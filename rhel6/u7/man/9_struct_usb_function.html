<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:37:08 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>STRUCT USB_FUNCTION(9) Kernel Mode Gadget API STRUCT
USB_FUNCTION(9)</p>

<p>NAME struct_usb_function - describes one function of a
configuration</p>

<p>SYNOPSIS struct usb_function { const char * name; struct
usb_gadget_strings ** strings; struct usb_descriptor_header
** descriptors; struct usb_descriptor_header **
hs_descriptors; struct usb_configuration * config; int (*
bind) (struct usb_configuration *,struct usb_function *);
void (* unbind) (struct usb_configuration *,struct
usb_function *); int (* set_alt) (struct usb_function
*,unsigned interface, unsigned alt); int (* get_alt) (struct
usb_function *,unsigned interface); void (* disable) (struct
usb_function *); int (* setup) (struct usb_function *,const
struct usb_ctrlrequest *); void (* suspend) (struct
usb_function *); void (* resume) (struct usb_function *);
};</p>

<p>MEMBERS name For diagnostics, identifies the
function.</p>

<p>strings tables of strings, keyed by identifiers assigned
during bind and by language IDs provided in control
requests</p>

<p>descriptors Table of full (or low) speed descriptors,
using interface and string identifiers assigned during
bind(). If this pointer is null, the function will not be
available at full speed (or at low speed).</p>

<p>hs_descriptors Table of high speed descriptors, using
interface and string identifiers assigned during bind(). If
this pointer is null, the function will not be available at
high speed.</p>

<p>config assigned when usb_add_function() is called; this
is the configuration with which this function is
associated.</p>

<p>bind Before the gadget can register, all of its
functions bind to the available resources including string
and interface identifiers used in interface or class
descriptors; endpoints; I/O buffers; and so on.</p>

<p>unbind Reverses bind; called as a side effect of
unregistering the driver which added this function.</p>

<p>set_alt (REQUIRED) Reconfigures altsettings; function
drivers may initialize usb_ep.driver data at this time (when
it is used). Note that setting an interface to its current
altsetting resets interface state, and that all interfaces
have a disabled state.</p>

<p>get_alt Returns the active altsetting. If this is not
provided, then only altsetting zero is supported.</p>

<p>disable (REQUIRED) Indicates the function should be
disabled. Reasons include host resetting or reconfiguring
the gadget, and disconnection.</p>

<p>setup Used for interface-specific control requests.</p>

<p>suspend Notifies functions when the host stops sending
USB traffic.</p>

<p>resume Notifies functions when the host restarts USB
traffic.</p>

<p>DESCRIPTION A single USB function uses one or more
interfaces, and should in most cases support operation at
both full and high speeds. Each function is associated by
usb_add_function() with a one configuration; that function
causes bind() to be called so resources can be allocated as
part of setting up a gadget driver. Those resources include
endpoints, which should be allocated using
usb_ep_autoconfig().</p>

<p>To support dual speed operation, a function driver
provides descriptors for both high and full speed operation.
Except in rare cases that don&acute;t involve bulk
endpoints, each speed needs different endpoint
descriptors.</p>

<p>Function drivers choose their own strategies for
managing instance data. The simplest strategy just declares
it &quot;static&acute;, which means the function can only be
activated once. If the function needs to be exposed in more
than one configuration at a given speed, it needs to support
multiple usb_function structures (one for each
configuration).</p>

<p>A more complex strategy might encapsulate a usb_function
structure inside a driver-specific instance structure to
allows multiple activations. An example of multiple
activations might be a CDC ACM function that supports two or
more distinct instances within the same configuration,
providing several independent logical data links to a USB
host.</p>

<p>AUTHOR David Brownell
&lt;dbrownell@users.sourceforge.net&gt; Author.</p>

<p>COPYRIGHT Kernel Hackers Manual 2.6. July 2015 STRUCT
USB_FUNCTION(9)</p>
<hr>
</body>
</html>
