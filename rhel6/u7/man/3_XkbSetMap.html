<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:46:43 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>XkbSetMap(3) XKB FUNCTIONS XkbSetMap(3)</p>

<p>NAME XkbSetMap - Send a complete new set of values for
entire components to the server.</p>

<p>SYNOPSIS Bool XkbSetMap (Display *dpy, unsigned int
which, XkbDescPtr xkb);</p>

<p>ARGUMENTS - dpy connection to X server</p>

<p>- which mask selecting subcomponents to update</p>

<p>- xkb description from which new values are taken</p>

<p>DESCRIPTION There are two ways to make changes to map
components: either change a local copy of the keyboard map
and call XkbSetMap to send the modified map to the server,
or, to reduce network traffic, use an XkbMapChanges- Rec
structure and call XkbChangeMap.</p>

<p>Use XkbSetMap to send a complete new set of values for
entire compo- nents (for example, all symbols, all actions,
and so on) to the server. The which parameter specifies the
components to be sent to the server, and is a bitwise
inclusive OR of the masks listed in Table 1. The xkb
parameter is a pointer to an XkbDescRec structure and
contains the information to be copied to the server. For
each bit set in the which parameter, XkbSetMap takes the
corresponding structure values from the xkb parameter and
sends it to the server specified by dpy.</p>

<p>If any components specified by which are not present in
the xkb parame- ter, XkbSetMap returns False. Otherwise, it
sends the update request to the server and returns True.
XkbSetMap can generate BadAlloc, BadLength, and BadValue
protocol errors.</p>

<p>Key types, symbol maps, and actions are all
interrelated; changes in one require changes in the others.
Xkb provides functions to make it easier to edit these
components and handle the interdependencies. Table 1 lists
these helper functions and provides a pointer to where they
are defined.</p>

<p>Table 1 Xkb Mapping Component Masks and Convenience
Functions
--------------------------------------------------------------------------------------
Mask Value Map Fields Convenience Functions
--------------------------------------------------------------------------------------
XkbKeyTypesMask (1&lt;&lt;0) client types XkbGetKeyTypes
size_types XkbResizeKeyType num_types XkbCopyKeyType
XkbCopyKeyTypes XkbKeySymsMask (1&lt;&lt;1) client syms
XkbGetKeySyms size_syms XkbResizeKeySyms num_syms
XkbChangeTypesOfKey key_sym_map XkbModifierMapMask
(1&lt;&lt;2) client modmap XkbGetKeyModifierMap
XkbExplicitCompo- (1&lt;&lt;3) server explicit
XkbGetKeyExplicitComponents nentsMask</p>

<p>XkbKeyActionsMask (1&lt;&lt;4) server key_acts
XkbGetKeyActions acts XkbResizeKeyActions num_acts size_acts
XkbKeyBehaviorsMask (1&lt;&lt;5) server behaviors
XkbGetKeyBehaviors XkbVirtualModsMask (1&lt;&lt;6) server
vmods XkbGetVirtualMods XkbVirtualModMapMask (1&lt;&lt;7)
server vmodmap XkbGetVirtualModMap</p>

<p>The changed field identifies the map components that
have changed in an XkbDescRec structure and may contain any
of the bits in Table 1, which are also shown in Table 2.
Every 1 bit in changed also identifies which other fields in
the XkbMapChangesRec structure contain valid values, as
indicated in Table 2. The min_key_code and max_key_code
fields are for reference only; they are ignored on any
requests sent to the server and are always updated by the
server whenever it returns the data for an
XkbMapChangesRec.</p>

<p>Table 2 XkbMapChangesRec Masks
---------------------------------------------------------------------------------------------------------
Valid Mask XkbMapChangesRec XkbDescRec Field Containing
Fields Changed Data
---------------------------------------------------------------------------------------------------------
XkbKeyTypesMask first_type, map-&gt;type[first_type] ..
num_types map-&gt;type[first_type + num_types - 1]</p>

<p>XkbKeySymsMask first_key_sym,
map-&gt;key_sym_map[first_key_sym] .. num_key_syms
map-&gt;key_sym_map[first_key_sym + num_key_syms - 1]
XkbModifierMapMask first_modmap_key,
map-&gt;modmap[first_modmap_key] .. num_modmap_keys
map-&gt;modmap[first_modmap_key + num_modmap_keys-1]
XkbExplicitComponentsMask first_key_explicit,
server-&gt;explicit[first_key_explicit] .. num_key_explicit
server-&gt;explicit[first_key_explicit + num_key_explicit -
1] XkbKeyActionsMask first_key_act,
server-&gt;key_acts[first_key_act] .. num_key_acts
server-&gt;key_acts[first_key_act + num_key_acts - 1]
XkbKeyBehaviorsMask first_key_behavior,
server-&gt;behaviors[first_key_behavior] ..
num_key_behaviors server-&gt;behaviors[first_key_behavior +
num_key_behaviors - 1] XkbVirtualModsMask vmods
server-&gt;vmods[*] XkbVirtualModMapMask first_vmodmap_key,
server-&gt;vmodmap[first_vmodmap_key] num_vmodmap_keys ..
server-&gt;vmodmap[first_vmodmap_key + num_vmodmap_keys -
1]</p>

<p>RETURN VALUES True The XkbSetMap function returns True
all components spec- ified by which are present in the xkb
parameter.</p>

<p>False The XkbSetMap function returns False if any
component specified by which is not present in the xkb
parameter.</p>

<p>STRUCTURES Use the XkbMapChangesRec structure to
identify and track partial modi- fications to the mapping
components and to reduce the amount of traffic between the
server and clients.</p>

<p>typedef struct _XkbMapChanges { unsigned short changed;
/ identifies valid components in structure */ KeyCode
min_key_code; / lowest numbered keycode for device */
KeyCode max_key_code; / highest numbered keycode for device
*/ unsigned char first_type; / index of first key type
modified */ unsigned char num_types; / # types modified */
KeyCode first_key_sym; / first key whose key_sym_map changed
*/ unsigned char num_key_syms; / # key_sym_map entries
changed */ KeyCode first_key_act; / first key whose key_acts
entry changed */ unsigned char num_key_acts; / # key_acts
entries changed */ KeyCode first_key_behavior; / first key
whose behaviors changed */ unsigned char num_key_behaviors;
/ # behaviors entries changed */ KeyCode first_key_explicit;
/ first key whose explicit entry changed */ unsigned char
num_key_explicit; / # explicit entries changed */ KeyCode
first_modmap_key; / first key whose modmap entry changed */
unsigned char num_modmap_keys; / # modmap entries changed */
KeyCode first_vmodmap_key; / first key whose vmodmap changed
*/ unsigned char num_vmodmap_keys; / # vmodmap entries
changed */ unsigned char pad1; / reserved */ unsigned short
vmods; / mask indicating which vmods changed */ }
XkbMapChangesRec,*XkbMapChangesPtr;</p>

<p>The complete description of an Xkb keyboard is given by
an XkbDescRec. The component structures in the XkbDescRec
represent the major Xkb com- ponents.</p>

<p>typedef struct { struct _XDisplay * display; /
connection to X server */ unsigned short flags; / private to
Xkb, do not modify */ unsigned short device_spec; / device
of interest */ KeyCode min_key_code; / minimum keycode for
device */ KeyCode max_key_code; / maximum keycode for device
*/ XkbControlsPtr ctrls; / controls */ XkbServerMapPtr
server; / server keymap */ XkbClientMapPtr map; / client
keymap */ XkbIndicatorPtr indicators; / indicator map */
XkbNamesPtr names; / names for all components */
XkbCompatMapPtr compat; / compatibility map */
XkbGeometryPtr geom; / physical geometry of keyboard */ }
XkbDescRec, *XkbDescPtr;</p>

<p>The display field points to an X display structure. The
flags field is private to the library: modifying flags may
yield unpredictable results. The device_spec field specifies
the device identifier of the keyboard input device, or
XkbUseCoreKeyboard, which specifies the core keyboard
device. The min_key_code and max_key_code fields specify the
least and greatest keycode that can be returned by the
keyboard.</p>

<p>Each structure component has a corresponding mask bit
that is used in function calls to indicate that the
structure should be manipulated in some manner, such as
allocating it or freeing it. These masks and their
relationships to the fields in the XkbDescRec are shown in
Table 3.</p>

<p>Table 3 Mask Bits for XkbDescRec
-------------------------------------------------- Mask Bit
XkbDescRec Field Value
--------------------------------------------------
XkbControlsMask ctrls (1L&lt;&lt;0) XkbServerMapMask server
(1L&lt;&lt;1) XkbIClientMapMask map (1L&lt;&lt;2)
XkbIndicatorMapMask indicators (1L&lt;&lt;3) XkbNamesMask
names (1L&lt;&lt;4) XkbCompatMapMask compat (1L&lt;&lt;5)
XkbGeometryMask geom (1L&lt;&lt;6) XkbAllComponentsMask All
Fields (0x7f)</p>

<p>DIAGNOSTICS BadAlloc Unable to allocate storage</p>

<p>BadLength The length of a request is shorter or longer
than that required to minimally contain the arguments</p>

<p>BadValue An argument is out of range</p>

<p>SEE ALSO XkbChangeMap(3), XkbChangeTypesOfKey(3),
XkbCopyKeyType(3), XkbCopyKey- Types(3),
XkbGetKeyActions(3), XkbGetKeyBehaviors(3), XkbGetKeyExplic-
itComponents(3), XkbGetKeyModifierMap(3), XkbGetKeySyms(3),
XkbGetKey- Types(3), XkbResizeKeyActions(3),
XkbResizeKeySyms(3), XkbResizeKey- Type(3),
XkbGetVirtualModMap(3), XkbGetVirtualMods(3)</p>

<p>X Version 11 libX11 1.6.0 XkbSetMap(3)</p>
<hr>
</body>
</html>
