<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:10:13 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>DOVEADM-DIRECTOR(1) Dovecot DOVEADM-DIRECTOR(1)</p>

<p>NAME doveadm-director - Manage Dovecot directors</p>

<p>SYNOPSIS doveadm [-Dv] director add [-a
director_socket_path] host [vhost_count] doveadm [-Dv]
director flush [-a director_socket_path] host|all doveadm
[-Dv] director map [-a director_socket_path] [-f users_file]
[host] doveadm [-Dv] director remove [-a
director_socket_path] host doveadm [-Dv] director status [-a
director_socket_path] [user]</p>

<p>DESCRIPTION doveadm director can be used to manage and
query the status of the list of backend mail servers where
Dovecot proxy can redirect connections to.</p>

<p>OPTIONS Global doveadm(1) options:</p>

<p>-D Enables verbosity and debug messages.</p>

<p>-v Enables verbosity, including progress counter.</p>

<p>Command specific options:</p>

<p>-a director_socket_path This option is used to specify
an alternative socket. The option&rsquo;s argument is either
an absolute path to a local UNIX domain socket, or a
hostname and port (hostname:port), in order to connect a
remote host via a TCP socket.</p>

<p>By default doveadm(1) will use the socket /var/run/dove-
cot/director-admin. The socket may be located in another
direc- tory, when the default base_dir setting was
overridden in /etc/dovecot/dovecot.conf.</p>

<p>ARGUMENTS host A mail server&rsquo;s hostname or IP
address.</p>

<p>user Is a user&rsquo;s login name. Depending on the
configuration, a login name may be for example jane or
john@example.com.</p>

<p>vhost_count The number of &quot;virtual hosts&quot; to
assign to this server. The higher the number is relative to
other servers, the more connec- tions it gets. The default
is 100.</p>

<p>COMMANDS director add doveadm director add [-a
director_socket_path] host [vhost_count]</p>

<p>The command&rsquo;s tasks are:</p>

<p>* assign a new mail server to the director.</p>

<p>* increase/decrease the vhost_count of an already
assigned server.</p>

<p>director flush doveadm director flush [-a
director_socket_path] host|all</p>

<p>doveadm director flush drops all user associations
either from the given host or all hosts. This command is
intended mainly for testing purposes.</p>

<p>director map doveadm director map [-a
director_socket_path] [-f users_file] [host]</p>

<p>The command doveadm director map is used to list current
user host mappings.</p>

<p>-f users_file Path to a file containing all user names
(one per line). When given no userdb lookup will be
performed. This may be a helpful alternative when for
example the network connection to the LDAP or SQL server is
slow.</p>

<p>host Specify a server&rsquo;s IP address or hostname, to
list only mappings of the given host.</p>

<p>director remove doveadm director remove [-a
director_socket_path] host</p>

<p>Use this command in oder to remove the given host from
the director.</p>

<p>director status doveadm director status [-a
director_socket_path] [user]</p>

<p>This command is used to show the current usage of all
assigned mail servers. When a user name is given, this
command shows which server the user is currently assigned
to, where the user will be assigned after the cur- rent
saved assignment gets removed and where the user would be
assigned to if the whole proxy cluster was restarted
fresh.</p>

<p>FILES /etc/dovecot/dovecot.conf Dovecot&rsquo;s main
configuration file.</p>

<p>/etc/dovecot/conf.d/10-director.conf Director specific
settings.</p>

<p>EXAMPLE Add a director with vhost count 150 (or change
existing one&rsquo;s vhost count to 150):</p>

<p>doveadm -v director add x1357.imap.ha.example.net 150
2001:db8:543:6861:143::1357: OK</p>

<p>Remove a director:</p>

<p>doveadm director remove x1357.imap.ha.example.net</p>

<p>Query the status of mail hosts in a director:</p>

<p>doveadm director status mail server ip vhosts users
192.168.10.1 100 125 192.168.10.2 100 144 192.168.10.3 100
115</p>

<p>Query the status of a user&rsquo;s assignment:</p>

<p>doveadm director status user@example.com Current:
192.168.10.1 (expires 2010-06-18 20:17:04) Hashed:
192.168.10.2 Initial config: 192.168.10.3</p>

<p>This means that the user is currently assigned to mail
server on IP 192.168.10.1. After all of user&rsquo;s
connections have logged out, the assignment will be removed
(currently it looks like at 20:17:04, but that may be
increased). After the assignment has expired, the user will
next time be redirected to 192.168.10.2 (assuming no changes
to direc- tor settings). If the entire Dovecot proxy cluster
was restarted, so that all of the director configuration
would revert back to its initial values, the user would be
redirected to 192.168.10.3.</p>

<p>REPORTING BUGS Report bugs, including doveconf -n
output, to the Dovecot Mailing List
&lt;dovecot@dovecot.org&gt;. Information about reporting
bugs is available at: http://dovecot.org/bugreport.html</p>

<p>SEE ALSO doveadm(1)</p>

<p>Dovecot v2.0 2010-07-16 DOVEADM-DIRECTOR(1)</p>
<hr>
</body>
</html>
