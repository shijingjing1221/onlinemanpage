<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:24:39 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>OCF_HEARTBEAT_NGINX(7) OCF resource agents
OCF_HEARTBEAT_NGINX(7)</p>

<p>NAME ocf_heartbeat_nginx - Manages an Nginx web/proxy
server instance</p>

<p>SYNOPSIS nginx [start | stop | status | monitor |
meta-data | validate-all]</p>

<p>DESCRIPTION This is the resource agent for the Nginx
web/proxy server. This resource agent does not monitor POP
or IMAP servers, as we don&acute;t know how to determine
meaningful status for them.</p>

<p>The start operation ends with a loop in which monitor is
repeatedly called to make sure that the server started and
that it is operational. Hence, if the monitor operation does
not succeed within the start operation timeout, the nginx
resource will end with an error status.</p>

<p>The default monitor operation will verify that nginx is
running.</p>

<p>The level 10 monitor operation by default will try and
fetch the /nginx_status page - which is commented out in
sample nginx configurations. Make sure that the
/nginx_status page works and that the access is restricted
to localhost (address 127.0.0.1) plus whatever places
_outside the cluster_ you want to monitor the server from.
See the status10url and status10regex attributes for more
details.</p>

<p>The level 20 monitor operation will perform a more
complex set of tests from a configuration file.</p>

<p>The level 30 monitor operation will run an external
command to perform an arbitrary monitoring operation.</p>

<p>SUPPORTED PARAMETERS configfile The full pathname of the
Nginx configuration file. This file is parsed to provide
defaults for various other resource agent parameters.</p>

<p>(unique, optional, string, no default)</p>

<p>httpd The full pathname of the httpd binary
(optional).</p>

<p>(optional, string, default
&quot;/usr/sbin/httpd&quot;)</p>

<p>port A port number that we can probe for status
information using the statusurl. This will default to the
port number found in the configuration file, or 80, if none
can be found in the configuration file.</p>

<p>(optional, integer, no default)</p>

<p>status10url The URL to monitor (the nginx server status
page by default) when given a level 10 monitor operation. If
left unspecified, it will be inferred from the nginx
configuration file, or defaulted to /nginx_status.</p>

<p>If you set this, make sure that it succeeds *only* from
the localhost (127.0.0.1) and no other cluster nodes.
Otherwise, the cluster software may complain about it being
active on multiple nodes.</p>

<p>(optional, string, no default)</p>

<p>status10regex Regular expression to match in the output
of status10url. Case insensitive.</p>

<p>(optional, string, default &quot;Reading: [0-9]+
Writing: [0-9]+ Waiting: [0-9]+&quot;)</p>

<p>testclient Client to use to query to Nginx for level 10
and level 20 tests. If not specified, the RA will try to
find one on the system. Currently, wget and curl are
supported, with curl being preferred. For example, you can
set this paramter to &quot;wget&quot; if you prefer that to
curl.</p>

<p>(optional, string, no default)</p>

<p>test20url URL to test. If it does not start with
&quot;http&quot;, then it&acute;s considered to be relative
to the document root address.</p>

<p>(optional, string, no default)</p>

<p>test20regex Regular expression to match in the output of
test20url. Case insensitive.</p>

<p>(optional, string, no default)</p>

<p>test20conffile A file which contains a more complex test
configuration. Could be useful if you have to check more
than one web application or in case sensitive info should be
passed as arguments (passwords). Furthermore, using a config
file is the only way to specify certain parameters.</p>

<p>Please see README.webapps for examples and file
description.</p>

<p>(optional, string, no default)</p>

<p>test20name Name of the test within the test
configuration file.</p>

<p>(optional, string, no default)</p>

<p>external_monitor30_cmd Command string to run which
implements level 30 monitoring.</p>

<p>(optional, string, no default)</p>

<p>options Extra options to apply when starting nginx.</p>

<p>(optional, string, no default)</p>

<p>SUPPORTED ACTIONS This resource agent supports the
following actions (operations):</p>

<p>start Starts the resource. Suggested minimum timeout:
60s.</p>

<p>stop Stops the resource. Suggested minimum timeout:
60s.</p>

<p>reload Suggested minimum timeout: 40s.</p>

<p>status Performs a status check. Suggested minimum
timeout: 30s.</p>

<p>monitor Performs a detailed status check. Suggested
minimum timeout: 30s. Suggested interval: 20s.</p>

<p>meta-data Retrieves resource agent metadata (internal
use only). Suggested minimum timeout: 5.</p>

<p>validate-all Performs a validation of the resource
configuration. Suggested minimum timeout: 5.</p>

<p>EXAMPLE The following is an example configuration for a
nginx resource using the crm(8) shell:</p>

<p>primitive p_nginx ocf:heartbeat:nginx op monitor
timeout=&quot;30s&quot; depth=&quot;0&quot;
interval=&quot;20s&quot;</p>

<p>SEE ALSO
http://www.linux-ha.org/wiki/nginx_(resource_agent)</p>

<p>AUTHOR Linux-HA contributors (see the resource agent
source for information about individual authors)</p>

<p>resource-agents 3.9.2 05/07/2015
OCF_HEARTBEAT_NGINX(7)</p>
<hr>
</body>
</html>
