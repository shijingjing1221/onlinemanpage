<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:14:56 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>GETGROUPLIST(3) Linux Programmer s Manual
GETGROUPLIST(3)</p>

<p>NAME getgrouplist - get list of groups to which a user
belongs</p>

<p>SYNOPSIS #include &lt;grp.h&gt;</p>

<p>int getgrouplist(const char *user, gid_t group, gid_t
*groups, int *ngroups);</p>

<p>Feature Test Macro Requirements for glibc (see
feature_test_macros(7)):</p>

<p>getgrouplist(): _BSD_SOURCE</p>

<p>DESCRIPTION The getgrouplist() function scans the group
database (see group(5)) to obtain the list of groups that
user belongs to. Up to *ngroups of these groups are returned
in the array groups.</p>

<p>If it was not among the groups defined for user in the
group database, then group is included in the list of groups
returned by getgrou- plist(); typically this argument is
specified as the group ID from the password record for
user.</p>

<p>The ngroups argument is a value-result argument: on
return it always contains the number of groups found for
user, including group; this value may be greater than the
number of groups stored in groups.</p>

<p>RETURN VALUE If the number of groups of which user is a
member is less than or equal to *ngroups, then the value
*ngroups is returned.</p>

<p>If the user is a member of more than *ngroups groups,
then getgrou- plist() returns -1. In this case the value
returned in *ngroups can be used to resize the buffer passed
to a further call getgrouplist().</p>

<p>VERSIONS This function is present since glibc 2.2.4.</p>

<p>CONFORMING TO This function is non-standard; it appears
on most BSDs.</p>

<p>BUGS In glibc versions before 2.3.3, the implementation
of this function contains a buffer-overrun bug: it returns
the complete list of groups for user in the array groups,
even when the number of groups exceeds *ngroups.</p>

<p>EXAMPLE The program below displays the group list for
the user named in its first command-line argument. The
second command-line argument speci- fies the ngroups value
to be supplied to getgrouplist(). The following shell
session shows examples of the use of this program:</p>

<p>$ ./a.out cecilia 0 getgrouplist() returned -1; ngroups
= 3 $ ./a.out cecilia 3 ngroups = 3 16 (dialout) 33 (video)
100 (users)</p>

<p>Program source</p>

<p>#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt;
#include &lt;grp.h&gt; #include &lt;pwd.h&gt;</p>

<p>int main(int argc, char *argv[]) { int j, ngroups; gid_t
*groups; struct passwd *pw; struct group *gr;</p>

<p>if (argc != 3) { fprintf(stderr, &quot;Usage: %s
&lt;user&gt; &lt;ngroups&gt;0, argv[0]); exit(EXIT_FAILURE);
}</p>

<p>ngroups = atoi(argv[2]);</p>

<p>groups = malloc(ngroups * sizeof (gid_t)); if (groups ==
NULL) { perror(&quot;malloc&quot;); exit(EXIT_FAILURE);
}</p>

<p>/* Fetch passwd structure (contains first group ID for
user) */</p>

<p>pw = getpwnam(argv[1]); if (pw == NULL) {
perror(&quot;getpwnam&quot;); exit(EXIT_SUCCESS); }</p>

<p>/* Retrieve group list */</p>

<p>if (getgrouplist(argv[1], pw-&gt;pw_gid, groups,
&amp;ngroups) == -1) { fprintf(stderr, &quot;getgrouplist()
returned -1; ngroups = %d0, ngroups); exit(EXIT_FAILURE);
}</p>

<p>/* Display list of retrieved groups, along with group
names */</p>

<p>fprintf(stderr, &quot;ngroups = %d0, ngroups); for (j =
0; j &lt; ngroups; j++) { printf(&quot;%d&quot;, groups[j]);
gr = getgrgid(groups[j]); if (gr != NULL) printf(&quot;
(%s)&quot;, gr-&gt;gr_name); printf(&quot;0); }</p>

<p>exit(EXIT_SUCCESS); }</p>

<p>SEE ALSO getgroups(2), setgroups(2), getgrent(3),
group(5), passwd(5)</p>

<p>COLOPHON This page is part of release 3.22 of the Linux
man-pages project. A description of the project, and
information about reporting bugs, can be found at
http://www.kernel.org/doc/man-pages/.</p>

<p>GNU 2008-07-03 GETGROUPLIST(3)</p>
<hr>
</body>
</html>
