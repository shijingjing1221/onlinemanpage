<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:13:01 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>FLUSH(8) FLUSH(8)</p>

<p>NAME flush - Postfix fast flush server</p>

<p>SYNOPSIS flush [generic Postfix daemon options]</p>

<p>DESCRIPTION The flush(8) server maintains a record of
deferred mail by destination. This information is used to
improve the performance of the SMTP ETRN request, and of its
command-line equivalent, &quot;sendmail -qR&quot; or
&quot;postqueue -f&quot;. This program expects to be run
from the master(8) pro- cess manager.</p>

<p>The record is implemented as a per-destination logfile
with as contents the queue IDs of deferred mail. A logfile
is append-only, and is trun- cated when delivery is
requested for the corresponding destination. A destination
is the part on the right-hand side of the right-most @ in an
email address.</p>

<p>Per-destination logfiles of deferred mail are maintained
only for eli- gible destinations. The list of eligible
destinations is specified with the fast_flush_domains
configuration parameter, which defaults to
$relay_domains.</p>

<p>This server implements the following requests:</p>

<p>add sitename queueid Inform the flush(8) server that the
message with the specified queue ID is queued for the
specified destination.</p>

<p>send_site sitename Request delivery of mail that is
queued for the specified desti- nation.</p>

<p>send_file queueid Request delivery of the specified
deferred message.</p>

<p>refresh Refresh non-empty per-destination logfiles that
were not read in $fast_flush_refresh_time hours, by
simulating send requests (see above) for the corresponding
destinations.</p>

<p>Delete empty per-destination logfiles that were not
updated in $fast_flush_purge_time days.</p>

<p>This request completes in the background.</p>

<p>purge Do a refresh for all per-destination logfiles.</p>

<p>SECURITY The flush(8) server is not security-sensitive.
It does not talk to the network, and it does not talk to
local users. The fast flush server can run chrooted at fixed
low privilege.</p>

<p>DIAGNOSTICS Problems and transactions are logged to
syslogd(8).</p>

<p>BUGS Fast flush logfiles are truncated only after a
&quot;send&quot; request, not when mail is actually
delivered, and therefore can accumulate outdated or
redundant data. In order to maintain sanity,
&quot;refresh&quot; must be executed periodically. This can
be automated with a suitable wakeup timer setting in the
master.cf configuration file.</p>

<p>Upon receipt of a request to deliver mail for an
eligible destination, the flush(8) server requests delivery
of all messages that are listed in that destination s
logfile, regardless of the recipients of those messages.
This is not an issue for mail that is sent to a
relay_domains destination because such mail typically only
has recipients in one domain.</p>

<p>CONFIGURATION PARAMETERS Changes to main.cf are picked
up automatically as flush(8) processes run for only a
limited amount of time. Use the command &quot;postfix
reload&quot; to speed up a change.</p>

<p>The text below provides only a parameter summary. See
postconf(5) for more details including examples.</p>

<p>config_directory (seepostconf -doutput) The default
location of the Postfix main.cf and master.cf con-
figuration files.</p>

<p>daemon_timeout (18000s) How much time a Postfix daemon
process may take to handle a request before it is terminated
by a built-in watchdog timer.</p>

<p>fast_flush_domains ($relay_domains) Optional list of
destinations that are eligible for per-destina- tion
logfiles with mail that is queued to those destinations.</p>

<p>fast_flush_refresh_time (12h) The time after which a
non-empty but unread per-destination &quot;fast flush&quot;
logfile needs to be refreshed.</p>

<p>fast_flush_purge_time (7d) The time after which an empty
per-destination &quot;fast flush&quot; log- file is
deleted.</p>

<p>ipc_timeout (3600s) The time limit for sending or
receiving information over an internal communication
channel.</p>

<p>max_idle (100s) The maximum amount of time that an idle
Postfix daemon process waits for an incoming connection
before terminating voluntarily.</p>

<p>max_use (100) The maximal number of incoming connections
that a Postfix daemon process will service before
terminating voluntarily.</p>

<p>parent_domain_matches_subdomains (seepostconf -doutput)
What Postfix features match subdomains of
&quot;domain.tld&quot; automati- cally, instead of requiring
an explicit &quot;.domain.tld&quot; pattern.</p>

<p>process_id (read-only) The process ID of a Postfix
command or daemon process.</p>

<p>process_name (read-only) The process name of a Postfix
command or daemon process.</p>

<p>queue_directory (seepostconf -doutput) The location of
the Postfix top-level queue directory.</p>

<p>syslog_facility (mail) The syslog facility of Postfix
logging.</p>

<p>syslog_name (seepostconf -doutput) The mail system name
that is prepended to the process name in syslog records, so
that &quot;smtpd&quot; becomes, for example,
&quot;postfix/smtpd&quot;.</p>

<p>FILES /var/spool/postfix/flush, &quot;fast flush&quot;
logfiles.</p>

<p>SEE ALSO smtpd(8), SMTP server qmgr(8), queue manager
postconf(5), configuration parameters master(5), generic
daemon options master(8), process manager syslogd(8), system
logging</p>

<p>README FILES Use &quot;postconf readme_directory&quot;
or &quot;postconf html_directory&quot; to locate this
information. ETRN_README, Postfix ETRN howto</p>

<p>LICENSE The Secure Mailer license must be distributed
with this software.</p>

<p>HISTORY This service was introduced with Postfix version
1.0.</p>

<p>AUTHOR(S) Wietse Venema IBM T.J. Watson Research P.O.
Box 704 Yorktown Heights, NY 10598, USA</p>

<p>FLUSH(8)</p>
<hr>
</body>
</html>
