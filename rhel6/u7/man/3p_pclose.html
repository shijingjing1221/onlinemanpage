<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:25:52 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PCLOSE(3P) POSIX Programmer s Manual PCLOSE(3P)</p>

<p>PROLOG This manual page is part of the POSIX Programmer
s Manual. The Linux implementation of this interface may
differ (consult the corresponding Linux manual page for
details of Linux behavior), or the interface may not be
implemented on Linux.</p>

<p>NAME pclose - close a pipe stream to or from a
process</p>

<p>SYNOPSIS #include &lt;stdio.h&gt;</p>

<p>int pclose(FILE *stream);</p>

<p>DESCRIPTION The pclose() function shall close a stream
that was opened by popen(), wait for the command to
terminate, and return the termination status of the process
that was running the command language interpreter. How-
ever, if a call caused the termination status to be
unavailable to pclose(), then pclose() shall return -1 with
errno set to [ECHILD] to report this situation. This can
happen if the application calls one of the following
functions:</p>

<p>* wait()</p>

<p>* waitpid() with a pid argument less than or equal to 0
or equal to the process ID of the command line
interpreter</p>

<p>* Any other function not defined in this volume of IEEE
Std 1003.1-2001 that could do one of the above</p>

<p>In any case, pclose() shall not return before the child
process created by popen() has terminated.</p>

<p>If the command language interpreter cannot be executed,
the child ter- mination status returned by pclose() shall be
as if the command lan- guage interpreter terminated using
exit(127) or _exit(127).</p>

<p>The pclose() function shall not affect the termination
status of any child of the calling process other than the
one created by popen() for the associated stream.</p>

<p>If the argument stream to pclose() is not a pointer to a
stream created by popen(), the result of pclose() is
undefined.</p>

<p>RETURN VALUE Upon successful return, pclose() shall
return the termination status of the command language
interpreter. Otherwise, pclose() shall return -1 and set
errno to indicate the error.</p>

<p>ERRORS The pclose() function shall fail if:</p>

<p>ECHILD The status of the child process could not be
obtained, as described above.</p>

<p>The following sections are informative.</p>

<p>EXAMPLES None.</p>

<p>APPLICATION USAGE None.</p>

<p>RATIONALE There is a requirement that pclose() not
return before the child pro- cess terminates. This is
intended to disallow implementations that return [EINTR] if
a signal is received while waiting. If pclose() returned
before the child terminated, there would be no way for the
application to discover which child used to be associated
with the stream, and it could not do the cleanup itself.</p>

<p>If the stream pointed to by stream was not created by
popen(), histori- cal implementations of pclose() return -1
without setting errno. To avoid requiring pclose() to set
errno in this case, IEEE Std 1003.1-2001 makes the behavior
unspecified. An application should not use pclose() to close
any stream that was not created by popen().</p>

<p>Some historical implementations of pclose() either block
or ignore the signals SIGINT, SIGQUIT, and SIGHUP while
waiting for the child process to terminate. Since this
behavior is not described for the pclose() function in IEEE
Std 1003.1-2001, such implementations are not conform- ing.
Also, some historical implementations return [EINTR] if a
signal is received, even though the child process has not
terminated. Such implementations are also considered
non-conforming.</p>

<p>Consider, for example, an application that uses:</p>

<p>popen(&quot;command&quot;, &quot;r&quot;)</p>

<p>to start command, which is part of the same application.
The parent writes a prompt to its standard output
(presumably the terminal) and then reads from the popen()ed
stream. The child reads the response from the user, does
some transformation on the response (pathname expansion,
perhaps) and writes the result to its standard output. The
parent pro- cess reads the result from the pipe, does
something with it, and prints another prompt. The cycle
repeats. Assuming that both processes do appropriate buffer
flushing, this would be expected to work.</p>

<p>To conform to IEEE Std 1003.1-2001, pclose() must use
waitpid(), or some similar function, instead of wait().</p>

<p>The code sample below illustrates how the pclose()
function might be implemented on a system conforming to IEEE
Std 1003.1-2001.</p>

<p>int pclose(FILE *stream) { int stat; pid_t pid;</p>

<p>pid = &lt;pid for process created for stream by
popen()&gt; (void) fclose(stream); while (waitpid(pid,
&amp;stat, 0) == -1) { if (errno != EINTR){ stat = -1;
break; } } return(stat); }</p>

<p>FUTURE DIRECTIONS None.</p>

<p>SEE ALSO fork(), popen(), waitpid(), the Base
Definitions volume of IEEE Std 1003.1-2001,
&lt;stdio.h&gt;</p>

<p>COPYRIGHT Portions of this text are reprinted and
reproduced in electronic form from IEEE Std 1003.1, 2003
Edition, Standard for Information Technology -- Portable
Operating System Interface (POSIX), The Open Group Base
Specifications Issue 6, Copyright (C) 2001-2003 by the
Institute of Electrical and Electronics Engineers, Inc and
The Open Group. In the event of any discrepancy between this
version and the original IEEE and The Open Group Standard,
the original IEEE and The Open Group Standard is the referee
document. The original Standard can be obtained online at
http://www.opengroup.org/unix/online.html .</p>

<p>IEEE/The Open Group 2003 PCLOSE(3P)</p>
<hr>
</body>
</html>
