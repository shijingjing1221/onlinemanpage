<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:33:42 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>set_matchpathcon_flags(3) SELinux API documentation
set_matchpathcon_flags(3)</p>

<p>NAME set_matchpathcon_flags,
set_matchpathcon_invalidcon, set_matchpath- con_printf - set
flags controlling the operation of matchpathcon or
matchpathcon_index and configure the behaviour of validity
checking and error displaying.</p>

<p>SYNOPSIS #include &lt;selinux/selinux.h&gt;</p>

<p>void set_matchpathcon_flags(unsigned int flags);</p>

<p>void set_matchpathcon_invalidcon(int (*f)(const char
*path, unsigned lineno, char * context));</p>

<p>void set_matchpathcon_printf(void (*f)(const char *fmt,
...));</p>

<p>DESCRIPTION set_matchpathcon_flags sets the flags
controlling the operation of matchpathcon_init and
subsequently matchpathcon_index or matchpathcon. If the
MATCHPATHCON_BASEONLY flag is set, then only the base file
con- texts configuration file will be processed, not any
dynamically gener- ated entries or local customizations.</p>

<p>set_matchpathcon_invalidcon sets the function used by
matchpathcon_init when checking the validity of a context in
the file contexts configura- tion. If not set, then this
defaults to a test based on secu- rity_check_context(3),
which checks validity against the active policy on a SELinux
system. This can be set to instead perform checking based on
a binary policy file, e.g. using sepol_check_context(3), as
is done by setfiles -c. The function is also responsible for
reporting any such error, and may include the path and
lineno in such error messages.</p>

<p>set_matchpathcon_printf sets the function used by
matchpathcon_init when displaying errors about the file
contexts configuration. If not set, then this defaults to
fprintf(stderr, fmt, ...). This can be set to redirect error
reporting to a different destination.</p>

<p>RETURN VALUE Returns zero on success or -1
otherwise.</p>

<p>SEE ALSO selinux(8), matchpathcon(3),
matchpathcon_index(3), set_matchpath- con_invalidcon(3),
set_matchpathcon_printf(3), freecon(3), setfile- con(3),
setfscreatecon(3)</p>

<p>sds@tycho.nsa.gov 21 November 2009
set_matchpathcon_flags(3)</p>
<hr>
</body>
</html>
