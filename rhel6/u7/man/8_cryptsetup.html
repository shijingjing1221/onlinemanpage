<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:08:32 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>CRYPTSETUP(8) Maintenance Commands CRYPTSETUP(8)</p>

<p>NAME cryptsetup - setup cryptographic volumes for
dm-crypt (including LUKS extension)</p>

<p>SYNOPSIS cryptsetup &lt;options&gt; &lt;action&gt;
&lt;action args&gt;</p>

<p>DESCRIPTION cryptsetup is used to conveniently setup
dm-crypt managed device-mapper mappings. For basic (plain)
dm-crypt mappings, there are four opera- tions.</p>

<p>ACTIONS These strings are valid for &lt;action&gt;,
followed by their &lt;action args&gt;:</p>

<p>create &lt;name&gt; &lt;device&gt;</p>

<p>creates a mapping with &lt;name&gt; backed by device
&lt;device&gt;.</p>

<p>&lt;options&gt; can be [--hash, --cipher,
--verify-passphrase, --key- file, --key-size, --offset,
--skip, --readonly]</p>

<p>remove &lt;name&gt;</p>

<p>removes an existing mapping &lt;name&gt;.</p>

<p>status &lt;name&gt;</p>

<p>reports the status for the mapping &lt;name&gt;.</p>

<p>resize &lt;name&gt;</p>

<p>resizes an active mapping &lt;name&gt;.</p>

<p>If --size (in sectors) is not specified, the size of the
under- lying block device is used.</p>

<p>LUKS EXTENSION LUKS, Linux Unified Key Setup, is a
standard for hard disk encryption. It standardizes a
partition header, as well as the format of the bulk data.
LUKS can manage multiple passwords, that can be revoked
effec- tively and that are protected against dictionary
attacks with PBKDF2.</p>

<p>These are valid LUKS actions:</p>

<p>luksFormat &lt;device&gt; [&lt;key file&gt;]</p>

<p>initializes a LUKS partition and sets the initial key,
either via prompting or via &lt;key file&gt;.</p>

<p>&lt;options&gt; can be [--cipher, --verify-passphrase,
--key-size, --key-slot, --key-file (takes precedence over
optional second argument), --keyfile-size, --use-random |
--use-urandom, --uuid].</p>

<p>luksOpen &lt;device&gt; &lt;name&gt;</p>

<p>opens the LUKS partition &lt;device&gt; and sets up a
mapping &lt;name&gt; after successful verification of the
supplied key material (either via key file by --key-file, or
via prompting).</p>

<p>&lt;options&gt; can be [--key-file, --keyfile-size,
--readonly].</p>

<p>luksClose &lt;name&gt;</p>

<p>identical to remove.</p>

<p>luksSuspend &lt;name&gt;</p>

<p>suspends active device (all IO operations are frozen)
and wipes encryption key from kernel. Kernel version 2.6.19
or later is required.</p>

<p>After that operation you have to use luksResume to
reinstate encryption key (and resume device) or luksClose to
remove mapped device.</p>

<p>WARNING: never try to suspend device where is the
cryptsetup binary itself.</p>

<p>luksResume &lt;name&gt;</p>

<p>Resumes suspended device and reinstates encryption key.
You will need provide passphrase identical to luksOpen
command (using prompting or key file).</p>

<p>&lt;options&gt; can be [--key-file, --keyfile-size]</p>

<p>luksAddKey &lt;device&gt; [&lt;new key file&gt;]</p>

<p>add a new key file/passphrase. An existing passphrase or
key file (via --key-file) must be supplied. The key file
with the new material is supplied as a positional
argument.</p>

<p>&lt;options&gt; can be [--key-file, --keyfile-size,
--new-keyfile- size, --key-slot].</p>

<p>luksRemoveKey &lt;device&gt; [&lt;key file&gt;]</p>

<p>remove supplied key or key file from LUKS device</p>

<p>luksKillSlot &lt;device&gt; &lt;key slot number&gt;</p>

<p>wipe key with number &lt;key slot&gt; from LUKS device.
A remaining passphrase or key file (via --key-file) must be
supplied.</p>

<p>&lt;options&gt; can be [--key-file, --keyfile-size].</p>

<p>luksUUID &lt;device&gt;</p>

<p>print UUID, if &lt;device&gt; has a LUKS header.</p>

<p>set new UUID if --uuid option is specified.</p>

<p>isLuks &lt;device&gt;</p>

<p>returns true, if &lt;device&gt; is a LUKS partition.
Otherwise, false.</p>

<p>luksDump &lt;device&gt;</p>

<p>dumps the header information of a LUKS partition.</p>

<p>If --dump-master-key option is used, the volume (master)
key is dumped instead of keyslot info. Because this
information can be used to access encrypted device without
passphrase knowledge (even without LUKS header) use this
option very carefully.</p>

<p>Dump with volume key (either printed or stored to file)
should be always stored encrypted and on safe place.</p>

<p>LUKS passphrase or key file is required for volume key
dump.</p>

<p>&lt;options&gt; can be [--dump-master-key, --key-file,
--keyfile- size].</p>

<p>luksHeaderBackup &lt;device&gt; --header-backup-file
&lt;file&gt;</p>

<p>Stores binary backup of LUKS header and keyslot
areas.</p>

<p>WARNING: Please note that with this backup file (and old
passphrase knowledge) you can decrypt data even if old
passphrase was wiped from real device.</p>

<p>Also note that anti-forensic splitter is not used during
manipu- lation with backup file.</p>

<p>luksHeaderRestore &lt;device&gt; --header-backup-file
&lt;file&gt;</p>

<p>Restores binary backup of LUKS header and keyslot areas
from specified file.</p>

<p>WARNING: All the keyslot areas are overwritten, only
active keyslots form backup file are available after issuing
this com- mand.</p>

<p>This command allows restoring header if device do not
contain LUKS header or if the master key size and data
offset in LUKS header on device match the backup file.</p>

<p>For more information about LUKS, see
http://code.google.com/p/crypt- setup/wiki/Specification</p>

<p>OPTIONS --verbose, -v Print more verbose messages.</p>

<p>--debug Run in debug mode with full diagnostic logs.</p>

<p>--hash, -h For create action specifies hash to use for
password hashing.</p>

<p>For luksFormat action specifies hash used in LUKS key
setup scheme and volume key digest.</p>

<p>WARNING: setting hash other than sha1 causes LUKS device
incom- patible with older version of cryptsetup.</p>

<p>The hash string is passed to libgcrypt, so all hash
algorithms are supported (for luksFormat algorithm must
provide at least 20 byte long hash). Default is set during
compilation, compatible values with old version of
cryptsetup are &quot;ripemd160&quot; for create action and
&quot;sha1&quot; for luksFormat.</p>

<p>Use cryptsetup --help to show defaults.</p>

<p>--cipher, -c set cipher specification string.</p>

<p>Default mode is configurable during compilation, you can
see compiled-in default using cryptsetup --help. If not
changed, the default is for plain dm-crypt and LUKS mappings
&quot;aes-cbc- essiv:sha256&quot;.</p>

<p>For pre-2.6.10 kernels, use &quot;aes-plain&quot; as
they don t understand the new cipher spec strings. To use
ESSIV, use &quot;aes-cbc- essiv:sha256&quot;.</p>

<p>For XTS mode, kernel version 2.6.24 or more recent is
required. Use &quot;aes-xts-plain&quot; cipher specification
and set key size to 256 (or 512) bits (see -s option).</p>

<p>--verify-passphrase, -y query for passwords twice.
Useful when creating a (regular) map- ping for the first
time, or when running luksFormat.</p>

<p>--key-file, -d use file as key material.</p>

<p>With LUKS, key material supplied in key files via -d are
always used for existing passphrases, except in luksFormat
action where -d is equivalent to positional key file
argument. If you want to set a new key via a key file, you
have to use a positional arg to luksAddKey.</p>

<p>If the key file is &quot;-&quot;, stdin will be used.
With the &quot;-&quot; key file reading will not stop when
new line character is detected. See section NOTES ON
PASSWORD PROCESSING for more information.</p>

<p>--keyfile-size, -d value Limits read from keyfile to
value bytes. Usable together with all comands using key
file.</p>

<p>--new-keyfile-size value Limits read from new keyfile to
value bytes in luksAddKey when adding new key file. Default
is exhaustive read from key file.</p>

<p>--master-key-file Use pre-generated master key stored in
file. For luksFormat it allows LUKS header reformatting with
the same master key (if all other parameters are the same
existing encrypted data remains intact).</p>

<p>For luksAddKey it allows adding new passphrase with only
master key knowledge.</p>

<p>--dump-master-key For luksDump it allows LUKS header
dump including volume (mas- ter) key. Use with care (this
information allows access to device without passphrase
knowledge).</p>

<p>See luksDump for more info.</p>

<p>--use-random</p>

<p>--use-urandom For luksFormat it defines which kernel
random number generator will be used for long-term key
(volume key).</p>

<p>See NOTES ON RNG for more information. Use cryptsetup
--help to show default RNG.</p>

<p>--key-slot, -S For LUKS operations that add key
material, this options allows to you specify which key slot
is selected for the new key. This option can be used for
luksFormat and luksAddKey.</p>

<p>--key-size, -s set key size in bits.</p>

<p>Has to be a multiple of 8 bits. The key size is limited
by the used cipher. See output of /proc/crypto for more
information. Can be used for create or luksFormat, all other
LUKS actions will use key-size specified by the LUKS header.
Default is set during compilation, if not changed it is 256
bits.</p>

<p>Use cryptsetup --help to show defaults.</p>

<p>--size, -b force the size of the underlying device in
sectors. This option is only relevant for create and resize
action.</p>

<p>--offset, -o start offset in the backend device (in
512-byte sectors). This option is only relevant for create
action.</p>

<p>--skip, -p how many sectors of the encrypted data to
skip at the beginning. This is different from the --offset
options with respect to IV calculations. Using --offset will
shift the IV calculation by the same negative amount. Hence,
if --offset n, sector n will be the first sector on the
mapping with IV 0. Using --skip would have resulted in
sector n being the first sector also, but with IV n. This
option is only relevant for create action.</p>

<p>--readonly set up a read-only mapping.</p>

<p>--iter-time, -i The number of milliseconds to spend with
PBKDF2 password pro- cessing. This option is only relevant
to the LUKS operations as luksFormat or luksAddKey.</p>

<p>--batch-mode, -q Do not ask for confirmation. Use with
care! This option is only relevant for luksFormat,
luksAddKey, luksRemoveKey or luksKill- Slot.</p>

<p>--timeout, -t The number of seconds to wait before
timeout. This option is relevant every time a password is
asked, like create, luksOpen, luksFormat or luksAddKey. It
has no effect if used in conjunc- tion with --key-file.</p>

<p>--tries, -T How often the input of the passphrase shall
be retried. This option is relevant every time a password is
asked, like create, luksOpen, luksFormat or luksAddKey. The
default is 3 tries.</p>

<p>--align-payload=value Align payload at a boundary of
value 512-byte sectors. This option is relevant for
luksFormat. If not specified, cryptsetup tries to use
topology info provided by kernel for underlying device to
get optimal alignment. If not available (or calcu- lated
value is multiple of default) data is by default aligned to
1 MiB boundary (2048 512-byte sectors).</p>

<p>--uuid=UUID Use provided UUID in luksFormat command
instead of generating new one or change existing UUID in
luksUUID command.</p>

<p>The UUID must be provided in standard UUID format (e.g.
12345678-1234-1234-1234-123456789abc).</p>

<p>--version Show the version.</p>

<p>NOTES ON PASSWORD PROCESSING From a terminal: Password
processing is new-line sensitive, meaning the reading will
stop after encountering 0 It will process the read mate-
rial (without newline) with the default hash or the hash
given by --hash. After hashing, it will be cropped to the
key size given by -s.</p>

<p>From stdin: Reading will continue until EOF (so using
e.g. /dev/random as stdin will not work), with the trailing
newline stripped. After that the read data will be hashed
with the default hash or the hash given by --hash and the
result will be cropped to the keysize given by -s. If
&quot;plain&quot; is used as an argument to the hash option,
the input data will not be hashed. Instead, it will be zero
padded (if shorter than the keysize) or truncated (if longer
than the keysize) and used directly as the key. No warning
will be given if the amount of data read from stdin is less
than the keysize.</p>

<p>From a key file: It will be cropped to the size given by
-s. If there is insufficient key material in the key file,
cryptsetup will quit with an error.</p>

<p>If --key-file=- is used for reading the key from stdin,
no trailing newline is stripped from the input. Without that
option, cryptsetup strips trailing newlines from stdin
input.</p>

<p>NOTES ON PASSWORD PROCESSING FOR LUKS LUKS uses PBKDF2
to protect against dictionary attacks (see RFC 2898).</p>

<p>LUKS will always do an exhaustive password reading.
Hence, password can not be read from /dev/random, /dev/zero
or any other stream that does not terminate.</p>

<p>For any password creation action (luksAddKey, or
luksFormat), the user may specify how much the time the
password processing should consume. Increasing the time will
lead to a more secure password, but also will take luksOpen
longer to complete. The default setting of one second is
sufficient for good security.</p>

<p>INCOHERENT BEHAVIOUR FOR INVALID PASSWORDS/KEYS LUKS
checks for a valid password or key when an encrypted
partition is unlocked. Thus the luksOpen action fails with
invalid password or key, contrary to the plain dm-crypt
create action.</p>

<p>Please also be sure that you are using the same keyboard
and language setting as during device format.</p>

<p>NOTES ON SUPPORTED CIPHERS, MODES, HASHES AND KEY SIZES
The available combinations of ciphers, modes, hashes and key
sizes depend on kernel support. See /proc/crypto for a list
of available options. You might need to load additional
kernel crypto modules in order to get more options.</p>

<p>For --hash option all algorithms supported by gcrypt
library are avail- able.</p>

<p>NOTES ON PASSWORDS Mathematics cant be bribed. Make sure
you keep your passwords safe. There are a few nice tricks
for constructing a fallback, when suddenly out of (or after
being) blue, your brain refuses to cooperate. These
fallbacks are possible with LUKS, as its only possible with
LUKS to have multiple passwords.</p>

<p>NOTES ON RNG Random Number Generator (RNG) used in
cryptsetup always uses kernel RNG without any modifications
or additions to data stream procudes by ker- nel (like
internal random pool operations or mixing with the other
ran- dom sources).</p>

<p>There are two types of randomness cryptsetup/LUKS needs.
One type (which always uses /dev/urandom) is used for salt,
AF splitter and for wiping removed keyslot.</p>

<p>Second type is used for volume (master) key. You can
switch between using /dev/random and /dev/urandom here, see
--use-random and --use- urandom options. Using /dev/random
on system without enough entropy sources can cause
luksFormat to block until the requested amount of random
data is gathered. See urandom(4) for more information.</p>

<p>AUTHORS cryptsetup is written by Christophe Saout
&lt;christophe@saout.de&gt; LUKS extensions, and man page by
Clemens Fruhwirth &lt;clemens@endor- phin.org&gt;</p>

<p>DEPRECATED ACTIONS The reload action is no longer
supported. Please use dmsetup(8) if you need to directly
manipulate with the device mapping table.</p>

<p>The luksDelKey was replaced with luksKillSlot.</p>

<p>REPORTING BUGS Report bugs to &lt;dm-crypt@saout.de&gt;
or Issues section on LUKS website. Please attach output of
failed command with added --debug option.</p>

<p>COPYRIGHT Copyright &copy; 2004 Christophe Saout
Copyright &copy; 2004-2006 Clemens Fruhwirth Copyright
&copy; 2009-2010 Red Hat, Inc.</p>

<p>This is free software; see the source for copying
conditions. There is NO warranty; not even for
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>

<p>SEE ALSO LUKS website,
http://code.google.com/p/cryptsetup/</p>

<p>cryptsetup CRYPTSETUP(8)</p>
<hr>
</body>
</html>
