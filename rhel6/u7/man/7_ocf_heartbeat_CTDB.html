<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:24:37 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>OCF_HEARTBEAT_CTDB(7) OCF resource agents
OCF_HEARTBEAT_CTDB(7)</p>

<p>NAME ocf_heartbeat_CTDB - CTDB Resource Agent</p>

<p>SYNOPSIS CTDB [start | stop | monitor | meta-data |
validate-all]</p>

<p>DESCRIPTION This resource agent manages CTDB, allowing
one to use Clustered Samba in a Linux-HA/Pacemaker cluster.
You need a shared filesystem (e.g. OCFS2) on which the CTDB
lock will be stored. Create /etc/ctdb/nodes containing a
list of private IP addresses of each node in the cluster,
then configure this RA as a clone. To have CTDB manage
Samba, set ctdb_manages_samba=&quot;yes&quot;. Note that
this option will be deprecated in future, in favour of
configuring a separate Samba resource.</p>

<p>For more information see
http://linux-ha.org/wiki/CTDB_(resource_agent)</p>

<p>SUPPORTED PARAMETERS ctdb_recovery_lock The location of
a shared lock file, common across all nodes. This must be on
shared storage, e.g.: /shared-fs/samba/ctdb.lock</p>

<p>(unique, required, string, no default)</p>

<p>ctdb_manages_samba Should CTDB manage starting/stopping
the Samba service for you? This will be deprecated in
future, in favor of configuring a separate Samba
resource.</p>

<p>(optional, boolean, default no)</p>

<p>ctdb_manages_winbind Should CTDB manage
starting/stopping the Winbind service for you? This will be
deprecated in future, in favor of configuring a separate
Winbind resource.</p>

<p>(optional, boolean, default no)</p>

<p>ctdb_service_smb Name of smb init script. Only necessary
if CTDB is managing Samba directly. Will usually be
auto-detected.</p>

<p>(optional, string, no default)</p>

<p>ctdb_service_nmb Name of nmb init script. Only necessary
if CTDB is managing Samba directly. Will usually be
auto-detected.</p>

<p>(optional, string, no default)</p>

<p>ctdb_service_winbind Name of winbind init script. Only
necessary if CTDB is managing Winbind directly. Will usually
be auto-detected.</p>

<p>(optional, string, no default)</p>

<p>ctdb_samba_skip_share_check If there are very many
shares it may not be feasible to check that all of them are
available during each monitoring interval. In that case this
check can be disabled.</p>

<p>(optional, boolean, default yes)</p>

<p>ctdb_monitor_free_memory If the amount of free memory
drops below this value the node will become unhealthy and
ctdb and all managed services will be shutdown. Once this
occurs, the administrator needs to find the reason for the
OOM situation, rectify it and restart ctdb with
&quot;service ctdb start&quot;.</p>

<p>(optional, integer, default 100)</p>

<p>ctdb_start_as_disabled When set to yes, the CTDB node
will start in DISABLED mode and not host any public ip
addresses.</p>

<p>(optional, boolean, default no)</p>

<p>ctdb_config_dir The directory containing various CTDB
configuration files. The &quot;nodes&quot; and
&quot;notify.sh&quot; scripts are expected to be in this
directory, as is the &quot;events.d&quot; subdirectory.</p>

<p>(optional, string, default &quot;/etc/ctdb&quot;)</p>

<p>ctdb_binary Full path to the CTDB binary.</p>

<p>(optional, string, default
&quot;/usr/bin/ctdb&quot;)</p>

<p>ctdbd_binary Full path to the CTDB cluster daemon
binary.</p>

<p>(optional, string, default
&quot;/usr/sbin/ctdbd&quot;)</p>

<p>ctdb_socket Full path to the domain socket that ctdbd
will create, used for local clients to attach and
communicate with the ctdb daemon.</p>

<p>(unique, optional, string, default
&quot;/var/lib/ctdb/ctdb.socket&quot;)</p>

<p>ctdb_dbdir The directory to put the local CTDB database
files in. Persistent database files will be put in
ctdb_dbdir/persistent.</p>

<p>(unique, optional, string, default
&quot;/var/lib/ctdb&quot;)</p>

<p>ctdb_logfile Full path to log file. To log to syslog
instead, use the value &quot;syslog&quot;.</p>

<p>(optional, string, default
&quot;/var/log/ctdb/log.ctdb&quot;)</p>

<p>ctdb_debuglevel What debug level to run at (0-10).
Higher means more verbose.</p>

<p>(optional, integer, default 2)</p>

<p>smb_conf Path to default samba config file. Only
necessary if CTDB is managing Samba.</p>

<p>(optional, string, default
&quot;/etc/samba/smb.conf&quot;)</p>

<p>smb_private_dir The directory for smbd to use for
storing such files as smbpasswd and secrets.tdb. Old
versions of CTBD (prior to 1.0.50) required this to be on
shared storage. This parameter should not be set for current
versions of CTDB, and only remains in the RA for backwards
compatibility.</p>

<p>(unique, optional, string, no default)</p>

<p>smb_passdb_backend Which backend to use for storing user
and possibly group information. Only necessary if CTDB is
managing Samba.</p>

<p>(optional, string, default &quot;tdbsam&quot;)</p>

<p>smb_idmap_backend Which backend to use for SID/uid/gid
mapping. Only necessary if CTDB is managing Samba.</p>

<p>(optional, string, default &quot;tdb2&quot;)</p>

<p>smb_fileid_algorithm Which fileid:algorithm to use with
vfs_fileid. The correct value depends on which clustered
filesystem is in use, e.g.: for OCFS2, this should be set to
&quot;fsid&quot;. Only necessary if CTDB is managing
Samba.</p>

<p>(optional, string, no default)</p>

<p>SUPPORTED ACTIONS This resource agent supports the
following actions (operations):</p>

<p>start Starts the resource. Suggested minimum timeout:
90.</p>

<p>stop Stops the resource. Suggested minimum timeout:
100.</p>

<p>monitor Performs a detailed status check. Suggested
minimum timeout: 20. Suggested interval: 10.</p>

<p>meta-data Retrieves resource agent metadata (internal
use only). Suggested minimum timeout: 5.</p>

<p>validate-all Performs a validation of the resource
configuration. Suggested minimum timeout: 30.</p>

<p>EXAMPLE The following is an example configuration for a
CTDB resource using the crm(8) shell:</p>

<p>primitive p_CTDB ocf:heartbeat:CTDB params
ctdb_recovery_lock=string op monitor timeout=&quot;20&quot;
interval=&quot;10&quot; depth=&quot;0&quot;</p>

<p>SEE ALSO
http://www.linux-ha.org/wiki/CTDB_(resource_agent)</p>

<p>AUTHOR Linux-HA contributors (see the resource agent
source for information about individual authors)</p>

<p>resource-agents 3.9.2 05/07/2015
OCF_HEARTBEAT_CTDB(7)</p>
<hr>
</body>
</html>
