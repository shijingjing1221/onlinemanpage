<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:05:00 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>AUDIT_LOG_USER_COMMAND(3) Linux Audit API
AUDIT_LOG_USER_COMMAND(3)</p>

<p>NAME audit_log_user_command - log a user command</p>

<p>SYNOPSIS #include &lt;libaudit.h&gt;</p>

<p>int audit_log_user_command(int audit_fd, int type, const
char *command, const char *tty, int result);</p>

<p>DESCRIPTION This function will log a command to the
audit system using a predefined message format. It encodes
the command as the audit system expects for untrusted
strings. This function should be used by all apps need to
record commands. The function parameters are as follows:</p>

<p>audit_fd - The fd returned by audit_open type - type of
message, ex: AUDIT_USYS_CONFIG, AUDIT_USER_LOGIN command -
the command being logged tty - The tty of the user, if NULL
will attempt to figure out result - 1 is &quot;success&quot;
and 0 is &quot;failed&quot;</p>

<p>RETURN VALUE It returns the sequence number which is
&gt; 0 on success or &lt;= 0 on error.</p>

<p>ERRORS This function returns -1 on failure. Examine
errno for more info.</p>

<p>SEE ALSO audit_log_user_message(3),
audit_log_user_comm_message(3), audit_log_acct_message(3),
audit_log_user_avc_message(3),
audit_log_semanage_message(3).</p>

<p>AUTHOR Steve Grubb</p>

<p>Red Hat Feb 2007 AUDIT_LOG_USER_COMMAND(3)</p>
<hr>
</body>
</html>
