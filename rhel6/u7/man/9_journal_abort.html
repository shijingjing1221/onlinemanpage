<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:20:22 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>JOURNAL_ABORT(9) The Linux Journalling API
JOURNAL_ABORT(9)</p>

<p>NAME journal_abort - Shutdown the journal
immediately.</p>

<p>SYNOPSIS void journal_abort(journal_t * journal, int
errno);</p>

<p>ARGUMENTS journal the journal to shutdown.</p>

<p>errno an error number to record in the journal
indicating the reason for the shutdown.</p>

<p>DESCRIPTION Perform a complete, immediate shutdown of
the ENTIRE journal (not of a single transaction). This
operation cannot be undone without closing and reopening the
journal.</p>

<p>The journal_abort function is intended to support higher
level error recovery mechanisms such as the ext2/ext3
remount-readonly error mode.</p>

<p>Journal abort has very specific semantics. Any existing
dirty, unjournaled buffers in the main filesystem will still
be written to disk by bdflush, but the journaling mechanism
will be suspended immediately and no further transaction
commits will be honoured.</p>

<p>Any dirty, journaled buffers will be written back to
disk without hitting the journal. Atomicity cannot be
guaranteed on an aborted filesystem, but we _do_ attempt to
leave as much data as possible behind for fsck to use for
cleanup.</p>

<p>Any attempt to get a new transaction handle on a journal
which is in ABORT state will just result in an -EROFS error
return. A journal_stop on an existing handle will return
-EIO if we have entered abort state during the update.</p>

<p>Recursive transactions are not disturbed by journal
abort until the final journal_stop, which will receive the
-EIO error.</p>

<p>Finally, the journal_abort call allows the caller to
supply an errno which will be recorded (if possible) in the
journal superblock. This allows a client to record failure
conditions in the middle of a transaction without having to
complete the transaction to record the failure to disk.
ext3_error, for example, now uses this functionality.</p>

<p>Errors which originate from within the journaling layer
will NOT supply an errno; a null errno implies that
absolutely no further writes are done to the journal (unless
there are any already in progress).</p>

<p>AUTHORS Roger Gammans
&lt;rgammans@computer-surgery.co.uk&gt; Author.</p>

<p>Stephen Tweedie &lt;sct@redhat.com&gt; Author.</p>

<p>COPYRIGHT Kernel Hackers Manual 2.6. July 2015
JOURNAL_ABORT(9)</p>
<hr>
</body>
</html>
