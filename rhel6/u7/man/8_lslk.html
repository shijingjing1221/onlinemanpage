<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:22:08 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>LSLK(8) LSLK(8)</p>

<p>NOTICE !!!NOTICE!!! !!!NOTICE!!! !!!NOTICE!!!
!!!NOTICE!!! !!!NOTICE!!!! ! ! ! Revision 1.29 represents
the end of life for lslk. I dont have time ! ! to support
it. Please dont report bugs to me. I will politely ! !
decline to work on them. ! ! ! ! Vic Abell
&lt;abe@purdue.edu&gt;, July 11, 2001 ! ! ! !!!NOTICE!!!
!!!NOTICE!!! !!!NOTICE!!! !!!NOTICE!!! !!!NOTICE!!!!</p>

<p>NAME lslk - list local locks</p>

<p>SYNOPSIS lslk [ -abhnOvw ] [ -i i ] [ -k k ] [ -p p ] [
-S [t] ] [ paths ]</p>

<p>DESCRIPTION Lslk revision 1.29 lists information about
locks held on files with local inodes on systems running the
following UNIX dialects:</p>

<p>AIX 3.2.5, 4.1.4, 4.2[.1], and AIX 4.3[.[12]] DEC OSF/1,
Digital UNIX, and Tru64 UNIX [2345].[01] and 3.2 Linux SCO
OpenDesktop or OpenServer 3.0 and 5.0.[0245] Sequent PTX
2.1.9, 4.2.1, 4.3, and 4.4 Solaris 2.[345], 2.5.1, 2.6, 7,
and 8 (excluding Veritas VxFS local files) SunOS 4.1.3</p>

<p>The lock may belong to a process on the local system or
to a process on an NFS client system to which the local
system is an NFS server. Notes: Linux and PTX 2.1.9 lslk
dont report on locks held by NFS clients; Solaris lslk wont
report locks held on local Veritas VxFS files.</p>

<p>OPTIONS In the absence of any options, lslk lists all
locks associated with the local files of the system.</p>

<p>When selection options are specified, the listing of all
locks is dis- abled, and the selection options are ORed
together. Only locks meeting any selection criterion are
listed.</p>

<p>When the -a option is specified, the listing of all
locks is disabled, and the selection options are ANDed
together. Only locks that meet all selection criteria are
listed.</p>

<p>-a This option causes list selection options to be
ANDed, as described above.</p>

<p>-b This option causes lslk to avoid kernel functions
that might block - lstat(2), readlink(2), and stat(2).</p>

<p>See the BLOCKS AND TIMEOUTS and AVOIDING KERNEL BLOCKS
sec- tions for information on using this option.</p>

<p>-i i This option selects the listing of locks whose
owning process is on the Internet host whose name or network
address is i.</p>

<p>Multiple addresses may be declared with multiple -i i
options.</p>

<p>-k k This option specifies k as an alternate to the
default kernel name list file path. The default kernel name
list file path is listed in the -h help output.</p>

<p>It may be necessary to specify an alternate kernel name
list path when the file at the default path isn t the booted
kernel -- e.g., the default is /vmunix, but the booted
kernel file is /vmunix.new.</p>

<p>Unless lslk accesses the correct kernel name list file,
it may derive incorrect addresses for symbols in kernel
memory, caus- ing it to fail.</p>

<p>-n This option inhibits the conversion of network host
names to network addresses and the conversion of network
addresses to network host names.</p>

<p>This option may be useful when the host name to address
trans- lation service (e.g., the Domain Name Server) is slow
or inop- erative.</p>

<p>If you use this option on hosts whose kernel lock table
con- tains only host names - e.g., SCO or Solaris - or you
use this option and also select the listing of locks by an
Internet network address with the -i i option, lslk will not
be able to locate any locks with the specified network
address, nor will it be able to report network addresses in
its output. The -n option inhibits the necessary conversion
of kernel lock table host names to network addresses.</p>

<p>-O This option directs lslk to bypass the strategy it
uses to avoid being blocked by some kernel operations -
i.e., doing them in forked child processes. See the BLOCKS
AND TIMEOUTS and AVOIDING KERNEL BLOCKS sections for more
information on kernel operations that may block lslk.</p>

<p>-p p This option selects the listing of locks whose
owning process IDentification (PID) numbers are in the
comma-separated list, p.</p>

<p>-S [t] This option specifies an optional time-out
seconds value for kernel functions - lstat(2), readlink(2),
and stat(2) - that might otherwise deadlock. The minimum for
t is two; the default, fifteen; when no value is specified,
the default is used.</p>

<p>See the BLOCKS AND TIMEOUTS section for more
information.</p>

<p>-v When this option is specified, lslk lists version
information - i.e., where, when and how it was
constructed.</p>

<p>-w This option suppresses non-fatal warning
messages.</p>

<p>paths This option specifies a list of file path names
for which lslk is to list lock information.</p>

<p>OUTPUT Lslk lists the information for each lock on a
separate line in the fol- lowing columns. (The columns are
dynamically sized.)</p>

<p>SRC indicates the source of the process holding the
lock.</p>

<p>If the source is a local process, its command name is
dis- played, or (unknown) if the command name cant be deter-
mined.</p>

<p>If the source is a remote process, the host name or
network number where the remote process executes is
displayed.</p>

<p>PID is the Process IDentification number of the process
holding the lock.</p>

<p>DEV is the device (major and minor numbers) on which the
locked file resides.</p>

<p>INUM is the inode number of the locked file.</p>

<p>SZ is the size of the locked file.</p>

<p>TY is the lock type: r read; rw read and write; w write;
? unknown.</p>

<p>M is the mandatory state of the lock: 0 if none; 1 if
set. (See chmod(1)).</p>

<p>ST is the relative byte offset of the lock.</p>

<p>WH is the starting offset (whence) of the lock.</p>

<p>END is the ending offset of the lock.</p>

<p>LEN is the length of the lock.</p>

<p>NAME is the name of the locked file, if it was specified
as a path argument.</p>

<p>If there is no path argument name, then the mount point
and device paths of the file system on which the locked file
resides are displayed.</p>

<p>BLOCKS AND TIMEOUTS Lslk can be blocked by some kernel
functions that it uses - lstat(2), readlink(2), and stat(2).
These functions are stalled in the kernel, for example, when
the hosts where mounted NFS file systems reside become
inaccessible.</p>

<p>Lslk attempts to break these blocks with timers and
child processes, but the techniques are not wholly reliable.
When lslk does manage to break a block, it will report the
break with an error message. The messages may be suppressed
with the -w option.</p>

<p>The default timeout value may be displayed with the -h
option, and it may be changed with the -S [t] option. The
minimum for t is two sec- onds, but you should avoid small
values, since slow system responsive- ness can cause short
timeouts to expire unexpectedly and perhaps stop lslk before
it can produce any output.</p>

<p>When lslk has to break a block during its access of
mounted file system information, it normally continues,
although with less information available to display about
open files.</p>

<p>Lslk can also be directed to avoid the protection of
timers and child processes when using the kernel functions
that might block by specify- ing the -O option. While this
will allow lslk to start up with less overhead, it exposes
lslk completely to the kernel situations that might block
it. Use this option cautiously.</p>

<p>AVOIDING KERNEL BLOCKS You can use the -b option to tell
lslk to avoid using kernel functions that would block. Some
cautions apply.</p>

<p>First, using this option usually requires that your
system supply alternate device numbers in place of the
device numbers that lslk would normally obtain with the
lstat(2) and stat(2) kernel functions. See the ALTERNATE
DEVICE NUMBERS section for more information on alternate
device numbers.</p>

<p>Second, you cant specify the names of files you want
lslk to locate locks for unless they re file system names.
This is because lslk needs to know the device and inode
numbers of files listed with names in the lslk options, and
the -b option prevents lslk from obtaining them. Moreover,
since lslk only has device numbers for the file systems that
have alternates, its ability to locate locks on file systems
depends completely on the availability and accuracy of the
alternates. If no alternates are available, or if theyre
incorrect, lslk won t be able to locate locks on the named
file systems.</p>

<p>Third, if the names of your file system directories that
lslk obtains from your systems mount table are symbolic
links, lslk won t be able to resolve the links. This is
because the -b option causes lslk to avoid the kernel
readlink(2) function it uses to resolve symbolic links.</p>

<p>Finally, using the -b option causes lslk to issue
warning messages when it needs to use the kernel functions
that the -b option directs it to avoid. You can suppress
these messages by specifying the -w option, but if you do,
you wont see the alternate device numbers reported in the
warning messages.</p>

<p>ALTERNATE DEVICE NUMBERS On some dialects, when lslk has
to break a block because it cant get information about a
mounted file system via the lstat(2) and stat(2) kernel
functions, or because you specified the -b option, lslk can
obtain some of the information it needs - the device number
and possi- bly the file system type - from the system mount
table. When that is possible, lslk will report the device
number it obtained. (You can suppress the report by
specifying the -w option.)</p>

<p>You can assist this process if your mount table is
supported with an /etc/mtab or /etc/mnttab file that
contains an options field by adding a dev=xxxx field for
mount points that do not have one in their options
strings.</p>

<p>The xxxx portion of the field is the hexadecimal value
of the file systems device number. (Consult the st_dev field
of the output of the lstat(2) and stat(2) functions for the
appropriate values for your file systems.) Here s an example
from a Solaris 2.5 /etc/mnttab for a UFS file system:</p>

<p>... ufs suid,rw,dev=80001f ...</p>

<p>Some dialects that do not use an ASCII /etc/mtab or
/etc/mnttab file for the mount table may still provide an
alternative device number in their internal mount tables.
This includes AIX, DEC OSF/1, Digital UNIX, and Tru64 UNIX.
Lslk knows how to obtain the alternative device number for
these dialects and uses it when its attempt to lstat(2) or
stat(2) the file system is blocked.</p>

<p>If youre not sure your dialect supplies alternate device
numbers for file systems from its mount table, use this lslk
incantation to see if it reports any alternate device
numbers:</p>

<p>lslk -b</p>

<p>Look for standard error file warning messages that begin
assuming &quot;dev=xxxx&quot; from ....</p>

<p>DIAGNOSTICS Errors are identified with messages on the
standard error file.</p>

<p>Lslk returns a one (1) if an error was detected or if it
couldnt list lock information for all the names that were
specified.</p>

<p>EXAMPLES To list all locks, use:</p>

<p>lslk</p>

<p>To list locks from the host klaatu in the local domain,
use:</p>

<p>lslk -i klaatu</p>

<p>To list locks from the hosts helios.cc.purdue.edu and
vic1.cc.pur- due.edu, use:</p>

<p>lslk -i helios.cc.purdue.edu -i vic1.cc.purdue.edu</p>

<p>To list locks held by processes 1234 and 56789, use:</p>

<p>lslk -p 1234,56789</p>

<p>To list all locks held by process 1234 on host klaatu,
use:</p>

<p>lslk -p 1234 -a -i klaatu</p>

<p>PERMISSION Lslk must have permission to access the
system memory files - e.g., /dev/kmem and /dev/mem.
Permission to do that is granted when the lslk process is
run from a root shell, or when its setgid group matches the
group (e.g., sys) that can read the system memory files.</p>

<p>BUGS Perhaps it should be possible to specify the host
on which a search target PID is located.</p>

<p>DEC OSF/1, Digital UNIX, and Tru64 UNIX lslk wont find
locks applied with the flock(2) function. It will find locks
applied with the fcntl(2) and lockf(3) functions.</p>

<p>Linux lslk will not report locks held by NFS clients. It
may have dif- ficulty reporting locks held on dynamic inodes
(e.g., for the Win-95 file system type, smbfs).</p>

<p>Solaris lslk wont find locks held on local Veritas VxFS
files by local or remote processes.</p>

<p>FILES /dev/kmem kernel virtual memory device</p>

<p>/dev/mem physical memory device</p>

<p>AUTHORS Lslk was written by Victor A. Abell
&lt;abe@purdue.edu&gt; of the Purdue Uni- versity Computing
Center (PUCC).</p>

<p>Chris Eleveld &lt;chris@sector7.com&gt; did the DEC
OSF/1, Digital UNIX, Linux, and Tru64 UNIX ports.</p>

<p>SEE ALSO chmod(1), fcntl(2), fcntl(5), flock(3B),
lockd(1M), lstat(2), lockf(3C), readlink(2), stat(2).</p>

<p>Revision-1.29 LSLK(8)</p>
<hr>
</body>
</html>
