<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:04:04 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>aide.conf(5) aide.conf(5)</p>

<p>NAME aide.conf - The configuration file for Advanced
Intrusion Detection Environment</p>

<p>SYNOPSIS aide.conf is the configuration file for
Advanced Intrusion Detection Environment. aide.conf contains
the runtime configuration aide uses to initiailize or check
the aide database.</p>

<p>FILE FORMAT aide.conf is similar in to Tripwire(tm)s
configuration file. With lit- tle effort tw.conf can be
converted to aide.conf.</p>

<p>aide.conf is case-sensitive. Leading and trailing
whitespaces are ignored.</p>

<p>There are three types of lines in aide.conf. First there
are the con- figuration lines which are used to set
configuration parameters and define/undefine variables.
Second, there are selection lines that are used to indicate
which files are added to the database. Third, macro lines
define or undefine variables within the config file. Lines
begin- ning with # are ignored as comments.</p>

<p>CONFIG LINES These lines have the format
parameter=value. See URLS for a list of valid urls.</p>

<p>database The url from which database is read. There can
only be one of these lines. If there are multiple database
lines then the first is used. The default value is
&quot;/usr/etc/aide.db&quot;.</p>

<p>database_out The url to which the new database is
written to. There can only be one of these lines. If there
are multiple database_out lines then the first is used. The
default value is &quot;/usr/etc/aide.db.new&quot;.</p>

<p>database_new The url from which the other database for
--compare is read. There is no default for this one.</p>

<p>verbose The level of messages that is output. This value
can be 0-255 inclusive. This parameter can only be given
once. Value from the first occurence is used. If --verbose
or -V is used then the value from that is used. The default
is 5. If verbosity is 20 then additional report output is
written when doing --check, --update or --compare.</p>

<p>report_url The url that the output is written to. There
can be multiple instances of this parameter. Output is
written to all of them. The default is stdout.</p>

<p>gzip_dbout Whether the output to the database is gzipped
or not. Valid val- ues are yes,true,no and false. The
default is no. This option is available only if zlib support
is compiled in.</p>

<p>acl_no_symlink_follow Whether to check ACLs for symlinks
or not. Valid values are yes,true,no and false. The default
is to follow symlinks. This option is available only if acl
support is compiled in.</p>

<p>warn_dead_symlinks Whether to warn about dead symlinks
or not. Valid values are yes,true,no and false. The default
is not to warn about dead symlinks.</p>

<p>summarize_changes Whether to summarize changes in the
added, removed and changed files sections of the report or
not. Valid values are yes,true,no and false. The default is
not to summarize the changes.</p>

<p>The general format is like the string YlZbpugamcinCAXS,
where Y is replaced by the file-type (f for a regular file,
d for a directory, L for a symbolic link, D for a character
device, B for a block device, F for a FIFO, s for a unix
socket and ? oth- erwise).</p>

<p>The Z is replaced as follows: A = means that the size
has not changed, a &lt; reports a shrinked size and a &gt;
reports a grown size.</p>

<p>The other letters in the string are the actual letters
that will be output if the associated attribute for the item
has been changed or a &quot;.&quot; for no change, a
&quot;+&quot; if the attribute has been added, a
&quot;-&quot; if it has been removed, a &quot;:&quot; if the
attribute is listed in ignore_list or a &quot; &quot; if the
attribute has not been checked. The exceptions to this are:
(1) a newly created file replaces each letter with a
&quot;+&quot;, and (2) a removed file replaces each letter
with a &quot;-&quot;.</p>

<p>The attribute that is associated with each letter is as
follows:</p>

<p>o A l means that the link name has changed.</p>

<p>o A b means that the block count has changed.</p>

<p>o A p means that the permissions have changed.</p>

<p>o An u means that the uid has changed.</p>

<p>o A g means that the gid has changed.</p>

<p>o An a means that the access time has changed.</p>

<p>o A m means that the modification time has changed.</p>

<p>o A c means that the change time has changed.</p>

<p>o An i means that the inode has changed.</p>

<p>o A n means that the link count has changed.</p>

<p>o A C means that one or more checksums have changed.</p>

<p>o A A means that the access control list has
changed.</p>

<p>o A X means that the extended attributes have
changed.</p>

<p>o A S means that the SELinux attributes have
changed.</p>

<p>report_attributes Special group definition that lists
parameters which are always printed in the final report for
changed files.</p>

<p>ignore_list Special group definition that lists
parameters which are to be ignored from the final
report.</p>

<p>config_version The value of config_version is printed in
the report and also printed to the database. This is for
informational purposes only. It has no other
functionality.</p>

<p>Group definitions If the parameter is not one of the
previous parameters then it is regarded as a group
definition. Value is then regarded as an expression.
Expression is of the following form.</p>

<p>&lt;predefined group&gt;| &lt;expr&gt; + &lt;predefined
group&gt; | &lt;expr&gt; - &lt;predifined group&gt;</p>

<p>See DEFAULT GROUPS for an explanation of default
predefined groups. Note that this is different from the way
Tripwire(tm) does it.</p>

<p>There is also a special group named
&quot;ignore_list&quot;. The prede- fined -groups listed in
it are NOT displayed in the final report.</p>

<p>SELECTION LINES aide supports three types of selection
lines (regular, negative, equals) Lines beginning with
&quot;/&quot; are regular selection lines. Lines beginning
with &quot;=&quot; are equals selection lines. And lines
beginning with &quot;!&quot; are negative selection lines.
The string following the first char- acter is taken as a
regular expression matching to a complete filename,
including the path. In a regular selection rule the
&quot;/&quot; is included in the regular expression.
Following the regular expression is a group definition as
explained above. See EXAMPLES and doc/aide.conf for exam-
ples.</p>

<p>More in-depth discussion of the selection algorithm can
be found in the aide manual.</p>

<p>MACRO LINES @@define VAR val Define variable VAR to
value val.</p>

<p>@@undef VAR Undefine variable VAR.</p>

<p>@@ifdef VAR, @@ifndef VAR @@ifdef begins an if
statement. It must be terminated with an @@endif statement.
The lines between @@ifdef and @@endif are used if variable
VAR is defined. If there is an @@else statement then the
part between @@ifdef and @@else is used is VAR is defined
otherwise the part between @@else and @@endif is used.
@@ifndef reverses the logic of @@ifdef statement but
otherwise works similarly.</p>

<p>@@ifhost hostname, @@ifnhost hostname @@ifhost works
like @@ifdef only difference is that it checks whether
hostname equals the name of the host that aide is running
on. hostname is the name of the host without the domainname
(hostname, not hostname.aide.org).</p>

<p>@@{VAR} @@{VAR} is replaced with the value of the
variable VAR. If variable VAR is not defined an empty string
is used. Unlike Tripwire(tm) @@VAR is NOT supported. One
special VAR is @@{HOST- NAME} which is substituted for the
hostname of the current sys- tem.</p>

<p>@@else Begins the else part of an if statement.</p>

<p>@@endif Ends an if statement.</p>

<p>@@include VAR Includes the file VAR. The content of the
file is used as if it were inserted in this part of the
config file.</p>

<p>URLS Urls can be one of the following. Input urls cannot
be used as outputs and vice versa.</p>

<p>stdout</p>

<p>stderr Output is sent to stdout,stderr respectively.</p>

<p>stdin Input is read from stdin.</p>

<p>file://filename Input is read from filename or output is
written to filename.</p>

<p>fd:number Input is read from filedescriptor number or
output is written to number.</p>

<p>DEFAULT GROUPS p: permissions</p>

<p>i: inode</p>

<p>l: link name</p>

<p>n: number of links</p>

<p>u: user</p>

<p>g: group</p>

<p>s: size</p>

<p>b: block count</p>

<p>m: mtime</p>

<p>a: atime</p>

<p>c: ctime</p>

<p>S: check for growing size</p>

<p>I: ignore changed filename</p>

<p>ANF: allow new files</p>

<p>ARF: allow removed files</p>

<p>md5: md5 checksum</p>

<p>sha1: sha1 checksum</p>

<p>sha256: sha256 checksum</p>

<p>sha512: sha512 checksum</p>

<p>rmd160: rmd160 checksum</p>

<p>tiger: tiger checksum</p>

<p>haval: haval checksum</p>

<p>crc32: crc32 checksum</p>

<p>R: p+i+l+n+u+g+s+m+c+md5</p>

<p>L: p+i+l+n+u+g</p>

<p>E: Empty group</p>

<p>&gt;: Growing logfile p+l+u+g+i+n+S</p>

<p>And also the following if you have mhash support
enabled</p>

<p>gost: gost checksum</p>

<p>whirlpool: whirlpool checksum</p>

<p>The followingg is available when explicitly enabled
using configure</p>

<p>acl: access control list</p>

<p>selinux: selinux attributes</p>

<p>xattrs: extended attributes</p>

<p>Please note that I and c are incompatible. When the name
of a file is changed, its ctime is updated as well. When you
put c and I in the same rule the, a changed ctime is
silently ignored.</p>

<p>When ANF is used, new files are added to the new
database, but are ignored in the report.</p>

<p>When ARF is used, files missing on disk are omitted from
the new database, but are ignored in the report.</p>

<p>EXAMPLES / R</p>

<p>This adds all files on your machine to the database.
This is one line is a fully qualified configuration
file.</p>

<p>!/dev</p>

<p>This ignores the /dev directory structure.</p>

<p>=/tmp</p>

<p>Only /tmp is taken into the database. None of its
children are added.</p>

<p>All=p+i+n+u+g+s+m+c+a+md5+sha1+tiger+rmd160</p>

<p>This line defines group All. It has all attributes and
all md checksum functions. If you absolutely want all digest
functions then you should enable mhash support and add
+crc32+haval+gost to the end of the defi- nition for All.
Mhash support can only be enabled at compile-time.</p>

<p>HINTS =/foo p+i+l+n+u+g+s+m+c+md5</p>

<p>/foo/bar p+i+l+n+u+g+s+m+c+md5</p>

<p>This config adds all files under /foo because they match
to regex /foo, which is equivalent to /foo.* . What you
probably want is:</p>

<p>=/foo$ p+i+l+n+u+g+s+m+c+md5</p>

<p>/foo/bar p+i+l+n+u+g+s+m+c+md5</p>

<p>Note that the following still works as expected because
=/foo$ stop recuring of directory /foo.</p>

<p>=/foo p+i+l+n+u+g+s+m+c+md5</p>

<p>In the following, the first is not allowed in AIDE. Use
the latter instead.</p>

<p>/foo epug</p>

<p>/foo e+p+u+g</p>

<p>SEE ALSO aide(1)
http://www.cs.tut.fi/~rammer/aide/manual.html</p>

<p>DISCLAIMER All trademarks are the property of their
respective owners. No animals were harmed while making this
webpage or this piece of software.</p>

<p>aide.conf(5)</p>
<hr>
</body>
</html>
