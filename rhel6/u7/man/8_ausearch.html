<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:05:07 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>AUSEARCH:(8) System Administration Utilities
AUSEARCH:(8)</p>

<p>NAME ausearch - a tool to query audit daemon logs</p>

<p>SYNOPSIS ausearch [options]</p>

<p>DESCRIPTION ausearch is a tool that can query the audit
daemon logs based for events based on different search
criteria. The ausearch utility can also take input from
stdin as long as the input is the raw log data. Each
commandline option given forms an &quot;and&quot; statement.
For example, searching with -m and -ui means return events
that have both the requested type and match the user id
given. An exception is the -n option; multiple nodes are
allowed in a search which will return any matching node.</p>

<p>It should also be noted that each syscall excursion from
user space into the kernel and back into user space has one
event ID that is unique. Any auditable event that is
triggered during this trip share this ID so that they may be
correlated.</p>

<p>Different parts of the kernel may add supplemental
records. For exam- ple, an audit event on the syscall
&quot;open&quot; will also cause the kernel to emit a PATH
record with the file name. The ausearch utility will present
all records that make up one event together. This could mean
that even though you search for a specific kind of record,
the result- ing events may contain SYSCALL records.</p>

<p>Also be aware that not all record types have the
requested information. For example, a PATH record does not
have a hostname or a loginuid.</p>

<p>OPTIONS -a, --event audit-event-id Search for an event
based on the given event ID. Messages always start with
something like msg=audit(1116360555.329:2401771). The event
ID is the number after the :. All audit events that are
recorded from one applications syscall have the same audit
event ID. A second syscall made by the same application will
have a different event ID. This way they are unique.</p>

<p>--arch CPU Search for events based on a specific CPU
architecture. If you do not know the arch of your machine
but you want to use the 32 bit syscall table and your
machine supports 32 bits, you can also use b32 for the arch.
The same applies to the 64 bit syscall table, you can use
b64. The arch of your machine can be found by doing uname
-m.</p>

<p>-c, --comm comm-name Search for an event based on the
given comm name. The comm name is the executables name from
the task structure.</p>

<p>--debug Write malformed events that are skipped to
stderr.</p>

<p>--checkpoint checkpoint-file Checkpoint the output
between successive invocations of ausearch such that only
events not previously output will print in subse- quent
invocations.</p>

<p>An auditd event is made up of one or more records. When
processing events, ausearch defines events as either
complete or in-complete. A complete event is either a single
record event or one whose event time occurred 2 seconds in
the past compared to the event being currently
processed.</p>

<p>A checkpoint is achieved by recording the last completed
event output along with the device number and inode of the
file the last completed event appeared in checkpoint-file.
On a subse- quent invocation, ausearch will load this
checkpoint data and as it processes the log files, it will
discard all complete events until it matches the
checkpointed one. At this point, it will start outputting
complete events.</p>

<p>Should the file or the last checkpointed event not be
found, one of a number of errors will result and ausearch
will terminate. See EXIT STATUS for detail.</p>

<p>-e, --exit exit-code-or-errno Search for an event based
on the given syscall exit code or errno.</p>

<p>-f, --file file-name Search for an event based on the
given filename.</p>

<p>-ga, --gid-all all-group-id Search for an event with
either effective group ID or group ID matching the given
group ID.</p>

<p>-ge, --gid-effective effective-group-id Search for an
event with the given effective group ID or group name.</p>

<p>-gi, --gid group-id Search for an event with the given
group ID or group name.</p>

<p>-h, --help Help</p>

<p>-hn, --host host-name Search for an event with the given
host name. The hostname can be either a hostname, fully
qualified domain name, or numeric network address. No
attempt is made to resolve numeric addresses to domain names
or aliases.</p>

<p>-i, --interpret Interpret numeric entities into text.
For example, uid is con- verted to account name. The
conversion is done using the current resources of the
machine where the search is being run. If you have renamed
the accounts, or dont have the same accounts on your
machine, you could get misleading results.</p>

<p>-if, --input file-name | directory Use the given file or
directory instead of the logs. This is to aid analysis where
the logs have been moved to another machine or only part of
a log was saved.</p>

<p>--input-logs Use the log file location from auditd.conf
as input for search- ing. This is needed if you are using
ausearch from a cron job.</p>

<p>--just-one Stop after emitting the first event that
matches the search cri- teria.</p>

<p>-k, --key key-string Search for an event based on the
given key string.</p>

<p>-l, --line-buffered Flush output on every line. Most
useful when stdout is connected to a pipe and the default
block buffering strategy is undesir- able. May impose a
performance penalty.</p>

<p>-m, --message message-type | comma-sep-message-type-list
Search for an event matching the given message type. You may
also enter a comma separated list of message types. There is
an ALL message type that doesn t exist in the actual logs.
It allows you to get all messages in the system. The list of
valid messages types is long. The program will display the
list when- ever no message type is passed with this
parameter. The message type can be either text or numeric.
If you enter a list, there can be only commas and no spaces
separating the list.</p>

<p>-n, --node node-name Search for events originating from
node name string. Multiple nodes are allowed, and if any
nodes match, the event is matched.</p>

<p>-o, --object SE-Linux-context-string Search for event
with tcontext (object) matching the string.</p>

<p>-p, --pid process-id Search for an event matching the
given process ID.</p>

<p>-pp, --ppid parent-process-id Search for an event
matching the given parent process ID.</p>

<p>-r, --raw Output is completely unformatted. This is
useful for extracting records that can still be interpreted
by audit tools.</p>

<p>-sc, --syscall syscall-name-or-value Search for an event
matching the given syscall. You may either give the numeric
syscall value or the syscall name. If you give the syscall
name, it will use the syscall table for the machine that you
are using.</p>

<p>-se, --context SE-Linux-context-string Search for event
with either scontext/subject or tcontext/object matching the
string.</p>

<p>--session Login-Session-ID Search for events matching
the given Login Session ID. This pro- cess attribute is set
when a user logs in and can tie any pro- cess to a
particular user login.</p>

<p>-su, --subject SE-Linux-context-string Search for event
with scontext (subject) matching the string.</p>

<p>-sv, --success success-value Search for an event
matching the given success value. Legal val- ues are yes and
no.</p>

<p>-te, --end [end-date] [end-time] Search for events with
time stamps equal to or before the given end time. The
format of end time depends on your locale. If the date is
omitted, today is assumed. If the time is omitted, now is
assumed. Use 24 hour clock time rather than AM or PM to
spec- ify time. An example date using the en_US.utf8 locale
is 09/03/2009. An example of time is 18:00:00. The date
format accepted is influenced by the LC_TIME environmental
variable.</p>

<p>You may also use the word: now, recent, today,
yesterday, this-week, week-ago, this-month, this-year. Today
means starting now. Recent is 10 minutes ago. Yesterday is 1
second after mid- night the previous day. This-week means
starting 1 second after midnight on day 0 of the week
determined by your locale (see localtime). This-month means
1 second after midnight on day 1 of the month. This-year
means the 1 second after midnight on the first day of the
first month.</p>

<p>-ts, --start [start-date] [start-time] Search for events
with time stamps equal to or after the given end time. The
format of end time depends on your locale. If the date is
omitted, today is assumed. If the time is omitted, mid-
night is assumed. Use 24 hour clock time rather than AM or
PM to specify time. An example date using the en_US.utf8
locale is 09/03/2009. An example of time is 18:00:00. The
date format accepted is influenced by the LC_TIME
environmental variable.</p>

<p>You may also use the word: now, recent, today,
yesterday, this-week, this-month, this-year. Today means
starting at 1 sec- ond after midnight. Recent is 10 minutes
ago. Yesterday is 1 second after midnight the previous day.
This-week means starting 1 second after midnight on day 0 of
the week determined by your locale (see localtime).
This-month means 1 second after midnight on day 1 of the
month. This-year means the 1 second after mid- night on the
first day of the first month.</p>

<p>-tm, --terminal terminal Search for an event matching
the given terminal value. Some dae- mons such as cron and
atd use the daemon name for the terminal.</p>

<p>-ua, --uid-all all-user-id Search for an event with
either user ID, effective user ID, or login user ID (auid)
matching the given user ID.</p>

<p>-ue, --uid-effective effective-user-id Search for an
event with the given effective user ID.</p>

<p>-ui, --uid user-id Search for an event with the given
user ID.</p>

<p>-ul, --loginuid login-id Search for an event with the
given login user ID. All entry point programs that are
pamified need to be configured with pam_loginuid required
for the session for searching on loginuid (auid) to be
accurate.</p>

<p>-uu, --uuid guest-uuid Search for an event with the
given guest UUID.</p>

<p>-v, --version Print the version and exit</p>

<p>-vm, --vm-name guest-name Search for an event with the
given guest name.</p>

<p>-w, --word String based matches must match the whole
word. This category of matches include: filename, hostname,
terminal, and SE Linux con- text.</p>

<p>-x, --executable executable Search for an event matching
the given executable name.</p>

<p>EXIT STATUS 0 if OK,</p>

<p>1 if nothing found, or argument errors or minor file
acces/read errors,</p>

<p>10 invalid checkpoint data found in checkpoint file,</p>

<p>11 checkpoint processing error</p>

<p>12 checkpoint event not found in matching log file</p>

<p>SEE ALSO auditd(8), pam_loginuid(8).</p>

<p>Red Hat Sept 2009 AUSEARCH:(8)</p>
<hr>
</body>
</html>
