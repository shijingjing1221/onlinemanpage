<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:22:12 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>LVCONVERT(8) LVCONVERT(8)</p>

<p>NAME lvconvert convert a logical volume from linear to
mirror or snapshot</p>

<p>SYNOPSIS lvconvert -m|--mirrors Mirrors [--type
SegmentType] [--mirrorlog {disk|core|mirrored}] [--corelog]
[-R|--regionsize MirrorLogRegionSize] [--stripes Stripes
[-I|--stripesize StripeSize]] [-A|--alloc Alloca-
tionPolicy] [-b|--background] [-f|--force] [-i|--interval
Seconds] [--commandprofile ProfileName] [-h|-?|--help]
[--noudevsync] [-v|--ver- bose] [-y|--yes] [--version]
LogicalVolume[Path] [PhysicalVol-
ume[Path][:PE[-PE]]...]</p>

<p>lvconvert --split [--commandprofile ProfileName]
[-h|-?|--help] [--noudevsync] [-v|--verbose]
SplitableLogicalVolume{Name|Path}</p>

<p>lvconvert --splitcache|--uncache [--commandprofile
ProfileName] [-h|-?|--help] [--noudevsync] [-v|--verbose]
[--version] CacheLogi- calVolume{Name|Path}</p>

<p>lvconvert --splitmirrors Images [--name
SplitLogicalVolumeName] [--trackchanges]
MirrorLogicalVolume[Path] [--commandprofile Profile- Name]
[SplittablePhysicalVolume[Path][:PE[-PE]]...]</p>

<p>lvconvert --splitsnapshot [--commandprofile ProfileName]
[-h|-?|--help] [--noudevsync] [-v|--verbose] [--version]
SnapshotLogicalVolume[Path]</p>

<p>lvconvert -s|--snapshot [-c|--chunksize
ChunkSize[bBsSkK]] [-Z|--zero {y|n}] [--commandprofile
ProfileName] [-h|-?|--help] [--noudevsync] [-v|--verbose]
[--version] OriginalLogicalVolume[Path] SnapshotLogi-
calVolume[Path]</p>

<p>lvconvert --merge [-b|--background] [-i|--interval
Seconds] [--command- profile ProfileName] [-h|-?|--help]
[-v|--verbose] [--version] Logi- calVolume[Path]...</p>

<p>lvconvert --repair [--stripes Stripes [-I|--stripesize
StripeSize]] [--commandprofile ProfileName] [-h|-?|--help]
[-v|--verbose] [--ver- sion] LogicalVolume[Path]
[PhysicalVolume[Path]...]</p>

<p>lvconvert --replace PhysicalVolume [--commandprofile
ProfileName] [-h|-?|--help] [-v|--verbose] [--version]
LogicalVolume[Path] [Physi- calVolume[Path]...]</p>

<p>lvconvert --type thin[-pool]|-T|--thin [--originname
NewExternalOrigin- VolumeName] [--thinpool
ThinPoolLogicalVolume{Name|Path} [-c|--chunk- size
ChunkSize[bBsSkKmMgG]] [--discards
{ignore|nopassdown|passdown}] [--poolmetadata
ThinPoolMetadataLogicalVolume{Name|Path} | --poolmeta-
datasize ThinPoolMetadataSize[bBsSkKmMgG]] [-r|--readahead
{ReadAhead- Sectors|auto|none}] [--stripes Stripes
[-I|--stripesize StripeSize]]] [--poolmetadataspare {y|n}]
[-Z|--zero {y|n}]] [--commandprofile Pro- fileName]
[-h|-?|--help] [-v|--verbose] [--version] [[ExternalOri-
gin|ThinPool]LogicalVolume{Name|Path}]
[PhysicalVolume[Path][:PE [-PE]] ...</p>

<p>lvconvert --type cache[-pool]|-H|--cache [--cachepool
CachePoolLogi- calVolume{Name|Path}] [-c|--chunksize
ChunkSize[bBsSkKmMgG]] [--cachemode
{writeback|writethrough}] [--poolmetadata CachePoolMeta-
dataLogicalVolume{Name|Path} | --poolmetadatasize
CachePoolMetadata- Size[bBsSkKmMgG]] [--poolmetadataspare
{y|n}] [--commandprofile Pro- fileName] [-h|-?|--help]
[-v|--verbose] [--version] LogicalVol- ume{Name|Path}
[PhysicalVolume[Path][:PE[-PE]]...]</p>

<p>DESCRIPTION lvconvert is used to change the segment type
(i.e. linear, mirror, etc) or characteristics of a logical
volume. For example, it can add or remove the redundant
images of a logical volume, change the log type of a mirror,
or designate a logical volume as a snapshot repository. If
the conversion requires allocation of physical extents (for
example, when converting from linear to mirror) and you
specify one or more PhysicalVolumes (optionally with ranges
of physical extents), alloca- tion of physical extents will
be restricted to these physical extents. If the conversion
frees physical extents (for example, when converting from a
mirror to a linear, or reducing mirror legs) and you specify
one or more PhysicalVolumes, the freed extents come first
from the speci- fied PhysicalVolumes.</p>

<p>OPTIONS See lvm(8) for common options. Exactly one of
--cache, --corelog, --merge, --mirrorlog, --mirrors,
--repair, --replace, --snapshot, --split, --splitcache,
--splitsnap- shot, --splitmirrors, --thin, --type or
--uncache arguments is required.</p>

<p>-b, --background Run the daemon in the background.</p>

<p>-H, --cache, --type cache Converts logical volume to a
cached LV with the use of cache pool specified with
--cachepool. For more information on cache pool LVs and
cache LVs, see lvmcache(8).</p>

<p>--cachepool CachePoolLV This argument is necessary when
converting a logical volume to a cache LV. For more
information on cache pool LVs and cache LVs, see
lvmcache(8).</p>

<p>-m, --mirrors Mirrors Specifies the degree of the mirror
you wish to create. For example, &quot;-m 1&quot; would
convert the original logical volume to a mirror volume with
2-sides; that is, a linear volume plus one copy. There are
two implementations of mirroring which corre- spond to the
&quot;raid1&quot; and &quot;mirror&quot; segment types. The
default mirroring segment type is &quot;raid1&quot;. If the
legacy &quot;mirror&quot; seg- ment type is desired, the
--type argument must be used to explicitly select the
desired type. The --mirrorlog and --corelog options below
are only relevant to the legacy &quot;mirror&quot; segment
type.</p>

<p>--mirrorlog {disk|core|mirrored} Specifies the type of
log to use. The default is disk, which is persistent and
requires a small amount of storage space, usually on a
separate device from the data being mirrored. Core may be
useful for short-lived mirrors: It means the mirror is
regener- ated by copying the data from the first device
again every time the device is activated - perhaps, for
example, after every reboot. Using mirrored will create a
persistent log that is itself mirrored.</p>

<p>--corelog The optional argument --corelog is the same as
specifying --mir- rorlog core.</p>

<p>-R, --regionsize MirrorLogRegionSize A mirror is divided
into regions of this size (in MB), and the mirror log uses
this granularity to track which regions are in sync.</p>

<p>--type SegmentType Used to convert a logical volume to
another segment type, like cache, cache-pool, raid1,
snapshot, thin, or thin-pool. When converting a logical
volume to a cache LV, the --cachepool argu- ment is
required. When converting a logical volume to a thin LV, the
--thinpool argument is required. See lvmcache(7) for more
info about caching support and lvmthin(7) for thin provi-
sioning support.</p>

<p>-i, --interval Seconds Report progress as a percentage
at regular intervals.</p>

<p>--noudevsync Disables udev synchronisation. The process
will not wait for notification from udev. It will continue
irrespective of any possible udev processing in the
background. You should only use this if udev is not running
or has rules that ignore the devices LVM2 creates.</p>

<p>--splitmirrors Images The number of redundant Images of
a mirror to be split off and used to form a new logical
volume. A name must be supplied for the newly-split-off
logical volume using the --name argument, unless the
--trackchanges argument is given.</p>

<p>-n, --name Name The name to apply to a logical volume
which has been split off from a mirror logical volume.</p>

<p>--trackchanges Used with --splitmirrors on a raid1
device, this tracks changes so that the read-only detached
image can be merged efficiently back into the mirror later.
Only the regions of the detached device where the data
changed get resynchronized.</p>

<p>Please note that this feature is only supported with the
new md- based mirror implementation and not with the
original device- mapper mirror implementation.</p>

<p>--split Separates SplitableLogicalVolume. Option is
agregating various split commands and tries to detect
necessary split operation from its arguments.</p>

<p>--splitcache Separates CacheLogicalVolume from cache
pool. Before the logi- cal volume becomes uncached, cache is
flushed. The cache pool volume is then left unused and could
be used e.g. to caching another volume. See also the option
--uncache for uncaching and removing cache pool with one
command.</p>

<p>--splitsnapshot Separates SnapshotLogicalVolume from its
origin. The volume that is split off contains the chunks
that differ from the ori- gin along with the metadata
describing them. This volume can be wiped and then destroyed
with lvremove. The inverse of --snap- shot.</p>

<p>-s, --snapshot, --type snapshot Recreates a snapshot
from constituent logical volumes (or copies of them) after
having been separated using --splitsnapshot. For this to
work correctly, no changes may be made to the contents of
either volume after the split.</p>

<p>-c, --chunksize ChunkSize[bBsSkKmMgG] Gives the size of
chunk for snapshot, cache pool and thin pool logical
volumes. Default unit is in kilobytes.</p>

<p>For snapshots the value must be power of 2 between 4KiB
and 512KiB and the default value is 4.</p>

<p>For cache pools the value must be between 32KiB and 1GiB
and the default value is 64.</p>

<p>For thin pools the value must be between 64KiB and 1GiB
and the default value starts with 64 and scales up to fit
the pool meta- data size within 128MiB, if the pool metadata
size is not speci- fied. The value must be a multiple of
64KiB. (Early kernel support until thin target version 1.4
required the value to be a power of 2. Discards weren t
supported for non-power of 2 val- ues until thin target
version 1.5.)</p>

<p>--discards {ignore|nopassdown|passdown} Specifies
whether or not discards will be processed by the thin layer
in the kernel and passed down to the Physical Volume.
Options is currently supported only with thin pools. Default
is passdown.</p>

<p>-Z, --zero {y|n} Controls zeroing of the first 4KiB of
data in the snapshot. If the volume is read-only the
snapshot will not be zeroed. For thin pool volumes it
controls zeroing of provisioned blocks. Note: Provisioning
of large zeroed chunks negatively impacts performance.</p>

<p>--merge Merges a snapshot into its origin volume or
merges a raid1 image that has been split from its mirror
with --trackchanges back into its mirror.</p>

<p>To check if your kernel supports the snapshot merge
feature, look for snapshot-merge in the output of dmsetup
targets. If both the origin and snapshot volume are not open
the merge will start immediately. Otherwise, the merge will
start the first time either the origin or snapshot are
activated and both are closed. Merging a snapshot into an
origin that cannot be closed, for example a root filesystem,
is deferred until the next time the origin volume is
activated. When merging starts, the resulting logical volume
will have the origins name, minor number and UUID. While the
merge is in progress, reads or writes to the origin appear
as they were directed to the snap- shot being merged. When
the merge finishes, the merged snapshot is removed. Multiple
snapshots may be specified on the command- line or a @tag
may be used to specify multiple snapshots be merged to their
respective origin.</p>

<p>--originname NewExternalOriginVolumeName The new name
for original logical volume, which becomes external origin
volume for a thin logical volume that will use given
--thinpool. Without this option a default name of
&quot;lvol&lt;n&gt;&quot; will be gener- ated where
&lt;n&gt; is the LVM internal number of the logical volume.
This volume will be read-only and cannot be further modified
as long, as it is being used as the external origin.</p>

<p>--poolmetadata PoolMetadataLogicalVolume{Name|Path}
Specifies cache or thin pool metadata logical volume. The
size should be in between 2MiB and 16GiB. Cache pool is
specified with the option --cachepool. Thin pool is
specified with the option --thinpool. When the specified
pool already exists, the pools metadata volume will be
swapped with the given LV. Pool properties (like chunk size,
discards or zero) are preserved by default in this case. It
can be useful for pool metadata repair or its offline
resize, since the metadata volume is available as regular
volume for a user with thin provisioning tools
cache_dump(8), cache_repair(8), cache_restore(8),
thin_dump(8), thin_repair(8) and thin_restore(8).</p>

<p>--poolmetadatasize PoolMetadataSize[bBsSkKmMgG] Sets the
size of cache or thin pool s metadata logical volume, if the
pool metadata volume is undefined. Pool is specified with
the option --cachepool or --thinpool. For thin pool sup-
ported value is in the range between 2MiB and 16GiB. The
default value is estimated with this formula (Pool_LV_size /
Pool_LV_chunk_size * 64b). Default unit is megabytes.</p>

<p>--poolmetadataspare {y|n} Controls creation and
maintanence of pool metadata spare logical volume that will
be used for automated pool recovery. Only one such volume is
maintained within a volume group with the size of the
biggest pool metadata volume. Default is yes.</p>

<p>-r, --readahead {ReadAheadSectors|auto|none} Sets read
ahead sector count of thin pool metadata logical vol- ume.
The default value is &quot;auto&quot; which allows the
kernel to choose a suitable value automatically.
&quot;None&quot; is equivalent to specifying zero.</p>

<p>--repair Repair a mirror after suffering a disk failure
or try to fix thin pool metadata.</p>

<p>The mirror will be brought back into a consistent state.
By default, the original number of mirrors will be restored
if pos- sible. Specify -y on the command line to skip the
prompts. Use -f if you do not want any replacement.
Additionally, you may use --use-policies to use the device
replacement policy speci- fied in lvm.conf(5), viz.
activation/mirror_log_fault_policy or
activation/mirror_device_fault_policy.</p>

<p>Thin pool repair automates the use of thin_repair(8)
tool. Only inactive thin pool volumes can be repaired. There
is no valida- tion of metadata between kernel and lvm2. This
requires further manual work. After successfull repair the
old unmodified meta- data are still available in
&quot;&lt;pool&gt;_meta&lt;n&gt;&quot; LV.</p>

<p>--replace PhysicalVolume Remove the specified device
(PhysicalVolume) and replace it with one that is available
in the volume group or from the specific list provided. This
option is only available to RAID segment types (e.g. raid1,
raid5, etc).</p>

<p>--stripes Stripes Gives the number of stripes. This is
equal to the number of physical volumes to scatter the
logical volume. This does not apply to existing allocated
space, only newly allocated space can be striped.</p>

<p>-I, --stripesize StripeSize Gives the number of
kilobytes for the granularity of the stripes. StripeSize
must be 2^n (n = 2 to 9) for metadata in LVM1 format. For
metadata in LVM2 format, the stripe size may be a larger
power of 2 but must not exceed the physical extent size.</p>

<p>-T, --thin, --type thin Converts the logical volume into
a thin logical volume of the thin pool specified with
--thinpool. The original logical volume
ExternalOriginLogicalVolume is renamed into a new read-only
log- ical volume. For the non-default name for this volume
use --originname. The volume cannot be further modified as
long as it is used as an external origin volume for
unprovisioned areas of any thin logical volume.</p>

<p>--thinpool ThinPoolLogicalVolume{Name|Path} Specifies or
converts logical volume into a thin pools data volume.
Content of converted volume is lost. Thin pools meta- data
logical volume can be specified with the option --poolmeta-
data or allocated with --poolmetadatasize. See lvmthin(7)
for more info about thin provisioning support.</p>

<p>--uncache Uncaches CacheLogicalVolume. Before the volume
becomes uncached, cache is flushed. Unlike with --splitcache
the cache pool volume is removed. This option could seen as
an inverse of --cache.</p>

<p>Examples Converts the linear logical volume
&quot;vg00/lvol1&quot; to a two-way mirror logical
volume:</p>

<p>lvconvert -m1 vg00/lvol1</p>

<p>Converts the linear logical volume
&quot;vg00/lvol1&quot; to a two-way RAID1 log- ical
volume:</p>

<p>lvconvert --type raid1 -m1 vg00/lvol1</p>

<p>Converts a mirror with a disk log to a mirror with an
in-memory log:</p>

<p>lvconvert --mirrorlog core vg00/lvol1</p>

<p>Converts a mirror with an in-memory log to a mirror with
a disk log:</p>

<p>lvconvert --mirrorlog disk vg00/lvol1</p>

<p>Converts a mirror logical volume to a linear logical
volume:</p>

<p>lvconvert -m0 vg00/lvol1</p>

<p>Converts a mirror logical volume to a RAID1 logical
volume with the same number of images:</p>

<p>lvconvert --type raid1 vg00/mirror_lv</p>

<p>Converts logical volume &quot;vg00/lvol2&quot; to
snapshot of original volume &quot;vg00/lvol1&quot;:</p>

<p>lvconvert -s vg00/lvol1 vg00/lvol2</p>

<p>Converts linear logical volume &quot;vg00/lvol1&quot; to
a two-way mirror, using physical extents /dev/sda:0-15 and
/dev/sdb:0-15 for allocation of new extents:</p>

<p>lvconvert -m1 vg00/lvol1 /dev/sda:0-15 /dev/sdb:0-15</p>

<p>Converts mirror logical volume
&quot;vg00/lvmirror1&quot; to linear, freeing physical
extents from /dev/sda:</p>

<p>lvconvert -m0 vg00/lvmirror1 /dev/sda</p>

<p>Merges &quot;vg00/lvol1_snap&quot; into its origin:</p>

<p>lvconvert --merge vg00/lvol1_snap</p>

<p>If &quot;vg00/lvol1&quot;, &quot;vg00/lvol2&quot; and
&quot;vg00/lvol3&quot; are all tagged with
&quot;some_tag&quot; each snapshot logical volume will be
merged serially, e.g.: &quot;vg00/lvol1&quot;, then
&quot;vg00/lvol2&quot;, then &quot;vg00/lvol3&quot;. If
--background were used it would start all snapshot logical
volume merges in paral- lel.</p>

<p>lvconvert --merge @some_tag</p>

<p>Extracts one image from the mirror, making it a new
logical volume named &quot;lv_split&quot;. The mirror the
image is extracted from is reduced accordingly. If it was a
2-way mirror (created with -m 1 ), then the resulting
original volume will be linear.</p>

<p>lvconvert --splitmirrors 1 --name lv_split
vg00/lvmirror1</p>

<p>A mirrored logical volume created with --type raid1 can
use the --trackchanges argument when splitting off an image.
Detach one image from the mirrored logical volume lv_raid1
as a separate read-only device and track the changes made to
the mirror while it is detached. The split-off device has a
name of the form lv_raid1_rimage_N, where N is a number, and
it cannot be renamed.</p>

<p>lvconvert --splitmirrors 1 --trackchanges
vg00/lv_raid1</p>

<p>Merge an image that was detached temporarily from its
mirror with the --trackchanges argument back into its
original mirror and bring its contents back up-to-date.</p>

<p>lvconvert --merge vg00/lv_raid1_rimage_1</p>

<p>Replaces the physical volume &quot;/dev/sdb1&quot; in
the RAID1 logical volume &quot;my_raid1&quot; with the
specified physical volume &quot;/dev/sdf1&quot;. Had the
argument &quot;/dev/sdf1&quot; been left out, lvconvert
would attempt to find a suitable device from those available
in the volume group.</p>

<p>lvconvert --replace /dev/sdb1 vg00/my_raid1
/dev/sdf1</p>

<p>Convert the logical volume &quot;vg00/lvpool&quot; into
a thin pool with chunk size 128KiB and convert
&quot;vg00/lv1&quot; into a thin volume using this pool.
Original &quot;vg00/lv1&quot; is used as an external
read-only origin, where all writes to such volume are stored
in the &quot;vg00/lvpool&quot;.</p>

<p>lvconvert --type thin --thinpool vg00/lvpool -c 128
lv1</p>

<p>Convert the logical volume &quot;vg00/origin&quot; into
a thin volume from the thin pool &quot;vg00/lvpool&quot;.
This thin volume will use &quot;vg00/origin&quot; as an
external origin volume for unprovisioned areas in this
volume. For the read-only external origin use the new name
&quot;vg00/external&quot;.</p>

<p>lvconvert -T --thinpool vg00/lvpool --originname
external vg00/origin</p>

<p>Convert an existing logical volume to a cache pool LV
using the given cache metadata LV.</p>

<p>lvconvert --type cache-pool --poolmetadata vg00/lvx_meta
vg00/lvx_data lvrename vg00/lvx_data vg00/lvx_cachepool</p>

<p>Convert an existing logical volume to a cache LV using
the given cache pool LV and chunk size 128KiB.</p>

<p>lvconvert --cache --cachepool vg00/lvx_cachepool -c 128
vg00/lvx</p>

<p>Detach cache pool from an existing cached logical volume
&quot;vg00/lvol1&quot; and leave cache pool unused.</p>

<p>lvconvert --splitcache vg00/lvol1</p>

<p>Drop cache pool from an existing cached logical volume
&quot;vg00/lvol1&quot;.</p>

<p>lvconvert --uncache vg00/lvol1</p>

<p>SEE ALSO lvm(8), lvm.conf(5), lvmcache(7), lvmthin(7),
lvdisplay(8), lvex- tend(8), lvreduce(8), lvremove(8),
lvrename(8), lvscan(8), vgcreate(8), cache_dump(8),
cache_repair(8), cache_restore(8), thin_dump(8),
thin_repair(8), thin_restore(8)</p>

<p>Red Hat, Inc LVM TOOLS 2.02.118(2)-RHEL6 (2015-04-15)
LVCONVERT(8)</p>
<hr>
</body>
</html>
