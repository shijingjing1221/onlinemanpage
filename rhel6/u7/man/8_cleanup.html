<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:07:32 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>CLEANUP(8) CLEANUP(8)</p>

<p>NAME cleanup - canonicalize and enqueue Postfix
message</p>

<p>SYNOPSIS cleanup [generic Postfix daemon options]</p>

<p>DESCRIPTION The cleanup(8) daemon processes inbound
mail, inserts it into the incoming mail queue, and informs
the queue manager of its arrival.</p>

<p>The cleanup(8) daemon always performs the following
transformations:</p>

<p>&middot; Insert missing message headers: (Resent-)
From:, To:, Message- Id:, and Date:.</p>

<p>&middot; Transform envelope and header addresses to the
standard user@fully-qualified-domain form that is expected
by other Post- fix programs. This task is delegated to the
trivial-rewrite(8) daemon.</p>

<p>&middot; Eliminate duplicate envelope recipient
addresses.</p>

<p>The following address transformations are optional:</p>

<p>&middot; Optionally, rewrite all envelope and header
addresses according to the mappings specified in the
canonical(5) lookup tables.</p>

<p>&middot; Optionally, masquerade envelope sender
addresses and message header addresses (i.e. strip host or
domain information below all domains listed in the
masquerade_domains parameter, except for user names listed
in masquerade_exceptions). By default, address masquerading
does not affect envelope recipients.</p>

<p>&middot; Optionally, expand envelope recipients
according to information found in the virtual(5) lookup
tables.</p>

<p>The cleanup(8) daemon performs sanity checks on the
content of each message. When it finds a problem, by default
it returns a diagnostic status to the client, and leaves it
up to the client to deal with the problem. Alternatively,
the client can request the cleanup(8) daemon to bounce the
message back to the sender in case of trouble.</p>

<p>STANDARDS RFC 822 (ARPA Internet Text Messages) RFC 2045
(MIME: Format of Internet Message Bodies) RFC 2046 (MIME:
Media Types) RFC 3463 (Enhanced Status Codes) RFC 3464
(Delivery status notifications)</p>

<p>DIAGNOSTICS Problems and transactions are logged to
syslogd(8).</p>

<p>BUGS Table-driven rewriting rules make it hard to
express if then else and other logical relationships.</p>

<p>CONFIGURATION PARAMETERS Changes to main.cf are picked
up automatically, as cleanup(8) processes run for only a
limited amount of time. Use the command &quot;postfix
reload&quot; to speed up a change.</p>

<p>The text below provides only a parameter summary. See
postconf(5) for more details including examples.</p>

<p>COMPATIBILITY CONTROLS undisclosed_recipients_header
(To: undisclosed-recipients:;) Message header that the
Postfix cleanup(8) server inserts when a message contains no
To: or Cc: message header.</p>

<p>Available in Postfix version 2.1 only:</p>

<p>enable_errors_to (no) Report mail delivery errors to the
address specified with the non-standard Errors-To: message
header, instead of the envelope sender address (this feature
is removed with Postfix version 2.2, is turned off by
default with Postfix version 2.1, and is always turned on
with older Postfix versions).</p>

<p>Available in Postfix version 2.6 and later:</p>

<p>always_add_missing_headers (no) Always add (Resent-)
From:, To:, Date: or Message-ID: headers when not
present.</p>

<p>BUILT-IN CONTENT FILTERING CONTROLS Postfix built-in
content filtering is meant to stop a flood of worms or
viruses. It is not a general content filter.</p>

<p>body_checks (empty) Optional lookup tables for content
inspection as specified in the body_checks(5) manual
page.</p>

<p>header_checks (empty) Optional lookup tables for content
inspection of primary non- MIME message headers, as
specified in the header_checks(5) man- ual page.</p>

<p>Available in Postfix version 2.0 and later:</p>

<p>body_checks_size_limit (51200) How much text in a
message body segment (or attachment, if you prefer to use
that term) is subjected to body_checks inspection.</p>

<p>mime_header_checks ($header_checks) Optional lookup
tables for content inspection of MIME related message
headers, as described in the header_checks(5) manual
page.</p>

<p>nested_header_checks ($header_checks) Optional lookup
tables for content inspection of non-MIME mes- sage headers
in attached messages, as described in the header_checks(5)
manual page.</p>

<p>Available in Postfix version 2.3 and later:</p>

<p>message_reject_characters (empty) The set of characters
that Postfix will reject in message con- tent.</p>

<p>message_strip_characters (empty) The set of characters
that Postfix will remove from message con- tent.</p>

<p>BEFORE QUEUE MILTER CONTROLS As of version 2.3, Postfix
supports the Sendmail version 8 Milter (mail filter)
protocol. When mail is not received via the smtpd(8) server,
the cleanup(8) server will simulate SMTP events to the
extent that this is possible. For details see the
MILTER_README document.</p>

<p>non_smtpd_milters (empty) A list of Milter (mail filter)
applications for new mail that does not arrive via the
Postfix smtpd(8) server.</p>

<p>milter_protocol (6) The mail filter protocol version and
optional protocol exten- sions for communication with a
Milter application; prior to Postfix 2.6 the default
protocol is 2.</p>

<p>milter_default_action (tempfail) The default action when
a Milter (mail filter) application is unavailable or
mis-configured.</p>

<p>milter_macro_daemon_name ($myhostname) The {daemon_name}
macro value for Milter (mail filter) applica- tions.</p>

<p>milter_macro_v ($mail_name $mail_version) The {v} macro
value for Milter (mail filter) applications.</p>

<p>milter_connect_timeout (30s) The time limit for
connecting to a Milter (mail filter) applica- tion, and for
negotiating protocol options.</p>

<p>milter_command_timeout (30s) The time limit for sending
an SMTP command to a Milter (mail filter) application, and
for receiving the response.</p>

<p>milter_content_timeout (300s) The time limit for sending
message content to a Milter (mail filter) application, and
for receiving the response.</p>

<p>milter_connect_macros (seepostconf -doutput) The macros
that are sent to Milter (mail filter) applications after
completion of an SMTP connection.</p>

<p>milter_helo_macros (seepostconf -doutput) The macros
that are sent to Milter (mail filter) applications after the
SMTP HELO or EHLO command.</p>

<p>milter_mail_macros (seepostconf -doutput) The macros
that are sent to Milter (mail filter) applications after the
SMTP MAIL FROM command.</p>

<p>milter_rcpt_macros (seepostconf -doutput) The macros
that are sent to Milter (mail filter) applications after the
SMTP RCPT TO command.</p>

<p>milter_data_macros (seepostconf -doutput) The macros
that are sent to version 4 or higher Milter (mail filter)
applications after the SMTP DATA command.</p>

<p>milter_unknown_command_macros (seepostconf -doutput) The
macros that are sent to version 3 or higher Milter (mail
filter) applications after an unknown SMTP command.</p>

<p>milter_end_of_data_macros (seepostconf -doutput) The
macros that are sent to Milter (mail filter) applications
after the message end-of-data.</p>

<p>Available in Postfix version 2.5 and later:</p>

<p>milter_end_of_header_macros (seepostconf -doutput) The
macros that are sent to Milter (mail filter) applications
after the end of the message header.</p>

<p>MIME PROCESSING CONTROLS Available in Postfix version
2.0 and later:</p>

<p>disable_mime_input_processing (no) Turn off MIME
processing while receiving mail.</p>

<p>mime_boundary_length_limit (2048) The maximal length of
MIME multipart boundary strings.</p>

<p>mime_nesting_limit (100) The maximal recursion level
that the MIME processor will handle.</p>

<p>strict_8bitmime (no) Enable both strict_7bit_headers and
strict_8bitmime_body.</p>

<p>strict_7bit_headers (no) Reject mail with 8-bit text in
message headers.</p>

<p>strict_8bitmime_body (no) Reject 8-bit message body text
without 8-bit MIME content encod- ing information.</p>

<p>strict_mime_encoding_domain (no) Reject mail with
invalid Content-Transfer-Encoding: information for the
message/* or multipart/* MIME content types.</p>

<p>Available in Postfix version 2.5 and later:</p>

<p>detect_8bit_encoding_header (yes) Automatically detect
8BITMIME body content by looking at Con-
tent-Transfer-Encoding: message headers; historically, this
behavior was hard-coded to be &quot;always on&quot;.</p>

<p>AUTOMATIC BCC RECIPIENT CONTROLS Postfix can
automatically add BCC (blind carbon copy) when mail enters
the mail system:</p>

<p>always_bcc (empty) Optional address that receives a
&quot;blind carbon copy&quot; of each message that is
received by the Postfix mail system.</p>

<p>Available in Postfix version 2.1 and later:</p>

<p>sender_bcc_maps (empty) Optional BCC (blind carbon-copy)
address lookup tables, indexed by sender address.</p>

<p>recipient_bcc_maps (empty) Optional BCC (blind
carbon-copy) address lookup tables, indexed by recipient
address.</p>

<p>ADDRESS TRANSFORMATION CONTROLS Address rewriting is
delegated to the trivial-rewrite(8) daemon. The cleanup(8)
server implements table driven address mapping.</p>

<p>empty_address_recipient (MAILER-DAEMON) The recipient of
mail addressed to the null address.</p>

<p>canonical_maps (empty) Optional address mapping lookup
tables for message headers and envelopes.</p>

<p>recipient_canonical_maps (empty) Optional address
mapping lookup tables for envelope and header recipient
addresses.</p>

<p>sender_canonical_maps (empty) Optional address mapping
lookup tables for envelope and header sender addresses.</p>

<p>masquerade_classes (envelope_sender, header_sender,
header_recipient) What addresses are subject to address
masquerading.</p>

<p>masquerade_domains (empty) Optional list of domains
whose subdomain structure will be stripped off in email
addresses.</p>

<p>masquerade_exceptions (empty) Optional list of user
names that are not subjected to address masquerading, even
when their address matches $masquer- ade_domains.</p>

<p>propagate_unmatched_extensions (canonical, virtual) What
address lookup tables copy an address extension from the
lookup key to the lookup result.</p>

<p>Available before Postfix version 2.0:</p>

<p>virtual_maps (empty) Optional lookup tables with a)
names of domains for which all addresses are aliased to
addresses in other local or remote domains, and b) addresses
that are aliased to addresses in other local or remote
domains.</p>

<p>Available in Postfix version 2.0 and later:</p>

<p>virtual_alias_maps ($virtual_maps) Optional lookup
tables that alias specific mail addresses or domains to
other local or remote address.</p>

<p>Available in Postfix version 2.2 and later:</p>

<p>canonical_classes (envelope_sender, envelope_recipient,
header_sender, header_recipient) What addresses are subject
to canonical_maps address mapping.</p>

<p>recipient_canonical_classes (envelope_recipient,
header_recipient) What addresses are subject to
recipient_canonical_maps address mapping.</p>

<p>sender_canonical_classes (envelope_sender,
header_sender) What addresses are subject to
sender_canonical_maps address map- ping.</p>

<p>remote_header_rewrite_domain (empty) Dont rewrite
message headers from remote clients at all when this
parameter is empty; otherwise, rewrite message headers and
append the specified domain name to incomplete
addresses.</p>

<p>RESOURCE AND RATE CONTROLS duplicate_filter_limit (1000)
The maximal number of addresses remembered by the address
dupli- cate filter for aliases(5) or virtual(5) alias
expansion, or for showq(8) queue displays.</p>

<p>header_size_limit (102400) The maximal amount of memory
in bytes for storing a message header.</p>

<p>hopcount_limit (50) The maximal number of Received:
message headers that is allowed in the primary message
headers.</p>

<p>in_flow_delay (1s) Time to pause before accepting a new
message, when the message arrival rate exceeds the message
delivery rate.</p>

<p>message_size_limit (10240000) The maximal size in bytes
of a message, including envelope information.</p>

<p>Available in Postfix version 2.0 and later:</p>

<p>header_address_token_limit (10240) The maximal number of
address tokens are allowed in an address message header.</p>

<p>mime_boundary_length_limit (2048) The maximal length of
MIME multipart boundary strings.</p>

<p>mime_nesting_limit (100) The maximal recursion level
that the MIME processor will handle.</p>

<p>queue_file_attribute_count_limit (100) The maximal
number of (name=value) attributes that may be stored in a
Postfix queue file.</p>

<p>Available in Postfix version 2.1 and later:</p>

<p>virtual_alias_expansion_limit (1000) The maximal number
of addresses that virtual alias expansion produces from each
original recipient.</p>

<p>virtual_alias_recursion_limit (1000) The maximal nesting
depth of virtual alias expansion.</p>

<p>MISCELLANEOUS CONTROLS config_directory (seepostconf
-doutput) The default location of the Postfix main.cf and
master.cf con- figuration files.</p>

<p>daemon_timeout (18000s) How much time a Postfix daemon
process may take to handle a request before it is terminated
by a built-in watchdog timer.</p>

<p>delay_logging_resolution_limit (2) The maximal number of
digits after the decimal point when log- ging sub-second
delay values.</p>

<p>delay_warning_time (0h) The time after which the sender
receives the message headers of mail that is still
queued.</p>

<p>ipc_timeout (3600s) The time limit for sending or
receiving information over an internal communication
channel.</p>

<p>max_idle (100s) The maximum amount of time that an idle
Postfix daemon process waits for an incoming connection
before terminating voluntarily.</p>

<p>max_use (100) The maximal number of incoming connections
that a Postfix daemon process will service before
terminating voluntarily.</p>

<p>myhostname (seepostconf -doutput) The internet hostname
of this mail system.</p>

<p>myorigin ($myhostname) The domain name that
locally-posted mail appears to come from, and that locally
posted mail is delivered to.</p>

<p>process_id (read-only) The process ID of a Postfix
command or daemon process.</p>

<p>process_name (read-only) The process name of a Postfix
command or daemon process.</p>

<p>queue_directory (seepostconf -doutput) The location of
the Postfix top-level queue directory.</p>

<p>soft_bounce (no) Safety net to keep mail queued that
would otherwise be returned to the sender.</p>

<p>syslog_facility (mail) The syslog facility of Postfix
logging.</p>

<p>syslog_name (seepostconf -doutput) The mail system name
that is prepended to the process name in syslog records, so
that &quot;smtpd&quot; becomes, for example, &quot;post-
fix/smtpd&quot;.</p>

<p>Available in Postfix version 2.1 and later:</p>

<p>enable_original_recipient (yes) Enable support for the
X-Original-To message header.</p>

<p>FILES /etc/postfix/canonical*, canonical mapping table
/etc/postfix/virtual*, virtual mapping table</p>

<p>SEE ALSO trivial-rewrite(8), address rewriting qmgr(8),
queue manager header_checks(5), message header content
inspection body_checks(5), body parts content inspection
canonical(5), canonical address lookup table format
virtual(5), virtual alias lookup table format postconf(5),
configuration parameters master(5), generic daemon options
master(8), process manager syslogd(8), system logging</p>

<p>README FILES Use &quot;postconf readme_directory&quot;
or &quot;postconf html_directory&quot; to locate this
information. ADDRESS_REWRITING_README Postfix address
manipulation CONTENT_INSPECTION_README content
inspection</p>

<p>LICENSE The Secure Mailer license must be distributed
with this software.</p>

<p>AUTHOR(S) Wietse Venema IBM T.J. Watson Research P.O.
Box 704 Yorktown Heights, NY 10598, USA</p>

<p>CLEANUP(8)</p>
<hr>
</body>
</html>
