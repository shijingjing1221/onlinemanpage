<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:33:21 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>selabel_open(3) SELinux API documentation
selabel_open(3)</p>

<p>NAME selabel_open, selabel_close - userspace SELinux
labeling interface.</p>

<p>SYNOPSIS #include &lt;selinux/selinux.h&gt;</p>

<p>#include &lt;selinux/label.h&gt;</p>

<p>struct selabel_handle *selabel_open(int backend, struct
selinux_opt *options,</p>

<p>unsigned nopt);</p>

<p>void selabel_close(struct selabel_handle *hnd);</p>

<p>DESCRIPTION selabel_open is used to initialize a
labeling handle to be used for lookup operations. The
backend argument specifies which backend is to be opened;
the list of current backends appears in BACKENDS below.</p>

<p>The options argument should be NULL or a pointer to an
array of selinux_opt structures of length nopt:</p>

<p>struct selinux_opt { int type; const char *value; };</p>

<p>The available option types are described in GLOBAL
OPTIONS below as well as in the documentation for each
individual backend. The return value on success is a
non-NULL value for use in subsequent label opera- tions.</p>

<p>selabel_close terminates use of a handle, freeing any
internal resources associated with it. After this call has
been made, the han- dle must not be used again.</p>

<p>GLOBAL OPTIONS Global options which may be passed to
selabel_open include the follow- ing:</p>

<p>SELABEL_OPT_UNUSED The option with a type code of zero
is a no-op. Thus an array of options may be initizalized to
zero and any untouched ele- ments will not cause an
error.</p>

<p>SELABEL_OPT_VALIDATE A non-null value for this option
enables context validation. By default,
security_check_context(3) is used; a custom validation
function can be provided via selinux_set_callback(3). Note
that an invalid context may not be treated as an error
unless it is actually encountered during a lookup
operation.</p>

<p>BACKENDS SELABEL_CTX_FILE File contexts backend,
described in selabel_file(5).</p>

<p>SELABEL_CTX_MEDIA Media contexts backend, described in
selabel_media(5).</p>

<p>SELABEL_CTX_X X Windows contexts backend, described in
selabel_x(5).</p>

<p>SELABEL_CTX_DB Database objects contexts backend,
described in selabel_db(5).</p>

<p>RETURN VALUE A non-NULL handle value is returned on
success. On error, NULL is returned and errno is set
appropriately.</p>

<p>AUTHOR Eamon Walsh &lt;ewalsh@tycho.nsa.gov&gt;</p>

<p>SEE ALSO selabel_lookup(3), selabel_stats(3),
selinux_set_callback(3), selinux(8)</p>

<p>18 Jun 2007 selabel_open(3)</p>
<hr>
</body>
</html>
