<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:28:10 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PMLOGCONF(1) PMLOGCONF(1)</p>

<p>NAME pmlogconf - create/edit a pmlogger configuration
file</p>

<p>SYNOPSIS $PCP_BINADM_DIR/pmlogconf [-cqrv] [-d
groupsdir] [-h hostname] config- file</p>

<p>DESCRIPTION pmlogconf may be used to create and modify a
generic configuration file for the PCP archive logger,
pmlogger(1).</p>

<p>If configfile does not exist, pmlogconf will create a
generic configu- ration file with a default set of enabled
metrics and logging inter- vals.</p>

<p>Once created, configfile may be used with the -c option
to pmlogger(1) to select performance metrics and specify
logging intervals for a PCP archive.</p>

<p>If configfile does exist, pmlogconf will prompt for
input from the user to enable or disable groups of related
performance metrics and to con- trol the logging interval
for each enabled group.</p>

<p>Group selection requires a simple y (yes) or n (no)
response to the prompt Log this group?.</p>

<p>Other responses at this point may be used to select
additional control functions as follows:</p>

<p>m Report the names of the metrics in the current
group.</p>

<p>q Finish with group selection (quit) and make no further
changes to this group or any subsequent group.</p>

<p>/pattern Make no change to this group but search for a
group contain- ing pattern in the description of the group
or the names of the associated metrics.</p>

<p>A logging interval is specified by responding to the
Logging interval? prompt with the keywords once or default
or a valid pmlogger(1) inter- val specification of the form
every N timeunits or simply N time- units _ (the every is
optional) where N is an unsigned integer and timeunits is
one of the keywords msec, millisecond, sec, second, min,
minute, hour or the plural form of one of the keywords.</p>

<p>When run from automated logging setup processes, the -c
option is used to add a message and timestamp indicating
this fact. This option is not appropriate for interactive
use of the tool.</p>

<p>The -q option suppresses the logging interval dialog and
preserves the current interval from configfile.</p>

<p>More verbose output may be enabled with the -v
option.</p>

<p>SETUP GROUP FILES When an initial configfile is created,
the default specifications come from a set of group files
below the groupsdir specified with the -d option (the
default groupsdir is $PCP_VAR_DIR/config/pmlogconf which is
most commonly correct, so the -d option is rarely used in
practice).</p>

<p>The directory structure below groupsdir is arbitrary as
all regular files will be found by recursive descent and
considered, so add-on products and PMDA developers can
easily extend the available defaults to pmlogconf by adding
new directories and/or group files below groups- dir.</p>

<p>These group files are processed in the following
ways:</p>

<p>&middot; When a new configfile is created, all group
files are processed.</p>

<p>&middot; Whenever pmlogconf is run with an existing
configfile, groupsdir is traversed to see if any new groups
have been defined and should be considered for inclusion in
configfile.</p>

<p>&middot; When pmlogconf processes a group in configfile
that is enabled, the list of metrics associated with the
group is taken from the group file (and replaces any
previous list of metrics associated with this group in
configfile).</p>

<p>&middot; When the -r (reprobe) command line option is
specified, every group (not just newly discovered ones) is
reprocessed to see if it should be considered for inclusion
in configfile.</p>

<p>Each group file is structured as follows:</p>

<p>&middot; The first line must contain #pmlogconf-setup
2.0</p>

<p>&middot; Other lines beginning with # are treated as
comments.</p>

<p>&middot; Blank lines are ignored.</p>

<p>&middot; One or more lines starting with the keyword
ident are used to pro- vide the human-readable description
of the group.</p>

<p>&middot; Non-blank lines beginning with white space
define metrics to be associated with this group, one per
line. Each metric specification follows the rules for a
pmlogger(1) configuration, namely either the name of a
non-leaf node in the PMNS (implying all descendent names in
the PMNS), or the name of a leaf node in the PMNS optionally
fol- lowed by one or more instance names enclosed by [ and ]
.</p>

<p>&middot; A control line starting with one of the
keywords probe or force must be present.</p>

<p>&middot; An optional logging interval control line
begins with the keyword delta followed by one of the
pmlogger(1) interval specification described above.</p>

<p>&middot; probe control lines have the format: probe
metric [condition [state_rule] ] where metric is the name of
a PCP metric (must be a leaf node in the PMNS and no
instance specification is allowed) and the optional con-
dition is the keyword exists (true if metric exists, i.e. is
defined in the PMNS) or the keyword values (true if metric
exists in the PMNS and has one or more current values) or an
expression of the form op val where op is one of the awk(1)
operators (==, !=, &gt;, &gt;=, &lt;, &lt;=, ~ (regular
expression match) or !~ (negated regular expression match))
and val is a value (arbitrary sequence of characters,
excluding a space) and the condition is true if there is
some instance of metric that makes the expression true.</p>

<p>If the condition is missing, the default is exists.</p>

<p>When an explicit condition is provided, there may also
be an optional state_rule of the form ? true_state :
false_state where true_state (applies if condition is true)
and false_state (applies if condition is false) are both
taken from the keywords include (include and enable the
group and the associated metrics in configfile), available
(include and disable the group in configfile - a user action
of y as described above is needed to enable the group and
add the associated metrics into configfile) or exclude (the
group is not considered for inclusion in configfile).</p>

<p>The default state_rule is ? available : exclude</p>

<p>&middot; force control lines begin with the keyword
force followed by one of the states defined above, so one of
the actions include, exclude or available is applied
unconditionally to the group.</p>

<p>Probing is only done when a new group is being added to
configfile or when the -r command line option is specified.
The evaluation of the probing conditions is done by
contacting pmcd(1) on hostname (defaults to local:).</p>

<p>EXAMPLE The following group file demonstrates all of the
supported syntactic elements.</p>

<p>#pmlogconf-setup 2.0 ident Example group file ident ...
more description delta 1 minute probe sample.secret.foo.one
values ? include : exclude sample.secret.foo.one
sample.secret.foo.bar # non-leaf in the PMNS sample.colour [
red green ]</p>

<p>MIGRATION The current version of pmlogconf (2.0)
supports a slightly different format for configfile compared
to earlier versions. If an old version configfile is
presented to pmlogconf it will be converted to the new
format.</p>

<p>PCP ENVIRONMENT Environment variables with the prefix
PCP_ are used to parameterize the file and directory names
used by PCP. On each installation, the file /etc/pcp.conf
contains the local values for these variables. The $PCP_CONF
variable may be used to specify an alternative configuration
file, as described in pcp.conf(5).</p>

<p>SEE ALSO pmcd(1), pmlogger(1), pcp.conf(5) and
pcp.env(5).</p>

<p>Performance Co-Pilot PCP PMLOGCONF(1)</p>
<hr>
</body>
</html>
