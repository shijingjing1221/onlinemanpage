<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:44:14 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>VIRT-V2V.CONF(5) User Contributed Perl Documentation
VIRT-V2V.CONF(5)</p>

<p>NAME virt-v2v.conf - configuration file for virt-v2v</p>

<p>DESCRIPTION &quot;virt-v2v.conf&quot; describes:</p>

<p>&middot; a set of target profiles which pre-define a set
of output options.</p>

<p>&middot; how to map virtual network interface
connections when importing them from another
environment.</p>

<p>&middot; software which can be installed by virt-v2v
during the conversion process.</p>

<p>FORMAT The configuration file is an XML document whose
root element is &lt;virt-v2v&gt;.</p>

<p>Target Profiles A target profile is used to group a set
of configuration options defining a specific destination for
a conversion. A user can specify a target profile in place
of the equivalent command line options.</p>

<p>A target profile is defined by an element in
virt-v2v.conf which is a child of the top-level virt-v2v
element. For example:</p>

<p>&lt;profile name=&rsquo;kvm1&rsquo;&gt;
&lt;method&gt;libvirt&lt;/method&gt; &lt;storage
format=&rsquo;raw&rsquo;
allocation=&rsquo;sparse&rsquo;&gt;default&lt;/storage&gt;
&lt;network type=&rsquo;default&rsquo;&gt; &lt;network
type=&rsquo;network&rsquo; name=&rsquo;red&rsquo;/&gt;
&lt;/network&gt; &lt;network type=&rsquo;bridge&rsquo;
name=&rsquo;xenbr1&rsquo;&gt; &lt;network
type=&rsquo;network&rsquo; name=&rsquo;green&rsquo;/&gt;
&lt;/network&gt; &lt;/profile&gt;</p>

<p>A target profile is identified by its name attribute.
Allowed elements are:</p>

<p>method The output method, equivalent to the -o command
line option. This element is required.</p>

<p>storage The output storage location, equivalent to the
-os command line option. This element is required.</p>

<p>storage can optionally have format and allocation
attributes. If specified, these are equivalent to the -of
and -oa command line options respectively.</p>

<p>network A set of network mappings specific to this
profile. See &quot;Mapping network interface
connections&quot; for detail of the format of this
element.</p>

<p>Network mappings specified in the selected profile will
be used in preference to top-level network mappings. A
specific, matching top- level mapping will still be used in
preference to a default specified in a profile.</p>

<p>Mapping network interface connections When importing a
guest from a different machine and/or hypervisor, it is
likely that the name of the virtual interface its network
devices were connected to will change. For example, a
typical Xen guest will be connected to a bridge device
called xenbrN. This bridge is created by Xen and will not
exist locally by default.</p>

<p>virt-v2v can change these on import to connect to an
appropriate local interface. The mapping is specified by the
&lt;network&gt; element, which is a child of the root
element. The configuration can specify any number of
&lt;network&gt; elements. &lt;network&gt; has 2
attributes:</p>

<p>type type can be:</p>

<p>bridge A bridge to a host network interface.</p>

<p>network A managed virtual network.</p>

<p>default A type which will match any network if there is
no specific match.</p>

<p>For Xen and ESX guests the source type will typically be
bridge. A configuration may only contain a single default
mapping.</p>

<p>name name specifies the name of the given network or
bridge. A default mapping does not have a name.</p>

<p>The mapping is specified by a nested &lt;network&gt;
element.</p>

<p>The following example specifies that a guest interface
which bridged to xenbr1 before conversion should be changed
to connect to the local bridge called br0. Any other network
interface should be changed to connect to the local managed
network called default:</p>

<p>&lt;network type=&rsquo;bridge&rsquo;
name=&rsquo;xenbr1&rsquo;&gt; &lt;network
type=&rsquo;bridge&rsquo; name=&rsquo;br0&rsquo;/&gt;
&lt;/network&gt;</p>

<p>&lt;network type=&rsquo;default&rsquo;&gt; &lt;network
type=&rsquo;network&rsquo; name=&rsquo;default&rsquo;/&gt;
&lt;/network&gt;</p>

<p>Specifying software to be installed virt-v2v may have to
install software in a guest during the conversion process to
ensure it boots. An example is replacing a Xen
paravirtualised kernel with a normal kernel. This software
will be specific to the guest operating system.</p>

<p>Capabilities</p>

<p>A capability describes the set of software required for
a specific goal, for example VirtIO support. A capability
describes only direct dependencies. Transitive dependencies
will be resolved by the installation method, for example yum
or &quot;Local Installation&quot;.</p>

<p>&lt;capability&gt; is a child of the root element. There
can be any number of &lt;capability&gt; elements. See
&quot;Searching&quot; for a description of the attributes of
&lt;capability&gt; and how they are matched.</p>

<p>Dependencies are specified in the &lt;dep&gt; element,
which has the following attributes:</p>

<p>name The symbolic name of a dependency. On an rpm-based
system this will be the package name. This attribute is
required.</p>

<p>minversion The minimum required version of the software.
For rpm-based systems this must be specified as
[epoch:]version[-release]. This attribute is required.</p>

<p>ifinstalled A dependency must normally be installed if
it is not present, or upgraded if it present but too old. If
ifinstalled is yes, the dependency will be upgraded if is
present but too old, but not installed if it is not already
present.</p>

<p>Local Installation</p>

<p>If it is not possible to install required software using
the guests update agent, the software can be installed from
the conversion host. In this case, it must be specified in
the &lt;app&gt; element. &lt;app&gt; is a child of the root
element. The configuration can specify any number of
&lt;app&gt; elements. See &quot;Searching&quot; for a
description of the attribute of &lt;app&gt; and how they are
matched.</p>

<p>The &lt;app&gt; element must contain a &lt;path&gt;
element, which specifies the path to the software. It may
also contain any number of &lt;dep&gt; elements, which
specify the names of additional applications which may need
to be installed. Each dependency will be resolved in the
same way as its parent, by looking for a match based on os,
distro, major, minor and arch.</p>

<p>virt-v2v will attempt to install dependencies first. A
dependency will only be installed if it is not already
installed, or the installed version is older than the
specified version. On x86_64, virt-v2v will additionally
check if an i386 version need to by updated, but only if any
i386 version of the package is already installed.</p>

<p>Paths given in &lt;path&gt; must be absolute, unless
there is a top level &lt;path-root&gt; element. If it
exists, all &lt;path&gt; elements will be relative to
&lt;path-root&gt;.</p>

<p>The following example specifies the location of kernel
for RHEL 5, all minor versions, on i686:</p>

<p>&lt;app os=&rsquo;linux&rsquo; distro=&rsquo;rhel&rsquo;
major=&rsquo;5&rsquo; arch=&rsquo;i686&rsquo;
name=&rsquo;kernel&rsquo;&gt;
&lt;path&gt;rhel/5/kernel-2.6.18-128.el5.i686.rpm&lt;/path&gt;
&lt;dep&gt;ecryptfs-utils&lt;/dep&gt;
&lt;dep&gt;lvm2&lt;/dep&gt; &lt;/app&gt; &lt;app
os=&rsquo;linux&rsquo; distro=&rsquo;rhel&rsquo;
major=&rsquo;5&rsquo; arch=&rsquo;i386&rsquo;
name=&rsquo;ecryptfs-utils&rsquo;&gt;
&lt;path&gt;rhel/5/ecryptfs-utils-56-8.el5.i386.rpm&lt;/path&gt;
&lt;/app&gt; &lt;app os=&rsquo;linux&rsquo;
distro=&rsquo;rhel&rsquo; major=&rsquo;5&rsquo;
arch=&rsquo;i386&rsquo; name=&rsquo;lvm2&rsquo;&gt;
&lt;path&gt;rhel/5/lvm2-2.02.40-6.el5.i386.rpm&lt;/path&gt;
&lt;dep&gt;device-mapper&lt;/dep&gt;
&lt;dep&gt;device-mapper-event&lt;/dep&gt; &lt;/app&gt;</p>


<p>&lt;path-root&gt;/var/lib/virt-v2v/software&lt;/path-root&gt;</p>

<p>The kernel can be found at
/var/lib/virt-v2v/software/rhel/5/kernel-2.6.18-128.el5.i686.rpm.
It has 2 direct dependencies: ecryptfs and lvm2.
ecryptfs-utils has no additional dependencies, but lvm2 has
2 further dependencies (not shown for brevity). All
dependencies will also be installed if they are not present,
or are too old. All dependency paths are also relative to
/var/lib/virt-v2v/software.</p>

<p>Searching</p>

<p>Both &lt;capability&gt; and &lt;app&gt; are matched in
the same way, based on the following attributes:</p>

<p>name The symbolic name of the software virt-v2v is
looking for. name is a mandatory attribute.</p>

<p>os The name of the guest operating system, as returned
by virt- inspector. This will be a string, like linux or
windows.</p>

<p>distro When os= linux , this is the Linux distribution
as returned by virt-inspector. Possible values include rhel,
debian.</p>

<p>major The major version name of the guest operating
system, as returned by virt-inspector.</p>

<p>minor The minor version name of the guest operating
system, as returned by virt-inspector.</p>

<p>arch The guest architecture, as returned by
virt-inspector.</p>

<p>virt-v2v searches for an &lt;app&gt; or
&lt;capability&gt; by symbolic name, matching based on its
additional attributes. If an attribute is missing it will
match any value. If multiple elements would match a given
search, virt-v2v will choose the most specific match.
Specifically, it searches in the following order:</p>

<p>&middot; os, distro, major, minor, arch</p>

<p>&middot; os, distro, major, minor</p>

<p>&middot; os, distro, major, arch</p>

<p>&middot; os, distro, major</p>

<p>&middot; os, distro</p>

<p>&middot; os</p>

<p>If virt-v2v doesnt find a match it will quit with an
error describing what it was looking for.</p>

<p>Installing custom software during conversion The Red Hat
converter, which converts RHEL and Fedora guests, includes a
hook which allows custom software to be installed during
conversion. The user can define a capability with the name
user-custom. The dependencies of this capability will be
installed during conversion in the same way as the
dependencies of other capabilities.</p>

<p>It is recommended that custom configuration changes are
added to /etc/virt-v2v.conf rather than
/var/lib/virt-v2v/virt-v2v.db.</p>

<p>COPYRIGHT Copyright (C) 2009-2012 Red Hat Inc.</p>

<p>SEE ALSO Example virt-v2v.conf in the documentation
directory, virt-v2v(1), virt-inspector(1),
&lt;http://libguestfs.org/&gt;</p>

<p>perl v5.10.1 2013-06-12 VIRT-V2V.CONF(5)</p>
<hr>
</body>
</html>
