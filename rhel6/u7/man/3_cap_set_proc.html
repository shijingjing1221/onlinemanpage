<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:06:51 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>CAP_GET_PROC(3) Linux Programmer s Manual
CAP_GET_PROC(3)</p>

<p>NAME cap_get_proc, cap_set_proc, capgetp - capability
manipulation on pro- cesses</p>

<p>SYNOPSIS #include &lt;sys/capability.h&gt;</p>

<p>cap_t cap_get_proc(void);</p>

<p>int cap_set_proc(cap_t cap_p);</p>

<p>#include &lt;sys/types.h&gt;</p>

<p>cap_t cap_get_pid(pid_t pid);</p>

<p>Link with -lcap.</p>

<p>DESCRIPTION cap_get_proc() allocates a capability state
in working storage, sets its state to that of the calling
process, and returns a pointer to this newly created
capability state. The caller should free any releasable
memory, when the capability state in working storage is no
longer required, by calling cap_free() with the cap_t as an
argument.</p>

<p>cap_set_proc() sets the values for all capability flags
for all capa- bilities to the capability state identified by
cap_p. The new capabil- ity state of the process will be
completely determined by the contents of cap_p upon
successful return from this function. If any flag in cap_p
is set for any capability not currently permitted for the
calling process, the function will fail, and the capability
state of the pro- cess will remain unchanged.</p>

<p>cap_get_pid() returns cap_d, see cap_init(3), with the
process capabil- ities of the process indicated by pid. This
information can also be obtained from the
/proc/&lt;pid&gt;/status file.</p>

<p>RETURN VALUE The functions cap_get_proc() and
cap_get_pid() return a non-NULL value on success, and NULL
on failure.</p>

<p>The function cap_set_proc() return zero for success, and
-1 on failure.</p>

<p>On failure, errno is set to EINVAL, EPERM, or
ENOMEM.</p>

<p>CONFORMING TO cap_set_proc() and cap_get_proc() are
specified in the withdrawn POSIX.1e draft specification.
cap_get_pid() is a Linux extension.</p>

<p>NOTES The library also supports the deprecated
functions:</p>

<p>int capgetp(pid_t pid, cap_t cap_d);</p>

<p>int capsetp(pid_t pid, cap_t cap_d);</p>

<p>capgetp() attempts to obtain the capabilities of some
other process; storing the capabilities in a pre-allocated
cap_d.See cap_init() for information on allocating an empty
capability set. This function, capgetp(), is deprecated, you
should use cap_get_pid().</p>

<p>capsetp() attempts to set the capabilities of some other
process(es), pid. If pid is positive it refers to a specific
process; if it is zero, it refers to the current process; -1
refers to all processes other than the current process and
process 1 (typically init(8)); other negative values refer
to the -pid process group. In order to use this function,
the kernel must support it and the current process must have
CAP_SETPCAP raised in its Effective capability set. The
capabili- ties set in the target process(es) are those
contained in cap_d. Ker- nels that support filesystem
capabilities redefine the semantics of CAP_SETPCAP and on
such systems this function will always fail for any target
not equal to the current process. capsetp() returns zero for
success, and -1 on failure.</p>

<p>Where supported by the kernel, the function capsetp()
should be used with care. It existed, primarily, to overcome
an early lack of support for capabilities in the filesystems
supported by Linux. Note that, by default, the only
processes that have CAP_SETPCAP available to them are
processes started as a kernel thread. (Typically this
includes init(8), kflushd and kswapd). You will need to
recompile the kernel to modify this default.</p>

<p>EXAMPLE The code segment below raises the CAP_FOWNER and
CAP_SETFCAP effective capabilities for the caller:</p>

<p>cap_t caps; cap_value_t cap_list[2];</p>

<p>caps = cap_get_proc(); if (caps == NULL) /* handle error
*/;</p>

<p>cap_list[0] = CAP_FOWNER; cap_list[1] = CAP_SETFCAP; if
(cap_set_flag(caps, CAP_EFFECTIVE, 2, cap_list, CAP_SET) ==
-1) /* handle error */;</p>

<p>if (cap_set_proc(caps) == -1) /* handle error */;</p>

<p>if (cap_free(caps) == -1) /* handle error */;</p>

<p>SEE ALSO libcap(3), cap_clear(3), cap_copy_ext(3),
cap_from_text(3), cap_get_file(3), cap_init(3),
capabilities(7)</p>

<p>2008-05-11 CAP_GET_PROC(3)</p>
<hr>
</body>
</html>
