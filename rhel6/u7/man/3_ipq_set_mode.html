<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:19:45 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>IPQ_SET_MODE(3) Linux Programmer s Manual
IPQ_SET_MODE(3)</p>

<p>NAME ipq_set_mode set the ip_queue queuing mode</p>

<p>SYNOPSIS #include &lt;linux/netfilter.h&gt; #include
&lt;libipq.h&gt;</p>

<p>int ipq_set_mode(const struct ipq_handle *h, u_int8_t
mode, size_t range);</p>

<p>DESCRIPTION The ipq_set_mode function sends a message to
the kernel ip_queue mod- ule, specifying whether packet
metadata only, or packet payloads as well as metadata should
be copied to userspace.</p>

<p>The h parameter is a context handle which must
previously have been returned successfully from a call to
ipq_create_handle.</p>

<p>The mode parameter must be one of:</p>

<p>IPQ_COPY_META Copy only packet metadata to
userspace.</p>

<p>IPQ_COPY_PACKET Copy packet metadata and packet payloads
to userspace.</p>

<p>The range parameter is used to specify how many bytes of
the payload to copy to userspace. It is only valid for
IPQ_COPY_PACKET mode and is otherwise ignored. The maximum
useful value for range is 65535 (greater values will be
clamped to this by ip_queue).</p>

<p>ipq_set_mode is usually used immediately following
ipq_create_handle to enable the flow of packets to
userspace.</p>

<p>Note that as the underlying Netlink messaging transport
is connection- less, the ip_queue module does not know that
a userspace application is ready to communicate until it
receives a message such as this.</p>

<p>RETURN VALUE On failure, -1 is returned. On success, a
non-zero positive value is returned.</p>

<p>ERRORS On failure, a descriptive error message will be
available via the ipq_errstr function.</p>

<p>DIAGNOSTICS A relatively common failure may occur if the
ip_queue module is not loaded. In this case, the following
code excerpt:</p>

<p>status = ipq_set_mode(h, IPQ_COPY_META, 0); if (status
&lt; 0) { ipq_perror(&quot;myapp&quot;);
ipq_destroy_handle(h); exit(1); }</p>

<p>would generate the following output:</p>

<p>myapp: Failed to send netlink message: Connection
refused</p>

<p>BUGS None known.</p>

<p>AUTHOR James Morris &lt;jmorris@intercode.com.au&gt;</p>

<p>COPYRIGHT Copyright (c) 2000-2001 Netfilter Core
Team.</p>

<p>Distributed under the GNU General Public License.</p>

<p>SEE ALSO libipq(3), iptables(8).</p>

<p>Linux iptables 1.2 16 October 2001 IPQ_SET_MODE(3)</p>
<hr>
</body>
</html>
