<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:21:00 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>LDAP_OPEN(3) LDAP_OPEN(3)</p>

<p>NAME ldap_dup, ldap_destroy, - Duplicate and destroy
LDAP session handles</p>

<p>LIBRARY OpenLDAP LDAP (libldap, -lldap)</p>

<p>SYNOPSIS #include &lt;ldap.h&gt;</p>

<p>LDAP *ldap_dup( LDAP *old );</p>

<p>int ldap_destroy( LDAP *old );</p>

<p>DESCRIPTION ldap_dup() duplicates an existing LDAP (LDAP
*) session handle. The new session handle may be used
concurrently with the original session handle. In a threaded
environment, different threads may execute con- current
requests on the same connection/session without fear of
contam- ination. Each session handle manages its own private
error results.</p>

<p>ldap_destroy() destroys an existing session handle.</p>

<p>The ldap_dup() and ldap_destroy() functions are used in
conjunction with a &quot;thread safe&quot; version of
libldap (libldap_r) to enable operation thread safe API
calls, so that a single session may be simultaneously used
across multiple threads with consistent error handling.</p>

<p>When a session is created through the use of one of the
session cre- ation functions including ldap_open(3),
ldap_init(3), ldap_initial- ize(3) or ldap_init_fd(3) an
LDAP * session handle is returned to the application. The
session handle may be shared amongst threads, however the
error codes are unique to a session handle. Multiple threads
per- forming different operations using the same session
handle will result in inconsistent error codes and return
values.</p>

<p>To prevent this confusion, ldap_dup() is used duplicate
an existing session handle so that multiple threads can
share the session, and maintain consistent error information
and results.</p>

<p>The message queues for a session are shared between
sibling session handles. Results of operations on a sibling
session handles are acces- sible to all the sibling session
handles. Applications desiring results associated with a
specific operation should provide the appro- priate msgid to
ldap_result(). Applications should avoid calling
ldap_result() with LDAP_RES_ANY as that may
&quot;steal&quot; and return results in the calling thread
that another operation in a different thread, using a
different session handle, may require to complete.</p>

<p>When ldap_unbind() is called on a session handle with
siblings, all the siblings become invalid.</p>

<p>Siblings must be destroyed using ldap_destroy(). Session
handle resources associated with the original (LDAP *) will
be freed when the last session handle is destroyed or when
ldap_unbind() is called, if no other session handles
currently exist.</p>

<p>ERRORS If an error occurs, ldap_dup() will return NULL
and errno should be set appropriately. ldap_destroy() will
directly return the LDAP code asso- ciated to the error (or
LDAP_SUCCESS in case of success); errno should be set as
well whenever appropriate.</p>

<p>SEE ALSO ldap_open(3), ldap_init(3), ldap_initialize(3),
ldap_init_fd(3), errno(3)</p>

<p>ACKNOWLEDGEMENTS This work is based on the previously
proposed LDAP C API Concurrency Extensions draft
(draft-zeilenga-ldap-c-api-concurrency-00.txt) effort.
OpenLDAP Software is developed and maintained by The
OpenLDAP Project &lt;http://www.openldap.org/&gt;. OpenLDAP
Software is derived from Univer- sity of Michigan LDAP 3.3
Release.</p>

<p>OpenLDAP 2.4.40 2014/09/20 LDAP_OPEN(3)</p>
<hr>
</body>
</html>
