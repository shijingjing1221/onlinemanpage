<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:23:33 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>MULTIPATH.CONF(5) MULTIPATH.CONF(5)</p>

<p>NAME multipath.conf - multipath daemon configuration
file</p>

<p>DESCRIPTION multipath.conf is the configuration file for
the multipath daemon. It is used to overwrite the built-in
configuration table of multipathd. Any line whose first
non-white-space character is a # is considered a comment
line. Empty lines are ignored.</p>

<p>SYNTAX The configuration file contains entries of the
form:</p>

<p>&lt;section&gt; { &lt;attribute&gt; &lt;value&gt; ...
&lt;subsection&gt; { &lt;attribute&gt; &lt;value&gt; ... }
}</p>

<p>Each section contains one or more attributes or
subsections. The recog- nized keywords for attributes or
subsections depend on the section in which they occor.</p>

<p>The following section keywords are recognized:</p>

<p>defaults This section defines default settings for
devices-map- per-multipath. These values can be overwritten
by the devices and multipaths sections.</p>

<p>blacklist This section defines which devices should be
excluded from the multipath topology discovery.</p>

<p>blacklist_exceptions This section defines which devices
should be included in the multipath topology discovery,
despite being listed in the blacklist section.</p>

<p>multipaths This section defines the settings for
individual mul- tipath devices. These values overwrite what
is speci- fied in the defaults and devices section of the
con- figuration file. The devices are identified by the wwid
keyword, which is a regular expression that must match the
result of the getuid_callout program.</p>

<p>devices This section defines the settings for individual
stor- age controller types. These value overwrite what is
specified in the defaults section of the configuration file.
These controller types are identified by the vendor,
product, and revision keywords, which are reg- ular
expressions that must match the sysfs information about this
device. If you are using a storage array that is not
supported by default, you may need to cre- ate a devices
subsection for your array.</p>

<p>The priority of configuration in multipath.conf is:
multipaths is greater than devices is greater that
defaults</p>

<p>defaults section The defaults section recognizes the
following keywords:</p>

<p>polling_interval interval between two path checks in
seconds For prop- erly functioning paths, the interval
between checks will gradually increase to (4 *
polling_interval); default is 5</p>

<p>udev_dir directory where udev creates its device nodes;
default is /dev</p>

<p>multipath_dir directory where the dynamic shared objects
are stored; default is system dependent, commonly
/lib/multipath</p>

<p>find_multipaths If set to yes , instead of trying to
create a multi- path device for every non-blacklisted path,
multipath will only create a device if one of three
condidions are met. 1 There are at least two non-blacklisted
paths with the same wwid, 2 the user manually forces the
creation, by specifying a device with the multi- path
command, or 3 a path has the same WWID as a mul- tipath
device that was previously created while find_multipaths was
set (even if that multipath device doesn t currently exist).
Whenever a multipath device is created with find_multipaths
set, multipath will remeber the WWID of the device, so that
it will auto- matically create the device again, as soon as
it sees a path with that WWID. This should allow most users
to have multipath automatically choose the correct paths to
make into multipath devices, without having to edit the
blacklist; Default is no</p>

<p>verbosity default verbosity. Higher values increase the
ver- bosity level. Valid levels are between 0 and 6; default
is 2</p>

<p>path_selector The default path selector algorithm to
use; they are offered by the kernel multipath target. There
are three selector algorithms.</p>

<p>round-robin 0 Loop through every path in the path group,
sending the same amount of IO to each.</p>

<p>queue-length 0 Send the next bunch of IO down the path
with the least amount of outstanding IO.</p>

<p>service-time 0 Choose the path for the next bunch of IO
based on the amount of outstanding IO to the path and its
relative throughput.</p>

<p>path_grouping_policy The default path grouping policy to
apply to unspeci- fied multipaths. Possible values are</p>

<p>failover 1 path per priority group</p>

<p>multibus all paths in 1 priority group</p>

<p>group_by_serial 1 priority group per serial number</p>

<p>group_by_prio 1 priority group per priority value. Pri-
orities are determined by callout programs specified as a
global, per-controller or per-multipath option in the
configuration file.</p>

<p>group_by_node_name 1 priority group per target node
name. Target node names are fetched in
/sys/class/fc_transport/target*/node_name.</p>

<p>Default value is multibus.</p>

<p>getuid_callout The default program and args to callout
to obtain a unique path identifier. Should be specified with
an absolute path. Default value is /lib/udev/scsi_id
--whitelisted --device=/dev/%n</p>

<p>prio The default method used to obtain a path priority
value. Possible values are</p>

<p>const Set a priority of one to all paths</p>

<p>emc Generate the path priority for EMC arrays</p>

<p>alua Generate the path priority based on the SCSI-3 ALUA
settings.</p>

<p>tpg_pref Generate the path prority based on the SCSI-3
ALUA settings, using the preferred port bit.</p>

<p>ontap Generate the path priority for NetApp arrays.</p>

<p>rdac Generate the path priority for LSI/Enge- nio/NetApp
E-Series RDAC controller.</p>

<p>hp_sw Generate the path priority for Compaq/HP
controller in active/standby mode.</p>

<p>hds Generate the path priority for Hitachi HDS Modular
storage arrays.</p>

<p>weighted hbtl|devname &lt;regex1&gt; &lt;prio1&gt;
&lt;regex2&gt; &lt;prio2&gt; ... Generate the path priority
base on the regular expressions and the priorities provided.
hbtl regexes are of the SCSI H:B:T:L format. Ex: 1:0:0:1 ,
5:.* devname regexes are device names Ex: sda , sd.e Note:
These values may change on reboot, or if the device is
removed. Using this prioritizer may require edit- ting
multipath.conf after bootup to cor- rectly set the
priority.</p>

<p>Default value is const.</p>

<p>features Specify any device-mapper features to be used.
Syntax is num list where num is the number of features in
list. Possible values for the feature list are</p>

<p>queue_if_no_path Queue IO if no path is active;
identical to the no_path_retry keyword.</p>

<p>no_partitions Disable automatic partitions generation
via kpartx.</p>

<p>path_checker The default method used to determine the
paths state. Possible values are</p>

<p>readsector0 Read the first sector of the device</p>

<p>tur Issue a TEST UNIT READY command to the device.</p>

<p>emc_clariion Query the EMC Clariion specific EVPD page
0xC0 to determine the path state.</p>

<p>hp_sw Check the path state for HP storage arrays with
Active/Standby firmware.</p>

<p>rdac Check the path state for LSI/Enge- nio/NetApp
E-Series RDAC storage con- troller.</p>

<p>directio Read the first sector with direct I/O.</p>

<p>Default value is readsector0.</p>

<p>failback Tell multipathd how to manage path group
failback.</p>

<p>immediate Immediately failback to the highest prior- ity
pathgroup that contains active paths.</p>

<p>manual Do not perform automatic failback.</p>

<p>followover Only perform automatic failback when the
first path of a pathgroup becomes active. This keeps a node
from automatically fail- ing back when another node
requested the failover.</p>

<p>values &gt; 0 deferred failback (time to defer in sec-
onds)</p>

<p>Default value is manual.</p>

<p>rr_min_io The number of IO to route to a path before
switching to the next in the same path group, using
bio-based device-mapper-multipath. This is only for systems
run- ning kernels older that 2.6.31. Newer systems should
use rr_min_io_rq. Default is 1000</p>

<p>rr_min_io_rq The number of IO to route to a path before
switching to the next in the same path group, using request-
based device-mapper-multipath. This setting should be used
on systems running current kernels. On systems running
kernels older than 2.6.31, use rr_min_io. Default is 1</p>

<p>rr_weight If set to priorities the multipath
configurator will assign path weights as &quot;path prio *
rr_min_io&quot;. Possi- ble values are priorities or uniform
uniform</p>

<p>no_path_retry Specify the number of retries until
disable queueing, or fail for immediate failure (no
queueing), queue for never stop queueing. Default is 0.</p>

<p>user_friendly_names If set to yes , using the bindings
file /etc/multi- path/bindings to assign a persistent and
unique alias to the multipath, in the form of
mpath&lt;n&gt;. If set to no use the WWID as the alias. In
either case this be will be overriden by any specific
aliases in the mul- tipaths section. Default is no</p>

<p>queue_without_daemon If set to no , multipathd will
disable queueing for all devices when it is shut down.
Default is yes</p>

<p>flush_on_last_del If set to yes , multipathd will
disable queueing when the last path to a device has been
deleted. Default is no</p>

<p>max_fds Specify the maximum number of file descriptors
that can be opened by multipath and multipathd. This is
equivalent to ulimit -n. A value of max will set this to the
system limit from /proc/sys/fs/nr_open. If this is not set,
the maximum number of open fds is taken from the calling
process. It is usually 1024. To be safe, this should be set
to the maximum number of paths plus 32, if that number is
greated than 1024.</p>

<p>checker_timeout Specify the timeout to user for path
checkers and pri- oritizers that issue scsi commands with an
explict timeout, in seconds; default taken from
/sys/block/sd&lt;x&gt;/device/timeout</p>

<p>fast_io_fail_tmo Specify the number of seconds the scsi
layer will wait after a problem has been detected on a FC
remote port before failing IO to devices on that remote
port. This should be smaller than dev_loss_tmo. Setting this
to off will disable the timeout.</p>

<p>dev_loss_tmo Specify the number of seconds the scsi
layer will wait after a problem has been detected on a FC
remote port before removing it from the system. This can be
set to &quot;infinity&quot; which sets it to the max value
of 2147483647 seconds, or 68 years.</p>

<p>log_checker_err If set to once , multipathd logs the
first path checker error at logging level 2. Any later
errors are logged at level 3 until the device is restored.
If set to always , multipathd always logs the path checker
error at logging level 2. Default is always</p>

<p>hwtable_regex_match If set to yes , user device configs
will be regular expression matched against the builtin
configs to determine if they should modify an existing
config or create a new one. If set to no , user device
configs will be string matched against the builtin configs
to determine if they should modify an existing config or
create a new one. Default is no</p>

<p>reservation_key This is the service action reservation
key used by mpathpersist. It must be set for all multipath
devices using persistent reservations, and it must be the
same as the RESERVATION KEY field of the PERSIS- TENT
RESERVE OUT parameter list which contains an 8-byte value
provided by the application client to the device server to
identify the I_T nexus. It is unset by default.</p>

<p>retain_attached_hw_handler If set to yes and the scsi
layer has already attached a hardware_handler to the device,
multipath will not force the device to use the
hardware_handler specified by mutipath.conf. If the scsi
layer has not attached a hardware handler, multipath will
continue to use its configured hardware handler. Default is
no</p>

<p>detect_prio If set to yes , multipath will try to detect
if the device supports ALUA. If so, the device will
automati- cally use the alua prioritizer. If not, the
priori- tizer will be selected as usual. Default is no</p>

<p>reload_readwrite If set to yes , multipathd will monitor
change events on path devices. When it receives a change
event for a path of a readonly multipath device, it will
check if the path is now read/write. If so, multipathd will
reload the multipath device to switch it to read/write.
Default is no</p>

<p>replace_wwid_whitespace If set to yes devices using the
default getuid callout (scsi_id) will add
--relace-whitespace to the callout line. This will cause any
whitespace in the wwid to be replaced with one
underscore.</p>

<p>force_sync If set to yes , multipathd will call the path
checkers in sync mode only. This means that only one checker
will run at a time. This is useful in the case where many
multipathd checkers running in parallel causes significant
CPU pressure. The Default is no</p>

<p>config_dir If set to anything other than &quot;&quot;,
multipath will search this directory alphabetically for file
ending in &quot;.conf&quot; and it will read configuration
information from them, just as if it was in
/etc/multipath.conf. config_dir must either be &quot;&quot;
or a fully qualified directory name. Default is
/etc/multipath/conf.d</p>

<p>delay_watch_checks If set to a value greater than 0,
multipathd will watch paths that have recently become valid
for this many checks. If they fail again while they are
being watched, when they next become valid, they will not be
used until they have stayed up for delay_wait_checks checks.
Default is no</p>

<p>delay_wait_checks If set to a value greater than 0, when
a device that has recently come back online fails again
within delay_watch_checks checks, the next time it comes
back online, it will marked and delayed, and not used until
it has passed delay_wait_checks checks. Default is no</p>

<p>blacklist section The blacklist section is used to
exclude specific device from inclusion in the multipath
topology. It is most commonly used to exclude local disks or
LUNs for the array controller.</p>

<p>The following keywords are recognized:</p>

<p>wwid The World Wide Identification of a device.</p>

<p>devnode Regular expression of the device nodes to be
excluded.</p>

<p>device Subsection for the device description. This
subsection recognizes the vendor and product keywords. For a
full description of these keywords please see the devices
section description.</p>

<p>blacklist_exceptions section The blacklist_exceptions
section is used to revert the actions of the blacklist
section, ie to include specific device in the multipath
topology. This allows to selectively include devices which
would normally be excluded via the blacklist section.</p>

<p>The following keywords are recognized:</p>

<p>wwid The World Wide Identification of a device.</p>

<p>devnode Regular expression of the device nodes to be
excluded.</p>

<p>device Subsection for the device description. This
subsection recognizes the vendor and product keywords. For a
full description of these keywords please see the devices
section description.</p>

<p>multipaths section The only recognized attribute for the
multipaths section is the multi- path subsection.</p>

<p>The multipath subsection recognizes the following
attributes:</p>

<p>wwid Index of the container. Mandatory for this
subsection.</p>

<p>alias (Optional) symbolic name for the multipath
map.</p>

<p>The following attributes are optional; if not set the
default values are taken from the defaults section:</p>

<p>path_grouping_policy path_selector failback prio
no_path_retry rr_min_io rr_min_io_rq rr_weight
flush_on_last_del reservation_key delay_watch_checks
delay_wait_checks</p>

<p>devices section The only recognized attribute for the
devices section is the device subsection.</p>

<p>The device subsection recognizes the following
attributes:</p>

<p>vendor (Mandatory) Vendor identifier</p>

<p>product (Mandatory) Product identifier</p>

<p>revision Revision identifier</p>

<p>product_blacklist Product strings to blacklist for this
vendor</p>

<p>hardware_handler (Optional) The hardware handler to use
for this device type. The following hardware handler are
implemented:</p>

<p>1 emc Hardware handler for EMC storage arrays.</p>

<p>1 alua Hardware handler for SCSI-3 ALUA arrays.</p>

<p>1 hp_sw Hardware handler for Compaq/HP con-
trollers.</p>

<p>1 rdac Hardware handler for the LSI/Enge- nio/NetApp
E-Series RDAC storage controller.</p>

<p>The following attributes are optional; if not set the
default values are taken from the defaults section:</p>

<p>path_grouping_policy getuid_callout path_selector
path_checker features prio failback rr_weight no_path_retry
rr_min_io rr_min_io_rq fast_io_fail_tmo dev_loss_tmo
flush_on_last_del retain_attached_hw_handler detect_prio
reload_readwrite delay_watch_checks delay_wait_checks</p>

<p>KNOWN ISSUES The usage of queue_if_no_path option can
lead to D state processes being hung and not killable in
situations where all the paths to the LUN go offline. It is
advisable to use the no_path_retry option instead.</p>

<p>SEE ALSO udev(8), dmsetup(8) multipath(8)
multipathd(8)</p>

<p>AUTHORS multipath was developed by Christophe Varoqui,
&lt;christophe.varo- qui@free.fr&gt; and others.</p>

<p>30 November 2006 MULTIPATH.CONF(5)</p>
<hr>
</body>
</html>
