<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:23:57 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>MSGGET(2) Linux Programmer s Manual MSGGET(2)</p>

<p>NAME msgget - get a message queue identifier</p>

<p>SYNOPSIS #include &lt;sys/types.h&gt; #include
&lt;sys/ipc.h&gt; #include &lt;sys/msg.h&gt;</p>

<p>int msgget(key_t key, int msgflg);</p>

<p>DESCRIPTION The msgget() system call returns the message
queue identifier associ- ated with the value of the key
argument. A new message queue is cre- ated if key has the
value IPC_PRIVATE or key isn t IPC_PRIVATE, no mes- sage
queue with the given key key exists, and IPC_CREAT is
specified in msgflg.</p>

<p>If msgflg specifies both IPC_CREAT and IPC_EXCL and a
message queue already exists for key, then msgget() fails
with errno set to EEXIST. (This is analogous to the effect
of the combination O_CREAT | O_EXCL for open(2).)</p>

<p>Upon creation, the least significant bits of the
argument msgflg define the permissions of the message queue.
These permission bits have the same format and semantics as
the permissions specified for the mode argument of open(2).
(The execute permissions are not used.)</p>

<p>If a new message queue is created, then its associated
data structure msqid_ds (see msgctl(2)) is initialized as
follows:</p>

<p>msg_perm.cuid and msg_perm.uid are set to the effective
user ID of the calling process.</p>

<p>msg_perm.cgid and msg_perm.gid are set to the effective
group ID of the calling process.</p>

<p>The least significant 9 bits of msg_perm.mode are set to
the least significant 9 bits of msgflg.</p>

<p>msg_qnum, msg_lspid, msg_lrpid, msg_stime and msg_rtime
are set to 0.</p>

<p>msg_ctime is set to the current time.</p>

<p>msg_qbytes is set to the system limit MSGMNB.</p>

<p>If the message queue already exists the permissions are
verified, and a check is made to see if it is marked for
destruction.</p>

<p>RETURN VALUE If successful, the return value will be the
message queue identifier (a non-negative integer), otherwise
-1 with errno indicating the error.</p>

<p>ERRORS On failure, errno is set to one of the following
values:</p>

<p>EACCES A message queue exists for key, but the calling
process does not have permission to access the queue, and
does not have the CAP_IPC_OWNER capability.</p>

<p>EEXIST A message queue exists for key and msgflg
specified both IPC_CREAT and IPC_EXCL.</p>

<p>ENOENT No message queue exists for key and msgflg did
not specify IPC_CREAT.</p>

<p>ENOMEM A message queue has to be created but the system
does not have enough memory for the new data structure.</p>

<p>ENOSPC A message queue has to be created but the system
limit for the maximum number of message queues (MSGMNI)
would be exceeded.</p>

<p>CONFORMING TO SVr4, POSIX.1-2001.</p>

<p>NOTES IPC_PRIVATE isnt a flag field but a key_t type. If
this special value is used for key, the system call ignores
everything but the least sig- nificant 9 bits of msgflg and
creates a new message queue (on success).</p>

<p>The following is a system limit on message queue
resources affecting a msgget() call:</p>

<p>MSGMNI System wide maximum number of message queues:
policy dependent (on Linux, this limit can be read and
modified via /proc/sys/kernel/msgmni).</p>

<p>Linux Notes Until version 2.3.20 Linux would return
EIDRM for a msgget() on a mes- sage queue scheduled for
deletion.</p>

<p>BUGS The name choice IPC_PRIVATE was perhaps
unfortunate, IPC_NEW would more clearly show its
function.</p>

<p>SEE ALSO msgctl(2), msgrcv(2), msgsnd(2), ftok(3),
capabilities(7), mq_overview(7), svipc(7)</p>

<p>COLOPHON This page is part of release 3.22 of the Linux
man-pages project. A description of the project, and
information about reporting bugs, can be found at
http://www.kernel.org/doc/man-pages/.</p>

<p>Linux 2004-05-27 MSGGET(2)</p>
<hr>
</body>
</html>
