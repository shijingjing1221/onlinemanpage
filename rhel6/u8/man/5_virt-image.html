<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:43:53 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>virt-image(5) Virtual Machine Install Tools
virt-image(5)</p>

<p>NAME virt-image - Format of the virtual image XML
descriptor</p>

<p>DESCRIPTION virt-image(1) relies on an XML descriptor to
create virtual machines from virtual machine images. In
general, a virtual machine image consists of the XML
descriptor (usually in a file image.xml) and a number of
files for the virtual machines disks.</p>

<p>In the following explanation of the structure of the
image descriptor, mandatory XML elements are marked as
element, whereas optional elements are marked as
element.</p>

<p>All file names in the image descriptor are relative to
the location of the descriptor itself. Generally, disk files
are either kept in the same directory as the image
descriptor, or in a subdirectory.</p>

<p>HOST MATCHING The image descriptor contains information
on the requirements a guest has on the host platform through
one or more the /image/domain/boot descriptors (see section
&quot;BOOT&quot;). The image can only be used if at least
one of the boot descriptors is suitable for the host
platform; a boot descriptor is suitable if:</p>

<p>&middot; The CPU architecture of the boot descriptor,
given by the boot/guest/arch element, is supported by the
host</p>

<p>&middot; The host supports a guest with the features
requested in the boot/guest/features element, such as
providing an APIC, or having ACPI turned off</p>

<p>If a suitable boot descriptor is found, the guest is
created and booted according to the information about
booting the OS from the boot/os element and with the disks
specified in the boot/drive element. If more than one
suitable boot descriptor is found, one of them is chosen
based on a heuristic, generally preferring paravirtualized
guests over full virtualized ones, though this is an
implementation detail of the tool creating the virtual
machine.</p>

<p>STRUCTURE The image descriptor consists of three
sections, all contained in the toplevel image element:</p>

<p>General metadata about the image A number of elements
like label, name, and description that give some simple
information about the image. The name must be a string
suitable as a name for the virtual machine, the label is a
short human-readable string suitable for display in
graphical UIs, and the description should be a longer,
free-form description of the purpose of the image. The name
is mandatory.</p>

<p>Virtual machine attributes The domain element contains
instructions on how to boot the image, and device attributes
such as the number of virtual CPUs and the size of the
memory. (see section &quot;DOMAIN&quot;)</p>

<p>Storage layout The storage element lists the files to
back the virtual machines disks and some information about
their format and use. (see section &quot;STORAGE&quot;)</p>

<p>DOMAIN The domain element contains one or more boot
descriptors (see section &quot;BOOT&quot;) and a devices
element. The Devices element lists the recommended number of
virtual CPUs in the vcpu element and the recommended amount
of memory in kB in the memory element. It also indicates
whether the virtual machine should have a network interface
through the interface element and whether the virtual
machine has a graphical interface through the graphics
element.</p>

<p>BOOT Each boot descriptor details how the virtual
machine should be started on a certain hypervisor. The type
attribute of the boot element, which can either be
&quot;xen&quot; or &quot;hvm&quot;, depending on whether the
boot descriptor is for a paravirtualized Xen(tm) guest or a
fully-virtualized guest.</p>

<p>The boot element contains three subelements:</p>

<p>The platform requirements of the guest The platform
requirements, contained in the guest element, consist of the
arch element and the features element. The arch element
indicates the CPU architecture the guest expects, e.g.
&quot;i686&quot;, &quot;x86_64&quot;, or
&quot;ppc&quot;.</p>

<p>The features element indicates whether certain platform
features should be on or off. Currently, the platform
features are pae, acpi, and apic. Omitting a togglable
feature tag turns it off.</p>

<p>The details of booting the images operating system The
os element for fully-virtualized &quot;hvm&quot; guests
contains a loader element whose dev attribute indicates
whether to boot off a hard disk
(&quot;dev=&rsquo;hd&rsquo;&quot;) or off a CD-ROM
(&quot;dev=&rsquo;cdrom&rsquo;&quot;)</p>

<p>For paravirtualized guests, the os element either
contains a &quot;&lt;loader&gt;pygrub&lt;/loader&gt;&quot;
element, indicating that the guest should be booted with
pygrub, or kernel, initrd and cmdline elements. The contents
of the kernel and initrd elements are the names of the
kernel and initrd files, whereas the cmdline element
contains the command line that should be passed to the
kernel on boot.</p>

<p>The mapping of disk files as devices into the guest The
mapping of disk files into the guest is performed by a list
of drive elements inside the boot element. Each drive
element references the name of a disk file from the
&quot;STORAGE&quot; section through its disk attribute and
can optionally specify as what device that disk file should
appear in the guest through its target attribute. If the
target is omitted, device names are assigned in the order in
which the drive elements appear, skipping already assigned
devices.</p>

<p>STORAGE The storage element lists the disk image files
that are part of the virtual machine image in a list of one
or more disk elements. Each disk element can contain the
following attributes:</p>

<p>&middot; the file attribute giving the name of the disk
file</p>

<p>&middot; an optional id attribute. The name given with
that attribute is used to reference the disk from the drive
element of a boot descriptor. If the id attribute is
missing, it defaults to the file attribute.</p>

<p>&middot; the use attribute indicating whether the disk
file is a &quot;system&quot;, &quot;user&quot;, or
&quot;scratch&quot; disk. The use attribute differentiates
disk files so that an update based on replacing disk files
can replace &quot;system&quot; disks, but leave
&quot;user&quot; disks untouched.</p>

<p>Generally, &quot;system&quot; disks contain application
code, &quot;user&quot; disks contain the application s data,
and &quot;scratch&quot; disks contain temporary state that
can be erased between runs of the guest.</p>

<p>The virtual machine image must contain files for all
&quot;system&quot; disks, and may contain files for the
&quot;user&quot; and &quot;scratch&quot; disks. If the
latter are not part of the image, they are initialized as
empty files when a guest is created, with the size given by
the size attribute.</p>

<p>&middot; the size attribute giving the size of the disk
in MB.</p>

<p>&middot; the format attribute giving the format of the
disk file. Currently, this can be one of: &quot;raw&quot;,
&quot;iso&quot;, &quot;qcow2&quot;, or &quot;vmdk&quot;.</p>

<p>EXAMPLE The image descriptor below can be used to create
a virtual machine running the System Rescue CD
(&quot;http://www.sysresccd.org/&quot;) Besides the
descriptor, you only need the ISO image from the System
Rescue CD website.</p>

<p>&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF-8&quot;?&gt; &lt;image&gt;
&lt;name&gt;sysresccd&lt;/name&gt; &lt;domain&gt; &lt;boot
type=&quot;hvm&quot;&gt; &lt;guest&gt;
&lt;arch&gt;i686&lt;/arch&gt; &lt;/guest&gt; &lt;os&gt;
&lt;loader dev=&quot;cdrom&quot;/&gt; &lt;/os&gt; &lt;drive
disk=&quot;root.raw&quot; target=&quot;hda&quot;/&gt;
&lt;drive disk=&quot;sysresc&quot;/&gt; &lt;/boot&gt;
&lt;devices&gt; &lt;vcpu&gt;1&lt;/vcpu&gt;
&lt;memory&gt;262144&lt;/memory&gt; &lt;interface/&gt;
&lt;graphics/&gt; &lt;/devices&gt; &lt;/domain&gt;
&lt;storage&gt; &lt;disk file=&quot;root.raw&quot;
use=&quot;scratch&quot; size=&quot;100&quot;
format=&quot;raw&quot;/&gt; &lt;disk id=&quot;sysresc&quot;
file=&quot;isos/systemrescuecd.iso&quot;
use=&quot;system&quot; format=&quot;iso&quot;/&gt;
&lt;/storage&gt; &lt;/image&gt;</p>

<p>To create a virtual machine, save the above XML in
image.xml and run:</p>

<p># virt-image --vnc image.xml</p>

<p>AUTHOR Written by David Lutterkort. See the AUTHORS file
in the source distribution for the complete list of
credits.</p>

<p>BUGS Please see
&quot;http://virt-manager.org/page/BugReporting&quot;</p>

<p>COPYRIGHT Copyright (C) 2006-2007 Red Hat, Inc, and
various contributors. This is free software. You may
redistribute copies of it under the terms of the GNU General
Public License
&quot;http://www.gnu.org/licenses/gpl.html&quot;. There is
NO WARRANTY, to the extent permitted by law.</p>

<p>SEE ALSO virt-image(1), virt-install(1), the project
website &quot;http://virt-manager.org&quot;, the Relax-NG
grammar for image XML &quot;image.rng&quot;</p>

<p>2015-06-03 virt-image(5)</p>
<hr>
</body>
</html>
