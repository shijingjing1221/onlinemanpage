<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:25:06 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>OCF_HEARTBEAT_MYSQL(7) OCF resource agents
OCF_HEARTBEAT_MYSQL(7)</p>

<p>NAME ocf_heartbeat_mysql - Manages a MySQL database
instance</p>

<p>SYNOPSIS mysql [start | stop | status | monitor |
promote | demote | meta-data | validate-all]</p>

<p>DESCRIPTION Resource script for MySQL. May manage a
standalone MySQL database, a clone set with externally
managed replication, or a complete master/slave replication
setup.</p>

<p>While managing replication, the default behavior is to
use uname -n values in the change master to command. Other
IPs can be specified manually by adding a node attribute
${INSTANCE_ATTR_NAME}_mysql_master_IP giving the IP to use
for replication. For example, if the mysql primitive you are
using is p_mysql, the attribute to set will be
p_mysql_mysql_master_IP.</p>

<p>SUPPORTED PARAMETERS binary Location of the MySQL server
binary</p>

<p>(optional, string, default
&quot;/usr/bin/safe_mysqld&quot;)</p>

<p>client_binary Location of the MySQL client binary</p>

<p>(optional, string, default &quot;mysql&quot;)</p>

<p>config Configuration file</p>

<p>(optional, string, default &quot;/etc/my.cnf&quot;)</p>

<p>datadir Directory containing databases</p>

<p>(optional, string, default
&quot;/var/lib/mysql&quot;)</p>

<p>user User running MySQL daemon</p>

<p>(optional, string, default &quot;mysql&quot;)</p>

<p>group Group running MySQL daemon (for logfile and
directory permissions)</p>

<p>(optional, string, default &quot;mysql&quot;)</p>

<p>log The logfile to be used for mysqld.</p>

<p>(optional, string, default
&quot;/var/log/mysqld.log&quot;)</p>

<p>pid The pidfile to be used for mysqld.</p>

<p>(optional, string, default
&quot;/var/run/mysql/mysqld.pid&quot;)</p>

<p>socket The socket to be used for mysqld.</p>

<p>(optional, string, default
&quot;/var/lib/mysql/mysql.sock&quot;)</p>

<p>test_table Table to be tested in monitor statement (in
database.table notation)</p>

<p>(optional, string, default &quot;mysql.user&quot;)</p>

<p>test_user MySQL test user, must have select privilege on
test_table</p>

<p>(optional, string, default &quot;root&quot;)</p>

<p>test_passwd MySQL test user password</p>

<p>(optional, string, no default)</p>

<p>enable_creation If the MySQL database does not exist, it
will be created</p>

<p>(optional, boolean, default 0)</p>

<p>additional_parameters Additional parameters which are
passed to the mysqld on startup. (e.g.
--skip-external-locking or --skip-grant-tables)</p>

<p>(optional, string, no default)</p>

<p>replication_user MySQL replication user. This user is
used for starting and stopping MySQL replication, for
setting and resetting the master host, and for setting and
unsetting read-only mode. Because of that, this user must
have SUPER, REPLICATION SLAVE, REPLICATION CLIENT, and
PROCESS privileges on all nodes within the cluster.
Mandatory if you define a master-slave resource.</p>

<p>(optional, string, no default)</p>

<p>replication_passwd MySQL replication password. Used for
replication client and slave. Mandatory if you define a
master-slave resource.</p>

<p>(optional, string, no default)</p>

<p>replication_port The port on which the Master MySQL
instance is listening.</p>

<p>(optional, string, default &quot;3306&quot;)</p>

<p>max_slave_lag The maximum number of seconds a
replication slave is allowed to lag behind its master. Do
not set this to zero. What the cluster manager does in case
a slave exceeds this maximum lag is determined by the
evict_outdated_slaves parameter.</p>

<p>(optional, integer, default 3600)</p>

<p>evict_outdated_slaves If set to true, any slave which is
more than max_slave_lag seconds behind the master has its
MySQL instance shut down. If this parameter is set to false
in a primitive or clone resource, it is simply ignored. If
set to false in a master/slave resource, then exceeding the
maximum slave lag will merely push down the master
preference so the lagging slave is never promoted to the new
master.</p>

<p>(optional, boolean, default false)</p>

<p>reader_attribute An attribute that the RA can manage to
specify whether a node can be read from. This node attribute
will be 1 if it&acute;s fine to read from the node, and 0
otherwise (for example, when a slave has lagged too far
behind the master).</p>

<p>A typical example for the use of this attribute would be
to tie a set of IP addresses to MySQL slaves that can be
read from.</p>

<p>This parameter is only meaningful in master/slave set
configurations.</p>

<p>(unique, optional, string, default
&quot;readable&quot;)</p>

<p>SUPPORTED ACTIONS This resource agent supports the
following actions (operations):</p>

<p>start Starts the resource. Suggested minimum timeout:
120.</p>

<p>stop Stops the resource. Suggested minimum timeout:
120.</p>

<p>status Performs a status check. Suggested minimum
timeout: 60.</p>

<p>monitor Performs a detailed status check. Suggested
minimum timeout: 30. Suggested interval: 20.</p>

<p>monitor (Master role) Performs a detailed status check.
Suggested minimum timeout: 30. Suggested interval: 10.</p>

<p>monitor (Slave role) Performs a detailed status check.
Suggested minimum timeout: 30. Suggested interval: 30.</p>

<p>promote Promotes the resource to the Master role.
Suggested minimum timeout: 120.</p>

<p>demote Demotes the resource to the Slave role. Suggested
minimum timeout: 120.</p>

<p>notify Suggested minimum timeout: 90.</p>

<p>validate-all Performs a validation of the resource
configuration. Suggested minimum timeout: 5.</p>

<p>meta-data Retrieves resource agent metadata (internal
use only). Suggested minimum timeout: 5.</p>

<p>EXAMPLE The following is an example configuration for a
mysql resource using the crm(8) shell:</p>

<p>primitive p_mysql ocf:heartbeat:mysql op monitor
depth=&quot;0&quot; timeout=&quot;30&quot;
interval=&quot;20&quot; op monitor role=&quot;Master&quot;
depth=&quot;0&quot; timeout=&quot;30&quot;
interval=&quot;10&quot; op monitor role=&quot;Slave&quot;
depth=&quot;0&quot; timeout=&quot;30&quot;
interval=&quot;30&quot;</p>

<p>ms ms_mysql p_mysql meta notify=&quot;true&quot;
interleave=&quot;true&quot;</p>

<p>SEE ALSO
http://www.linux-ha.org/wiki/mysql_(resource_agent)</p>

<p>AUTHOR Linux-HA contributors (see the resource agent
source for information about individual authors)</p>

<p>resource-agents 3.9.2 02/25/2016
OCF_HEARTBEAT_MYSQL(7)</p>
<hr>
</body>
</html>
