<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:43:52 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>virt-df(1) Virtualization Support virt-df(1)</p>

<p>NAME virt-df - Display free space on virtual
filesystems</p>

<p>SYNOPSIS All guests:</p>

<p>virt-df [--options]</p>

<p>Single guest:</p>

<p>virt-df [--options] -d domname</p>

<p>virt-df [--options] -a disk.img [-a disk.img ...]</p>

<p>Old style:</p>

<p>virt-df [--options] domname</p>

<p>virt-df [--options] disk.img [disk.img ...]</p>

<p>DESCRIPTION &quot;virt-df&quot; is a command line tool
to display free space on virtual machine filesystems. Unlike
other tools, it doesnt just display the size of disk
allocated to a virtual machine, but can look inside disk
images to see how much space is really being used.</p>

<p>If used without any -a or -d arguments,
&quot;virt-df&quot; checks with libvirt to get a list of all
active and inactive guests, and performs a
&quot;df&quot;-type operation on each one in turn, printing
out the results.</p>

<p>If any -a or -d arguments are specified,
&quot;virt-df&quot; performs a &quot;df&quot;-type operation
on either the single named libvirt domain, or on the disk
image(s) listed on the command line (which must all belong
to a single VM). In this mode (with arguments),
&quot;virt-df&quot; will only work for a single guest. If
you want to run on multiple guests, then you have to invoke
&quot;virt-df&quot; multiple times.</p>

<p>Use the --csv option to get a format which can be easily
parsed by other programs. Other options are similar to the
standard df(1) command.</p>

<p>EXAMPLES Show disk usage for a single libvirt guest
called &quot;F14x64&quot;. Make the output
human-readable:</p>

<p># virt-df -d F14x64 -h Filesystem Size Used Available
Use% F14x64:/dev/sda1 484M 66M 393M 14%
F14x64:/dev/vg_f13x64/lv_root 7.4G 3.4G 4.0G 46%</p>

<p>Show disk usage for a disk image file called
&quot;test.img&quot;:</p>

<p>$ virt-df -a test1.img Filesystem 1K-blocks Used
Available Use% test1.img:/dev/sda1 99099 1551 92432 2%</p>

<p>If a single guest has multiple disks, use the -a option
repeatedly. A plus sign (&quot;+&quot;) is displayed for
each additional disk. Note: Do not do this with unrelated
guest disks.</p>

<p>$ virt-df -a Win7x32TwoDisks-a -a Win7x32TwoDisks-b
Filesystem 1K-blocks Used Available Use%
Win7x32TwoDisks-a+:/dev/sda1 102396 24712 77684 25%
Win7x32TwoDisks-a+:/dev/sda2 12478460 7403416 5075044 60%
Win7x32TwoDisks-a+:/dev/sdb1 521212 55728 465484 11%</p>

<p>OPTIONS --help Display brief help.</p>

<p>-a file --add file Add file which should be a disk image
from a virtual machine. If the virtual machine has multiple
block devices, you must supply all of them with separate -a
options.</p>

<p>The format of the disk image is auto-detected. To
override this and force a particular format use the
--format=.. option.</p>

<p>-c URI --connect URI If using libvirt, connect to the
given URI. If omitted, then we connect to the default
libvirt hypervisor.</p>

<p>If you specify guest block devices directly (-a), then
libvirt is not used at all.</p>

<p>--csv Write out the results in CSV format
(comma-separated values). This format can be imported easily
into databases and spreadsheets, but read &quot;NOTE ABOUT
CSV FORMAT&quot; below.</p>

<p>-d guest --domain guest Add all the disks from the named
libvirt guest. Domain UUIDs can be used instead of
names.</p>

<p>--format=raw|qcow2|.. --format The default for the -a
option is to auto-detect the format of the disk image. Using
this forces the disk format for -a options which follow on
the command line. Using --format with no argument switches
back to auto-detection for subsequent -a options.</p>

<p>For example:</p>

<p>virt-df --format=raw -a disk.img</p>

<p>forces raw format (no auto-detection) for
&quot;disk.img&quot;.</p>

<p>virt-df --format=raw -a disk.img --format -a
another.img</p>

<p>forces raw format (no auto-detection) for
&quot;disk.img&quot; and reverts to auto-detection for
&quot;another.img&quot;.</p>

<p>If you have untrusted raw-format guest disk images, you
should use this option to specify the disk format. This
avoids a possible security problem with malicious guests
(CVE-2010-3851).</p>

<p>-h --human-readable Print sizes in human-readable
format.</p>

<p>You are not allowed to use -h and --csv at the same
time.</p>

<p>-i --inodes Print inodes instead of blocks.</p>

<p>--one-per-guest Run one libguestfs appliance per guest.
Normally &quot;virt-df&quot; will add the disks from several
guests to a single libguestfs appliance.</p>

<p>You might use this option in the following
circumstances:</p>

<p>&middot; If you think an untrusted guest might actively
try to exploit the libguestfs appliance kernel, then this
prevents one guest from interfering with the stats printed
for another guest.</p>

<p>&middot; If the kernel has a bug which stops it from
accessing a filesystem in one guest (see for example
RHBZ#635373) then this allows libguestfs to continue and
report stats for further guests.</p>

<p>--uuid Print UUIDs instead of names. This is useful for
following a guest even when the guest is migrated or
renamed, or when two guests happen to have the same
name.</p>

<p>Note that only domains that we fetch from libvirt come
with UUIDs. For disk images, we still print the disk image
name even when this option is specified.</p>

<p>-v --verbose Enable verbose messages for debugging.</p>

<p>-V --version Display version number and exit.</p>

<p>-x Enable tracing of libguestfs API calls.</p>

<p>STATVFS NUMBERS &quot;virt-df&quot; (and df(1)) get
information by issuing a statvfs(3) system call. You can get
the same information directly, either from the host (using
libguestfs) or inside the guest:</p>

<p>From the host Run this command:</p>

<p>guestfish --ro -d GuestName -i statvfs /</p>

<p>(change &quot;/&quot; to see stats for other
filesystems).</p>

<p>From inside the guest Run this command:</p>

<p>python -c &rsquo;import os; s = os.statvfs
(&quot;/&quot;); print s&rsquo;</p>

<p>(change &quot;/&quot; to see stats for other
filesystems).</p>

<p>NOTE ABOUT CSV FORMAT Comma-separated values (CSV) is a
deceptive format. It seems like it should be easy to parse,
but it is definitely not easy to parse.</p>

<p>Myth: Just split fields at commas. Reality: This does
not work reliably. This example has two columns:</p>

<p>&quot;foo,bar&quot;,baz</p>

<p>Myth: Read the file one line at a time. Reality: This
does not work reliably. This example has one row:</p>

<p>&quot;foo bar&quot;,baz</p>

<p>For shell scripts, use &quot;csvtool&quot;
(http://merjis.com/developers/csv also packaged in major
Linux distributions).</p>

<p>For other languages, use a CSV processing library (eg.
&quot;Text::CSV&quot; for Perl or Pythons built-in csv
library).</p>

<p>Most spreadsheets and databases can import CSV
directly.</p>

<p>SHELL QUOTING Libvirt guest names can contain arbitrary
characters, some of which have meaning to the shell such as
&quot;#&quot; and space. You may need to quote or escape
these characters on the command line. See the shell manual
page sh(1) for details.</p>

<p>EXIT STATUS This program returns 0 if successful, or
non-zero if there was an error.</p>

<p>SEE ALSO df(1), guestfs(3), guestfish(1),
virt-filesystems(1), http://libguestfs.org/.</p>

<p>AUTHOR Richard W.M. Jones
http://people.redhat.com/~rjones/</p>

<p>COPYRIGHT Copyright (C) 2009-2013 Red Hat Inc.</p>

<p>LICENSE This program is free software; you can
redistribute it and/or modify it under the terms of the GNU
General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your
option) any later version.</p>

<p>This program is distributed in the hope that it will be
useful, but WITHOUT ANY WARRANTY; without even the implied
warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE. See the GNU General Public License for more
details.</p>

<p>You should have received a copy of the GNU General
Public License along with this program; if not, write to the
Free Software Foundation, Inc., 51 Franklin Street, Fifth
Floor, Boston, MA 02110-1301 USA.</p>

<p>BUGS To get a list of bugs against libguestfs, use this
link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p>To report a new bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p>When reporting a bug, please supply:</p>

<p>&middot; The version of libguestfs.</p>

<p>&middot; Where you got libguestfs (eg. which Linux
distro, compiled from source, etc)</p>

<p>&middot; Describe the bug accurately and give a way to
reproduce it.</p>

<p>&middot; Run libguestfs-test-tool(1) and paste the
complete, unedited output into the bug report.</p>

<p>libguestfs-1.20.11 2013-08-27 virt-df(1)</p>
<hr>
</body>
</html>
