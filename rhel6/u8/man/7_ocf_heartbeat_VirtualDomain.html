<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:25:07 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>OCF_HEARTBEAT_VIRTUA(7) OCF resource agents
OCF_HEARTBEAT_VIRTUA(7)</p>

<p>NAME ocf_heartbeat_VirtualDomain - Manages virtual
domains through the libvirt virtualization framework</p>

<p>SYNOPSIS VirtualDomain [start | stop | status | monitor
| migrate_to | migrate_from | meta-data | validate-all]</p>

<p>DESCRIPTION Resource agent for a virtual domain (a.k.a.
domU, virtual machine, virtual environment etc., depending
on context) managed by libvirtd.</p>

<p>This resource agent may be configured for native
migration if available in the cluster manager. For
Pacemaker, the allow-migrate=&quot;true&quot; meta attribute
enables native migration.</p>

<p>SUPPORTED PARAMETERS config Absolute path to the libvirt
configuration file, for this virtual domain.</p>

<p>(unique, required, string, no default)</p>

<p>hypervisor Hypervisor URI to connect to. See the libvirt
documentation for details on supported URI formats. The
default is system dependent.</p>

<p>(optional, string, no default)</p>

<p>force_stop Always forcefully shut down
(&quot;destroy&quot;) the domain on stop. The default
behavior is to resort to a forceful shutdown only after a
graceful shutdown attempt has failed. You should only set
this to true if your virtual domain (or your virtualization
backend) does not support graceful shutdown.</p>

<p>(optional, boolean, default 0)</p>

<p>migration_transport Transport used to connect to the
remote hypervisor while migrating. Please refer to the
libvirt documentation for details on transports available.
If this parameter is omitted, the resource will use
libvirt&acute;s default transport to connect to the remote
hypervisor.</p>

<p>(optional, string, no default)</p>

<p>migration_network_suffix Use a dedicated migration
network. The migration URI is composed by adding this
parameters value to the end of the node name. If the node
name happens to be an FQDN (as opposed to an unqualified
host name), insert the suffix immediately prior to the first
period (.) in the FQDN. At the moment Qemu/KVM and Xen
migration via a dedicated network is supported.</p>

<p>Note: Be sure this composed host name is locally
resolveable and the associated IP is reachable through the
favored network.</p>

<p>See also the migrate_options parameter below.</p>

<p>(optional, string, no default)</p>

<p>migrate_options Extra virsh options for the guest live
migration. You can also specify here --migrateuri if the
calculated migrate URI is unsuitable for your environment.
If --migrateuri is set then migration_network_suffix and
migrateport are effectively ignored. Use &quot;%n&quot; as
the placeholder for the target node name.</p>

<p>Please refer to the libvirt documentation for details on
guest migration.</p>

<p>(optional, string, no default)</p>

<p>monitor_scripts To additionally monitor services within
the virtual domain, add this parameter with a list of
scripts to monitor.</p>

<p>Note: when monitor scripts are used, the start and
migrate_from operations will complete only when all monitor
scripts have completed successfully. Be sure to set the
timeout of these operations to accommodate this delay.</p>

<p>(optional, string, no default)</p>

<p>autoset_utilization_cpu If set true, the agent will
detect the number of domainU&acute;s vCPUs from virsh, and
put it into the CPU utilization of the resource when the
monitor is executed.</p>

<p>(optional, boolean, default true)</p>

<p>autoset_utilization_hv_memory If set true, the agent
will detect the number of *Max memory* from virsh, and put
it into the hv_memory utilization of the resource when the
monitor is executed.</p>

<p>(optional, boolean, default true)</p>

<p>migrateport This port will be used in the qemu
migrateuri. If unset, the port will be a random
highport.</p>

<p>(optional, integer, no default)</p>

<p>snapshot Path to the snapshot directory where the
virtual machine image will be stored. When this parameter is
set, the virtual machine&acute;s RAM state will be saved to
a file in the snapshot directory when stopped. If on start a
state file is present for the domain, the domain will be
restored to the same state it was in right before it stopped
last. This option is incompatible with the
&acute;force_stop&acute; option.</p>

<p>(optional, string, no default)</p>

<p>SUPPORTED ACTIONS This resource agent supports the
following actions (operations):</p>

<p>start Starts the resource. Suggested minimum timeout:
90.</p>

<p>stop Stops the resource. Suggested minimum timeout:
90.</p>

<p>status Performs a status check. Suggested minimum
timeout: 30. Suggested interval: 10.</p>

<p>monitor Performs a detailed status check. Suggested
minimum timeout: 30. Suggested interval: 10.</p>

<p>migrate_from Executes steps necessary for migrating the
resource away from the node. Suggested minimum timeout:
60.</p>

<p>migrate_to Executes steps necessary for migrating the
resource to the node. Suggested minimum timeout: 120.</p>

<p>meta-data Retrieves resource agent metadata (internal
use only). Suggested minimum timeout: 5.</p>

<p>validate-all Performs a validation of the resource
configuration. Suggested minimum timeout: 5.</p>

<p>EXAMPLE The following is an example configuration for a
VirtualDomain resource using the crm(8) shell:</p>

<p>primitive p_VirtualDomain ocf:heartbeat:VirtualDomain
params config=string meta allow-migrate=&quot;true&quot; op
monitor depth=&quot;0&quot; timeout=&quot;30&quot;
interval=&quot;10&quot;</p>

<p>SEE ALSO
http://www.linux-ha.org/wiki/VirtualDomain_(resource_agent)</p>

<p>AUTHOR Linux-HA contributors (see the resource agent
source for information about individual authors)</p>

<p>resource-agents 3.9.2 02/25/2016
OCF_HEARTBEAT_VIRTUA(7)</p>
<hr>
</body>
</html>
