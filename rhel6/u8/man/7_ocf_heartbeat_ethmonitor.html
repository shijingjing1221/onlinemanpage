<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:25:05 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>OCF_HEARTBEAT_ETHMON(7) OCF resource agents
OCF_HEARTBEAT_ETHMON(7)</p>

<p>NAME ocf_heartbeat_ethmonitor - Monitors network
interfaces</p>

<p>SYNOPSIS ethmonitor [start | stop | status | monitor |
meta-data | validate-all]</p>

<p>DESCRIPTION Monitor the vitality of a local network
interface.</p>

<p>You may set up this RA as a clone resource to monitor
the network interfaces on different nodes, with the same
interface name. This is not related to the IP address or the
network on which a interface is configured. You may use this
RA to move resources away from a node, which has a faulty
interface or prevent moving resources to such a node. This
gives you independend control of the resources, without
involving cluster intercommunication. But it requires your
nodes to have more than one network interface.</p>

<p>The resource configuration requires a monitor operation,
because the monitor does the main part of the work. In
addition to the resource configuration, you need to
configure some location constraints, based on a CIB
attribute value. The name of the attribute value is
configured in the &acute;name&acute; option of this RA.</p>

<p>Example constraint configuration: location
loc_connected_node my_resource_grp rule
=&quot;rule_loc_connected_node&quot; -INF: ethmonitor eq
0</p>

<p>The ethmonitor works in 3 different modes to test the
interface vitality. 1. call ip to see if the link status is
up (if link is down -&gt; error) 2. call ip and watch the RX
counter (if packages come around in a certain time -&gt;
success) 3. call arping to check whether any of the IPs
found in the local ARP cache answers an ARP REQUEST (one
answer -&gt; success) 4. return error</p>

<p>SUPPORTED PARAMETERS interface The name of the network
interface which should be monitored (e.g. eth0).</p>

<p>(unique, required, string, no default)</p>

<p>name The name of the CIB attribute to set. This is the
name to be used in the constraints. Defaults to
&quot;ethmonitor-&acute;interface_name&acute;&quot;.</p>

<p>(unique, optional, string, no default)</p>

<p>multiplier Multiplier for the value of the CIB
attriobute specified in parameter name.</p>

<p>(optional, integer, default 1)</p>

<p>repeat_count Specify how often the interface will be
monitored, before the status is set to failed. You need to
set the timeout of the monitoring operation to at least
repeat_count * repeat_interval</p>

<p>(optional, integer, default 5)</p>

<p>repeat_interval Specify how long to wait in seconds
between the repeat_counts.</p>

<p>(optional, integer, default 10)</p>

<p>pktcnt_timeout Timeout for the RX packet counter. Stop
listening for packet counter changes after the given number
of seconds.</p>

<p>(optional, integer, default 5)</p>

<p>arping_count Number of ARP REQUEST packets to send for
every IP. Usually one ARP REQUEST (arping) is send</p>

<p>(optional, integer, default 1)</p>

<p>arping_timeout Time in seconds to wait for ARP REQUESTs
(all packets of arping_count). This is to limit the time for
arp requests, to be able to send requests to more than one
node, without running in the monitor operation timeout.</p>

<p>(optional, integer, default 1)</p>

<p>arping_cache_entries Maximum number of IPs from ARP
cache list to check for ARP REQUEST (arping) answers. Newest
entries are tried first.</p>

<p>(optional, integer, default 5)</p>

<p>SUPPORTED ACTIONS This resource agent supports the
following actions (operations):</p>

<p>start Starts the resource. Suggested minimum timeout:
20s.</p>

<p>stop Stops the resource. Suggested minimum timeout:
20s.</p>

<p>status Performs a status check. Suggested minimum
timeout: 20s. Suggested interval: 10s.</p>

<p>monitor Performs a detailed status check. Suggested
minimum timeout: 20s. Suggested interval: 10s.</p>

<p>meta-data Retrieves resource agent metadata (internal
use only). Suggested minimum timeout: 5s.</p>

<p>validate-all Performs a validation of the resource
configuration. Suggested minimum timeout: 20s.</p>

<p>EXAMPLE The following is an example configuration for a
ethmonitor resource using the crm(8) shell:</p>

<p>primitive p_ethmonitor ocf:heartbeat:ethmonitor params
interface=string op monitor depth=&quot;0&quot;
timeout=&quot;20s&quot; interval=&quot;10s&quot;</p>

<p>SEE ALSO
http://www.linux-ha.org/wiki/ethmonitor_(resource_agent)</p>

<p>AUTHOR Linux-HA contributors (see the resource agent
source for information about individual authors)</p>

<p>resource-agents 3.9.2 02/25/2016
OCF_HEARTBEAT_ETHMON(7)</p>
<hr>
</body>
</html>
