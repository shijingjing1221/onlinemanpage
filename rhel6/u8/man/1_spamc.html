<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:35:34 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>SPAMC(1) User Contributed Perl Documentation
SPAMC(1)</p>

<p>NAME spamc - client for spamd</p>

<p>SYNOPSIS spamc [options] &lt; message</p>

<p>DESCRIPTION Spamc is the client half of the spamc/spamd
pair. It should be used in place of &quot;spamassassin&quot;
in scripts to process mail. It will read the mail from
STDIN, and spool it to its connection to spamd, then read
the result back and print it to STDOUT. Spamc has extremely
low overhead in loading, so it should be much faster to load
than the whole spamassassin program.</p>

<p>See the README file in the spamd directory of the
SpamAssassin distribution for more details.</p>

<p>OPTIONS All options detailed below can be passed as
command line arguments, or be contained in a configuration
file, as described in the CONFIGURATION FILE section
below.</p>

<p>Note that the long options, a la
&quot;--long-options&quot;, are new as of SpamAssassin
3.2.0, and were not available in earlier versions.</p>

<p>-B, --bsmtp Assume input is a single BSMTP-formatted
message. In other words, spamc will pull out everything
between the DATA line and the lone- dot line to feed to
spamd, and will place the spamd output back in the same
envelope (thus, any SIZE extension in your BSMTP file will
cause many problems).</p>

<p>-c, --check Just check if the message is spam or not.
Set process exitcode to 1 if message is spam, 0 if not spam
or processing failure occurs. Will print score/threshold to
stdout (as ints) or 0/0 if there was an error. Combining -c
and -E is a no-op, since -c implies the behaviour of -E.</p>

<p>-d host[,host2], --dest=host[,host2] In TCP/IP mode,
connect to spamd server on given host (default: localhost).
Several hosts can be specified if separated by commas.</p>

<p>If host resolves to multiple addresses, then spamc will
fail-over to the other addresses, if the first one cannot be
connected to. It will first try all addresses of one host
before it tries the next one in the list. Note that this
fail-over behaviour is incompatible with -x; if that switch
is used, fail-over will not occur.</p>

<p>-e command [args], --pipe-to command [args] Instead of
writing to stdout, pipe the output to commands standard
input. Note that there is a very slight chance mail will be
lost here, because if the fork-and-exec fails theres no
place to put the mail message.</p>

<p>Note that this must be the LAST command line option, as
everything after the -e is taken as arguments to the command
(its like rxvt or xterm).</p>

<p>This option is not supported on Win32 platforms.</p>

<p>-E, --exitcode Filter according to the other options,
but set the process exitcode to 1 if message is spam, 0 if
not spam or processing failure occurs.</p>

<p>-F /path/to/file, --config=path Specify a configuration
file to read additional command-line flags from. See
CONFIGURATION FILE below.</p>

<p>-h, --help Print this help message and terminate without
action.</p>

<p>-H, --randomize For TCP/IP sockets, randomize the IP
addresses returned for the hosts given by the -d switch.
This provides for a simple kind of load balancing. It will
try only three times though.</p>

<p>-l, --log-to-stderr Send log messages to stderr, instead
of to the syslog.</p>

<p>-L learn type, --learntype=type Send message to spamd
for learning. The &quot;learn type&quot; can be either spam,
ham or forget. The exitcode for spamc will be set to 5 if
the message was learned, or 6 if it was already learned,
under a condition that a --no-safe-fallback option is
selected too.</p>

<p>Note that the &quot;spamd&quot; must run with the
&quot;--allow-tell&quot; option for this to work.</p>

<p>-C report type, --reporttype=type Report or revoke a
message to one of the configured collaborative filtering
databases. The &quot;report type&quot; can be either report
or revoke.</p>

<p>Note that the &quot;spamd&quot; must run with the
&quot;--allow-tell&quot; option for this to work.</p>

<p>-p port, --port=port In TCP/IP mode, connect to spamd
server listening on given port (default: 783).</p>

<p>-r, --full-spam Just output the SpamAssassin report text
to stdout, if the message is spam. If the message is ham
(non-spam), nothing will be printed. The first line of the
output is the message score and the threshold, in this
format:</p>

<p>score/threshold</p>

<p>-R, --full Just output the SpamAssassin report text to
stdout, for all messages. See -r for details of the output
format used.</p>

<p>-s max_size, --max-size=max_size Set the maximum message
size which will be sent to spamd -- any bigger than this
threshold and the message will be returned unprocessed
(default: 500 KB). If spamc gets handed a message bigger
than this, it wont be passed to spamd. The maximum message
size is 256 MB.</p>

<p>The size is specified in bytes, as a positive integer
greater than 0. For example, -s 500000.</p>

<p>--connect-retries=retries Retry connecting to spamd
retries times. The default is 3 times.</p>

<p>--retry-sleep=sleep Sleep for sleep seconds between
attempts to connect to spamd. The default is 1 second.</p>

<p>--filter-retries=retries Retry filtering retries times
if the spamd process fails (usually times out). This differs
from --connect-retries in that it times out the transaction
after the TCP connection has been established successfully.
The default is 1 time (ie. one attempt and no retries).</p>

<p>--filter-retry-sleep=sleep Sleep for sleep seconds
between failed spamd filtering attempts. The default is 1
second.</p>

<p>-S, --ssl, --ssl=sslversion If spamc was built with
support for SSL, encrypt data to and from the spamd process
with SSL; spamd must support SSL as well. sslversion
specifies the SSL protocol version to use, one of
&quot;sslv2&quot;, &quot;sslv3&quot;, &quot;tlsv1&quot;, or
&quot;sslv23&quot;. The default, &quot;sslv23&quot;, causes
spamc to use a SSLv2 hello handshake then negotiate use of
SSLv3 or TLSv1 protocol if the spamd server can accept
it.</p>

<p>-t timeout, --timeout=timeout Set the timeout for
spamc-to-spamd communications (default: 600, 0 disables). If
spamd takes longer than this many seconds to reply to a
message, spamc will abort the connection and treat this as a
failure to connect; in other words the message will be
returned unprocessed.</p>

<p>-n timeout, --connect-timeout=timeout Set the timeout
for spamc-to-spamd connection establishment (default: 600, 0
disables). If spamc takes longer than this many seconds to
establish a connection to spamd, spamc will abort the
connection and treat this as a failure to connect; in other
words the message will be returned unprocessed.</p>

<p>-u username, --username=username To have spamd use
per-user-config files, run spamc as the user whose config
files spamd should load; by default the effective user-ID is
sent to spamd. If youre running spamc as some other user,
though, (eg. root, mail, nobody, cyrus, etc.) then you may
use this flag to override the default.</p>

<p>-U socketpath, --socket=path Connect to
&quot;spamd&quot; via UNIX domain socket socketpath instead
of a TCP/IP connection.</p>

<p>This option is not supported on Win32 platforms.</p>

<p>-V, --version Report the version of this
&quot;spamc&quot; client. If built with SSL support, an
additional line will be included noting this, like so:</p>

<p>SpamAssassin Client version 3.0.0-rc4 compiled with SSL
support (OpenSSL 0.9.7d 17 Mar 2004)</p>

<p>-x, --no-safe-fallback Disables the safe fallback
error-recovery method, which passes through the unaltered
message if an error occurs. Instead, exit with an error
code, and let the MTA queue up the mails for a retry later.
See also &quot;EXIT CODES&quot;.</p>

<p>This also disables the TCP fail-over behaviour from
-d.</p>

<p>-y, --tests Just output the names of the tests hit to
stdout, on one line, separated by commas.</p>

<p>-K Perform a keep-alive check of spamd, instead of a
full message check.</p>

<p>-z Use gzip compression to compress the mail message
sent to &quot;spamd&quot;. This is useful for long-distance
use of spamc over the internet. Note that this relies on
&quot;zlib&quot; being installed on the &quot;spamc&quot;
client side, and the &quot;Compress::Zlib&quot; perl module
on the server side; an error will be returned otherwise.</p>

<p>--headers Perform a scan, but instead of allowing any
part of the message (header and body) to be rewritten, limit
rewriting to only the message headers. This is much more
efficient in bandwidth usage, since the response message
transmitted back from the spamd server will not include the
body.</p>

<p>Note that this only makes sense if you are using
&quot;report_safe 0&quot; in the scanning configuration on
the remote end; with &quot;report_safe 1&quot;, it is likely
to result in corrupt messages.</p>

<p>CONFIGURATION FILE The above command-line switches can
also be loaded from a configuration file.</p>

<p>The format of the file is similar to the SpamAssassin
rules files; blank lines and lines beginning with
&quot;#&quot; are ignored. Any space- separated words are
considered additions to the command line, and are prepended.
Newlines are treated as equivalent to spaces. Existing
command line switches will override any settings in the
configuration file.</p>

<p>If the -F switch is specified, that file will be used.
Otherwise, &quot;spamc&quot; will attempt to load spamc.conf
in &quot;SYSCONFDIR&quot; (default: /etc/mail/spamassassin).
If that file doesn t exist, and the -F switch is not
specified, no configuration file will be read.</p>

<p>Example:</p>

<p># spamc global configuration file</p>

<p># connect to &quot;server.example.com&quot;, port 783 -d
server.example.com -p 783</p>

<p># max message size for scanning = 350k -s 350000</p>

<p>EXIT CODES By default, spamc will use the safe fallback
error recovery method. That means, it will always exit with
an exit code if 0, even if an error was encountered. If any
error occurrs, it will simply pass through the unaltered
message.</p>

<p>The -c and -E options modify this; instead, spamc will
use an exit code of 1 if the message is determined to be
spam.</p>

<p>If one of the &quot;-x&quot;, &quot;-L&quot; or
&quot;-C&quot; options are specified, safe fallback will be
disabled, and certain error conditions related to
communication between spamc and spamd will result in an
error code. The exit codes used are as follows:</p>

<p>EX_USAGE 64 command line usage error EX_DATAERR 65 data
format error EX_NOINPUT 66 cannot open input EX_NOUSER 67
addressee unknown EX_NOHOST 68 host name unknown
EX_UNAVAILABLE 69 service unavailable EX_SOFTWARE 70
internal software error EX_OSERR 71 system error (e.g.,
can&rsquo;t fork) EX_OSFILE 72 critical OS file missing
EX_CANTCREAT 73 can&rsquo;t create (user) output file
EX_IOERR 74 input/output error EX_TEMPFAIL 75 temp failure;
user is invited to retry EX_PROTOCOL 76 remote error in
protocol EX_NOPERM 77 permission denied EX_CONFIG 78
configuration error EX_TOOBIG 98 message was too big to
process (see --max-size)</p>

<p>SEE ALSO spamd(1) spamassassin(1)
Mail::SpamAssassin(3)</p>

<p>PREREQUISITES &quot;Mail::SpamAssassin&quot;</p>

<p>AUTHORS The SpamAssassin(tm) Project
&lt;http://spamassassin.apache.org/&gt;</p>

<p>COPYRIGHT SpamAssassin is distributed under the Apache
License, Version 2.0, as described in the file
&quot;LICENSE&quot; included with the distribution.</p>

<p>perl v5.10.1 2010-03-16 SPAMC(1)</p>
<hr>
</body>
</html>
