<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:27:22 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PERF-KVM(1) perf Manual PERF-KVM(1)</p>

<p>NAME perf-kvm - Tool to trace/measure kvm guest os</p>

<p>SYNOPSIS perf kvm [--host] [--guest]
[--guestmount=&lt;path&gt; [--guestkallsyms=&lt;path&gt;
--guestmodules=&lt;path&gt; | --guestvmlinux=&lt;path&gt;]]
{top|record|report|diff|buildid-list} [&lt;options&gt;] perf
kvm [--host] [--guest] [--guestkallsyms=&lt;path&gt;
--guestmodules=&lt;path&gt; | --guestvmlinux=&lt;path&gt;]
{top|record|report|diff|buildid-list|stat} [&lt;options&gt;]
&acute;perf kvm stat [record|report|live]
[&lt;options&gt;]</p>

<p>DESCRIPTION There are a couple of variants of perf
kvm:</p>

<p>&acute;perf kvm [options] top &lt;command&gt;&acute; to
generates and displays a performance counter profile of
guest os in realtime of an arbitrary workload.</p>

<p>&acute;perf kvm record &lt;command&gt;&acute; to record
the performance counter profile of an arbitrary workload and
save it into a perf data file. We set the default behavior
of perf kvm as --guest, so if neither --host nor --guest is
input, the perf data file name is perf.data.guest. If --host
is input, the perf data file name is perf.data.kvm. If you
want to record data into perf.data.host, please input --host
--no-guest. The behaviors are shown as following:
Default(&acute;&acute;) -&gt; perf.data.guest --host -&gt;
perf.data.kvm --guest -&gt; perf.data.guest --host --guest
-&gt; perf.data.kvm --host --no-guest -&gt;
perf.data.host</p>

<p>&acute;perf kvm report&acute; to display the performance
counter profile information recorded via perf kvm
record.</p>

<p>&acute;perf kvm diff&acute; to displays the performance
difference amongst two perf.data files captured via perf
record.</p>

<p>&acute;perf kvm buildid-list&acute; to display the
buildids found in a perf data file, so that other tools can
be used to fetch packages with matching symbol tables for
use by perf report. As buildid is read from
/sys/kernel/notes in os, then if you want to list the
buildid for guest, please make sure your perf data file was
captured with --guestmount in perf kvm record.</p>

<p>&acute;perf kvm stat &lt;command&gt;&acute; to run a
command and gather performance counter statistics.
Especially, perf &acute;kvm stat record/report&acute;
generates a statistical analysis of KVM events. Currently,
vmexit, mmio and ioport events are supported. &acute;perf
kvm stat record &lt;command&gt;&acute; records kvm events
and the events between start and end &lt;command&gt;. And
this command produces a file which contains tracing results
of kvm events.</p>

<p>&acute;perf kvm stat report&acute; reports statistical
data which includes events handled time, samples, and so
on.</p>

<p>&acute;perf kvm stat live&acute; reports statistical
data in a live mode (similar to record + report but with
statistical data updated live at a given display rate).</p>

<p>OPTIONS -i, --input=&lt;path&gt; Input file name.</p>

<p>-o, --output=&lt;path&gt; Output file name.</p>

<p>--host Collect host side performance profile.</p>

<p>--guest Collect guest side performance profile.</p>

<p>--guestmount=&lt;path&gt; Guest os root file system
mount directory. Users mounts guest os root directories
under &lt;path&gt; by a specific filesystem access method,
typically, sshfs. For example, start 2 guest os. The ones
pid is 8888 and the other s is 9999. #mkdir /guestmount;
cd/guestmount #sshfs -o allow_other,direct_io -p 5551
localhost:/ 8888/ #sshfs -o allow_other,direct_io -p 5552
localhost:/ 9999/ #perf kvm --host --guest
--guestmount=~/guestmount top</p>

<p>--guestkallsyms=&lt;path&gt; Guest os /proc/kallsyms
file copy. perf kvm&acute; reads it to get guest kernel
symbols. Users copy it out from guest os.</p>

<p>--guestmodules=&lt;path&gt; Guest os /proc/modules file
copy. perf kvm&acute; reads it to get guest kernel module
information. Users copy it out from guest os.</p>

<p>--guestvmlinux=&lt;path&gt; Guest os kernel vmlinux.</p>

<p>-v, --verbose Be more verbose (show counter open errors,
etc).</p>

<p>STAT REPORT OPTIONS --vcpu=&lt;value&gt; analyze events
which occur on this vcpu. (default: all vcpus)</p>

<p>--event=&lt;value&gt; event to be analyzed. Possible
values: vmexit, mmio, ioport. (default: vmexit)</p>

<p>-k, --key=&lt;value&gt; Sorting key. Possible values:
sample (default, sort by samples number), time (sort by
average time).</p>

<p>-p, --pid= Analyze events only for given process ID(s)
(comma separated list).</p>

<p>STAT LIVE OPTIONS -d, --display Time in seconds between
display updates</p>

<p>-m, --mmap-pages= Number of mmap data pages (must be a
power of two) or size specification with appended unit
character - B/K/M/G. The size is rounded up to have nearest
pages power of two value.</p>

<p>-a, --all-cpus System-wide collection from all CPUs.</p>

<p>-p, --pid= Analyze events only for given process ID(s)
(comma separated list).</p>

<p>--vcpu=&lt;value&gt; analyze events which occur on this
vcpu. (default: all vcpus)</p>

<p>--event=&lt;value&gt; event to be analyzed. Possible
values: vmexit, mmio, ioport. (default: vmexit)</p>

<p>-k, --key=&lt;value&gt; Sorting key. Possible values:
sample (default, sort by samples number), time (sort by
average time).</p>

<p>--duration=&lt;value&gt; Show events other than HLT that
take longer than duration usecs.</p>

<p>SEE ALSO perf-top(1), perf-record(1), perf-report(1),
perf-diff(1), perf- buildid-list(1), perf-stat(1)</p>

<p>perf 04/13/2016 PERF-KVM(1)</p>
<hr>
</body>
</html>
