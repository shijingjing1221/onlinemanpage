<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:37:03 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>SYSLOG(2) Linux Programmer s Manual SYSLOG(2)</p>

<p>NAME syslog, klogctl - read and/or clear kernel message
ring buffer; set console_loglevel</p>

<p>SYNOPSIS int syslog(int type, char *bufp, int len); /*
No wrapper provided in glibc */</p>

<p>/* The glibc interface */ #include
&lt;sys/klog.h&gt;</p>

<p>int klogctl(int type, char *bufp, int len);</p>

<p>DESCRIPTION If you need the C library function syslog()
(which talks to sys- logd(8)), then look at syslog(3). The
system call of this name is about controlling the kernel
printk() buffer, and the glibc version is called
klogctl().</p>

<p>The type argument determines the action taken by this
function.</p>

<p>Quoting from kernel/printk.c: /* * Commands to
sys_syslog: * * 0 -- Close the log. Currently a NOP. * 1 --
Open the log. Currently a NOP. * 2 -- Read from the log. * 3
-- Read all messages remaining in the ring buffer. * 4 --
Read and clear all messages remaining in the ring buffer * 5
-- Clear ring buffer. * 6 -- Disable printk to console * 7
-- Enable printk to console * 8 -- Set level of messages
printed to console * 9 -- Return number of unread characters
in the log buffer * 10 -- Return size of the log buffer
*/</p>

<p>Only command types 3 and 10 are allowed to unprivileged
processes. Type 9 was added in 2.4.10; type 10 in 2.6.6.</p>

<p>The kernel log buffer The kernel has a cyclic buffer of
length LOG_BUF_LEN in which messages given as arguments to
the kernel function printk() are stored (regard- less of
their loglevel). In early kernels, LOG_BUF_LEN had the value
4096; from kernel 1.3.54, it was 8192; from kernel 2.1.113
it was 16384; since 2.4.23/2.6 the value is a kernel
configuration option. In recent kernels the size can be
queried with command type 10.</p>

<p>The call syslog(2,buf,len) waits until this kernel log
buffer is non- empty, and then reads at most len bytes into
the buffer buf. It returns the number of bytes read. Bytes
read from the log disappear from the log buffer: the
information can only be read once. This is the function
executed by the kernel when a user program reads
/proc/kmsg.</p>

<p>The call syslog(3,buf,len) will read the last len bytes
from the log buffer (non-destructively), but will not read
more than was written into the buffer since the last
&quot;clear ring buffer&quot; command (which does not clear
the buffer at all). It returns the number of bytes read.</p>

<p>The call syslog(4,buf,len) does precisely the same, but
also executes the &quot;clear ring buffer&quot; command.</p>

<p>The call syslog(5,dummy,dummy) executes just the
&quot;clear ring buffer&quot; command. (In each call where
buf or len is shown as &quot;dummy&quot;, the value of the
argument is ignored by the call.)</p>

<p>The call syslog(6,dummy,dummy) sets the console log
level to minimum, so that no messages are printed to the
console.</p>

<p>The call syslog(7,dummy,dummy) sets the console log
level to default, so that messages are printed to the
console.</p>

<p>The call syslog(8,dummy,level) sets the console log
level to level, which must be an integer between 1 and 8
(inclusive). See the loglevel section for details.</p>

<p>The call syslog(9,dummy,dummy) returns the number of
bytes currently available to be read on the kernel log
buffer.</p>

<p>The call syslog(10,dummy,dummy) returns the total size
of the kernel log buffer.</p>

<p>The loglevel The kernel routine printk() will only print
a message on the console, if it has a loglevel less than the
value of the variable con- sole_loglevel. This variable
initially has the value DEFAULT_CON- SOLE_LOGLEVEL (7), but
is set to 10 if the kernel command line contains the word
&quot;debug&quot;, and to 15 in case of a kernel fault (the
10 and 15 are just silly, and equivalent to 8). This
variable is set (to a value in the range 1-8) by the call
syslog(8,dummy,value). The calls sys- log(type,dummy,dummy)
with type equal to 6 or 7, set it to 1 (kernel panics only)
or 7 (all except debugging messages), respectively.</p>

<p>Every text line in a message has its own loglevel. This
level is DEFAULT_MESSAGE_LOGLEVEL - 1 (6) unless the line
starts with &lt;d&gt; where d is a digit in the range 1-7,
in which case the level is d. The con- ventional meaning of
the loglevel is defined in &lt;linux/kernel.h&gt; as
follows:</p>

<p>#define KERN_EMERG &quot;&lt;0&gt;&quot; /* system is
unusable */ #define KERN_ALERT &quot;&lt;1&gt;&quot; /*
action must be taken immediately */ #define KERN_CRIT
&quot;&lt;2&gt;&quot; /* critical conditions */ #define
KERN_ERR &quot;&lt;3&gt;&quot; /* error conditions */
#define KERN_WARNING &quot;&lt;4&gt;&quot; /* warning
conditions */ #define KERN_NOTICE &quot;&lt;5&gt;&quot; /*
normal but significant condition */ #define KERN_INFO
&quot;&lt;6&gt;&quot; /* informational */ #define KERN_DEBUG
&quot;&lt;7&gt;&quot; /* debug-level messages */</p>

<p>RETURN VALUE For type equal to 2, 3, or 4, a successful
call to syslog() returns the number of bytes read. For type
9, syslog() returns the number of bytes currently available
to be read on the kernel log buffer. For type 10, syslog()
returns the total size of the kernel log buffer. For other
values of type, 0 is returned on success.</p>

<p>In case of error, -1 is returned, and errno is set to
indicate the error.</p>

<p>ERRORS EINVAL Bad arguments (e.g., bad type; or for type
2, 3, or 4, buf is NULL, or len is less than zero; or for
type 8, the level is out- side the range 1 to 8).</p>

<p>EPERM An attempt was made to change console_loglevel or
clear the ker- nel message ring buffer by a process without
sufficient privi- lege (more precisely: without the
CAP_SYS_ADMIN capability).</p>

<p>ERESTARTSYS System call was interrupted by a signal;
nothing was read. (This can be seen only during a
trace.)</p>

<p>ENOSYS This syslog() system call is not available,
because the kernel was compiled with the CONFIG_PRINTK
kernel-configuration option disabled.</p>

<p>CONFORMING TO This system call is Linux-specific and
should not be used in programs intended to be portable.</p>

<p>NOTES From the very start people noted that it is
unfortunate that a system call and a library routine of the
same name are entirely different ani- mals. In libc4 and
libc5 the number of this call was defined by SYS_klog. In
glibc 2.0 the syscall is baptized klogctl().</p>

<p>SEE ALSO syslog(3)</p>

<p>COLOPHON This page is part of release 3.22 of the Linux
man-pages project. A description of the project, and
information about reporting bugs, can be found at
http://www.kernel.org/doc/man-pages/.</p>

<p>Linux 2008-06-20 SYSLOG(2)</p>
<hr>
</body>
</html>
