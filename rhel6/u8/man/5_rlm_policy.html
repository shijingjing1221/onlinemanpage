<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:31:55 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>rlm_policy(5) FreeRADIUS Module rlm_policy(5)</p>

<p>NAME rlm_policy - FreeRADIUS Module</p>

<p>DESCRIPTION The rlm_policy module implements a simple
&quot;policy&quot; language.</p>

<p>The policy language implemented by this module is
simple, and specific to RADIUS. It does not implement
variables, arrays, loops, gotos, or any other feature of a
real language. If those features are needed for your system,
we suggest using rlm_perl.</p>

<p>What the policy module implements is a simple way to
look for attributes in the request packet (or other places),
and to add attributes to the reply packet (or other places)
based on those deci- sions. Where the module shines is that
it is significantly more flexi- ble than the old-style users
file.</p>

<p>The module has one configuration item:</p>

<p>filename The file where the policy is stored.</p>

<p>POLICY LANGUAGE Named policies The policy is composed of
a series of named policies. The following example defines a
policy named &quot;foo&quot;.</p>

<p>policy foo { ... }</p>

<p>Policy names MAY NOT be the same as attributes in the
dictionary. Defining a policy with the same name as a
dictionary attribute will cause an error message to be
printed, and the policy will not be loaded.</p>

<p>When the policy module is listed in a module section
like &quot;authorize&quot;, the module calls a policy named
&quot;authorize&quot;. The &quot;post-auth&quot;, etc.
sections behave the same. These names cannot be changed.</p>

<p>include &quot;policy.txt&quot;</p>

<p>The filename must be in a double-quoted string, and is
assumed to be relative to the location of the current file.
If the filename ends with a /, then it is assumed to be a
directory, and all files in that directory will be read.</p>

<p>include &quot;dir/&quot;</p>

<p>All file in &quot;dir/&quot; will be read and included
into the policy defini- tion. Any dot files (&quot;.&quot;,
&quot;..&quot;, etc.) will not be included, however.</p>

<p>Including multiple files The main file referred to from
the radiusd.conf may include one or more other files, as in
the following example.</p>

<p>Referencing a named policy The following example
references a named policy</p>

<p>foo()</p>

<p>While the brackets are required, no arguments may be
passed.</p>

<p>Conditions &quot;if&quot; statements are supported.</p>

<p>if (expression) { ... }</p>

<p>and &quot;else&quot;</p>

<p>if (expression) { ... } else { ... }</p>

<p>also, &quot;else if&quot;</p>

<p>if (expression) { ... } else if (expression) { ... }</p>

<p>Expressions within if statements Always have to have
brackets around them. Sorry.</p>

<p>The following kinds of expressions may be used, with
their meanings.</p>

<p>(attribute-reference) TRUE if the referenced attribute
exists, FALSE otherwise. See below for details on attribute
references.</p>

<p>(!(expression)) FALSE if the expression returned TRUE,
and TRUE if the nested expression returned FALSE.</p>

<p>(attribute-reference == value) Compares the attribute to
the value. The operators here can be &quot;==&quot;,
&quot;!=&quot;, &quot;=~&quot;, &quot;!~&quot;,
&quot;&lt;&quot;, &quot;&lt;=&quot;, &quot;&gt;&quot;, and
&quot;&gt;=&quot;.</p>

<p>(string1 == string2) A special case of the above. The
&quot;string1&quot; is dynamically expanded at run time,
while &quot;string2&quot; is not. The operators here can be
&quot;==&quot;, &quot;!=&quot;, &quot;=~&quot;,and
&quot;!~&quot;. Of these, the most use- ful is &quot;=~ ,
which lets you do things like (&quot;%{ldap:query...}&quot;
=~ &quot;foo=(.*) &quot;). The results of the regular
expression match are put into %{1}, and can be used later.
See &quot;doc/vari- ables.txt&quot; for more
information.</p>

<p>((expression1) || (expression2)) Short-circuit
&quot;or&quot;. If expression1 is TRUE, expression2 is not
evaluated.</p>

<p>((expression1) &amp;&amp; (expression2)) Short-circuit
&quot;and&quot;. If expression1 is FALSE, expression2 is not
evaluated.</p>

<p>Limitations. The &amp;&amp; and || operators have equal
precedence. You cant call a function as a expression.</p>

<p>Attribute references Attribute references are:</p>

<p>Attribute-Name Refers to an attribute of that name in
the Access-Request or Accounting-Request packet. May also
refer to &quot;server-side&quot; attributes, which are not
documented anywhere.</p>

<p>request:Attribute-Name An alternate way of referencing
an attribute in the request packet.</p>

<p>reply:Attribute-Name An attribute in the reply
packet</p>

<p>proxy-request:Attribute-Name An attribute in the
Access-Request or Accounting-Request packet which will be
proxied to the home server.</p>

<p>proxy-reply:Attribute-Name An attribute in the
Access-Accept or other packet which was received from a home
server.</p>

<p>control:Attribute-Name An attribute in the per-request
configuration and control attributes. Also known as
&quot;check&quot; attributes (doc/vari- ables.txt).</p>

<p>Adding attributes to reply packet (or other location)
reply .= { attribute-name = value ... attribute-name = value
}</p>

<p>The first name can be &quot;request&quot;,
&quot;reply&quot;, &quot;control&quot;,
&quot;proxy-request&quot;, or &quot;proxy-reply&quot;.</p>

<p>The operator can be</p>

<p>.= - appends attributes to end of the list</p>

<p>:= - replaces existing list with the attributes in the
list (bad idea)</p>

<p>= - use operators from &quot;attribute = value&quot; to
decide what to do. (see &quot;users&quot;)</p>

<p>The block must contain only attributes and values.
Nothing else is permitted.</p>

<p>SECTIONS authorize post-auth pre-proxy post-proxy</p>

<p>FILES /etc/raddb/radiusd.conf</p>

<p>SEE ALSO radiusd(8), users(5), radiusd.conf(5)</p>

<p>AUTHOR Alan DeKok &lt;aland@ox.org&gt;</p>

<p>7 December 2004 rlm_policy(5)</p>
<hr>
</body>
</html>
