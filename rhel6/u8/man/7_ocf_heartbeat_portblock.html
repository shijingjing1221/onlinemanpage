<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:25:07 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>OCF_HEARTBEAT_PORTBL(7) OCF resource agents
OCF_HEARTBEAT_PORTBL(7)</p>

<p>NAME ocf_heartbeat_portblock - Block and unblocks access
to TCP and UDP ports</p>

<p>SYNOPSIS portblock [start | stop | status | monitor |
meta-data | validate-all]</p>

<p>DESCRIPTION Resource script for portblock. It is used to
temporarily block ports using iptables. In addition, it may
allow for faster TCP reconnects for clients on failover. Use
that if there are long lived TCP connections to an HA
service. This feature is enabled by setting the tickle_dir
parameter and only in concert with action set to unblock.
Note that the tickle ACK function is new as of version 3.0.2
and hasn&acute;t yet seen widespread use.</p>

<p>SUPPORTED PARAMETERS protocol The protocol used to be
blocked/unblocked.</p>

<p>(required, string, no default)</p>

<p>portno The port number used to be blocked/unblocked.</p>

<p>(required, string, no default)</p>

<p>action The action (block/unblock) to be done on the
protocol::portno.</p>

<p>(required, string, no default)</p>

<p>reset_local_on_unblock_stop If for some reason the long
lived server side TCP sessions won&acute;t be cleaned up by
a reconfiguration/flush/stop of whatever services this
portblock protects, they would linger in the connection
table, even after the IP is gone and services have been
switched over to an other node.</p>

<p>An example would be the default NFS kernel server.</p>

<p>These &quot;known&quot; connections may seriously
confuse and delay a later switchback.</p>

<p>Enabling this option will cause this agent to try to get
rid of these connections by injecting a temporary iptables
rule to TCP-reset outgoing packets from the blocked ports,
and additionally tickle them locally, just before it starts
to DROP incoming packets on &quot;unblock stop&quot;.</p>

<p>(optional, boolean, default false)</p>

<p>ip The IP address used to be blocked/unblocked.</p>

<p>(optional, string, default &quot;0.0.0.0/0&quot;)</p>

<p>tickle_dir The shared or local directory (_must_ be
absolute path) which stores the established TCP
connections.</p>

<p>(optional, string, no default)</p>

<p>sync_script If the tickle_dir is a local directory, then
the TCP connection state file has to be replicated to other
nodes in the cluster. It can be csync2 (default), some
wrapper of rsync, or whatever. It takes the file name as a
single argument. For csync2, set it to &quot;csync2
-xv&quot;.</p>

<p>(optional, string, no default)</p>

<p>SUPPORTED ACTIONS This resource agent supports the
following actions (operations):</p>

<p>start Starts the resource. Suggested minimum timeout:
20.</p>

<p>stop Stops the resource. Suggested minimum timeout:
20.</p>

<p>status Performs a status check. Suggested minimum
timeout: 10. Suggested interval: 10.</p>

<p>monitor Performs a detailed status check. Suggested
minimum timeout: 10. Suggested interval: 10.</p>

<p>meta-data Retrieves resource agent metadata (internal
use only). Suggested minimum timeout: 5.</p>

<p>validate-all Performs a validation of the resource
configuration. Suggested minimum timeout: 5.</p>

<p>EXAMPLE The following is an example configuration for a
portblock resource using the crm(8) shell:</p>

<p>primitive p_portblock ocf:heartbeat:portblock params
protocol=string portno=string action=string op monitor
depth=&quot;0&quot; timeout=&quot;10&quot;
interval=&quot;10&quot;</p>

<p>SEE ALSO
http://www.linux-ha.org/wiki/portblock_(resource_agent)</p>

<p>AUTHOR Linux-HA contributors (see the resource agent
source for information about individual authors)</p>

<p>resource-agents 3.9.2 02/25/2016
OCF_HEARTBEAT_PORTBL(7)</p>
<hr>
</body>
</html>
