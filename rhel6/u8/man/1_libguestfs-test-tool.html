<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:21:55 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>libguestfs-test-tool(1) Virtualization Support
libguestfs-test-tool(1)</p>

<p>NAME libguestfs-test-tool - Diagnostics for
libguestfs</p>

<p>SYNOPSIS libguestfs-test-tool [--options]</p>

<p>DESCRIPTION libguestfs-test-tool is a test program
shipped with libguestfs to allow you to check basic
libguestfs functionality is working. This is needed because
libguestfs occasionally breaks for reasons beyond our
control: usually because of changes in the underlying qemu
or kernel packages, or the host environment.</p>

<p>If you suspect a problem in libguestfs, then just
run:</p>

<p>libguestfs-test-tool</p>

<p>It will print lots of diagnostic messages.</p>

<p>If it runs to completion successfully, you will see this
near the end:</p>

<p>===== TEST FINISHED OK =====</p>

<p>and the test tool will exit with code 0.</p>

<p>If it fails (and/or exits with non-zero error code),
please paste the complete, unedited output of the test tool
into a bug report. More information about reporting bugs can
be found on the http://libguestfs.org/ website.</p>

<p>OPTIONS --help Display short usage information and
exit.</p>

<p>--qemu qemu_binary If you have downloaded another qemu
binary, point this option at the full path of the binary to
try it.</p>

<p>--qemudir qemu_source_dir If you have compiled qemu from
source, point this option at the source directory to try
it.</p>

<p>-t N --timeout N Set the launch timeout to &quot;N&quot;
seconds. The default is 600 seconds (10 minutes) which does
not usually need to be adjusted.</p>

<p>-V --version Display the libguestfs version number and
exit.</p>

<p>TRYING OUT A DIFFERENT VERSION OF QEMU If you have
compiled another version of qemu from source and would like
to try that, then you can use the --qemudir option to point
to the qemu source directory.</p>

<p>If you have downloaded a qemu binary from somewhere, use
the --qemu option to point to the binary.</p>

<p>Note when using these options, you can ignore the
business of qemu wrapper scripts (&quot;QEMU WRAPPERS&quot;
in guestfs(3)), since libguestfs-test- tool writes a wrapper
script for you if one is needed.</p>

<p>TRYING OUT A DIFFERENT KERNEL If you are using supermin
/ febootstrap 3.8 then you can select which kernel
libguestfs tries. You do this by setting the environment
variables &quot;SUPERMIN_KERNEL&quot; and/or
&quot;SUPERMIN_MODULES&quot; (&quot;FEBOOTSTRAP_KERNEL&quot;
and &quot;FEBOOTSTRAP_MODULES&quot; if still using the old
febootstrap 3.21 program).</p>

<p>Refer to &quot;ENVIRONMENT VARIABLES&quot; in
supermin-helper(8) for further information.</p>

<p>TRYING OUT A DIFFERENT VERSION OF LIBVIRT To find out
which attach-method is the default in your libguestfs
package, do:</p>

<p>unset LIBGUESTFS_ATTACH_METHOD guestfish
get-attach-method</p>

<p>If you are using the libvirt attach-method, then you can
try out a different (eg. upstream) version of libvirt by
running these commands (not as root):</p>

<p>killall libvirtd lt-libvirtd ~/path/to/libvirt/run
libguestfs-test-tool</p>

<p>The first command kills any session &quot;libvirtd&quot;
process(es) that may be running on the machine. The second
command uses libvirt s &quot;run&quot; script (in the
top-level libvirt build directory) to set some environment
variables so that the alternate version of libvirt is used
to run the program.</p>

<p>TRYING OUT WITH / WITHOUT LIBVIRT To find out which
attach-method is the default in your libguestfs package,
do:</p>

<p>unset LIBGUESTFS_ATTACH_METHOD guestfish
get-attach-method</p>

<p>If you are using the libvirt attach-method, you can try
without (ie. libguestfs directly launching qemu) by
doing:</p>

<p>export LIBGUESTFS_ATTACH_METHOD=appliance</p>

<p>Or if you are using the default (appliance)
attach-method, then you can try libvirt:</p>

<p>export LIBGUESTFS_ATTACH_METHOD=libvirt</p>

<p>or with libvirt and a specific libvirt URI:</p>

<p>export
LIBGUESTFS_ATTACH_METHOD=libvirt:qemu:///session</p>

<p>TRYING OUT DIFFERENT SELINUX SETTINGS To find out which
attach-method is the default in your libguestfs package,
do:</p>

<p>LIBGUESTFS_ATTACH_METHOD= guestfish
get-attach-method</p>

<p>To find out if SELinux is being used, do:</p>

<p>getenforce</p>

<p>If you are using libvirt, SELinux and sVirt, then you
can try to see if changing SELinux to &quot;permissive&quot;
mode makes any difference. Use this command as root:</p>

<p>setenforce Permissive</p>

<p>If this makes a difference, look in the audit logs for
recent failures (&quot;AVCs&quot;):</p>

<p>ausearch -m avc -ts recent</p>

<p>You can convert AVCs into suggested SELinux policy rules
using tools like audit2allow(1). For more information, see
the &quot;Security Enhanced Linux User Guide&quot;.</p>

<p>To reenable SELinux and sVirt, do:</p>

<p>setenforce Enforcing</p>

<p>SELF-DIAGNOSIS Refer to &quot;APPLIANCE BOOT
PROCESS&quot; in guestfs(3) to understand the messages
produced by libguestfs-test-tool and/or possible errors.</p>

<p>EXIT STATUS libguestfs-test-tool returns 0 if the tests
completed without error, or 1 if there was an error.</p>

<p>ENVIRONMENT VARIABLES For the full list of environment
variables which may affect libguestfs, please see the
guestfs(3) manual page.</p>

<p>SEE ALSO guestfs(3), http://libguestfs.org/,
http://qemu.org/.</p>

<p>AUTHORS Richard W.M. Jones (&quot;rjones at redhat dot
com&quot;)</p>

<p>COPYRIGHT Copyright (C) 2009-2013 Red Hat Inc.</p>

<p>LICENSE This program is free software; you can
redistribute it and/or modify it under the terms of the GNU
General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your
option) any later version.</p>

<p>This program is distributed in the hope that it will be
useful, but WITHOUT ANY WARRANTY; without even the implied
warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE. See the GNU General Public License for more
details.</p>

<p>You should have received a copy of the GNU General
Public License along with this program; if not, write to the
Free Software Foundation, Inc., 51 Franklin Street, Fifth
Floor, Boston, MA 02110-1301 USA.</p>

<p>BUGS To get a list of bugs against libguestfs, use this
link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p>To report a new bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p>When reporting a bug, please supply:</p>

<p>&middot; The version of libguestfs.</p>

<p>&middot; Where you got libguestfs (eg. which Linux
distro, compiled from source, etc)</p>

<p>&middot; Describe the bug accurately and give a way to
reproduce it.</p>

<p>&middot; Run libguestfs-test-tool(1) and paste the
complete, unedited output into the bug report.</p>

<p>libguestfs-1.20.11 2013-08-27
libguestfs-test-tool(1)</p>
<hr>
</body>
</html>
