<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:22:41 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>LVS.CF(5) LVS.CF(5)</p>

<p>NAME lvs.cf - configuration file for lvs</p>

<p>DESCRIPTION This file contains the configuration
information for piranha and is normally located in
/etc/sysconfig/ha/lvs.cf. lvs.cf is read and updated from
the piranha web configuration tool, which uses lvs(8) to
actually work with the file.</p>

<p>GLOBAL OPTIONS Global settings affect all aspects of the
cluster, including virtual servers and real servers.</p>

<p>service = [lvs|fos] Indicates which set of defined
services are to be used. Virtual Servers and Failover
Services as mutually exclusive; although they may both be
defined in the same config file, thay cannot both be running
simultaneously. This option specifies which section is to be
used.</p>

<p>primary = a.b.c.d This is the IP (or hostname) of the
primary LVS machine.</p>

<p>primary_private = a.b.c.d Indicates the IP address of an
alternative network device for private heartbeating. It is
not necessary to fill out this field for piranha to work as
it simply provides an alternative method of checking an IP
service is running.</p>

<p>backup = a.b.c.d This is the IP (or hostname) of the
backup (or failover) LVS machine.</p>

<p>backup_private = a.b.c.d This is akin to primary_private
but refers to the alternative IP device on the backup</p>

<p>backup_active = [0|1] This dictates if the backup server
option is active or inactive. This option must be set if the
backup server is to function in a failover manner.</p>

<p>syncdaemon = [0|1] This option dictates if the
connection synchronization daemon is active or inactive.
This option is only useful when a backup server is defined.
See ipvsadm(8) for more information.</p>

<p>syncd_iface = dev This option dictates the network
interface that the synchroniza- tion daemon should use for
sending and receiving multicast mes- sages.</p>

<p>syncd_id = n This option dictates the syncid to be used
by the synchroniza- tion daemon. Valid values for syncd_id
are 0 to 255. The default is 0.</p>

<p>heartbeat = [0|1] Use heartbeat between the two LVS
nodes.</p>

<p>keepalive = n Number of seconds between heartbeats.</p>

<p>deadtime = n Length of time before a node is declared
dead and IP takeover occurs.</p>

<p>reservation_conflict_action = [nothing|preempt] This
option dictates what action should be taken when a scsi
reservation conflict occurs during failover and the disk is
found to be unexpectedly locked. You should think carefully
about this option as your setup may or may not have a scsi
con- troller setup to reset the scsi bus on power on or warm
reboot.</p>

<p>debug = NONE Ignore this option. Eventually it will
become a means to dictate how much and what type of
information about the state of the cluster is written to
file.</p>

<p>hard_shutdown = [0|1] With this option (default 1) it is
possible to have partially running system. So problem with
one nanny wont stop all others.</p>

<p>rsh_command = The command family used to sync file
systems and config files. Allowable options are either rsh
(default) or ssh. The appro- priate .rhosts (or
.ssh/authorized_keys) entries must be on all nodes so that
connections can be made non-interactively.</p>

<p>Sync ing of specified config files and directories will
occur when lvs receives a SIGUSR1. lvs.cf(5) is
automatically synced between the LVS nodes anytime it is
written to.</p>

<p>network = [direct|nat|tunnel] The lvs virtual server can
reroute all of its incoming traffic via one of three
methods; NAT (Network Address Translation), Direct Routing,
or Tunneling (IP Encapsulation).</p>

<p>nat_router = a.b.c.d dev:n If NAT routing is selected,
this specifies the IP address and device of the routing
interface.</p>

<p>nat_nmask = a.b.c.d Optional. The subnet mask to apply
to nat_router.</p>

<p>tcp_timeout = n This option specifies the timeout (in
seconds) for TCP sessions. A timeout value 0 means that the
current timeout value is pre- served. Default timeout value
is 0.</p>

<p>tcpfin_timeout = n This option specifies the timeout (in
seconds) for TCP sessions after receiving a FIN packet. A
timeout value 0 means that the current timeout value is
preserved. Default timeout value is 0.</p>

<p>udp_timeout = n This option specifies the timeout (in
seconds) for UDP packets. A timeout value 0 means that the
current timeout value is pre- served. Default timeout value
is 0.</p>

<p>PER-VIRTUAL SERVER SECTION A per-virtual server section
starts with</p>

<p>virtual server-name {</p>

<p>}</p>

<p>where the string is a unique server identifier. This
doesnt have to match up to a FQDN.</p>

<p>The following items are required for each virtual server
entry in the config file.</p>

<p>address = a.b.c.d This is the address to be used for the
virtual server.</p>

<p>sorry_server = a.b.c.d This is the address to be used
for the sorry server. If spec- ified, requests for this
virtual server will be redirected to this IP address in the
event that no real servers are available to handle the
request.</p>

<p>vip_nmask = a.b.c.d Optional. This is the subnet mask to
apply to the address of the virtual server.</p>

<p>active = [0|1] This flag is used to indicate whether or
not this particular virtual server is active. If it is
marked inactive, then all real servers being routed to by it
will by default become inac- tive as well.</p>

<p>The following items are all optional entries (note the
default values for many).</p>

<p>load_monitor = [uptime|rup|ruptime|none] This specifies
the method that the LVS can acquire CPU load information
from the real servers. This load information is used to
adjust the weighting factor for each server entry in the LVS
routing table. Each method requires slightly different con-
figurations to be present on the real servers and on the LVS
nodes. The default method is uptime. Specifying
&quot;none&quot; causes the service monitor to skip load
tests (required for most non- linux systems).</p>

<p>timeout = This is the amount of time allowed before a
presumed dead real server is removed from the LVS routing
table. Default is 10 seconds.</p>

<p>reentry = This is the amount of time that a previously
dead real server must be alive before the LVS will re-enter
it into the routing table. The purpose of this delay is to
prevent troubled machines from causing a
&quot;ping-pong&quot; effect. The default is 180
seconds.</p>

<p>port = xx This is the port that the virtual server is
instructed to listen to and redirect network requests from.
The default is port 80 (http).</p>

<p>send = xxx If present, the specified text
(&quot;xxx&quot;) will be sent to the port of the virtual
server as part of the test for whether the ser- vice is
operational. The text is limited to 255 characters maxi-
mum. Characters must be printable/quotable, and may contain
&quot;0 , \, or &quot;. Note that if both &quot;send&quot;
and &quot;expect&quot; are spec- ified, the send will always
execute before the read for the expect is attempted.</p>

<p>send_program = path %h For more advanced service
verification, you can use this direc- tive to specify the
path to a service-checking script. This functionality is
especially helpful for services that require dynamically
changing data, such as HTTPS or SSL. To use this
functionality, you must write a script that returns a
textual response (that will be matched against expect
directive), set it to be executable, and specify the path to
it. To ensure that each server in the real server pool is
checked, use the special token %h after the path to the
script. This token is replaced with each real servers IP
address as the script is called by the nanny daemon. If
send_program is used, then the send is ignored.</p>

<p>expect = xxx If present, the specified text
(&quot;xxx&quot;) will be expected as a response from the
port on the virtual server as part of the test for whether
the service is operational. The text is limited to 255
characters maximum. Characters must be printable/quotable, ,
\, or &quot;. Note that if both and may contain &quot;0
&quot;send&quot; and &quot;expect&quot; are specified, the
send will always execute before the read for the expect is
attempted. If you wrote your own service-checking script,
enter the response you told it to send if it was
successful.</p>

<p>use_regex = [0|1] If enabled, the expect string will be
interpreted as a regular expression.</p>

<p>persistent = The number of seconds that a connection
between this virtual server and a real server will persist.
If a request is received from a client within this number of
seconds, it will be assigned to the same real server that
processed a prior request. If this parameter is missing or
set to zero, connections with this vir- tual server are not
persistent.</p>

<p>pmask = The network mask to apply to persistence if
enabled. Default is 255.255.255.255.</p>

<p>scheduler = [rr|lc|wlc|wrr] This is the key part of the
LVS router. These methods of scheduling how incoming
requests are routed are built as load- able kernel modules:
Round Robin (rr), least-connections (lc), Weighted Least
Connections (wlc, the default) and Weighted Round Robin
(wrr).</p>

<p>REAL SERVER SECTIONS A per-real server section starts
with</p>

<p>server servername {</p>

<p>}</p>

<p>where the string is a unique server identifier. This
doesnt have to match up to any real FQDN.</p>

<p>The following items are required for each real server
entry in the con- fig file.</p>

<p>address = a.b.c.d This is the actual IP address being
used by the real server. In the cases of NAT type routing,
it is generally one of the reserved, private IPs.</p>

<p>active = [0|1] This flag is used to indicate whether or
not this particular real server is active.</p>

<p>The following item is optional.</p>

<p>weight = This option enforces a skew affect by enabling
more loading on a particular server. The weights of all real
servers influence the scheduling algorithm and a higher
weight will load a partic- ular server down with more
redirects. The default value is 1.</p>

<p>An example real server entry might look like:</p>

<p>server 1 { address = 192.168.10.2 active = 1 weight = 1
}</p>

<p>PER-FAILOVER SERVICE SECTION A per-failover-service
section starts with</p>

<p>failover service-name { }</p>

<p>where the service-name is a unique identifier.</p>

<p>The following items are required for each failover
service entry in the config file.</p>

<p>address = a.b.c.d dev:x This is the address and device
interface to be used for the vir- tual service.</p>

<p>vip_nmask = a.b.c.d Optional. The netmask to apply to
the service address.</p>

<p>active = [0|1] This flag is used to indicate whether or
not this particular virtual server is active. If it is
marked inactive, then all real servers being routed to by it
will by default become inac- tive as well.</p>

<p>The following items are all optional entries (note the
default values for many).</p>

<p>timeout = This is the amount of time allowed before a
service is presumed dead and will cause a failover.</p>

<p>reentry = This is the amount of time that a previously
dead partner system must be alive before it will be a
candidate for possible failover. The purpose of this delay
is to prevent troubled machines from causing a
&quot;ping-pong&quot; effect. The default is 180
seconds.</p>

<p>port = xx This is the port that the failover service is
instructed to test. The default is port 80 (http).</p>

<p>send = xxx If present, the specified text
(&quot;xxx&quot;) will be sent to the port of the virtual
server as part of the test for whether the ser- vice is
operational. The text is limited to 255 characters maxi-
mum. Characters must be printable/quotable, and may contain
&quot;0 , \, or &quot;. Note that if both &quot;send&quot;
and &quot;expect&quot; are spec- ified, the send will always
execute before the read for the expect is attempted.</p>

<p>expect = xxx If present, the specified text
(&quot;xxx&quot;) will be expected as a response from the
port on the virtual server as part of the test for whether
the service is operational. The text is limited to 255
characters maximum. Characters must be printable/quotable, ,
\, or &quot;. Expect can also and may contain &quot;0 be a
single * character to indicate any response characters are
allowed. Note that if both &quot;send&quot; and
&quot;expect&quot; are specified, the send will always
execute before the read for the expect is attempted.</p>

<p>start_cmd = xxx Mandatory; specifies the startup
command/script to execute to start the failover service.
Options can be specified, but must be separated by a single
space.</p>

<p>stop_cmd = xxx Mandatory; specifies the shutdown
command/script to execute to stop the failover service.
Options can be specified, but must be separated by a single
space.</p>

<p>SEE ALSO ipvsadm(8), lvs(8), fos(8), pulse(8). sample.cf
file http://www.linuxvirtualserver.org</p>

<p>4 July 2001 LVS.CF(5)</p>
<hr>
</body>
</html>
