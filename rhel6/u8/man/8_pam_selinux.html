<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:25:35 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PAM_SELINUX(8) Linux-PAM Manual PAM_SELINUX(8)</p>

<p>NAME pam_selinux - PAM module to set the default
security context</p>

<p>SYNOPSIS pam_selinux.so [close] [debug] [open] [nottys]
[verbose] [select_context] [env_params]
[use_current_range]</p>

<p>DESCRIPTION In a nutshell, pam_selinux sets up the
default security context for the next execed shell.</p>

<p>When an application opens a session using pam_selinux,
the shell that gets executed will be run in the default
security context, or if the user chooses and the pam file
allows the selected security context. Also the controlling
tty will have it&acute;s security context modified to match
the users.</p>

<p>Adding pam_selinux into a pam file could cause other pam
modules to change their behavior if the exec another
application. The close and open option help mitigate this
problem. close option will only cause the close portion of
the pam_selinux to execute, and open will only cause the
open portion to run. You can add pam_selinux to the config
file twice. Add the pam_selinux close as the executes the
open pass through the modules, pam_selinux open_session will
happen last. When PAM executes the close pass through the
modules pam_selinux close_session will happen first.</p>

<p>OPTIONS close Only execute the close_session portion of
the module.</p>

<p>debug Turns on debugging via syslog(3).</p>

<p>open Only execute the open_session portion of the
module.</p>

<p>nottys Do not try to setup the ttys security
context.</p>

<p>verbose attempt to inform the user when security context
is set.</p>

<p>select_context Attempt to ask the user for a custom
security context role. If MLS is on ask also for sensitivity
level.</p>

<p>env_params Attempt to obtain a custom security context
role from PAM environment. If MLS is on obtain also
sensitivity level. This option and the select_context option
are mutually exclusive. The respective PAM environment
variables are SELINUX_ROLE_REQUESTED,
SELINUX_LEVEL_REQUESTED, and SELINUX_USE_CURRENT_RANGE. The
first two variables are self describing and the last one if
set to 1 makes the PAM module behave as if the
use_current_range was specified on the command line of the
module.</p>

<p>use_current_range Use the sensitivity level of the
current process for the user context instead of the default
level. Also suppresses asking of the sensitivity level from
the user or obtaining it from PAM environment.</p>

<p>MODULE TYPES PROVIDED Only the session module type is
provided.</p>

<p>RETURN VALUES PAM_AUTH_ERR Unable to get or set a valid
context.</p>

<p>PAM_SUCCESS The security context was set
successfully.</p>

<p>PAM_USER_UNKNOWN The user is not known to the
system.</p>

<p>EXAMPLES auth required pam_unix.so session required
pam_permit.so session optional pam_selinux.so</p>

<p>SEE ALSO pam.conf(5), pam.d(5), pam(8)</p>

<p>AUTHOR pam_selinux was written by Dan Walsh
&lt;dwalsh@redhat.com&gt;.</p>

<p>Linux-PAM Manual 06/16/2009 PAM_SELINUX(8)</p>
<hr>
</body>
</html>
