<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:25:30 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PAM_GET_AUTHTOK(3) Linux-PAM Manual
PAM_GET_AUTHTOK(3)</p>

<p>NAME pam_get_authtok - get authentication token</p>

<p>SYNOPSIS #include &lt;security/pam_ext.h&gt;</p>

<p>int pam_get_authtok(pam_handle_t *pamh, int item, const
char **authtok, const char *prompt);</p>

<p>int pam_get_authtok_noverify(pam_handle_t *pamh, const
char **authtok, const char *prompt);</p>

<p>int pam_get_authtok_verify(pam_handle_t *pamh, const
char **authtok, const char *prompt);</p>

<p>DESCRIPTION The pam_get_authtok function returns the
cached authentication token, or prompts the user if no token
is currently cached. It is intended for internal use by
Linux-PAM and PAM service modules. Upon successful return,
authtok contains a pointer to the value of the
authentication token. Note, this is a pointer to the actual
data and should not be free()&acute;ed or over-written!</p>

<p>The prompt argument specifies a prompt to use if no
token is cached. If a NULL pointer is given, pam_get_authtok
uses pre-defined prompts.</p>

<p>The following values are supported for item:</p>

<p>PAM_AUTHTOK Returns the current authentication token.
Called from pam_sm_chauthtok(3) pam_get_authtok will ask the
user to confirm the new token by retyping it. If a prompt
was specified, &quot;Retype&quot; will be used as
prefix.</p>

<p>PAM_OLDAUTHTOK Returns the previous authentication token
when changing authentication tokens.</p>

<p>The pam_get_authtok_noverify function can only be used
for changing the password (from pam_sm_chauthtok(3)). It
returns the cached authentication token, or prompts the user
if no token is currently cached. The difference to
pam_get_authtok is, that this function does not ask a second
time for the password to verify it. Upon successful return,
authtok contains a pointer to the value of the
authentication token. Note, this is a pointer to the actual
data and should not be free()&acute;ed or over-written!</p>

<p>The pam_get_authtok_verify function can only be used to
verify a password for mistypes gotten by
pam_get_authtok_noverify(3). This function asks a second
time for the password and verify it with the password
provided by authtok argument. In case of an error, the value
of authtok is undefined. Else this argument will point to
the actual data and should not be free()&acute;ed or
over-written!</p>

<p>OPTIONS pam_get_authtok honours the following module
options:</p>

<p>try_first_pass Before prompting the user for their
password, the module first tries the previous stacked
module&acute;s password in case that satisfies this module
as well.</p>

<p>use_first_pass The argument use_first_pass forces the
module to use a previous stacked modules password and will
never prompt the user - if no password is available or the
password is not appropriate, the user will be denied
access.</p>

<p>use_authtok When password changing enforce the module to
set the new token to the one provided by a previously
stacked password module. If no token is available token
changing will fail.</p>

<p>authtok_type=XXX The default action is for the module to
use the following prompts when requesting passwords:
&quot;New UNIX password: &quot; and &quot;Retype UNIX
password: &quot;. The example word UNIX can be replaced with
this option, by default it is empty.</p>

<p>RETURN VALUES PAM_AUTH_ERR Authentication token could
not be retrieved.</p>

<p>PAM_AUTHTOK_ERR New authentication could not be
retrieved.</p>

<p>PAM_SUCCESS Authentication token was successfully
retrieved.</p>

<p>PAM_SYSTEM_ERR No space for an authentication token was
provided.</p>

<p>PAM_TRY_AGAIN New authentication tokens mismatch.</p>

<p>SEE ALSO pam(8)</p>

<p>STANDARDS The pam_get_authtok function is a Linux-PAM
extensions.</p>

<p>Linux-PAM Manual 11/10/2009 PAM_GET_AUTHTOK(3)</p>
<hr>
</body>
</html>
