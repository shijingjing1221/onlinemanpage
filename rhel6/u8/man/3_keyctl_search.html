<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:20:57 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>KEYCTL_SEARCH(3) Linux Key Management Calls
KEYCTL_SEARCH(3)</p>

<p>NAME keyctl_search - Search a keyring for a key</p>

<p>SYNOPSIS #include &lt;keyutils.h&gt;</p>

<p>long keyctl_search(key_serial_t keyring, const char
*type, const char *description, key_serial_t
destination);</p>

<p>DESCRIPTION keyctl_search() recursively searches the
keyring for a key of the spec- ified type and
description.</p>

<p>If found, the key will be attached to the destination
keyring (if given), and its serial number will be
returned.</p>

<p>The source keyring must grant search permission to the
caller, and for a key to be found, it must also grant search
permission to the caller. Child keyrings will be only be
recursively searched if they grant search permission to the
caller as well.</p>

<p>If the destination keyring is zero, no attempt will be
made to forge a link to the key, and just the serial number
will be returned.</p>

<p>If the destination keyring is given, then the link may
only be formed if the found key grants the caller link
permission and the destination keyring grants the caller
write permission.</p>

<p>If the search is successful, and if the destination
keyring already contains a link to a key that matches the
specified type and descrip- tion, then that link will be
replaced by a link to the found key.</p>

<p>The source keyring and destination keyring serial
numbers may be those of valid keyrings to which the caller
has appropriate permission, or they may be special keyring
IDs:</p>

<p>KEY_SPEC_THREAD_KEYRING This specifies the callers
thread-specific keyring.</p>

<p>KEY_SPEC_PROCESS_KEYRING This specifies the caller s
process-specific keyring.</p>

<p>KEY_SPEC_SESSION_KEYRING This specifies the caller s
session-specific keyring.</p>

<p>KEY_SPEC_USER_KEYRING This specifies the callers
UID-specific keyring.</p>

<p>KEY_SPEC_USER_SESSION_KEYRING This specifies the callers
UID-session keyring.</p>

<p>RETURN VALUE On success keyctl_search() returns the
serial number of the key it found. On error, the value -1
will be returned and errno will have been set to an
appropriate error.</p>

<p>ERRORS ENOKEY One of the keyrings doesnt exist, no key
was found by the search, or the only key found by the search
was a negative key.</p>

<p>ENOTDIR One of the keyrings is a valid key that isn t a
keyring.</p>

<p>EKEYEXPIRED One of the keyrings has expired, or the only
key found was expired.</p>

<p>EKEYREVOKED One of the keyrings has been revoked, or the
only key found was revoked.</p>

<p>ENOMEM Insufficient memory to expand the destination
keyring.</p>

<p>EDQUOT The key quota for this user would be exceeded by
creating a link to the found key in the destination
keyring.</p>

<p>EACCES The source keyring didnt grant search permission,
the destina- tion keyring didnt grant write permission or
the found key didnt grant link permission to the caller.</p>

<p>LINKING Although this is a Linux system call, it is not
present in libc but can be found rather in libkeyutils. When
linking, -lkeyutils should be specified to the linker.</p>

<p>SEE ALSO keyctl(1), add_key(2), keyctl(2),
request_key(2), keyctl(3), request-key(8)</p>

<p>Linux 4 May 2006 KEYCTL_SEARCH(3)</p>
<hr>
</body>
</html>
