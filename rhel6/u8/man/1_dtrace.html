<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:10:45 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>DTRACE(1) DTRACE(1)</p>

<p>NAME dtrace - Dtrace compatible user application static
probe generation tool.</p>

<p>SYNOPSIS dtrace -s file [OPTIONS]</p>

<p>DESCRIPTION The dtrace command converts probe
descriptions defined in file.d into a probe header file via
the -h option or a probe description file via the -G
option.</p>

<p>OPTIONS -h generate a systemtap header file.</p>

<p>-G generate a systemtap probe definition object
file.</p>

<p>-o file is the name of the output file. If the -G option
is given then the output file will be called file.o; if the
-h option is given then the output file will be called
file.h.</p>

<p>-C run the cpp preprocessor on the input file when the
-h option is given.</p>

<p>-I file give this include path to cpp when the -C option
is given.</p>

<p>-k keep temporary files, for example the C language
source for the -G option.</p>

<p>EXAMPLES Systemtap is source compatible with dtrace user
application static probe support. Given a file test.d
containing:</p>

<p>provider sdt_probes { probe test_0 (int type); probe
test_1 (struct astruct node); }; struct astruct {int a; int
b;};</p>

<p>Then the command &quot;dtrace -s test.d -G&quot; will
create the probe definition file test.o and the command
&quot;dtrace -stest.d -h&quot; will create the probe header
file test.h Subsequently the application can use the
generated macros this way:</p>

<p>#include &quot;test.h&quot; ... struct astruct s; ...
SDT_PROBES_TEST_0(value); ... if
(SDT_PROBES_TEST_1_ENABLED())
SDT_PROBES_TEST_1(expensive_function(s));</p>

<p>SEMAPHORES Semaphores are flag variables used by probes
as a way of bypassing po- tentially costly processing to
prepare arguments for probes that may not even be active.
They are automatically set/cleared by systemtap when a
relevant script is running, so the argument setup cost is
only paid when necessary. These semaphore variables are
defined within the the &quot;test.o&quot; object file, which
must therefore be linked into an appli- cation.</p>

<p>Sometimes, semaphore variables are not necessary nor
helpful. Skipping them can simplify the build process, by
omitting the extra &quot;test.o&quot; file. To skip
dependence upon semaphore variables, include
&quot;&lt;sys/sdt.h&gt;&quot; within the application before
&quot;test.h&quot;:</p>

<p>#include &lt;sys/sdt.h&gt; #include &quot;test.h&quot;
... struct astruct s; ... SDT_PROBES_TEST_0(value); ... if
(SDT_PROBES_TEST_1_ENABLED())
SDT_PROBES_TEST_1(cheap_function(s));</p>

<p>In this mode, the ENABLED() test is fixed at 1.</p>

<p>SEE ALSO stap(1), stappaths(7)</p>

<p>DTRACE(1)</p>
<hr>
</body>
</html>
