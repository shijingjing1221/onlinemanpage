<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 06:27:42 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PERLNEWMOD(1) Perl Programmers Reference Guide
PERLNEWMOD(1)</p>

<p>NAME perlnewmod - preparing a new module for
distribution</p>

<p>DESCRIPTION This document gives you some suggestions
about how to go about writing Perl modules, preparing them
for distribution, and making them available via CPAN.</p>

<p>One of the things that makes Perl really powerful is the
fact that Perl hackers tend to want to share the solutions
to problems theyve faced, so you and I dont have to battle
with the same problem again.</p>

<p>The main way they do this is by abstracting the solution
into a Perl module. If you dont know what one of these is,
the rest of this document isn t going to be much use to you.
Youre also missing out on an awful lot of useful code;
consider having a look at perlmod, perlmodlib and
perlmodinstall before coming back here.</p>

<p>When you ve found that there isnt a module available for
what youre trying to do, and youve had to write the code
yourself, consider packaging up the solution into a module
and uploading it to CPAN so that others can benefit.</p>

<p>Warning Were going to primarily concentrate on Perl-only
modules here, rather than XS modules. XS modules serve a
rather different purpose, and you should consider different
things before distributing them - the popularity of the
library you are gluing, the portability to other operating
systems, and so on. However, the notes on preparing the Perl
side of the module and packaging and distributing it will
apply equally well to an XS module as a pure-Perl one.</p>

<p>What should I make into a module? You should make a
module out of any code that you think is going to be useful
to others. Anything thats likely to fill a hole in the
communal library and which someone else can slot directly
into their program. Any part of your code which you can
isolate and extract and plug into something else is a likely
candidate.</p>

<p>Lets take an example. Suppose youre reading in data from
a local format into a hash-of-hashes in Perl, turning that
into a tree, walking the tree and then piping each node to
an Acme Transmogrifier Server.</p>

<p>Now, quite a few people have the Acme Transmogrifier,
and youve had to write something to talk the protocol from
scratch - you d almost certainly want to make that into a
module. The level at which you pitch it is up to you: you
might want protocol-level modules analogous to Net::SMTP
which then talk to higher level modules analogous to
Mail::Send. The choice is yours, but you do want to get a
module out for that server protocol.</p>

<p>Nobody else on the planet is going to talk your local
data format, so we can ignore that. But what about the thing
in the middle? Building tree structures from Perl variables
and then traversing them is a nice, general problem, and if
nobodys already written a module that does that, you might
want to modularise that code too.</p>

<p>So hopefully youve now got a few ideas about whats good
to modularise. Lets now see how its done.</p>

<p>Step-by-step: Preparing the ground Before we even start
scraping out the code, there are a few things well want to
do in advance.</p>

<p>Look around Dig into a bunch of modules to see how
theyre written. Id suggest starting with Text::Tabs, since
it s in the standard library and is nice and simple, and
then looking at something a little more complex like
File::Copy. For object oriented code,
&quot;WWW::Mechanize&quot; or the &quot;Email::*&quot;
modules provide some good examples.</p>

<p>These should give you an overall feel for how modules
are laid out and written.</p>

<p>Check its new There are a lot of modules on CPAN, and it
s easy to miss one thats similar to what youre planning on
contributing. Have a good plough through the
&lt;http://search.cpan.org&gt; and make sure you re not the
one reinventing the wheel!</p>

<p>Discuss the need You might love it. You might feel that
everyone else needs it. But there might not actually be any
real demand for it out there. If you re unsure about the
demand your module will have, consider sending out feelers
on the &quot;comp.lang.perl.modules&quot; newsgroup, or as a
last resort, ask the modules list at
&quot;modules@perl.org&quot;. Remember that this is a closed
list with a very long turn-around time - be prepared to wait
a good while for a response from them.</p>

<p>Choose a name Perl modules included on CPAN have a
naming hierarchy you should try to fit in with. See
perlmodlib for more details on how this works, and browse
around CPAN and the modules list to get a feel of it. At the
very least, remember this: modules should be title
capitalised, (This::Thing) fit in with a category, and
explain their purpose succinctly.</p>

<p>Check again While you re doing that, make really sure
you havent missed a module similar to the one youre about to
write.</p>

<p>When youve got your name sorted out and youre sure that
your module is wanted and not currently available, its time
to start coding.</p>

<p>Step-by-step: Making the module Start with
module-starter or h2xs The module-starter utility is
distributed as part of the Module::Starter CPAN package. It
creates a directory with stubs of all the necessary files to
start a new module, according to recent &quot;best
practice&quot; for module development, and is invoked from
the command line, thus:</p>

<p>module-starter --module=Foo::Bar --author=&quot;Your
Name&quot; --email=yourname@cpan.org</p>

<p>If you do not wish to install the Module::Starter
package from CPAN, h2xs is an older tool, originally
intended for the development of XS modules, which comes
packaged with the Perl distribution.</p>

<p>A typical invocation of h2xs for a pure Perl module
is:</p>

<p>h2xs -AX --skip-exporter --use-new-tests -n Foo::Bar</p>

<p>The &quot;-A&quot; omits the Autoloader code,
&quot;-X&quot; omits XS elements,
&quot;--skip-exporter&quot; omits the Exporter code,
&quot;--use-new-tests&quot; sets up a modern testing
environment, and &quot;-n&quot; specifies the name of the
module.</p>

<p>Use strict and warnings A module s code has to be
warning and strict-clean, since you cant guarantee the
conditions that it ll be used under. Besides, you wouldn t
want to distribute code that wasnt warning or strict-clean
anyway, right?</p>

<p>Use Carp The Carp module allows you to present your
error messages from the caller s perspective; this gives you
a way to signal a problem with the caller and not your
module. For instance, if you say this:</p>

<p>warn &quot;No hostname given&quot;;</p>

<p>the user will see something like this:</p>

<p>No hostname given at
/usr/local/lib/perl5/site_perl/5.6.0/Net/Acme.pm line
123.</p>

<p>which looks like your module is doing something wrong.
Instead, you want to put the blame on the user, and say
this:</p>

<p>No hostname given at bad_code, line 10.</p>

<p>You do this by using Carp and replacing your
&quot;warn&quot;s with &quot;carp&quot;s. If you need to
&quot;die&quot;, say &quot;croak&quot; instead. However,
keep &quot;warn&quot; and &quot;die&quot; in place for your
sanity checks - where it really is your module at fault.</p>

<p>Use Exporter - wisely! Exporter gives you a standard way
of exporting symbols and subroutines from your module into
the caller s namespace. For instance, saying &quot;use
Net::Acme qw(&amp;frob)&quot; would import the
&quot;frob&quot; subroutine.</p>

<p>The package variable @EXPORT will determine which
symbols will get exported when the caller simply says
&quot;use Net::Acme&quot; - you will hardly ever want to put
anything in there. @EXPORT_OK, on the other hand, specifies
which symbols youre willing to export. If you do want to
export a bunch of symbols, use the %EXPORT_TAGS and define a
standard export set - look at Exporter for more details.</p>

<p>Use plain old documentation The work isnt over until the
paperwork is done, and you re going to need to put in some
time writing some documentation for your module.
&quot;module-starter&quot; or &quot;h2xs&quot; will provide
a stub for you to fill in; if youre not sure about the
format, look at perlpod for an introduction. Provide a good
synopsis of how your module is used in code, a description,
and then notes on the syntax and function of the individual
subroutines or methods. Use Perl comments for developer
notes and POD for end-user notes.</p>

<p>Write tests Youre encouraged to create self-tests for
your module to ensure it s working as intended on the myriad
platforms Perl supports; if you upload your module to CPAN,
a host of testers will build your module and send you the
results of the tests. Again, &quot;module-starter&quot; and
&quot;h2xs&quot; provide a test framework which you can
extend - you should do something more than just checking
your module will compile. Test::Simple and Test::More are
good places to start when writing a test suite.</p>

<p>Write the README If youre uploading to CPAN, the
automated gremlins will extract the README file and place
that in your CPAN directory. Itll also appear in the main
by-module and by-category directories if you make it onto
the modules list. Its a good idea to put here what the
module actually does in detail, and the user-visible changes
since the last release.</p>

<p>Step-by-step: Distributing your module Get a CPAN user
ID Every developer publishing modules on CPAN needs a CPAN
ID. Visit &quot;http://pause.perl.org/&quot;, select
&quot;Request PAUSE Account&quot;, and wait for your request
to be approved by the PAUSE administrators.</p>

<p>&quot;perl Makefile.PL; make test; make dist&quot; Once
again, &quot;module-starter&quot; or &quot;h2xs&quot; has
done all the work for you. They produce the standard
&quot;Makefile.PL&quot; you see when you download and
install modules, and this produces a Makefile with a
&quot;dist&quot; target.</p>

<p>Once you ve ensured that your module passes its own
tests - always a good thing to make sure - you can
&quot;make dist&quot;, and the Makefile will hopefully
produce you a nice tarball of your module, ready for
upload.</p>

<p>Upload the tarball The email you got when you received
your CPAN ID will tell you how to log in to PAUSE, the Perl
Authors Upload SErver. From the menus there, you can upload
your module to CPAN.</p>

<p>Announce to the modules list Once uploaded, it ll sit
unnoticed in your author directory. If you want it connected
to the rest of the CPAN, youll need to go to &quot;Register
Namespace&quot; on PAUSE. Once registered, your module will
appear in the by-module and by-category listings on
CPAN.</p>

<p>Announce to clpa If you have a burning desire to tell
the world about your release, post an announcement to the
moderated &quot;comp.lang.perl.announce&quot; newsgroup.</p>

<p>Fix bugs! Once you start accumulating users, theyll send
you bug reports. If you re lucky, theyll even send you
patches. Welcome to the joys of maintaining a software
project...</p>

<p>AUTHOR Simon Cozens, &quot;simon@cpan.org&quot;</p>

<p>Updated by Kirrily &quot;Skud&quot; Robert,
&quot;skud@cpan.org&quot;</p>

<p>SEE ALSO perlmod, perlmodlib, perlmodinstall, h2xs,
strict, Carp, Exporter, perlpod, Test::Simple, Test::More
ExtUtils::MakeMaker, Module::Build, Module::Starter
http://www.cpan.org/ , Ken Williams tutorial on building
your own module at
http://mathforum.org/~ken/perl_modules.html</p>

<p>perl v5.10.1 2009-02-12 PERLNEWMOD(1)</p>
<hr>
</body>
</html>
