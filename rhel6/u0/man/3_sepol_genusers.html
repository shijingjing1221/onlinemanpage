<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:15:00 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>sepol_genusers(3) SE Linux binary policy API
documentation sepol_genusers(3)</p>

<p>NAME sepol_genusers - Generate a new binary policy image
with a customized user configuration</p>

<p>SYNOPSIS #include &lt;sepol/sepol.h&gt;</p>

<p>int sepol_genusers(void *data, size_t len, const char
*usersdir, void *newdata, size_t *newlen);</p>

<p>void sepol_set_delusers(int on);</p>

<p>DESCRIPTION sepol_genusers generates a new binary policy
image from an existing binary policy image stored in the
memory region described by the start- ing address data and
the length len and a pair of user configuration files named
system.users and local.users from the directory specified by
usersdir. The resulting binary policy is placed into
dynamically allocated memory and the variables newdata and
newlen are set to refer to the new binary images starting
address and length. The original binary policy image is not
modified.</p>

<p>By default, sepol_genusers will preserve user entries
that are defined in the original binary policy image but not
defined in the user config- uration files. If such user
entries should instead by omitted entirely from the new
binary policy image, then the sepol_set_delusers function
may be called with on set to 1 prior to calling
sepol_genusers in order to enable deletion of such
users.</p>

<p>RETURN VALUE Returns 0 on success or -1 otherwise, with
errno set appropriately. An errno of ENOENT indicates that
one or both of the user configuration files did not exist.
An errno of EINVAL indicates that either the original binary
policy image or the generated one were invalid. An errno of
ENOMEM indicates that insufficient memory was available to
process the original binary policy image or to generate the
new policy image. Invalid entries in the user configuration
files are skipped with a warning.</p>

<p>sds@tycho.nsa.gov 15 March 2005 sepol_genusers(3)</p>
<hr>
</body>
</html>
