<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:21:55 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>TGTADM(8) TGTADM(8)</p>

<p>NAME tgtadm - Linux SCSI Target Administration
Utility</p>

<p>SYNOPSIS tgtadm [OPTIONS]... [-C --control-port
&lt;port&gt;] [--lld &lt;driver&gt;] [--op
&lt;operation&gt;] [--mode &lt;mode&gt;] [--tid &lt;tid&gt;]
[-T --targetname &lt;targetname&gt;] [-Y --device-type
&lt;type&gt;] [--lun &lt;lun&gt;] [--backing-store
&lt;path&gt;] [--initiator-address &lt;address&gt;] [--name
&lt;parameter&gt;] [--value &lt;value&gt;] [--params
&lt;param=value[,param=value...]&gt;] [--help]</p>

<p>DESCRIPTION tgtadm is used to monitor and modify
everything about Linux SCSI target software: targets,
volumes, etc.</p>

<p>OPTIONS -C, --control-port=&lt;port&gt; It is possible
to run multiple concurrent instances of tgtd on a host. This
argument is used to control which instance the tgtadm
command will operate on.</p>

<p>-Y, --device-type=&lt;type&gt; When creating a LUN, this
parameter specifies the type of device to create. Default is
disk.</p>

<p>Possible device-types are: disk : emulate a disk device
tape : emulate a tape reader ssc : same as tape cd : emulate
a DVD drive changer : emulate a media changer device</p>

<p>--lld [driver] --op new --mode target --tid=[id]
--targetname [name] Add a new target with [id] and
[name].</p>

<p>--lld [driver] --op delete --mode target --tid=[id]
Delete specific target with [id]. The target must have no
active I_T nexus.</p>

<p>--lld [driver] --op show --mode target Show all the
targets.</p>

<p>--lld [driver] --op show --mode target --tid=[id] Show
target parameters of a target with [id].</p>

<p>--lld [driver] --op new --mode=logicalunit --tid=[id]
--lun=[lun] --backing-store [path] Add a new logical unit
with [lun] to specific target with [id]. The logical unit is
offered to the initiators. [path] must be block device files
(including LVM and RAID devices) or regular files. lun0 is
reserved for a special device automatically created.</p>

<p>--lld [driver] --op delete --mode=logicalunit --tid=[id]
--lun=[lun] Delete specific logical unit with [lun] that the
target with [id] has.</p>

<p>--lld [driver] --op bind --mode=target --tid=[id]
--initiator-address=[address] Add the address to the access
lists of the target with [id]. Initiators with the address
can access to the target. &acute;ALL&acute; is a special
address to allow all initiators to access to a target.</p>

<p>--lld [driver] --op unbind --mode=target --tid=[id]
--initiator-address=[address] Delete the address from the
access lists of the target with [id].</p>

<p>--lld [driver] --op update --mode=target --tid=[id]
--name=[parameter] --value=[value] Change the value of
[parameter] of the target with [id] to [value].</p>

<p>--lld [driver] --op update --mode=target --tid=[id]
--params parameter=value[,...] Sets/changes the value of one
or more parameters.</p>

<p>--help Display a list of available options and
exits.</p>

<p>LUN PARAMETERS These parameters are only applicable for
&quot;--mode logicalunit&quot;.</p>

<p>vendor_id=&lt;string&gt; This parameter sets the Vendor
Identification string that a LUN will report in INQURY
data.</p>

<p>product_id=&lt;string&gt; This parameter sets the
Product Identification string that a LUN will report in
INQURY data.</p>

<p>product_rev=&lt;string&gt; This parameter sets the
Product Revision string that a LUN will report in INQURY
data.</p>

<p>Example:</p>

<p>tgtadm --lld iscsi --mode logicalunit --op update --tid
&lt;TID&gt; --lun &lt;LUN&gt; --params
vendor_id=TGTD,product_id=VirtualHD,product_rev=0103</p>

<p>removable=&lt;0|1&gt; This can be used to
override/change the default setting for the removable flag.
Disk devices default to non-removable while DVD and TAPE
devices default to removable.</p>

<p>sense_format=&lt;0|1&gt; This flag controls the format
of sense data that the device will return. 0 = Clasic sense
format, 1 = Support descriptor format.</p>

<p>online=&lt;0|1&gt; This controls whether a device is
online or not.</p>

<p>Devices default to be online when created but can be
brought offline using this parameter. Behaviour of offline
devices depend on device type. An MMC/DVD device that is
offline will report that there is no disk in the unit but
the actual MMC/DVD unit itself can still be communicated
with. All other device types will fail all I/O with a sense
code of Not Ready.</p>

<p>Example:</p>

<p>tgtadm --lld iscsi --mode logicalunit --op update --tid
1 --lun 1 --params removable=1,sense_format=1,online=1</p>

<p>mode_page=&lt;byte-string&gt; This parameter is used to
set specific mode pages for the device and the mode page
contents. Most devices default to reasonable default mode
pages automatically when the LUN is created, but this allows
special settings.</p>

<p>Examples:</p>

<p>Create mode page &acute;2&acute;, subpage 0 and 14 bytes
of data. This is Disconnect-Reconnect mode page.</p>

<p>tgtadm --mode logicalunit --op update --tid 1 --lun 2
--params
mode_page=2:0:14:0x80:0x80:0:0xa:0:0:0:0:0:0:0:0:0:0</p>

<p>Create mode page &acute;10&acute;, subpage 0 and 10
bytes of data. This is Control Extension mode page.</p>

<p>tgtadm --lld iscsi --mode logicalunit --op update --tid
1 --lun 2 --params mode_page=10:0:10:2:0:0:0:0:0:0:0:2:0</p>

<p>Create mode page &acute;0x1c&acute;, subpage 0 and 10
bytes of data. This is Informational Exceptions Control mode
page.</p>

<p>tgtadm --lld iscsi --mode logicalunit --op update --tid
1 --lun 2 --params
mode_page=0x1c:0:10:8:0:0:0:0:0:0:0:0:0</p>

<p>SMC SPECIFIC LUN PARAMETERS These parameters are only
applicable for luns that are of type &quot;changer&quot;
i.e. the media changer device for a DVD Jukebox or a Virtual
Tape Library.</p>

<p>element_type=&lt;1|2|3|4&gt; This controls which type of
element a certain slot in the jukebox/vtl is.</p>

<p>Slot types: 1 -&gt; Medium Transport (picker arm) 2
-&gt; Storage Element 3 -&gt; Import/Export Element 4 -&gt;
Data Transfer device (CD drive, tape drive, MO drive
etc)</p>

<p>address=&lt;1-65535&gt; This is used to create/operate
on a single slot. Address specifies the slot on which to
perform the operation.</p>

<p>start_address=&lt;1-65535&gt;,quantity=&lt;1--65535&gt;
This is used to create/operate on an entire range of slots
at once. Start_address specifies the first address to
operate on and quantity specifies the number of consequtive
slots.</p>

<p>sides=&lt;1|2&gt; When creating storage elements, i.e.
&quot;element_type=2&quot;, this parameter specifies if the
media has 1 or two sides to hold data.</p>

<p>barcode=&lt;string&gt; This is used to assign a barcode
to an element.</p>

<p>media_home=&lt;string&gt; This parameter specifies a
directory where all virtual media for the dvd/tape device
elements are stored.</p>

<p>To assign a media image file to a storage element slot,
you assign &quot;barcode&quot; to be the name of the image
file in the &quot;media_home&quot; directory.</p>

<p>Example: How to create a DVD jukebox with eight disk
trays and two empty DVD-R disks.</p>

<p># Create a target tgtadm --lld iscsi --mode target --op
new --tid 1 -T iqn.2007-03:virtual-dvd:hostname</p>

<p># Create a DVD drive and give it a nice name # The dvd
starts out without a backing store file, i.e. no disk loaded
tgtadm --op new --mode logicalunit --tid 1 --lun 1 -Y cd
tgtadm --lld iscsi --mode logicalunit --op update --tid 1
--lun 1 --params
vendor_id=STGT_DVD,product_id=DVD101,product_rev=0010,scsi_sn=STGTDVD01,removable=1</p>

<p># We need a backend store file for the media changer if
[ ! -f $HOME/smc ]; then dd if=/dev/zero of=$HOME/smc bs=1k
count=1 fi</p>

<p># Create the SMC device and give it a nice name tgtadm
--lld iscsi --mode logicalunit --op new --tid 1 --lun 2 -b
$HOME/smc --device-type=changer tgtadm --lld iscsi --mode
logicalunit --op update --tid 1 --lun 2 --params
vendor_id=STK,product_id=L700,product_rev=0010,scsi_sn=XYZZY_0,removable=1</p>

<p># Add a Data Transfer devices (1 drive) tgtadm --lld
iscsi --mode logicalunit --op update --tid 1 --lun 2
--params element_type=4,start_address=1,quantity=1</p>

<p># Specify that the DVD above (LUN 1) is the data
transfer device we created tgtadm --lld iscsi --mode
logicalunit --op update --tid 1 --lun 2 --params
element_type=4,address=1,tid=1,lun=1</p>

<p># Medium Transport Elements (robot arm / picker) tgtadm
--lld iscsi --mode logicalunit --op update --tid 1 --lun 2
--params element_type=1,start_address=16,quantity=1</p>

<p># define path to virtual media VTL=${HOME}/vtl mkdir -p
${VTL} tgtadm --lld iscsi --mode logicalunit --op update
--tid 1 --lun 2 --params media_home=${VTL}</p>

<p># Storage Elements - 8 starting at addr 1024 tgtadm
--lld iscsi --mode logicalunit --op update --tid 1 --lun 2
--params element_type=2,start_address=1024,quantity=8</p>

<p># Add &acute;media&acute; to slots 1 and 2 and leave the
other 6 slots empty # slot 1 # Create empty writeable
virtual DVD-R media tgtimg --op new --device-type cd --type
dvd+r --file ${VTL}/DISK_001 tgtadm --lld iscsi --mode
logicalunit --op update --tid 1 --lun 2 --params
element_type=2,address=1024,barcode=DISK_001,sides=1</p>

<p># slot 2 tgtimg --op new --device-type cd --type dvd+r
--file ${VTL}/DISK_002 tgtadm --lld iscsi --mode logicalunit
--op update --tid 1 --lun 2 --params
element_type=2,address=1025,barcode=DISK_002,sides=1</p>

<p># Allow ALL initiators to connect to this target tgtadm
--lld iscsi --mode target --op bind --tid 1 -I ALL</p>

<p># Show all our good work. tgtadm --lld iscsi --mode
target --op show</p>

<p>ISNS PARAMETERS iSNS configuration for a target is by
using the tgtadm command.</p>

<p>iSNSServerIP This specifies the IP address of the iSNS
server. TGTD only supprots one iSNS server.</p>

<p>Example:</p>

<p>tgtadm --op update --mode sys --name iSNSServerIP -v
192.168.11.133</p>

<p>iSNS This setting enables(on)/disables(off) iSNS.</p>

<p>Example:</p>

<p>tgtadm --op update --mode sys --name iSNS -v On</p>

<p>iSNSServerPort This setting specifies the port to use
for iSNS.</p>

<p>Example:</p>

<p>tgtadm --op update --mode sys --name iSNSServerPort -v
3205</p>

<p>iSNSAccessControl Enable/disable access control for
iSNS.</p>

<p>Example:</p>

<p>tgtadm --op update --mode sys --name iSNSAccessControl
-v Off</p>

<p>SEE ALSO tgtd(8), tgt-admin(8), tgtimg(8),
tgt-setup-lun(8). http://stgt.sourceforge.net/</p>

<p>REPORTING BUGS Report bugs to
&lt;stgt@vger.kernel.org&gt;</p>

<p>04/04/2010 TGTADM(8)</p>
<hr>
</body>
</html>
