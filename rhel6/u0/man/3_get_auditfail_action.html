<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:00:56 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>GET_AUDITFAIL_ACTION(3) Linux Programmer s Manual
GET_AUDITFAIL_ACTION(3)</p>

<p>NAME get_auditfail_action - Get failure_action tunable
value</p>

<p>SYNOPSIS #include &lt;libaudit.h&gt;</p>

<p>int get_auditfail_action (int *failmode);</p>

<p>DESCRIPTION This function gets the failure_action
tunable value stored in /etc/libaudit.conf.
get_auditfail_action should be called after an au- dit_open
call returns an error to see what action the admin
prefers.</p>

<p>The failure_action value found in /etc/libaudit.conf is
copied into the failmode argument upon function return. This
value should then be used by the calling application to
determine what action should be taken when the audit
subsystem is unavailable.</p>

<p>RETURN VALUE Upon success, get_auditfail_action returns
a zero, and the failmode ar- gument will hold the
failure_action value. The possible values for failure_action
are: FAIL_IGNORE (0), FAIL_LOG (1), and FAIL_TERMINATE (2).
Upon failure, get_auditfail_action returns a return code of
one.</p>

<p>ERRORS An error is returned if there is an error reading
/etc/libaudit.conf or if the failure_action tunable is not
found in the file.</p>

<p>EXAMPLES /* Sample code */ auditfail_t failmode;</p>

<p>if ((fd = audit_open() ) &lt; 0 ) { fprintf (stderr,
&quot;Cannot open netlink audit socket&quot;);</p>

<p>/* Get the failure_action */ if ((rc =
get_auditfail_action(&amp;failmode)) == 0) { if (failmode ==
FAIL_LOG) fprintf (stderr, &quot;Audit subsystem
unavailable&quot;); else if (failmode == FAIL_TERMINATE)
exit (1); /* If failmode == FAIL_IGNORE, do nothing */ }
}</p>

<p>SEE ALSO audit_open(3), auditd(8).</p>

<p>AUTHOR Lisa M. Smith.</p>

<p>Linux 2.7 2006-7-10 GET_AUDITFAIL_ACTION(3)</p>
<hr>
</body>
</html>
