<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:10:45 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PKEXEC(1) pkexec PKEXEC(1)</p>

<p>NAME pkexec - Execute a command as another user</p>

<p>SYNOPSIS pkexec [--version] [--help]</p>

<p>pkexec [--user username] PROGRAM [ARGUMENTS...]</p>

<p>DESCRIPTION pkexec allows an authorized user to execute
PROGRAM as another user. If username is not specified, then
the program will be executed as the administrative super
user, root.</p>

<p>RETURN VALUE Upon successful completion, the return
value is the return value of PROGRAM. If the calling process
is not authorized or an authorization could not be obtained
through authentication or an error occured, pkexec exits
with a return value of 127.</p>

<p>SECURITY NOTES Executing a program as another user is a
privileged operation. By default the required authorization
(See the section called REQUIRED AUTHORIZATIONS ) requires
administrator authentication. In addition, the
authentication dialog presented to the user will display the
full path to the program to be executed so the user is aware
of what will happen:</p>

<p>[IMAGE][1]</p>


<p>+----------------------------------------------------------+
| Authenticate [X] |
+----------------------------------------------------------+
| | | [Icon] Authentication is needed to run
/bin/bash&acute; | | as the super user | | | | An
application is attempting to perform an | | action that
requires privileges. Authentication | | as the super user is
required to perform this | | action. | | | | Password for
root: [_________________________] | | | | [V] Details: | |
Command: /bin/bash | | Run As: Super User (root) | | Action:
org.freedesktop.policykit.exec | | Vendor: The PolicyKit
Project | | | | [Cancel] [Authenticate] |
+----------------------------------------------------------+</p>

<p>The environment that PROGRAM will run it, will be set to
a minimal known and safe environment in order to avoid
injecting code through LD_LIBRARY_PATH or similar
mechanisms. In addition the PKEXEC_UID environment variable
is set to the user id of the process invoking pkexec. As a
result, pkexec will not allow you to run e.g. X11
applications as another user since the $DISPLAY environment
variable is not set.</p>

<p>REQUIRED AUTHORIZATIONS By default, the
org.freedesktop.policykit.exec authorization is required
unless an action definition file is present for the program
in question. To require another authorization, it can be
specified using the org.freedesktop.policykit.exec.path
annotation on an action (See the section called EXAMPLE for
details).</p>

<p>EXAMPLE To specify what kind of authorization is needed
to execute the program /usr/bin/pk-example-frobnicate as
another user, simply write an action definition file like
this</p>

<p>&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE policyconfig
PUBLIC &quot;-//freedesktop//DTD PolicyKit Policy
Configuration 1.0//EN&quot;
&quot;http://www.freedesktop.org/standards/PolicyKit/1/policyconfig.dtd&quot;&gt;
&lt;policyconfig&gt;</p>

<p>&lt;vendor&gt;Examples for the PolicyKit
Project&lt;/vendor&gt;
&lt;vendor_url&gt;http://hal.freedesktop.org/docs/PolicyKit/&lt;/vendor_url&gt;</p>

<p>&lt;action
id=&quot;org.freedesktop.policykit.example.pkexec.run-frobnicate&quot;&gt;
&lt;description&gt;Run the PolicyKit example program
Frobnicate&lt;/description&gt; &lt;description
xml:lang=&quot;da&quot;&gt;K&oslash;r PolicyKit eksemplet
Frobnicate&lt;/description&gt; &lt;message&gt;Authentication
is required to run the PolicyKit example program
Frobnicate&lt;/message&gt; &lt;message
xml:lang=&quot;da&quot;&gt;Autorisering er
p&aring;kr&aelig;vet for at afvikle PolicyKit eksemplet
Frobnicate&lt;/message&gt;
&lt;icon_name&gt;audio-x-generic&lt;/icon_name&gt;
&lt;defaults&gt; &lt;allow_any&gt;no&lt;/allow_any&gt;
&lt;allow_inactive&gt;no&lt;/allow_inactive&gt;
&lt;allow_active&gt;auth_self_keep&lt;/allow_active&gt;
&lt;/defaults&gt; &lt;annotate
key=&quot;org.freedesktop.policykit.exec.path&quot;&gt;/usr/bin/pk-example-frobnicate&lt;/annotate&gt;
&lt;/action&gt;</p>

<p>&lt;/policyconfig&gt;</p>

<p>and drop it in the /usr/share/polkit-1/actions directory
under a suitable name (e.g. matching the namespace of the
action). Note that in addition to specifying the program,
the authentication message, description, icon and defaults
can be specified. For example, for the action defined above,
the following authentication dialog will be shown:</p>

<p>[IMAGE][2]</p>


<p>+----------------------------------------------------------+
| Authenticate [X] |
+----------------------------------------------------------+
| | | [Icon] Authentication is required to run the PolicyKit
| | example program Frobnicate | | | | An application is
attempting to perform an | | action that requires
privileges. Authentication | | is required to perform this
action. | | | | Password:
[__________________________________] | | | | [V] Details: |
| Command: /usr/bin/pk-example-frobnicate | | Run As: Super
User (root) | | Action:
org.fd.pk.example.pkexec.run-frobnicate | | Vendor: Examples
for the PolicyKit Project | | | | [Cancel] [Authenticate] |
+----------------------------------------------------------+</p>

<p>If the user is using the da_DK locale, the dialog looks
like this:</p>

<p>[IMAGE][3]</p>


<p>+----------------------------------------------------------+
| Autorisering [X] |
+----------------------------------------------------------+
| | | [Icon] Autorisering er p&aring;kr&aelig;vet for at
afvikle | | PolicyKit eksemplet Frobnicate | | | | Et
program fors&oslash;ger at udf&oslash;re en handling der | |
kr&aelig;ver privilegier. Autorisering er
p&aring;kr&aelig;vet. | | | | Kodeord:
[___________________________________] | | | | [V] Detaljer:
| | Bruger: Super User (root) | | Program:
/usr/bin/pk-example-frobnicate | | Handling:
org.fd.pk.example.pkexec.run-frobnicate | | Vendor: Examples
for the PolicyKit Project | | | | [Annull&eacute;r]
[Autorisering] |
+----------------------------------------------------------+</p>

<p>Note that pkexec does no validation of the ARGUMENTS
passed to PROGRAM. In the normal case (where administrator
authentication is required every time pkexec is used), this
is not a problem since if the user is an administrator he
might as well just run pkexec bash to get root.</p>

<p>However, if an action is used for which the user can
retain authorization (or if the user is implicitly
authorized), such as with pk-example-frobnicate above, this
could be a security hole. Therefore, as a rule of thumb,
programs for which the default required authorization is
changed, should never implicitly trust user input (e.g. like
any other well-written suid program).</p>

<p>AUTHOR Written by David Zeuthen davidz@redhat.com with a
lot of help from many others.</p>

<p>BUGS Please send bug reports to either the distribution
or the polkit-devel mailing list, see the link
http://lists.freedesktop.org/mailman/listinfo/polkit-devel
on how to subscribe.</p>

<p>SEE ALSO polkit(8), pkaction(1), pkcheck(1)</p>

<p>NOTES 1.
/usr/share/gtk-doc/html/polkit-1/pkexec-bash.png</p>

<p>2.
/usr/share/gtk-doc/html/polkit-1/pkexec-frobnicate.png</p>

<p>3.
/usr/share/gtk-doc/html/polkit-1/pkexec-frobnicate-da.png</p>

<p>polkit May 2009 PKEXEC(1)</p>
<hr>
</body>
</html>
