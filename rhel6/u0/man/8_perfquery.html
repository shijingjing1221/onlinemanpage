<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:09:52 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PERFQUERY(8) OpenIB Diagnostics PERFQUERY(8)</p>

<p>NAME perfquery - query InfiniBand port counters</p>

<p>SYNOPSIS perfquery [-d(ebug)] [-G(uid)] [-x|--extended]
[-X|--xmtsl] [-S|--rcvsl] [-D|--xmtdisc] [-a(ll_ports)]
[-l(oop_ports)] [-r(eset_after_read)] [-R(eset_only)] [-C
ca_name] [-P ca_port] [-t(imeout) timeout_ms] [-V(ersion)]
[-h(elp)] [&lt;lid|guid&gt; [[port] [reset_mask]]]</p>

<p>DESCRIPTION perfquery uses PerfMgt GMPs to obtain the
PortCounters (basic perfor- mance and error counters),
PortExtendedCounters, PortXmitDataSL, or PortRcvDataSL from
the PMA at the node/port specified. Optionally shows
aggregated counters for all ports of node. Also, optionally,
reset after read, or only reset counters.</p>

<p>Note: In PortCounters, PortCountersExtended,
PortXmitDataSL, and PortR- cvDataSL, components that
represent Data (e.g. PortXmitData and PortR- cvData)
indicate octets divided by 4 rather than just octets.</p>

<p>Note: Inputting a port of 255 indicates an operation be
performed on all ports.</p>

<p>OPTIONS -x, --extended show extended port counters
rather than (basic) port counters. Note that extended port
counters attribute is optional.</p>

<p>-X, --xmtsl show transmit data SL counter. This is an
optional counter for QoS.</p>

<p>-S, --rcvsl show receive data SL counter. This is an
optional counter for QoS.</p>

<p>-D, --xmtdisc show transmit discard details. This is an
optional counter.</p>

<p>-a, --all_ports show aggregated counters for all ports
of the destination lid or reset all counters for all ports.
If the destination lid does not support the AllPortSelect
flag, all ports will be iterated through to emulate
AllPortSelect behavior.</p>

<p>-l, --loop_ports If all ports are selected by the user
(either through the -a option or port 255) iterate through
each port rather than doing than aggregate operation.</p>

<p>-r, --reset_after_read reset counters after read</p>

<p>-R, --Reset_only only reset counters</p>

<p>COMMON OPTIONS Most OpenIB diagnostics take the
following common flags. The exact list of supported flags
per utility can be found in the usage message and can be
shown using the util_name -h syntax.</p>

<p># Debugging flags</p>

<p>-d raise the IB debugging level. May be used several
times (-ddd or -d -d -d).</p>

<p>-e show send and receive errors (timeouts and
others)</p>

<p>-h show the usage message</p>

<p>-v increase the application verbosity level. May be used
several times (-vv or -v -v -v)</p>

<p>-V show the version info.</p>

<p># Addressing flags</p>

<p>-G use GUID address argument. In most cases, it is the
Port GUID. Example: &quot;0x08f1040023&quot;</p>

<p>-s &lt;smlid&gt; use smlid as the target lid for SM/SA
queries.</p>

<p># Other common flags:</p>

<p>-C &lt;ca_name&gt; use the specified ca_name.</p>

<p>-P &lt;ca_port&gt; use the specified ca_port.</p>

<p>-t &lt;timeout_ms&gt; override the default timeout for
the solicited mads.</p>

<p>Multiple CA/Multiple Port Support</p>

<p>When no IB device or port is specified, the port to use
is selected by the following criteria:</p>

<p>1. the first port that is ACTIVE.</p>

<p>2. if not found, the first port that is UP (physical
link up).</p>

<p>If a port and/or CA name is specified, the user request
is attempted to be fulfilled, and will fail if it is not
possible.</p>

<p>EXAMPLES perfquery # read local port performance
counters</p>

<p>perfquery 32 1 # read performance counters from lid 32,
port 1</p>

<p>perfquery -x 32 1 # read extended performance counters
from lid 32, port 1</p>

<p>perfquery -a 32 # read perf counters from lid 32, all
ports</p>

<p>perfquery -r 32 1 # read performance counters and
reset</p>

<p>perfquery -x -r 32 1 # read extended performance
counters and reset</p>

<p>perfquery -R 0x20 1 # reset performance counters of port
1 only</p>

<p>perfquery -x -R 0x20 1 # reset extended performance
counters of port 1 only</p>

<p>perfquery -R -a 32 # reset performance counters of all
ports</p>

<p>perfquery -R 32 2 0x0fff # reset only error counters of
port 2</p>

<p>perfquery -R 32 2 0xf000 # reset only non-error counters
of port 2</p>

<p>AUTHOR Hal Rosenstock &lt;halr@voltaire.com&gt;</p>

<p>OpenIB September 21, 2009 PERFQUERY(8)</p>
<hr>
</body>
</html>
