<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:07:30 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>MODULI(5) BSD File Formats Manual MODULI(5)</p>

<p>NAME moduli - Diffie Hellman moduli</p>

<p>DESCRIPTION The /etc/ssh/moduli file contains prime
numbers and generators for use by sshd(8) in the
Diffie-Hellman Group Exchange key exchange method.</p>

<p>New moduli may be generated with ssh-keygen(1) using a
two-step process. An initial candidate generation pass,
using ssh-keygen -G, calculates numbers that are likely to
be useful. A second primality testing pass, using ssh-keygen
-T provides a high degree of assurance that the numbers are
prime and are safe for use in Diffie Hellman operations by
sshd(8). This moduli format is used as the output from each
pass.</p>

<p>The file consists of newline-separated records, one per
modulus, contain- ing seven space separated fields. These
fields are as follows:</p>

<p>timestamp The time that the modulus was last processed
as YYYYM- MDDHHMMSS.</p>

<p>type Decimal number specifying the internal structure of
the prime modulus. Supported types are:</p>

<p>0 Unknown, not tested 2 &quot;Safe&quot; prime; (p-1)/2
is also prime. 4 Sophie Germain; (p+1)*2 is also prime.</p>

<p>Moduli candidates initially produced by ssh-keygen(1)
are Sophie Germain primes (type 4). Futher primality testing
with ssh-keygen(1) produces safe prime moduli (type 2) that
are ready for use in sshd(8). Other types are not used by
OpenSSH.</p>

<p>tests Decimal number indicating the type of primality
tests that the number has been subjected to represented as a
bitmask of the following values:</p>

<p>0x00 Not tested 0x01 Composite number - not prime. 0x02
Sieve of Eratosthenes 0x04 Probabalistic Miller-Rabin
primality tests.</p>

<p>The ssh-keygen(1) moduli candidate generation uses the
Sieve of Eratosthenes (flag 0x02). Subsequent ssh-keygen(1)
primality tests are Miller-Rabin tests (flag 0x04).</p>

<p>trials Decimal number indicating of primaility trials
that have been performed on the modulus.</p>

<p>size Decimal number indicating the size of the prime in
bits.</p>

<p>generator The recommended generator for use with this
modulus (hexadecimal).</p>

<p>modulus The modulus itself in hexadecimal.</p>

<p>When performing Diffie Hellman Group Exchange, sshd(8)
first estimates the size of the modulus required to produce
enough Diffie Hellman output to sufficiently key the
selected symmetric cipher. sshd(8) then randomly selects a
modulus from /etc/ssh/moduli that best meets the size
require- ment.</p>

<p>SEE ALSO ssh-keygen(1), sshd(8),</p>

<p>Diffie-Hellman Group Exchange for the Secure Shell (SSH)
Transport Layer Protocol, RFC 4419, 2006.</p>

<p>BSD November 12, 2016 BSD</p>
<hr>
</body>
</html>
