<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:09:08 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PAM_SM_CHAUTHTOK(3) Linux-PAM Manual
PAM_SM_CHAUTHTOK(3)</p>

<p>NAME pam_sm_chauthtok - PAM service function for
authentication token management</p>

<p>SYNOPSIS #define PAM_SM_PASSWORD</p>

<p>#include &lt;security/pam_modules.h&gt;</p>

<p>PAM_EXTERN int pam_sm_chauthtok(pam_handle_t *pamh, int
flags, int argc, const char **argv);</p>

<p>DESCRIPTION The pam_sm_chauthtok function is the service
module&acute;s implementation of the pam_chauthtok(3)
interface.</p>

<p>This function is used to (re-)set the authentication
token of the user.</p>

<p>Valid flags, which may be logically OR&acute;d with
PAM_SILENT, are:</p>

<p>PAM_SILENT Do not emit any messages.</p>

<p>PAM_CHANGE_EXPIRED_AUTHTOK This argument indicates to
the module that the users authentication token (password)
should only be changed if it has expired. This flag is
optional and must be combined with one of the following two
flags. Note, however, the following two options are mutually
exclusive.</p>

<p>PAM_PRELIM_CHECK This indicates that the modules are
being probed as to their ready status for altering the
user&acute;s authentication token. If the module requires
access to another system over some network it should attempt
to verify it can connect to this system on receiving this
flag. If a module cannot establish it is ready to update the
user&acute;s authentication token it should return
PAM_TRY_AGAIN, this information will be passed back to the
application.</p>

<p>If the control value sufficient is used in the password
stack, the PAM_PRELIM_CHECK section of the modules following
that control value is not always executed.</p>

<p>PAM_UPDATE_AUTHTOK This informs the module that this is
the call it should change the authorization tokens. If the
flag is logically OR&acute;d with
PAM_CHANGE_EXPIRED_AUTHTOK, the token is only changed if it
has actually expired.</p>

<p>The PAM library calls this function twice in succession.
The first time with PAM_PRELIM_CHECK and then, if the module
does not return PAM_TRY_AGAIN, subsequently with
PAM_UPDATE_AUTHTOK. It is only on the second call that the
authorization token is (possibly) changed.</p>

<p>RETURN VALUES PAM_AUTHTOK_ERR The module was unable to
obtain the new authentication token.</p>

<p>PAM_AUTHTOK_RECOVERY_ERR The module was unable to obtain
the old authentication token.</p>

<p>PAM_AUTHTOK_LOCK_BUSY Cannot change the authentication
token since it is currently locked.</p>

<p>PAM_AUTHTOK_DISABLE_AGING Authentication token aging has
been disabled.</p>

<p>PAM_PERM_DENIED Permission denied.</p>

<p>PAM_TRY_AGAIN Preliminary check was unsuccessful.
Signals an immediate return to the application is
desired.</p>

<p>PAM_SUCCESS The authentication token was successfully
updated.</p>

<p>PAM_USER_UNKNOWN User unknown to password service.</p>

<p>SEE ALSO pam(3), pam_chauthtok(3), pam_sm_chauthtok(3),
pam_strerror(3), PAM(8)</p>

<p>Linux-PAM Manual 03/02/2009 PAM_SM_CHAUTHTOK(3)</p>
<hr>
</body>
</html>
