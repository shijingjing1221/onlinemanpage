<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:06:11 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>LIBPFM(3) Linux Programmer s Manual LIBPFM(3)</p>

<p>NAME libpfm - a helper library to program Hardware
Performance Units (PMUs)</p>

<p>SYNOPSIS #include &lt;perfmon/pfmlib.h&gt;</p>

<p>DESCRIPTION The libpfm library is a helper library which
is used by applications to help program the Performance
Monitoring Unit (PMU), i.e., the hardware performance
counters of modern processors. It provides a generic and
portable programming interface to help setup the PMU
configuration reg- isters given a list of events to
measure.</p>

<p>A diversity of PMU hardware is supported, a list can be
found below under SUPPORTED HARDWARE. The library is
primarily designed to be used in conjunction with the
Perfmon2 Linux kernel interface. However, at its core, it is
totally independent of that interface and could as well be
used on other operating systems. It is important to realize
that the library does not make the actual kernel calls to
program the PMU, it simply helps applications figure out
which PMU registers to use to mea- sure certain events or
access certain advanced PMU features.</p>

<p>The library logically divides PMU registers into two
categories. The performance monitoring data registers (PMD)
are used to collect results, e.g., counts. The performance
monitoring configuration regis- ters (PMCS) are used to
indicate what events to measure or what feature to enable.
Programming the PMU consists in setting up the PMC registers
and collecting the results in the PMD registers. The central
piece of the library is the pfm_dispatch_events
function.</p>

<p>The number of PMC and PMD registers varies between
architectures and CPU models. The association of PMC to PMD
can also change. Moreover the number and encodings of events
can also widely change. Finally, the structure of a PMC
register can also change. All these factors make it quite
difficult to write monitoring tools.</p>

<p>This library is designed to simplify the programming of
the PMC regis- ters by hiding the complexity behind a simple
interface. The library does this without limiting
accessibility to model specific features by using a layered
design.</p>

<p>The library is structured in two layers. The common
layer provides an interface that is shared across all PMU
models. This layer is good enough to setup simple monitoring
sessions which count occurrences of events. Then, there is a
model-specific layer which gives access to the
model-specific features. For instance, on Itanium,
applications can use the library to setup the registers for
the Branch Trace Buffer. Model-specific interfaces have the
abbreviated PMU model name in their names. For instance,
pfm_ita2_get_event_umask() is an Itanium2 (ita2) specific
function.</p>

<p>When the library is initialized, it automatically probes
the host CPU and enables the right set of interfaces.</p>

<p>The common interface is defined in the pfmlib.h header
file. Model- specific interfaces are defined in
model-specific header files. For instance, pfmlib_amd64.h
provides the AMD64 interface.</p>

<p>ENVIRONMENT VARIABLES It is possible to enable certain
debug output of the library using environment variables. The
following variables are defined:</p>

<p>LIBPFM_VERBOSE Enable verbose output. Value must be 0 or
1. When not set, ver- bosity level can be controlled with
this function.</p>

<p>LIBPFM_DEBUG Enable debug output. Value must be 0 or 1.
When not set, debug level can be controlled with this
function.</p>

<p>LIBPFM_DEBUG_STDOUT Redirect verbose and debug output to
the standard output file descriptor (stdout). By default,
the output is directed to the standard error file descriptor
(stderr).</p>

<p>Alternatively, it is possible to control verbosity and
debug output using the pfm_set_options function.</p>

<p>SUPPORTED HARDWARE libpfm_amd64(3) AMD64 processors K8
and Barcelona (families 0Fh and 10h) libpfm_core(3) Intel
Core processor family libpfm_atom(3) Intel Atom processor
family libpfm_itanium(3) Intel Itanium libpfm_itanium2(3)
Intel Itanium 2 libpfm_montecito(3) Intel dual-core Itanium
2 9000 (Montecito) libpfm_p6(3) P6 processor family
including the Pentium M processor libpfm_powerpc(3) IBM
PowerPC and POWER processor families (PPC970(FX,GX),
PPC970MP POWER4, POWER4+, POWER5, POWER5+, and POWER6)</p>

<p>AUTHORS Stephane Eranian &lt;eranian@hpl.hp.com&gt;
Robert Richter &lt;robert.richter@amd.com&gt;</p>

<p>SEE ALSO libpfm(3), libpfm_amd64(3), libpfm_core(3),
libpfm_itanium2(3), libpfm_itanium(3), libpfm_montecito(3),
libpfm_p6(3), libpfm_pow- erpc(3). pfm_dispatch_events(3),
pfm_find_event(3), pfm_set_options(3),
pfm_get_cycle_event(3), pfm_get_event_name(3),
pfm_get_impl_pmcs(3), pfm_get_pmu_name(3),
pfm_get_version(3), pfm_initialize(3), pfm_regmask_set(3),
pfm_set_options(3), pfm_strerror(3).</p>

<p>Examples shipped with the library</p>

<p>March, 2008 LIBPFM(3)</p>
<hr>
</body>
</html>
