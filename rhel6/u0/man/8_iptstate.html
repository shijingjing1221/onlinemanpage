<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:04:52 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>IPTSTATE(8) IPTSTATE(8)</p>

<p>NAME iptstate - A top-like display of IP Tables state
table entries</p>

<p>SYNOPSIS iptstate [&lt;options&gt;]</p>

<p>DESCRIPTION iptstate displays information held in the IP
Tables state table in real-time in a top-like format. Output
can be sorted by any field, or any field reversed. Users can
choose to have the output only print once and exit, rather
than the top-like system. Refresh rate is config- urable,
IPs can be resolved to names, output can be formatted, the
dis- play can be filtered, and color coding are among some
of the many fea- tures.</p>

<p>COMMAND-LINE OPTIONS -c, --no-color Toggle color-code by
protocol</p>

<p>-C, --counters Toggle display of bytes/packets
counters</p>

<p>-d, --dst-filter IP Only show states with a destination
of IP Note, that this must be an IP, hostname matching is
not yet supported.</p>

<p>-D --dstpt-filter port Only show states with a
destination port of port</p>

<p>-h, --help Show help message</p>

<p>-l, --lookup Show hostnames instead of IP addresses</p>

<p>-m, --mark-truncated Mark truncated hostnames with a
+</p>

<p>-o, --no-dynamic Toggle dynamic formatting</p>

<p>-L, --no-dns Skip outgoing DNS lookup states</p>

<p>-f, --no-loopback Filter states on loopback</p>

<p>-p, --no-scroll No scrolling (dont use a
&quot;pad&quot;). See SCROLLING AND PADS for more
information.</p>

<p>-r, --reverse Reverse sort order</p>

<p>-R, --rate seconds Refresh rate, followed by rate in
seconds. Note that this is for statetop mode, and not
applicable for single-run mode (--sin- gle).</p>

<p>-1, --single Single run (no curses)</p>

<p>-b, --sort column This determines what column to sort
by. Options: S Source Port d Destination IP (or Name) D
Destination Port p Protocol s State t TTL b Bytes P Packets
To sort by Source IP (or Name), dont use -b. Sorting by
bytes/packets is only available for kernels that support it,
and only when compiled against libnetfilter_conntrack (the
default).</p>

<p>-s, --src-filter IP Only show states with a source of
IP. Note, that this must be an IP, hostname matching is not
yet supported.</p>

<p>-S, --srcpt-filter port Only show states with a source
port of port</p>

<p>-t, --totals Toggle display of totals</p>

<p>INTERACTIVE OPTIONS As of version 2.0, all command-line
options are now available interac- tively using the same key
as the short-option. For example, --sort is also -b, so
while iptstate is running, hitting b will change the sort-
ing to the next column. Similarly, t toggles the display of
totals, and so on.</p>

<p>There are also extra interactive options: B - change
sorting to previ- ous column (opposite of b); q - quit; and
x - delete the currently highlighted state from the
netfilter conntrack table.</p>

<p>Additionally, the following keys are used to navigate
within iptstate:</p>

<p>Up or j - Move up one line</p>

<p>Down or k - Move down one line</p>

<p>Left or h - Move left one column</p>

<p>Right or l - Move right one column</p>

<p>PageUp or ^u - Move up one page</p>

<p>PageDown or ^d - Move down one page</p>

<p>Home - Go to the top</p>

<p>End - Go to the end</p>

<p>In many cases, iptstate needs to prompt you in order to
change some- thing. For example, if you want to set or
change the source-ip filter, when you hit s, iptstate will
pop up a prompt at the top of the window to ask you what you
want to set it to.</p>

<p>Note that like many UNIX applications, ctrl-G will tell
iptstate &quot;nev- ermind&quot; - itll remove the prompt
and forget you ever hit s.</p>

<p>In most cases, a blank response means &quot;clear&quot;
- clear the source IP filter, for example.</p>

<p>At anytime while iptstate is running, you can hit h to
get to the interactive help which will display all the
current settings to you as well give you a list of all
interactive commands available.</p>

<p>While running, space will immediately update the
display. Iptstate should gracefully handle all window
resizes, but if it doesnt, you can force it to re-calculate
and re-draw the screen with a ctrl-L.</p>

<p>SCROLLING AND PADS For almost any user, there is no
reason to turn off scrolling. The ability to turn this off -
and especially the ability to toggle this interactively - is
done more for theoretical completeness than anything
else.</p>

<p>But, nonetheless, here are the details. Typically in a
curses applica- tion you create a &quot;window.&quot;
Windows dont scroll, however. They are, at most, the size of
your terminal. Windows provide double-buffering to make
refreshing as fast and seemless as possible. However, to
enable scrolling, one has to use &quot;pads&quot; instead of
windows. Pads can be bigger than the current terminal. Then
all necessary data is written to the pad, and
&quot;scrolling&quot; becomes a function of just showing the
right part of that pad on the screen.</p>

<p>However, pads do not have the double-buffering feature
that windows have. Thus, there _might_ be some case where
for some user using some very strange machine, having
scrolling enabled could cause poor refreshing. Given the
nature of the way iptstate uses the screen though, I find
this highly unlikely. In addition, the scrolling method uses
a little more memory. However, iptstate is not a memory
intensive application, so this shouldn t be a problem even
on low-memory systems.</p>

<p>Nonetheless, if this does negatively affect you, the
option to turn it off is there.</p>

<p>EXIT STATUS Anything other than 0 indicates and error. A
list of current exit sta- tuses are below:</p>

<p>0 Success</p>

<p>1 Bad command-line arguments</p>

<p>2 Error communicating with the netfilter subsystem.</p>

<p>3 Terminal too narrow</p>

<p>BUGS There are no known bugs at this time.</p>

<p>BUG REPORTS All bugs should be reported to Phil Dibowitz
&lt;phil AT ipom DOT com&gt;. Please see the README and BUGS
for more information on bug reports. Please read the
WISHLIST before sending in features you hope to see.</p>

<p>NOTES iptstate does a lot of work to try to fit
everything on the screen in an easy-to-read way. However, in
some cases, hostnames may need to be truncated in lookup
mode. The truncation of names in lookup mode hap- pens from
the right for source because you most likely know your own
domain name, and from the left for destination because
knowing your users are connection to &quot;mail.a.&quot;
doesnt help much.</p>

<p>iptstate does not automatically handle window-resizes
while in the interactive help screen. If you do resize while
in this window, you should return to the main window, hit
ctrl-L to re-calculate and re- draw the screen, and then, if
you choose, return to the interactive help.</p>

<p>iptstate currently uses libnetfilter_conntrack to access
the netfilter connection state table. However, older
versions read out of /proc/net/ip_conntrack, and the current
version can still be compiled to do this. This deprecated
method can be racy on SMP systems, and can hurt performance
on very heavily loaded firewalls. This deprecated method
should be avoided - support will be removed in future
versions.</p>

<p>SEE ALSO iptables(8)</p>

<p>AUTHOR iptstate was written by Phil Dibowitz &lt;phil AT
ipom DOT com&gt; http://www.phildev.net/iptstate/</p>

<p>SEPTEMBER 2009 IPTSTATE(8)</p>
<hr>
</body>
</html>
