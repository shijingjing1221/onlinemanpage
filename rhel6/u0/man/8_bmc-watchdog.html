<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 21:54:44 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>bmc-watchdog(8) System Commands bmc-watchdog(8)</p>

<p>NAME bmc-watchdog - BMC watchdog timer daemon and
control utility</p>

<p>SYNOPSIS bmc-watchdog command [OPTION...]
[COMMAND_OPTIONS...]</p>

<p>DESCRIPTION bmc-watchdog controls a Baseboard Management
Controller (BMC) watchdog timer. The bmc-watchdog tool
typically executes as a cronjob or daemon to manage the
watchdog timer. A user must be root in order to run bmc-
watchdog.</p>

<p>BMC WATCHDOG DETAILS A BMC watchdog timer is part of the
Intelligent Platform Management Interface (IPMI)
specification and is only available to BMCs that are
compliant with IPMI. When a BMC watchdog timer is started,
it begins counting down to zero from some positive number of
seconds. When the timer hits zero, the timer will execute a
pre-configured pre-timeout interrupt and/or timeout
action.</p>

<p>In order to stop the pre-timeout interrupt or timeout
action from being executed, the watchdog timer must be
periodically reset back to its initial beginning value.</p>

<p>The BMC watchdog timer automatically stops itself when
the machine is rebooted. Therefore, when a machine is
brought up, the BMC watchdog timer must be setup again
before it can be used.</p>

<p>Typically, a BMC watchdog timer is used to automatically
reset a machine that has crashed. When the operating system
first starts up, the BMC timer is set to its initial
countdown value. At periodic inter- vals, when the operating
system is functioning properly, the watchdog timer can be
reset by the OS or a userspace program. Thus, the timer
never counts down to zero. When the system crashes, the
timer cannot be reset by the OS or userspace program.
Eventually, the timer will count- down to zero and reset the
machine.</p>

<p>See EXAMPLES below for examples of how bmc-watchdog is
commonly used.</p>

<p>COMMANDS The following commands are available to
bmc-watchdog.</p>

<p>-s, --set Set BMC Watchdog Configuration. BMC watchdog
timer configuration values can be set using the set command
options listed below under SET OPTIONS. If a particular
configuration parameter is not specified on the command
line, the current configuration of that parameter will not
be changed.</p>

<p>-g, --get Get BMC Watchdog Configuration and State. The
current configura- tion and state is printed to standard
output.</p>

<p>-r, --reset Reset BMC Watchdog Timer.</p>

<p>-t, --start Start BMC Watchdog Timer. Does nothing if
the timer is currently running. Identical to --reset command
when the timer is stopped with the exception of the start
command options listed below under START OPTIONS.</p>

<p>-y, --stop Stop BMC Watchdog Timer. Stops the current
timer.</p>

<p>-c, --clear Clear BMC Watchdog Configuration. Clears all
configuration val- ues for the watchdog timer, except for
timer use, which is kept at its current value.</p>

<p>-d, --daemon Run bmc-watchdog as a daemon. Configurable
BMC watchdog timer options are listed below under DAEMON
OPTIONS. The configuration values are set once, then the
daemon will reset the timer at specified periodic intervals.
Everytime the BMC watchdog timer is reset, a log entry will
be generated in the bmc-watchdog log. The default log is
stored at /var/log/freeipmi/bmc-watchdog.log. The daemon can
be stopped using the --stop command, --clear com- mand, or
by setting the stop_timer flag on the --set command.</p>

<p>GENERAL OPTIONS The following options are general
options for configuring IPMI communi- cation and executing
general tool commands. These options are generic and can be
used by any command.</p>

<p>-D, --driver-type=IPMIDRIVER Specify the driver type to
use instead of doing an auto selec- tion. The currently
available inband drivers are KCS, SSIF, OPENIPMI, and SUNBMC
(SUNBMC is currently experimental).</p>

<p>--disable-auto-probe Do not probe in-band IPMI devices
for default settings.</p>

<p>--driver-address=DRIVER-ADDRESS Specify the in-band
driver address to be used instead of the probed value.
DRIVER-ADDRESS should be prefixed with &quot;0x&quot; for a
hex value and 0 for an octal value.</p>

<p>--driver-device=DEVICE Specify the in-band driver device
path to be used instead of the probed path.</p>

<p>--register-spacing=REGISTER-SPACING Specify the in-band
driver register spacing instead of the probed value.</p>

<p>-f STRING, --logfile=FILE Specify an alternate logfile
from the default of /var/log/freeipmi/bmc-watchdog.log.</p>

<p>-n, --no-logging Turns off all logging done by
bmc-watchdog.</p>

<p>--config-file=FILE Specify an alternate configuration
file.</p>

<p>-W, --workaround-flags=WORKAROUNDS Specify workarounds
to vendor compliance issues. Multiple workarounds can be
specified separated by commas. See WORKAROUNDS below for a
list of available workarounds.</p>

<p>--debug Turn on debugging.</p>

<p>-?, --help Output a help list and exit.</p>

<p>--usage Output a usage message and exit.</p>

<p>-V, --version Output the program version and exit.</p>

<p>SET OPTIONS The following options can be used by the set
command to set or clear various BMC watchdog configuration
parameters.</p>

<p>-u INT, --timer-use=INT Set timer use. The timer use
value can be set to one of the fol- lowing: 1 = BIOS FRB2, 2
= BIOS POST, 3 = OS_LOAD, 4 = SMS OS, 5 = OEM.</p>

<p>-m INT, --stop-timer=INT Set Stop Timer Flag. A flag
value of 0 stops the current BMC watchdog timer. A value of
1 doesnt turn off the current watch- dog timer.</p>

<p>-l INT, --log=INT Set Log Flag. A flag value of 0 turns
logging on. A value of 1 turns logging off.</p>

<p>-a INT, --timeout-action=INT Set timeout action. The
timeout action can be set to one of the following: 0 = No
action, 1 = Hard Reset, 2 = Power Down, 3 = Power Cycle.</p>

<p>-p INT, --pre-timeout-interrupt=INT Set pre-timeout
interrupt. The pre timeout interrupt can be set to one of
the following: 0 = None, 1 = SMI, 2 = NMI, 3 = Messag- ing
Interrupt.</p>

<p>-z SECS, --pre-timeout-interval=SECONDS Set pre-timeout
interval in seconds.</p>

<p>-F, --clear-bios-frb2 Clear BIOS FRB2 Timer Use
Flag.</p>

<p>-P, --clear-bios-post Clear BIOS POST Timer Use
Flag.</p>

<p>-L, --clear-os-load Clear OS Load Timer Use Flag.</p>

<p>-S, --clear-sms-os Clear SMS/OS Timer Use Flag.</p>

<p>-O, --clear-oem Clear OEM Timer Use Flag.</p>

<p>-i SECS, --initial-countdown=SECONDS Set initial
countdown in seconds.</p>

<p>-w, --start-after-set Start timer after set command if
timer is stopped. This is typi- cally used when bmc-watchdog
is used as a cronjob. This can be used to automatically
start the timer after it has been set the first time.</p>

<p>-x, --reset-after-set Reset timer after set command if
timer is running.</p>

<p>-j, --start-if-stopped Don t execute set command if
timer is stopped, just start timer.</p>

<p>-k, --reset-if-running Dont execute set command if timer
is running, just reset timer. This is typically used when
bmc-watchdog is used as a cronjob. This can be used to reset
the timer after it has been initially started.</p>

<p>START OPTIONS The following options can be used by the
start command.</p>

<p>-G INT, --gratuitous-arp=INT Suspend or dont suspend
gratuitous ARPs while the BMC timer is running. A flag value
of 1 suspends gratuitous ARPs. A value of 0 will not suspend
gratuitous ARPs. If this option is not speci- fied,
gratuitous ARPs will not be suspended.</p>

<p>-A INT, --arp-response=INT Suspend or dont suspend
BMC-generated ARP responses while the BMC timer is running.
A flag value of 1 suspends ARP responses. A value of 0 will
not suspend ARP responses. If this option is not specified,
ARP responses will not be suspended.</p>

<p>DAEMON OPTIONS The following options can be used by the
daemon command to set the ini- tial BMC watchdog
configuration parameters.</p>

<p>-u INT, --timer-use=INT Set timer use. The timer use
value can be set to one of the fol- lowing: 1 = BIOS FRB2, 2
= BIOS POST, 3 = OS_LOAD, 4 = SMS OS, 5 = OEM.</p>

<p>-l INT, --log=INT Set Log Flag. A flag value of 0 turns
logging on. A value of 1 turns logging off.</p>

<p>-a INT, --timeout-action=INT Set timeout action. The
timeout action can be set to one of the following: 0 = No
action, 1 = Hard Reset, 2 = Power Down, 3 = Power Cycle.</p>

<p>-p INT, --pre-timeout-interrupt=INT Set pre-timeout
interrupt. The pre timeout interrupt can be set to one of
the following: 0 = None, 1 = SMI, 2 = NMI, 3 = Messag- ing
Interrupt.</p>

<p>-z SECS, --pre-timeout-interval=SECONDS Set pre-timeout
interval in seconds.</p>

<p>-F, --clear-bios-frb2 Clear BIOS FRB2 Timer Use
Flag.</p>

<p>-P, --clear-bios-post Clear BIOS POST Timer Use
Flag.</p>

<p>-L, --clear-os-load Clear OS Load Timer Use Flag.</p>

<p>-S, --clear-sms-os Clear SMS/OS Timer Use Flag.</p>

<p>-O, --clear-oem Clear OEM Timer Use Flag.</p>

<p>-i SECS, --initial-countdown=SECONDS Set initial
countdown in seconds.</p>

<p>-G INT, --gratuitous-arp=INT Suspend or dont suspend
gratuitous ARPs while the BMC timer is running. A flag value
of 1 suspends gratuitous ARPs. A value of 0 will not suspend
gratuitous ARPs. If this option is not speci- fied,
gratuitous ARPs will not be suspended.</p>

<p>-A INT, --arp-response=INT Suspend or dont suspend
BMC-generated ARP responses while the BMC timer is running.
A flag value of 1 suspends ARP responses. A value of 0 will
not suspend ARP responses. If this option is not specified,
ARP responses will not be suspended.</p>

<p>-e, --reset-period Time interval to wait before
resetting timer. The default is 60 seconds.</p>

<p>ERRORS Errors are logged to the bmc-watchdog log.</p>

<p>EXAMPLES Setup a bmc-watchdog daemon that resets the
machine after 15 minutes (900 seconds) if the OS has crashed
(see default bmc-watchdog rc script /etc/init.d/bmc-watchdog
for a more complete example): bmc-watchdog -d -u 4 -p 0 -a 1
-i 900</p>

<p>KNOWN ISSUES Bmc-watchdog may fail to reset the watchdog
timer if it is not sched- uled properly. It is always
recommended that bmc-watchdog be executed with a high
scheduling priority.</p>

<p>On some machines, the hardware based SMI Handler may
disable a proces- sor after a watchdog timer timeout if the
timer use is set to something other than SMS/OS.</p>

<p>REPORTING BUGS Report bugs to
&lt;freeipmi-users@gnu.org&gt; or
&lt;freeipmi-devel@gnu.org&gt;.</p>

<p>COPYRIGHT Copyright (C) 2007-2008 Lawrence Livermore
National Security, LLC. Copyright (C) 2004-2007 The Regents
of the University of California.</p>

<p>This program is free software; you can redistribute it
and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later
version.</p>

<p>SEE ALSO freeipmi(7)</p>

<p>http://www.gnu.org/software/freeipmi/</p>

<p>bmc-watchdog 0.7.16 2010-05-03 bmc-watchdog(8)</p>
<hr>
</body>
</html>
