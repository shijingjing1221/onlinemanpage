<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:12:46 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>RECONSTRUCT(8) RECONSTRUCT(8)</p>

<p>*</p>

<p>NAME reconstruct - reconstruct mailboxes</p>

<p>SYNOPSIS reconstruct [ -C config-file ] [ -p partition ]
[ -x ] [ -r ] [ -f ] [ -k ] [ -s ] [ -g ] [ -G ] mailbox...
reconstruct [ -C config-file ] -m</p>

<p>DESCRIPTION Reconstruct rebuilds one or more IMAP
mailboxes. When invoked with the -m switch, it rebuilds the
master mailboxes file. It can be used to recover from almost
any sort of data corruption.</p>

<p>If Reconstruct can find existing header and index files,
it attempts to preserve any data in them that is not
derivable from the message files themselves. The state
reconstruct attempts to preserve includes the flag names,
flag state, and internaldate. Reconstruct derives all other
information from the message files.</p>

<p>Reconstruct reads its configuration options out of the
imapd.conf(5) file unless specified otherwise by -C. Any
mailbox directory under- neath the path specified in the
partition-news configuration option is assumed to be in news
format.</p>

<p>Reconstruct does not adjust the quota usage recorded in
any quota root files. After running reconstruct, it is
advisable to run quota(8) with the -f switch in order to fix
the quota root files.</p>

<p>OPTIONS -C config-file Read configuration options from
config-file.</p>

<p>-p partition Search for the listed (non-existant)
mailboxes on the indicated partition. Create the mailboxes
in the database in addition to reconstructing them. (not
compatible with the use of wildcards)</p>

<p>-x When processing a mailbox which is not in the mailbox
list (e.g. via the -p or -f options), do not import the
metadata from the mailbox, instead create it anew (this
specifically affects at least the mailboxs seen state unique
identifier, user flags, and ACL).</p>

<p>-r Recursively reconstruct all sub-mailboxes of the
mailboxes or mailbox prefixes given as arguments.</p>

<p>-f Examine the filesystem underneath mailbox, adding all
directo- ries with a cyrus.header found there as new
mailboxes. Useful for restoring mailboxes from backups.</p>

<p>-k Preserve the cyrus.expunge file and the corresponding
message files instead of deleting them.</p>

<p>-s Adds synchronization records to the log, so the
synchronization service can replicate the changes.</p>

<p>-g Clear existing or regenerated GUIDs for all
messages.</p>

<p>-G Force regeneration of GUIDs for all messages.</p>

<p>-m NOTE: CURRENTLY UNAVAILABLE Rebuild the mailboxes
file. Use whatever data in the existing mailboxes file it
can scavenge, then scans all partitions listed in the
imapd.conf(5) file for additional mailboxes.</p>

<p>EXAMPLES You want to reconstruct the index files for a
user, you have recovered a deleted mail file from backup and
given it a suitable name (eg user/ben-lacy/33.), but it is
not visible since it is not indexed:</p>

<p>reconstruct -r user.ben-lacy</p>

<p>If you have the unixhierarchysep:yes option set in
/etc/imapd.conf you would need to run:</p>

<p>reconstruct -r user/ben.lacy</p>

<p>FILES /etc/imapd.conf</p>

<p>CMU Project Cyrus RECONSTRUCT(8)</p>
<hr>
</body>
</html>
