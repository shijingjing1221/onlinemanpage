<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:01:44 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>GIT-UPDATE-REF(1) Git Manual GIT-UPDATE-REF(1)</p>

<p>NAME git-update-ref - Update the object name stored in a
ref safely</p>

<p>SYNOPSIS git update-ref [-m &lt;reason&gt;] (-d
&lt;ref&gt; [&lt;oldvalue&gt;] | [--no-deref] &lt;ref&gt;
&lt;newvalue&gt; [&lt;oldvalue&gt;])</p>

<p>DESCRIPTION Given two arguments, stores the
&lt;newvalue&gt; in the &lt;ref&gt;, possibly dereferencing
the symbolic refs. E.g. git update-ref HEAD &lt;newvalue&gt;
updates the current branch head to the new object.</p>

<p>Given three arguments, stores the &lt;newvalue&gt; in
the &lt;ref&gt;, possibly dereferencing the symbolic refs,
after verifying that the current value of the &lt;ref&gt;
matches &lt;oldvalue&gt;. E.g. git update-ref
refs/heads/master &lt;newvalue&gt; &lt;oldvalue&gt; updates
the master branch head to &lt;newvalue&gt; only if its
current value is &lt;oldvalue&gt;. You can specify 40
&quot;0&quot; or an empty string as &lt;oldvalue&gt; to make
sure that the ref you are creating does not exist.</p>

<p>It also allows a &quot;ref&quot; file to be a symbolic
pointer to another ref file by starting with the four-byte
header sequence of &quot;ref:&quot;.</p>

<p>More importantly, it allows the update of a ref file to
follow these symbolic pointers, whether they are symlinks or
these &quot;regular file symbolic refs&quot;. It follows
real symlinks only if they start with &quot;refs/&quot;:
otherwise it will just try to read them and update them as a
regular file (i.e. it will allow the filesystem to follow
them, but will overwrite such a symlink to somewhere else
with a regular filename).</p>

<p>If --no-deref is given, &lt;ref&gt; itself is
overwritten, rather than the result of following the
symbolic pointers.</p>

<p>In general, using</p>

<p>git update-ref HEAD &quot;$head&quot;</p>

<p>should be a lot safer than doing</p>

<p>echo &quot;$head&quot; &gt;
&quot;$GIT_DIR/HEAD&quot;</p>

<p>both from a symlink following standpoint and an error
checking standpoint. The &quot;refs/&quot; rule for symlinks
means that symlinks that point to &quot;outside&quot; the
tree are safe: theyll be followed for reading but not for
writing (so well never write through a ref symlink to some
other tree, if you have copied a whole archive by creating a
symlink tree).</p>

<p>With -d flag, it deletes the named &lt;ref&gt; after
verifying it still contains &lt;oldvalue&gt;.</p>

<p>LOGGING UPDATES If config parameter
&quot;core.logAllRefUpdates&quot; is true or the file
&quot;$GIT_DIR/logs/&lt;ref&gt;&quot; exists then git
update-ref will append a line to the log file
&quot;$GIT_DIR/logs/&lt;ref&gt;&quot; (dereferencing all
symbolic refs before creating the log name) describing the
change in ref value. Log lines are formatted as:</p>

<p>1. oldsha1 SP newsha1 SP committer LF</p>

<p>Where &quot;oldsha1&quot; is the 40 character
hexadecimal value previously stored in &lt;ref&gt;,
&quot;newsha1&quot; is the 40 character hexadecimal value of
&lt;newvalue&gt; and &quot;committer&quot; is the committers
name, email address and date in the standard GIT committer
ident format.</p>

<p>Optionally with -m:</p>

<p>1. oldsha1 SP newsha1 SP committer TAB message LF</p>

<p>Where all fields are as described above and
&quot;message&quot; is the value supplied to the -m
option.</p>

<p>An update will fail (without changing &lt;ref&gt;) if
the current user is unable to create a new log file, append
to the existing log file or does not have committer
information available.</p>

<p>AUTHOR Written by Linus Torvalds
&lt;torvalds@osdl.org[1]&gt;.</p>

<p>GIT Part of the git(1) suite</p>

<p>NOTES 1. torvalds@osdl.org mailto:torvalds@osdl.org</p>

<p>Git 1.7.1 07/27/2010 GIT-UPDATE-REF(1)</p>
<hr>
</body>
</html>
