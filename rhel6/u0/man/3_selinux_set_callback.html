<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:14:53 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>selinux_set_callback(3) SELinux API documentation
selinux_set_callback(3)</p>

<p>NAME selinux_set_callback - userspace SELinux callback
facilities.</p>

<p>SYNOPSIS #include &lt;selinux/selinux.h&gt;</p>

<p>void selinux_set_callback(int type, union
selinux_callback callback);</p>

<p>DESCRIPTION selinux_set_callback sets the callback
indicated by type to the value of callback, which should be
passed as a function pointer cast to type union
selinux_callback.</p>

<p>All callback functions should return a negative value
with errno set appropriately on error.</p>

<p>The available values for type are:</p>

<p>SELINUX_CB_LOG int (*func_log) (int type, const char
*fmt, ...);</p>

<p>This callback is used for logging and should process the
printf(3) style fmt string and arguments as appropriate. The
type argument indicates the type of message and will be set
to one of the following:</p>

<p>SELINUX_ERROR</p>

<p>SELINUX_WARNING</p>

<p>SELINUX_INFO</p>

<p>SELINUX_AVC</p>

<p>SELINUX_CB_AUDIT int (*func_audit) (void *auditdata,
security_class_t cls, char *msgbuf, size_t msgbufsize);</p>

<p>This callback is used for supplemental auditing in AVC
messages. The auditdata and cls arguments are the values
passed to avc_has_perm(3). A human-readable interpretation
should be printed to msgbuf using no more than msgbufsize
characters.</p>

<p>SELINUX_CB_VALIDATE int (*func_validate)
(security_context_t *ctx);</p>

<p>This callback is used for context validation. The
callback may optionally modify the input context by setting
the target of the ctx pointer to a new context. In this
case, the old value should be freed with freecon(3). The
value of errno should be set to EINVAL to indicate an
invalid context.</p>

<p>SELINUX_CB_SETENFORCE int (*func_setenforce) (int
enforcing);</p>

<p>This callback is invoked when the system enforcing state
changes. The enforcing argument indicates the new value and
is set to 1 for enforcing mode, and 0 for permissive
mode.</p>

<p>SELINUX_CB_POLICYLOAD int (*func_policyload) (int
seqno);</p>

<p>This callback is invoked when the system security policy
is reloaded. The seqno argument is the current sequential
number of the policy generation in the system.</p>

<p>RETURN VALUE None.</p>

<p>ERRORS None.</p>

<p>AUTHOR Eamon Walsh &lt;ewalsh@tycho.nsa.gov&gt;</p>

<p>SEE ALSO selabel_open(3), avc_init(3),
avc_netlink_open(3), selinux(8)</p>

<p>20 Jun 2007 selinux_set_callback(3)</p>
<hr>
</body>
</html>
