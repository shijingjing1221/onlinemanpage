<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:18:19 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>SYNC_FILE_RANGE(2) Linux Programmer s Manual
SYNC_FILE_RANGE(2)</p>

<p>NAME sync_file_range - sync a file segment with disk</p>

<p>SYNOPSIS #define _GNU_SOURCE #include
&lt;fcntl.h&gt;</p>

<p>int sync_file_range(int fd, off64_t offset, off64_t
nbytes, unsigned int flags);</p>

<p>DESCRIPTION sync_file_range() permits fine control when
synchronizing the open file referred to by the file
descriptor fd with disk.</p>

<p>offset is the starting byte of the file range to be
synchronized. nbytes specifies the length of the range to be
synchronized, in bytes; if nbytes is zero, then all bytes
from offset through to the end of file are synchronized.
Synchronization is in units of the system page size: offset
is rounded down to a page boundary; (offset+nbytes-1) is
rounded up to a page boundary.</p>

<p>The flags bit-mask argument can include any of the
following values:</p>

<p>SYNC_FILE_RANGE_WAIT_BEFORE Wait upon write-out of all
pages in the specified range that have already been
submitted to the device driver for write-out before
performing any write.</p>

<p>SYNC_FILE_RANGE_WRITE Initiate write-out of all dirty
pages in the specified range which are not presently
submitted write-out. Note that even this may block if you
attempt to write more than request queue size.</p>

<p>SYNC_FILE_RANGE_WAIT_AFTER Wait upon write-out of all
pages in the range after performing any write.</p>

<p>Specifying flags as 0 is permitted, as a no-op.</p>

<p>Some details None of these operations write out the
files metadata. Therefore, unless the application is
strictly performing overwrites of already- instantiated disk
blocks, there are no guarantees that the data will be
available after a crash.</p>

<p>SYNC_FILE_RANGE_WAIT_BEFORE and
SYNC_FILE_RANGE_WAIT_AFTER will detect any I/O errors or
ENOSPC conditions and will return these to the caller.</p>

<p>Useful combinations of the flags bits are:</p>

<p>SYNC_FILE_RANGE_WAIT_BEFORE | SYNC_FILE_RANGE_WRITE
Ensures that all pages in the specified range which were
dirty when sync_file_range() was called are placed under
write-out. This is a start-write-for-data-integrity
operation.</p>

<p>SYNC_FILE_RANGE_WRITE Start write-out of all dirty pages
in the specified range which are not presently under
write-out. This is an asynchronous flush-to-disk operation.
This is not suitable for data integrity operations.</p>

<p>SYNC_FILE_RANGE_WAIT_BEFORE (or
SYNC_FILE_RANGE_WAIT_AFTER) Wait for completion of write-out
of all pages in the specified range. This can be used after
an earlier SYNC_FILE_RANGE_WAIT_BEFORE |
SYNC_FILE_RANGE_WRITE operation to wait for completion of
that operation, and obtain its result.</p>

<p>SYNC_FILE_RANGE_WAIT_BEFORE | SYNC_FILE_RANGE_WRITE |
SYNC_FILE_RANGE_WAIT_AFTER This is a
write-for-data-integrity operation that will ensure that all
pages in the specified range which were dirty when
sync_file_range() was called are committed to disk.</p>

<p>RETURN VALUE On success, sync_file_range() returns 0; on
failure -1 is returned and errno is set to indicate the
error.</p>

<p>ERRORS EBADF fd is not a valid file descriptor.</p>

<p>EINVAL flags specifies an invalid bit; or offset or
nbytes is invalid.</p>

<p>EIO I/O error.</p>

<p>ENOMEM Out of memory.</p>

<p>ENOSPC Out of disk space.</p>

<p>ESPIPE fd refers to something other than a regular file,
a block device, a directory, or a symbolic link.</p>

<p>VERSIONS sync_file_range() appeared on Linux in kernel
2.6.17.</p>

<p>CONFORMING TO This system call is Linux-specific, and
should be avoided in portable programs.</p>

<p>SEE ALSO fdatasync(2), fsync(2), msync(2), sync(2),
feature_test_macros(7)</p>

<p>COLOPHON This page is part of release 3.22 of the Linux
man-pages project. A description of the project, and
information about reporting bugs, can be found at
http://www.kernel.org/doc/man-pages/.</p>

<p>Linux 2008-05-27 SYNC_FILE_RANGE(2)</p>
<hr>
</body>
</html>
