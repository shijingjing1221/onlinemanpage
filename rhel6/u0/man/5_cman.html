<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 21:55:59 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>cman(5) cluster.conf cman configuration section
cman(5)</p>

<p>NAME cman - cluster.conf cman configuration section</p>

<p>DESCRIPTION Cman configuration values are placed in the
&lt;cman&gt; &lt;/cman&gt; sec- tion of cluster.conf.
Per-node configuration related to cman is placed in the
standard &lt;clusternode&gt; &lt;/clusternode&gt; sections.
All cman configuration settings are optional; usually none
are used. The &lt;cman&gt; section is placed under the
&lt;cluster&gt; section in cluster.conf.</p>

<p>&lt;cluster&gt; &lt;cman&gt; &lt;/cman&gt; ...
&lt;/cluster&gt;</p>

<p>UDP port By default, cman will use UDP port 5405/5404
for internode com- munication. This can be changed by
setting a port number as follows:</p>

<p>&lt;cman port=&quot;6809&quot;&gt; &lt;/cman&gt;</p>

<p>This will cause cman to use ports 6809 and 6808 for
cluster com- munications.</p>

<p>Expected votes The expected votes value is used by cman
to determine quorum. The cluster is quorate if the sum of
votes of existing members is over half of the expected votes
value. By default, cman sets the expected votes value to be
the sum of votes of all nodes listed in cluster.conf. This
can be overridden by setting an explicit expected_votes
value as follows:</p>

<p>&lt;cman expected_votes=&quot;3&quot;&gt;
&lt;/cman&gt;</p>

<p>If the cluster becomes partitioned, improper use of this
option can result in more than one partition gaining quorum.
In that event, nodes in each partition will enable cluster
services.</p>

<p>Two node clusters Ordinarily, the loss of quorum after
one out of two nodes fails will prevent the remaining node
from continuing (if both nodes have one vote.) Special
configuration options can be set to allow the one remaining
node to continue operating if the other fails. To do this
only two nodes, each with one vote, can be defined in
cluster.conf. The two_node and expected_votes values must
then be set to 1 in the cman section as follows.</p>

<p>&lt;cman two_node=&quot;1&quot;
expected_votes=&quot;1&quot;&gt; &lt;/cman&gt;</p>

<p>Node votes By default, a node is given one vote toward
the calculation of quorum. This can be changed by giving a
node a specific number of votes as follows:</p>

<p>&lt;clusternode name=&quot;nd1&quot;
votes=&quot;2&quot;&gt; &lt;/clusternode&gt;</p>

<p>Node ID</p>

<p>All nodes must have a unique node ID. This is a single
integer that identifies it to the cluster. A node s
application to join the cluster may be rejected if you try
to set the nodeid to one that is already used.</p>

<p>&lt;clusternode name=&quot;nd1&quot;
nodeid=&quot;1&quot;&gt; &lt;/clusternode&gt;</p>

<p>Multi-home configuration It is quite common to use
multiple ethernet adapters for cluster nodes, so they will
tolerate the failure of one link. A common way to do this is
to use ethernet bonding. Alternatively you can get corosync
to run in redundant ring mode by specifying an altname for
the node. This is an alternative name by which the node is
known, that resolves to another IP address used on the other
ethernet adapter(s). You can optionally specify a differ-
ent port and/or multicast address for each altname in use.
Up to 9 altnames (10 interfaces in total) can be used.</p>

<p>Note that if you are using the DLM with cman/corosync
then you MUST tell it to use SCTP as its communications
protocol as TCP does not support multihoming.</p>

<p>&lt;clusternode name=&quot;nd1&quot;
nodeid=&quot;1&quot;&gt; &lt;altname name=&quot;nd1a&quot;
port=&quot;6809&quot; mcast=&quot;229.192.0.2&quot;/&gt;
&lt;/clusternode&gt;</p>

<p>&lt;dlm protocol=&quot;sctp&quot;/&gt;</p>

<p>Multicast network configuration cman uses multicast UDP
packets to communicate with other nodes in the cluster. By
default it will generate a multicast address using
239.192.x.x where x.x is the 16bit cluster ID number split
into bytes. This, in turn is generated from a hash of the
clus- ter name though it can be specified explicitly. The
purpose of this is to allow multiple clusters to share the
same subnet - they will each use a different multicast
address. You might also/instead want to isolate clusters
using the port number as shown above.</p>

<p>It is possible to override the multicast address by
specifying it in cluster.conf as shown:</p>

<p>&lt;cman&gt; &lt;multicast
addr=&quot;229.192.0.1&quot;/&gt; &lt;/cman&gt;</p>

<p>Cluster ID The cluster ID number is used to isolate
clusters in the same subnet. Usually it is generated from a
hash of the cluster name, but it can be overridden here if
you feel the need. Sometimes cluster names can hash to the
same ID.</p>

<p>&lt;cman cluster_id=&quot;669&quot;&gt;
&lt;/cman&gt;</p>

<p>corosync security key All traffic sent out by
cman/corosync is encrypted. By default the security key used
is simply the cluster name. If you need more security you
can specify a key file that contains the key used to encrypt
cluster communications. Of course, the contents of the key
file must be the same on all nodes in the cluster. It is up
to you to securely copy the file to the nodes.</p>

<p>&lt;cman
keyfile=&quot;/etc/cluster/corosync.key&quot;&gt;
&lt;/cman&gt;</p>

<p>Note that this only applies to cluster communication.
The DLM does not encrypt traffic.</p>

<p>Other corosync parameters When corosync is started by
cman (cman_tool runs corosync), the corosync.conf file is
not used. Many of the configuration parameters listed in
corosync.conf can be set in cluster.conf instead. Cman will
read corosync parameters from the following sections in
cluster.conf and load them into corosync:</p>

<p>&lt;cluster&gt; &lt;totem /&gt; &lt;event /&gt;
&lt;aisexec /&gt; &lt;group /&gt; &lt;/cluster&gt;</p>

<p>See the corosync.conf(5) man page for more information
on keys that are valid for these sections. Note that
settings in the &lt;clusternodes&gt; section will override
settings in the sections above, and options on the cman_tool
command line will override both. In particular, settings
like bindnetaddr, mcastaddr, mcastport and nodeid will
always be replaced by values in &lt;clus- ternodes&gt;.</p>

<p>Cman uses different defaults for some of the corosync
parameters listed in corosync.conf(5). If you wish to use a
non-default setting, they can be configured in cluster.conf
as shown above. Cman uses the following default values:</p>

<p>&lt;totem vsftype=&quot;none&quot;
token=&quot;10000&quot;
token_retransmits_before_loss_const=&quot;20&quot;
join=&quot;60&quot; consensus=&quot;4800&quot;
rrp_mode=&quot;none&quot; &lt;!-- or
rrp_mode=&quot;active&quot; if altnames are present &gt;
/&gt; &lt;aisexec user=&quot;root&quot;
group=&quot;root&quot; /&gt;</p>

<p>Heres how to set the token timeout to five seconds:</p>

<p>&lt;totem token=&quot;5000&quot;/&gt;</p>

<p>SEE ALSO cluster.conf(5), corosync.conf(5),
cman_tool(8)</p>

<p>cman(5)</p>
<hr>
</body>
</html>
