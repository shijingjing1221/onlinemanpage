<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:08:11 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>NANNY(8) NANNY(8)</p>

<p>NAME nanny - tool to monitor status of services in a
cluster</p>

<p>SYNOPSIS nanny has two forms, depending on whether it is
being used to monitor virtual server services running on
real servers, or failover services running on a primary or
backup cluster node.</p>

<p>Using nanny to monitor virtual server services:</p>

<p>nanny [-t|--interval=ARG] [-I|--ipvsadm=ARG]
[-M|--method=ARG] [-U|--loadcmd=ARG] [-n|--nodaemon]
[-c|--nofork] [--test-start] [--norun] [-p|--port=ARG]
[-a|--reentrytime=ARG] [-h|--server=ARG] [-f|--fwmark=ARG]
[-r|--rport=ARG] [-v|--verbose] [-V|--virtaddress=ARG]
[-w|--weight=ARG] [-S|--scale=ARG] [-s|--send_string=ARG]
[-e|--send_program=ARG[-x|--expect_string=ARG]
[-q|--quiesce-server] [-u|--UDP] [-T|--suppress] [-?|--help]
[--usage] [--version]</p>

<p>Using nanny to monitor failover services:</p>

<p>nanny [-t|--interval=ARG] [-U|--loadcmd=ARG]
[-n|--nodaemon] [-c|--nofork] [--test-start] [--norun]
[-p|--port=ARG] [-h|--server=ARG] [-r|--rport=ARG]
[-v|--verbose] [-V|--virtaddress=ARG] [-s|--send_string=ARG]
[-x|--expect_string=ARG] [-R|--startup=ARG]
[-D|--shutdown=ARG] [-u|--UDP] [-T|--suppress] [-?|--help]
[--usage] [--version]</p>

<p>DESCRIPTION nanny is a daemon used by pulse to monitor
the running status of the specified services on clustered
servers. This tool has NO error check- ing and should not be
run without the direct supervision of pulse!</p>

<p>OPTIONS -t ARG|--interval= ARG ARG specifies the number
of seconds to wait between connection attempts to the
server/service.</p>

<p>-I ARG|--ipvsadm= ARG This s the path to the ipvsadm
tool, which is normally /sbin/ipvsadm. This parameter is not
used in failover service monitoring.</p>

<p>-M ARG|--method= ARG This option specifies the routing
method for the real server (this parameter is not used in
monitoring failover services). Allowable choices are:</p>

<p>g - Use gatewaying (direct routing).</p>

<p>m - Use masquerading (network access translation, or
NAT).</p>

<p>t - Use ipip encapsulation (tunneling).</p>

<p>-U|--loadcmd=ARG Command to get remote load average
and/or perform file transfers with (rup, rsh, ssh).</p>

<p>-n|--nodaemon Normally, nanny runs as a daemon but with
this option runs in the foreground. When running in this
mode, nanny sends all out- put to STDOUT instead of to
syslog.</p>

<p>-c|--nofork This mode forces nanny to disassociate from
the terminal, but dont fork off into a daemon.</p>

<p>--test-start Runs nanny in a test mode. Reports, but
does not start, other daemon processes.</p>

<p>--norun Same as &quot;--test-start&quot;.</p>

<p>-p|--port= ARG Port used on the virtual IP address of
the service to be moni- tored (fos), or the port used on the
address of the virtual ser- vice to be monitored (lvsd). If
omitted, port 80 (http) is assumed.</p>

<p>-a|--reentrytime= ARG The number of seconds a failed
service must remain alive before allowing the service/node
back into the cluster. The main pur- pose of this time delay
is to avoid having a service or node ping-ponging. As a
general rule of thumb, if the service is available
uninterupted for 60-120 seconds, then it is generally ok to
let it back into the cluster. This parameter is ignored for
failover services.</p>

<p>-S|--scale= ARG This is a factor used to adjust the
sensitivity of the real server loading algorythm. By
increasing this factor, the CPU load on the server must be
much higher before the weighting of the server will be
affected in the LVS routing table. This parameter is ignored
for failover services.</p>

<p>-h|--server= ARG This is the IP address of the server
that is to be monitored. MUST BE SPECIFIED.</p>

<p>-f|--fwmark= ARG This is the firewalling mark of the
virtual service to be moni- tored (lvsd). If this option is
set, the --virtaddress option will be ignored.</p>

<p>-r|--rport= ARG Port for nanny to monitor on the real
server to check for ser- vice availability. If omitted, port
80 (http) is assumed.</p>

<p>-V|--virtaddress= ARG This is the virtual IP address of
the service to be monitored (fos), or the address of the
virtual service to be monitored (lvsd).</p>

<p>-w|--weight= ARG The relative weighting of the real
servers can be adjusted by changing this setting to a higher
number. For example, if one server has a weighting of 1 and
another one has a weight of 2, the second one will get twice
as many requests redirected to it. The user-assigned weight
of the server is adjusted dynamically based the cpu load
average and by the scale factor. This parame- ter is ignored
for failover services.</p>

<p>-e|--send_program = FILE This option depreciates the -s
option when used. It s fuction is to allow the use of an
external program or script in preferance to the static -s
argument against each of the real servers defined in the
lvs.cf config file. The special token %h is replaced with
the IP of each of the defined real servers and can be used
more than once though it will carry the same IP of the
defined real server that has been selected. The special
token %p is replaced with the port of each of the defined
real servers and can be used more than once though it too
will carry the same port value of the defined real server
that has been selected. eg. ping -c1 %h</p>

<p>-s|--send_str= ARG Optional text string to send to the
port in order to test whether the service is functioning.
Length is limited to 255 , , \, and printable, quoteable
text characters (0 are also permitted). If the send_str
option is omitted altogether, then no attempt to send data
will occur EXCEPT if port = 80 and expect_str is also
omitted, in which case a web service is assumed and an http
test string will be sent and expected (for backwards
compatibility with earlier releases of piranha).</p>

<p>If both --send_str and --expect_str are specified, then
the send_str string will be sent first, before the
expect_str string is received and tested. If neither are
specified (and port is not 80), then the service will only
be tested by the success and/or failure of connecting to the
port. No other I/O will be performed.</p>

<p>-x|--expect_str= ARG Optional text response string
expected from the port in order to test whether the service
is functioning. Length is limited to , , \, 255 printable,
quotable text characters (0 and are also permitted). If
expect_str=&quot;*&quot;, then any characters are accepted
(but SOMETHING must be received). This is different than not
specifying any expect string, which means do not even
attempt the receive operation.</p>

<p>If this option is omitted then no attempt to receive
data will occur EXCEPT if port = 80 and send_str is also
omitted, in which case a web service is assumed and an http
test string will be sent and expected (for backwards
compatibility with earlier releases of piranha).</p>

<p>If both --send_str and --expect_str are specified, then
the send_str string will be sent first, before the
expect_str string is received and tested. If neither are
specified, the service will only be tested by the success
and/or failure of connecting to the port. No other I/O will
be performed.</p>

<p>-T|--suppress Suppress translation of characters in
send/expect strings. Try this if your send/expect strings
are not being handled prop- erly. It will prevent the nanny
program from performing its own translations.</p>

<p>-R|--startup=ARG This parameter is mandatory for
monitoring failover services, and must be omitted for
monitoring real servers. The specified value is the command
or script to execute to start the monitored service and a
single optional parameter separated by a space. Failover
services are started and stopped by nanny as part of the
failover process, and nanny determines whether the service
it is monitoring is a failover service (instead of a virtual
server) by the presence or absence of this parameter.</p>

<p>The command used should be repeatable; meaning that it
should be harmless (other than a possible returned error
value) to execute the command multiple times in a row.</p>

<p>-D|--shutdown=ARG This parameter is mandatory for
monitoring failover services, and must be omitted for
monitoring real servers. The specified value is the command
or script to execute to stop the monitored service and a
single optional parameter separated by a space. Failover
services are started and stopped by nanny as part of the
failover process, and nanny determines whether the service
it is monitoring is a failover service (instead of a virtual
server) by the presence or absence of this parameter.</p>

<p>The command used should be repeatable; meaning that it
should be harmless (other than a possible returned error
value) to execute the command multiple times in a row.</p>

<p>-q|--quiesce-server Quiesce server when service
monitoring timeouts. It is useful when a server is too busy
to serve new requests, nanny will qui- esce this server by
setting its weight zero, so that established connections
still get served by this server and no new requests will be
sent to this server.</p>

<p>-u|--UDP Use the UDP protocol instead of TCP for monitor
communications.</p>

<p>-v|--verbose Give *lots* of debugging information to
either syslog or STDOUT.</p>

<p>-?|--help Shows a verbose usage listing.</p>

<p>--usage Outputs a terse argument summary.</p>

<p>--version Displays program version.</p>

<p>SEE ALSO lvs.cf(5), ipvsadm(8), lvsd(8), pulse(8).</p>

<p>AUTHOR Philip Copeland &lt;bryce@redhat.com&gt; Erik
Troan &lt;ewt@redhat.com&gt; Keith Barrett
&lt;kbarrett@redhat.com&gt;</p>

<p>4th Berkeley Distribution Sat Aug 18 2001 NANNY(8)</p>
<hr>
</body>
</html>
