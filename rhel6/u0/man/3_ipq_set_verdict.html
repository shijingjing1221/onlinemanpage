<!-- Creator     : groff version 1.18.1.4 -->
<!-- CreationDate: Sat Nov 12 22:04:49 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>IPQ_SET_VERDICT(3) Linux Programmer s Manual
IPQ_SET_VERDICT(3)</p>

<p>NAME ipq_set_verdict issue verdict and optionally
modified packet to ker- nel</p>

<p>SYNOPSIS #include &lt;linux/netfilter.h&gt; #include
&lt;libipq.h&gt;</p>

<p>int ipq_set_verdict(const struct ipq_handle *h, ipq_id_t
id, unsigned int verdict, size_t data_len, unsigned char
*buf);</p>

<p>DESCRIPTION The ipq_set_verdict function issues a
verdict on a packet previously obtained with ipq_read,
specifing the intended disposition of the packet, and
optionally supplying a modified version of the payload
data.</p>

<p>The h parameter is a context handle which must
previously have been returned successfully from a call to
ipq_create_handle.</p>

<p>The id parameter is the packet identifier obtained via
ipq_get_packet.</p>

<p>The verdict parameter must be one of:</p>

<p>NF_ACCEPT Accept the packet and continue traversal
within the kernel.</p>

<p>NF_DROP Drop the packet.</p>

<p>NF_QUEUE Requeue the packet.</p>

<p>NF_STOLEN and NF_REPEAT are kernel-internal constants
and should not be used from userspace as their exact side
effects have not been investi- gated.</p>

<p>The data_len parameter is the length of the data pointed
to by buf, the optional replacement payload data.</p>

<p>If simply setting a verdict without modifying the
payload data, use zero for data_len and NULL for buf.</p>

<p>The application is responsible for recalculating any
packet checksums when modifying packets.</p>

<p>RETURN VALUE On failure, -1 is returned. On success, a
non-zero positive value is returned.</p>

<p>ERRORS On error, a descriptive error message will be
available via the ipq_errstr function.</p>

<p>BUGS None known.</p>

<p>AUTHOR James Morris &lt;jmorris@intercode.com.au&gt;</p>

<p>COPYRIGHT Copyright (c) 2000-2001 Netfilter Core
Team.</p>

<p>Distributed under the GNU General Public License.</p>

<p>SEE ALSO iptables(8), libipq(3).</p>

<p>Linux iptables 1.2 16 October 2001
IPQ_SET_VERDICT(3)</p>
<hr>
</body>
</html>
