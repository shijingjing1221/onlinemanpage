<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:27:52 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>STRONGSWAN.CONF</title>

</head>
<body>

<h1 align="center">STRONGSWAN.CONF</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#SYNTAX">SYNTAX</a><br>
<a href="#INCLUDING FILES">INCLUDING FILES</a><br>
<a href="#READING VALUES">READING VALUES</a><br>
<a href="#DEFINED KEYS">DEFINED KEYS</a><br>
<a href="#LOGGER CONFIGURATION">LOGGER CONFIGURATION</a><br>
<a href="#JOB PRIORITY MANAGEMENT">JOB PRIORITY MANAGEMENT</a><br>
<a href="#IKE_SA_INIT DROPPING">IKE_SA_INIT DROPPING</a><br>
<a href="#LOAD TESTS">LOAD TESTS</a><br>
<a href="#IKEv2 RETRANSMISSION">IKEv2 RETRANSMISSION</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">strongswan.conf
&minus; strongSwan configuration file</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">While the
<i>ipsec.conf</i>(5) configuration file is well suited to
define IPsec related configuration parameters, it is not
useful for other strongSwan applications to read options
from this file. The file is hard to parse and only <i>ipsec
starter</i> is capable of doing so. As the number of
components of the strongSwan project is continually growing,
a more flexible configuration file was needed, one that is
easy to extend and can be used by all components. With
strongSwan 4.2.1 <i>strongswan.conf</i>(5) was introduced
which meets these requirements.</p>

<h2>SYNTAX
<a name="SYNTAX"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The format of
the strongswan.conf file consists of hierarchical
<b>sections</b> and a list of <b>key/value pairs</b> in each
section. Each section has a name, followed by C-Style curly
brackets defining the section body. Each section body
contains a set of subsections and key/value pairs:</p>

<pre style="margin-left:11%; margin-top: 1em">     settings := (section|keyvalue)*
     section  := name { settings }
     keyvalue := key = value\n</pre>


<p style="margin-left:11%; margin-top: 1em">Values must be
terminated by a newline.</p>

<p style="margin-left:11%; margin-top: 1em">Comments are
possible using the <b>#</b>-character, but be careful: The
parser implementation is currently limited and does not like
brackets in comments.</p>

<p style="margin-left:11%; margin-top: 1em">Section names
and keys may contain any printable character except:</p>

<pre style="margin-left:11%; margin-top: 1em">     . { } # \n \t space</pre>


<p style="margin-left:11%; margin-top: 1em">An example file
in this format might look like this:</p>

<pre style="margin-left:11%; margin-top: 1em">     a = b
     section-one {
          somevalue = asdf
          subsection {
               othervalue = xxx
          }
          # yei, a comment
          yetanother = zz
     }
     section-two {
          x = 12
     }</pre>


<p style="margin-left:11%; margin-top: 1em">Indentation is
optional, you may use tabs or spaces.</p>

<h2>INCLUDING FILES
<a name="INCLUDING FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Using the
<b>include</b> statement it is possible to include other
files into strongswan.conf, e.g.</p>

<pre style="margin-left:11%; margin-top: 1em">     include /some/path/*.conf</pre>


<p style="margin-left:11%; margin-top: 1em">If the file
name is not an absolute path, it is considered to be
relative to the directory of the file containing the include
statement. The file name may include shell wildcards (see
<i>sh</i>(1)). Also, such inclusions can be nested.</p>

<p style="margin-left:11%; margin-top: 1em">Sections loaded
from included files <i>extend</i> previously loaded
sections; already existing values are <i>replaced</i>. It is
important to note that settings are added relative to the
section the include statement is in.</p>

<p style="margin-left:11%; margin-top: 1em">As an example,
the following three files result in the same final config as
the one given above:</p>
<pre style="margin-left:11%; margin-top: 1em">     a = b
     section-one {
          somevalue = before include
          include include.conf
     }
     include other.conf

include.conf:
     # settings loaded from this file are added to section-one
     # the following replaces the previous value
     somevalue = asdf
     subsection {
          othervalue = yyy
     }
     yetanother = zz


other.conf:
     # this extends section-one and subsection
     section-one {
          subsection {
               # this replaces the previous value
               othervalue = xxx
          }
     }
     section-two {
          x = 12
     }</pre>


<h2>READING VALUES
<a name="READING VALUES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Values are
accessed using a dot-separated section list and a key. With
reference to the example above, accessing
<b>section-one.subsection.othervalue</b> will return
<b>xxx</b>.</p>

<h2>DEFINED KEYS
<a name="DEFINED KEYS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
keys are currently defined (using dot notation). The default
value (if any) is listed in brackets after the key.</p>

<p style="margin-left:11%; margin-top: 1em"><b>attest
section <br>
attest.database</b></p>

<p style="margin-left:22%;">Path to database with file
measurement information</p>

<p style="margin-left:11%;"><b>attest.load</b></p>

<p style="margin-left:22%;">Plugins to load in ipsec attest
tool</p>

<p style="margin-left:11%; margin-top: 1em"><b>charon
section</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>Note</b>:</p></td>
<td width="4%"></td>
<td width="78%">


<p>Many of these options also apply to
<b>charon&minus;cmd</b> and other <b>charon</b> derivatives.
Just use their respective name (e.g.
<i>charon&minus;cmd</i>) instead of <i>charon</i>.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>charon.block_threshold</b>
[5]</p>

<p style="margin-left:22%;">Maximum number of half-open
IKE_SAs for a single peer IP</p>

<p style="margin-left:11%;"><b>charon.cisco_unity</b>
[no]</p>

<p style="margin-left:22%;">Send Cisco Unity vendor ID
payload (IKEv1 only)</p>


<p style="margin-left:11%;"><b>charon.close_ike_on_child_failure</b>
[no]</p>

<p style="margin-left:22%;">Close the IKE_SA if setup of
the CHILD_SA along with IKE_AUTH failed</p>

<p style="margin-left:11%;"><b>charon.cookie_threshold</b>
[10]</p>

<p style="margin-left:22%;">Number of half-open IKE_SAs
that activate the cookie mechanism</p>

<p style="margin-left:11%;"><b>charon.dns1 <br>
charon.dns2</b></p>

<p style="margin-left:22%;">DNS servers assigned to peer
via configuration payload (CP)</p>

<p style="margin-left:11%;"><b>charon.dos_protection</b>
[yes]</p>

<p style="margin-left:22%;">Enable Denial of Service
protection using cookies and aggressiveness checks</p>

<p style="margin-left:11%;"><b>charon.filelog</b></p>

<p style="margin-left:22%;">Section to define file loggers,
see LOGGER CONFIGURATION</p>

<p style="margin-left:11%;"><b>charon.flush_auth_cfg</b>
[no]</p>

<p style="margin-left:22%;">If enabled objects used during
authentication (certificates, identities etc.) are released
to free memory once an IKE_SA is established. Enabling this
might conflict with plugins that later need access to e.g.
the used certificates.</p>

<p style="margin-left:11%;"><b>charon.fragment_size</b>
[512]</p>

<p style="margin-left:22%;">Maximum size (in bytes) of a
sent fragment when using the proprietary IKEv1 fragmentation
extension.</p>

<p style="margin-left:11%;"><b>charon.group</b></p>

<p style="margin-left:22%;">Name of the group the daemon
changes to after startup</p>


<p style="margin-left:11%;"><b>charon.half_open_timeout</b>
[30]</p>

<p style="margin-left:22%;">Timeout in seconds for
connecting IKE_SAs (also see IKE_SA_INIT DROPPING).</p>

<p style="margin-left:11%;"><b>charon.hash_and_url</b>
[no]</p>

<p style="margin-left:22%;">Enable hash and URL support</p>


<p style="margin-left:11%;"><b>charon.i_dont_care_about_security_and_use_aggressive_mode_psk</b>
[no]</p>

<p style="margin-left:22%;">If enabled responders are
allowed to use IKEv1 Aggressive Mode with pre-shared keys,
which is discouraged due to security concerns (offline
attacks on the openly transmitted hash of the PSK)</p>


<p style="margin-left:11%;"><b>charon.ignore_routing_tables</b></p>

<p style="margin-left:22%;">A space-separated list of
routing tables to be excluded from route lookups</p>

<p style="margin-left:11%;"><b>charon.ikesa_limit</b>
[0]</p>

<p style="margin-left:22%;">Maximum number of IKE_SAs that
can be established at the same time before new connection
attempts are blocked</p>


<p style="margin-left:11%;"><b>charon.ikesa_table_segments</b>
[1]</p>

<p style="margin-left:22%;">Number of exclusively locked
segments in the hash table</p>

<p style="margin-left:11%;"><b>charon.ikesa_table_size</b>
[1]</p>

<p style="margin-left:22%;">Size of the IKE_SA hash
table</p>


<p style="margin-left:11%;"><b>charon.inactivity_close_ike</b>
[no]</p>

<p style="margin-left:22%;">Whether to close IKE_SA if the
only CHILD_SA closed due to inactivity</p>


<p style="margin-left:11%;"><b>charon.init_limit_half_open</b>
[0]</p>

<p style="margin-left:22%;">Limit new connections based on
the current number of half open IKE_SAs (see IKE_SA_INIT
DROPPING).</p>


<p style="margin-left:11%;"><b>charon.init_limit_job_load</b>
[0]</p>

<p style="margin-left:22%;">Limit new connections based on
the number of jobs currently queued for processing (see
IKE_SA_INIT DROPPING).</p>

<p style="margin-left:11%;"><b>charon.initiator_only</b>
[no]</p>

<p style="margin-left:22%;">Causes charon daemon to ignore
IKE initiation requests.</p>

<p style="margin-left:11%;"><b>charon.install_routes</b>
[yes]</p>

<p style="margin-left:22%;">Install routes into a separate
routing table for established IPsec tunnels</p>


<p style="margin-left:11%;"><b>charon.install_virtual_ip</b>
[yes]</p>

<p style="margin-left:22%;">Install virtual IP
addresses</p>


<p style="margin-left:11%;"><b>charon.install_virtual_ip_on</b></p>

<p style="margin-left:22%;">The name of the interface on
which virtual IP addresses should be installed. If not
specified the addresses will be installed on the outbound
interface.</p>


<p style="margin-left:11%;"><b>charon.interfaces_ignore</b></p>

<p style="margin-left:22%;">A comma-separated list of
network interfaces that should be ignored, if
<b>charon.interfaces_use</b> is specified this option has no
effect.</p>


<p style="margin-left:11%;"><b>charon.interfaces_use</b></p>

<p style="margin-left:22%;">A comma-separated list of
network interfaces that should be used by charon. All other
interfaces are ignored.</p>

<p style="margin-left:11%;"><b>charon.keep_alive</b>
[20s]</p>

<p style="margin-left:22%;">NAT keep alive interval</p>

<p style="margin-left:11%;"><b>charon.load</b></p>

<p style="margin-left:22%;">Plugins to load in the IKEv2
daemon charon</p>

<p style="margin-left:11%;"><b>charon.max_packet</b>
[10000]</p>

<p style="margin-left:22%;">Maximum packet size accepted by
charon</p>


<p style="margin-left:11%;"><b>charon.multiple_authentication</b>
[yes]</p>

<p style="margin-left:22%;">Enable multiple authentication
exchanges (RFC 4739)</p>

<p style="margin-left:11%;"><b>charon.nbns1 <br>
charon.nbns2</b></p>

<p style="margin-left:22%;">WINS servers assigned to peer
via configuration payload (CP)</p>

<p style="margin-left:11%;"><b>charon.port</b> [500]</p>

<p style="margin-left:22%;">UDP port used locally. If set
to 0 a random port will be allocated.</p>

<p style="margin-left:11%;"><b>charon.port_nat_t</b>
[4500]</p>

<p style="margin-left:22%;">UDP port used locally in case
of NAT-T. If set to 0 a random port will be allocated. Has
to be different from <b>charon.port</b>, otherwise a random
port will be allocated.</p>

<p style="margin-left:11%;"><b>charon.process_route</b>
[yes]</p>

<p style="margin-left:22%;">Process RTM_NEWROUTE and
RTM_DELROUTE events</p>

<p style="margin-left:11%;"><b>charon.receive_delay</b>
[0]</p>

<p style="margin-left:22%;">Delay in ms for receiving
packets, to simulate larger RTT</p>


<p style="margin-left:11%;"><b>charon.receive_delay_response</b>
[yes]</p>

<p style="margin-left:22%;">Delay response messages</p>


<p style="margin-left:11%;"><b>charon.receive_delay_request</b>
[yes]</p>

<p style="margin-left:22%;">Delay request messages</p>


<p style="margin-left:11%;"><b>charon.receive_delay_type</b>
[0]</p>

<p style="margin-left:22%;">Specific IKEv2 message type to
delay, 0 for any</p>

<p style="margin-left:11%;"><b>charon.replay_window</b>
[32]</p>

<p style="margin-left:22%;">Size of the AH/ESP replay
window, in packets.</p>

<p style="margin-left:11%;"><b>charon.retransmit_base</b>
[1.8]</p>

<p style="margin-left:22%;">Base to use for calculating
exponential back off, see IKEv2 RETRANSMISSION</p>


<p style="margin-left:11%;"><b>charon.retransmit_timeout</b>
[4.0]</p>

<p style="margin-left:22%;">Timeout in seconds before
sending first retransmit</p>

<p style="margin-left:11%;"><b>charon.retransmit_tries</b>
[5]</p>

<p style="margin-left:22%;">Number of times to retransmit a
packet before giving up</p>


<p style="margin-left:11%;"><b>charon.retry_initiate_interval</b>
[0]</p>

<p style="margin-left:22%;">Interval to use when retrying
to initiate an IKE_SA (e.g. if DNS resolution failed), 0 to
disable retries.</p>

<p style="margin-left:11%;"><b>charon.reuse_ikesa</b>
[yes]</p>

<p style="margin-left:22%;">Initiate CHILD_SA within
existing IKE_SAs</p>


<p style="margin-left:11%;"><b>charon.routing_table</b></p>

<p style="margin-left:22%;">Numerical routing table to
install routes to</p>


<p style="margin-left:11%;"><b>charon.routing_table_prio</b></p>

<p style="margin-left:22%;">Priority of the routing
table</p>

<p style="margin-left:11%;"><b>charon.send_delay</b>
[0]</p>

<p style="margin-left:22%;">Delay in ms for sending
packets, to simulate larger RTT</p>


<p style="margin-left:11%;"><b>charon.send_delay_response</b>
[yes]</p>

<p style="margin-left:22%;">Delay response messages</p>


<p style="margin-left:11%;"><b>charon.send_delay_request</b>
[yes]</p>

<p style="margin-left:22%;">Delay request messages</p>

<p style="margin-left:11%;"><b>charon.send_delay_type</b>
[0]</p>

<p style="margin-left:22%;">Specific IKEv2 message type to
delay, 0 for any</p>

<p style="margin-left:11%;"><b>charon.send_vendor_id</b>
[no]</p>

<p style="margin-left:22%;">Send strongSwan vendor ID
payload</p>

<p style="margin-left:11%;"><b>charon.syslog</b></p>

<p style="margin-left:22%;">Section to define syslog
loggers, see LOGGER CONFIGURATION</p>

<p style="margin-left:11%;"><b>charon.threads</b> [16]</p>

<p style="margin-left:22%;">Number of worker threads in
charon. Several of these are reserved for long running tasks
in internal modules and plugins. Therefore, make sure you
don&rsquo;t set this value too low. The number of idle
worker threads listed in <i>ipsec statusall</i> might be
used as indicator on the number of reserved threads.</p>

<p style="margin-left:11%;"><b>charon.user</b></p>

<p style="margin-left:22%;">Name of the user the daemon
changes to after startup</p>


<p style="margin-left:11%; margin-top: 1em"><b>charon.plugins
subsection <br>
charon.plugins.android_log.loglevel</b> [1]</p>

<p style="margin-left:22%;">Loglevel for logging to Android
specific logger</p>

<p style="margin-left:11%;"><b>charon.plugins.attr</b></p>

<p style="margin-left:22%;">Section to specify arbitrary
attributes that are assigned to a peer via configuration
payload (CP)</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.cron</b></p>

<p style="margin-left:22%;">Cron style string specifying
CSV export times</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.empty_string</b></p>

<p style="margin-left:22%;">String to use in empty
intermediate CA fields</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.fixed_fields</b>
[yes]</p>

<p style="margin-left:22%;">Use a fixed intermediate CA
field count</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.force</b>
[yes]</p>

<p style="margin-left:22%;">Force export of all trustchains
we have a private key for</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.format</b>
[%d:%m:%Y]</p>

<p style="margin-left:22%;">strftime(3) format string to
export expiration dates as</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.local</b></p>

<p style="margin-left:22%;">strftime(3) format string for
the CSV file name to export local certificates to</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.remote</b></p>

<p style="margin-left:22%;">strftime(3) format string for
the CSV file name to export remote certificates to</p>


<p style="margin-left:11%;"><b>charon.plugins.certexpire.csv.separator</b>
[,]</p>

<p style="margin-left:22%;">CSV field separator</p>


<p style="margin-left:11%;"><b>charon.plugins.coupling.file</b></p>

<p style="margin-left:22%;">File to store coupling list
to</p>


<p style="margin-left:11%;"><b>charon.plugins.coupling.hash</b>
[sha1]</p>

<p style="margin-left:22%;">Hashing algorithm to
fingerprint coupled certificates</p>


<p style="margin-left:11%;"><b>charon.plugins.coupling.max</b>
[1]</p>

<p style="margin-left:22%;">Maximum number of coupling
entries to create</p>


<p style="margin-left:11%;"><b>charon.plugins.dhcp.force_server_address</b>
[no]</p>

<p style="margin-left:22%;">Always use the configured
server address. This might be helpful if the DHCP server
runs on the same host as strongSwan, and the DHCP daemon
does not listen on the loopback interface. In that case the
server cannot be reached via unicast (or even
255.255.255.255) as that would be routed via loopback.
Setting this option to yes and configuring the local
broadcast address (e.g. 192.168.0.255) as server address
might work.</p>


<p style="margin-left:11%;"><b>charon.plugins.dhcp.identity_lease</b>
[no]</p>

<p style="margin-left:22%;">Derive user-defined MAC address
from hash of IKEv2 identity</p>


<p style="margin-left:11%;"><b>charon.plugins.dhcp.server</b>
[255.255.255.255]</p>

<p style="margin-left:22%;">DHCP server unicast or
broadcast IP address</p>


<p style="margin-left:11%;"><b>charon.plugins.dnscert.enable</b>
[no]</p>

<p style="margin-left:22%;">Enable fetching of CERT RRs via
DNS</p>


<p style="margin-left:11%;"><b>charon.plugins.duplicheck.enable</b>
[yes]</p>

<p style="margin-left:22%;">Enable duplicheck plugin (if
loaded)</p>


<p style="margin-left:11%;"><b>charon.plugins.duplicheck.socket</b>
[unix:///var/run/charon.dck]</p>

<p style="margin-left:22%;">Socket provided by the
duplicheck plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-aka.request_identity</b>
[yes] <b><br>
charon.plugins.eap-aka-3ggp2.seq_check <br>
charon.plugins.eap-dynamic.preferred</b></p>

<p style="margin-left:22%;">The preferred EAP method(s) to
be used. If it is not given the first registered method will
be used initially. If a comma separated list is given the
methods are tried in the given order before trying the rest
of the registered methods.</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-dynamic.prefer_user</b>
[no]</p>

<p style="margin-left:22%;">If enabled the EAP methods
proposed in an EAP-Nak message sent by the peer are
preferred over the methods registered locally.</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-gtc.backend</b>
[pam]</p>

<p style="margin-left:22%;">XAuth backend to be used for
credential verification</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-peap.fragment_size</b>
[1024]</p>

<p style="margin-left:22%;">Maximum size of an EAP-PEAP
packet</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-peap.max_message_count</b>
[32]</p>

<p style="margin-left:22%;">Maximum number of processed
EAP-PEAP packets (0 = no limit)</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-peap.include_length</b>
[no]</p>

<p style="margin-left:22%;">Include length in
non-fragmented EAP-PEAP packets</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-peap.phase2_method</b>
[mschapv2]</p>

<p style="margin-left:22%;">Phase2 EAP client
authentication method</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-peap.phase2_piggyback</b>
[no]</p>

<p style="margin-left:22%;">Phase2 EAP Identity request
piggybacked by server onto TLS Finished message</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-peap.phase2_tnc</b>
[no]</p>

<p style="margin-left:22%;">Start phase2 EAP TNC protocol
after successful client authentication</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-peap.request_peer_auth</b>
[no]</p>

<p style="margin-left:22%;">Request peer authentication
based on a client certificate</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.accounting</b>
[no]</p>

<p style="margin-left:22%;">Send RADIUS accounting
information to RADIUS servers.</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.accounting_requires_vip</b>
[no]</p>

<p style="margin-left:22%;">If enabled, accounting is
disabled unless an IKE_SA has at least one virtual IP</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.class_group</b>
[no]</p>

<p style="margin-left:22%;">Use the <i>class</i> attribute
sent in the RADIUS-Accept message as group membership
information that is compared to the groups specified in the
<b>rightgroups</b> option in <b>ipsec.conf (5).</b></p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.close_all_on_timeout</b>
[no]</p>

<p style="margin-left:22%;">Closes all IKE_SAs if
communication with the RADIUS server times out. If it is not
set only the current IKE_SA is closed.</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.dae.enable</b>
[no]</p>

<p style="margin-left:22%;">Enables support for the Dynamic
Authorization Extension (RFC 5176)</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.dae.listen</b>
[0.0.0.0]</p>

<p style="margin-left:22%;">Address to listen for DAE
messages from the RADIUS server</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.dae.port</b>
[3799]</p>

<p style="margin-left:22%;">Port to listen for DAE
requests</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.dae.secret</b></p>

<p style="margin-left:22%;">Shared secret used to
verify/sign DAE messages</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.eap_start</b>
[no]</p>

<p style="margin-left:22%;">Send EAP-Start instead of
EAP-Identity to start RADIUS conversation</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.filter_id</b>
[no]</p>

<p style="margin-left:22%;">If the RADIUS
<i>tunnel_type</i> attribute with value <b>ESP</b> is
received, use the <i>filter_id</i> attribute sent in the
RADIUS-Accept message as group membership information that
is compared to the groups specified in the
<b>rightgroups</b> option in <b>ipsec.conf (5).</b></p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.forward.ike_to_radius</b></p>

<p style="margin-left:22%;">RADIUS attributes to be
forwarded from IKEv2 to RADIUS (can be defined by name or
attribute number, a colon can be used to specify
vendor-specific attributes, e.g. Reply-Message, or 11, or
36906:12).</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.forward.radius_to_ike</b></p>

<p style="margin-left:22%;">Same as
<b>charon.plugins.eap-radius.forward.ike_to_radius</b> but
from RADIUS to IKEv2, a strongSwan specific private notify
(40969) is used to transmit the attributes.</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.id_prefix</b></p>

<p style="margin-left:22%;">Prefix to EAP-Identity, some
AAA servers use a IMSI prefix to select the EAP method</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.nas_identifier</b>
[strongSwan]</p>

<p style="margin-left:22%;">NAS-Identifier to include in
RADIUS messages</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.port</b>
[1812]</p>

<p style="margin-left:22%;">Port of RADIUS server
(authentication)</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.secret</b></p>

<p style="margin-left:22%;">Shared secret between RADIUS
and NAS</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.server</b></p>

<p style="margin-left:22%;">IP/Hostname of RADIUS
server</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.servers</b></p>

<p style="margin-left:22%;">Section to specify multiple
RADIUS servers. The <b>nas_identifier</b>, <b>secret</b>,
<b>sockets</b> and <b>port</b> (or <b>auth_port</b>) options
can be specified for each server. A server&rsquo;s
IP/Hostname can be configured using the <b>address</b>
option. The <b>acct_port</b> [1813] option can be used to
specify the port used for RADIUS accounting. For each RADIUS
server a priority can be specified using the
<b>preference</b> [0] option.</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.sockets</b>
[1]</p>

<p style="margin-left:22%;">Number of sockets (ports) to
use, increase for high load</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-radius.xauth</b></p>

<p style="margin-left:22%;">Section to configure multiple
XAuth authentication rounds via RADIUS. The subsections
define so called authentication profiles with arbitrary
names. In each profile section one or more XAuth types can
be configured, with an assigned message. For each type a
separate XAuth exchange will be initiated and all replies
get concatenated into the User-Password attribute, which
then gets verified over RADIUS.</p>

<p style="margin-left:22%; margin-top: 1em">Available XAuth
types are <b>password</b>, <b>passcode</b>, <b>nextpin</b>,
and <b>answer</b>. This type is not relevant to strongSwan
or the AAA server, but the client may show a different
dialog (along with the configured message).</p>

<p style="margin-left:22%; margin-top: 1em">To use the
configured profiles, they have to be configured in the
respective connection in <i>ipsec.conf</i>(5) by appending
the profile name, separated by a colon, to the
<b>xauth-radius</b> XAauth backend configuration in
<i>rightauth</i> or <i>rightauth2</i>, for instance,
<i>rightauth2=xauth-radius:profile</i>.</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-sim.request_identity</b>
[yes] <b><br>
charon.plugins.eap-simaka-sql.database <br>
charon.plugins.eap-simaka-sql.remove_used</b> [no] <b><br>
charon.plugins.eap-tls.fragment_size</b> [1024]</p>

<p style="margin-left:22%;">Maximum size of an EAP-TLS
packet</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-tls.max_message_count</b>
[32]</p>

<p style="margin-left:22%;">Maximum number of processed
EAP-TLS packets (0 = no limit)</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-tls.include_length</b>
[yes]</p>

<p style="margin-left:22%;">Include length in
non-fragmented EAP-TLS packets</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-tnc.max_message_count</b>
[10]</p>

<p style="margin-left:22%;">Maximum number of processed
EAP-TNC packets (0 = no limit)</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-tnc.protocol</b>
[tnccs-1.1]</p>

<p style="margin-left:22%;">IF-TNCCS protocol version to be
used (tnccs-1.1, tnccs-2.0, tnccs-dynamic)</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-ttls.fragment_size</b>
[1024]</p>

<p style="margin-left:22%;">Maximum size of an EAP-TTLS
packet</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-ttls.max_message_count</b>
[32]</p>

<p style="margin-left:22%;">Maximum number of processed
EAP-TTLS packets (0 = no limit)</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-ttls.include_length</b>
[yes]</p>

<p style="margin-left:22%;">Include length in
non-fragmented EAP-TTLS packets</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-ttls.phase2_method</b>
[md5]</p>

<p style="margin-left:22%;">Phase2 EAP client
authentication method</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-ttls.phase2_piggyback</b>
[no]</p>

<p style="margin-left:22%;">Phase2 EAP Identity request
piggybacked by server onto TLS Finished message</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-ttls.phase2_tnc</b>
[no]</p>

<p style="margin-left:22%;">Start phase2 EAP TNC protocol
after successful client authentication</p>


<p style="margin-left:11%;"><b>charon.plugins.eap-ttls.request_peer_auth</b>
[no]</p>

<p style="margin-left:22%;">Request peer authentication
based on a client certificate</p>


<p style="margin-left:11%;"><b>charon.plugins.error-notify.socket</b>
[unix:///var/run/charon.enfy]</p>

<p style="margin-left:22%;">Socket provided by the
error-notify plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.ha.autobalance</b>
[0]</p>

<p style="margin-left:22%;">Interval in seconds to
automatically balance handled segments between nodes. Set to
0 to disable.</p>


<p style="margin-left:11%;"><b>charon.plugins.ha.fifo_interface</b>
[yes] <b><br>
charon.plugins.ha.heartbeat_delay</b> [1000] <b><br>
charon.plugins.ha.heartbeat_timeout</b> [2100] <b><br>
charon.plugins.ha.local <br>
charon.plugins.ha.monitor</b> [yes] <b><br>
charon.plugins.ha.pools <br>
charon.plugins.ha.remote <br>
charon.plugins.ha.resync</b> [yes] <b><br>
charon.plugins.ha.secret <br>
charon.plugins.ha.segment_count</b> [1] <b><br>
charon.plugins.ipseckey.enable</b> [no]</p>

<p style="margin-left:22%;">Enable fetching of IPSECKEY RRs
via DNS</p>


<p style="margin-left:11%;"><b>charon.plugins.led.activity_led
<br>
charon.plugins.led.blink_time</b> [50] <b><br>
charon.plugins.kernel-klips.ipsec_dev_count</b> [4]</p>

<p style="margin-left:22%;">Number of ipsecN devices</p>


<p style="margin-left:11%;"><b>charon.plugins.kernel-klips.ipsec_dev_mtu</b>
[0]</p>

<p style="margin-left:22%;">Set MTU of ipsecN device</p>


<p style="margin-left:11%;"><b>charon.plugins.kernel-libipsec.allow_peer_ts</b>
[no]</p>

<p style="margin-left:22%;">Allow that the remote traffic
selector equals the IKE peer. The route installed for such
traffic (via TUN device) usually prevents further IKE
traffic. The fwmark options for the <i>kernel-netlink</i>
and <i>socket-default</i> plugins can be used to circumvent
that problem.</p>


<p style="margin-left:11%;"><b>charon.plugins.kernel-netlink.fwmark</b></p>

<p style="margin-left:22%;">Firewall mark to set on the
routing rule that directs traffic to our own routing table.
The format is [!]mark[/mask], where the optional exclamation
mark inverts the meaning (i.e. the rule only applies to
packets that don&rsquo;t match the mark).</p>


<p style="margin-left:11%;"><b>charon.plugins.kernel-netlink.roam_events</b>
[yes]</p>

<p style="margin-left:22%;">Whether to trigger roam events
when interfaces, addresses or routes change</p>


<p style="margin-left:11%;"><b>charon.plugins.kernel-netlink.xfrm_acq_expires</b>
[165]</p>

<p style="margin-left:22%;">Lifetime of XFRM acquire state
in kernel. The value gets written to
/proc/sys/net/core/xfrm_acq_expires. Indirectly controls the
delay of XFRM acquire messages sent.</p>


<p style="margin-left:11%;"><b>charon.plugins.kernel-pfroute.vip_wait</b>
[1000]</p>

<p style="margin-left:22%;">Time in ms to wait until
virtual IP addresses appear/disappear before failing.</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester</b></p>

<p style="margin-left:22%;">Section to configure the
load-tester plugin, see LOAD TESTS</p>


<p style="margin-left:11%;"><b>charon.plugins.lookip.socket</b>
[unix:///var/run/charon.lkp]</p>

<p style="margin-left:22%;">Socket provided by the lookip
plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.radattr.dir</b></p>

<p style="margin-left:22%;">Directory where RADIUS
attributes are stored in client-ID specific files.</p>


<p style="margin-left:11%;"><b>charon.plugins.radattr.message_id</b>
[-1]</p>

<p style="margin-left:22%;">Attributes are added to all
IKE_AUTH messages by default (-1), or only to the IKE_AUTH
message with the given IKEv2 message ID.</p>


<p style="margin-left:11%;"><b>charon.plugins.resolve.file</b>
[/etc/resolv.conf]</p>

<p style="margin-left:22%;">File where to add DNS server
entries</p>


<p style="margin-left:11%;"><b>charon.plugins.resolve.resolvconf.iface_prefix</b>
[lo.inet.ipsec.]</p>

<p style="margin-left:22%;">Prefix used for interface names
sent to resolvconf(8). The nameserver address is appended to
this prefix to make it unique. The result has to be a valid
interface name according to the rules defined by resolvconf.
Also, it should have a high priority according to the order
defined in interface-order(5).</p>


<p style="margin-left:11%;"><b>charon.plugins.socket-default.fwmark</b></p>

<p style="margin-left:22%;">Firewall mark to set on
outbound packets.</p>


<p style="margin-left:11%;"><b>charon.plugins.socket-default.set_source</b>
[yes]</p>

<p style="margin-left:22%;">Set source address on outbound
packets, if possible.</p>


<p style="margin-left:11%;"><b>charon.plugins.socket-default.use_ipv4</b>
[yes]</p>

<p style="margin-left:22%;">Listen on IPv4, if
possible.</p>


<p style="margin-left:11%;"><b>charon.plugins.socket-default.use_ipv6</b>
[yes]</p>

<p style="margin-left:22%;">Listen on IPv6, if
possible.</p>


<p style="margin-left:11%;"><b>charon.plugins.sql.database</b></p>

<p style="margin-left:22%;">Database URI for charons SQL
plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.sql.loglevel</b>
[-1]</p>

<p style="margin-left:22%;">Loglevel for logging to SQL
database</p>


<p style="margin-left:11%;"><b>charon.plugins.stroke.ignore_missing_ca_basic_constraint</b>
[no]</p>

<p style="margin-left:22%;">Treat certificates in
ipsec.d/cacerts and ipsec.conf ca sections as CA
certificates even if they don&rsquo;t contain a CA basic
constraint.</p>


<p style="margin-left:11%;"><b>charon.plugins.stroke.max_concurrent</b>
[4]</p>

<p style="margin-left:22%;">Maximum number of stroke
messages handled concurrently</p>


<p style="margin-left:11%;"><b>charon.plugins.stroke.socket</b>
[unix:///var/run/charon.ctl]</p>

<p style="margin-left:22%;">Socket provided by the stroke
plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.stroke.timeout</b>
[0]</p>

<p style="margin-left:22%;">Timeout in ms for any stroke
command. Use 0 to disable the timeout</p>


<p style="margin-left:11%;"><b>charon.plugins.systime-fix.interval</b>
[0]</p>

<p style="margin-left:22%;">Interval in seconds to check
system time for validity. 0 disables the check</p>


<p style="margin-left:11%;"><b>charon.plugins.systime-fix.reauth</b>
[no]</p>

<p style="margin-left:22%;">Whether to use reauth or delete
if an invalid cert lifetime is detected</p>


<p style="margin-left:11%;"><b>charon.plugins.systime-fix.threshold</b></p>

<p style="margin-left:22%;">Threshold date where system
time is considered valid. Disabled if not specified</p>


<p style="margin-left:11%;"><b>charon.plugins.systime-fix.threshold_format</b>
[%Y]</p>

<p style="margin-left:22%;">strptime(3) format used to
parse threshold option</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-ifmap.client_cert</b></p>

<p style="margin-left:22%;">Path to X.509 certificate file
of IF-MAP client</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-ifmap.client_key</b></p>

<p style="margin-left:22%;">Path to private key file of
IF-MAP client</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-ifmap.device_name</b></p>

<p style="margin-left:22%;">Unique name of strongSwan
server as a PEP and/or PDP device</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-ifmap.renew_session_interval</b>
[150]</p>

<p style="margin-left:22%;">Interval in seconds between
periodic IF-MAP RenewSession requests</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-ifmap.server_uri</b>
[https://localhost:8444/imap]</p>

<p style="margin-left:22%;">URI of the form
[https://]servername[:port][/path]</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-ifmap.server_cert</b></p>

<p style="margin-left:22%;">Path to X.509 certificate file
of IF-MAP server</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-ifmap.username_password</b></p>

<p style="margin-left:22%;">Credentials of IF-MAP client of
the form username:password</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.pt_tls.enable</b>
[yes]</p>

<p style="margin-left:22%;">Enable PT-TLS protocol on the
strongSwan PDP</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.pt_tls.port</b>
[271]</p>

<p style="margin-left:22%;">PT-TLS server port the
strongSwan PDP is listening on</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.radius.enable</b>
[yes]</p>

<p style="margin-left:22%;">Enable RADIUS protocol on the
strongSwan PDP</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.radius.method</b>
[ttls]</p>

<p style="margin-left:22%;">EAP tunnel method to be
used</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.radius.port</b>
[1812]</p>

<p style="margin-left:22%;">RADIUS server port the
strongSwan PDP is listening on</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.radius.secret</b></p>

<p style="margin-left:22%;">Shared RADIUS secret between
strongSwan PDP and NAS</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.server</b></p>

<p style="margin-left:22%;">Name of the strongSwan PDP as
contained in the AAA certificate</p>


<p style="margin-left:11%;"><b>charon.plugins.tnc-pdp.timeout</b></p>

<p style="margin-left:22%;">Timeout in seconds before
closing incomplete connections</p>


<p style="margin-left:11%;"><b>charon.plugins.updown.dns_handler</b>
[no]</p>

<p style="margin-left:22%;">Whether the updown script
should handle DNS serves assigned via IKEv1 Mode Config or
IKEv2 Config Payloads (if enabled they can&rsquo;t be
handled by other plugins, like resolve)</p>


<p style="margin-left:11%;"><b>charon.plugins.whitelist.enable</b>
[yes]</p>

<p style="margin-left:22%;">Enable loaded whitelist
plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.whitelist.socket</b>
[unix:///var/run/charon.wlst]</p>

<p style="margin-left:22%;">Socket provided by the
whitelist plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.xauth-eap.backend</b>
[radius]</p>

<p style="margin-left:22%;">EAP plugin to be used as
backend for XAuth credential verification</p>


<p style="margin-left:11%;"><b>charon.plugins.xauth-pam.pam_service</b>
[login]</p>

<p style="margin-left:22%;">PAM service to be used for
authentication</p>


<p style="margin-left:11%;"><b>charon.plugins.xauth-pam.trim_email</b>
[yes]</p>

<p style="margin-left:22%;">If an email address is given as
an XAuth username, trim it to just the username part.</p>


<p style="margin-left:11%; margin-top: 1em"><b>libstrongswan
section <br>
libstrongswan.cert_cache</b> [yes]</p>

<p style="margin-left:22%;">Whether relations in validated
certificate chains should be cached in memory</p>


<p style="margin-left:11%;"><b>libstrongswan.crypto_test.bench</b>
[no] <b><br>
libstrongswan.crypto_test.bench_size</b> [1024] <b><br>
libstrongswan.crypto_test.bench_time</b> [50] <b><br>
libstrongswan.crypto_test.on_add</b> [no]</p>

<p style="margin-left:22%;">Test crypto algorithms during
registration</p>


<p style="margin-left:11%;"><b>libstrongswan.crypto_test.on_create</b>
[no]</p>

<p style="margin-left:22%;">Test crypto algorithms on each
crypto primitive instantiation</p>


<p style="margin-left:11%;"><b>libstrongswan.crypto_test.required</b>
[no]</p>

<p style="margin-left:22%;">Strictly require at least one
test vector to enable an algorithm</p>


<p style="margin-left:11%;"><b>libstrongswan.crypto_test.rng_true</b>
[no]</p>

<p style="margin-left:22%;">Whether to test RNG with TRUE
quality; requires a lot of entropy</p>


<p style="margin-left:11%;"><b>libstrongswan.dh_exponent_ansi_x9_42</b>
[yes]</p>

<p style="margin-left:22%;">Use ANSI X9.42 DH exponent size
or optimum size matched to cryptographical strength</p>


<p style="margin-left:11%;"><b>libstrongswan.ecp_x_coordinate_only</b>
[yes]</p>

<p style="margin-left:22%;">Compliance with the errata for
RFC 4753</p>


<p style="margin-left:11%;"><b>libstrongswan.host_resolver.max_threads</b>
[3]</p>

<p style="margin-left:22%;">Maximum number of concurrent
resolver threads (they are terminated if unused)</p>


<p style="margin-left:11%;"><b>libstrongswan.host_resolver.min_threads</b>
[0]</p>

<p style="margin-left:22%;">Minimum number of resolver
threads to keep around</p>


<p style="margin-left:11%;"><b>libstrongswan.integrity_test</b>
[no]</p>

<p style="margin-left:22%;">Check daemon, libstrongswan and
plugin integrity at startup</p>


<p style="margin-left:11%;"><b>libstrongswan.leak_detective.detailed</b>
[yes]</p>

<p style="margin-left:22%;">Includes source file names and
line numbers in leak detective output</p>


<p style="margin-left:11%;"><b>libstrongswan.leak_detective.usage_threshold</b>
[10240]</p>

<p style="margin-left:22%;">Threshold in bytes for leaks to
be reported (0 to report all)</p>


<p style="margin-left:11%;"><b>libstrongswan.leak_detective.usage_threshold_count</b>
[0]</p>

<p style="margin-left:22%;">Threshold in number of
allocations for leaks to be reported (0 to report all)</p>


<p style="margin-left:11%;"><b>libstrongswan.processor.priority_threads</b></p>

<p style="margin-left:22%;">Subsection to configure the
number of reserved threads per priority class see JOB
PRIORITY MANAGEMENT</p>


<p style="margin-left:11%;"><b>libstrongswan.x509.enforce_critical</b>
[yes]</p>

<p style="margin-left:22%;">Discard certificates with
unsupported or unknown critical extensions</p>


<p style="margin-left:11%; margin-top: 1em"><b>libstrongswan.plugins
subsection <br>
libstrongswan.plugins.attr-sql.database</b></p>

<p style="margin-left:22%;">Database URI for attr-sql
plugin used by charon</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.attr-sql.lease_history</b>
[yes]</p>

<p style="margin-left:22%;">Enable logging of SQL IP pool
leases</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.gcrypt.quick_random</b>
[no]</p>

<p style="margin-left:22%;">Use faster random numbers in
gcrypt; for testing only, produces weak keys!</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.openssl.engine_id</b>
[pkcs11]</p>

<p style="margin-left:22%;">ENGINE ID to use in the OpenSSL
plugin</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.openssl.fips_mode</b>
[0]</p>

<p style="margin-left:22%;">Set OpenSSL FIPS mode:
disabled(0), enabled(1), Suite B enabled(2)</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.modules</b></p>

<p style="margin-left:22%;">List of available PKCS#11
modules</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.load_certs</b>
[yes]</p>

<p style="margin-left:22%;">Whether to load certificates
from tokens</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.reload_certs</b>
[no]</p>

<p style="margin-left:22%;">Reload certificates from all
tokens if charon receives a SIGHUP</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.use_dh</b>
[no]</p>

<p style="margin-left:22%;">Whether the PKCS#11 modules
should be used for DH and ECDH (see use_ecc option)</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.use_ecc</b>
[no]</p>

<p style="margin-left:22%;">Whether the PKCS#11 modules
should be used for ECDH and ECDSA public key operations.
ECDSA private keys can be used regardless of this option</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.use_hasher</b>
[no]</p>

<p style="margin-left:22%;">Whether the PKCS#11 modules
should be used to hash data</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.use_pubkey</b>
[no]</p>

<p style="margin-left:22%;">Whether the PKCS#11 modules
should be used for public key operations, even for keys not
stored on tokens</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.pkcs11.use_rng</b>
[no]</p>

<p style="margin-left:22%;">Whether the PKCS#11 modules
should be used as RNG</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.random.random</b>
[/dev/random]</p>

<p style="margin-left:22%;">File to read random bytes from,
instead of /dev/random</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.random.urandom</b>
[/dev/urandom]</p>

<p style="margin-left:22%;">File to read pseudo random
bytes from, instead of /dev/urandom</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.unbound.resolv_conf</b>
[/etc/resolv.conf]</p>

<p style="margin-left:22%;">File to read DNS resolver
configuration from</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.unbound.trust_anchors</b>
[/etc/ipsec.d/dnssec.keys]</p>

<p style="margin-left:22%;">File to read DNSSEC trust
anchors from (usually root zone KSK). The format of the file
is the standard DNS Zone file format, anchors can be stored
as DS or DNSKEY entries in the file.</p>


<p style="margin-left:11%;"><b>libstrongswan.plugins.unbound.dlv_anchors</b></p>

<p style="margin-left:22%;">File to read trusted keys for
DLV (DNSSEC Lookaside Validation) from. It uses the same
format as <i>trust_anchors</i>. Only one DLV can be
configured, which is then used as a root trusted DLV, this
means that it is a lookaside for the root.</p>

<p style="margin-left:11%; margin-top: 1em"><b>libtls
section <br>
libtls.cipher</b></p>

<p style="margin-left:22%;">List of TLS encryption
ciphers</p>

<p style="margin-left:11%;"><b>libtls.key_exchange</b></p>

<p style="margin-left:22%;">List of TLS key exchange
methods</p>

<p style="margin-left:11%;"><b>libtls.mac</b></p>

<p style="margin-left:22%;">List of TLS MAC algorithms</p>

<p style="margin-left:11%;"><b>libtls.suites</b></p>

<p style="margin-left:22%;">List of TLS cipher suites</p>

<p style="margin-left:11%; margin-top: 1em"><b>libtnccs
section <br>
libtnccs.tnc_config</b> [/etc/tnc_config]</p>

<p style="margin-left:22%;">TNC IMC/IMV configuration
directory</p>

<p style="margin-left:11%; margin-top: 1em"><b>libtnccs
plugins section <br>
libtnccs.plugins.tnccs-11.max_message_size</b> [45000]</p>

<p style="margin-left:22%;">Maximum size of a PA-TNC
message (XML &amp; Base64 encoding)</p>


<p style="margin-left:11%;"><b>libtnccs.plugins.tnccs-20.max_batch_size</b>
[65522]</p>

<p style="margin-left:22%;">Maximum size of a PB-TNC batch
(upper limit via PT-EAP = 65529)</p>


<p style="margin-left:11%;"><b>libtnccs.plugins.tnccs-20.max_message_size</b>
[65490]</p>

<p style="margin-left:22%;">Maximum size of a PA-TNC
message (upper limit via PT-EAP = 65497)</p>


<p style="margin-left:11%;"><b>libtnccs.plugins.tnc-imc.dlclose</b>
[yes]</p>

<p style="margin-left:22%;">Unload IMC after use</p>


<p style="margin-left:11%;"><b>libtnccs.plugins.tnc-imc.preferred_language</b>
[en]</p>

<p style="margin-left:22%;">Preferred language for TNC
recommendations</p>


<p style="margin-left:11%;"><b>libtnccs.plugins.tnc-imv.dlclose</b>
[yes]</p>

<p style="margin-left:22%;">Unload IMV after use</p>

<p style="margin-left:11%; margin-top: 1em"><b>libimcv
section <br>
libimcv.assessment_result</b> [yes]</p>

<p style="margin-left:22%;">Whether IMVs send a standard
IETF Assessment Result attribute</p>

<p style="margin-left:11%;"><b>libimcv.database</b></p>

<p style="margin-left:22%;">Global IMV policy database
URI</p>

<p style="margin-left:11%;"><b>libimcv.debug_level</b>
[1]</p>

<p style="margin-left:22%;">Debug level for a stand-alone
libimcv library</p>

<p style="margin-left:11%;"><b>libimcv.load</b> [random
nonce gmp pubkey x509]</p>

<p style="margin-left:22%;">Plugins to load in IMC/IMVs</p>


<p style="margin-left:11%;"><b>libimcv.os_info.name</b></p>

<p style="margin-left:22%;">Manually set the name of the
client OS (e.g. Ubuntu)</p>


<p style="margin-left:11%;"><b>libimcv.os_info.version</b></p>

<p style="margin-left:22%;">Manually set the version of the
client OS (e.g. 12.04 i686)</p>

<p style="margin-left:11%;"><b>libimcv.policy_script</b>
[ipsec _imv_policy]</p>

<p style="margin-left:22%;">Script called for each TNC
connection to generate IMV policies</p>

<p style="margin-left:11%;"><b>libimcv.stderr_quiet</b>
[no]</p>

<p style="margin-left:22%;">isable output to stderr with a
stand-alone libimcv library</p>

<p style="margin-left:11%; margin-top: 1em"><b>libimcv
plugins section <br>
libimcv.plugins.imc-attestation.aik_blob</b></p>

<p style="margin-left:22%;">AIK encrypted private key blob
file</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-attestation.aik_cert</b></p>

<p style="margin-left:22%;">AIK certificate file</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-attestation.aik_key</b></p>

<p style="margin-left:22%;">AIK public key file</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-attestation.nonce_len</b>
[20]</p>

<p style="margin-left:22%;">DH nonce length</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-attestation.use_quote2</b>
[yes]</p>

<p style="margin-left:22%;">Use Quote2 AIK signature
instead of Quote signature</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-attestation.cadir</b></p>

<p style="margin-left:22%;">Path to directory with AIK
cacerts</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-attestation.dh_group</b>
[ecp256]</p>

<p style="margin-left:22%;">Preferred Diffie-Hellman
group</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-attestation.hash_algorithm</b>
[sha256]</p>

<p style="margin-left:22%;">Preferred measurement hash
algorithm</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-attestation.min_nonce_len</b>
[0]</p>

<p style="margin-left:22%;">DH minimum nonce length</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-attestation.remediation_uri</b></p>

<p style="margin-left:22%;">URI pointing to attestation
remediation instructions</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-os.push_info</b>
[yes]</p>

<p style="margin-left:22%;">Send operating system info
without being prompted</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-os.remediation_uri</b></p>

<p style="margin-left:22%;">URI pointing to operating
system remediation instructions</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-scanner.push_info</b>
[yes]</p>

<p style="margin-left:22%;">Send open listening ports
without being prompted</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-scanner.remediation_uri</b></p>

<p style="margin-left:22%;">URI pointing to scanner
remediation instructions</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-swid.swid_directory</b>
[/usr/share]</p>

<p style="margin-left:22%;">Directory where SWID tags are
located</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-test.additional_ids</b>
[0]</p>

<p style="margin-left:22%;">Number of additional IMC
IDs</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-test.command</b>
[none]</p>

<p style="margin-left:22%;">Command to be sent to the Test
IMV</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-test.dummy_size</b>
[0]</p>

<p style="margin-left:22%;">Size of dummy attribute to be
sent to the Test IMV (0 = disabled)</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-test.remediation_uri</b></p>

<p style="margin-left:22%;">URI pointing to test
remediation instructions</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-test.retry</b>
[no]</p>

<p style="margin-left:22%;">Do a handshake retry</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imc-test.retry_command</b></p>

<p style="margin-left:22%;">Command to be sent to the Test
IMV in the handshake retry</p>


<p style="margin-left:11%;"><b>libimcv.plugins.imv-test.rounds</b>
[0]</p>

<p style="margin-left:22%;">Number of IMC-IMV retry
rounds</p>

<p style="margin-left:11%; margin-top: 1em"><b>manager
section <br>
manager.database</b></p>

<p style="margin-left:22%;">Credential database URI for
manager</p>

<p style="margin-left:11%;"><b>manager.debug</b> [no]</p>

<p style="margin-left:22%;">Enable debugging in manager</p>

<p style="margin-left:11%;"><b>manager.load</b></p>

<p style="margin-left:22%;">Plugins to load in manager</p>

<p style="margin-left:11%;"><b>manager.socket</b></p>

<p style="margin-left:22%;">FastCGI socket of manager, to
run it statically</p>

<p style="margin-left:11%;"><b>manager.threads</b> [10]</p>

<p style="margin-left:22%;">Threads to use for request
handling</p>

<p style="margin-left:11%;"><b>manager.timeout</b>
[15m]</p>

<p style="margin-left:22%;">Session timeout for manager</p>

<p style="margin-left:11%; margin-top: 1em"><b>mediation
client section <br>
medcli.database</b></p>

<p style="margin-left:22%;">Mediation client database
URI</p>

<p style="margin-left:11%;"><b>medcli.dpd</b> [5m]</p>

<p style="margin-left:22%;">DPD timeout to use in mediation
client plugin</p>

<p style="margin-left:11%;"><b>medcli.rekey</b> [20m]</p>

<p style="margin-left:22%;">Rekeying time on mediation
connections in mediation client plugin</p>

<p style="margin-left:11%; margin-top: 1em"><b>mediation
server section <br>
medsrv.database</b></p>

<p style="margin-left:22%;">Mediation server database
URI</p>

<p style="margin-left:11%;"><b>medsrv.debug</b> [no]</p>

<p style="margin-left:22%;">Debugging in mediation server
web application</p>

<p style="margin-left:11%;"><b>medsrv.dpd</b> [5m]</p>

<p style="margin-left:22%;">DPD timeout to use in mediation
server plugin</p>

<p style="margin-left:11%;"><b>medsrv.load</b></p>

<p style="margin-left:22%;">Plugins to load in mediation
server plugin</p>

<p style="margin-left:11%;"><b>medsrv.password_length</b>
[6]</p>

<p style="margin-left:22%;">Minimum password length
required for mediation server user accounts</p>

<p style="margin-left:11%;"><b>medsrv.rekey</b> [20m]</p>

<p style="margin-left:22%;">Rekeying time on mediation
connections in mediation server plugin</p>

<p style="margin-left:11%;"><b>medsrv.socket</b></p>

<p style="margin-left:22%;">Run Mediation server web
application statically on socket</p>

<p style="margin-left:11%;"><b>medsrv.threads</b> [5]</p>

<p style="margin-left:22%;">Number of thread for mediation
service web application</p>

<p style="margin-left:11%;"><b>medsrv.timeout</b> [15m]</p>

<p style="margin-left:22%;">Session timeout for mediation
service</p>

<p style="margin-left:11%; margin-top: 1em"><b>openac
section <br>
openac.load</b></p>

<p style="margin-left:22%;">Plugins to load in ipsec openac
tool</p>

<p style="margin-left:11%; margin-top: 1em"><b>pacman
section <br>
pacman.database</b></p>

<p style="margin-left:22%;">Database URI for the database
that stores the package information</p>

<p style="margin-left:11%; margin-top: 1em"><b>pki section
<br>
pki.load</b></p>

<p style="margin-left:22%;">Plugins to load in ipsec pki
tool</p>

<p style="margin-left:11%; margin-top: 1em"><b>pool section
<br>
pool.load</b></p>

<p style="margin-left:22%;">Plugins to load in ipsec pool
tool</p>


<p style="margin-left:11%; margin-top: 1em"><b>pt-tls-client
section <br>
pt-tls-client.load</b></p>

<p style="margin-left:22%;">Plugins to load in ipsec
pt-tls-client tool</p>

<p style="margin-left:11%; margin-top: 1em"><b>scepclient
section <br>
scepclient.load</b></p>

<p style="margin-left:22%;">Plugins to load in ipsec
scepclient tool</p>

<p style="margin-left:11%; margin-top: 1em"><b>starter
section <br>
starter.load</b></p>

<p style="margin-left:22%;">Plugins to load in starter</p>

<p style="margin-left:11%;"><b>starter.load_warning</b>
[yes]</p>

<p style="margin-left:22%;">Disable charon plugin load
option warning</p>

<h2>LOGGER CONFIGURATION
<a name="LOGGER CONFIGURATION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The options
described below provide a much more flexible way to
configure loggers for the IKEv2 daemon charon than using the
<b>charondebug</b> option in <b>ipsec.conf</b>(5).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Please
note</b> that if any loggers are specified in
strongswan.conf, <b>charondebug</b> does not have any
effect.</p>

<p style="margin-left:11%; margin-top: 1em">There are
currently two types of loggers defined: <b><br>
File loggers</b></p>

<p style="margin-left:22%;">Log directly to a file and are
defined by specifying the full path to the file as
subsection in the <b>charon.filelog</b> section. To log to
the console the two special filenames <b>stdout</b> and
<b>stderr</b> can be used.</p>

<p style="margin-left:11%;"><b>Syslog loggers</b></p>

<p style="margin-left:22%;">Log into a syslog facility and
are defined by specifying the facility to log to as the name
of a subsection in the <b>charon.syslog</b> section. The
following facilities are currently supported: <b>daemon</b>
and <b>auth</b>.</p>

<p style="margin-left:11%; margin-top: 1em">Multiple
loggers can be defined for each type with different log
verbosity for the different subsystems of the daemon.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Options <br>
charon.filelog.&lt;filename&gt;.default</b> [1] <b><br>
charon.syslog.&lt;facility&gt;.default</b></p>

<p style="margin-left:22%;">Specifies the default loglevel
to be used for subsystems for which no specific loglevel is
defined.</p>


<p style="margin-left:11%;"><b>charon.filelog.&lt;filename&gt;.&lt;subsystem&gt;</b>
[&lt;default&gt;] <b><br>
charon.syslog.&lt;facility&gt;.&lt;subsystem&gt;</b></p>

<p style="margin-left:22%;">Specifies the loglevel for the
given subsystem.</p>


<p style="margin-left:11%;"><b>charon.filelog.&lt;filename&gt;.append</b>
[yes]</p>

<p style="margin-left:22%;">If this option is enabled log
entries are appended to the existing file.</p>


<p style="margin-left:11%;"><b>charon.filelog.&lt;filename&gt;.flush_line</b>
[no]</p>

<p style="margin-left:22%;">Enabling this option disables
block buffering and enables line buffering.</p>


<p style="margin-left:11%;"><b>charon.filelog.&lt;filename&gt;.ike_name</b>
[no] <b><br>
charon.syslog.&lt;facility&gt;.ike_name</b></p>

<p style="margin-left:22%;">Prefix each log entry with the
connection name and a unique numerical identifier for each
IKE_SA.</p>


<p style="margin-left:11%;"><b>charon.filelog.&lt;filename&gt;.time_format</b></p>

<p style="margin-left:22%;">Prefix each log entry with a
timestamp. The option accepts a format string as passed to
<b>strftime</b>(3).</p>


<p style="margin-left:11%;"><b>charon.syslog.identifier</b></p>

<p style="margin-left:22%;">Global identifier used for an
<b>openlog</b>(3) call, prepended to each log message by
syslog. If not configured, <b>openlog</b>(3) is not called,
so the value will depend on system defaults (often the
program name).</p>


<p style="margin-left:11%; margin-top: 1em"><b>Subsystems</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>dmn</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Main daemon setup/cleanup/signal handling</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>mgr</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>IKE_SA manager, handling synchronization for IKE_SA
access</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>ike</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>IKE_SA</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>chd</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>CHILD_SA</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>job</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Jobs queueing/processing and thread pool management</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>cfg</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Configuration management and plugins</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>knl</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>IPsec/Networking kernel interface</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>net</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>IKE network communication</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>asn</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Low-level encoding/decoding (ASN.1, X.509 etc.)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>enc</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Packet encoding/decoding encryption/decryption
operations</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>tls</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>libtls library messages</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>esp</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>libipsec library messages</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>lib</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>libstrongwan library messages</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>tnc</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Trusted Network Connect</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>imc</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Integrity Measurement Collector</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>imv</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Integrity Measurement Verifier</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>pts</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Platform Trust Service</p></td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>Loglevels</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em"><b>-1</b></p></td>
<td width="8%"></td>
<td width="78%">


<p style="margin-top: 1em">Absolutely silent</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>0</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Very basic auditing logs, (e.g. SA up/SA down)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>1</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Generic control flow with errors, a good default to see
whats going on</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>2</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>More detailed debugging control flow</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>3</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Including RAW data dumps in Hex</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>4</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Also include sensitive material in dumps, e.g. keys</p></td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>Example</b></p>


<pre style="margin-left:11%;">     charon {
          filelog {
               /var/log/charon.log {
                    time_format = %b %e %T
                    append = no
                    default = 1
               }
               stderr {
                    ike = 2
                    knl = 3
                    ike_name = yes
               }
          }
          syslog {
               # enable logging to LOG_DAEMON, use defaults
               daemon {
               }
               # minimalistic IKE auditing logging to LOG_AUTHPRIV
               auth {
                    default = -1
                    ike = 0
               }
          }
     }</pre>


<h2>JOB PRIORITY MANAGEMENT
<a name="JOB PRIORITY MANAGEMENT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Some operations
in the IKEv2 daemon charon are currently implemented
synchronously and blocking. Two examples for such operations
are communication with a RADIUS server via EAP-RADIUS, or
fetching CRL/OCSP information during certificate chain
verification. Under high load conditions, the thread pool
may run out of available threads, and some more important
jobs, such as liveness checking, may not get executed in
time.</p>

<p style="margin-left:11%; margin-top: 1em">To prevent
thread starvation in such situations job priorities were
introduced. The job processor will reserve some threads for
higher priority jobs, these threads are not available for
lower priority, locking jobs.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Implementation</b>
<br>
Currently 4 priorities have been defined, and they are used
in charon as follows: <b><br>
CRITICAL</b></p>

<p style="margin-left:22%;">Priority for long-running
dispatcher jobs.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>HIGH</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>INFORMATIONAL exchanges, as used by liveness checking
(DPD).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>MEDIUM</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Everything not HIGH/LOW, including IKE_SA_INIT
processing.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>LOW</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>IKE_AUTH message processing. RADIUS and CRL fetching
block here</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Although
IKE_SA_INIT processing is computationally expensive, it is
explicitly assigned to the MEDIUM class. This allows charon
to do the DH exchange while other threads are blocked in
IKE_AUTH. To prevent the daemon from accepting more
IKE_SA_INIT requests than it can handle, use IKE_SA_INIT
DROPPING.</p>

<p style="margin-left:11%; margin-top: 1em">The thread pool
processes jobs strictly by priority, meaning it will consume
all higher priority jobs before looking for ones with lower
priority. Further, it reserves threads for certain
priorities. A priority class having reserved <i>n</i>
threads will always have <i>n</i> threads available for this
class (either currently processing a job, or waiting for
one).</p>


<p style="margin-left:11%; margin-top: 1em"><b>Configuration</b>
<br>
To ensure that there are always enough threads available for
higher priority tasks, threads must be reserved for each
priority class. <b><br>
libstrongswan.processor.priority_threads.critical</b>
[0]</p>

<p style="margin-left:22%;">Threads reserved for CRITICAL
priority class jobs</p>


<p style="margin-left:11%;"><b>libstrongswan.processor.priority_threads.high</b>
[0]</p>

<p style="margin-left:22%;">Threads reserved for HIGH
priority class jobs</p>


<p style="margin-left:11%;"><b>libstrongswan.processor.priority_threads.medium</b>
[0]</p>

<p style="margin-left:22%;">Threads reserved for MEDIUM
priority class jobs</p>


<p style="margin-left:11%;"><b>libstrongswan.processor.priority_threads.low</b>
[0]</p>

<p style="margin-left:22%;">Threads reserved for LOW
priority class jobs</p>

<p style="margin-left:11%; margin-top: 1em">Let&rsquo;s
consider the following configuration:</p>

<pre style="margin-left:11%; margin-top: 1em">     libstrongswan {
          processor {
               priority_threads {
                    high = 1
                    medium = 4
               }
          }
     }</pre>


<p style="margin-left:11%; margin-top: 1em">With this
configuration, one thread is reserved for HIGH priority
tasks. As currently only liveness checking and stroke
message processing is done with high priority, one or two
threads should be sufficient.</p>

<p style="margin-left:11%; margin-top: 1em">The MEDIUM
class mostly processes non-blocking jobs. Unless your setup
is experiencing many blocks in locks while accessing shared
resources, threads for one or two times the number of CPU
cores is fine.</p>

<p style="margin-left:11%; margin-top: 1em">It is usually
not required to reserve threads for CRITICAL jobs. Jobs in
this class rarely return and do not release their thread to
the pool.</p>

<p style="margin-left:11%; margin-top: 1em">The remaining
threads are available for LOW priority jobs. Reserving
threads does not make sense (until we have an even lower
priority).</p>


<p style="margin-left:11%; margin-top: 1em"><b>Monitoring</b>
<br>
To see what the threads are actually doing, invoke <i>ipsec
statusall</i>. Under high load, something like this will
show up:</p>

<pre style="margin-left:11%; margin-top: 1em">     worker threads: 2 or 32 idle, 5/1/2/22 working,
          job queue: 0/0/1/149, scheduled: 198</pre>


<p style="margin-left:11%; margin-top: 1em">From 32 worker
threads,</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2</p></td>
<td width="8%"></td>
<td width="78%">


<p>are currently idle.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>5</p></td>
<td width="8%"></td>
<td width="78%">


<p>are running CRITICAL priority jobs (dispatching from
sockets, etc.).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>1</p></td>
<td width="8%"></td>
<td width="78%">


<p>is currently handling a HIGH priority job. This is
actually the thread currently providing this information via
stroke.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2</p></td>
<td width="8%"></td>
<td width="78%">


<p>are handling MEDIUM priority jobs, likely IKE_SA_INIT or
CREATE_CHILD_SA messages.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>22</p></td>
<td width="8%"></td>
<td width="78%">


<p>are handling LOW priority jobs, probably waiting for an
EAP-RADIUS response while processing IKE_AUTH messages.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The job queue
load shows how many jobs are queued for each priority, ready
for execution. The single MEDIUM priority job will get
executed immediately, as we have two spare threads reserved
for MEDIUM class jobs.</p>

<h2>IKE_SA_INIT DROPPING
<a name="IKE_SA_INIT DROPPING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">If a responder
receives more connection requests per seconds than it can
handle, it does not make sense to accept more IKE_SA_INIT
messages. And if they are queued but can&rsquo;t get
processed in time, an answer might be sent after the client
has already given up and restarted its connection setup.
This additionally increases the load on the responder.</p>

<p style="margin-left:11%; margin-top: 1em">To limit the
responder load resulting from new connection attempts, the
daemon can drop IKE_SA_INIT messages just after reception.
There are two mechanisms to decide if this should happen,
configured with the following options: <b><br>
charon.init_limit_half_open</b> [0]</p>

<p style="margin-left:22%;">Limit based on the number of
half open IKE_SAs. Half open IKE_SAs are SAs in connecting
state, but not yet established.</p>


<p style="margin-left:11%;"><b>charon.init_limit_job_load</b>
[0]</p>

<p style="margin-left:22%;">Limit based on the number of
jobs currently queued for processing (sum over all job
priorities).</p>

<p style="margin-left:11%; margin-top: 1em">The second
limit includes load from other jobs, such as rekeying.
Choosing a good value is difficult and depends on the
hardware and expected load.</p>

<p style="margin-left:11%; margin-top: 1em">The first limit
is simpler to calculate, but includes the load from new
connections only. If your responder is capable of
negotiating 100 tunnels/s, you might set this limit to 1000.
The daemon will then drop new connection attempts if
generating a response would require more than 10 seconds. If
you are allowing for a maximum response time of more than 30
seconds, consider adjusting the timeout for connecting
IKE_SAs (<b>charon.half_open_timeout</b>). A responder, by
default, deletes an IKE_SA if the initiator does not
establish it within 30 seconds. Under high load, a higher
value might be required.</p>

<h2>LOAD TESTS
<a name="LOAD TESTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To do stability
testing and performance optimizations, the IKEv2 daemon
charon provides the load-tester plugin. This plugin allows
one to setup thousands of tunnels concurrently against the
daemon itself or a remote host.</p>


<p style="margin-left:11%; margin-top: 1em"><b>WARNING:</b>
Never enable the load-testing plugin on productive systems.
It provides preconfigured credentials and allows an attacker
to authenticate as any user.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Options <br>
charon.plugins.load-tester.addrs</b></p>

<p style="margin-left:22%;">Subsection that contains
key/value pairs with address pools (in CIDR notation) to use
for a specific network interface e.g. eth0 =
10.10.0.0/16</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.addrs_keep</b>
[no]</p>

<p style="margin-left:22%;">Whether to keep dynamic
addresses even after the associated SA got terminated</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.addrs_prefix</b>
[16]</p>

<p style="margin-left:22%;">Network prefix length to use
when installing dynamic addresses. If set to -1 the full
address is used (i.e. 32 or 128)</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.ca_dir</b></p>

<p style="margin-left:22%;">Directory to load
(intermediate) CA certificates from</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.child_rekey</b>
[600]</p>

<p style="margin-left:22%;">Seconds to start CHILD_SA
rekeying after setup</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.delay</b>
[0]</p>

<p style="margin-left:22%;">Delay between initiatons for
each thread</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.delete_after_established</b>
[no]</p>

<p style="margin-left:22%;">Delete an IKE_SA as soon as it
has been established</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.digest</b>
[sha1]</p>

<p style="margin-left:22%;">Digest algorithm used when
issuing certificates</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.dpd_delay</b>
[0]</p>

<p style="margin-left:22%;">DPD delay to use in load
test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.dynamic_port</b>
[0]</p>

<p style="margin-left:22%;">Base port to be used for
requests (each client uses a different port)</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.eap_password</b>
[default-pwd]</p>

<p style="margin-left:22%;">EAP secret to use in load
test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.enable</b>
[no]</p>

<p style="margin-left:22%;">Enable the load testing
plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.esp</b>
[aes128-sha1]</p>

<p style="margin-left:22%;">CHILD_SA proposal to use for
load tests</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.fake_kernel</b>
[no]</p>

<p style="margin-left:22%;">Fake the kernel interface to
allow load-testing against self</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.ike_rekey</b>
[0]</p>

<p style="margin-left:22%;">Seconds to start IKE_SA
rekeying after setup</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.init_limit</b>
[0]</p>

<p style="margin-left:22%;">Global limit of concurrently
established SAs during load test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.initiator</b>
[0.0.0.0]</p>

<p style="margin-left:22%;">Address to initiate from</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.initiators</b>
[0]</p>

<p style="margin-left:22%;">Number of concurrent initiator
threads to use in load test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.initiator_auth</b>
[pubkey]</p>

<p style="margin-left:22%;">Authentication method(s) the
intiator uses</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.initiator_id</b></p>

<p style="margin-left:22%;">Initiator ID used in load
test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.initiator_match</b></p>

<p style="margin-left:22%;">Initiator ID to match against
as responder</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.initiator_tsi</b></p>

<p style="margin-left:22%;">Traffic selector on initiator
side, as proposed by initiator</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.initiator_tsr</b></p>

<p style="margin-left:22%;">Traffic selector on responder
side, as proposed by initiator</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.iterations</b>
[1]</p>

<p style="margin-left:22%;">Number of IKE_SAs to initiate
by each initiator in load test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.issuer_cert</b></p>

<p style="margin-left:22%;">Path to the issuer certificate
(if not configured a hard-coded value is used)</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.issuer_key</b></p>

<p style="margin-left:22%;">Path to private key that is
used to issue certificates (if not configured a hard-coded
value is used)</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.mode</b>
[tunnel]</p>

<p style="margin-left:22%;">IPsec mode to use, one of
<b>tunnel</b>, <b>transport</b>, or <b>beet</b>.</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.pool</b></p>

<p style="margin-left:22%;">Provide INTERNAL_IPV4_ADDRs
from a named pool</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.preshared_key</b>
[default-psk]</p>

<p style="margin-left:22%;">Preshared key to use in load
test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.proposal</b>
[aes128-sha1-modp768]</p>

<p style="margin-left:22%;">IKE proposal to use in load
test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.responder</b>
[127.0.0.1]</p>

<p style="margin-left:22%;">Address to initiation
connections to</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.responder_auth</b>
[pubkey]</p>

<p style="margin-left:22%;">Authentication method(s) the
responder uses</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.responder_id</b></p>

<p style="margin-left:22%;">Responder ID used in load
test</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.responder_tsi</b>
[initiator_tsi]</p>

<p style="margin-left:22%;">Traffic selector on initiator
side, as narrowed by responder</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.responder_tsr</b>
[initiator_tsr]</p>

<p style="margin-left:22%;">Traffic selector on responder
side, as narrowed by responder</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.request_virtual_ip</b>
[no]</p>

<p style="margin-left:22%;">Request an INTERNAL_IPV4_ADDR
from the server</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.shutdown_when_complete</b>
[no]</p>

<p style="margin-left:22%;">Shutdown the daemon after all
IKE_SAs have been established</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.socket</b>
[unix:///var/run/charon.ldt]</p>

<p style="margin-left:22%;">Socket provided by the
load-tester plugin</p>


<p style="margin-left:11%;"><b>charon.plugins.load-tester.version</b>
[0]</p>

<p style="margin-left:22%;">IKE version to use (0 means use
IKEv2 as initiator and accept any version as responder)</p>


<p style="margin-left:11%; margin-top: 1em"><b>Configuration
details</b> <br>
For public key authentication, the responder uses the
<b>&quot;CN=srv, OU=load-test, O=strongSwan&quot;</b>
identity. For the initiator, each connection attempt uses a
different identity in the form <b>&quot;CN=c1-r1,
OU=load-test, O=strongSwan&quot;</b>, where the first number
inidicates the client number, the second the authentication
round (if multiple authentication is used).</p>

<p style="margin-left:11%; margin-top: 1em">For PSK
authentication, FQDN identities are used. The server uses
<b>srv.strongswan.org</b>, the client uses an identity in
the form <b>c1-r1.strongswan.org</b>.</p>

<p style="margin-left:11%; margin-top: 1em">For EAP
authentication, the client uses a NAI in the form
<b>100000000010001@strongswan.org</b>.</p>

<p style="margin-left:11%; margin-top: 1em">To configure
multiple authentication, concatenate multiple methods using,
e.g.</p>

<pre style="margin-left:11%;">     initiator_auth = pubkey|psk|eap-md5|eap-aka</pre>


<p style="margin-left:11%; margin-top: 1em">The responder
uses a hardcoded certificate based on a 1024-bit RSA key.
This certificate additionally serves as CA certificate. A
peer uses the same private key, but generates client
certificates on demand signed by the CA certificate. Install
the Responder/CA certificate on the remote host to
authenticate all clients.</p>

<p style="margin-left:11%; margin-top: 1em">To speed up
testing, the load tester plugin implements a special
Diffie-Hellman implementation called modpnull. By
setting</p>

<pre style="margin-left:11%;">     proposal = aes128-sha1-modpnull</pre>


<p style="margin-left:11%;">this wicked fast DH
implementation is used. It does not provide any security at
all, but allows one to run tests without DH calculation
overhead.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Examples</b>
<br>
In the simplest case, the daemon initiates IKE_SAs against
itself using the loopback interface. This will actually
establish double the number of IKE_SAs, as the daemon is
initiator and responder for each IKE_SA at the same time.
Installation of IPsec SAs would fails, as each SA gets
installed twice. To simulate the correct behavior, a fake
kernel interface can be enabled which does not install the
IPsec SAs at the kernel level.</p>

<p style="margin-left:11%; margin-top: 1em">A simple
loopback configuration might look like this:</p>
<pre style="margin-left:11%; margin-top: 1em">     charon {
          # create new IKE_SAs for each CHILD_SA to simulate
          # different clients
          reuse_ikesa = no
          # turn off denial of service protection
          dos_protection = no


          plugins {
               load-tester {
                    # enable the plugin
                    enable = yes
                    # use 4 threads to initiate connections
                    # simultaneously
                    initiators = 4
                    # each thread initiates 1000 connections
                    iterations = 1000
                    # delay each initiation in each thread by 20ms
                    delay = 20
                    # enable the fake kernel interface to
                    # avoid SA conflicts
                    fake_kernel = yes
               }
          }
     }</pre>


<p style="margin-left:11%; margin-top: 1em">This will
initiate 4000 IKE_SAs within 20 seconds. You may increase
the delay value if your box can not handle that much load,
or decrease it to put more load on it. If the daemon starts
retransmitting messages your box probably can not handle all
connection attempts.</p>

<p style="margin-left:11%; margin-top: 1em">The plugin also
allows one to test against a remote host. This might help to
test against a real world configuration. A connection setup
to do stress testing of a gateway might look like this:</p>
<pre style="margin-left:11%; margin-top: 1em">     charon {
          reuse_ikesa = no
          threads = 32


          plugins {
               load-tester {
                    enable = yes
                    # 10000 connections, ten in parallel
                    initiators = 10
                    iterations = 1000
                    # use a delay of 100ms, overall time is:
                    # iterations * delay = 100s
                    delay = 100
                    # address of the gateway
                    remote = 1.2.3.4
                    # IKE-proposal to use
                    proposal = aes128-sha1-modp1024
                    # use faster PSK authentication instead
                    # of 1024bit RSA
                    initiator_auth = psk
                    responder_auth = psk
                    # request a virtual IP using configuration
                    # payloads
                    request_virtual_ip = yes
                    # enable CHILD_SA every 60s
                    child_rekey = 60
               }
          }
     }</pre>


<h2>IKEv2 RETRANSMISSION
<a name="IKEv2 RETRANSMISSION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Retransmission
timeouts in the IKEv2 daemon charon can be configured
globally using the three keys listed below:</p>


<p style="margin-left:22%; margin-top: 1em"><b>charon.retransmit_base</b>
[1.8] <b><br>
charon.retransmit_timeout</b> [4.0] <b><br>
charon.retransmit_tries</b> [5]</p>

<p style="margin-left:11%; margin-top: 1em">The following
algorithm is used to calculate the timeout:</p>

<pre style="margin-left:11%; margin-top: 1em">     relative timeout = retransmit_timeout * retransmit_base ^ (n-1)</pre>


<p style="margin-left:11%; margin-top: 1em">Where <i>n</i>
is the current retransmission count.</p>

<p style="margin-left:11%; margin-top: 1em">Using the
default values, packets are retransmitted in:</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-95761.png" alt="Image grohtml-95761.png"></p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">/etc/strongswan.conf</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>ipsec.conf</b>(5),
<b>ipsec.secrets</b>(5), <b>ipsec</b>(8),
<b>charon-cmd</b>(8)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Written for the
<a href="http://www.strongswan.org">strongSwan project</a>
by Tobias Brunner, Andreas Steffen and Martin Willi.</p>
<hr>
</body>
</html>
