<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:11:46 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PERF&minus;KVM</title>

</head>
<body>

<h1 align="center">PERF&minus;KVM</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#STAT REPORT OPTIONS">STAT REPORT OPTIONS</a><br>
<a href="#STAT LIVE OPTIONS">STAT LIVE OPTIONS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">perf-kvm
&minus; Tool to trace/measure kvm guest os</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>perf kvm</i>
[&minus;&minus;host] [&minus;&minus;guest]
[&minus;&minus;guestmount=&lt;path&gt; <br>
[&minus;&minus;guestkallsyms=&lt;path&gt;
&minus;&minus;guestmodules=&lt;path&gt; |
&minus;&minus;guestvmlinux=&lt;path&gt;]] <br>
{top|record|report|diff|buildid&minus;list} <i><br>
perf kvm</i> [&minus;&minus;host] [&minus;&minus;guest]
[&minus;&minus;guestkallsyms=&lt;path&gt;
&minus;&minus;guestmodules=&lt;path&gt; <br>
| &minus;&minus;guestvmlinux=&lt;path&gt;]
{top|record|report|diff|buildid&minus;list|stat} <br>
'perf kvm stat [record|report|live] [&lt;options&gt;]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">There are a
couple of variants of perf kvm:</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm
[options] top &lt;command&gt;' to generates and displays
<br>
a performance counter profile of guest os in realtime <br>
of an arbitrary workload.</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm
record &lt;command&gt;' to record the performance counter
profile <br>
of an arbitrary workload and save it into a perf data file.
If both <br>
&minus;&minus;host and &minus;&minus;guest are input, the
perf data file name is perf.data.kvm. <br>
If there is no &minus;&minus;host but &minus;&minus;guest,
the file name is perf.data.guest. <br>
If there is no &minus;&minus;guest but &minus;&minus;host,
the file name is perf.data.host.</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm
report' to display the performance counter profile
information <br>
recorded via perf kvm record.</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm diff'
to displays the performance difference amongst two perf.data
<br>
files captured via perf record.</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm
buildid&minus;list' to display the buildids found in a perf
data file, <br>
so that other tools can be used to fetch packages with
matching symbol tables <br>
for use by perf report.</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm stat
&lt;command&gt;' to run a command and gather performance
counter <br>
statistics. <br>
Especially, perf 'kvm stat record/report' generates a
statistical analysis <br>
of KVM events. Currently, vmexit, mmio and ioport events are
supported. <br>
'perf kvm stat record &lt;command&gt;' records kvm events
and the events between <br>
start and end &lt;command&gt;. <br>
And this command produces a file which contains tracing
results of kvm <br>
events.</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm stat
report' reports statistical data which includes events <br>
handled time, samples, and so on.</p>

<p style="margin-left:17%; margin-top: 1em">'perf kvm stat
live' reports statistical data in a live mode (similar to
<br>
record + report but with statistical data updated live at a
given display <br>
rate).</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">&minus;i,
&minus;&minus;input=</p>

<p style="margin-left:17%;">Input file name.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;o,
&minus;&minus;output</p>

<p style="margin-left:17%;">Output file name.</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;host=</p>

<p style="margin-left:17%;">Collect host side performance
profile.</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;guest=</p>

<p style="margin-left:17%;">Collect guest side performance
profile.</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;guestmount=&lt;path&gt;</p>

<p style="margin-left:17%;">Guest os root file system mount
directory. Users mounts guest os root directories under
&lt;path&gt; by a specific filesystem access method,
typically, sshfs. For example, start 2 guest os. The
one&rsquo;s pid is 8888 and the other&rsquo;s is 9999.
#mkdir /guestmount; cd/guestmount #sshfs &minus;o
allow_other,direct_io &minus;p 5551 localhost:/ 8888/ #sshfs
&minus;o allow_other,direct_io &minus;p 5552 localhost:/
9999/ #perf kvm &minus;&minus;host &minus;&minus;guest
&minus;&minus;guestmount=~/guestmount top</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;guestkallsyms=&lt;path&gt;</p>

<p style="margin-left:17%;">Guest os /proc/kallsyms file
copy. <i>perf</i> kvm' reads it to get guest kernel symbols.
Users copy it out from guest os.</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;guestmodules=&lt;path&gt;</p>

<p style="margin-left:17%;">Guest os /proc/modules file
copy. <i>perf</i> kvm' reads it to get guest kernel module
information. Users copy it out from guest os.</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;guestvmlinux=&lt;path&gt;</p>

<p style="margin-left:17%;">Guest os kernel vmlinux.</p>

<h2>STAT REPORT OPTIONS
<a name="STAT REPORT OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">&minus;&minus;vcpu=&lt;value&gt;</p>

<p style="margin-left:17%;">analyze events which occures on
this vcpu. (default: all vcpus)</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;event=&lt;value&gt;</p>

<p style="margin-left:17%;">event to be analyzed. Possible
values: vmexit, mmio, ioport. (default: vmexit)</p>

<p style="margin-left:11%; margin-top: 1em">&minus;k,
&minus;&minus;key=&lt;value&gt;</p>

<p style="margin-left:17%;">Sorting key. Possible values:
sample (default, sort by samples number), time (sort by
average time).</p>

<p style="margin-left:11%; margin-top: 1em">&minus;p,
&minus;&minus;pid=</p>

<p style="margin-left:17%;">Analyze events only for given
process ID(s) (comma separated list).</p>

<h2>STAT LIVE OPTIONS
<a name="STAT LIVE OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">&minus;d,
&minus;&minus;display</p>

<p style="margin-left:17%;">Time in seconds between display
updates</p>

<p style="margin-left:11%; margin-top: 1em">&minus;m,
&minus;&minus;mmap&minus;pages=</p>

<p style="margin-left:17%;">Number of mmap data pages. Must
be a power of two.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;a,
&minus;&minus;all&minus;cpus</p>

<p style="margin-left:17%;">System&minus;wide collection
from all CPUs.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;p,
&minus;&minus;pid=</p>

<p style="margin-left:17%;">Analyze events only for given
process ID(s) (comma separated list).</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;vcpu=&lt;value&gt;</p>

<p style="margin-left:17%;">analyze events which occures on
this vcpu. (default: all vcpus)</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;event=&lt;value&gt;</p>

<p style="margin-left:17%;">event to be analyzed. Possible
values: vmexit, mmio, ioport. (default: vmexit)</p>

<p style="margin-left:11%; margin-top: 1em">&minus;k,
&minus;&minus;key=&lt;value&gt;</p>

<p style="margin-left:17%;">Sorting key. Possible values:
sample (default, sort by samples number), time (sort by
average time).</p>


<p style="margin-left:11%; margin-top: 1em">&minus;&minus;duration=&lt;value&gt;</p>

<p style="margin-left:17%;">Show events other than HLT that
take longer than duration usecs.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>perf-top</b>(1),
<b>perf-record</b>(1), <b>perf-report</b>(1),
<b>perf-diff</b>(1), <b>perf-buildid-list</b>(1),
<b>perf-stat</b>(1)</p>
<hr>
</body>
</html>
