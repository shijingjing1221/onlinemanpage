<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:28:02 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>STUNNEL</title>

</head>
<body>

<h1 align="center">STUNNEL</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#CONFIGURATION FILE">CONFIGURATION FILE</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#SIGNALS">SIGNALS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#FILES">FILES</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">stunnel &minus;
universal SSL tunnel</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Unix:</b></p>

<p style="margin-left:17%;"><b>stunnel</b>
[&lt;filename&gt;] | &minus;fd&nbsp;n | &minus;help |
&minus;version | &minus;sockets</p>


<p style="margin-left:11%;"><b><small>WIN32:</small></b></p>

<p style="margin-left:17%;"><b>stunnel</b> [
[&minus;install | &minus;uninstall | &minus;start |
&minus;stop] | &minus;exit] <br>
[&minus;quiet] [&lt;filename&gt;] ] | &minus;help |
&minus;version | &minus;sockets</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>stunnel</b> program is designed to work as
<i><small>SSL</small></i> encryption wrapper between remote
clients and local (<i>inetd</i>&minus;startable) or remote
servers. The concept is that having non-SSL aware daemons
running on your system you can easily set them up to
communicate with clients over secure <small>SSL</small>
channels.</p>

<p style="margin-left:11%; margin-top: 1em"><b>stunnel</b>
can be used to add <small>SSL</small> functionality to
commonly used <i>Inetd</i> daemons like <small>POP&minus;2,
POP&minus;3,</small> and <small>IMAP</small> servers, to
standalone daemons like <small>NNTP, SMTP</small> and
<small>HTTP,</small> and in tunneling <small>PPP</small>
over network sockets without changes to the source code.</p>

<p style="margin-left:11%; margin-top: 1em">This product
includes cryptographic software written by Eric Young
(eay@cryptsoft.com)</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">&lt;<b>filename</b>&gt;</p>

<p style="margin-left:17%;">Use specified configuration
file</p>

<p style="margin-left:11%;"><b>&minus;fd n</b> (Unix
only)</p>

<p style="margin-left:17%;">Read the config file from
specified file descriptor</p>

<p style="margin-left:11%;"><b>&minus;help</b></p>

<p style="margin-left:17%;">Print <b>stunnel</b> help
menu</p>

<p style="margin-left:11%;"><b>&minus;version</b></p>

<p style="margin-left:17%;">Print <b>stunnel</b> version
and compile time defaults</p>

<p style="margin-left:11%;"><b>&minus;sockets</b></p>

<p style="margin-left:17%;">Print default socket
options</p>

<p style="margin-left:11%;"><b>&minus;install</b> (
<small>NT/2000/XP</small> only)</p>

<p style="margin-left:17%;">Install <small>NT</small>
Service</p>

<p style="margin-left:11%;"><b>&minus;uninstall</b> (
<small>NT/2000/XP</small> only)</p>

<p style="margin-left:17%;">Uninstall <small>NT</small>
Service</p>

<p style="margin-left:11%;"><b>&minus;start</b> (
<small>NT/2000/XP</small> only)</p>

<p style="margin-left:17%;">Start <small>NT</small>
Service</p>

<p style="margin-left:11%;"><b>&minus;stop</b> (
<small>NT/2000/XP</small> only)</p>

<p style="margin-left:17%;">Stop <small>NT</small>
Service</p>

<p style="margin-left:11%;"><b>&minus;exit</b> (Win32
only)</p>

<p style="margin-left:17%;">Exit an already started
stunnel</p>

<p style="margin-left:11%;"><b>&minus;quiet</b> (
<small>NT/2000/XP</small> only)</p>

<p style="margin-left:17%;">Don&rsquo;t display any message
boxes</p>

<h2>CONFIGURATION FILE
<a name="CONFIGURATION FILE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Each line of
the configuration file can be either:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>An empty line (ignored).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>A comment starting with &rsquo;;&rsquo; (ignored).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>An &rsquo;option_name = option_value&rsquo; pair.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>&rsquo;[service_name]&rsquo; indicating a start of a
service definition.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">An address
parameter of an option may be either:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p style="margin-top: 1em">A port number.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>A colon-separated pair of <small>IP</small> address
(either IPv4, IPv6, or domain name) and port number.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>A Unix socket path (Unix only).</p></td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b><small>GLOBAL
OPTIONS</small> <br>
chroot</b> = directory (Unix only)</p>

<p style="margin-left:17%;">directory to chroot
<b>stunnel</b> process</p>

<p style="margin-left:17%; margin-top: 1em"><b>chroot</b>
keeps <b>stunnel</b> in chrooted jail. <i>CApath</i>,
<i>CRLpath</i>, <i>pid</i> and <i>exec</i> are located
inside the jail and the patches have to be relative to the
directory specified with <b>chroot</b>.</p>

<p style="margin-left:17%; margin-top: 1em">Several
functions of the operating system also need their files to
be located within chroot jail, e.g.:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Delayed resolver typically needs /etc/nsswitch.conf and
/etc/resolv.conf.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Local time in log files needs /etc/timezone.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Some other functions may need devices, e.g. /dev/zero or
/dev/null.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>compression</b> = deflate |
zlib | rle</p>

<p style="margin-left:17%;">select data compression
algorithm</p>

<p style="margin-left:17%; margin-top: 1em">default: no
compression</p>

<p style="margin-left:17%; margin-top: 1em">deflate is the
standard compression method as described in <small>RFC
1951.</small></p>

<p style="margin-left:17%; margin-top: 1em">zlib
compression of <b>OpenSSL 0.9.8</b> or above is not backward
compatible with <b>OpenSSL 0.9.7</b>.</p>

<p style="margin-left:17%; margin-top: 1em">rle compression
is currently not implemented by the <b>OpenSSL</b>
library.</p>

<p style="margin-left:11%;"><b>debug</b> =
[facility.]level</p>

<p style="margin-left:17%;">debugging level</p>

<p style="margin-left:17%; margin-top: 1em">Level is a one
of the syslog level names or numbers emerg (0), alert (1),
crit (2), err (3), warning (4), notice (5), info (6), or
debug (7). All logs for the specified level and all levels
numerically less than it will be shown. Use <i>debug =
debug</i> or <i>debug = 7</i> for greatest debugging output.
The default is notice (5).</p>

<p style="margin-left:17%; margin-top: 1em">The syslog
facility &rsquo;authpriv&rsquo; will be used unless a
facility name is supplied. (Facilities are not supported on
Win32.)</p>

<p style="margin-left:17%; margin-top: 1em">Case is ignored
for both facilities and levels.</p>

<p style="margin-left:11%;"><b><small>EGD</small></b> = egd
path (Unix only)</p>

<p style="margin-left:17%;">path to Entropy Gathering
Daemon socket</p>

<p style="margin-left:17%; margin-top: 1em">Entropy
Gathering Daemon socket to use to feed <b>OpenSSL</b> random
number generator. (Available only if compiled with
<b>OpenSSL 0.9.5a</b> or higher)</p>

<p style="margin-left:11%;"><b>engine</b> = auto |
&lt;engine id&gt;</p>

<p style="margin-left:17%;">select hardware engine</p>

<p style="margin-left:17%; margin-top: 1em">default:
software-only cryptography</p>

<p style="margin-left:17%; margin-top: 1em">Here is an
example of advanced engine configuration to read private key
from an OpenSC engine</p>

<pre style="margin-left:17%; margin-top: 1em">    engine=dynamic
    engineCtrl=SO_PATH:/usr/lib/opensc/engine_pkcs11.so
    engineCtrl=ID:pkcs11
    engineCtrl=LIST_ADD:1
    engineCtrl=LOAD
    engineCtrl=MODULE_PATH:/usr/lib/pkcs11/opensc&minus;pkcs11.so
    engineCtrl=INIT
    [service]
    engineNum=1
    key=id_45</pre>


<p style="margin-left:11%;"><b>engineCtrl</b> =
command[:parameter]</p>

<p style="margin-left:17%;">control hardware engine</p>

<p style="margin-left:17%; margin-top: 1em">Special
commands &quot; <small>LOAD&quot;</small> and &quot;
<small>INIT&quot;</small> can be used to load and initialize
the engine cryptogaphic module.</p>

<p style="margin-left:11%;"><b>fips</b> = yes | no</p>

<p style="margin-left:17%;">Enable or disable <small>FIPS
140&minus;2</small> mode.</p>

<p style="margin-left:17%; margin-top: 1em">This option
allows to disable entering <small>FIPS</small> mode if
<b>stunnel</b> was compiled with <small>FIPS
140&minus;2</small> support.</p>

<p style="margin-left:17%; margin-top: 1em">default:
yes</p>

<p style="margin-left:11%;"><b>foreground</b> = yes | no
(Unix only)</p>

<p style="margin-left:17%;">foreground mode</p>

<p style="margin-left:17%; margin-top: 1em">Stay in
foreground (don&rsquo;t fork) and log to stderr instead of
via syslog (unless <i>output</i> is specified).</p>

<p style="margin-left:17%; margin-top: 1em">default:
background in daemon mode</p>

<p style="margin-left:11%;"><b>output</b> = file</p>

<p style="margin-left:17%;">append log messages to a
file</p>

<p style="margin-left:17%; margin-top: 1em">/dev/stdout
device can be used to send log messages to the standard
output (for example to log them with daemontools
splogger).</p>

<p style="margin-left:11%;"><b>pid</b> = file (Unix
only)</p>

<p style="margin-left:17%;">pid file location</p>

<p style="margin-left:17%; margin-top: 1em">If the argument
is empty, then no pid file will be created.</p>

<p style="margin-left:17%; margin-top: 1em"><i>pid</i> path
is relative to <i>chroot</i> directory if specified.</p>

<p style="margin-left:11%;"><b>RNDbytes</b> = bytes</p>

<p style="margin-left:17%;">bytes to read from random seed
files</p>

<p style="margin-left:17%; margin-top: 1em">Number of bytes
of data read from random seed files. With <small>SSL</small>
versions less than <b>0.9.5a</b>, also determines how many
bytes of data are considered sufficient to seed the
<small>PRNG.</small> More recent <b>OpenSSL</b> versions
have a builtin function to determine when sufficient
randomness is available.</p>

<p style="margin-left:11%;"><b>RNDfile</b> = file</p>

<p style="margin-left:17%;">path to file with random seed
data</p>

<p style="margin-left:17%; margin-top: 1em">The
<small>SSL</small> library will use data from this file
first to seed the random number generator.</p>

<p style="margin-left:11%;"><b>RNDoverwrite</b> = yes |
no</p>

<p style="margin-left:17%;">overwrite the random seed files
with new random data</p>

<p style="margin-left:17%; margin-top: 1em">default:
yes</p>

<p style="margin-left:11%;"><b>service</b> = servicename
(Unix only)</p>

<p style="margin-left:17%;">use specified string as
<i>inetd</i> mode service name for <small>TCP</small>
Wrapper library</p>

<p style="margin-left:17%; margin-top: 1em">default:
stunnel</p>

<p style="margin-left:11%;"><b>setgid</b> = groupname (Unix
only)</p>

<p style="margin-left:17%;"><i>setgid()</i> to groupname in
daemon mode and clears all other groups</p>

<p style="margin-left:11%;"><b>setuid</b> = username (Unix
only)</p>

<p style="margin-left:17%;"><i>setuid()</i> to username in
daemon mode</p>

<p style="margin-left:11%;"><b>socket</b> =
a|l|r:option=value[:value]</p>

<p style="margin-left:17%;">Set an option on
accept/local/remote socket</p>

<p style="margin-left:17%; margin-top: 1em">The values for
linger option are l_onof:l_linger. The values for time are
tv_sec:tv_usec.</p>

<p style="margin-left:17%; margin-top: 1em">Examples:</p>

<pre style="margin-left:17%; margin-top: 1em">    socket = l:SO_LINGER=1:60
        set one minute timeout for closing local socket
    socket = r:SO_OOBINLINE=yes
        place out&minus;of&minus;band data directly into the
        receive data stream for remote sockets
    socket = a:SO_REUSEADDR=no
        disable address reuse (enabled by default)
    socket = a:SO_BINDTODEVICE=lo
        only accept connections on loopback interface</pre>


<p style="margin-left:11%;"><b>syslog</b> = yes | no (Unix
only)</p>

<p style="margin-left:17%;">enable logging via syslog</p>

<p style="margin-left:17%; margin-top: 1em">default:
yes</p>

<p style="margin-left:11%;"><b>taskbar</b> = yes | no (
<small>WIN32</small> only)</p>

<p style="margin-left:17%;">enable the taskbar icon</p>

<p style="margin-left:17%; margin-top: 1em">default:
yes</p>


<p style="margin-left:11%; margin-top: 1em"><b>SERVICE-LEVEL
<small>OPTIONS</small></b> <br>
Each configuration section begins with service name in
square brackets. The service name is used for libwrap (
<small>TCP</small> Wrappers) access control and lets you
distinguish <b>stunnel</b> services in your log files.</p>

<p style="margin-left:11%; margin-top: 1em">Note that if
you wish to run <b>stunnel</b> in <i>inetd</i> mode (where
it is provided a network socket by a server such as
<i>inetd</i>, <i>xinetd</i>, or <i>tcpserver</i>) then you
should read the section entitled <i><small>INETD
MODE</small></i> below. <b><br>
accept</b> = address</p>

<p style="margin-left:17%;">accept connections on specified
address</p>

<p style="margin-left:17%; margin-top: 1em">If no host
specified, defaults to all IPv4 addresses for the local
host.</p>

<p style="margin-left:17%; margin-top: 1em">To listen on
all IPv6 addresses use:</p>

<pre style="margin-left:17%; margin-top: 1em">    connect = :::port</pre>


<p style="margin-left:11%;"><b>CApath</b> = directory</p>

<p style="margin-left:17%;">Certificate Authority
directory</p>

<p style="margin-left:17%; margin-top: 1em">This is the
directory in which <b>stunnel</b> will look for certificates
when using the <i>verify</i>. Note that the certificates in
this directory should be named <small>XXXXXXXX.0</small>
where <small>XXXXXXXX</small> is the hash value of the
<small>DER</small> encoded subject of the cert.</p>

<p style="margin-left:17%; margin-top: 1em">The hash
algorithm has been changed in <b>OpenSSL 1.0.0</b>. It is
required to c_rehash the directory on upgrade from
<b>OpenSSL 0.x.x</b> to <b>OpenSSL 1.x.x</b>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>CApath</i>
path is relative to <i>chroot</i> directory if
specified.</p>

<p style="margin-left:11%;"><b>CAfile</b> = certfile</p>

<p style="margin-left:17%;">Certificate Authority file</p>

<p style="margin-left:17%; margin-top: 1em">This file
contains multiple <small>CA</small> certificates, used with
the <i>verify</i>.</p>

<p style="margin-left:11%;"><b>cert</b> = pemfile</p>

<p style="margin-left:17%;">certificate chain
<small>PEM</small> file name</p>

<p style="margin-left:17%; margin-top: 1em">A
<small>PEM</small> is always needed in server mode.
Specifying this flag in client mode will use this
certificate chain as a client side certificate chain. Using
client side certs is optional. The certificates must be in
<small>PEM</small> format and must be sorted starting with
the certificate to the highest level (root <small>CA</small>
).</p>

<p style="margin-left:11%;"><b>ciphers</b> = cipherlist</p>

<p style="margin-left:17%;">Select permitted
<small>SSL</small> ciphers</p>

<p style="margin-left:17%; margin-top: 1em">A colon
delimited list of the ciphers to allow in the
<small>SSL</small> connection. For example
<small>DES&minus;CBC3&minus;SHA:IDEA&minus;CBC&minus;MD5</small></p>

<p style="margin-left:11%;"><b>client</b> = yes | no</p>

<p style="margin-left:17%;">client mode (remote service
uses <small>SSL</small> )</p>

<p style="margin-left:17%; margin-top: 1em">default: no
(server mode)</p>

<p style="margin-left:11%;"><b>connect</b> = address</p>

<p style="margin-left:17%;">connect to a remote address</p>

<p style="margin-left:17%; margin-top: 1em">If no host is
specified, the host defaults to localhost.</p>

<p style="margin-left:17%; margin-top: 1em">Multiple
<b>connect</b> options are allowed in a single service
section.</p>

<p style="margin-left:17%; margin-top: 1em">If host
resolves to multiple addresses and/or if multiple
<i>connect</i> options are specified, then the remote
address is chosen using a round-robin algorithm.</p>

<p style="margin-left:11%;"><b>CRLpath</b> = directory</p>

<p style="margin-left:17%;">Certificate Revocation Lists
directory</p>

<p style="margin-left:17%; margin-top: 1em">This is the
directory in which <b>stunnel</b> will look for CRLs when
using the <i>verify</i>. Note that the CRLs in this
directory should be named <small>XXXXXXXX</small> .r0 where
<small>XXXXXXXX</small> is the hash value of the
<small>CRL.</small></p>

<p style="margin-left:17%; margin-top: 1em">The hash
algorithm has been changed in <b>OpenSSL 1.0.0</b>. It is
required to c_rehash the directory on upgrade from
<b>OpenSSL 0.x.x</b> to <b>OpenSSL 1.x.x</b>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>CRLpath</i>
path is relative to <i>chroot</i> directory if
specified.</p>

<p style="margin-left:11%;"><b>CRLfile</b> = certfile</p>

<p style="margin-left:17%;">Certificate Revocation Lists
file</p>

<p style="margin-left:17%; margin-top: 1em">This file
contains multiple CRLs, used with the <i>verify</i>.</p>

<p style="margin-left:11%;"><b>curve</b> = nid</p>

<p style="margin-left:17%;">specify <small>ECDH</small>
curve name</p>

<p style="margin-left:17%; margin-top: 1em">To get a list
of supported cuves use:</p>

<pre style="margin-left:17%; margin-top: 1em">    openssl ecparam &minus;list_curves</pre>


<p style="margin-left:17%; margin-top: 1em">default:
prime256v1</p>

<p style="margin-left:11%;"><b>delay</b> = yes | no</p>

<p style="margin-left:17%;">delay <small>DNS</small> lookup
for &rsquo;connect&rsquo; option</p>

<p style="margin-left:17%; margin-top: 1em">This option is
useful for dynamic <small>DNS,</small> or when
<small>DNS</small> is not available during <b>stunnel</b>
startup (road warrior <small>VPN,</small> dial-up
configurations).</p>

<p style="margin-left:11%;"><b>engineNum</b> = engine
number</p>

<p style="margin-left:17%;">select engine number to read
private key</p>

<p style="margin-left:17%; margin-top: 1em">The engines are
numbered starting from 1.</p>

<p style="margin-left:11%;"><b>exec</b> =
executable_path</p>

<p style="margin-left:17%;">execute local inetd-type
program</p>

<p style="margin-left:17%; margin-top: 1em"><i>exec</i>
path is relative to <i>chroot</i> directory if
specified.</p>

<p style="margin-left:11%;"><b>execargs</b> = $0 $1 $2
...</p>

<p style="margin-left:17%;">arguments for <i>exec</i>
including program name ($0)</p>

<p style="margin-left:17%; margin-top: 1em">Quoting is
currently not supported. Arguments are separated with
arbitrary number of whitespaces.</p>

<p style="margin-left:11%;"><b>failover</b> = rr | prio</p>

<p style="margin-left:17%;">Failover strategy for multiple
&quot;connect&quot; targets.</p>

<pre style="margin-left:17%; margin-top: 1em">    rr (round robin) &minus; fair load distribution
    prio (priority) &minus; use the order specified in config file</pre>


<p style="margin-left:17%; margin-top: 1em">default: rr</p>

<p style="margin-left:11%;"><b>ident</b> = username</p>

<p style="margin-left:17%;">use <small>IDENT</small> (
<small>RFC 1413</small> ) username checking</p>

<p style="margin-left:11%;"><b>key</b> = keyfile</p>

<p style="margin-left:17%;">private key for certificate
specified with <i>cert</i> option</p>

<p style="margin-left:17%; margin-top: 1em">Private key is
needed to authenticate certificate owner. Since this file
should be kept secret it should only be readable to its
owner. On Unix systems you can use the following
command:</p>

<pre style="margin-left:17%; margin-top: 1em">    chmod 600 keyfile</pre>


<p style="margin-left:17%; margin-top: 1em">default: value
of <i>cert</i> option</p>

<p style="margin-left:11%;"><b>libwrap</b> = yes | no</p>

<p style="margin-left:17%;">Enable or disable the use of
/etc/hosts.allow and /etc/hosts.deny.</p>

<p style="margin-left:17%; margin-top: 1em">default:
yes</p>

<p style="margin-left:11%;"><b>local</b> = host</p>

<p style="margin-left:17%;"><small>IP</small> of the
outgoing interface is used as source for remote connections.
Use this option to bind a static local <small>IP</small>
address, instead.</p>

<p style="margin-left:11%;"><b>sni</b> =
service_name:server_name_pattern (server mode)</p>

<p style="margin-left:17%;">Use the service as a slave
service (a name-based virtual server) for Server Name
Indication <small>TLS</small> extension ( <small>RFC
3546</small> ).</p>


<p style="margin-left:17%; margin-top: 1em"><i>service_name</i>
specifies the master service that accepts client connections
with <i>accept</i> option. <i>server_name_pattern</i>
specifies the host name to be redirected. The pattern may
start with &rsquo;*&rsquo; character, e.g.
&rsquo;*.example.com&rsquo;. Multiple slave services are
normally specified for a single master service. <i>sni</i>
option can also be specified more than once within a single
slave service.</p>

<p style="margin-left:17%; margin-top: 1em">This service,
as well as the master service, may not be configured in
client mode.</p>

<p style="margin-left:17%; margin-top: 1em"><i>connect</i>
option of the slave service is ignored when <i>protocol</i>
option is specified, as <i>protocol</i> connects remote host
before <small>TLS</small> handshake.</p>

<p style="margin-left:17%; margin-top: 1em">Libwrap checks
(Unix only) are performed twice: with master service name
after <small>TCP</small> connection is accepted, and with
slave service name during <small>TLS</small> handshake.</p>

<p style="margin-left:17%; margin-top: 1em">Option
<i>sni</i> is only available when compiled with <b>OpenSSL
1.0.0</b> and later.</p>

<p style="margin-left:11%;"><b>sni</b> = server_name
(client mode)</p>

<p style="margin-left:17%;">Use the parameter as the value
of <small>TLS</small> Server Name Indication ( <small>RFC
3546</small> ) extension.</p>

<p style="margin-left:17%; margin-top: 1em">Option
<i>sni</i> is only available when compiled with <b>OpenSSL
1.0.0</b> and later.</p>

<p style="margin-left:11%;"><b><small>OCSP</small></b> =
url</p>

<p style="margin-left:17%;">select <small>OCSP</small>
server for certificate verification</p>

<p style="margin-left:11%;"><b>OCSPflag</b> = flag</p>

<p style="margin-left:17%;">specify <small>OCSP</small>
server flag</p>

<p style="margin-left:17%; margin-top: 1em">Several
<i>OCSPflag</i> can be used to specify multiple flags.</p>

<p style="margin-left:17%; margin-top: 1em">currently
supported flags: <small>NOCERTS, NOINTERN NOSIGS, NOCHAIN,
NOVERIFY, NOEXPLICIT, NOCASIGN, NODELEGATED, NOCHECKS,
TRUSTOTHER, RESPID_KEY, NOTIME</small></p>

<p style="margin-left:11%;"><b>options</b> =
SSL_options</p>

<p style="margin-left:17%;"><b>OpenSSL</b> library
options</p>

<p style="margin-left:17%; margin-top: 1em">The parameter
is the <b>OpenSSL</b> option name as described in the
<i>SSL_CTX_set_options(3ssl)</i> manual, but without
<i><small>SSL_OP_</small></i> prefix. Several <i>options</i>
can be used to specify multiple options.</p>

<p style="margin-left:17%; margin-top: 1em">For example for
compatibility with erroneous Eudora <small>SSL</small>
implementation the following option can be used:</p>

<pre style="margin-left:17%; margin-top: 1em">    options = DONT_INSERT_EMPTY_FRAGMENTS</pre>


<p style="margin-left:11%;"><b>protocol</b> = proto</p>

<p style="margin-left:17%;">application protocol to
negotiate <small>SSL</small></p>

<p style="margin-left:17%; margin-top: 1em">This option
enables initial, protocol-specific negotiation of the
<small>SSL/TLS</small> encryption. <i>protocol</i> option
should not be used with <small>SSL</small> encryption on a
separate port.</p>

<p style="margin-left:17%; margin-top: 1em">Currently
supported protocols: <i><br>
cifs</i></p>

<p style="margin-left:23%;">Proprietary (undocummented)
extension of <small>CIFS</small> protocol implemented in
Samba. Support for this extension was dropped in Samba
3.0.0.</p>

<p style="margin-left:17%;"><i>connect</i></p>

<p style="margin-left:23%;">Based on <small>RFC 2817
&minus;</small> <i>Upgrading to <small>TLS</small> Within
<small>HTTP/1.1</small></i> , section 5.2 &minus;
<i>Requesting a Tunnel with <small>CONNECT</small></i></p>

<p style="margin-left:23%; margin-top: 1em">This protocol
is only supported in client mode.</p>

<p style="margin-left:17%;"><i>imap</i></p>

<p style="margin-left:23%;">Based on <small>RFC 2595
&minus;</small> <i>Using <small>TLS</small> with
<small>IMAP, POP3</small> and <small>ACAP</small></i></p>

<p style="margin-left:17%;"><i>nntp</i></p>

<p style="margin-left:23%;">Based on <small>RFC 4642
&minus;</small> <i>Using Transport Layer Security (
<small>TLS</small> ) with Network News Transfer Protocol (
<small>NNTP</small> )</i></p>

<p style="margin-left:23%; margin-top: 1em">This protocol
is only supported in client mode.</p>

<p style="margin-left:17%;"><i>pgsql</i></p>

<p style="margin-left:23%;">Based on
http://www.postgresql.org/docs/8.3/static/protocol&minus;flow.html#AEN73982</p>

<p style="margin-left:17%;"><i>pop3</i></p>

<p style="margin-left:23%;">Based on <small>RFC 2449
&minus; <i>POP3</i></small> <i>Extension Mechanism</i></p>

<p style="margin-left:17%;"><i>proxy</i></p>

<p style="margin-left:23%;">Haproxy client
<small>IP</small> address
http://haproxy.1wt.eu/download/1.5/doc/proxy&minus;protocol.txt</p>

<p style="margin-left:17%;"><i>smtp</i></p>

<p style="margin-left:23%;">Based on <small>RFC 2487
&minus; <i>SMTP</i></small> <i>Service Extension for Secure
<small>SMTP</small> over <small>TLS</small></i></p>

<p style="margin-left:11%;"><b>protocolAuthentication</b> =
auth_type</p>

<p style="margin-left:17%;">authentication type for
protocol negotiations</p>

<p style="margin-left:17%; margin-top: 1em">currently
supported: basic, <small>NTLM</small></p>

<p style="margin-left:17%; margin-top: 1em">Currently
authentication type only applies to the
&rsquo;connect&rsquo; protocol.</p>

<p style="margin-left:17%; margin-top: 1em">default:
basic</p>

<p style="margin-left:11%;"><b>protocolHost</b> =
host:port</p>

<p style="margin-left:17%;">destination address for
protocol negotiations</p>


<p style="margin-left:17%; margin-top: 1em"><i>protocolHost</i>
specifies the final <small>SSL</small> server to be
connected by the proxy, and not the proxy server directly
connected by <b>stunnel</b>. The proxy server should be
specified with the &rsquo;connect&rsquo; option.</p>

<p style="margin-left:17%; margin-top: 1em">Currently
protocol destination address only applies to
&rsquo;connect&rsquo; protocol.</p>

<p style="margin-left:11%;"><b>protocolPassword</b> =
password</p>

<p style="margin-left:17%;">password for protocol
negotiations</p>

<p style="margin-left:11%;"><b>protocolUsername</b> =
username</p>

<p style="margin-left:17%;">username for protocol
negotiations</p>

<p style="margin-left:11%;"><b>pty</b> = yes | no (Unix
only)</p>

<p style="margin-left:17%;">allocate pseudo terminal for
&rsquo;exec&rsquo; option</p>

<p style="margin-left:11%;"><b>renegotiation</b> = yes |
no</p>

<p style="margin-left:17%;">support <small>SSL</small>
renegotiation</p>

<p style="margin-left:17%; margin-top: 1em">Applications of
the <small>SSL</small> renegotiation include some
authentication scenarios, or re-keying long lasting
connections.</p>

<p style="margin-left:17%; margin-top: 1em">On the other
hand this feature can facilitate a trivial CPU-exhaustion
DoS attack:</p>


<p style="margin-left:17%; margin-top: 1em">http://vincent.bernat.im/en/blog/2011&minus;ssl&minus;dos&minus;mitigation.html</p>

<p style="margin-left:17%; margin-top: 1em">Please note
that disabling <small>SSL</small> renegotiation does not
fully mitigate this issue.</p>

<p style="margin-left:17%; margin-top: 1em">default: yes
(if supported by <b>OpenSSL</b>)</p>

<p style="margin-left:11%;"><b>reset</b> = yes | no</p>

<p style="margin-left:17%;">attempt to use <small>TCP
RST</small> flag to indicate an error</p>

<p style="margin-left:17%; margin-top: 1em">This option is
not supported on some platforms.</p>

<p style="margin-left:17%; margin-top: 1em">default:
yes</p>

<p style="margin-left:11%;"><b>retry</b> = yes | no</p>

<p style="margin-left:17%;">reconnect a connect+exec
section after it&rsquo;s disconnected</p>

<p style="margin-left:17%; margin-top: 1em">default: no</p>

<p style="margin-left:11%;"><b>sessionCacheSize</b> =
size</p>

<p style="margin-left:17%;">session cache size</p>


<p style="margin-left:17%; margin-top: 1em"><i>sessionCacheSize</i>
specifies the maximum number of the internal session cache
entries.</p>

<p style="margin-left:17%; margin-top: 1em">The value of 0
can be used for unlimited size. It is not recommended for
production use due to the risk of memory exhaustion DoS
attack.</p>

<p style="margin-left:11%;"><b>sessionCacheTimeout</b> =
timeout</p>

<p style="margin-left:17%;">session cache timeout</p>

<p style="margin-left:17%; margin-top: 1em">This is the
number of seconds to keep cached <small>SSL</small>
sessions.</p>

<p style="margin-left:11%;"><b>sessiond</b> = host:port</p>

<p style="margin-left:17%;">address of sessiond
<small>SSL</small> cache server</p>

<p style="margin-left:11%;"><b>sslVersion</b> = version</p>

<p style="margin-left:17%;">select version of
<small>SSL</small> protocol</p>

<p style="margin-left:17%; margin-top: 1em">Allowed
options: all, SSLv2, SSLv3, TLSv1, TLSv1.1, TLSv1.2</p>

<p style="margin-left:11%;"><b>stack</b> = bytes (except
for <small>FORK</small> model)</p>

<p style="margin-left:17%;">thread stack size</p>

<p style="margin-left:11%;"><b>TIMEOUTbusy</b> =
seconds</p>

<p style="margin-left:17%;">time to wait for expected
data</p>

<p style="margin-left:11%;"><b>TIMEOUTclose</b> =
seconds</p>

<p style="margin-left:17%;">time to wait for close_notify
(set to 0 for buggy <small>MSIE</small> )</p>

<p style="margin-left:11%;"><b>TIMEOUTconnect</b> =
seconds</p>

<p style="margin-left:17%;">time to wait to connect a
remote host</p>

<p style="margin-left:11%;"><b>TIMEOUTidle</b> =
seconds</p>

<p style="margin-left:17%;">time to keep an idle
connection</p>

<p style="margin-left:11%;"><b>transparent</b> = none |
source | destination | both (Unix only)</p>

<p style="margin-left:17%;">enable transparent proxy
support on selected platforms</p>

<p style="margin-left:17%; margin-top: 1em">Supported
values: <i><br>
none</i></p>

<p style="margin-left:23%;">Disable transparent proxy
support. This is the default.</p>

<p style="margin-left:17%;"><i>source</i></p>

<p style="margin-left:23%;">Re-write address to appear as
if wrapped daemon is connecting from the <small>SSL</small>
client machine instead of the machine running
<b>stunnel</b>.</p>

<p style="margin-left:23%; margin-top: 1em">This option is
currently available in: <br>
Remote mode (<i>connect</i> option) on <i>Linux
&gt;=2.6.28</i></p>

<p style="margin-left:29%;">This configuration requires
<b>stunnel</b> to be executed as root and without
<i>setuid</i> option.</p>

<p style="margin-left:29%; margin-top: 1em">This
configuration requires the following setup for iptables and
routing (possibly in /etc/rc.local or equivalent file):</p>

<pre style="margin-left:29%; margin-top: 1em">    iptables &minus;t mangle &minus;N DIVERT
    iptables &minus;t mangle &minus;A PREROUTING &minus;p tcp &minus;m socket &minus;j DIVERT
    iptables &minus;t mangle &minus;A DIVERT &minus;j MARK &minus;&minus;set&minus;mark 1
    iptables &minus;t mangle &minus;A DIVERT &minus;j ACCEPT
    ip rule add fwmark 1 lookup 100
    ip route add local 0.0.0.0/0 dev lo table 100
    echo 0 &gt;/proc/sys/net/ipv4/conf/lo/rp_filter</pre>


<p style="margin-left:29%; margin-top: 1em"><b>stunnel</b>
must also to be executed as root and without <i>setuid</i>
option.</p>

<p style="margin-left:23%;">Remote mode (<i>connect</i>
option) on <i>Linux 2.2.x</i></p>

<p style="margin-left:29%;">This configuration requires
kernel to be compiled with <i>transparent proxy</i> option.
Connected service must be installed on a separate host.
Routing towards the clients has to go through the
<b>stunnel</b> box.</p>

<p style="margin-left:29%; margin-top: 1em"><b>stunnel</b>
must also to be executed as root and without <i>setuid</i>
option.</p>

<p style="margin-left:23%;">Remote mode (<i>connect</i>
option) on <i>FreeBSD &gt;=8.0</i></p>

<p style="margin-left:29%;">This configuration requires
additional firewall and routing setup. <b>stunnel</b> must
also to be executed as root and without <i>setuid</i>
option.</p>

<p style="margin-left:23%;">Local mode (<i>exec</i>
option)</p>

<p style="margin-left:29%;">This configuration works by
pre-loading <i>libstunnel.so</i> shared library. _RLD_LIST
environment variable is used on Tru64, and
<small>LD_PRELOAD</small> variable on other platforms.</p>

<p style="margin-left:17%;"><i>destination</i></p>

<p style="margin-left:23%;">Original destination is used
instead of <i>connect</i> option.</p>

<p style="margin-left:23%; margin-top: 1em">A service
section for transparent destination may look like this:</p>

<pre style="margin-left:23%; margin-top: 1em">    [transparent]
    client=yes
    accept=&lt;stunnel_port&gt;
    transparent=destination</pre>


<p style="margin-left:23%; margin-top: 1em">This
configuration requires the following setup for iptables
(possibly in /etc/rc.local or equivalent file):</p>

<pre style="margin-left:23%; margin-top: 1em">    /sbin/iptables &minus;I INPUT &minus;i eth0 &minus;p tcp &minus;&minus;dport &lt;stunnel_port&gt; &minus;j ACCEPT
    /sbin/iptables &minus;t nat &minus;I PREROUTING &minus;i eth0 &minus;p tcp &minus;&minus;dport &lt;redirected_port&gt; &minus;j DNAT &minus;&minus;to&minus;destination &lt;local_ip&gt;:&lt;stunnel_port&gt;</pre>


<p style="margin-left:23%; margin-top: 1em">Transparent
destination option is currently only supported on Linux.</p>

<p style="margin-left:17%;"><i>both</i></p>

<p style="margin-left:23%;">Use both <i>source</i> and
<i>destination</i> transparent proxy.</p>

<p style="margin-left:17%; margin-top: 1em">Two legacy
options are also supported for backward compatibility:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><i>yes</i></p></td>
<td width="1%"></td>
<td width="62%">


<p>This options has been renamed to <i>source</i>.</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><i>no</i></p></td>
<td width="1%"></td>
<td width="62%">


<p>This options has been renamed to <i>none</i>.</p></td>
<td width="15%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>verify</b> = level</p>

<p style="margin-left:17%;">verify peer certificate <br>
level 0</p>

<p style="margin-left:23%;">Request and ignore peer
certificate.</p>

<p style="margin-left:17%;">level 1</p>

<p style="margin-left:23%;">Verify peer certificate if
present.</p>

<p style="margin-left:17%;">level 2</p>

<p style="margin-left:23%;">Verify peer certificate.</p>

<p style="margin-left:17%;">level 3</p>

<p style="margin-left:23%;">Verify peer with locally
installed certificate.</p>

<p style="margin-left:17%;">level 4</p>

<p style="margin-left:23%;">Ignore <small>CA</small> chain
and only verify peer certificate.</p>

<p style="margin-left:17%;">default</p>

<p style="margin-left:23%;">No verify.</p>

<p style="margin-left:17%; margin-top: 1em">It is important
to understand, that this option was solely designed for
access control and not for authorization. Specifically for
level 2 every non-revoked certificate is accepted regardless
of its Common Name. For this reason a dedicated
<small>CA</small> should be used with level 2, and not a
generic <small>CA</small> commonly used for webservers.
Level 3 is preferred for point-to-point connections.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>stunnel</b>
returns zero on success, non-zero on error.</p>

<h2>SIGNALS
<a name="SIGNALS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
signals can be used to control <b>stunnel</b> in Unix
environment: <small><br>
SIGHUP</small></p>

<p style="margin-left:17%;">Force a reload of the
configuration file.</p>

<p style="margin-left:17%; margin-top: 1em">Some global
options will not be reloaded:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="15%">


<p>chroot</p></td>
<td width="62%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="15%">


<p>foreground</p></td>
<td width="62%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="15%">


<p>pid</p></td>
<td width="62%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="15%">


<p>setgid</p></td>
<td width="62%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="15%">


<p>setuid</p></td>
<td width="62%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">The use of
&rsquo;setuid&rsquo; option will also prevent <b>stunnel</b>
from binding privileged (&lt;1024) ports during
configuration reloading.</p>

<p style="margin-left:17%; margin-top: 1em">When
&rsquo;chroot&rsquo; option is used, <b>stunnel</b> will
look for all its files (including configuration file,
certificates, log file and pid file) within the chroot
jail.</p>

<p style="margin-left:11%;"><small>SIGUSR1</small></p>

<p style="margin-left:17%;">Close and reopen <b>stunnel</b>
log file. This function can be used for log rotation.</p>

<p style="margin-left:11%;"><small>SIGTERM, SIGQUIT,
SIGINT</small></p>

<p style="margin-left:17%;">Shut <b>stunnel</b> down.</p>

<p style="margin-left:11%; margin-top: 1em">The result of
sending any other signals to the server is undefined.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">In order to
provide <small>SSL</small> encapsulation to your local
<i>imapd</i> service, use</p>

<pre style="margin-left:11%; margin-top: 1em">    [imapd]
    accept = 993
    exec = /usr/sbin/imapd
    execargs = imapd</pre>


<p style="margin-left:11%; margin-top: 1em">If you want to
provide tunneling to your <i>pppd</i> daemon on port 2020,
use something like</p>

<pre style="margin-left:11%; margin-top: 1em">    [vpn]
    accept = 2020
    exec = /usr/sbin/pppd
    execargs = pppd local
    pty = yes</pre>


<p style="margin-left:11%; margin-top: 1em">If you want to
use <b>stunnel</b> in <i>inetd</i> mode to launch your imapd
process, you&rsquo;d use this <i>stunnel.conf</i>. Note
there must be no <i>[service_name]</i> section.</p>

<pre style="margin-left:11%; margin-top: 1em">    exec = /usr/sbin/imapd
    execargs = imapd</pre>


<h2>NOTES
<a name="NOTES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b><small>RESTRICTIONS</small>
<br>
stunnel</b> cannot be used for the <small>FTP</small> daemon
because of the nature of the <small>FTP</small> protocol
which utilizes multiple ports for data transfers. There are
available <small>SSL</small> enabled versions of
<small>FTP</small> and telnet daemons, however.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>INETD
MODE</small></b> <br>
The most common use of <b>stunnel</b> is to listen on a
network port and establish communication with either a new
port via the connect option, or a new program via the
<i>exec</i> option. However there is a special case when you
wish to have some other program accept incoming connections
and launch <b>stunnel</b>, for example with <i>inetd</i>,
<i>xinetd</i>, or <i>tcpserver</i>.</p>

<p style="margin-left:11%; margin-top: 1em">For example, if
you have the following line in <i>inetd.conf</i>:</p>

<pre style="margin-left:11%; margin-top: 1em">    imaps stream tcp nowait root /usr/bin/stunnel stunnel /etc/stunnel/imaps.conf</pre>


<p style="margin-left:11%; margin-top: 1em">In these cases,
the <i>inetd</i>&minus;style program is responsible for
binding a network socket (<i>imaps</i> above) and handing it
to <b>stunnel</b> when a connection is received. Thus you do
not want <b>stunnel</b> to have any <i>accept</i> option.
All the <i>Service Level Options</i> should be placed in the
global options section, and no <i>[service_name]</i> section
will be present. See the <i><small>EXAMPLES</small></i>
section for example configurations.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>CERTIFICATES</small></b>
<br>
Each <small>SSL</small> enabled daemon needs to present a
valid X.509 certificate to the peer. It also needs a private
key to decrypt the incoming data. The easiest way to obtain
a certificate and a key is to generate them with the free
<b>OpenSSL</b> package. You can find more information on
certificates generation on pages listed below.</p>

<p style="margin-left:11%; margin-top: 1em">The order of
contents of the <i>.pem</i> file is important. It should
contain the unencrypted private key first, then a signed
certificate (not certificate request). There should be also
empty lines after certificate and private key. Plaintext
certificate information appended on the top of generated
certificate should be discarded. So the file should look
like this:</p>

<pre style="margin-left:11%; margin-top: 1em">    &minus;&minus;&minus;&minus;&minus;BEGIN RSA PRIVATE KEY&minus;&minus;&minus;&minus;&minus;
    [encoded key]
    &minus;&minus;&minus;&minus;&minus;END RSA PRIVATE KEY&minus;&minus;&minus;&minus;&minus;
    [empty line]
    &minus;&minus;&minus;&minus;&minus;BEGIN CERTIFICATE&minus;&minus;&minus;&minus;&minus;
    [encoded certificate]
    &minus;&minus;&minus;&minus;&minus;END CERTIFICATE&minus;&minus;&minus;&minus;&minus;
    [empty line]</pre>



<p style="margin-left:11%; margin-top: 1em"><b><small>RANDOMNESS</small>
<br>
stunnel</b> needs to seed the <small>PRNG</small> (pseudo
random number generator) in order for <small>SSL</small> to
use good randomness. The following sources are loaded in
order until sufficient random data has been gathered:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The file specified with the <i>RNDfile</i> flag.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The file specified by the <small>RANDFILE</small>
environment variable, if set.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The file .rnd in your home directory, if
<small>RANDFILE</small> not set.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The file specified with
&rsquo;&minus;&minus;with&minus;random&rsquo; at compile
time.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The contents of the screen if running on Windows.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The egd socket specified with the
<i><small>EGD</small></i> flag.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The egd socket specified with
&rsquo;&minus;&minus;with&minus;egd&minus;sock&rsquo; at
compile time.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The /dev/urandom device.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">With recent
(<b>OpenSSL 0.9.5a</b> or later) version of
<small>SSL</small> it will stop loading random data
automatically when sufficient entropy has been gathered.
With previous versions it will continue to gather from all
the above sources since no <small>SSL</small> function
exists to tell when enough data is available.</p>

<p style="margin-left:11%; margin-top: 1em">Note that on
Windows machines that do not have console user interaction
(mouse movements, creating windows, etc.) the screen
contents are not variable enough to be sufficient, and you
should provide a random file for use with the <i>RNDfile</i>
flag.</p>

<p style="margin-left:11%; margin-top: 1em">Note that the
file specified with the <i>RNDfile</i> flag should contain
random data -- that means it should contain different
information each time <b>stunnel</b> is run. This is handled
automatically unless the <i>RNDoverwrite</i> flag is used.
If you wish to update this file manually, the <i>openssl
rand</i> command in recent versions of <b>OpenSSL</b>, would
be useful.</p>

<p style="margin-left:11%; margin-top: 1em">Important note:
If /dev/urandom is available, <b>OpenSSL</b> often seeds the
<small>PRNG</small> with it while checking the random state.
On systems with /dev/urandom <b>OpenSSL</b> is likely to use
it even though it is listed at the very bottom of the list
above. This is the behaviour of <b>OpenSSL</b> and not
<b>stunnel</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b><small>DH
PARAMETERS</small></b> <br>
Stunnel 4.40 and later contains hardcoded 2048&minus;bit
<small>DH</small> parameters.</p>

<p style="margin-left:11%; margin-top: 1em">It is also
possible to specify <small>DH</small> parameters in the
certificate file:</p>

<pre style="margin-left:11%; margin-top: 1em">    openssl dhparam 2048 &gt;&gt; stunnel.pem</pre>



<p style="margin-left:11%; margin-top: 1em"><small>DH</small>
parameter generation may take several minutes.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>stunnel.conf</i></p>

<p style="margin-left:17%;"><b>stunnel</b> configuration
file</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Option
<i>execargs</i> and Win32 command line does not support
quoting.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>tcpd</i>(8)</p>

<p style="margin-left:17%;">access control facility for
internet services</p>

<p style="margin-left:11%;"><i>inetd</i>(8)</p>

<p style="margin-left:17%;">internet
&rsquo;super&minus;server&rsquo;</p>


<p style="margin-left:11%;"><i>http://www.stunnel.org/</i></p>

<p style="margin-left:17%;"><b>stunnel</b> homepage</p>


<p style="margin-left:11%;"><i>http://www.openssl.org/</i></p>

<p style="margin-left:17%;"><b>OpenSSL</b> project
website</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Micha&#322;
Trojnara</p>


<p style="margin-left:17%;">&lt;<i>Michal.Trojnara@mirt.net</i>&gt;</p>
<hr>
</body>
</html>
