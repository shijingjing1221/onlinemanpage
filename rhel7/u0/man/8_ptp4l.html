<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:16:03 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PTP4l</title>

</head>
<body>

<h1 align="center">PTP4l</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#CONFIGURATION FILE">CONFIGURATION FILE</a><br>
<a href="#PORT OPTIONS">PORT OPTIONS</a><br>
<a href="#PROGRAM AND CLOCK OPTIONS">PROGRAM AND CLOCK OPTIONS</a><br>
<a href="#TIME SCALE USAGE">TIME SCALE USAGE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ptp4l &minus;
PTP Boundary/Ordinary Clock</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>ptp4l</b> [
<b>&minus;AEP246HSLmqsv</b> ] [ <b>&minus;f</b>
<i>config</i> ] [ <b>&minus;p</b> <i>phc-device</i> ] [
<b>&minus;l</b> <i>print-level</i> ] [ <b>&minus;i</b>
<i>interface</i> ] <i>...</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>ptp4l</b></i>
is an implementation of the Precision Time Protocol (PTP)
according to IEEE standard 1588 for Linux. It implements
Boundary Clock (BC) and Ordinary Clock (OC).</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em"><b>&minus;A</b></p></td>
<td width="8%"></td>
<td width="78%">


<p style="margin-top: 1em">Select the delay mechanism
automatically. Start with E2E and switch to P2P when a peer
delay request is received.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;E</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the delay request-response (E2E) mechanism. This
is the default mechanism. All clocks on single PTP
communication path must use the same mechanism. A warning
will be printed when a peer delay request is received on
port using the E2E mechanism.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;P</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the peer delay (P2P) mechanism. A warning will be
printed when a delay request is received on port using the
P2P mechanism.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;2</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the IEEE 802.3 network transport.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;4</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the UDP IPv4 network transport. This is the
default transport.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;6</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the UDP IPv6 network transport.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;H</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the hardware time stamping. All ports specified
by the <b>&minus;i</b> option and in the configuration file
must be attached to the same PTP hardware clock (PHC). This
is the default time stamping.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;S</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the software time stamping.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;L</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Select the legacy hardware time stamping.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;f</b>
<i>config</i></p>

<p style="margin-left:22%;">Read configuration from the
specified file. No configuration file is read by
default.</p>

<p style="margin-left:11%;"><b>&minus;i</b>
<i>interface</i></p>

<p style="margin-left:22%;">Specify a PTP port, it may be
used multiple times. At least one port must be specified by
this option or in the configuration file.</p>

<p style="margin-left:11%;"><b>&minus;p</b>
<i>phc-device</i></p>

<p style="margin-left:22%;">With hardware time stamping,
force which PHC device (e.g. /dev/ptp0) should be used.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;s</b></p></td>
<td width="8%"></td>
<td width="40%">


<p>Enable the slaveOnly mode.</p></td>
<td width="38%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;l</b>
<i>print-level</i></p>

<p style="margin-left:22%;">Set the maximum syslog level of
messages which should be printed or sent to the system
logger. The default is 6 (LOG_INFO).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;m</b></p></td>
<td width="8%"></td>
<td width="63%">


<p>Print messages to the standard output.</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;q</b></p></td>
<td width="8%"></td>
<td width="63%">


<p>Don&rsquo;t send messages to the system logger.</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;v</b></p></td>
<td width="8%"></td>
<td width="63%">


<p>Prints the software version and exits.</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;h</b></p></td>
<td width="8%"></td>
<td width="63%">


<p>Display a help message.</p></td>
<td width="15%">
</td></tr>
</table>

<h2>CONFIGURATION FILE
<a name="CONFIGURATION FILE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
configuration file is divided into sections. Each section
starts with a line containing its name enclosed in brackets
and it follows with settings. Each setting is placed on a
separate line, it contains the name of the option and the
value separated by whitespace characters. Empty lines and
lines starting with # are ignored.</p>

<p style="margin-left:11%; margin-top: 1em">The global
section (indicated as <b>[global]</b>) sets the program
options, clock options and default port options. Other
sections are port specific sections and they override the
default port options. The name of the section is the name of
the configured port (e.g. <b>[eth0]</b>). Ports specified in
the configuration file don&rsquo;t need to be specified by
the <b>&minus;i</b> option. An empty port section can be
used to replace the command line option.</p>

<h2>PORT OPTIONS
<a name="PORT OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>delayAsymmetry</b></p>

<p style="margin-left:22%;">The time difference in
nanoseconds of the transmit and receive paths. This value
should be positive when the master-to-slave propagation time
is longer and negative when the slave-to-master time is
longer. The default is 0 nanoseconds.</p>

<p style="margin-left:11%;"><b>logAnnounceInterval</b></p>

<p style="margin-left:22%;">The mean time interval between
Announce messages. A shorter interval makes ptp4l react
faster to the changes in the master-slave hierarchy. The
interval should be the same in the whole domain. It&rsquo;s
specified as a power of two in seconds. The default is 1 (2
seconds).</p>

<p style="margin-left:11%;"><b>logSyncInterval</b></p>

<p style="margin-left:22%;">The mean time interval between
Sync messages. A shorter interval may improve accuracy of
the local clock. It&rsquo;s specified as a power of two in
seconds. The default is 0 (1 second).</p>


<p style="margin-left:11%;"><b>logMinDelayReqInterval</b></p>

<p style="margin-left:22%;">The minimum permitted mean time
interval between Delay_Req messages. A shorter interval
makes ptp4l react faster to the changes in the path delay.
It&rsquo;s specified as a power of two in seconds. The
default is 0 (1 second).</p>


<p style="margin-left:11%;"><b>logMinPdelayReqInterval</b></p>

<p style="margin-left:22%;">The minimum permitted mean time
interval between Pdelay_Req messages. It&rsquo;s specified
as a power of two in seconds. The default is 0 (1
second).</p>


<p style="margin-left:11%;"><b>announceReceiptTimeout</b></p>

<p style="margin-left:22%;">The number of missed Announce
messages before the last Announce messages expires. The
default is 3.</p>

<p style="margin-left:11%;"><b>transportSpecific</b></p>

<p style="margin-left:22%;">The transport specific field.
Must be in the range 0 to 255. The default is 0.</p>

<p style="margin-left:11%;"><b>path_trace_enabled</b></p>

<p style="margin-left:22%;">Enable the mechanism used to
trace the route of the Announce messages. The default is 0
(disabled).</p>

<p style="margin-left:11%;"><b>follow_up_info</b></p>

<p style="margin-left:22%;">Include the 802.1AS data in the
Follow_Up messages if enabled. The default is 0
(disabled).</p>


<p style="margin-left:11%;"><b>fault_reset_interval</b></p>

<p style="margin-left:22%;">The time in seconds between the
detection of a port&rsquo;s fault and the fault being reset.
This value is expressed as a power of two. Setting this
value to -128 or to the special key word &quot;ASAP&quot;
will let the fault be reset immediately. The default is 4
(16 seconds).</p>


<p style="margin-left:11%;"><b>fault_badpeernet_interval</b></p>

<p style="margin-left:22%;">The time in seconds between the
detection of a peer network misconfiguration and the fault
being reset. The port is disabled for the duration of the
interval. The value is in seconds and the special key word
ASAP will let the fault be reset immediately. The default is
16 seconds.</p>

<p style="margin-left:11%;"><b>delay_mechanism</b></p>

<p style="margin-left:22%;">Select the delay mechanism.
Possible values are E2E, P2P and Auto. The default is
E2E.</p>

<p style="margin-left:11%;"><b>network_transport</b></p>

<p style="margin-left:22%;">Select the network transport.
Possible values are UDPv4, UDPv6 and L2. The default is
UDPv4.</p>


<p style="margin-left:11%;"><b>neighborPropDelayThresh</b></p>

<p style="margin-left:22%;">Upper limit for peer delay in
nanoseconds. If the estimated peer delay is greater than
this value the port is marked as not 802.1AS capable.</p>

<h2>PROGRAM AND CLOCK OPTIONS
<a name="PROGRAM AND CLOCK OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>twoStepFlag</b></p>

<p style="margin-left:22%;">Enable two-step mode for sync
messages. One-step mode can be used only with hardware time
stamping. The default is 1 (enabled).</p>

<p style="margin-left:11%;"><b>slaveOnly</b></p>

<p style="margin-left:22%;">The local clock is a slave-only
clock if enabled. The default is 0 (disabled).</p>

<p style="margin-left:11%;"><b>priority1</b></p>

<p style="margin-left:22%;">The priority1 attribute of the
local clock. It is used in the best master selection
algorithm, lower values take precedence. Must be in the
range 0 to 255. The default is 128.</p>

<p style="margin-left:11%;"><b>priority2</b></p>

<p style="margin-left:22%;">The priority2 attribute of the
local clock. It is used in the best master selection
algorithm, lower values take precedence. Must be in the
range 0 to 255. The default is 128.</p>

<p style="margin-left:11%;"><b>clockClass</b></p>

<p style="margin-left:22%;">The clockClass attribute of the
local clock. It denotes the traceability of the time
distributed by the grandmaster clock. The default is
248.</p>

<p style="margin-left:11%;"><b>clockAccuracy</b></p>

<p style="margin-left:22%;">The clockAccuracy attribute of
the local clock. It is used in the best master selection
algorithm. The default is 0xFE.</p>


<p style="margin-left:11%;"><b>offsetScaledLogVariance</b></p>

<p style="margin-left:22%;">The offsetScaledLogVariance
attribute of the local clock. It characterizes the stability
of the clock. The default is 0xFFFF.</p>

<p style="margin-left:11%;"><b>domainNumber</b></p>

<p style="margin-left:22%;">The domain attribute of the
local clock. The default is 0.</p>

<p style="margin-left:11%;"><b>free_running</b></p>

<p style="margin-left:22%;">Don&rsquo;t adjust the local
clock if enabled. The default is 0 (disabled).</p>

<p style="margin-left:11%;"><b>freq_est_interval</b></p>

<p style="margin-left:22%;">The time interval over which is
estimated the ratio of the local and peer clock frequencies.
It is specified as a power of two in seconds. The default is
1 (2 seconds).</p>

<p style="margin-left:11%;"><b>assume_two_step</b></p>

<p style="margin-left:22%;">Treat one-step responses as
two-step if enabled. It is used to work around buggy 802.1AS
switches. The default is 0 (disabled).</p>


<p style="margin-left:11%;"><b>tx_timestamp_timeout</b></p>

<p style="margin-left:22%;">The number of milliseconds to
poll waiting for the tx time stamp from the kernel when a
message has recently been sent. The default is 1.</p>

<p style="margin-left:11%;"><b>clock_servo</b></p>

<p style="margin-left:22%;">The servo which is used to
synchronize the local clock. Currently only one servo is
implemented, a PI controller. The default is pi.</p>


<p style="margin-left:11%;"><b>pi_proportional_const</b></p>

<p style="margin-left:22%;">The proportional constant of
the PI controller. When set to 0.0, the proportional
constant will be set by the following formula from the
current sync interval. The default is 0.0.</p>

<p style="margin-left:22%; margin-top: 1em">kp =
min(kp_scale * sync^kp_exponent, kp_norm_max / sync))</p>

<p style="margin-left:11%;"><b>pi_integral_const</b></p>

<p style="margin-left:22%;">The integral constant of the PI
controller. When set to 0.0, the integral constant will be
set by the following formula from the current sync interval.
The default is 0.0.</p>

<p style="margin-left:22%; margin-top: 1em">ki =
min(ki_scale * sync^ki_exponent, ki_norm_max / sync)</p>


<p style="margin-left:11%;"><b>pi_proportional_scale</b></p>

<p style="margin-left:22%;">The kp_scale constant in the
formula used to set the proportional constant of the PI
controller from the sync interval. When set to 0.0, the
value will be selected from 0.7 and 0.1 for the hardware and
software time stamping respectively. The default is 0.0.</p>


<p style="margin-left:11%;"><b>pi_proportional_exponent</b></p>

<p style="margin-left:22%;">The kp_exponent constant in the
formula used to set the proportional constant of the PI
controller from the sync interval. The default is -0.3.</p>


<p style="margin-left:11%;"><b>pi_proportional_norm_max</b></p>

<p style="margin-left:22%;">The kp_norm_max constant in the
formula used to set the proportional constant of the PI
controller from the sync interval. The default is 0.7</p>

<p style="margin-left:11%;"><b>pi_integral_scale</b></p>

<p style="margin-left:22%;">The ki_scale constant in the
formula used to set the integral constant of the PI
controller from the sync interval. When set to 0.0, the
value will be selected from 0.3 and 0.001 for the hardware
and software time stamping respectively. The default is
0.0.</p>


<p style="margin-left:11%;"><b>pi_integral_exponent</b></p>

<p style="margin-left:22%;">The ki_exponent constant in the
formula used to set the integral constant of the PI
controller from the sync interval. The default is 0.4.</p>


<p style="margin-left:11%;"><b>pi_integral_norm_max</b></p>

<p style="margin-left:22%;">The ki_norm_max constant in the
formula used to set the integral constant of the PI
controller from the sync interval. The default is 0.3.</p>

<p style="margin-left:11%;"><b>pi_offset_const</b></p>

<p style="margin-left:22%;">The maximum offset the PI
controller will correct by changing the clock frequency
instead of stepping the clock. When set to 0.0, the
controller will never step the clock except on start. The
default is 0.0.</p>

<p style="margin-left:11%;"><b>pi_f_offset_const</b></p>

<p style="margin-left:22%;">The maximum offset the PI
controller will correct by changing the clock frequency
instead of stepping the clock. This is only applied on the
first update. When set to 0.0, the controller won&rsquo;t
step the clock on start. The default is 0.0000001 (100
nanoseconds).</p>

<p style="margin-left:11%;"><b>pi_max_frequency</b></p>

<p style="margin-left:22%;">The maximum allowed frequency
adjustment of the clock in parts per billion (ppb). This is
an additional limit to the maximum allowed by the hardware.
When set to 0, the hardware limit will be used. The default
is 900000000 (90%).</p>

<p style="margin-left:11%;"><b>ptp_dst_mac</b></p>

<p style="margin-left:22%;">The MAC address where should be
PTP messages sent. Relevant only with L2 transport. The
default is 01:1B:19:00:00:00.</p>

<p style="margin-left:11%;"><b>p2p_dst_mac</b></p>

<p style="margin-left:22%;">The MAC address where should be
peer delay messages the PTP peer. Relevant only with L2
transport. The default is 01:80:C2:00:00:0E.</p>

<p style="margin-left:11%;"><b>udp6_scope</b></p>

<p style="margin-left:22%;">Specifies the desired scope for
the IPv6 multicast messages. This will be used as the second
byte of the primary address. This option is only relevant
with IPv6 transport. See RFC 4291. The default is 0x0E for
the global scope.</p>

<p style="margin-left:11%;"><b>logging_level</b></p>

<p style="margin-left:22%;">The maximum logging level of
messages which should be printed. The default is 6
(LOG_INFO).</p>

<p style="margin-left:11%;"><b>verbose</b></p>

<p style="margin-left:22%;">Print messages to the standard
output if enabled. The default is 0 (disabled).</p>

<p style="margin-left:11%;"><b>use_syslog</b></p>

<p style="margin-left:22%;">Print messages to the system
log if enabled. The default is 1 (enabled).</p>

<p style="margin-left:11%;"><b>summary_interval</b></p>

<p style="margin-left:22%;">The time interval in which are
printed summary statistics of the clock. It is specified as
a power of two in seconds. The statistics include offset
root mean square (RMS), maximum absolute offset, frequency
offset mean and standard deviation, and path delay mean and
standard deviation. The units are nanoseconds and parts per
billion (ppb). If there is only one clock update in the
interval, the sample will be printed instead of the
statistics. The messages are printed at the LOG_INFO level.
The default is 0 (1 second).</p>

<p style="margin-left:11%;"><b>time_stamping</b></p>

<p style="margin-left:22%;">The time stamping method. The
allowed values are hardware, software and legacy. The
default is hardware.</p>

<p style="margin-left:11%;"><b>productDescription</b></p>

<p style="margin-left:22%;">The product description string.
Allowed values must be of the form
manufacturerName;modelNumber;instanceIdentifier and contain
at most 64 utf8 symbols. The default is &quot;;;&quot;.</p>

<p style="margin-left:11%;"><b>revisionData</b></p>

<p style="margin-left:22%;">The revision description string
which contains the revisions for node hardware (HW),
firmware (FW), and software (SW). Allowed values are of the
form HW;FW;SW and contain at most 32 utf8 symbols. The
default is an &quot;;;&quot;.</p>

<p style="margin-left:11%;"><b>userDescription</b></p>

<p style="margin-left:22%;">The user description string.
Allowed values are of the form name;location and contain at
most 128 utf8 symbols. The default is an empty string.</p>


<p style="margin-left:11%;"><b>manufacturerIdentity</b></p>

<p style="margin-left:22%;">The manufacturer id which
should be an OUI owned by the manufacturer. The default is
00:00:00.</p>

<p style="margin-left:11%;"><b>kernel_leap</b></p>

<p style="margin-left:22%;">When a leap second is
announced, let the kernel apply it by stepping the clock
instead of correcting the one-second offset with servo,
which would correct the one-second offset slowly by changing
the clock frequency (unless the <b>pi_offset_const</b>
option is set to correct such offset by stepping). Relevant
only with software time stamping. The default is 1
(enabled).</p>

<p style="margin-left:11%;"><b>timeSource</b></p>

<p style="margin-left:22%;">The time source is a single
byte code that gives an idea of the kind of local clock in
use. The value is purely informational, having no effect on
the outcome of the Best Master Clock algorithm, and is
advertised when the clock becomes grand master.</p>

<h2>TIME SCALE USAGE
<a name="TIME SCALE USAGE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>ptp4l</b> as
domain master either uses PTP or UTC time scale depending on
time stamping mode. In software and legacy time stamping
modes it announces Arbitrary time scale mode, which is
effectively UTC here, in hardware time stamping mode it
announces use of PTP time scale.</p>

<p style="margin-left:11%; margin-top: 1em">When
<b>ptp4l</b> is the domain master using hardware time
stamping, it is up to <b>phc2sys</b> to maintain the correct
offset between UTC and PTP times. See <b>phc2sys</b>(8)
manual page for more details.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>pmc</b>(8),
<b>phc2sys</b>(8)</p>
<hr>
</body>
</html>
