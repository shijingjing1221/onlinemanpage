<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:08:43 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>netlabelctl</title>

</head>
<body>

<h1 align="center">netlabelctl</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">netlabelctl
&minus; NetLabel management utility</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>netlabelctl</b>
[&lt;global_flags&gt;] &lt;module&gt;
[&lt;module_commands&gt;]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The NetLabel
management utility, netlabelctl, is a command line program
designed to allow system administrators to configure the
NetLabel system in the kernel. The utility is based around
different &quot;modules&quot; which correspond to the
different types of NetLabel commands supported by the
kernel.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Global
Flags</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;h</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>Help message</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;p</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>Attempt to make the output human readable or
&quot;pretty&quot;</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;t
&lt;seconds&gt;</b></p>

<p style="margin-left:18%;">Set a timeout to be used when
waiting for the NetLabel subsystem to respond</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;v</b></p></td>
<td width="4%"></td>
<td width="48%">


<p>Enable extra output</p></td>
<td width="34%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;V</b></p></td>
<td width="4%"></td>
<td width="48%">


<p>Display the version information</p></td>
<td width="34%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Modules and
Commands</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p style="margin-top: 1em"><b>mgmt</b></p></td>
<td width="83%">
</td></tr>
</table>

<p style="margin-left:11%;">The management module is used
to perform general queries about the NetLabel subsystem
within the kernel. The different commands and their syntax
are listed below.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p style="margin-top: 1em"><i>version</i></p></td>
<td width="78%">
</td></tr>
</table>

<p style="margin-left:22%;">Display the kernel&rsquo;s
NetLabel management protocol version.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p style="margin-top: 1em"><i>protocols</i></p></td>
<td width="75%">
</td></tr>
</table>

<p style="margin-left:22%;">Display the kernel&rsquo;s list
of supported labeling protocols.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p style="margin-top: 1em"><b>map</b></p></td>
<td width="85%">
</td></tr>
</table>

<p style="margin-left:11%;">The domain mapping module is
used to map different NetLabel labeling protocols to either
individual LSM domains or the default domain mapping. It is
up to each LSM to determine what defines a domain. With
SELinux, the normal SELinux domain should be used, i.e.
&quot;ping_t&quot;. In addition to protocol selection based
only on the LSM domain, it is also possible to select the
labeling protocol based on both the LSM domain and
destination address. The network address selectors can
specify either single hosts or entire networks and work for
both IPv4 and IPv6, although the labeling protocol chosen
must support the IP version chosen. When specifying the
labeling protocol to use for each mapping there is an
optional &quot;extra&quot; field which is used to further
identify the specific labeling protocol configuration. When
specifying the unlabeled protocol, &quot;unlbl&quot;, there
is no extra identification needed. When specifying the
CIPSO/IPv4 protocol, &quot;cipsov4&quot;, the DOI value
should be specified; see the EXAMPLES section for details.
The different commands and their syntax are listed
below.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><i>add
default|domain:&lt;domain&gt;
[address:&lt;ADDR&gt;[/&lt;MASK&gt;]]
protocol:&lt;protocol&gt;[,&lt;extra&gt;]</i></p> </td></tr>
</table>

<p style="margin-left:22%;">Add a new LSM domain / network
address to NetLabel protocol mapping.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p style="margin-top: 1em"><i>del
default|domain:&lt;domain&gt;</i></p> </td>
<td width="48%">
</td></tr>
</table>

<p style="margin-left:22%;">Delete an existing LSM domain
to NetLabel protocol mapping.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p style="margin-top: 1em"><i>list</i></p></td>
<td width="83%">
</td></tr>
</table>

<p style="margin-left:22%;">Display all of the configured
LSM domain to NetLabel protocol mappings.</p>

<p style="margin-left:11%;"><b>unlbl</b></p>

<p style="margin-left:11%; margin-top: 1em">The unlabeled
(unlbl) module controls the unlabeled protocol which is used
both when labeling outgoing traffic is not desired as well
as when unlabeled traffic is received by the system. This
module allows administrators to block all unlabeled packets
from the system through the &quot;accept&quot; flag and
assign static, or fallback, security labels to unlabeled
traffic based on the inbound network interface and source
address.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="20%">


<p style="margin-top: 1em"><i>accept on|off</i></p></td>
<td width="69%">
</td></tr>
</table>

<p style="margin-left:22%;">Toggle the unlabeled traffic
accept flag.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><i>add
default|interface:&lt;dev&gt;
address:&lt;addr&gt;[/&lt;mask&gt;]
label:&lt;label&gt;</i></p> </td></tr>
</table>

<p style="margin-left:22%;">Add a new static/fallback
entry.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="78%">


<p style="margin-top: 1em"><i>del
default|interface:&lt;dev&gt;
address:&lt;addr&gt;[/&lt;mask&gt;]</i></p> </td>
<td width="11%">
</td></tr>
</table>

<p style="margin-left:22%;">Delete an existing
static/fallback entry.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p style="margin-top: 1em"><i>list</i></p></td>
<td width="83%">
</td></tr>
</table>

<p style="margin-left:22%;">Display the status of the
unlabeled accept flag.</p>

<p style="margin-left:11%;"><b>cipsov4</b></p>

<p style="margin-left:11%; margin-top: 1em">The CIPSO/IPv4
(cipsov4) module controls the CIPSO/IPv4 labeling engine in
the kernel. The CIPSO/IPv4 engine provided by NetLabel
supports multiple Domains Of Interpretation (DOI) and the
CIPSO/IPv4 module allows for different configurations for
each DOI. At present there are three types of
configurations, the &quot;trans&quot; configuration which
allows on&minus;the&minus;fly translation of MLS sensitivity
labels, the &quot;pass&quot; configuration which does not
perform any translation of the MLS sensitivity label and the
&quot;local&quot; configuration which conveys the full LSM
security label over localhost/loopback connections.
Regardless of which configuration type is chosen a DOI value
must be specified and if the &quot;trans&quot; or
&quot;pass&quot; configurations are specified then a list of
the CIPSO/IPv4 tag types to use when generating the
CIPSO/IPv4 packet labels must also be specified. The list of
CIPSO/IPv4 tags is ordered such that when possible the first
tag type listed is used when a CIPSO/IPv4 label is
generated. However, if it is not possible to use the first
tag type then each tag type is checked, in order, until a
suitable tag type is found. If a valid tag type can not be
found then the operation causing the CIPSO/IPv4 label will
fail, typically this occurs whenever a new socket is
created. The different commands and their syntax are listed
below.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><i>add trans doi:&lt;DOI&gt;
tags:&lt;T1&gt;,&lt;Tn&gt;
levels:&lt;LL1&gt;=&lt;RL1&gt;,&lt;LLn&gt;=&lt;RLn&gt;
categories:&lt;LC1&gt;=&lt;RC1&gt;,&lt;LCn&gt;=&lt;RCn&gt;</i></p> </td></tr>
</table>

<p style="margin-left:22%;">Add a new CIPSO/IPv4
configuration using the standard/translated mapping with the
given level and category translations. The levels are
translated in such a way that the local level
&quot;LLn&quot; is translated to the remote,
on&minus;the&minus;wire level of &quot;RLn&quot;; the
reverse translation is done for incoming packets. The same
translation is done for the categories using &quot;LCn&quot;
and &quot;RCn&quot;. In order for a packet to be accepted,
or a socket created by an application, there must be a
translation for the sensitivity level and all the categories
present in the MLS sensitivity label; if the entire
requested sensitivity label can not be translated the
application will fail.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="51%">


<p style="margin-top: 1em"><i>add pass doi:&lt;DOI&gt;
tags:&lt;T1&gt;,&lt;Tn&gt;</i></p> </td>
<td width="38%">
</td></tr>
</table>

<p style="margin-left:22%;">Add a new CIPSO/IPv4
configuration without any level or category
translations.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="29%">


<p style="margin-top: 1em"><i>add local
doi:&lt;DOI&gt;</i></p> </td>
<td width="60%">
</td></tr>
</table>

<p style="margin-left:22%;">Add a new CIPSO/IPv4
configuration for localhost/loopback connections.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="20%">


<p style="margin-top: 1em"><i>del doi:&lt;DOI&gt;</i></p></td>
<td width="69%">
</td></tr>
</table>

<p style="margin-left:22%;">Delete an existing CIPSO/IPv4
configuration with the given DOI value. If any LSM domain
mappings are present which make use of this DOI they will
also be deleted.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="24%">


<p style="margin-top: 1em"><i>list
[doi:&lt;DOI&gt;]</i></p> </td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:22%;">Display a list of all the
CIPSO/IPv4 configurations or just the configuration matching
the optionally specified DOI.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Returns zero on
success, errno values on failure.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>netlabelctl
cipsov4 add pass doi:16 tags:1</i></p>

<p style="margin-left:18%;">Add a CIPSO/IPv4 configuration
with a DOI value of &quot;16&quot;, using CIPSO tag
&quot;1&quot; (the permissive bitmap tag). The CIPSO and LSM
levels/categories are passed through the NetLabel subsystem
without any translation.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><i>netlabelctl cipsov4 add trans
doi:8 tags:1 levels:0=0,1=1 categories:0=1,1=0</i></p></td></tr>
</table>

<p style="margin-left:18%;">Add a CIPSO/IPv4 configuration
with a DOI value of &quot;8&quot;, using CIPSO tag
&quot;1&quot; (the permissive bitmap tag). The specified
mapping converts local LSM levels &quot;0&quot; and
&quot;1&quot; to CIPSO levels &quot;0&quot; and
&quot;1&quot; respectively while local LSM categories
&quot;0&quot; and &quot;1&quot; are mapped to CIPSO
categories &quot;1&quot; and &quot;0&quot; respectively.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p style="margin-top: 1em"><i>netlabelctl &minus;p cipsov4
list</i></p> </td>
<td width="48%">
</td></tr>
</table>

<p style="margin-left:18%;">Display all of the CIPSO/IPv4
configurations in a human readable format.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="52%">


<p style="margin-top: 1em"><i>netlabelctl &minus;p cipsov4
list doi:16</i></p></td>
<td width="37%">
</td></tr>
</table>

<p style="margin-left:18%;">Display specific information
about the CIPSO/IPv4 DOI 16 configuration.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="44%">


<p style="margin-top: 1em"><i>netlabelctl cipsov4 del
doi:8</i></p> </td>
<td width="45%">
</td></tr>
</table>

<p style="margin-left:18%;">Delete the CIPSO/IPv4
configuration assigned to DOI 8. In addition to removing the
CIPSO/IPv4 configuration any domain mappings using this
configuration will also be removed.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="86%">


<p style="margin-top: 1em"><i>netlabelctl map add
domain:lsm_domain protocol:cipsov4,8</i></p></td>
<td width="3%">
</td></tr>
</table>

<p style="margin-left:18%;">Add a domain mapping so that
all outgoing packets sent from the &quot;lsm_domain&quot;
will be labeled according to the CIPSO/IPv4 protocol using
DOI 8.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><i>netlabelctl map add
domain:lsm_domain address:192.168.1.0/24
protocol:cipsov4,8</i></p> </td></tr>
</table>

<p style="margin-left:18%;">Add a mapping so that all
outgoing packets sent from the &quot;lsm_domain&quot; to the
192.168.1.0/24 network will be labeled according to the
CIPSO/IPv4 protocol using DOI 8.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="35%">


<p style="margin-top: 1em"><i>netlabelctl &minus;p map
list</i></p> </td>
<td width="54%">
</td></tr>
</table>

<p style="margin-left:18%;">Display all of the domain
mappings in a human readable format.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="51%">


<p style="margin-top: 1em"><i>netlabelctl del
domain:lsm_domain</i></p> </td>
<td width="38%">
</td></tr>
</table>

<p style="margin-left:18%;">Delete the domain mapping for
the &quot;lsm_domain&quot;, packets sent from the
&quot;lsm_domain&quot; will fallback to the default NetLabel
mapping.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="86%">


<p style="margin-top: 1em"><i>netlabelctl unlbl add
interface:lo address:::1 label:foo</i></p></td>
<td width="3%">
</td></tr>
</table>

<p style="margin-left:18%;">Add a static/fallback label to
assign the &quot;foo&quot; security label to unlabeled
packets entering the system over the &quot;lo&quot;
(loopback) interface with an IPv6 source address of
&quot;::1&quot; (localhost).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><i>netlabelctl unlbl add default
address:192.168.0.0/16 label:bar</i></p></td></tr>
</table>

<p style="margin-left:18%;">Add a static/fallback label to
assign the &quot;bar&quot; security label to unlabeled
packets entering the system over any interface with an IPv4
source address in the 192.168.0.0/16 network.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The NetLabel
subsystem is supported on Linux Kernels version 2.6.19 and
later. The static, or fallback, labels are only supported on
Linux Kernels version 2.6.25 and later. The domain mapping
address selectors are only supported on Linux Kernels 2.6.28
and later.</p>

<p style="margin-left:11%; margin-top: 1em">The NetLabel
project site, with more information including the source
code repository, can be found at http://netlabel.sf.net.
This program is currently under development, please report
any bugs at the project site or directly to the author.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Paul Moore
&lt;paul@paul-moore.com&gt;</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>netlabel-config</b>(8)</p>
<hr>
</body>
</html>
