<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:00:25 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IPTSTATE</title>

</head>
<body>

<h1 align="center">IPTSTATE</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#COMMAND&minus;LINE OPTIONS">COMMAND&minus;LINE OPTIONS</a><br>
<a href="#INTERACTIVE OPTIONS">INTERACTIVE OPTIONS</a><br>
<a href="#SCROLLING AND PADS">SCROLLING AND PADS</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#BUG REPORTS">BUG REPORTS</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>iptstate</b>
&minus; A top-like display of IP Tables state table
entries</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>iptstate</b>
[&lt;<b>options</b>&gt;]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>iptstate</b>
displays information held in the IP Tables state table in
real-time in a top-like format. Output can be sorted by any
field, or any field reversed. Users can choose to have the
output only print once and exit, rather than the top-like
system. Refresh rate is configurable, IPs can be resolved to
names, output can be formatted, the display can be filtered,
and color coding are among some of the many features.</p>

<h2>COMMAND&minus;LINE OPTIONS
<a name="COMMAND&minus;LINE OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>-c,
--no-color</b></p>

<p style="margin-left:22%;">Toggle color-code by
protocol</p>

<p style="margin-left:11%;"><b>-C, --counters</b></p>

<p style="margin-left:22%;">Toggle display of bytes/packets
counters</p>

<p style="margin-left:11%;"><b>-d, --dst-filter</b>
<i>IP</i></p>

<p style="margin-left:22%;">Only show states with a
destination of <i>IP</i> Note, that this must be an IP,
hostname matching is not yet supported.</p>

<p style="margin-left:11%;"><b>-D --dstpt-filter</b>
<i>port</i></p>

<p style="margin-left:22%;">Only show states with a
destination port of <i>port</i></p>

<p style="margin-left:11%;"><b>-h, --help</b></p>

<p style="margin-left:22%;">Show help message</p>

<p style="margin-left:11%;"><b>-l, --lookup</b></p>

<p style="margin-left:22%;">Show hostnames instead of IP
addresses</p>

<p style="margin-left:11%;"><b>-m, --mark-truncated</b></p>

<p style="margin-left:22%;">Mark truncated hostnames with a
&rsquo;+&rsquo;</p>

<p style="margin-left:11%;"><b>-o, --no-dynamic</b></p>

<p style="margin-left:22%;">Toggle dynamic formatting</p>

<p style="margin-left:11%;"><b>-L, --no-dns</b></p>

<p style="margin-left:22%;">Skip outgoing DNS lookup
states</p>

<p style="margin-left:11%;"><b>-f, --no-loopback</b></p>

<p style="margin-left:22%;">Filter states on loopback</p>

<p style="margin-left:11%;"><b>-p, --no-scroll</b></p>

<p style="margin-left:22%;">No scrolling (don&rsquo;t use a
&quot;pad&quot;). See <b>SCROLLING AND PADS</b> for more
information.</p>

<p style="margin-left:11%;"><b>-r, --reverse</b></p>

<p style="margin-left:22%;">Reverse sort order</p>

<p style="margin-left:11%;"><b>-R, --rate</b>
<i>seconds</i></p>

<p style="margin-left:22%;">Refresh rate, followed by rate
in <i>seconds</i>. Note that this is for statetop mode, and
not applicable for single-run mode
(&minus;&minus;single).</p>

<p style="margin-left:11%;"><b>-1, --single</b></p>

<p style="margin-left:22%;">Single run (no curses)</p>

<p style="margin-left:11%;"><b>-b, --sort</b>
<i>column</i></p>

<p style="margin-left:22%;">This determines what column to
sort by. Options:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>S</b> Source Port</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>d</b> Destination IP (or Name)</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>D</b> Destination Port</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>p</b> Protocol</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>s</b> State</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>t</b> TTL</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>b</b> Bytes</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>P</b> Packets</p></td></tr>
</table>

<p style="margin-left:22%;">To sort by Source IP (or Name),
don&rsquo;t use &minus;b. Sorting by bytes/packets is only
available for kernels that support it, and only when
compiled against libnetfilter_conntrack (the default).</p>

<p style="margin-left:11%;"><b>-s, --src-filter</b>
<i>IP</i></p>

<p style="margin-left:22%;">Only show states with a source
of <i>IP</i>. Note, that this must be an IP, hostname
matching is not yet supported.</p>

<p style="margin-left:11%;"><b>-S, --srcpt-filter</b>
<i>port</i></p>

<p style="margin-left:22%;">Only show states with a source
port of <i>port</i></p>

<p style="margin-left:11%;"><b>-t, --totals</b></p>

<p style="margin-left:22%;">Toggle display of totals</p>

<h2>INTERACTIVE OPTIONS
<a name="INTERACTIVE OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">As of version
2.0, all command-line options are now available
interactively using the same key as the short-option. For
example, <b>--sort</b> is also <b>-b</b>, so while
<b>iptstate</b> is running, hitting <b>b</b> will change the
sorting to the next column. Similarly, <b>t</b> toggles the
display of totals, and so on.</p>

<p style="margin-left:11%; margin-top: 1em">There are also
extra interactive options: <b>B</b> - change sorting to
previous column (opposite of <b>b</b>); <b>q</b> - quit; and
<b>x</b> - delete the currently highlighted state from the
netfilter conntrack table.</p>

<p style="margin-left:11%; margin-top: 1em">Additionally,
the following keys are used to navigate within
<b>iptstate</b>: <b><br>
Up</b> or <b>j</b> - Move up one line <b><br>
Down</b> or <b>k</b> - Move down one line <b><br>
Left</b> or <b>h</b> - Move left one column <b><br>
Right</b> or <b>l</b> - Move right one column <b><br>
PageUp</b> or <b>^u</b> - Move up one page <b><br>
PageDown</b> or <b>^d</b> - Move down one page <b><br>
Home</b> - Go to the top <b><br>
End</b> - Go to the end</p>

<p style="margin-left:11%; margin-top: 1em">In many cases,
<b>iptstate</b> needs to prompt you in order to change
something. For example, if you want to set or change the
source-ip filter, when you hit <b>s</b>, <b>iptstate</b>
will pop up a prompt at the top of the window to ask you
what you want to set it to.</p>

<p style="margin-left:11%; margin-top: 1em">Note that like
many UNIX applications, ctrl-G will tell <b>iptstate</b>
&quot;nevermind&quot; - it&rsquo;ll remove the prompt and
forget you ever hit <b>s</b>.</p>

<p style="margin-left:11%; margin-top: 1em">In most cases,
a blank response means &quot;clear&quot; - clear the source
IP filter, for example.</p>

<p style="margin-left:11%; margin-top: 1em">At anytime
while <b>iptstate</b> is running, you can hit <b>h</b> to
get to the <b>interactive help</b> which will display all
the current settings to you as well give you a list of all
interactive commands available.</p>

<p style="margin-left:11%; margin-top: 1em">While running,
<b>space</b> will immediately update the display.
<b>Iptstate</b> should gracefully handle all window resizes,
but if it doesn&rsquo;t, you can force it to re-calculate
and re-draw the screen with a <b>ctrl-L</b>.</p>

<h2>SCROLLING AND PADS
<a name="SCROLLING AND PADS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For almost any
user, there is no reason to turn off scrolling. The ability
to turn this off - and especially the ability to toggle this
interactively - is done more for theoretical completeness
than anything else. <br>
But, nonetheless, here are the details. Typically in a
curses <br>
application you create a &quot;window.&quot; Windows
don&rsquo;t scroll, however. They <br>
are, at most, the size of your terminal. Windows provide
<br>
double-buffering to make refreshing as fast and seemless as
possible. <br>
However, to enable scrolling, one has to use
&quot;pads&quot; instead of windows. <br>
Pads can be bigger than the current terminal. Then all
necessary data <br>
is written to the pad, and &quot;scrolling&quot; becomes a
function of just <br>
showing the right part of that pad on the screen. <br>
However, pads do not have the double-buffering feature that
windows <br>
have. Thus, there _might_ be some case where for some user
using some <br>
very strange machine, having scrolling enabled could cause
poor <br>
refreshing. Given the nature of the way <b>iptstate</b> uses
the screen <br>
though, I find this highly unlikely. In addition, the
scrolling method <br>
uses a little more memory. However, <b>iptstate</b> is not a
memory intensive <br>
application, so this shouldn&rsquo;t be a problem even on
low-memory systems. <br>
Nonetheless, if this does negatively affect you, the option
to turn it <br>
off is there.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Anything other
than 0 indicates and error. A list of current exit statuses
are below:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p><b>0</b></p></td>
<td width="10%"></td>
<td width="75%">


<p>Success</p></td>
<td width="3%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p><b>1</b></p></td>
<td width="10%"></td>
<td width="75%">


<p>Bad command-line arguments</p></td>
<td width="3%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p><b>2</b></p></td>
<td width="10%"></td>
<td width="75%">


<p>Error communicating with the netfilter subsystem.</p></td>
<td width="3%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p><b>3</b></p></td>
<td width="10%"></td>
<td width="75%">


<p>Terminal too narrow</p></td>
<td width="3%">
</td></tr>
</table>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">We don&rsquo;t
support filtering on resolved names, and we don&rsquo;t
support filtering on networks. IPv6 support is new and the
dynamic formatting doesn&rsquo;t yet always handle IPv6
addresses as well as it should.</p>

<h2>BUG REPORTS
<a name="BUG REPORTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">All bugs should
be reported to Phil Dibowitz &lt;phil AT ipom DOT com&gt;.
Please see the <b>README</b> and <b>BUGS</b> for more
information on bug reports. Please read the <b>WISHLIST</b>
before sending in features you hope to see.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>iptstate</b>
does a lot of work to try to fit everything on the screen in
an easy-to-read way. However, in some cases, hostnames may
need to be truncated (in lookup mode). Similarly, IPv6
addresses may need to be truncated. The truncation of names
happens from the right for source because you most likely
know your own domain name, and from the left for destination
because knowing your users are connection to
&quot;mail.a.&quot; doesn&rsquo;t help much. However, for
addresses, this is reversed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>iptstate</b>
does not automatically handle window-resizes while in the
<b>interactive help</b> screen. If you do resize while in
this window, you should return to the main window, hit
<b>ctrl-L</b> to re-calculate and re-draw the screen, and
then, if you choose, return to the <b>interactive
help</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>iptstate</b>
currently uses libnetfilter_conntrack to access the
netfilter connection state table. However, older versions
read out of /proc/net/ip_conntrack, and the current version
can still be compiled to do this. This deprecated method can
be racy on SMP systems, and can hurt performance on very
heavily loaded firewalls. This deprecated method should be
avoided - support will be removed in future versions.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>iptables</b>(8)</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>iptstate</b>
was written by Phil Dibowitz &lt;phil AT ipom DOT com&gt;
<br>
 http://www.phildev.net/iptstate/</p>
<hr>
</body>
</html>
