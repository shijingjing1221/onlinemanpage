<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:24:05 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SNMPUSM</title>

</head>
<body>

<h1 align="center">SNMPUSM</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#CREATING USERS">CREATING USERS</a><br>
<a href="#DELETING USERS">DELETING USERS</a><br>
<a href="#CHANGING PASS PHRASES">CHANGING PASS PHRASES</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#WARNING">WARNING</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">snmpusm -
creates and maintains SNMPv3 users on a network entity</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] [&minus;Cw] AGENT <b>create</b> USER
[CLONEFROM-USER] <b><br>
snmpusm</b> [COMMON OPTIONS] AGENT <b>delete</b> USER
<b><br>
snmpusm</b> [COMMON OPTIONS] AGENT <b>cloneFrom</b> USER
CLONEFROM-USER <b><br>
snmpusm</b> [COMMON OPTIONS] [&minus;Ca] [&minus;Cx] AGENT
<b>passwd</b> OLD-PASSPHRASE NEW-PASSPHRASE [USER] <b><br>
snmpusm</b> [COMMON OPTIONS] &lt;&minus;Ca | &minus;Cx&gt;
&minus;Ck AGENT <b>passwd</b> OLD-KEY-OR-PASSPHRASE
NEW-KEY-OR-PASSPHRASE [USER] <b><br>
snmpusm</b> [COMMON OPTIONS] [&minus;Ca] [&minus;Cx] AGENT
<b>changekey</b> [USER]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>snmpusm</b>
is an SNMP application that can be used to do simple
maintenance on the users known to an SNMP agent, by
manipulating the agent&rsquo;s User-based Security Module
(USM) table. The user needs write access to the usmUserTable
MIB table. This tool can be used to create, delete, clone,
and change the passphrase of users configured on a running
SNMP agent.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Common options
for all <b>snmpusm</b> commands: <b><br>
&minus;CE</b> <i>ENGINE-ID</i></p>

<p style="margin-left:22%;">Set usmUserEngineID to be used
as part of the index of the usmUserTable. Default is to use
the contextEngineID (set via &minus;E or probed) as the
usmUserEngineID.</p>

<p style="margin-left:11%;"><b>&minus;Cp</b>
<i>STRING</i></p>

<p style="margin-left:22%;">Set the usmUserPublic value of
the (new) user to the specified STRING.</p>

<p style="margin-left:11%; margin-top: 1em">Options for the
<b>passwd</b> and <b>changekey</b> commands:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>&minus;Ca</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Change the authentication key.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>&minus;Cx</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Change the privacy key.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>&minus;Ck</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Allows one to use localized key (must start with 0x)
instead of passphrase. When this option is used, either the
&minus;Ca or &minus;Cx option (but not both) must also be
used.</p> </td></tr>
</table>

<h2>CREATING USERS
<a name="CREATING USERS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">An
unauthenticated SNMPv3 user can be created using the
command</p>

<p style="margin-left:22%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] AGENT create USER</p>

<p style="margin-left:11%; margin-top: 1em">This constructs
an (inactive) entry in the usmUserTable, with no
authentication or privacy settings. In principle, this user
should be useable for &rsquo;noAuthNoPriv&rsquo; requests,
but in practise the Net-SNMP agent will not allow such an
entry to be made active. The user can be created via the
createAndWait operation instead by using the &minus;Ca flag.
This will prevent the user from being marked as active in
any agent until explicitly activated later via the activate
command.</p>

<p style="margin-left:11%; margin-top: 1em">In order to
activate this entry, it is necessary to &quot;clone&quot; an
existing user, using the command</p>

<p style="margin-left:22%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] AGENT cloneFrom USER CLONEFROM-USER</p>

<p style="margin-left:11%; margin-top: 1em">The USER entry
then inherits the same authentication and privacy settings
(including pass phrases) as the CLONEFROM user.</p>

<p style="margin-left:11%; margin-top: 1em">These two steps
can be combined into one, by using the command</p>

<p style="margin-left:22%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] AGENT create USER CLONEFROM-USER</p>

<p style="margin-left:11%; margin-top: 1em">The two forms
of the <b>create</b> sub-command require that the user being
created does not already exist. The <b>cloneFrom</b>
sub-command requires that the user being cloned to
<i>does</i> already exist.</p>

<p style="margin-left:11%; margin-top: 1em">Cloning is the
only way to specify which authentication and privacy
protocols to use for a given user, and it is only possible
to do this once. Subsequent attempts to reclone onto the
same user will appear to succeed, but will be silently
ignored. This (somewhat unexpected) behaviour is mandated by
the SNMPv3 USM specifications (RFC 3414). To change the
authentication and privacy settings for a given user, it is
necessary to delete and recreate the user entry. This is
<i>not</i> necessary for simply changing the pass phrases
(see below). This means that the agent must be initialized
with at least one user for each combination of
authentication and privacy protocols. See the
<i>snmpd.conf(5)</i> manual page for details of the
<b>createUser</b> configuration directive.</p>

<h2>DELETING USERS
<a name="DELETING USERS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A user can be
deleted from the usmUserTable using the command</p>

<p style="margin-left:22%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] AGENT delete USER</p>

<h2>CHANGING PASS PHRASES
<a name="CHANGING PASS PHRASES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">User profiles
contain private keys that are never transmitted over the
wire in clear text (regardless of whether the administration
requests are encrypted or not). To change the secret key for
a user, it is necessary to specify the user&rsquo;s old
passphrase as well as the new one. This uses the command</p>

<p style="margin-left:22%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] [&minus;Ca] [&minus;Cx] AGENT passwd
OLD-PASSPHRASE NEW-PASSPHRASE [USER]</p>

<p style="margin-left:11%; margin-top: 1em">After cloning a
new user entry from the appropriate template, you should
immediately change the new user&rsquo;s passphrase.</p>

<p style="margin-left:11%; margin-top: 1em">If USER is not
specified, this command will change the passphrase of the
(SNMPv3) user issuing the command. If the &minus;Ca or
&minus;Cx options are specified, then only the
authentication or privacy keys are changed. If these options
are not specified, then both the authentication and privacy
keys are changed.</p>

<p style="margin-left:22%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] [&minus;Ca] [&minus;Cx] AGENT changekey
[USER]</p>

<p style="margin-left:11%; margin-top: 1em">This command
changes the key in a perfect-forward-secrecy compliant way
through a diffie-helman exchange. The remote agent must
support the SNMP&minus;USM&minus;DH&minus;OBJECTS&minus;MIB
for this command to work. The resulting keys are printed to
the console and may be then set in future command
invocations using the &minus;&minus;defAuthLocalizedKey and
&minus;&minus;defPrivLocalizedKey options or in your
snmp.conf file using the defAuthLocalizedKey and
defPrivLocalizedKey keywords.</p>

<p style="margin-left:11%; margin-top: 1em">Note that since
these keys are randomly generated based on a diffie helman
exchange, they are no longer derived from a more easily
typed password. They are, however, much more secure.</p>

<p style="margin-left:11%; margin-top: 1em">To change from
a localized key back to a password, the following variant of
the <b>passwd</b> sub-command is used:</p>

<p style="margin-left:22%; margin-top: 1em"><b>snmpusm</b>
[COMMON OPTIONS] &lt;&minus;Ca | &minus;Cx&gt; &minus;Ck
AGENT passwd OLD-KEY-OR-PASSPHRASE NEW-KEY-OR-PASSPHRASE
[USER]</p>

<p style="margin-left:11%; margin-top: 1em">Either the
&minus;Ca or the &minus;Cx option must be specified. The
OLD-KEY-OR-PASSPHRASE and/or NEW-KEY-OR-PASSPHRASE arguments
can either be a passphrase or a localized key starting with
&quot;0x&quot;, e.g. as printed out by the <b>changekey</b>
sub-command.</p>

<p style="margin-left:11%; margin-top: 1em">Note that
<b>snmpusm</b> REQUIRES an argument specifying the agent to
query as described in the .I snmpcmd(1) manual page.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Let&rsquo;s
assume for our examples that the following VACM and USM
configurations lines were in the snmpd.conf file for a
Net-SNMP agent. These lines set up a default user called
&quot;initial&quot; with the authentication passphrase
&quot;setup_passphrase&quot; so that we can perform the
initial setup of an agent:</p>

<p style="margin-left:22%; margin-top: 1em"># VACM
configuration entries <br>
rwuser initial <br>
# lets add the new user we&rsquo;ll create too: <br>
rwuser wes <br>
# USM configuration entries <br>
createUser initial MD5 setup_passphrase DES</p>

<p style="margin-left:11%; margin-top: 1em">Note: the
&quot;initial&quot; user&rsquo;s setup should be removed
after creating a real user that you grant administrative
privileges to (like the user &quot;wes&quot; we&rsquo;ll be
creating in this example.</p>

<p style="margin-left:11%; margin-top: 1em">Note:
passphrases must be 8 characters <i>minimum</i> in
length.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Create a new
user</b> <br>
snmpusm &minus;v3 &minus;u initial &minus;n &quot;&quot;
&minus;l authNoPriv &minus;a MD5 &minus;A setup_passphrase
localhost create wes initial</p>

<p style="margin-left:22%; margin-top: 1em">Creates a new
user, here named &quot;wes&quot; using the user
&quot;initial&quot; to do it. &quot;wes&quot; is cloned from
&quot;initial&quot; in the process, so he inherits that
user&rsquo;s passphrase (&quot;setup_passphrase&quot;).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Change the
user&rsquo;s passphrase</b> <br>
snmpusm &minus;v 3 &minus;u wes &minus;n &quot;&quot;
&minus;l authNoPriv &minus;a MD5 &minus;A setup_passphrase
localhost passwd setup_passphrase new_passphrase</p>

<p style="margin-left:22%; margin-top: 1em">After creating
the user &quot;wes&quot; with the same passphrase as the
&quot;initial&quot; user, we need to change his passphrase
for him. The above command changes it from
&quot;setup_passphrase&quot;, which was inherited from the
initial user, to &quot;new_passphrase&quot;.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Test the new
user</b> <br>
snmpget &minus;v 3 &minus;u wes &minus;n &quot;&quot;
&minus;l authNoPriv &minus;a MD5 &minus;A new_passphrase
localhost sysUpTime.0</p>

<p style="margin-left:22%; margin-top: 1em">If the above
commands were successful, this command should have properly
performed an authenticated SNMPv3 GET request to the
agent.</p>

<p style="margin-left:11%; margin-top: 1em">Now, go remove
the vacm &quot;group&quot; snmpd.conf entry for the
&quot;initial&quot; user and you have a valid user
&rsquo;wes&rsquo; that you can use for future transactions
instead of initial.</p>

<h2>WARNING
<a name="WARNING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Manipulating
the usmUserTable using this command can <i>only</i> be done
using SNMPv3. This command will not work with the
community-based versions, even if they have write access to
the table.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">snmpd.conf(5),
snmp.conf(5), RFC 3414</p>
<hr>
</body>
</html>
