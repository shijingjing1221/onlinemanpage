<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 01:30:16 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>AMANDA&minus;DEVICES</title>

</head>
<body>

<h1 align="center">AMANDA&minus;DEVICES</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#SPECIFYING DEVICES">SPECIFYING DEVICES</a><br>
<a href="#PROPERTIES">PROPERTIES</a><br>
<a href="#DEVICES">DEVICES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">amanda-devices
&minus; Configuring and Using Amanda Devices</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The Device API
specifies a generic interface between Amanda and storage
devices such as tapes or disks. This manual page describes
the device drivers included with Amanda.</p>

<p style="margin-left:11%; margin-top: 1em">This is a
<i>user&minus;level</i> description of the API, and does not
address details that are only of concern to developers. For
that purpose, consult the Amanda source code and
http://wiki.zmanda.com.</p>

<p style="margin-left:11%; margin-top: 1em">The term
&quot;device driver&quot; describes the software that can
communicate with some kind of backend storage, e.g., a tape
driver. A &quot;device&quot; is the storage element itself,
usually a piece of hardware. When discussing a device and
its driver as a unit, the term &quot;device&quot; is
sometimes also used to refer to the combination of device
and driver.</p>

<h2>SPECIFYING DEVICES
<a name="SPECIFYING DEVICES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Device names
take the form <i>TYPE:NODE</i>, where <i>TYPE</i> selects a
device driver, and <i>NODE</i> provides further information
to that driver. The syntax for each device driver is given
in the corresponding section below.</p>

<p style="margin-left:11%; margin-top: 1em">Devices can be
described in <b>amanda.conf</b>(5) with &quot;device&quot;
sections, e.g.,</p>

<p style="margin-left:11%; margin-top: 1em">define device
top_drive { <br>
tapedev &quot;tape:/dev/nst0&quot; <br>
device&minus;property &quot;BLOCK_SIZE&quot;
&quot;131072&quot; <br>
} <br>
Such a device defininition creates a device
&quot;alias&quot;, in this case named <i>top_drive</i>,
which can then be named in the global <i>tapedev</i> or
<i>tpchanger</i> parameter:</p>

<p style="margin-left:11%; margin-top: 1em">tapedev
&quot;top_drive&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The global
<i>tapedev</i> parameter can also specify a literal device
name. For example,</p>

<p style="margin-left:11%; margin-top: 1em">tapedev
&quot;file:/amdisks&quot; <br>
is equivalent to</p>

<p style="margin-left:11%; margin-top: 1em">tapedev
&quot;default&quot; <br>
define device default { <br>
tapedev &quot;file:/amdisks&quot; <br>
} <br>
Note that, in both cases, the specified devices are actually
accessed through the <i>chg&minus;single</i> changer driver;
see <b>amanda-changers</b>(7) for more information.</p>

<p style="margin-left:11%; margin-top: 1em">Device
properties specified outside of any device definition apply
to all devices. This syntax is provided mainly for backward
compatibility, and for simple Amanda configurations. Note
that there is no way to provide properties specific to a
device without defining a device alias.</p>

<p style="margin-left:11%; margin-top: 1em">See
<b>amanda-changers</b>(7) for details on how devices are
configured, and in particular on how device properties are
specified. See <b>amanda.conf</b>(5) for more information on
Amanda configuration in general.</p>


<p style="margin-left:17%; margin-top: 1em"><b><big>Note</big></b>
<br>
There is no way to reset a device property to its default
value.</p>

<h2>PROPERTIES
<a name="PROPERTIES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Device drivers
use <i>properties</i> as a generic means to interact with
other parts of Amanda. Some properties are set by the device
driver and used by Amanda to determine how its devices
should be used. Other properties can be set by Amanda or by
the user to influence the driver's behavior. Properties are
set for a particular device, so that if you have two tape
devices, they will not share property values.</p>

<p style="margin-left:11%; margin-top: 1em">Properties are
specified in <i>amanda.conf</i> with the
<i>device&minus;property</i> parameter. The syntax looks
like this:</p>


<p style="margin-left:11%; margin-top: 1em">device&minus;property
&quot;FROBNICATOR_PATH&quot; &quot;/var/frobd/state&quot;
<br>
device&minus;property &quot;BYTES_PER_FORTNIGHT&quot;
&quot;128k&quot; <br>
device&minus;property &quot;USE_QUBITS&quot;
&quot;no&quot;</p>

<p style="margin-left:11%; margin-top: 1em">Both the
property name and the property value are always quoted.
Property names, like Amanda configuration parameters, are
not case&minus;sensitive, and &minus; (dash) and _
(underscore) may be used interchangeably. String values are
given as simple strings, like FROBNICATOR_PATH in the
example above. Integer values can be specified with any of
the suffixes given in the &quot;VALUE SUFFIXES&quot; section
of <b>amanda.conf</b>(5), like BYTES_PER_FORTNIGHT, above.
Boolean values can be specified using the same names as in
<b>amanda.conf</b>(5), like USE_QUBITS, above. Some
properties have special formats, as described below.</p>

<p style="margin-left:11%; margin-top: 1em">Some properties
are set based on other configuration values, such as
tapetype parameters. These special cases are detailed under
the appropriate property, below.</p>

<p style="margin-left:11%; margin-top: 1em">The order in
which device properties are set is as follows:</p>

<p style="margin-left:17%; margin-top: 1em">1. Tapetype
parameters (including length, blocksize, and readblocksize)
are translated into device properties and set
accordingly.</p>

<p style="margin-left:17%; margin-top: 1em">2. Device
properties from any device&minus;property configuration
parameters are set, in the order they appear in the
configuration file.</p>

<p style="margin-left:11%; margin-top: 1em">Properties
described as read&minus;only are not accessible to users.
They are listed here for completeness.</p>

<p style="margin-left:11%; margin-top: 1em"><b>COMMON
PROPERTIES</b> <br>
Note that some of these properties are currently unused, and
present only for future expansion. Not all devices implement
all of these properties.</p>

<p style="margin-left:11%; margin-top: 1em">APPENDABLE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This boolean property indicates whether this device supports
appending data to volumes.</p>

<p style="margin-left:11%; margin-top: 1em">BLOCK_SIZE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property gives the block size, in bytes, that will be
used to write to the device. The usual suffixes
(&quot;kbytes&quot;, etc.) are allowed. The tapetype
parameter <i>blocksize</i> sets this property.</p>


<p style="margin-left:11%; margin-top: 1em">CANONICAL_NAME</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property contains the full canonical name for this
device. This name may not be the same as the
user&minus;supplied name, but is a valid name by which to
access this device.</p>

<p style="margin-left:11%; margin-top: 1em">COMMENT</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This string property is entirely for the user's convenience.
It is supported by all devices, but no device interprets its
value in any way.</p>


<p style="margin-left:11%; margin-top: 1em">COMPRESSION</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property represents the compression status of
the device, and can be used to enable and disable such
compression. This applies mostly to tape devices, although
many tape devices do not support setting compression from
software.</p>


<p style="margin-left:11%; margin-top: 1em">COMPRESSION_RATE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property gives the compression rate, as a decimal
ratio. It may be a measured value over some unspecified
period or a simple estimate.</p>


<p style="margin-left:11%; margin-top: 1em">CONCURRENCY</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property indicates the level of concurrent access that
this device supports.</p>


<p style="margin-left:11%; margin-top: 1em">FULL_DELETION</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property indicates whether the device supports erasing
the entire volume. Aside from S3 and VFS, most devices
cannot support this feature.</p>

<p style="margin-left:11%; margin-top: 1em">LEOM</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
If this property is true, then the device can detect an EOM
condition before actually running out of space, allowing
Amanda to forgo caching parts while writing. For some
devices, it is necessary to override the conservative
default value of this property.</p>


<p style="margin-left:11%; margin-top: 1em">MAX_BLOCK_SIZE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property gives the maximum block size this device can
support. See BLOCK SIZES, below.</p>


<p style="margin-left:11%; margin-top: 1em">MEDIUM_ACCESS_TYPE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property gives the type of the media in the device:
read only, WORM (Write Once, Read Many), read/write, or
write only. Write&minus;only devices do not support
recovery, but the data are not necessarily thrown out.</p>


<p style="margin-left:11%; margin-top: 1em">MIN_BLOCK_SIZE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property gives the minimum block size this device can
support. See BLOCK SIZES, below.</p>


<p style="margin-left:11%; margin-top: 1em">MAX_VOLUME_USAGE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
On devices that support it, this property will limit the
total amount of data written to a volume; attempts to write
beyond this point will cause the device to simulate
&quot;out of space.&quot; Zero means no limit. The tapetype
parameter <i>length</i> sets this property.</p>


<p style="margin-left:11%; margin-top: 1em">ENFORCE_MAX_VOLUME_USAGE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
If this property is false, limit set by MAX_VOLUME_USAGE
property (and thus the tapetype LENGTH parameter) will not
be verified while writing to device, allowing the volume to
expand without limit. If this property is true, then
MAX_VOLUME_USAGE willbe enforced, limiting the total size of
the volume. This property is not available on all devices;
see below.</p>


<p style="margin-left:11%; margin-top: 1em">PARTIAL_DELETION</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property indicates whether the device supports deletion
of specific files. Aside from linear tapes and S3, most
devices can support this feature. It is currently unused by
Amanda.</p>

<p style="margin-left:11%; margin-top: 1em">STREAMING</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;only)
This property gives the streaming requirement for this
device. For example, tape drives often require a steady
supply of data to avoid shoe&minus;shining, while disk
devices have no such requirement. Streaming is accomplished
by buffering
<b>device&minus;output&minus;buffer&minus;size</b> bytes of
data. The allowed values are &quot;none&quot; (no streaming
buffer necessary), &quot;required&quot; (fill the buffer
before starting to write), or &quot;desired&quot; (fill the
buffer before starting to write, and if the buffer becomes
empty, stop writing until it is completely full again).</p>

<p style="margin-left:11%; margin-top: 1em">VERBOSE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
If this boolean property is set, then the device will
produce verbose debugging output. This property is not
recognized by most devices.</p>

<p style="margin-left:11%; margin-top: 1em"><b>BLOCK
SIZES</b> <br>
Amanda writes device data in blocks. On most devices the
block boundaries are embedded in the media along with the
data itself, so subsequent reads must use the same block
sizes. On tape devices, the block size is dictated by the
capabilities of the hardware &minus;&minus; buffer sizes,
physical format, and so on.</p>

<p style="margin-left:11%; margin-top: 1em">Amanda has
historically supported a single, fixed block size
&minus;&minus; usually 32k. The Device API adds the ability
to specify a block size at runtime, using the BLOCK_SIZE
property. Devices provide MIN_BLOCK_SIZE and MAX_BLOCK_SIZE
as a guide to the range of acceptable block sizes. Note that
this does not imply that all sizes in the range
MIN_BLOCK_SIZE &minus; MAX_BLOCK_SIZE are available
&minus;&minus; the device may require that block sizes are
even multiples of some power of two, for example. Consult
the documentation for your hardware and operating system for
more information.</p>

<p style="margin-left:11%; margin-top: 1em">Most devices
are flexible enough to read a volume using a different block
size than that with which it was written. This can be useful
when handling old volumes written with a smaller blocksize,
or volumes of unknown blocksize. Unfortunately, some tape
devices do not detect oversized blocks correctly, and may
lose data if the configured block size is smaller than the
volume's block size. The tape device driver has a
READ_BLOCK_SIZE property which specifies the minimum buffer
size that will be allocated for reads from tape. If the
hardware supports it, setting this property allows Amanda to
correctly read from tapes written with any blocksize less
than or equal to READ_BLOCK_SIZE.</p>


<p style="margin-left:17%; margin-top: 1em"><b><big>Note</big></b>
<br>
The RAIT device does not support flexible block sizes, as
its parity algorithm requires that all child devices have
the same, fixed block size.</p>

<p style="margin-left:11%; margin-top: 1em"><b>LEOM
DETECTION</b> <br>
Some Amanda devices can detect end&minus;of&minus;medium
(running out of space on the device) before it occurs. This
early warning is referred to as logical EOM, and where it is
supported Amanda can operate more efficiently, since the
possibility for data loss is reduced.</p>

<p style="margin-left:11%; margin-top: 1em">The boolean
LEOM property indicates whether or not a particular device
supports LEOM detection. The sections below also describe
the degree of support.</p>

<h2>DEVICES
<a name="DEVICES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This section
lists the device drivers included with Amanda, and basic
instructions for using them. For complete How&minus;To
information, consult the Amanda wiki at
http://wiki.zmanda.com.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Null
Device</b> <br>
tapedev &quot;null:&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The null device
driver only supports writing, and discards all data. It is
generally only useful for testing purposes.</p>

<p style="margin-left:11%; margin-top: 1em"><b>RAIT
Device</b> <br>
tapedev &quot;rait:tape:/dev/rmt/tps0d{4,5,6}n&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The RAIT device
driver mirrors or stripes data over multiple
&quot;child&quot; devices. The child devices are specified
using a shell&minus;like syntax, where alternatives are
enclosed in braces and separated by commas. Braces and
commas can be escaped with a backslash. Note that the
backslash itself must be escaped in most contexts. For
example:</p>

<p style="margin-left:11%; margin-top: 1em">tapedev
&quot;rait:{file:/var/amanda/vtapes,tape:/dev/nst0}&quot;
<br>
tapedev
&quot;rait:{comma&minus;dev:foo\\,bar,brace&minus;dev:foo\\}bar}&quot;
# quoting <br>
If the braces contain a numeric range separated with two
dots, that range will be filled in sequentially. If the
first number has a leading zero, then the results will be
zero&minus;padded to the maximum length. For example:</p>

<p style="margin-left:11%; margin-top: 1em">tapedev
&quot;rait:file:/var/amanda/vtapes/drive{01..04}&quot;</p>

<p style="margin-left:11%; margin-top: 1em">With two child
devices, the RAIT device driver mirrors data such that the
two devices contain identical data and can be used singly
for recovery. With more than two devices, the RAIT device
&quot;stripes&quot; data across all but one device and
writes a parity block to the final device, usable for data
recovery in the event of a device or volume failure. The
RAIT device scales its blocksize as necessary to match the
number of children that will be used to store data.</p>

<p style="margin-left:11%; margin-top: 1em">When a child
device is known to have failed, the RAIT device should be
reconfigured to replace that device with the text
&quot;ERROR&quot;, e.g.,</p>

<p style="margin-left:11%; margin-top: 1em">tapedev
&quot;rait:{tape:/dev/st0,ERROR,tape:/dev/st2}&quot; <br>
This will cause the RAIT device to start up in degraded
mode, reconstructing the data from the missing device.</p>

<p style="margin-left:11%; margin-top: 1em">Like ordinary
RAID drivers, the RAIT device driver can automatically enter
degraded mode when one of its child devices fails. However,
the RAIT device cannot automatically recover from any write
error nor write any data in degraded mode. When reading,
certain errors may be fatal (rather than causing degraded
mode). And in any case, labels on all volumes must initially
match (labeled or otherwise). If you have lost one volume
from a set, explicitly start the device in degraded mode as
described above.</p>

<p style="margin-left:11%; margin-top: 1em">This device can
detect LEOM if and only if all of the child devices can
detect LEOM.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Child Device
Block Sizes</b> <br>
The RAIT device driver requires that all of its child
devices use the same block size. If no block sizes are
specified, the driver selects the block size closest to 32k
that is within the MIN_BLOCK_SIZE &minus; MAX_BLOCK_SIZE
range of all child devices, and calculates its own blocksize
according to the formula <i>rait_blocksize = child_blocksize
* (num_children &minus; 1)</i>. If a block size is specified
for the RAIT device, then it calculates its child block
sizes according to the formula <i>child_blocksize =
rait_blocksize / (num_children &minus; 1)</i>. Either way,
it sets the BLOCK_SIZE property of each child device
accordingly.</p>

<p style="margin-left:11%; margin-top: 1em"><b>S3
Device</b> <br>
tapedev
&quot;s3:foocorp&minus;backups/DailySet1&minus;&quot; <br>
device&minus;property &quot;S3_ACCESS_KEY&quot;
&quot;MYACCESSKEY&quot; <br>
device&minus;property &quot;S3_SECRET_KEY&quot;
&quot;MYSECRETKEY&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The S3 device
driver uploads data to the Amazon S3 &quot;storage
cloud&quot;. Its device name is a slash&minus;sparated
combination of bucket name and prefix:
&quot;s3:BUCKET/PREFIX&quot;. Since buckets must be unique
across all Amazon S3 users, and since the number of buckets
allowed to each user is limited, the driver can store
multiple Amanda volumes in a single S3 bucket, distinguished
by prefix. The prefix and slash can be omitted if they are
not needed: &quot;s3:BUCKET&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">The access and
secret keys used to authenticate to Amazon S3 are provided
as properties.</p>

<p style="margin-left:11%; margin-top: 1em">The S3 device
driver stores each block in a distinct S3 object. Due to
high HTTP overhead for each request, use of larger than
normal block sizes (&gt; 1 megabyte) is recommended with the
S3 device.</p>

<p style="margin-left:11%; margin-top: 1em">Amanda
automatically creates a bucket when writing, if the bucket
doesn't already exist. At that time, it specifies where
Amazon should store the data based on the S3_BUCKET_LOCATION
property. If this property is not set, Amazon's default
value (equivalent to &quot;*&quot;) is used. The bucket
location has both billing and legal concerns, so you are
encouraged to consult Amazon's documentation for
details.</p>

<p style="margin-left:11%; margin-top: 1em">Amazon does not
permit changes to bucket locations, so this is a permanent
specification. If the bucket already exists and the property
is set, then Amanda checks the property against the location
of the bucket, and produces an error if they do not
match.</p>


<p style="margin-left:17%; margin-top: 1em"><b><big>Note</big></b>
<br>
If a location constraint is set, the bucket name must
consist only of lower&minus;case letters, numbers, dashes,
and dots.</p>

<p style="margin-left:11%; margin-top: 1em">This driver
supports the VERBOSE property, but use it carefully
&minus;&minus; it produces a great deal of output, and may
cause spurious failures by filling your debug log partition.
Its logging is generally only useful for developers chasing
down a problem in communications with Amazon's servers.</p>

<p style="margin-left:11%; margin-top: 1em">Since Amazon
storage is unlimited, the device never encounteres EOM, so
LEOM detection is trivially enabled for this device.</p>

<p style="margin-left:11%; margin-top: 1em">This driver
supports the ENFORCE_MAX_VOLUME_USAGE property. Default
value is false. See COMMON_PROPERTIES, above.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Device-Specific
Properties</b> <br>
In addition to the common properties, the S3 device supports
the properties listed in this section.</p>

<p style="margin-left:11%; margin-top: 1em">Most Amanda
devices work just fine without any properties, but not the
S3 device. A typical S3 configuration will have an access
key and secret key specified:</p>


<p style="margin-left:11%; margin-top: 1em">device&minus;property
&quot;S3_ACCESS_KEY&quot;
&quot;27D3B8C6C4E7AA423C2B37C72A0D22C8&quot; <br>
device&minus;property &quot;S3_SECRET_KEY&quot;
&quot;agphc2Q7Zmxragphc2RmO2xragpzZGY7a2xqCgr&quot;</p>

<p style="margin-left:11%; margin-top: 1em">CLIENT_ID</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The client_id for oauth2.</p>


<p style="margin-left:11%; margin-top: 1em">CLIENT_SECRET</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The client_secret for oauth2.</p>


<p style="margin-left:11%; margin-top: 1em">CREATE&minus;BUCKET</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Default: yes. If amanda create/delete the bucket.</p>


<p style="margin-left:11%; margin-top: 1em">REFRESH_TOKEN</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The refresh&minus;token for oauth2.</p>


<p style="margin-left:11%; margin-top: 1em">MAX_RECV_SPEED</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Maximum speed, in bytes per second, that this device will
receive data from S3. If the average speed exceeds this
value, the device will stop reading long enough to bring the
average below this value.</p>


<p style="margin-left:11%; margin-top: 1em">MAX_SEND_SPEED</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Maximum speed, in bytes per second, that this device will
send data to S3. If the average speed exceeds this value,
the device will stop writing long enough to bring the
average below this value.</p>


<p style="margin-left:11%; margin-top: 1em">S3_MULTI_DELETE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
If the server support the multi delete protocol (only Amazon
S3), default is &quot;YES&quot;. If it fail, it revert to
single delete.</p>


<p style="margin-left:11%; margin-top: 1em">NB_THREADS_BACKUP</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The number of thread that send data to the s3 device, higher
value can provide more throutput.</p>


<p style="margin-left:11%; margin-top: 1em">NB_THREADS_RECOVERY</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The number of thread that read data from the s3 device,
higher value can provide more throutput.</p>


<p style="margin-left:11%; margin-top: 1em">OPENSTACK_SWIFT_API</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Deprecated, set &quot;STORAGE_API to
&quot;SWIFT&minus;1.0&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">PROXY</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The proxy hostname or IP in the format
&quot;host[:port]&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">PASSWORD</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The password (for swift v2).</p>


<p style="margin-left:11%; margin-top: 1em">PROJECT&minus;ID</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The projectid (for google).</p>


<p style="margin-left:11%; margin-top: 1em">REUSE&minus;CONNECTION</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Default: YES. Set it to &quot;NO&quot; if reusing a
connection cause some bug, this is sometime the case with
big block size.</p>


<p style="margin-left:11%; margin-top: 1em">S3_ACCESS_KEY</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property gives the Amazon S3 access key used to access
the service.</p>


<p style="margin-left:11%; margin-top: 1em">S3_BUCKET_LOCATION</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Location constraint for buckets on Amazon S3. As of this
writing, it can be set to &quot;*&quot; (US Standard, i.e.
lowest&minus;latency choice of US East or West),
&quot;us&minus;west&minus;1&quot; (US West, Northern
California), &quot;EU&quot; (European Union), or
&quot;ap&minus;southeast&minus;1&quot; (Asia Pacific). See :
http://docs.amazonwebservices.com/general/latest/gr/index.html?rande.html
for the most up&minus;to&minus;date list.</p>


<p style="margin-left:11%; margin-top: 1em">SSL_CA_INFO</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Path to CA certificate to use to verify the identity of the
S3 server. Only applicable when SSL/TLS is in use. The
certificate should be in PEM format if OpenSSL or GnuTLS is
being used with libcurl. Multiple certificates can be
bundled together simply by concatenating them. If NSS is
being used, then it is the directory that the database
resides in. The value is passed to curl_easy_setopt(3) as
CURLOPT_CAINFO.</p>

<p style="margin-left:11%; margin-top: 1em">S3_HOST</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The host name to connect, in the form
&quot;hostname:port&quot; or &quot;ip:port&quot;, default is
&quot;s3.amazonaws.com&quot;</p>


<p style="margin-left:11%; margin-top: 1em">S3_SECRET_KEY</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property gives the Amazon S3 secret key used to access
the service.</p>


<p style="margin-left:11%; margin-top: 1em">S3_SERVER_SIDE_ENCRYPTION</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Set to the server side encryption algorithm to use. There is
actually only one algorithm, it is &quot;AES256&quot;. The
encryption is done by Amazon on their server. See :
http://docs.amazonwebservices.com/AmazonS3/latest/API/index.html?RESTObjectPUT.html
for the most up&minus;to&minus;date list.</p>


<p style="margin-left:11%; margin-top: 1em">S3_SERVICE_PATH</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
A path to add at the beginning of the URL.</p>


<p style="margin-left:11%; margin-top: 1em">S3_STORAGE_CLASS</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Storage class for new objects, currently one of
&quot;STANDARD&quot; (the default) or
&quot;REDUCED_REDUNDANCY&quot; (cheaper, but less
redundant). See :
http://docs.amazonwebservices.com/AmazonS3/latest/dev/index.html?DataDurability.html
for the most up&minus;to&minus;date list.</p>

<p style="margin-left:11%; margin-top: 1em">S3_SSL</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Whether or not to use SSL/TLS to secure communications with
Amazon S3.</p>


<p style="margin-left:11%; margin-top: 1em">S3_SUBDOMAIN</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Whether or not to use subdomain hostname.</p>


<p style="margin-left:11%; margin-top: 1em">S3_USER_TOKEN</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property specifies the user token for Amanda Enterprise
Edition customers.</p>


<p style="margin-left:11%; margin-top: 1em">STORAGE_API</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Which API to use for the cloud: <br>
S3 Amanzon S3 api <br>
SWIFT&minus;1.0 Openstack swift v1.0 <br>
SWIFT&minus;2.0 Openstack swift v2.0 <br>
OAUTH2 Google <br>
CASTOR Caringo CAStor</p>

<p style="margin-left:11%; margin-top: 1em">TENANT_ID</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The tenant_id (for swift v2).</p>


<p style="margin-left:11%; margin-top: 1em">TENANT_NAME</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The tenant_name (for swift v2).</p>

<p style="margin-left:11%; margin-top: 1em">USERNAME</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The username (for swift v2).</p>

<p style="margin-left:11%; margin-top: 1em">VERBOSE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
If true, verbose data about each HTTP transaction is sent to
the debug log.</p>

<p style="margin-left:11%; margin-top: 1em"><b>S3 URL</b>
<br>
SSL &amp;&amp; SUBDOMAIN:
https://bucket.host/service_path/file <br>
SSL &amp;&amp; !SUBDOMAIN:
https://host/service_path/bucket/file <br>
!SSL &amp;&amp; SUBDOMAIN:
http://bucket.host/service_path/file <br>
!SSL &amp;&amp; !SUBDOMAIN:
http://host/service_path/bucket/file</p>

<p style="margin-left:11%; margin-top: 1em"><b>Tape
Device</b> <br>
tapedev &quot;tape:/dev/nst0&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The tape device
driver interacts with a tape drive. The device uses the
operating system's built&minus;in tape support, which is
generally similar to that available via the
command&minus;line utilities dd(1) and mt(1).</p>

<p style="margin-left:11%; margin-top: 1em">The tape device
name should specify a path to the operating system's device
file.</p>

<p style="margin-left:11%; margin-top: 1em">There is no
simple way to determine whether a particular system
(operating system and tape hardware) supports LEOM, so as a
safe default the tape device has LEOM detection disabled.
However, on modern hardware and common operating systems
(Linux, *BSD, and Solaris, at least), LEOM support is
functional. On these systems, enable LEOM by setting the
LEOM property to &quot;true&quot; at the appropriate place
in the Amanda configuration.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Device-Specific
Properties</b> <br>
Most of these properties are automatically detected, but can
be overridden in the configuration file if the autodetection
fails. Note that tape drives are required to at least
support the MTREW (rewind) operation; all other operations
can be emulated with the MTREW and read data operations.</p>


<p style="margin-left:11%; margin-top: 1em">BROKEN_GMT_ONLINE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Set this boolean property if the system's GMT_ONLINE macro
gives incorrect results. This is currently true for the
Linux IDE&minus;TAPE driver.</p>

<p style="margin-left:11%; margin-top: 1em">BSF</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property specifies whether the device <br>
driver may execute the MTBSF operation (backward seek
file).</p>


<p style="margin-left:11%; margin-top: 1em">BSF_AFTER_EOM</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property specifies whether the device <br>
driver should execute an MTBSF (backward seek file)
operation after <br>
MTEOM (seek to end of recorded data) in order to append.</p>

<p style="margin-left:11%; margin-top: 1em">BSR</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property specifies whether the device <br>
driver may use the MTBSR operation (backward seek
record).</p>

<p style="margin-left:11%; margin-top: 1em">EOM</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property specifies whether the device <br>
driver may use the MTEOM command (seek to end of recorded
data).</p>


<p style="margin-left:11%; margin-top: 1em">FINAL_FILEMARKS</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This integer property gives the number of filemarks that
should be written at EOD. It is usually 1 or 2.</p>

<p style="margin-left:11%; margin-top: 1em">FSF</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property specifies whether the device driver
may use the MTFSF operation (forward seek file).</p>


<p style="margin-left:11%; margin-top: 1em">FSF_AFTER_FILEMARK</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property specifies whether the device driver
needs a FSF to go the next file after the filemark is read.
Default to &quot;TRUE&quot; on Solaris and &quot;FALSE&quot;
on all others machines.</p>

<p style="margin-left:11%; margin-top: 1em">FSR</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This boolean property specifies whether the device driver
may use the MTFSR operation (forward seek record).</p>


<p style="margin-left:11%; margin-top: 1em">NONBLOCKING_OPEN</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Set this boolean property to &quot;true&quot; if O_NONBLOCK
must be used on the open call. Default to &quot;true&quot;
on Linux and &quot;false&quot; on all others machines.
Without it, Linux wait for a few seconds if no tape are
loaded. Solaris have strange error it is set to
&quot;yes&quot;.</p>


<p style="margin-left:11%; margin-top: 1em">READ_BLOCK_SIZE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property (previously known as <i>READ_BUFFER_SIZE</i>)
specifies the block size that will be used for reads; this
should be large enough to contain any block that may be read
from the device (for example, from a tape containing
variable&minus;sized blocks), and must be larger than
BLOCK_SIZE. This property is most often used when
overwriting tapes using a new, smaller block size. <br>
The tapetype parameter <i>READBLOCKSIZE</i> sets this
property. See BLOCK SIZES, above.</p>

<p style="margin-left:11%; margin-top: 1em"><b>NDMP
Device</b> <br>
tapedev &quot;ndmp:my.filer.com:10000@st1&quot; <br>
device&minus;property &quot;NDMP_USERNAME&quot;
&quot;jimmy&quot; <br>
device&minus;property &quot;NDMP_PASSWORD&quot;
&quot;thelock&quot;</p>

<p style="margin-left:11%; margin-top: 1em">This device
enables Amanda to communicate with a tape service on an NDMP
server. The device name specifies the hostname and
optionally the TCP port of the NDMP server, followed by the
name of the tape device on the server (<b>st1</b> in the
example above).</p>

<p style="margin-left:11%; margin-top: 1em">This device
supports LEOM detection.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Device-Specific
Properties</b> <br>
The properties <b>NDMP_USERNAME</b> and <b>NDMP_PASSWORD</b>
set the username and password with which to access the NDMP
server. The default for both is &quot;ndmp&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">INDIRECT</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Set to &quot;yes&quot; if the ndmp server doesn't allow to
set a window length to 0. The default is &quot;no&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">NDMP_AUTH</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Authentication method to use to connect to the NDMP server.
One of &quot;md5&quot; (default), &quot;text&quot;,
&quot;none&quot; (for an empty authentication attempt) or
&quot;void&quot; (for no authentication attempt at all).</p>


<p style="margin-left:11%; margin-top: 1em">NDMP_PASSWORD</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Password for md5 or text authentications.</p>


<p style="margin-left:11%; margin-top: 1em">NDMP_USERNAME</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Username for md5 or text authentications.</p>


<p style="margin-left:11%; margin-top: 1em">READ_BLOCK_SIZE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property specifies the block size that will be used for
reads; this should be large enough to contain any block that
may be read from the device and must be larger than
BLOCK_SIZE. See BLOCK_SIZES, above.</p>

<p style="margin-left:11%; margin-top: 1em"><b>VFS
Device</b> <br>
tapedev &quot;file:/path/to/vtape&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The VFS device
driver stores data on a UNIX filesystem. Note that although
one typically uses the VFS device driver to store data on
hard disks, the driver does not interface with any hardware
on a block level.</p>

<p style="margin-left:11%; margin-top: 1em">The device name
specifies a path to a directory which must exist and contain
a &quot;data/&quot; subdirectory. Each tape file is stored
as a distinct file in this directory, the name of which
reflects the Amanda header in the tape file. Block
boundaries are not maintained: the driver supports reads of
arbitrary size, regardless of the blocksize used to write
the data.</p>

<p style="margin-left:11%; margin-top: 1em">This device
supports LEOM detection. LEOM will be indicated when the
MAX_VOLUME_USAGE is nearly met, or when the filesystem is
nearly out of space. The latter circumstance is detected by
monitoring the available space on the filesystem, and this
monitoring can be disabled with the MONITOR_FREE_SPACE
property. Note that the device cannot detect other
circumstances that may cause a write to fail, such as a
filesystem quota. LEOM detection can be disabled by setting
the LEOM property to false.</p>

<p style="margin-left:11%; margin-top: 1em">This device
supports the ENFORCE_MAX_VOLUME_USAGE property. Default
value is true. See COMMON PROPERTIES, above.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Device-Specific
Properties</b> <br>
MONITOR_FREE_SPACE</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p>(read&minus;write) This property controls whether the
device will monitor</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p>the filesystem's free space to detect a full filesystem
before an</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p>error occurs, and defaults to true. The monitoring
operation works on</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p>most filesystems, but if it causes problems, use this
property to</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p>disable it.</p></td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>DVD&minus;RW
Device</b> <br>
tapedev
&quot;dvdrw:/var/cache/amanda/dvd&minus;cache:/dev/scd0&quot;
<br>
device&minus;property &quot;DVDRW_MOUNT_POINT&quot;
&quot;/media/dvd&quot; <br>
device&minus;property &quot;DVDRW_KEEP_CACHE&quot;
&quot;false&quot; <br>
device&minus;property
&quot;DVDRW_UNLABELLED_WHEN_UNMOUNTABLE&quot;
&quot;true&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The
DVD&minus;RW device driver reads and writes optical media
such as DVDs and CDs. The device name must specify a cache
directory for data to be temporarily stored, followed by the
operating system name for the optical drive. The cache
directory must contain a &quot;data/&quot; subdirectory.</p>

<p style="margin-left:11%; margin-top: 1em">The
DVDRW_MOUNT_POINT property is required, and specifies a
directory where the optical media can be mounted. This
directory must be configured to enable non&minus;root users
to mount the optical media. On Linux, that means a line
similar to the following in /etc/fstab: <br>
/dev/scd0 /media/dvd auto ro,user,noauto 0 0</p>

<p style="margin-left:11%; margin-top: 1em">Note the
&quot;user&quot; option.</p>

<p style="margin-left:11%; margin-top: 1em">When writing
data, the device acts as a VFS device using the given cache
directory. On completion of writing the tape, the cache
directory is written to optical media. The DVDRW_KEEP_CACHE
property controls whether the cache contents are immediately
deleted. When reading, the optical media is first mounted
and read as a VFS device.</p>

<p style="margin-left:11%; margin-top: 1em">Attempting to
mount unformatted media or media that is formatted but
contains no filesystem will usually result in an error. The
boolean DVDRW_UNLABELLED_WHEN_UNMOUNTABLE property specifies
whether media that cannot be mounted should be treated as an
empty, unlabelled volume when attempting to read the volume
label. It is necessary to set this property to
&quot;true&quot; when labelling such media.</p>

<p style="margin-left:11%; margin-top: 1em">This device
does not support LEOM detection.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Device-Specific
Properties</b> <br>
The properties DVDRW_GROWISOFS_COMMAND, DVDRW_MOUNT_COMMAND
and DVDRW_UMOUNT_COMMAND specify alternative commands for
writing, mounting and unmounting optical media. The default
is to find the programs using the PATH environment
variable.</p>

<p style="margin-left:11%; margin-top: 1em">The CDRW device
supports all of the properties of the VFS device, as well as
the properties given below. The DVDRW_MOUNT_POINT property
is required. Other properties are optional.</p>


<p style="margin-left:11%; margin-top: 1em">DVDRW_KEEP_CACHE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Set this boolean property to &quot;true&quot; if the disk
cache directory should be kept after successfully writing
tape data to optical media. The default is false, which
causes the cache contents to be deleted immediately after a
successful write operation.</p>


<p style="margin-left:11%; margin-top: 1em">DVDRW_MOUNT_POINT</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
This property specifies the filesystem mount point for the
optical media. Non&minus;root users must be able to mount
optical media by invoking &quot;mount&quot; and specifying
this mount point.</p>


<p style="margin-left:11%; margin-top: 1em">DVDRW_UNLABELLED_WHEN_UNMOUNTABLE</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
Treat unmountable media as empty, unlabelled media. This is
necessary when attempting to label freshly formatted
media.</p>


<p style="margin-left:11%; margin-top: 1em">DVDRW_GROWISOFS_COMMAND</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The command to invoke to burn the DVD.</p>


<p style="margin-left:11%; margin-top: 1em">DVDRW_MOUNT_COMMAND</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The command to invoke to mount the DVD.</p>


<p style="margin-left:11%; margin-top: 1em">DVDRW_UMOUNT_COMMAND</p>


<p style="margin-left:17%; margin-top: 1em">(read&minus;write)
The command to invoke to unmount the DVD.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>amanda</b>(8),
<b>amanda.conf</b>(5)</p>

<p style="margin-left:11%; margin-top: 1em">The Amanda
Wiki: : http://wiki.zmanda.com/</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Ian
Turner</b> &lt;ian@zmanda.com&gt;</p>

<p style="margin-left:17%;">Zmanda, Inc.
(http://www.zmanda.com)</p>

<p style="margin-left:11%; margin-top: 1em"><b>Dustin J.
Mitchell</b> &lt;dustin@zmanda.com&gt;</p>

<p style="margin-left:17%;">Zmanda, Inc.
(http://www.zmanda.com)</p>
<hr>
</body>
</html>
