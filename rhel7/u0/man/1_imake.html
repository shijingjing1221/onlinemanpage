<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 01:59:12 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IMAKE</title>

</head>
<body>

<h1 align="center">IMAKE</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#HOW IT WORKS">HOW IT WORKS</a><br>
<a href="#USE WITH THE X WINDOW SYSTEM">USE WITH THE X WINDOW SYSTEM</a><br>
<a href="#INPUT FILES">INPUT FILES</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">imake &minus; C
preprocessor interface to the make utility</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>imake</b> [
<b>&minus;D</b><i>define</i> ] [ <b>&minus;I</b><i>dir</i> ]
[ <b>&minus;U</b><i>define</i> ] [
<b>&minus;T</b><i>template</i> ] [ <b>&minus;f</b>
<i>filename</i> ] [ <b>&minus;C</b> <i>filename</i> ] [
<b>&minus;s</b> <i>filename</i> ] [ <b>&minus;e</b> ] [
<b>&minus;v</b> ]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>Imake</i> is
used to generate <i>Makefiles</i> from a template, a set of
<i>cpp</i> macro functions, and a per-directory input file
called an <i>Imakefile</i>. This allows machine dependencies
(such as compiler options, alternate command names, and
special <i>make</i> rules) to be kept separate from the
descriptions of the various items to be built.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
command line options may be passed to <i>imake</i>: <b><br>
&minus;D</b><i>define</i></p>

<p style="margin-left:23%;">This option is passed directly
to <i>cpp</i>. It is typically used to set
directory-specific variables. For example, the X Window
System used this flag to set <i>TOPDIR</i> to the name of
the directory containing the top of the core distribution
and <i>CURDIR</i> to the name of the current directory,
relative to the top.</p>


<p style="margin-left:11%;"><b>&minus;I</b><i>directory</i></p>

<p style="margin-left:23%;">This option is passed directly
to <i>cpp</i>. It is typically used to indicate the
directory in which the <i>imake</i> template and
configuration files may be found.</p>


<p style="margin-left:11%;"><b>&minus;U</b><i>define</i></p>

<p style="margin-left:23%;">This option is passed directly
to <i>cpp</i>. It is typically used to unset variables when
debugging <i>imake</i> configuration files.</p>


<p style="margin-left:11%;"><b>&minus;T</b><i>template</i></p>

<p style="margin-left:23%;">This option specifies the name
of the master template file (which is usually located in the
directory specified with <i>&minus;I</i>) used by
<i>cpp</i>. The default is <i>Imake.tmpl</i>.</p>

<p style="margin-left:11%;"><b>&minus;f</b>
<i>filename</i></p>

<p style="margin-left:23%;">This option specifies the name
of the per-directory input file. The default is
<i>Imakefile</i>.</p>

<p style="margin-left:11%;"><b>&minus;C</b>
<i>filename</i></p>

<p style="margin-left:23%;">This option specifies the name
of the .c file that is constructed in the current directory.
The default is <i>Imakefile.c</i>.</p>

<p style="margin-left:11%;"><b>&minus;s</b>
<i>filename</i></p>

<p style="margin-left:23%;">This option specifies the name
of the <i>make</i> description file to be generated but
<i>make</i> should not be invoked. If the <i>filename</i> is
a dash (&minus;), the output is written to <i>stdout</i>.
The default is to generate, but not execute, a
<i>Makefile</i>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;e</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>This option indicates the <i>imake</i> should execute
the generated <i>Makefile</i>. The default is to leave this
to the user.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;v</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>This option indicates that <i>imake</i> should print the
<i>cpp</i> command line that it is using to generate the
<i>Makefile</i>.</p> </td></tr>
</table>

<h2>HOW IT WORKS
<a name="HOW IT WORKS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>Imake</i>
invokes <i>cpp</i> with any <i>&minus;I</i> or
<i>&minus;D</i> flags passed on the command line and passes
the name of a file containing the following 3 lines:</p>

<p style="margin-left:11%; margin-top: 1em">#define
IMAKE_TEMPLATE &quot;Imake.tmpl&quot;</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="77%">


<p>#define INCLUDE_IMAKEFILE &lt;Imakefile&gt;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="77%">


<p>#include IMAKE_TEMPLATE</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">where
<i>Imake.tmpl</i> and <i>Imakefile</i> may be overridden by
the <i>&minus;T</i> and <i>&minus;f</i> command options,
respectively.</p>

<p style="margin-left:11%; margin-top: 1em">The
IMAKE_TEMPLATE typically reads in a file containing
machine-dependent parameters (specified as <i>cpp</i>
symbols), a site-specific parameters file, a file defining
variables, a file containing <i>cpp</i> macro functions for
generating <i>make</i> rules, and finally the
<i>Imakefile</i> (specified by INCLUDE_IMAKEFILE) in the
current directory. The <i>Imakefile</i> uses the macro
functions to indicate what targets should be built;
<i>imake</i> takes care of generating the appropriate
rules.</p>

<p style="margin-left:11%; margin-top: 1em"><i>Imake</i>
configuration files contain two types of variables, imake
variables and make variables. The imake variables are
interpreted by cpp when <i>imake</i> is run. By convention
they are mixed case. The make variables are written into the
<i>Makefile</i> for later interpretation by <i>make.</i> By
convention make variables are upper case.</p>

<p style="margin-left:11%; margin-top: 1em">The rules file
(usually named <i>Imake.rules</i> in the configuration
directory) contains a variety of <i>cpp</i> macro functions
that are configured according to the current platform.
<i>Imake</i> replaces any occurrences of the string
&lsquo;&lsquo;@@&rsquo;&rsquo; with a newline to allow
macros that generate more than one line of <i>make</i>
rules. For example, the macro</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>#define</p><td width="12%"></td>
<td width="3%"></td>
<td width="10%">


<p>program_target(program, objlist)</p></td>
<td width="52%"></td>
<td width="23%">


<p>@@\ <br>
program:</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%"></td>
<td width="10%">


<p>objlist</p></td>
<td width="52%"></td>
<td width="23%">


<p>@@\</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%"></td>
<td width="10%">


<p>$(CC) &minus;o $@ objlist $(LDFLAGS)</p></td>
<td width="52%"></td>
<td width="23%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">when called
with <i>program_target(foo, foo1.o foo2.o)</i> will expand
to</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>foo:</p><td width="12%"></td>
<td width="3%"></td>
<td width="10%"></td>
<td width="75%">


<p>foo1.o foo2.o</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%"></td>
<td width="10%"></td>
<td width="75%">


<p>$(CC) &minus;o $@ foo1.o foo2.o $(LDFLAGS)</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><i>Imake</i>
also replaces any occurrences of the word
&lsquo;&lsquo;XCOMM&rsquo;&rsquo; with the character
&lsquo;&lsquo;#&rsquo;&rsquo; to permit placing comments in
the Makefile without causing &lsquo;&lsquo;invalid
directive&rsquo;&rsquo; errors from the preprocessor.</p>

<p style="margin-left:11%; margin-top: 1em">Some complex
<i>imake</i> macros require generated <i>make</i> variables
local to each invocation of the macro, often because their
value depends on parameters passed to the macro. Such
variables can be created by using an <i>imake</i> variable
of the form <b>XVARdef</b><i>n</i>, where <i>n</i> is a
single digit. A unique <i>make</i> variable will be
substituted. Later occurrences of the variable
<b>XVARuse</b><i>n</i> will be replaced by the variable
created by the corresponding <b>XVARdef</b><i>n</i>.</p>

<p style="margin-left:11%; margin-top: 1em">On systems
whose <i>cpp</i> reduces multiple tabs and spaces to a
single space, <i>imake</i> attempts to put back any
necessary tabs (<i>make</i> is very picky about the
difference between tabs and spaces). For this reason, colons
(:) in command lines must be preceded by a backslash
(\).</p>

<h2>USE WITH THE X WINDOW SYSTEM
<a name="USE WITH THE X WINDOW SYSTEM"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The X Window
System used <i>imake</i> extensively up through the X11R6.9
release, for both full builds within the source tree and
external software. X has since moved to GNU autoconf and
automake for its build system in X11R7.0 and later releases,
but still maintains imake for building existing external
software programs that have not yet converted.</p>

<p style="margin-left:11%; margin-top: 1em">As mentioned
above, two special variables, <i>TOPDIR</i> and
<i>CURDIR,</i> are set to make referencing files using
relative path names easier. For example, the following
command is generated automatically to build the
<i>Makefile</i> in the directory <i>lib/X/</i> (relative to
the top of the sources):</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="15%"></td>
<td width="10%"></td>
<td width="52%">


<p>% ../.././config/imake &minus;I../.././config \</p></td>
<td width="23%">
</td></tr>
<tr valign="top" align="left">
<td width="15%"></td>
<td width="10%"></td>
<td width="52%">
</td>
<td width="23%">
</td></tr>
<tr valign="top" align="left">
<td width="15%"></td>
<td width="10%"></td>
<td width="52%">


<p>&minus;DTOPDIR=../../. &minus;DCURDIR=./lib/X</p></td>
<td width="23%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">When building X
programs outside the source tree, a special symbol
<i>UseInstalled</i> is defined and <i>TOPDIR</i> and
<i>CURDIR</i> are omitted. If the configuration files have
been properly installed, the script <i>xmkmf</i>(1) may be
used.</p>

<h2>INPUT FILES
<a name="INPUT FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Here is a
summary of the files read by <i>imake</i> as used by X. The
indentation shows what files include what other files.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Imake.tmpl</p><td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>generic variables <br>
site.def</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>site-specific, BeforeVendorCF defined <br>
*.cf</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>machine-specific <br>
*Lib.rules</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>shared library rules <br>
site.def</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>site-specific, AfterVendorCF defined <br>
Imake.rules</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>rules <br>
Project.tmpl</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>X-specific variables <br>
*Lib.tmpl</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="29%"></td>
<td width="54%">


<p>shared library variables</p></td></tr>
</table>

<p style="margin-left:11%;">Imakefile</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Library.tmpl</p><td width="29%"></td>
<td width="17%"></td>
<td width="54%">


<p>library rules <br>
Server.tmpl</p></td></tr>
<tr valign="top" align="left">
<td width="29%"></td>
<td width="17%"></td>
<td width="54%">


<p>server rules <br>
Threads.tmpl</p></td></tr>
<tr valign="top" align="left">
<td width="29%"></td>
<td width="17%"></td>
<td width="54%">


<p>multi-threaded rules</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Note that
<i>site.def</i> gets included twice, once before the
<i>*.cf</i> file and once after. Although most site
customizations should be specified after the <i>*.cf</i>
file, some, such as the choice of compiler, need to be
specified before, because other variable settings may depend
on them.</p>

<p style="margin-left:11%; margin-top: 1em">The first time
<i>site.def</i> is included, the variable BeforeVendorCF is
defined, and the second time, the variable AfterVendorCF is
defined. All code in <i>site.def</i> should be inside an
#ifdef for one of these symbols.</p>

<h2>FILES
<a name="FILES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="35%">


<p>Imakefile.c</p></td>
<td width="54%">


<p>temporary input file for cpp</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="35%">


<p>/tmp/Imf.XXXXXX</p></td>
<td width="54%">


<p>temporary Makefile for -s</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="35%">


<p>/tmp/IIf.XXXXXX</p></td>
<td width="54%">


<p>temporary Imakefile if specified Imakefile uses #
comments</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="35%">


<p>/usr/bin/cpp</p></td>
<td width="54%">


<p>default C preprocessor</p></td></tr>
</table>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">make(1),
xmkmf(1) <br>
Paul DuBois, <i>imake-Related Software and
Documentation,</i>
http://www.snake.net/software/imake-stuff/ <br>
Paul DuBois, <i>Software Portability with imake, Second
Edition,</i> O&rsquo;Reilly &amp; Associates, 1996. <br>
S. I. Feldman, <i>Make &mdash; A Program for Maintaining
Computer Programs</i></p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
environment variables may be set, however their use is not
recommended as they introduce dependencies that are not
readily apparent when <i>imake</i> is run: <b><br>
IMAKEINCLUDE</b></p>

<p style="margin-left:18%;">If defined, this specifies a
&lsquo;&lsquo;&minus;I&rsquo;&rsquo; include argument to
pass to the C preprocessor. E.g.,
&lsquo;&lsquo;&minus;I/usr/X11/config&rsquo;&rsquo;.</p>

<p style="margin-left:11%;"><b>IMAKECPP</b></p>

<p style="margin-left:18%;">If defined, this should be a
valid path to a preprocessor program. E.g.,
&lsquo;&lsquo;/usr/local/cpp&rsquo;&rsquo;. By default,
<i>imake</i> will use cc -E or /usr/bin/cpp, depending on
the OS specific configuration.</p>

<p style="margin-left:11%;"><b>IMAKEMAKE</b></p>

<p style="margin-left:18%;">If defined, this should be a
valid path to a make program, such as
&lsquo;&lsquo;/usr/local/make&rsquo;&rsquo;. By default,
<i>imake</i> will use whatever <i>make</i> program is found
using <i>execvp(3).</i> This variable is only used if the
&lsquo;&lsquo;&minus;e&rsquo;&rsquo; option is
specified.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Todd Brunhoff,
Tektronix and MIT Project Athena; Jim Fulton, MIT X
Consortium</p>
<hr>
</body>
</html>
