<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:33:49 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>USB_MODESWITCH</title>

</head>
<body>

<h1 align="center">USB_MODESWITCH</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">usb_modeswitch
- switch mode of &quot;multi-state&quot; USB devices</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>usb_modeswitch</b>
[<b>&minus;heWQDIvpVPmM23rwdHSOBGTNALnsRiuagft</b>]
[<b>&minus;c</b> <i>filename</i><b>]</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Several new USB
devices have their proprietary Windows drivers onboard, most
of them WWAN and WLAN dongles. When plugged in for the first
time, they act like a flash storage and start installing the
Windows driver from there. If the driver is already
installed, it makes the storage device disappear and a new
device, mainly composite with modem ports, shows up.</p>

<p style="margin-left:11%; margin-top: 1em">On Linux, in
most cases the drivers are available as kernel modules, such
as &quot;usbserial&quot; or &quot;option&quot;. However, the
device initially binds to &quot;usb-storage&quot; by
default. <b>usb_modeswitch</b> can then send a provided bulk
message (most likely a mass storage command) to the device;
this message has to be determined by analyzing the actions
of the Windows driver.</p>

<p style="margin-left:11%; margin-top: 1em">In some cases,
USB control commands are used for switching. These cases are
handled by custom functions, and no bulk message needs to be
provided.</p>

<p style="margin-left:11%; margin-top: 1em">Usually, the
program is distributed with a set of configurations for many
known devices, which allows a fully automatic handling of a
device upon insertion, made possible by combining
usb_modeswitch with the wrapper script
<b>usb_modeswitch_dispatcher</b> which is launched by the
udev daemon.</p>

<p style="margin-left:11%; margin-top: 1em">Note that
<b>usb_modeswitch</b> itself has no specific Linux
dependencies.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This program
follows the usual GNU command line syntax, with long options
starting with two dashes (&rsquo;--&rsquo;). A summary of
options is included below.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p><b>-h &minus;&minus;help</b></p></td>
<td width="1%"></td>
<td width="37%">


<p>Show summary of options.</p></td>
<td width="37%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>-e
&minus;&minus;version</b></p>

<p style="margin-left:26%;">Print version information and
exit</p>

<p style="margin-left:11%;"><b>-v
&minus;&minus;default-vendor NUM</b></p>

<p style="margin-left:26%;">Vendor ID to look for
(mandatory), usually given as hex number (example: 0x12d1).
Each USB device is identified by a number officialy assigned
to the vendor by the USB association and a number for the
respective model (product ID) chosen by the vendor</p>

<p style="margin-left:11%;"><b>-p
&minus;&minus;default-product NUM</b></p>

<p style="margin-left:26%;">Product ID to look for
(mandatory)</p>

<p style="margin-left:11%;"><b>-V
&minus;&minus;target-vendor NUM</b></p>

<p style="margin-left:26%;">Target vendor ID. When given
will be searched for and detected initially for information
purposes. If success checking (option &minus;s) is active,
providing target IDs (vendor/product) or target class is
recommended</p>

<p style="margin-left:11%;"><b>-j
&minus;&minus;find-mbim</b></p>

<p style="margin-left:26%;">Return configuration number
with MBIM interface and exit.</p>

<p style="margin-left:11%;"><b>-P
&minus;&minus;target-product NUM</b></p>

<p style="margin-left:26%;">Target product ID</p>

<p style="margin-left:11%;"><b>-b &minus;&minus;bus-num NUM
<br>
-g &minus;&minus;device-num NUM</b></p>

<p style="margin-left:26%;">If bus and device number are
provided, the handling of a specific device on a specific
USB port is guaranteed, in contrast to using only the USB
ID. This is important if there are multiple similar devices
on a system</p>

<p style="margin-left:11%;"><b>-C
&minus;&minus;target-class NUM</b></p>

<p style="margin-left:26%;">Target Device Class according
to the USB specification. Some devices keep their original
vendor/product ID after successful switching. To prevent
them from being treated again, the device class can be
checked. For unswitched devices it is always 8 (storage
class), for switched modems it is often 0xff (vendor
specific). In composite modes, the class of the first
interface is watched</p>

<p style="margin-left:11%;"><b>-m
&minus;&minus;message-endpoint NUM</b></p>

<p style="margin-left:26%;">A specific endpoint to use for
data transfers. Only for testing purposes; usually endpoints
are determined from the device attributes</p>

<p style="margin-left:11%;"><b>-M
&minus;&minus;message-content STRING</b></p>

<p style="margin-left:26%;">A bulk message to send as a
switching command. Provided as a hexadecimal string</p>

<p style="margin-left:11%;"><b>-2, -3
&minus;&minus;message-content2,
&minus;&minus;message-content3 STRING</b></p>

<p style="margin-left:26%;">Additional bulk messages to
send as switching commands. Provided as hexadecimal strings.
When used with mass storage commands, setting
<b>&minus;&minus;need-response</b> is strongly advised to
comply with specifications and to avoid likely errors</p>

<p style="margin-left:11%;"><b>-w
&minus;&minus;release-delay NUM</b></p>

<p style="margin-left:26%;">After issuing all bulk
messages, wait for NUM milliseconds before releasing the
interface. Required for some modems on older systems
(especially after an EJECT message)</p>

<p style="margin-left:11%;"><b>-n
&minus;&minus;need-response</b></p>

<p style="margin-left:26%;">Read the response (command
status wrapper) to a mass storage command transfer. Some
devices have trouble switching if the response is not read;
most are disappearing right away. When sending multiple mass
storage commands with <b>&minus;2</b> and <b>&minus;3</b>,
this may need to be set to avoid transfer errors</p>

<p style="margin-left:11%;"><b>-r
&minus;&minus;response-endpoint NUM</b></p>

<p style="margin-left:26%;">Try to read the response to a
storage command from there if option &minus;n is active.
Only for testing purposes; usually endpoints are determined
from the device attributes</p>

<p style="margin-left:11%;"><b>-d
&minus;&minus;detach-only</b></p>

<p style="margin-left:26%;">Just detach the current driver.
This is sufficient for some early devices to switch
successfully. Otherwise this feature can be used as a
&rsquo;scalpel&rsquo; for special cases, like separating the
driver from individual interfaces</p>

<p style="margin-left:11%;"><b>-H
&minus;&minus;huawei-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by older Huawei devices</p>

<p style="margin-left:11%;"><b>-S
&minus;&minus;sierra-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by Sierra devices</p>

<p style="margin-left:11%;"><b>-G
&minus;&minus;gct-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by GCT chipsets</p>

<p style="margin-left:11%;"><b>-T
&minus;&minus;kobil-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by Kobil devices</p>

<p style="margin-left:11%;"><b>-N
&minus;&minus;sequans-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by Sequans chipset</p>

<p style="margin-left:11%;"><b>-A
&minus;&minus;mobileaction-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by the MobileAction device</p>

<p style="margin-left:11%;"><b>-B
&minus;&minus;qisda-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by Qisda devices</p>

<p style="margin-left:11%;"><b>-E
&minus;&minus;quanta-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by Quanta devices</p>

<p style="margin-left:11%;"><b>-F
&minus;&minus;pantech-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by Pantech devices</p>

<p style="margin-left:11%;"><b>-Z
&minus;&minus;blackberry-mode</b></p>

<p style="margin-left:26%;">Send a special control message
used by Blackberry devices</p>

<p style="margin-left:11%;"><b>-O
&minus;&minus;sony-mode</b></p>

<p style="margin-left:26%;">Apply a special sequence used
by Sony Ericsson devices. Implies option
&minus;-check-success</p>

<p style="margin-left:11%;"><b>-L
&minus;&minus;cisco-mode</b></p>

<p style="margin-left:26%;">Send a sequence of bulk
messages used by Cisco devices</p>

<p style="margin-left:11%;"><b>-R
&minus;&minus;reset-usb</b></p>

<p style="margin-left:26%;">Send a USB reset command to the
device. Can be combined with any switching method or stand
alone. It is always done as the last step of all device
interactions. Few devices need it to complete the switching;
apart from that it may be useful during testing</p>

<p style="margin-left:11%;"><b>-c &minus;&minus;config-file
FILENAME</b></p>

<p style="margin-left:26%;">Use a specific config file. If
any ID or switching options are given as command line
parameters, this option is ignored. In that case all
mandatory parameters have to be provided on the command
line</p>

<p style="margin-left:11%;"><b>-f &minus;&minus;long-config
STRING</b></p>

<p style="margin-left:26%;">Provide device details in
config file syntax as a multiline string on the command
line</p>

<p style="margin-left:11%;"><b>-t
&minus;&minus;stdinput</b></p>

<p style="margin-left:26%;">Read the device details in
config file syntax from standard input, e.g. redirected from
a command pipe (multiline text)</p>

<p style="margin-left:11%;"><b>-Q
&minus;&minus;quiet</b></p>

<p style="margin-left:26%;">Don&rsquo;t show progress or
error messages</p>

<p style="margin-left:11%;"><b>-W
&minus;&minus;verbose</b></p>

<p style="margin-left:26%;">Print all settings before
running and show libusb debug messages</p>

<p style="margin-left:11%;"><b>-D
&minus;&minus;sysmode</b></p>

<p style="margin-left:26%;">Changes the behaviour of the
program slightly. A success message including the effective
target device ID is put out and a syslog notice is issued.
Mainly for integration with a wrapper script</p>

<p style="margin-left:11%;"><b>-s
&minus;&minus;check-success NUM</b></p>

<p style="margin-left:26%;">After switching, keep checking
for the result up to max. NUM seconds. If target IDs or
target class were provided, their appearance indicates
certain success. Otherwise the disconnection of the original
device is rated as likely proof</p>

<p style="margin-left:11%;"><b>-I
&minus;&minus;no-inquire</b></p>

<p style="margin-left:26%;">do not obtain SCSI attributes
from device (default is on). For proper identification of
differing devices the attributes of the storage part provide
valuable information. This is not needed for devices that
are known and supported</p>

<p style="margin-left:11%;"><b>-i &minus;&minus;interface
NUM</b></p>

<p style="margin-left:26%;">Select initial USB interface
(default: 0). Only for testing purposes</p>

<p style="margin-left:11%;"><b>-u
&minus;&minus;configuration NUM</b></p>

<p style="margin-left:26%;">Select USB configuration
(applied after any other possible switching actions)</p>

<p style="margin-left:11%;"><b>-a &minus;&minus;altsetting
NUM</b></p>

<p style="margin-left:26%;">Select alternative USB
interface setting (applied after switching). Mainly for
testing</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This manual
page was originally written by Didier Raboud
(didier@raboud.com) for the <b>Debian</b> system. Additions
made by Josua Dietze. Permission is granted to copy,
distribute and/or modify this document under the terms of
the GNU General Public License, Version 2 or any later
version published by the Free Software Foundation.</p>

<p style="margin-left:11%; margin-top: 1em">The complete
text of the current GNU General Public License can be found
in http://www.gnu.org/licenses/gpl.txt</p>
<hr>
</body>
</html>
