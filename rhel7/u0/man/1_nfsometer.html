<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:08:56 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>man</title>

</head>
<body>

<h1 align="center">man</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#MODES">MODES</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfsometer
&minus; NFS performance measurement tool</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfsometer
[options] [mode] [[&lt;server:path&gt;] [workloads...]]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfsometer is a
performance measurement framework for running workloads and
reporting results across NFS protocol versions, NFS options
and Linux NFS client implementations</p>

<h2>MODES
<a name="MODES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Basic usage (no
mode specified):</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
&lt;server:path&gt; [workloads...]</b></p>

<p style="margin-left:11%; margin-top: 1em">This will fetch
needed files, run traces, and generate reports, <br>
same as running the the &rsquo;fetch&rsquo;,
&rsquo;trace&rsquo; and &rsquo;report&rsquo; stages.</p>

<p style="margin-left:11%; margin-top: 1em">Advanced usage
(specify modes):</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
list</b></p>

<p style="margin-left:11%; margin-top: 1em">List the
contents of the results directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
workloads</b></p>

<p style="margin-left:11%; margin-top: 1em">List available
and unavailable workloads.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
notes</b></p>

<p style="margin-left:11%; margin-top: 1em">Edit the notes
file of the results directory. These notes will <br>
be displayed in report headers.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
loadgen &lt;server:path&gt; &lt;workload&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">Run in loadgen
mode: don&rsquo;t record any stats, just loop over <br>
&lt;workload&gt; against &lt;server:path&gt;. Only one
&minus;o option is allowed. <br>
Use the &minus;n option to run multuple instances of the
loadgen workload. <br>
When running more than one instance, the intial start times
are <br>
staggered.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
fetch [workloads...]</b></p>

<p style="margin-left:11%; margin-top: 1em">Fetch all
needed files for the specified workload(s). If no <br>
workloads are specified, all workloads are fetched. <br>
Fetched files are only downloaded once and are cached for
<br>
future runs.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
trace &lt;server:path&gt; [workloads...]</b></p>

<p style="margin-left:11%; margin-top: 1em">Run traces
against &lt;server:path&gt;. The traces run will be: <br>
(options + always options + tags) X (workloads) X (num runs)
<br>
This will only run traces that don&rsquo;t already exist in
the results <br>
directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
report</b></p>

<p style="margin-left:11%; margin-top: 1em">Generate all
reports available from the results directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
example</b></p>

<p style="margin-left:11%; margin-top: 1em">Show examples
from man page</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;r
&lt;dir&gt;</b>,
<b>&minus;&minus;resultdir=&lt;dir&gt;</b></p>

<p style="margin-left:18%;">The directory used to save
results. default:
&rsquo;/home/dros/nfsometer_results&rsquo;</p>

<p style="margin-left:11%;"><b>&minus;o &lt;mount.nfs
options&gt;</b>, <b>&minus;&minus;options=&lt;mount.nfs
options&gt;</b></p>

<p style="margin-left:18%;">Mount options to iterate
through. This option may be used multiple times. Each mount
option must have a version specified.</p>

<p style="margin-left:11%;"><b>&minus;a &lt;mount.nfs
options&gt;</b>,
<b>&minus;&minus;always&minus;options=&lt;mount.nfs
options&gt;</b></p>

<p style="margin-left:18%;">Options added to every trace.
This option may be used multiple times.</p>

<p style="margin-left:11%;"><b>&minus;t &lt;tags&gt;</b>,
<b>&minus;&minus;tag=&lt;tags&gt;</b></p>

<p style="margin-left:18%;">Tag all new traces with
&rsquo;tags&rsquo;. This option may be used multiple
times.</p>

<p style="margin-left:11%;"><b>&minus;n &lt;num
runs&gt;</b>, <b>&minus;&minus;num&minus;runs=&lt;num
runs&gt;</b></p>

<p style="margin-left:18%;">Number of runs for each trace
of &lt;options&gt; X &lt;tags&gt; X &lt;workloads&gt;
default: 1</p>


<p style="margin-left:11%;"><b>&minus;&minus;serial&minus;graphs</b></p>

<p style="margin-left:18%;">Generate graphs inline while
generating reports. Useful for debugging graphing
issues.</p>

<p style="margin-left:11%;"><b>&minus;&minus;rand</b></p>

<p style="margin-left:18%;">Randomize the order of
traces</p>

<p style="margin-left:11%;"><b>&minus;h</b>,
<b>&minus;&minus;help</b></p>

<p style="margin-left:18%;">Show the help message</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Example 1: See
what workloads are available</p>

<p style="margin-left:11%; margin-top: 1em"><b>$ nfsometer
workloads</b></p>

<p style="margin-left:11%; margin-top: 1em">This command
lists available workloads and will tell you why <br>
workloads are unavailable (if any exist).</p>

<p style="margin-left:11%; margin-top: 1em">Example 2:
Compare cthon, averaged over 3 runs, <br>
across nfs protocol versions</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
&minus;n 3 server:/export cthon</b></p>

<p style="margin-left:11%; margin-top: 1em">This example
uses the default for &minus;o: &quot;&minus;o v3 &minus;o v4
&minus;o v4.1&quot;. <br>
To see the results, open results/index.html in a web
browser.</p>

<p style="margin-left:11%; margin-top: 1em">Example 3:
Compare cthon, averaged over 3 runs, <br>
between v3 and v4.0 only</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
&minus;n 3 &minus;o v3 &minus;o v4 server:/export
cthon</b></p>

<p style="margin-left:11%; margin-top: 1em">This example
specifies v3 and v4 only. <br>
To see the results, open results/index.html in a web
browser.</p>

<p style="margin-left:11%; margin-top: 1em">Example 4:
Compare two kernels running iozone workload, averaged <br>
over 2 runs, across all nfs protocol versions</p>

<p style="margin-left:11%; margin-top: 1em">nfsometer can
compare two (or more) kernel versions, but <br>
has no way of building, installing or booting new kernels.
<br>
It&rsquo;s up to the user to install new kernels. <br>
In order for these kernels to be differentiated,
&rsquo;uname &minus;a&rsquo; <br>
must be different.</p>

<p style="margin-left:11%; margin-top: 1em">1) boot into
kernel #1</p>

<p style="margin-left:11%; margin-top: 1em">2) <b>nfsometer
&minus;n 2 server:/export iozone</b></p>

<p style="margin-left:11%; margin-top: 1em">3) boot into
kernel #2</p>

<p style="margin-left:11%; margin-top: 1em">4) <b>nfsometer
&minus;n 2 server:/export iozone</b></p>

<p style="margin-left:11%; margin-top: 1em">5) open
results/index.html in a web browser</p>

<p style="margin-left:11%; margin-top: 1em">To see the
results, open results/index.html in a web browser.</p>

<p style="margin-left:11%; margin-top: 1em">Example 5:
Using tags</p>

<p style="margin-left:11%; margin-top: 1em">Tags (the
&minus;t option) can be used to mark nfsometer runs as <br>
occurring with some configuration not captured by mount
options <br>
or detectable tags, such as different sysctl settings
(client side), <br>
different server side options, or different network
conditions.</p>

<p style="margin-left:11%; margin-top: 1em">1) set server
value foo to 2.3</p>

<p style="margin-left:11%; margin-top: 1em">2) <b>nfsometer
&minus;o v4 &minus;o v4.1 &minus;t foo=2.3</b></p>

<p style="margin-left:11%; margin-top: 1em">3) set server
value foo to 10</p>

<p style="margin-left:11%; margin-top: 1em">4) <b>nfsometer
&minus;o v4 &minus;o v4.1 &minus;t foo=10</b></p>

<p style="margin-left:11%; margin-top: 1em">What is passed
to &minus;t is entirely up to the user &minus; it will not
be <br>
interpreted or checked by nfsometer at all, so be
careful!</p>

<p style="margin-left:11%; margin-top: 1em">To see the
results, open results/index.html in a web browser.</p>

<p style="margin-left:11%; margin-top: 1em">Example 6:
Always options</p>

<p style="margin-left:11%; margin-top: 1em">The &minus;o
flag specifies distinct option sets to run, but sometimes
<br>
there are options that should be present in each. Instead of
<br>
writing each one out, you can use the &minus;a option:</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
&minus;o v3 &minus;o v4 &minus;a sec=krb5 server:/export
iozone</b></p>

<p style="margin-left:11%; margin-top: 1em">this is
equivalent to:</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
&minus;o v3,sec=krb5 &minus;o v4,sec=krb5 server:/export
iozone</b></p>

<p style="margin-left:11%; margin-top: 1em">Example 7:
Using the &quot;custom&quot; workload</p>

<p style="margin-left:11%; margin-top: 1em">A main use case
of nfsometer is the &quot;custom&quot; workload &minus; it
allows <br>
the user to specify the command that nfsometer is to
run.</p>

<p style="margin-left:11%; margin-top: 1em">NOTE: the
command&rsquo;s cwd (current working directory) is the
runroot <br>
created on the server.</p>

<p style="margin-left:11%; margin-top: 1em"><b>export
NFSOMETER_CMD=&quot;echo foo &gt; bar&quot; <br>
export NFSOMETER_NAME=&quot;echo&quot; <br>
export NFSOMETER_DESC=&quot;Writes 4 bytes to a file&quot;
<br>
nfsometer server:/export custom</b></p>

<p style="margin-left:11%; margin-top: 1em">This will run 3
traces (v3, v4, v4.1) against server:/export of <br>
the command: <b>echo foo &gt; bar</b>.</p>

<p style="margin-left:11%; margin-top: 1em">Example 8:
Using the loadgen mode</p>

<p style="margin-left:11%; margin-top: 1em">Loadgen runs
several instances of a workload without capturing <br>
traces. The idea is that you use several clients to generate
<br>
load, then another client to measure performance of a loaded
<br>
server. The &quot;real&quot; run of nfsometer (not loadgen)
should mark <br>
the traces using the &minus;t option.</p>

<p style="margin-left:11%; margin-top: 1em">1) On client A,
run the cthon workload to get a baseline of <br>
a server without any load.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
trace server:/export cthon</b></p>

<p style="margin-left:11%; margin-top: 1em">2) When
that&rsquo;s done, start loadgen on client B:</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
&minus;n 10 loadgen server:/export dd_100m_1k</b></p>

<p style="margin-left:11%; margin-top: 1em">This runs 10
instances of dd_100m_1k workload on server:/export. <br>
It can take several minutes to start in an attempt to
stagger <br>
all the workload instances.</p>

<p style="margin-left:11%; margin-top: 1em">3) once all
instances are started, run the &quot;real&quot; nfsometer
<br>
trace on client A. Use the &minus;t option to mark the
traces <br>
as having run under load conditions:</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
&minus;t &quot;10_dd&quot; trace server:/export
cthon</b></p>

<p style="margin-left:11%; margin-top: 1em">4) Explain how
the tests were set up in the result notes. <br>
This should be run on client A (which has the traces:</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
notes</b></p>

<p style="margin-left:11%; margin-top: 1em">5) Now generate
the reports:</p>

<p style="margin-left:11%; margin-top: 1em"><b>nfsometer
report</b></p>

<p style="margin-left:11%; margin-top: 1em">Example 8: Long
running nfsometer trace</p>

<p style="margin-left:11%; margin-top: 1em">The
nfsometer.py script currently runs in the foreground. As
<br>
such, it will be killed if the tty gets a hangup or the
connection <br>
to the client is closed.</p>

<p style="margin-left:11%; margin-top: 1em">For the time
being, nfsometer should be run in a screen <br>
session, or run with nohup and the output redirected to a
file.</p>

<p style="margin-left:11%; margin-top: 1em">1) <b>screen
&minus;RD</b> <br>
2) <b>nfsometer &minus;n 2 server:/export iozone</b> <br>
3) close terminal window (or ^A^D) <br>
... <br>
4) reattach later with <b>screen &minus;RD</b> <br>
5) once nfsometer.py is done, results will be in
results/index.html</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">mountstats,
nfsstats</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">No known
bugs.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Weston Andros
Adamson (dros@netapp.com)</p>
<hr>
</body>
</html>
