<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 02:08:33 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Net::LDAP::FAQ</title>

</head>
<body>

<h1 align="center">Net::LDAP::FAQ</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#GENERAL">GENERAL</a><br>
<a href="#LDAP AND DIRECTORY TERMINOLOGY.">LDAP AND DIRECTORY TERMINOLOGY.</a><br>
<a href="#perl-ldap INSTALLATION">perl-ldap INSTALLATION</a><br>
<a href="#USING NET::LDAP">USING NET::LDAP</a><br>
<a href="#GETTING SEARCH RESULTS">GETTING SEARCH RESULTS</a><br>
<a href="#USING NET::LDAPS">USING NET::LDAPS</a><br>
<a href="#USING LDAP GROUPS.">USING LDAP GROUPS.</a><br>
<a href="#USING DSML.">USING DSML.</a><br>
<a href="#USING CONTROLS AND VIRTUAL LISTS.">USING CONTROLS AND VIRTUAL LISTS.</a><br>
<a href="#GENERAL QUESTIONS.">GENERAL QUESTIONS.</a><br>
<a href="#Using X.509 certificates.">Using X.509 certificates.</a><br>
<a href="#ADDITIONAL DIRECTORY AND LDAP RESOURCES.">ADDITIONAL DIRECTORY AND LDAP RESOURCES.</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Net::LDAP::FAQ
&minus; Frequently Asked Questions about Net::LDAP</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em"> perldoc Net::LDAP::FAQ</pre>


<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This document
serves to answer the most frequently asked questions on both
the perl-ldap Mailing List and those sent to Graham
Barr.</p>

<p style="margin-left:11%; margin-top: 1em">The latest
version of this <small>FAQ</small> can be found at</p>

<pre style="margin-left:11%; margin-top: 1em"> http://ldap.perl.org/FAQ.html</pre>


<h2>GENERAL
<a name="GENERAL"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>What is
perl-ldap?</b> <br>
perl-ldap is the distribution name. The perl-ldap
distribution contains the Net::LDAP modules.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Why another
Perl <small>LDAP</small> implementation?</b> <br>
perl-ldap&rsquo;s goal is to be as portable as possible. It
does this by being implemented completely in Perl. So
basically anywhere that Perl runs perl-ldap will run. This
is not true for other implementations which require a C
compiler.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Where can I
get it?</b> <br>
Perl-ldap is available from <small>CPAN.</small> You can
find the released versions at:</p>

<pre style="margin-left:11%; margin-top: 1em"> http://search.cpan.org/dist/perl&minus;ldap/</pre>


<p style="margin-left:11%; margin-top: 1em"><b>Is there a
web page for perl-ldap?</b> <br>
Yes there is at http://ldap.perl.org/</p>

<p style="margin-left:11%; margin-top: 1em"><b>Is there a
mailing list?</b> <br>
Yes there is at perl&minus;ldap@perl.org</p>

<p style="margin-left:11%; margin-top: 1em">You can
subscribe to this list by mailing
perl&minus;ldap&minus;subscribe@perl.org</p>

<p style="margin-left:11%; margin-top: 1em"><b>Is the
mailing list archived?</b> <br>
Yes, at http://nntp.perl.org/group/perl.ldap</p>

<p style="margin-left:11%; margin-top: 1em">Archives with
messages before we switched to using perl.org can be found
at</p>

<pre style="margin-left:11%; margin-top: 1em"> http://marc.theaimsgroup.com/?l=perl&minus;ldap&minus;dev</pre>


<p style="margin-left:11%; margin-top: 1em">There is also
an archive of the perl-ldap mailing list at</p>

<pre style="margin-left:11%; margin-top: 1em"> http://www.xray.mpe.mpg.de/mailing&minus;lists/perl&minus;ldap/</pre>


<p style="margin-left:11%; margin-top: 1em">which also has
messages from before the move.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Is there any
online documentation?</b> <br>
Yes. perl-ldap has online documentation at</p>

<pre style="margin-left:11%; margin-top: 1em"> http://ldap.perl.org/</pre>


<p style="margin-left:11%; margin-top: 1em">which will have
the latest documentation available.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Is there a
public repository?</b> <br>
Yes, there is a public Git repository at</p>

<pre style="margin-left:11%; margin-top: 1em"> https://github.com/perl&minus;ldap/perl&minus;ldap</pre>


<p style="margin-left:11%; margin-top: 1em"><b>Can I get
perl-ldap from the public Git repository?</b> <br>
Yes, anyone can pull perl-ldap from the public Git
repository on GitHub.</p>

<p style="margin-left:11%; margin-top: 1em">There are
several ways this can be done &minus; see below. <small><br>
CPAN</small></p>

<p style="margin-left:17%;">You can download it from
<small>CPAN</small> by following the &quot;Download&quot;
link on:</p>

<pre style="margin-left:17%; margin-top: 1em"> http://search.cpan.org/dist/perl&minus;ldap/</pre>


<p style="margin-left:17%; margin-top: 1em">Example;</p>

<pre style="margin-left:17%; margin-top: 1em"> http://search.cpan.org/CPAN/authors/id/M/MA/MARSCHAP/perl&minus;ldap&minus;0.54.tar.gz</pre>


<p style="margin-left:11%;">Git &minus; fork on GitHub</p>

<p style="margin-left:17%;">If you have an account on
Github (there&rsquo;s a free variant), you can easily fork
the perl-ldap respository on GitHub. When logged on to
GitHub, navigate to the perl-ldap repository</p>

<pre style="margin-left:17%; margin-top: 1em"> https://github.com/perl&minus;ldap/perl&minus;ldap</pre>


<p style="margin-left:17%; margin-top: 1em">and simply
click on the &quot;Fork&quot; button near the top-right
corner.</p>

<p style="margin-left:11%;">Git &minus; clone
repository</p>

<p style="margin-left:17%;">You can download latest
development version of perl-ldap from GitHub by cloning the
repsoitory using the command:</p>

<pre style="margin-left:17%; margin-top: 1em"> git clone https://github.com/perl&minus;ldap/perl&minus;ldap.git</pre>


<p style="margin-left:17%; margin-top: 1em">This command
will create a directory named &rsquo;perl&minus;ldap&rsquo;
in your current directory containing a local clone of the
repository.</p>

<p style="margin-left:17%; margin-top: 1em">Keeping your
local repository in sync with perl-ldap&rsquo;s GitHub
repository is easy:</p>

<pre style="margin-left:17%; margin-top: 1em">  cd perl&minus;ldap
  git pull</pre>


<p style="margin-left:11%;">Web page</p>

<p style="margin-left:17%;">Most of the time there is a
<small>URL</small> link on the perl-ldap home page on
ldap.perl.org that points to the latest released version of
perl-ldap. Due to the fact that humans must update the web
page to point to a new release it sometimes does not get
updated as quickly as it should.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is
Git?</b> <br>
Git (see http://git&minus;scm.com) is a distributed version
control system designed to keep track of source changes made
by groups of developers working on the same files, allowing
them to stay in sync with each other as each individual
chooses.</p>

<h2>LDAP AND DIRECTORY TERMINOLOGY.
<a name="LDAP AND DIRECTORY TERMINOLOGY."></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">In order to
help the user understand the perl-ldap module better some
key <small>LDAP</small> terminology is defined here.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is a
directory?</b> <br>
A directory is a special purpose hierarchical database that
usually contains typed information such as text strings,
binary data, or X.509 certificates.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is
<small>LDAP</small> ?</b> <small><br>
LDAP</small> stands for Lightweight Directory Access
Protocol. The word <i>Protocol</i> is the key word in the
definition given in the preceding sentence,
<small>LDAP</small> is <i><small>NOT</small></i> hardware or
software. It is a protocol that defines how a client and
server will communicate with one another.</p>

<p style="margin-left:11%; margin-top: 1em">The Lightweight
Directory Access Protocol is defined in a series of Requests
For Comments, better known as RFCs. The RFCs can be found on
the Internet at http://www.ietf.org/ (the master repository)
and many other places. There&rsquo;s a link to all the
LDAP-related RFCs at perl-ldap&rsquo;s web site,
http://ldap.perl.org/rfc.html. Some of the more important
<small>RFC</small> numbers are <small>RFC 4510 &minus;
4519</small> for <small>LDAP</small> (previously called
LDAPv3) and the historic <small>RFC 1777</small> for
LDAPv2.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is a
<small>LDAP</small> Directory?</b> <br>
In the strictest terms of the definition there is no such
thing as a <small>LDAP</small> directory. To be practical
about this situation every day directory professionals refer
to their directory as &quot; a <small>LDAP</small>
directory&quot; because it is easy to say and it does convey
the type of protocol used to communicate with their
directory. Using this definition a <small>LDAP</small>
directory is a directory whose server software conforms to
the Lightweight Directory Access Protocol when communicating
with a client.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is an
Entry?</b> <br>
The traditional directory definition of a directory object
is called an Entry. Entries are composed of attributes that
contain the information to be recorded about the object.</p>

<p style="margin-left:11%; margin-top: 1em">(An entry in
<small>LDAP</small> is somewhat analogous to a record in a
table in an <small>SQL</small> database, but don&rsquo;t get
too hung up about this analogy!)</p>

<p style="margin-left:11%; margin-top: 1em">Entries are
held in an upside-down tree structure. Entries can therefore
contain subordinate entries, and entries <b>must</b> have
one direct superior entry.</p>

<p style="margin-left:11%; margin-top: 1em">Entries with
subordinate entries are called &rsquo;non&minus;leaf&rsquo;
entries.</p>

<p style="margin-left:11%; margin-top: 1em">Entries without
subordinate entries are called &rsquo;leaf&rsquo;
entries.</p>

<p style="margin-left:11%; margin-top: 1em">An
entry&rsquo;s direct superior entry is called the
entry&rsquo;s &rsquo;parent&rsquo;.</p>


<p style="margin-left:11%; margin-top: 1em">&rsquo;Non&minus;leaf&rsquo;
entries are also said to have &rsquo;child&rsquo;
entries.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is an
attribute?</b> <br>
The entry(s) in a directory are composed of attributes that
contain information about the object. Each attribute has a
type and can contain one or more values.</p>

<p style="margin-left:11%; margin-top: 1em">For
example:</p>

<pre style="margin-left:11%; margin-top: 1em">  cn=Road Runner</pre>


<p style="margin-left:11%; margin-top: 1em">is an attribute
with a type named &quot;cn&quot;, and one value.</p>

<p style="margin-left:11%; margin-top: 1em">Each attribute
is described by a &rsquo;syntax&rsquo; which defines what
kind of information can be stored in the attributes values.
Trying to store a value that doesn&rsquo;t conform to the
attribute&rsquo;s syntax will result in an error.</p>

<p style="margin-left:11%; margin-top: 1em">For
example:</p>

<pre style="margin-left:11%; margin-top: 1em">  jpegPhoto=unknown</pre>


<p style="margin-left:11%; margin-top: 1em">is not
permitted by the directory, because jpegPhotos may only
contain JPEG-formatted images.</p>

<p style="margin-left:11%; margin-top: 1em">Most syntaxes
used in <small>LDAP</small> however describe text strings
rather than binary objects (like JPEGs or certificates.)</p>

<p style="margin-left:11%; margin-top: 1em">In LDAPv3 most
of these syntaxes support Unicode encoded using
<small>UTF&minus;8.</small> Because the Net::LDAP modules do
not change the strings that you pass in as attribute values
(they get sent to the <small>LDAP</small> server as-is) to
use accented characters you simply need to encode your
strings in <small>UTF&minus;8.</small> There are modules on
<small>CPAN</small> that will help you here.</p>

<p style="margin-left:11%; margin-top: 1em">Note that
LDAPv2 servers used something called T.61 instead of Unicode
and <small>UTF&minus;8.</small> Most servers do not
implement T.61 correctly, and it is recommended that you use
LDAPv3 instead.</p>

<p style="margin-left:11%; margin-top: 1em">Attributes may
also be searched. The algorithms used to perform different
kinds of searches are described by the attribute&rsquo;s
&rsquo;matching rules&rsquo;. Some matching rules are
case-sensitive and some are case-insensitive, for example.
Sometimes matching rules aren&rsquo;t defined for a
particular attribute: there&rsquo;s no way to search for
jpegPhotos that contain a substring!</p>

<p style="margin-left:11%; margin-top: 1em">You can examine
all of a server&rsquo;s attribute definitions by reading the
schema from the server.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is an
object class?</b> <br>
An object class is the name associated with a group of
attributes that <b>must</b> be present in an entry, and the
group of attributes that <b>may</b> also be present in an
entry.</p>

<p style="margin-left:11%; margin-top: 1em">Object classes
may be derived (subclassed) from other object classes. For
example the widely used &rsquo;inetOrgPerson&rsquo; object
class is derived from &rsquo;organizationalPerson&rsquo;,
which is itself derived from &rsquo;person&rsquo; which is
itself derived from &rsquo;top&rsquo;.</p>

<p style="margin-left:11%; margin-top: 1em">Every entry has
an attribute called &rsquo;objectClass&rsquo; that lists all
the names of object classes (and their superclasses) being
used with the entry.</p>

<p style="margin-left:11%; margin-top: 1em">You can examine
all of a server&rsquo;s objectclass definitions by reading
the schema from the server.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is a
Distinguished Name ( <small>DN</small> )?</b> <br>
Every entry in a directory has a Distinguished Name, or
<small>DN.</small> It is a unique Entry identifier
throughout the complete directory. No two Entries can have
the same <small>DN</small> within the same directory.</p>

<p style="margin-left:11%; margin-top: 1em">Examples of
DNs:</p>

<pre style="margin-left:11%; margin-top: 1em"> cn=Road Runner, ou=bird, dc=cartoon, dc=com
 ou=bird, dc=cartoon, dc=com
 dc=cartoon, dc=com
 dc=com</pre>


<p style="margin-left:11%; margin-top: 1em"><b>What is a
Relative Distinguished Name?</b> <br>
Every <small>DN</small> is made up of a sequence of Relative
Distinguished Names, or RDNs. The sequences of RDNs are
separated by commas (,). In LDAPv2 semi-colons (;) were also
allowed. There can be more than one identical
<small>RDN</small> in a directory, but they must have
different parent entries.</p>

<p style="margin-left:11%; margin-top: 1em">Technically, an
<small>RDN</small> contains attribute-value assertions, or
AVAs. When an <small>AVA</small> is written down, the
attribute name is separated from the attribute value with an
equals (=) sign.</p>

<p style="margin-left:11%; margin-top: 1em">Example of a
<small>DN:</small></p>

<pre style="margin-left:11%; margin-top: 1em"> cn=Road Runner,ou=bird,dc=cartoon,dc=com
 RDNs of the proceeding DN:
 RDN =&gt; cn=Road Runner
 RDN =&gt; ou=bird
 RDN =&gt; dc=cartoon
 RDN =&gt; dc=com</pre>


<p style="margin-left:11%; margin-top: 1em">RDNs can
contain multiple attributes, though this is somewhat
ususual. They are called multi-AVA RDNs, and each
<small>AVA</small> is separated in the <small>RDN</small>
from the others with a plus sign (+).</p>

<p style="margin-left:11%; margin-top: 1em">Example of a
<small>DN</small> with a multi-AVA <small>RDN:</small></p>

<pre style="margin-left:11%; margin-top: 1em"> cn=Road Runner+l=Arizona,ou=bird,dc=cartoon,dc=com</pre>


<p style="margin-left:11%; margin-top: 1em"><b>Where is an
entry&rsquo;s name held?</b> <br>
Entries do <b>not</b> contain their <small>DN.</small> When
you retrieve an entry from a search, the server will tell
you the <small>DN</small> of each entry.</p>

<p style="margin-left:11%; margin-top: 1em">On the other
hand, entries <b>do</b> contain their <small>RDN.</small>
Recall that the <small>RDN</small> is formed from one or
more attribute-value assertions (AVAs); each entry must
contain all the attributes and values in the
<small>RDN.</small></p>

<p style="margin-left:11%; margin-top: 1em">For example the
entry:</p>

<pre style="margin-left:11%; margin-top: 1em"> cn=Road Runner+l=Arizona,ou=bird,dc=cartoon,dc=com</pre>


<p style="margin-left:11%; margin-top: 1em"><b>must</b>
contain a &rsquo;cn&rsquo; attribute containing at least the
value &quot;Road Runner&quot;, <b>and</b> an &rsquo;l&rsquo;
attribute containing at least the value
&quot;Arizona&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">The attributes
used in the <small>RDN</small> may contain additional
values, but the entry still only has one
<small>DN.</small></p>

<p style="margin-left:11%; margin-top: 1em"><b>What is a
search base?</b> <br>
A search base is a Distinguished Name that is the starting
point of search queries.</p>

<p style="margin-left:11%; margin-top: 1em">Example of a
<small>DN:</small></p>

<pre style="margin-left:11%; margin-top: 1em"> cn=Road Runner,ou=bird,dc=cartoon,dc=com</pre>


<p style="margin-left:11%; margin-top: 1em">Possible search
base(s) for the proceeding <small>DN:</small></p>

<pre style="margin-left:11%; margin-top: 1em"> Base =&gt; cn=Road Runner,ou=bird,dc=cartoon,dc=com
 Base =&gt; ou=bird,dc=cartoon,dc=com
 Base =&gt; dc=cartoon,dc=com
 Base =&gt; dc=com</pre>


<p style="margin-left:11%; margin-top: 1em">Setting the
search base to the lowest possible branch of the directory
will speed up searches considerably.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is the
difference between a <small>LDAP</small> server and a
relational database?</b> <br>
The most basic difference is that a directory server is a
specialized database designed to provide fast searches.
While a relational database is optimized for transactions
(where a series of operations is counted as 1, thus if one
of the steps fails, the <small>RDBMS</small> can roll-back
to the state it was in before you started).</p>

<p style="margin-left:11%; margin-top: 1em">Directories
also typically are hierarchical in nature (
<small>RDBMS</small> is typically flat, but you can
implement a hierarchy using tables and queries),
networkable, distributed and replicated.</p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP</small>
provides an open-standard to a directory service.</p>

<p style="margin-left:11%; margin-top: 1em">Typically we
use <small>LDAP</small> for email directories (all popular
email clients provide an <small>LDAP</small> client now) and
authorization services (authentication and access
control).</p>

<p style="margin-left:11%; margin-top: 1em">You could use a
<small>RDBMS</small> for these types of queries but
there&rsquo;s no set standard, in particular over
<small>TCP/IP</small> to connect to databases over the
network. There&rsquo;s language specific protocols (like
Perl&rsquo;s <small>DBI</small> and Java&rsquo;s
<small>JDBC</small> ) that hide this problem behind an
<small>API</small> abstraction, but that&rsquo;s not a
replacement for a standard access protocol.</p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP</small>
is starting to be used on roles traditionally played by
<small>RDBMS</small> in terms of general data management
because it&rsquo;s easier to setup a <small>LDAP</small>
server (once you understand the basic nomenclature) and you
don&rsquo;t need a <small>DBA</small> to write your queries
and more importantly all <small>LDAP</small> servers speak
the same essential protocol, thus you don&rsquo;t have to
fuss with a database driver trying to connect it to the
Internet. Once you have an <small>LDAP</small> server up and
running, it&rsquo;s automatically available over the
&rsquo;net. It&rsquo;s possible to connect to a
<small>LDAP</small> server from a variety of mechanisms,
including just about every possible programming
language.</p>

<p style="margin-left:11%; margin-top: 1em">More
information on this topic can be found on the following
URLs;</p>

<pre style="margin-left:11%; margin-top: 1em"> http://www.openldap.org/faq/data/cache/378.html
 http://www.isode.com/whitepapers/ic&minus;6055.html</pre>


<p style="margin-left:11%; margin-top: 1em"><b>What is the
difference between a ldap reference and a ldap referral?</b>
<br>
A referral is returned when the <b>entire</b> operation must
be resent to another server.</p>

<p style="margin-left:11%; margin-top: 1em">A continuation
reference is returned when <b>part</b> of the operation must
be resent to another server.</p>

<p style="margin-left:11%; margin-top: 1em">See <small>RFC
4511</small> section 4.5.3 for more details.</p>

<h2>perl-ldap INSTALLATION
<a name="perl-ldap INSTALLATION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
install perl-ldap?</b> <br>
To install the modules that are in the perl-ldap
distribution follow the same steps that you would for most
other distributions found on <small>CPAN,</small> that
is</p>

<pre style="margin-left:11%; margin-top: 1em">   # replace 0.44 with the version you have
   gunzip perl&minus;ldap&minus;0.44.tar.gz
   tar xvf perl&minus;ldap&minus;0.44.tar
   cd perl&minus;ldap&minus;0.44
   perl Makefile.PL
   make
   make test
   make install</pre>


<p style="margin-left:11%; margin-top: 1em"><b>But I do not
have make, how can I install perl-ldap?</b> <br>
Well as luck would have it the modules in perl-ldap do not
do anything complex, so a simple copy is enough to install.
First run</p>

<pre style="margin-left:11%; margin-top: 1em">  perl &minus;V</pre>


<p style="margin-left:11%; margin-top: 1em">This will
output information about the version of Perl you have
installed. Near the bottom you will find something like</p>

<pre style="margin-left:11%; margin-top: 1em">  @INC:
    /usr/local/lib/perl/5.8.3
    /usr/local/share/perl/5.8.3
    /usr/lib/perl5
    /usr/share/perl5
    /usr/lib/perl/5.8.3
    /usr/share/perl/5.8.3
    /usr/local/lib/site_perl</pre>


<p style="margin-left:11%; margin-top: 1em">This is a list
of directories that Perl searches when it is looking for a
module. The directory you need is the site_perl directory,
but without the system architecture name, in this case it is
<tt>&quot;/usr/local/lib/site_perl&quot;</tt>. The files
required can then be installed with</p>

<pre style="margin-left:11%; margin-top: 1em">   # replace 0.44 with the version you have
   gunzip perl&minus;ldap&minus;0.44.tar.gz
   tar xvf perl&minus;ldap&minus;0.44.tar
   cd perl&minus;ldap&minus;0.44/lib
   cp * /usr/local/lib/site_perl</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
load perl-ldap into an ActiveState Perl installation?</b>
<br>
There are several ways that perl-ldap can be installed into
an ActiveState Perl tree.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>1.</p></td>
<td width="3%"></td>
<td width="83%">


<p>The ActiveState ppm command can be used to install
perl-ldap. When a new version of perl-ldap is released, it
takes ActiveState a period of time to get the new release
into the ActiveState ppm system.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2.</p></td>
<td width="3%"></td>
<td width="83%">


<p>If the user has nmake installed, the user can do a
normal Perl module install using nmake instead of make.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>3.</p></td>
<td width="3%"></td>
<td width="83%">


<p>If the user does not have nmake or make, the user can
install perl-ldap using the install-nomake script by issuing
the following command.</p></td></tr>
</table>

<pre style="margin-left:17%; margin-top: 1em"> perl install&minus;nomake</pre>


<p style="margin-left:17%; margin-top: 1em">The
install-nomake script can be used on any system that does
not have make installed.</p>

<p style="margin-left:11%; margin-top: 1em"><b>What other
modules will I need?</b> <br>
perl-ldap uses other Perl modules. Some are required, but
some are optional (i.e. required to use certain features
only).</p>

<p style="margin-left:11%; margin-top: 1em">If you are
using a Linux system, many of the distributions have
packages that you can install using the distribution&rsquo;s
package management tools (e.g. apt, rpm, ...).</p>

<p style="margin-left:11%; margin-top: 1em">Alternatively,
you may use your favorite web search engine to find the
package that you need. <br>
Convert::ASN1</p>

<p style="margin-left:17%;">This module converts between
Perl data structures and <small>ASN.1,</small> and is
required for perl-ldap to work.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release from <br>
http://search.cpan.org/search?module=Convert::ASN1</p>

<p style="margin-left:11%;">OpenSSL and IO::Socket::SSL</p>

<p style="margin-left:17%;">If you want to use encrypted
connections, either via start_tls or <small>LDAPS</small>
connections, you will need this module and the OpenSSL
software package.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release of IO::Socket::SSL from <br>
http://search.cpan.org/search?module=IO::Socket::SSL</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release of OpenSSL from <br>
http://www.openssl.org/</p>

<p style="margin-left:11%;">IO::Socket::INET6</p>

<p style="margin-left:17%;">For connecting to
<small>LDAP</small> servers via IPv6, IO::Socket::INET6 is
required. Its presence is detected at runtime, so that
perl-ldap can be installed without it, and automatically
gains IPv6 support as soon as IO::Socket::INET6 gets
installed.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest releases from <br>
http://search.cpan.org/search?module=IO::Socket::INET6</p>

<p style="margin-left:11%;">Authen::SASL</p>

<p style="margin-left:17%;">This module is optional. You
only need to install Authen::SASL if you want to use the
<small>SASL</small> authentication methods.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release from <br>
http://search.cpan.org/search?module=Authen::SASL</p>

<p style="margin-left:11%;">Digest::MD5</p>

<p style="margin-left:17%;">This module is optional. It
also requires a C compiler when installing. You only need to
install Digest::MD5 if you want to use the <small>SASL
DIGEST&minus;MD5</small> authentication mechanism.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release from <br>
http://search.cpan.org/search?module=Digest::MD5</p>

<p style="margin-left:17%; margin-top: 1em">As Digest::MD5
is part of the Perl core modules since Perl 5.7.3, you only
need a C compiler if you want to install a version that is
newer than the version distributed with your Perl
installation.</p>

<p style="margin-left:11%;">Digest::HMAC_MD5</p>

<p style="margin-left:17%;">This optional module is
required only if you want to use the <small>SASL
CRAM&minus;MD5</small> authentication mechanism.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release from <br>
http://search.cpan.org/search?module=Digest::HMAC_MD5</p>

<p style="margin-left:11%;"><small>GSSAPI</small></p>

<p style="margin-left:17%;">This optional module is
required only if you want to use the <small>SASL
GSSAPI</small> authentication mechanism (e.g. for Kerberos
authentication).</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release from <br>
http://search.cpan.org/search?module=GSSAPI</p>

<p style="margin-left:11%;">URI::ldap, URI::ldaps, and
URI::ldapi</p>

<p style="margin-left:17%;">These modules are optional. You
only need to install them if you want to parse ldap://,
ldaps:// or ldapi:// URIs using ldap_parse_uri in
Net::LDAP::Util. or use LWP::Protocol::ldap,
LWP::Protocol::ldaps, or LWP::Protocol::ldapi.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest releases from <br>
http://search.cpan.org/search?module=URI::ldap <br>
http://search.cpan.org/search?module=URI::ldaps <br>
http://search.cpan.org/search?module=URI::ldapi</p>

<p style="margin-left:11%;">LWP::Protocol, LWP::MediaTypes,
HTTP::Negotiate, and HTTP::Response</p>

<p style="margin-left:17%;">These optional modules are
needed if you want to use perl-ldap&rsquo;s
LWP::Protocol::ldap, LWP::Protocol::ldaps, or
LWP::Protocol::ldapi modules.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest releases from <br>
http://search.cpan.org/search?module=LWP::Protocol <br>
http://search.cpan.org/search?module=LWP::MediaTypes <br>
http://search.cpan.org/search?module=HTTP::Negotiate <br>
http://search.cpan.org/search?module=HTTP::Response</p>

<p style="margin-left:11%;"><small>JSON</small></p>

<p style="margin-left:17%;">This optional module is
required for JSON-formatted output of perl-ldap&rsquo;s
LWP::Protocol::ldap, LWP::Protocol::ldaps, or
LWP::Protocol::ldapi modules.</p>

<p style="margin-left:17%; margin-top: 1em">If you need it,
you can optain the latest releases from <br>
http://search.cpan.org/search?module=JSON</p>

<p style="margin-left:11%;">Time::Local</p>

<p style="margin-left:17%;">This module is optional, and
only required if you want to convert between
<small>UNIX</small> time and generalizedTime using the
functions provided in Net::LDAP::Util.</p>

<p style="margin-left:11%;"><small>XML::SAX</small> and
XML::SAX::Writer</p>

<p style="margin-left:17%;">If you want to parse or write
DSMLv1 documents with Net::LDAP::DSML to you will need these
optional modules.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest releases from <br>
http://search.cpan.org/search?module=XML::SAX <br>
http://search.cpan.org/search?module=XML::SAX::Writer</p>


<p style="margin-left:11%;">ResourcePool::Factory::Net::LDAP</p>

<p style="margin-left:17%;">If you want to use failover the
ResourcePool::Factory::Net::LDAP Perl module provides
methods to do this.</p>

<p style="margin-left:17%; margin-top: 1em">You can obtain
the latest release from <br>

http://search.cpan.org/search?module=ResourcePool::Factory::Net::LDAP</p>

<h2>USING NET::LDAP
<a name="USING NET::LDAP"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
connect to my server?</b> <br>
The connection to the server is created when you create a
new Net::LDAP object, e.g.</p>

<pre style="margin-left:11%; margin-top: 1em">  $ldap = Net::LDAP&minus;&gt;new($server);</pre>



<p style="margin-left:11%; margin-top: 1em"><b>Net::LDAP&minus;&gt;new
sometimes returns undef, why?</b> <br>
The constructor will return undef if there was a problem
connecting to the specified server. Any error message will
be available in $@</p>

<p style="margin-left:11%; margin-top: 1em"><b>What is the
proper format of the bind <small>DN</small> ?</b> <br>
The <small>DN</small> used to bind to a directory is a
<small>FULLY QUALIFIED DN.</small> The exact structure of
the <small>DN</small> will depend on what data has been
stored in the server.</p>

<p style="margin-left:11%; margin-top: 1em">The following
are valid examples.</p>

<pre style="margin-left:11%; margin-top: 1em">  uid=clif,ou=People,dc=umich,dc=edu
  cn=directory manager,ou=admins,dc=umich,dc=edu</pre>


<p style="margin-left:11%; margin-top: 1em">In some servers
the following would be a valid fully qualified
<small>DN</small> of the directory manager.</p>

<pre style="margin-left:11%; margin-top: 1em">  cn=directory manager</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
tell when the server returns an error,</b> <i>bind()</i>
<b>always returns true?</b> <br>
Most methods in Net::LDAP return a Net::LDAP::Message
object, or a sub-class of that. This object will hold the
results from the server, including the result code.</p>

<p style="margin-left:11%; margin-top: 1em">So, for
example, to determine the result of the bind operation.</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;bind( $dn, password =&gt; $passwd );
  if ( $mesg&minus;&gt;code ) {
    # Handle error codes here
  }</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
set the <small>LDAP</small> version of a connection to my
ldap server?</b> <br>
This is done by adding the version option when connecting or
binding to the <small>LDAP</small> server.</p>

<p style="margin-left:11%; margin-top: 1em">For
example;</p>

<pre style="margin-left:11%; margin-top: 1em">  $ldap = Net::LDAP&minus;&gt;new( $server, version =&gt; 3 );</pre>


<p style="margin-left:11%; margin-top: 1em">or</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;bind( $dn, password =&gt; $passwd, version =&gt; 3 );</pre>


<p style="margin-left:11%; margin-top: 1em">Valid version
numbers are 2 and 3. As of perl-ldap 0.27 the default
<small>LDAP</small> version is 3.</p>

<p style="margin-left:11%; margin-top: 1em"><b>I did a
search on my directory using the &rsquo;search&rsquo;
method. Where did the results go?</b> <br>
Your search results are stored in a &rsquo;search
object&rsquo;. Consider the following:</p>

<pre style="margin-left:11%; margin-top: 1em"> use Net::LDAP;
 $ldap = Net::LDAP&minus;&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap&minus;&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       filter =&gt; &quot;uid=jsmith&quot;,
                      );</pre>


<p style="margin-left:11%; margin-top: 1em">$mesg is a
search object. It is a reference blessed into the
Net::LDAP::Search package. By calling methods on this object
you can obtain information about the result and also the
individual entries.</p>

<p style="margin-left:11%; margin-top: 1em">The first thing
to check is if the search was successful. This is done with
with the method <tt>$mesg</tt>&minus;&gt;code. This method
will return the status code that the server returned. A
success will yield a zero value, but there are other values,
some of which could also be considered a success. See
Net::LDAP::Constant</p>

<pre style="margin-left:11%; margin-top: 1em">  use Net::LDAP::Util qw(ldap_error_text);
  die ldap_error_text($mesg&minus;&gt;code)
    if $mesg&minus;&gt;code;</pre>


<p style="margin-left:11%; margin-top: 1em">There are two
ways in which you can access the entries. You can access
then with an index or you can treat the container like a
stack and shift each entry in turn. For example</p>

<pre style="margin-left:11%; margin-top: 1em">  # as an array
  # How many entries were returned from the search
  my $max = $mesg&minus;&gt;count;
  for (my $index = 0 ; $index &lt; $max ; $index++) {
    my $entry = $mesg&minus;&gt;entry($index);
    # ...
  }
  # or as a stack
  while (my $entry = $mesg&minus;&gt;shift_entry) {
    # ...
  }</pre>


<p style="margin-left:11%; margin-top: 1em">In each case
<tt>$entry</tt> is an entry object. It is a reference
blessed into the Net::LDAP::Entry package. By calling
methods on this object you can obtain information about the
entry.</p>

<p style="margin-left:11%; margin-top: 1em">For example, to
obtain the <small>DN</small> for the entry</p>

<pre style="margin-left:11%; margin-top: 1em">  $dn = $entry&minus;&gt;dn;</pre>


<p style="margin-left:11%; margin-top: 1em">To obtain the
attributes that a given entry has</p>

<pre style="margin-left:11%; margin-top: 1em">  @attrs = $entry&minus;&gt;attributes;</pre>


<p style="margin-left:11%; margin-top: 1em">And to get the
list of values for a given attribute</p>

<pre style="margin-left:11%; margin-top: 1em">  @values = $entry&minus;&gt;get( 'sn' );</pre>


<p style="margin-left:11%; margin-top: 1em">And to get the
first of the values for a given attribute</p>

<pre style="margin-left:11%; margin-top: 1em">  $values = $entry&minus;&gt;get( 'cn' );</pre>


<p style="margin-left:11%; margin-top: 1em">One thing to
remember is that attribute names are case insensitive, so
&rsquo;sn&rsquo;, &rsquo;Sn&rsquo;, &rsquo;sN&rsquo; and
&rsquo; <small>SN</small> &rsquo; are all the same.</p>

<p style="margin-left:11%; margin-top: 1em">So, if you want
to print all the values for the attribute <tt>'ou'</tt> then
this is as simple as</p>

<pre style="margin-left:11%; margin-top: 1em">  foreach ($entry&minus;&gt;get_value( 'ou' )) {
      print $_,&quot;\n&quot;;
    }</pre>


<p style="margin-left:11%; margin-top: 1em">Now if you just
want to print all the values for all the attributes you can
do</p>

<pre style="margin-left:11%; margin-top: 1em">  foreach my $attr ($entry&minus;&gt;attributes) {
    foreach my $value ($entry&minus;&gt;get_value($attr)) {
      print $attr, &quot;: &quot;, $value, &quot;\n&quot;;
    }
  }</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
limit the scope of a directory search?</b> <br>
You limit the scope of a directory search by setting the
scope parameter of search request. Consider the
following:</p>

<pre style="margin-left:11%; margin-top: 1em"> use Net::LDAP;
 $ldap = Net::LDAP&minus;&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap&minus;&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       scope  =&gt; 'sub',
                       filter =&gt; &quot;uid=jsmith&quot;,
                      );</pre>


<p style="margin-left:11%; margin-top: 1em">Values for the
scope parameter are as follows. <br>
base</p>

<p style="margin-left:17%;">Search only the base
object.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p>one</p></td>
<td width="2%"></td>
<td width="81%">


<p>Search the entries immediately below the base
object.</p> </td>
<td width="2%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p>sub</p></td>
<td width="2%"></td>
<td width="81%"></td>
<td width="2%">
</td></tr>
</table>

<p style="margin-left:11%;">subtree</p>

<p style="margin-left:17%;">Search the whole tree below
(and including) the base object. This is the default.</p>

<p style="margin-left:11%;">children</p>

<p style="margin-left:17%;">Search the whole subtree below
the base object, excluding the base object itself.</p>

<p style="margin-left:17%; margin-top: 1em">Note:
<i>children</i> scope requires LDAPv3 subordinate feature
extension.</p>

<h2>GETTING SEARCH RESULTS
<a name="GETTING SEARCH RESULTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">There are two
ways of retrieving the results of a requested
<small>LDAP</small> search; inline and by using a callback
subroutine.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>USING
THE INLINE APPROACH</small></b> <br>
Using the inline approach involves requesting the data and
then waiting for all of the data to be returned before the
user starts processing the data.</p>

<p style="margin-left:11%; margin-top: 1em">Example:</p>

<pre style="margin-left:11%; margin-top: 1em"> use Net::LDAP;
 $ldap = Net::LDAP&minus;&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap&minus;&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       scope  =&gt; 'sub',
                       filter =&gt; &quot;sn=smith&quot;,
                      );
  #
  # At this point the user can get the returned data as an array
  # or as a stack.
  # In this example we will use an array
  # How many entries were returned from the search
  my $max = $mesg&minus;&gt;count;
  for (my $index = 0 ; $index &lt; $max ; $index++)
  {
    my $entry = $mesg&minus;&gt;entry($index);
    my $dn = $entry&minus;&gt;dn; # Obtain DN of this entry
    @attrs = $entry&minus;&gt;attributes; # Obtain attributes for this entry.
    foreach my $var (@attrs)
    {
     #get a list of values for a given attribute
     $attr = $entry&minus;&gt;get_value( $var, asref =&gt; 1 );
     if ( defined($attr) )
     {
         foreach my $value ( @$attr )
         {
          print &quot;$var: $value\n&quot;;  # Print each value for the attribute.
         }
     }
    }
  }</pre>


<p style="margin-left:11%; margin-top: 1em">As you can see
the example is straightforward, but there is one drawback to
this approach. You must wait until all entries for the
request search to be returned before you can process the
data. If there several thousand entries that match the
search filter this could take quite a long time period.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>USING
THE CALLBACK SUBROUTINE APPROACH</small></b> <br>
Using the callback approach involves requesting the data be
sent to a callback subroutine as each entry arrives at the
client.</p>

<p style="margin-left:11%; margin-top: 1em">A callback is
just a subroutine that is passed two parameters when it is
called, the mesg and entry objects.</p>

<p style="margin-left:11%; margin-top: 1em">Example:</p>

<pre style="margin-left:11%; margin-top: 1em"> use Net::LDAP;
 $ldap = Net::LDAP&minus;&gt;new('ldap.acme.com') or die &quot;$@&quot;;
 $mesg = $ldap&minus;&gt;search(
                       base   =&gt; &quot;o=acme.com&quot;,
                       scope  =&gt; 'sub',
                       filter =&gt; &quot;sn=smith&quot;,
                       callback =&gt; \&amp;callback,
                      );
 #
 # At this point the user needs to check the status of the
 # ldap search.
 #
 if ( $mesg&minus;&gt;code )
 {
    $errstr = $mesg&minus;&gt;code;
    print &quot;Error code:  $errstr\n&quot;;
    $errstr = ldap_error_text($errstr);
    print &quot;$errstr\n&quot;;
 }
 sub callback
 {
 my ( $mesg, $entry) = @_;
   #
   # First you must check to see if something was returned.
   # Last execution of callback subroutine will have no
   # defined entry and mesg object
   #
   if ( !defined($entry) )
   {
     print &quot;No records found matching filter $match.\n&quot;
     if ($mesg&minus;&gt;count == 0) ; # if mesg is not defined nothing will print.
     return;
   }
   my $dn = $entry&minus;&gt;dn; # Obtain DN of this entry
   @attrs = $entry&minus;&gt;attributes; # Obtain attributes for this entry.
   foreach my $var (@attrs)
   {
    #get a list of values for a given attribute
    $attr = $entry&minus;&gt;get_value( $var, asref =&gt; 1 );
    if ( defined($attr) )
    {
      foreach my $value ( @$attr )
      {
        print &quot;$var: $value\n&quot;;  # Print each value for the attribute.
      }
    }
   }
   #
   # For large search requests the following line of code
   # may be very important, it will reduce the amount of memory
   # used by the search results.
   #
   # If the user is not worried about memory usage then the line
   # of code can be omitted.
   #
   $mesg&minus;&gt;pop_entry;
 }  # End of callback subroutine</pre>


<p style="margin-left:11%; margin-top: 1em">As you can see
the example is straightforward and it does not waste time
waiting for all of the entries to be returned. However if
the pop_entry method is not used the callback approach can
allocate a lot of memory to the search request.</p>

<h2>USING NET::LDAPS
<a name="USING NET::LDAPS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Using an
<small>SSL</small> network connection, how do I connect to
my server?</b> <br>
This class is a subclass of Net::LDAP so all the normal
Net::LDAP methods can be used with a Net::LDAPS object; see
the documentation for Net::LDAP to find out how to query a
directory server using the <small>LDAP</small> protocol.</p>

<p style="margin-left:11%; margin-top: 1em">The connection
to the server is created when you create a new Net::LDAPS
object, e.g.</p>

<pre style="margin-left:11%; margin-top: 1em">  $ldaps = Net::LDAPS&minus;&gt;new($server,
                           port =&gt; '10000',
                           verify =&gt; 'require',
                           capath =&gt; '/usr/local/cacerts/',
                           );</pre>


<p style="margin-left:11%; margin-top: 1em">Starting with
version 0.28 perl-ldap also supports URIs in the new method.
So, the above can also be expressed as:</p>

<pre style="margin-left:11%; margin-top: 1em">  $ldaps = Net::LDAP&minus;&gt;new(&quot;ldaps://$server&quot;,
                           port =&gt; '10000',
                           verify =&gt; 'require',
                           capath =&gt; '/usr/local/cacerts/',
                           );</pre>


<p style="margin-left:11%; margin-top: 1em">There are
additional options to the new method with
<small>LDAPS</small> URIs and the <small>LDAPS</small> new
method and several additional methods are included in the
<small>LDAPS</small> object class.</p>

<p style="margin-left:11%; margin-top: 1em">For further
information and code examples read the <small>LDAPS</small>
module documentation; perldoc Net::LDAPS</p>

<h2>USING LDAP GROUPS.
<a name="USING LDAP GROUPS."></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>What are
<small>LDAP</small> groups?</b> <small><br>
LDAP</small> groups are object classes that contain an
attribute that can store multiple <small>DN</small> values.
Two standard object classes are &rsquo;groupOfNames&rsquo;
(which has a &rsquo;member&rsquo; attribute) and
&rsquo;groupOfUniqueNames&rsquo; (which has a
&rsquo;uniqueMember&rsquo; attribute.)</p>

<p style="margin-left:11%; margin-top: 1em">According to
the RFCs a group can be a member of another group, but some
<small>LDAP</small> server vendors restrict this flexibility
by not allowing nested groups in their servers.</p>

<p style="margin-left:11%; margin-top: 1em">Two scripts for
working with groups are available in the contrib directory.
They are isMember.pl and printMembers.pl.</p>

<p style="margin-left:11%; margin-top: 1em"><b>How do you
format a filter to search for entries whose
&rsquo;member&rsquo; attribute has a particular value?</b>
<br>
Asking for (member=*) is <small>OK &minus;</small> the
directory uses the equality matching rule which is defined
for the member attribute.</p>

<p style="margin-left:11%; margin-top: 1em">Asking for
(member=c*) is not <small>OK &minus;</small> there is no
defined substring matching rule for the member attribute.
That&rsquo;s because the member values are *not* strings,
but distinguished names. There is no substring matching rule
for DNs, see <small>RFC 4519</small> section 2.7.</p>

<p style="margin-left:11%; margin-top: 1em">What you have
to do is get the results of (member=*) and then select the
required results from the returned values. You need to do
this using knowledge of the string representation of DNs
defined in <small>RFC 4514,</small> which is important
because the same <small>DN</small> can have different string
representations. So you need to perform some
canonicalization if you want to be correct.</p>

<h2>USING DSML.
<a name="USING DSML."></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
access <small>DSML</small> features from perl-ldap?</b> <br>
Directory Service Markup Language ( <small>DSML</small> ) is
the <small>XML</small> standard for representing directory
service information in <small>XML.</small></p>

<p style="margin-left:11%; margin-top: 1em">Support for
<small>DSML</small> is included in perl-ldap starting with
version .20.</p>

<p style="margin-left:11%; margin-top: 1em">At the moment
this module only reads and writes <small>DSML</small> entry
entities. It cannot process any schema entities because
schema entities are processed differently than elements.</p>

<p style="margin-left:11%; margin-top: 1em">Eventually this
module will be a full level 2 consumer and producer enabling
you to give you full <small>DSML</small> conformance.</p>

<p style="margin-left:11%; margin-top: 1em">The
specification for <small>DSML</small> is at
http://www.oasis&minus;open.org/specs/</p>

<p style="margin-left:11%; margin-top: 1em">For further
information and code examples read the <small>DSML</small>
module documentation; perldoc Net::LDAP::DSML</p>

<h2>USING CONTROLS AND VIRTUAL LISTS.
<a name="USING CONTROLS AND VIRTUAL LISTS."></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
access the Control features?</b> <br>
Support for <small>LDAP</small> version 3 Control objects is
included in perl-ldap starting with version .20.</p>

<p style="margin-left:11%; margin-top: 1em">For further
information and code examples read the Control module
documentation; perldoc Net::LDAP::Control</p>

<p style="margin-left:11%; margin-top: 1em"><b>How do I
access the Virtual List features?</b> <br>
Support for Virtual Lists is included in perl-ldap starting
with version .20.</p>

<p style="margin-left:11%; margin-top: 1em">For further
information and code examples read the Control module
documentation; perldoc Net::LDAP::Control</p>

<h2>GENERAL QUESTIONS.
<a name="GENERAL QUESTIONS."></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Are there
any other code examples.</b> <br>
Yes, there is an Examples pod file. To view the pod do the
following command; perldoc Net::LDAP::Examples</p>

<p style="margin-left:11%; margin-top: 1em">There is user
contributed software in the contrib directory that is
supplied with the perl-ldap distribution. This is an
excellent source of information on how to use the perl-ldap
module.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Are there
any performance issues with perl-ldap?</b> <br>
In the vast majority of use cases (one user has suggested 9
out of 10) there are no performance issues with
perl-ldap.</p>

<p style="margin-left:11%; margin-top: 1em">Where you may
wish to use perl-ldap to perform, for example, a very large
number of queries (e.g. 10,000) in succession you may find a
noticeable performance difference between perl-ldap and non
pure-Perl modules. This is not because of perl-ldap itself
but because of the pure-Perl Convert::ASN1 module that it
depends on.</p>

<p style="margin-left:11%; margin-top: 1em">You should make
up your own mind, based upon your own situation (performance
requirements, hardware etc.) as to whether you should use
perl-ldap or not. The figures quoted in this answer are only
indicative, and will differ for different people.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Can I
contribute Perl scripts that use perl-ldap to the contrib
section?</b> <br>
Any one can submit a Perl script that uses perl-ldap for
inclusion in the contrib section. The perl-ldap maintainers
will determiner if the script will be included and will do
the initial check in of the script to the Git repository at
https://github.com/perl&minus;ldap/perl&minus;ldap.</p>

<p style="margin-left:11%; margin-top: 1em">There are a
couple of requirements for consideration.</p>

<p style="margin-left:11%; margin-top: 1em">You must supply
a one line description of your script to be included in the
contrib <small>README</small> file.</p>

<p style="margin-left:11%; margin-top: 1em">Inside the
script will be the pod documentation for the script. No
auxiliary documentation will be allowed. For examples of how
to do this see the tklkup script currently in the contrib
section.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Is it
possible to get a complete entry, <small>DN</small> and
attributes without specifying the attributes name?</b> <br>
Yes, just specify you want a list of no attributes back. The
<small>RFC</small> says that this tells the server to return
all readable attributes back (there may be access controls
to prevent some from being returned.)</p>

<p style="margin-left:11%; margin-top: 1em">So in the
search method, just set (for LDAPv2):</p>

<pre style="margin-left:11%; margin-top: 1em">                attrs =&gt; [ ]</pre>


<p style="margin-left:11%; margin-top: 1em">If you are
using LDAPv3, you can specify an attribute called
&quot;*&quot; instead, which lets you ask for additional
(i.g. operational) attributes in the same search.</p>

<pre style="margin-left:11%; margin-top: 1em">                attrs =&gt; [ &quot;*&quot; ]</pre>


<p style="margin-left:11%; margin-top: 1em">To get all
operational attributes in a search, some servers allow the
use of the &quot;+&quot; pseudo attribute. So that with
these servers</p>

<pre style="margin-left:11%; margin-top: 1em">                attrs =&gt; [ &quot;*&quot;, &quot;+&quot; ]</pre>


<p style="margin-left:11%; margin-top: 1em">will return the
most information from the server.</p>

<p style="margin-left:11%; margin-top: 1em"><b>How do I put
a <small>JPEG</small> photo into a entry in the
directory?</b> <br>
Follow the following code example, replacing the (...) with
whatever is relevant to your setup.</p>

<pre style="margin-left:11%; margin-top: 1em">  use Net::LDAP;
  use Net::LDAP::Util qw(ldap_error_text);
  use CGI;
  local $/ = undef;
  my $jpeg = &lt;$filename&gt;;
  my $ldap = Net::LDAP&minus;&gt;new(...);
  my $res = $ldap&minus;&gt;bind(...);
     $res = $ldap&minus;&gt;modify(...,
                   add =&gt; [ 'jpegPhoto' =&gt; [ $jpeg ] ]);
     $res = $ldap&minus;&gt;unbind();</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How do I add
a jpeg photo into a entry in the directory via
html-forms?</b> <br>
Follow the following code example, replacing the (...) with
whatever is relevant to your setup.</p>

<pre style="margin-left:11%; margin-top: 1em">  use Net::LDAP;
  use Net::LDAP::Util qw(ldap_error_text);
  use CGI;
  my $q = new CGI;
  print $q&minus;&gt;header;
  print $q&minus;&gt;start_html(&minus;title =&gt; 'Change JPEG photo');
  if ($q&minus;&gt;param('Update')) {
          my $filename = $q&minus;&gt;param('jpeg');
          local $/ = undef;
          my $jpeg = &lt;$filename&gt;;
          my $ldap = Net::LDAP&minus;&gt;new(...);
          my $res = $ldap&minus;&gt;bind(...);
          $res = $ldap&minus;&gt;modify(...,
                          add =&gt; [ 'jpegPhoto' =&gt; [ $jpeg ] ]);
          $res = $ldap&minus;&gt;unbind();
  } else {
          print $q&minus;&gt;start_multipart_form();
          print $q&minus;&gt;filefield(&minus;name =&gt; 'jpeg', &minus;size =&gt; 50);
          print $q&minus;&gt;submit('Update');
          print $q&minus;&gt;end_form();
  }
  print $q&minus;&gt;end_html();</pre>


<p style="margin-left:11%; margin-top: 1em"><b>What happens
when you delete an attribute that does not exist?</b> <br>
It is an error to delete an attribute that doesn&rsquo;t
exist. When you get the error back the server ignores the
entire modify operation you sent it, so you need to make
sure the error doesn&rsquo;t happen.</p>

<p style="margin-left:11%; margin-top: 1em">Another
approach, if you are using LDAPv3 (note beginning with
version .27 Net::LDAP uses LDAPv3 by default) is to use a
&rsquo;replace&rsquo; with your attribute name and no
values. In LDAPv3, this is defined to always work even if
that attribute doesn&rsquo;t exist in the entry.</p>

<p style="margin-left:11%; margin-top: 1em">ie:</p>

<pre style="margin-left:11%; margin-top: 1em">  my $mesg = $ldap&minus;&gt;modify( $entry, replace =&gt; { %qv_del_arry } );</pre>


<p style="margin-left:11%; margin-top: 1em">But make sure
you are using LDAPv3, because that is defined to <b>not</b>
work in LDAPv2. (A nice incompatibility between LDAPv2 and
LDAPv3.)</p>

<p style="margin-left:11%; margin-top: 1em"><b>How can I
delete a referral from an <small>LDAP</small> tree?</b> <br>
Since this is a proprietary feature, you will have to check
your server&rsquo;s documentation. You might find that you
need to use a control. If there is a control called
something like managedsait, that&rsquo;s the one you should
probably use. For proper operation you will need the oid
number for managedsait; 2.16.840.1.113730.3.4.2 and do not
specify a value for type.</p>

<p style="margin-left:11%; margin-top: 1em">The code
required will look similar to the following code
snippet.</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg =  $ldap&minus;&gt;delete(&quot;ref=\&quot;ldap://acme/c=us,o=bricks\&quot;,o=clay&quot;,
                  control =&gt; {type =&gt; &quot;2.16.840.1.113730.3.4.2&quot;} );</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How do I add
an <small>ACI/ACL</small> entry to a directory server with
perl-ldap?</b> <br>
ACIs and ACLs are proprietary features in
<small>LDAP.</small> The following code snippet works with a
Netscape directory server. You will need the specify the
correct <small>DN</small> (&minus;DN&minus;) and correct
attribute(s) (&minus;nom attr&minus;).</p>

<pre style="margin-left:11%; margin-top: 1em">  my $aci = '(target=&quot;ldap:///&minus;DN&minus;&quot;)(targetattr=&quot;&minus;nom attr&minus;&quot;)(version 3.0;
              acl &quot;&minus;nom acl&minus;&quot;; deny(all) userdn = &quot;ldap:///self&quot;;)' ;
  $ldap&minus;&gt;modify($dn_modif, add =&gt; {'aci' =&gt; $aci });</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
avoid file type and data type mis-matching when loading data
from a Win32 system?</b> <br>
When loading a binary attribute with data read from a file
on a Win32 system, it has been noted that you should set
&quot;binmode&quot; on the file before reading the file
contents into the data array.</p>

<p style="margin-left:11%; margin-top: 1em">Another
possible solution to this problem is to convert the binary
data into a base64 encoded string and then store the encoded
string in the file. Then when reading the file, decode the
base64 encoded string back to binary and then use perl-ldap
to store the data in the directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>How do I
create an account in Active Directory?</b> <br>
Active Directory accounts need some AD-specific attributes
(only the method we&rsquo;re interested in, no error
checking):</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;add( 'cn=John Doe,cn=Users,dc=your,dc=ads,dc=domain',
                      attrs =&gt; [
                        objectClass =&gt; [ qw/top user/ ],
                        cn =&gt; 'John Doe',
                        sn =&gt; 'Doe',
                        givenName =&gt; 'John',
                        displayName =&gt; 'John &quot;the one&quot; Doe',
                        userAccountControl =&gt; 514,      # disabled regular user
                        sAMAccountName =&gt; 'JohnDoe',
                        userPrincipalName =&gt; 'JohnDoe@your.ads.domain'
                      ]
                    );</pre>


<p style="margin-left:11%; margin-top: 1em">In order to
find out what other attributes can be set, interactively
edit the user in the Active Directory Users and Computers
<small>MCC</small> plugin, perform an <small>LDAP</small>
search operation to find out what changed, and update your
&quot;add&quot; routine accordingly.</p>

<p style="margin-left:11%; margin-top: 1em"><b>How can I
create a group in Active Directory?</b> <br>
Similar to accounts, groups need some AD-specific attributes
too:</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;add( 'cn=NewGroup,cn=Users,dc=your,dc=ads,dc=domain',
                      attrs =&gt; [
                        objectClass =&gt; [ qw/top group/ ],
                        cn =&gt; 'NewGroup',
                        sAMAccountName =&gt; 'NewGroup',
                        groupType =&gt; 0x80000002         # global, security enabled group
                      ]
                    );</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
search for disabled accounts in Active Directory</b> <br>
The bit values in <tt>&quot;userAccountcontrol&quot;</tt>
require the <small>LDAP_MATCHING_RULE_BIT_AND</small>
matching rule&rsquo;s <small>OID</small> to be used in an
extensible filter term:</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;search( base   =&gt; 'cn=Users,dc=your,dc=ads,dc=domain',
                         filter =&gt; '(&amp;(objectclass=user)' .
                                      (userAccountControl:1.2.840.113556.1.4.803:=2))',
                         attrs  =&gt; [ '1.1' ]
                       );</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
search for security groups in Active Directory</b> <br>
With groups, the same applies to the
<tt>&quot;groupType&quot;</tt> bit-field:</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;search( base   =&gt; 'cn=Users,dc=your,dc=ads,dc=domain',
                         filter =&gt; '(&amp;(objectclass=group)' .
                                      (groupType:1.2.840.113556.1.4.803:=2147483648))',
                                      # 2147483648 = 0x80000000
                         attrs  =&gt; [ '1.1' ]
                       );</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
search for all members of a group in <small>AD</small>
(including group nesting)?</b> <small><br>
AD</small> allows you to find all members of a specified
group, the direct members plus those that are member of the
group via group nesting.</p>

<p style="margin-left:11%; margin-top: 1em">The trick to
this is the special
<tt>&quot;LDAP_MATCHING_RULE_IN_CHAIN&quot;</tt> matching
rule:</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;search( base   =&gt; 'cn=Users,dc=your,dc=ads,dc=domain',
                         filter =&gt; '(memberOf:1.2.840.113556.1.4.1941:=cn=Testgroup,dc=your,dc=ads,dc=domain)',
                         attrs  =&gt; [ '1.1' ]
                       );</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
search for all groups one user is a member of in
<small>AD</small> (including group nesting)?</b> <br>
Similarly you can search for all the groups one user is
member of, either directly or via group nesting.</p>

<pre style="margin-left:11%; margin-top: 1em">  $mesg = $ldap&minus;&gt;search( base   =&gt; 'dc=your,dc=ads,dc=domain',
                         filter =&gt; '(member:1.2.840.113556.1.4.1941:=cn=TestUser,ou=Users,dc=your,dc=ads,dc=domain)',
                         attrs  =&gt; [ '1.1' ]
                       );</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
search for all members of a large group in <small>AD</small>
?</b> <small><br>
AD</small> normally restricts the number of attribute values
returned in one query. The exact number depends on the
<small>AD</small> server version: it was ~1000 in Win2000,
1500 in Win2003 and is 5000 in Win2008 &amp; Win2008R2.</p>

<p style="margin-left:11%; margin-top: 1em">Performing the
same standard search again will yield the same values
again.</p>

<p style="margin-left:11%; margin-top: 1em">So, how can you
get all members of a really large <small>AD</small>
group?</p>

<p style="margin-left:11%; margin-top: 1em">The trick to
use here is to use Microsoft&rsquo;s <i>range option</i>
when searching, i.e instead of doing one search for plain
<tt>&quot;member&quot;</tt>, perform multiple searches for
e.g. <tt>&quot;member;range=1000&minus;*&quot;</tt> where
the range starting index increases accordingly:</p>

<pre style="margin-left:11%; margin-top: 1em">  my $mesg;
  my @members;
  my $index = 0;
  while ($index ne '*') {
    $mesg = $ldap&minus;&gt;search( base   =&gt; 'cn=Testgroup,dc=your,dc=ads,dc=domain',
                           filter =&gt; '(objectclass=group)',
                           scope  =&gt; 'base',
                           attrs  =&gt; ($index &gt; 0) ? &quot;member;range=$index&minus;*&quot; : 'member'
                         );
    if ($mesg&minus;&gt;code == LDAP_SUCCESS) {
      my $entry = $mesg&minus;&gt;entry(0);
      my $attr;
      # large group: let's do the range option dance
      if (($attr) = grep(/^member;range=/, $entry&minus;&gt;attributes)) {
        push(@members, $entry&minus;&gt;get_value($attr));
        if ($attr =~ /^member;range=\d+&minus;(.*)$/) {
          $index = $1;
          $index++  if ($index ne '*');
        }
      }
      # small group: no need for the range dance
      else {
        @members = $entry&minus;&gt;get_value('member');
        last;
      }
    }
    # failure
    else {
      last;
    }
  }
  if ($mesg&minus;&gt;code == LDAP_SUCCESS) {
    # success: @members contains the members of the group
  }
  else {
    # failure: deal with the error in $mesg
  }</pre>


<p style="margin-left:11%; margin-top: 1em">See
&lt;http://msdn.microsoft.com/en&minus;us/library/windows/desktop/aa367017.aspx&gt;
for more details.</p>

<p style="margin-left:11%; margin-top: 1em"><b>How do I
create a Microsoft Exchange 5.x user?</b> <br>
This is a solution provided by a perl-ldap user.</p>

<p style="margin-left:11%; margin-top: 1em">This code works
with ActiveState Perl running on WinNT 4. Please note that
this requires the Win32::Perms module, and needs valid
<small>NT</small> account info to replace the
placeholders.</p>

<pre style="margin-left:11%; margin-top: 1em">  use Net::LDAP;
  use Net::LDAP::Util;
  use Win32::Perms;
  #Constants taken from ADSI Type Library
  $ADS_RIGHT_EXCH_ADD_CHILD = 1;
  $ADS_RIGHT_EXCH_DELETE = 0x10000;
  $ADS_RIGHT_EXCH_DS_REPLICATION = 64;
  $ADS_RIGHT_EXCH_DS_SEARCH = 256;
  $ADS_RIGHT_EXCH_MAIL_ADMIN_AS = 32;
  $ADS_RIGHT_EXCH_MAIL_RECEIVE_AS = 16;
  $ADS_RIGHT_EXCH_MAIL_SEND_AS = 8;
  $ADS_RIGHT_EXCH_MODIFY_ADMIN_ATT = 4;
  $ADS_RIGHT_EXCH_MODIFY_SEC_ATT = 128;
  $ADS_RIGHT_EXCH_MODIFY_USER_ATT = 2;
  $EXCH_USER_RIGHTS = $ADS_RIGHT_EXCH_MAIL_RECEIVE_AS |
  $ADS_RIGHT_EXCH_MAIL_SEND_AS |
  $ADS_RIGHT_EXCH_MODIFY_USER_ATT;
  $exch = Net::LDAP&minus;&gt;new('server', debug =&gt;0) || die $@;
  $exch&minus;&gt;bind( 'cn=admin_user,cn=nt_domain,cn=admin', version =&gt;3,
  password=&gt;'password');
  $myObj = Win32::Perms&minus;&gt;new();
  $Result = $myObj&minus;&gt;Owner('nt_domain\user_name');
  $myObj&minus;&gt;Group('nt_domain\Everyone');
  $myObj&minus;&gt;Allow('nt_domain\user_name',
  $EXCH_USER_RIGHTS,OBJECT_INHERIT_ACE);
  $BinarySD = $myObj&minus;&gt;GetSD(SD_RELATIVE);
  $TextSD = uc(unpack( &quot;H*&quot;, $BinarySD ));
  Win32::Perms::ResolveSid('nt_domain\user_name', $sid);
  $mysid = uc(unpack(&quot;H*&quot;,$sid));
  $result = $exch&minus;&gt;add ( dn   =&gt;
                'cn=user_name,cn=container,ou=site,o=organisation',
                attr =&gt; [ 'objectClass' =&gt; ['organizationalPerson'],
                          'cn'   =&gt; 'directory_name',
                          'uid' =&gt; 'mail_nickname',
                          'mail' =&gt; 'smtp_address',
                        'assoc&minus;nt&minus;account' =&gt; [ $mysid ],
                        'nt&minus;security&minus;descriptor' =&gt; [ $TextSD ],
                        'mailPreferenceOption'  =&gt; 0
                        ]
              );
  print ldap_error_name($result&minus;&gt;code);</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
reset a user&rsquo;s password ...</b> <i><br>
... in most <small>LDAP</small> servers?</i></p>

<p style="margin-left:11%; margin-top: 1em">Most
<small>LDAP</small> servers use the standard userPassword
attribute as the attribute to set when you want to change a
user&rsquo;s password.</p>

<p style="margin-left:11%; margin-top: 1em">They usually
allow to set the password either using the regular modify
operation on the userPassword attribute or using the
extended <small>LDAP</small> Password Modify operation
defined in <small>RFC3062.</small></p>

<p style="margin-left:11%; margin-top: 1em">The recommended
method is the extended Password Modify operation, which
offers a standardized way to set user passwords but
unfortunately is not available on all <small>LDAP</small>
servers.</p>

<p style="margin-left:11%; margin-top: 1em">Whether the
extended Password Modify operation is available can be found
out by searching the attribute supportedExtension for the
value 1.3.6.1.4.1.4203.1.11.1 in the RootDSE object.</p>

<p style="margin-left:11%; margin-top: 1em">If the extended
Password Modify operation is not available the alternative
is the regular modification of the userPassword
attribute.</p>

<p style="margin-left:11%; margin-top: 1em">But this method
has some drawbacks:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Depending on the type of the server the arguments to the
modify operations may vary. Some want the modify done with
replace, some want it done by explicitly deleting the old
password and add of the new one. This may even depend on
whether you change the password for the bound user or as an
administrator for another user.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>With the modify operation some servers expect the client
to do the hashing of the password on the client side. I.e.
all clients that set passwords need to agree on the
algorithm and the format of the hashed password.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Some <small>LDAP</small> servers do not allow setting
the password if the connection is not sufficiently secured.
I.e. require <small>SSL</small> or <small>TLS</small>
support to set the password (which is heavily recommended
anyway ;&minus;)</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Here is an
example of how to change your own password (for
brevity&rsquo;s sake error checking is left out):</p>

<pre style="margin-left:11%; margin-top: 1em">  use Net::LDAP;
  my $ldap = Net::LDAP&minus;&gt;new('ldaps://server.domain')  or  die &quot;$@&quot;;
  my $mesg = $ldap&minus;&gt;bind('cn=Joe User,dc=perl,dc=ldap,dc=org',
                         password =&gt; 'oldPW');
  my $rootdse = $ldap&minus;&gt;root_dse();
  if ($rootdse&minus;&gt;supported_extension('1.3.6.1.4.1.4203.1.11.1') {
      require Net::LDAP::Extension::SetPassword;
      $mesg = $ldap&minus;&gt;set_password(user =&gt; 'cn=Joe User,dc=perl,dc=ldap,dc=org',
                                  oldpasswd =&gt; 'oldPW',
                                  newpasswd =&gt; 'newPW');
  }
  else {
      $mesg = $ldap&minus;&gt;modify('cn=Joe User,dc=perl,dc=ldap,dc=org',
                            changes =&gt; [
                                delete =&gt; [ userPassword =&gt; $oldPW ]
                                add    =&gt; [ userPassword =&gt; $newPW ] ]);
  }
  $ldap&minus;&gt;unbind();</pre>


<p style="margin-left:11%; margin-top: 1em"><i>... in
<small>MS</small> Active Directory?</i></p>

<p style="margin-left:11%; margin-top: 1em">With Active
Directory a user&rsquo;s password is stored in the
unicodePwd attribute and changed using the regular modify
operation.</p>


<p style="margin-left:11%; margin-top: 1em"><small>ADS</small>
expects this password to be encoded in Unicode &minus;
<small>UTF&minus;16</small> to be exact. Before the unicode
conversion is done the password needs to be surrounded by
double quotes which do not belong to the user&rsquo;s
password.</p>

<p style="margin-left:11%; margin-top: 1em">For the
password modify operation to succeed <small>SSL</small> is
required.</p>

<p style="margin-left:11%; margin-top: 1em">When changing
the password for the user bound to the directory
<small>ADS</small> expects it to be done by deleting the old
password and adding the new one. When doing it as a user
with administrative priviledges replacing the
unicodePwd&rsquo;s value with a new one is allowed too.</p>

<p style="margin-left:11%; margin-top: 1em">Perl-ldap
contains convenience methods for Active Directory that allow
one to perform this task very easily.</p>

<p style="margin-left:11%; margin-top: 1em">Here&rsquo;s an
example that demonstrates setting your own password from
<tt>$oldPW</tt> to <tt>$newPW</tt> (again almost no error
checking):</p>

<pre style="margin-left:11%; margin-top: 1em">  use Net::LDAP;
  use Net::LDAP::Extra qw(AD);
  my $ldap = Net::LDAP&minus;&gt;new('ldaps://ads.domain.controller')  or  die &quot;$@&quot;;
  my $mesg = $ldap&minus;&gt;bind('cn=Joe User,dc=your,dc=ads,dc=domain',
                         password =&gt; $oldPW);
  $mesg = $ldap&minus;&gt;change_ADpassword('cn=Joe User,dc=your,dc=ads,dc=domain',
                                   $oldPW, $newPW);
  $ldap&minus;&gt;unbind();</pre>


<p style="margin-left:11%; margin-top: 1em">And the same
for perl-ldap versions before 0.49, where everything needs
to be done by hand:</p>

<pre style="margin-left:11%; margin-top: 1em">  use Net::LDAP;
  use Unicode::Map8;
  use Unicode::String qw(utf16);
  # build the conversion map from your local character set to Unicode
  my $charmap = Unicode::Map8&minus;&gt;new('latin1')  or  die;
  # surround the PW with double quotes and convert it to UTF&minus;16
  # byteswap() was necessary in experiments on i386 Linux, YMMV
  my $oldUniPW = $charmap&minus;&gt;tou('&quot;'.$oldPW.'&quot;')&minus;&gt;byteswap()&minus;&gt;utf16();
  my $newUniPW = $charmap&minus;&gt;tou('&quot;'.$newPW.'&quot;')&minus;&gt;byteswap()&minus;&gt;utf16();
  my $ldap = Net::LDAP&minus;&gt;new('ldaps://ads.domain.controller')  or  die &quot;$@&quot;;
  my $mesg = $ldap&minus;&gt;bind('cn=Joe User,dc=your,dc=ads,dc=domain',
                         password =&gt; $oldPW);
  $mesg = $ldap&minus;&gt;modify('cn=Joe User,dc=your,dc=ads,dc=domain',
                        changes =&gt; [
                            delete =&gt; [ unicodePwd =&gt; $oldUniPW ]
                            add    =&gt; [ unicodePwd =&gt; $newUniPW ] ]);
  $ldap&minus;&gt;unbind();</pre>


<p style="margin-left:11%; margin-top: 1em"><b>How can I
simulate server failover?</b> <br>
Perl-ldap does not do server failover, however there are
several programming options for getting around this
situation.</p>

<p style="margin-left:11%; margin-top: 1em">Here is one
possible solution:</p>

<pre style="margin-left:11%; margin-top: 1em">  $ldaps = Net::LDAPS&minus;&gt;new([ $ldapserverone, $ldapservertwo ],
                           port=&gt;636, timeout=&gt;5)  or  die &quot;$@&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">For perl-ldap
versions before 0.27, thes same goal can be achieved
using:</p>

<pre style="margin-left:11%; margin-top: 1em">  unless ( $ldaps =
            Net::LDAPS&minus;&gt;new($ldapserverone,
                            port=&gt;636,timeout=&gt;5) )
          {
              $ldaps = Net::LDAPS&minus;&gt;new($ldapservertwo,
                                       port=&gt;636,timeout=&gt;20) ||
              return
              &quot;Can't connect to $ldapserverone or $ldapservertwo via LDAPS: $@&quot;;
          }</pre>


<h2>Using X.509 certificates.
<a name="Using X.509 certificates."></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>How do I
store X.509 certificates in the directory?</b> <br>
The first problem here is that there are many different
formats to hold certificates in, for example <small>PEM,
DER,</small> PKCS#7 and PKCS#12. The directory <b>only</b>
uses the <small>DER</small> format (more correctly, it only
uses the <small>BER</small> format) which is a binary
format.</p>

<p style="margin-left:11%; margin-top: 1em">Your first job
is to ensure that your certificates are therefore in
<small>DER/BER</small> format. You could use OpenSSL to
convert from <small>PEM</small> like this:</p>

<pre style="margin-left:11%; margin-top: 1em">  openssl x509 &minus;inform PEM &minus;in cert.pem &minus;outform DER &minus;out cert.der</pre>


<p style="margin-left:11%; margin-top: 1em">Consult the
OpenSSL documentation to find out how to perform other
conversions.</p>

<p style="margin-left:11%; margin-top: 1em">To add a
certificate to the directory, just slurp in the
<small>DER/BER</small> certificate into a scalar variable,
and add it to the entry&rsquo;s userCertificate attribute.
How you do that will depend on which version of
<small>LDAP</small> you are using.</p>

<p style="margin-left:11%; margin-top: 1em">To slurp in the
certificate try something like this:</p>

<pre style="margin-left:11%; margin-top: 1em">  my $cert;
  {
      local $/ = undef; # Slurp mode
      open CERT, &quot;cert.der&quot; or die;
      binmode CERT;     # for Windows e.a.
      $cert = &lt;CERT&gt;;
      close CERT;
  }
  # The certificate is now in $cert</pre>


<p style="margin-left:11%; margin-top: 1em">For LDAPv2,
because most directory vendors ignore the string
representation of certificates defined in <small>RFC
1778,</small> you should add this value to the directory
like this:</p>

<pre style="margin-left:11%; margin-top: 1em">  $res = $ldap&minus;&gt;modify(&quot;cn=My User, o=My Company,c=XY&quot;,
                       add =&gt; [
                               'userCertificate' =&gt; [ $cert ]
                              ]);
  die &quot;Modify failed (&quot; . ldap_error_name($res&minus;&gt;code) . &quot;)\n&quot;
      if $res&minus;&gt;code;</pre>


<p style="margin-left:11%; margin-top: 1em">For LDAPv3, you
must do this instead:</p>

<pre style="margin-left:11%; margin-top: 1em">  $res = $ldap&minus;&gt;modify(&quot;cn=My User, o=My Company, c=XY&quot;,
                       add =&gt; [
                               'userCertificate;binary' =&gt; [ $cert ]
                              ]);
  die &quot;Modify failed (&quot; . ldap_error_name($res&minus;&gt;code) . &quot;)\n&quot;
      if $res&minus;&gt;code;</pre>


<p style="margin-left:11%; margin-top: 1em">Of course, the
entry you are trying to add the certificate to must use
object classes that permit the userCertificate attribute,
otherwise the modify will fail with an object class
violation error. The inetOrgPerson structural object class
permits userCertificates, as does the
strongAuthenticationUser auxiliary object class. Others
might also.</p>

<p style="margin-left:11%; margin-top: 1em"><b>How do I
search objects by the contents of certificates.</b> <br>
The directory needs to support one or more of the
certificate*Match matching rules.</p>

<p style="margin-left:11%; margin-top: 1em">Then using the
filter (for certificateExactMatch)</p>

<pre style="margin-left:11%; margin-top: 1em">  (userCertificate={ serialNumber 1234, issuer &quot;cn=CA,o=TrustCenter&quot; })</pre>


<p style="margin-left:11%; margin-top: 1em">allows
searching for the objects containing the attribute
userCertificate with a certificate matching these
criteria.</p>

<p style="margin-left:11%; margin-top: 1em">Please note
that the exact syntax of the values for the serialNumber and
the issuer above may depend on the <small>LDAP</small>
server. In any case the example above works with OpenLDAP
2.4.33.</p>

<h2>ADDITIONAL DIRECTORY AND LDAP RESOURCES.
<a name="ADDITIONAL DIRECTORY AND LDAP RESOURCES."></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>URLs.</b>
<br>
Net::LDAP::Server &minus; <small>LDAP</small> server
framework in Perl
http://search.cpan.org/search?module=Net::LDAP::Server
https://github.com/alexrj/Net&minus;LDAP&minus;Server</p>


<p style="margin-left:11%; margin-top: 1em">Net::LDAP::SimpleServer
&minus; <small>LDAP</small> server in Perl
http://search.cpan.org/search?module=Net::LDAP::SimpleServer
https://github.com/russoz/Net&minus;LDAP&minus;SimpleServer</p>

<p style="margin-left:11%; margin-top: 1em">LemonLDAP::NG
&minus; Web SingleSignOn solution &amp; <small>SAML</small>
IdP in Perl http://lemonldap&minus;ng.org/</p>


<p style="margin-left:11%; margin-top: 1em">Dancer::Plugin::LDAP
&minus; <small>LDAP</small> plugin for Dancer micro
framework
http://search.cpan.org/search?module=Dancer::Plugin::LDAP
https://github.com/racke/Dancer&minus;Plugin&minus;LDAP</p>

<p style="margin-left:11%; margin-top: 1em">Directory
Services Mark Language ( <small>DSML</small> )
http://www.oasis&minus;open.org/specs/</p>

<p style="margin-left:11%; margin-top: 1em">eMailman
<small>LDAP</small> information
http://www.emailman.com/ldap/</p>

<p style="margin-left:11%; margin-top: 1em">Rafael
Corvalan&rsquo;s <small>LDAP</small> shell
http://sf.net/projects/ldapsh</p>

<p style="margin-left:11%; margin-top: 1em">Jeff
Hodges&rsquo;s Kings Mountain <small>LDAP</small>
http://www.kingsmountain.com/ldapRoadmap.shtml (outdated:
last update was in 2004)</p>


<p style="margin-left:11%; margin-top: 1em">willeke.com&rsquo;s
<small>LDAP</small> Wiki
http://ldapwiki.willeke.com/wiki/LDAP</p>

<p style="margin-left:11%; margin-top: 1em">OpenLDAP
Directory Server &minus; open source <small>LDAP</small>
server. http://www.openldap.org/</p>

<p style="margin-left:11%; margin-top: 1em">389 Directory
Server &minus; open source <small>LDAP</small> server
http://port389.org/</p>

<p style="margin-left:11%; margin-top: 1em">ApacheDS
&minus; open source <small>LDAP</small> server in Java
http://directory.apache.org/</p>

<p style="margin-left:11%; margin-top: 1em">CriticalPath
http://www.cp.net/</p>


<p style="margin-left:11%; margin-top: 1em">ForgeRock&rsquo;s
OpenDS &minus; LDAPv3 server with additional
<small>REST</small> APIs
http://www.forgerock.com/opendj.html</p>


<p style="margin-left:11%; margin-top: 1em"><small>IBM</small>
Tivoli Directory Server
http://www&minus;01.ibm.com/software/tivoli/products/directory&minus;server/</p>

<p style="margin-left:11%; margin-top: 1em">Isode (was
MessagingDirect) http://www.isode.com/</p>

<p style="margin-left:11%; margin-top: 1em">Nexor&rsquo;s
X.500 and Internet Directories
http://www.nexor.com/info/directory.htm/</p>

<p style="margin-left:11%; margin-top: 1em">Novell&rsquo;s
eDirectory http://www.novell.com/</p>

<p style="margin-left:11%; margin-top: 1em">Octet String
http://www.octetstring.com/</p>

<p style="margin-left:11%; margin-top: 1em"><small>SUN JAVA
JNDI</small> (Java Naming and Directory Interface)
http://java.sun.com/products/jndi/overview.html</p>

<p style="margin-left:11%; margin-top: 1em">Oracle
Directory Server Enterprise Edition, formerly Sun One,
formerly iPlanet.
http://www.oracle.com/technetwork/middleware/id&minus;mgmt/index&minus;085178.html</p>

<p style="margin-left:11%; margin-top: 1em">OptimalIDM
&minus; Virtual Identitity Server &minus; .NET
<small>LDAP</small> virtual directory
http://www.optimalidm.com/products/vis/Virtual&minus;Directory&minus;Server&minus;VDS.aspx</p>

<p style="margin-left:11%; margin-top: 1em">Quest One Quick
Connect Virtual Directory Server &minus; <small>LDAP</small>
virtual directory
http://www.quest.com/quest&minus;one&minus;quick&minus;connect&minus;virtual&minus;directory&minus;server/</p>


<p style="margin-left:11%; margin-top: 1em">UnboundID&rsquo;s
Identity data platform https://www.unboundid.com/</p>

<p style="margin-left:11%; margin-top: 1em">Virtual
Directory Blogger
https://virtualdirectory.wordpress.com/</p>

<p style="margin-left:11%; margin-top: 1em">eldapo &minus;
a directory manager&rsquo;s blog
http://eldapo.blogspot.de/</p>

<p style="margin-left:11%; margin-top: 1em">Eine deutsche
<small>LDAP</small> Website A german <small>LDAP</small>
Website http://verzeichnisdienst.de/ldap/Perl/index.html</p>


<p style="margin-left:11%; margin-top: 1em">(non-exhaustive)
list of <small>LDAP</small> software on wikipedia
http://en.wikipedia.org/wiki/List_of_LDAP_software</p>

<p style="margin-left:11%; margin-top: 1em">&quot;
<small>RFC</small> Sourcebook&quot; on <small>LDAP</small>
http://www.networksorcery.com/enp/protocol/ldap.htm</p>

<p style="margin-left:11%; margin-top: 1em">web2ldap
&minus; <small>WWW</small> gateway to <small>LDAP</small>
server in Python http://www.web2ldap.de/</p>

<p style="margin-left:11%; margin-top: 1em">Softerra
<small>LDAP</small> Browser / Administrator
http://www.ldapbrowser.com/</p>

<p style="margin-left:11%; margin-top: 1em">The 2 following
URLs deal mainly with Microsoft&rsquo;s Active
Directory.</p>

<p style="margin-left:11%; margin-top: 1em">Directory Works
http://directoryworks.com/</p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP</small>
Client .Net &amp; ActiveX <small>LDAP</small> Client
http://www.ldapservices.com/Products/Default.aspx</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>BOOKS</small></b>
<br>
Developing <small>LDAP</small> and <small>ADSI</small>
Clients for Microsoft(R) Exchange. By Sven B. Schreiber.
<small>ISBN: 0201657775</small></p>

<p style="margin-left:11%; margin-top: 1em">Implementing
<small>LDAP.</small> By Mark Wilcox. <small>ISBN:
1861002211</small></p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP:</small>
Programming Directory-Enabled Applications With Lightweight
Directory Access Protocol. By Tim Howes, Mark Smith.
<small>ISBN: 1578700000</small></p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP</small>
Programming; Directory Management and Integration. By
Clayton Donley. <small>ISBN: 1884777910</small></p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP</small>
Programming with Java. By Rob Weltman, Tony Dahbura.
<small>ISBN: 0201657589</small></p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP</small>
System Administration. By Gerald Carter. <small>ISBN:
1565924916</small></p>

<p style="margin-left:11%; margin-top: 1em">Managing
Enterprise Active Directory Services. By Robbie Allen,
Richard Puckett. <small>ISBN: 0672321254</small></p>

<p style="margin-left:11%; margin-top: 1em">Solaris and
<small>LDAP</small> Naming Services. By Tom Bialaski,
Michael Haines. <small>ISBN:
0&minus;13&minus;030678&minus;9</small></p>

<p style="margin-left:11%; margin-top: 1em">Understanding
and Deploying <small>LDAP</small> Directory Services (2ed).
By Tim Howes, Mark Smith, Gordon Good. <small>ISBN:
0672323168</small></p>


<p style="margin-left:11%; margin-top: 1em"><small>LDAP</small>
Directories Explained. By Brian Arkills. <small>ISBN
0&minus;201&minus;78792&minus;X</small></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Any good
<small>FAQ</small> is made up of many authors, everyone that
contributes information to the perl-ldap mail list is a
potential author.</p>

<p style="margin-left:11%; margin-top: 1em">An attempt to
maintain this <small>FAQ</small> is being done by Chris Ridd
&lt;chris.ridd@isode.com&gt; and Peter Marschall
&lt;peter@adpm.de&gt;. It was previously updated by Clif
Harden &lt;charden@pobox.com&gt;.</p>

<p style="margin-left:11%; margin-top: 1em">The original
author of this <small>FAQ</small> was Graham Barr
&lt;gbarr@pobox.com&gt;</p>

<p style="margin-left:11%; margin-top: 1em">Please report
any bugs, or post any suggestions, to the perl-ldap mailing
list &lt;perl&minus;ldap@perl.org&gt;.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (c)
1999&minus;2004 Graham Barr, (c) 2012 Peter Marschall. All
rights reserved. This document is distributed, and may be
redistributed, under the same terms as Perl itself.</p>
<hr>
</body>
</html>
