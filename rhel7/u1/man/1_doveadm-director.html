<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 00:38:18 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>DOVEADM&minus;DIRECTOR</title>

</head>
<body>

<h1 align="center">DOVEADM&minus;DIRECTOR</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#ARGUMENTS">ARGUMENTS</a><br>
<a href="#COMMANDS">COMMANDS</a><br>
<a href="#FILES">FILES</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#REPORTING BUGS">REPORTING BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">doveadm&minus;director
&minus; Manage Dovecot directors</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>doveadm</b>
[<b>&minus;Dv</b>] <b>director add</b> [<b>&minus;a</b>
<i>director_socket_path</i>] <i>host</i>
[<i>vhost_count</i>] <b><br>
doveadm</b> [<b>&minus;Dv</b>] <b>director flush</b>
[<b>&minus;a</b> <i>director_socket_path</i>]
<i>host</i>|<b>all <br>
doveadm</b> [<b>&minus;Dv</b>] <b>director map</b>
[<b>&minus;a</b> <i>director_socket_path</i>]
[<b>&minus;f</b> <i>users_file</i>] [<i>host</i>] <b><br>
doveadm</b> [<b>&minus;Dv</b>] <b>director remove</b>
[<b>&minus;a</b> <i>director_socket_path</i>] <i>host</i>
<b><br>
doveadm</b> [<b>&minus;Dv</b>] <b>director dump</b>
[<b>&minus;a</b> <i>director_socket_path</i>] <b><br>
doveadm</b> [<b>&minus;Dv</b>] <b>director status</b>
[<b>&minus;a</b> <i>director_socket_path</i>]
[<i>user</i>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>doveadm
director</b> can be used to manage and query the status of
the list of backend mail servers where Dovecot proxy can
redirect connections to.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Global
<b>doveadm</b>(1) <i>options</i>:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;D</b></p></td>
<td width="8%"></td>
<td width="70%">


<p>Enables verbosity and debug messages.</p></td>
<td width="8%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;v</b></p></td>
<td width="8%"></td>
<td width="70%">


<p>Enables verbosity, including progress counter.</p></td>
<td width="8%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Command
specific <i>options</i>: <b><br>
&minus;a&nbsp;</b><i>director_socket_path</i></p>

<p style="margin-left:22%;">This option is used to specify
an alternative socket. The option's argument is either an
absolute path to a local UNIX domain socket, or a hostname
and port (<i>hostname</i>:<i>port</i>), in order to connect
a remote host via a TCP socket.</p>

<p style="margin-left:22%; margin-top: 1em">By default
<b>doveadm</b>(1) will use the socket
<i>/var/run/dovecot/director&minus;admin</i>. The socket may
be located in another directory, when the default
<i>base_dir</i> setting was overridden in
<i>/etc/dovecot/dovecot.conf</i>.</p>

<h2>ARGUMENTS
<a name="ARGUMENTS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p style="margin-top: 1em"><i>host</i></p></td>
<td width="5%"></td>
<td width="78%">


<p style="margin-top: 1em">A mail server's hostname or IP
address.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><i>user</i></p></td>
<td width="5%"></td>
<td width="78%">


<p>Is a <i>user</i>'s login name. Depending on the
configuration, a login name may be for example <b>jane</b>
or <b>john@example.com</b>.</p></td></tr>
</table>

<p style="margin-left:11%;"><i>vhost_count</i></p>

<p style="margin-left:22%;">The number of &quot;virtual
hosts&quot; to assign to this server. The higher the number
is relative to other servers, the more connections it gets.
The default is 100.</p>

<h2>COMMANDS
<a name="COMMANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>director add
<br>
doveadm director add</b> [<b>&minus;a</b>
<i>director_socket_path</i>] <i>host</i>
[<i>vhost_count</i>]</p>

<p style="margin-left:11%; margin-top: 1em">The command's
tasks are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>*</p></td>
<td width="5%"></td>
<td width="83%">


<p>assign a new mail server to the director.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>*</p></td>
<td width="5%"></td>
<td width="83%">


<p>increase/decrease the <i>vhost_count</i> of an already
assigned server.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>director
flush <br>
doveadm director flush</b> [<b>&minus;a</b>
<i>director_socket_path</i>] <i>host</i>|<b>all</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>doveadm
director flush</b> drops all user associations either from
the given <i>host</i> or <b>all</b> hosts. This command is
intended mainly for testing purposes.</p>

<p style="margin-left:11%; margin-top: 1em"><b>director map
<br>
doveadm director map</b> [<b>&minus;a</b>
<i>director_socket_path</i>] [<b>&minus;f</b>
<i>users_file</i>] [<i>host</i>]</p>

<p style="margin-left:11%; margin-top: 1em">The command
<b>doveadm director map</b> is used to list current
<i>user&nbsp;</i>&rarr;&nbsp;<i>host</i> mappings. Note that
the director works using 32bit hashes which makes collisions
quite likely, so this command can't reliably list exactly
which users have recently logged in. <b><br>
&minus;f&nbsp;</b><i>users_file</i></p>

<p style="margin-left:22%;">Path to a file containing all
user names (one per line). When given no <i>userdb</i>
lookup will be performed. This may be a helpful alternative
when for example the network connection to the LDAP or SQL
server is slow.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><i>host</i></p></td>
<td width="5%"></td>
<td width="78%">


<p>Specify a server's IP address or hostname, to list only
mappings of the given <i>host</i>.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>director
remove <br>
doveadm director remove</b> [<b>&minus;a</b>
<i>director_socket_path</i>] <i>host</i></p>

<p style="margin-left:11%; margin-top: 1em">Use this
command in order to remove the given <i>host</i> from the
director.</p>

<p style="margin-left:11%; margin-top: 1em"><b>director
dump <br>
doveadm director dump</b> [<b>&minus;a</b>
<i>director_socket_path</i>]</p>

<p style="margin-left:11%; margin-top: 1em">Dump the
current host configuration as doveadm commands. These
commands can be easily run after a full director cluster
restart to get back to the dumped state.</p>

<p style="margin-left:11%; margin-top: 1em"><b>director
status <br>
doveadm director status</b> [<b>&minus;a</b>
<i>director_socket_path</i>] [<i>user</i>]</p>

<p style="margin-left:11%; margin-top: 1em">This command is
used to show the current usage of all assigned mail servers.
<br>
When a user name is given, this command shows which server
the <i>user</i> is currently assigned to, where the user
will be assigned after the current saved assignment gets
removed and where the user would be assigned to if the whole
proxy cluster was restarted fresh.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>/etc/dovecot/dovecot.conf</i></p>

<p style="margin-left:22%;">Dovecot's main configuration
file.</p>


<p style="margin-left:11%;"><i>/etc/dovecot/conf.d/10&minus;director.conf</i></p>

<p style="margin-left:22%;">Director specific settings.</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Add a director
with vhost count 150 (or change existing one's vhost count
to 150):</p>

<p style="margin-left:11%; margin-top: 1em"><b>doveadm
&minus;v director add x1357.imap.ha.example.net 150</b> <br>
2001:db8:543:6861:143::1357: OK</p>

<p style="margin-left:11%; margin-top: 1em">Remove a
director:</p>

<p style="margin-left:11%; margin-top: 1em"><b>doveadm
director remove x1357.imap.ha.example.net</b></p>

<p style="margin-left:11%; margin-top: 1em">Query the
status of mail hosts in a director:</p>

<p style="margin-left:11%; margin-top: 1em"><b>doveadm
director status</b> <br>
mail server ip vhosts users <br>
192.168.10.1 100 125 <br>
192.168.10.2 100 144 <br>
192.168.10.3 100 115</p>

<p style="margin-left:11%; margin-top: 1em">Query the
status of a user's assignment:</p>

<p style="margin-left:11%; margin-top: 1em"><b>doveadm
director status user@example.com</b> <br>
Current: 192.168.10.1 (expires 2010&minus;06&minus;18
20:17:04) <br>
Hashed: 192.168.10.2 <br>
Initial config: 192.168.10.3</p>

<p style="margin-left:11%; margin-top: 1em">This means that
the user is currently assigned to mail server on IP
192.168.10.1. After all of user's connections have logged
out, the assignment will be removed (currently it looks like
at 20:17:04, but that may be increased). After the
assignment has expired, the user will next time be
redirected to 192.168.10.2 (assuming no changes to director
settings). If the entire Dovecot proxy cluster was
restarted, so that all of the director configuration would
revert back to its initial values, the user would be
redirected to 192.168.10.3.</p>

<h2>REPORTING BUGS
<a name="REPORTING BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Report bugs,
including <i>doveconf &minus;n</i> output, to the Dovecot
Mailing List &lt;dovecot@dovecot.org&gt;. Information about
reporting bugs is available at:
http://dovecot.org/bugreport.html</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>doveadm</b>(1)</p>
<hr>
</body>
</html>
