<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 00:23:33 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>AUDIT_ENCODE_NV_STRING</title>

</head>
<body>

<h1 align="center">AUDIT_ENCODE_NV_STRING</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">audit_encode_nv_string
&minus; encode a name/value pair in a string</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;libaudit.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>char
*audit_encode_nv_string(const char *name, const char *value,
unsigned int vlen)</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This function
is used to encode a name/value pair. This should be used on
any field being logged that potentially contains a space, a
double-quote, or a control character. Any value containing
those have to be specially encoded for the auparse library
to correctly handle the value. The encoding method is
designed to prevent log injection attacks where malicious
values could cause parsing errors.</p>

<p style="margin-left:11%; margin-top: 1em">To use this
function, pass the name string and value strings on their
respective arguments. If the value is likely to have a NUL
value embedded within it, you will need to pass a value
length that tells in bytes how big the value is. Otherwise,
you can pass a 0 for vlen and the function will simply use
strlen against the value pointer. Also be aware that the
name of the field will cause auparse to do certain things
when interpretting the value. If the name is uid, a user id
value in decimal is expected. Make sure that well known
names are used for their intended purpose or that there is
no chance of name collision with something new.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Returns a
freshly malloc&rsquo;ed string that the caller must free or
NULL on error.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>audit_log_user_message</b>(3),
<b>audit_log_user_comm_message</b>(3),
<b>audit_log_user_avc_message</b>(3),
<b>audit_log_semanage_message</b>(3).</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Steve Grubb</p>
<hr>
</body>
</html>
