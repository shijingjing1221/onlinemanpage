<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 00:34:28 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>DBD::Proxy</title>

</head>
<body>

<h1 align="center">DBD::Proxy</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONNECTING TO THE DATABASE">CONNECTING TO THE DATABASE</a><br>
<a href="#KNOWN ISSUES">KNOWN ISSUES</a><br>
<a href="#SECURITY WARNING">SECURITY WARNING</a><br>
<a href="#AUTHOR AND COPYRIGHT">AUTHOR AND COPYRIGHT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">DBD::Proxy
&minus; A proxy driver for the DBI</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em">  use DBI;
  $dbh = DBI&minus;&gt;connect(&quot;dbi:Proxy:hostname=$host;port=$port;dsn=$db&quot;,
                      $user, $passwd);
  # See the DBI module documentation for full details</pre>


<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">DBD::Proxy is a
Perl module for connecting to a database via a remote
<small>DBI</small> driver. See DBD::Gofer for an alternative
with different trade-offs.</p>

<p style="margin-left:11%; margin-top: 1em">This is of
course not needed for <small>DBI</small> drivers which
already support connecting to a remote database, but there
are engines which don&rsquo;t offer network
connectivity.</p>

<p style="margin-left:11%; margin-top: 1em">Another
application is offering database access through a firewall,
as the driver offers query based restrictions. For example
you can restrict queries to exactly those that are used in a
given <small>CGI</small> application.</p>

<p style="margin-left:11%; margin-top: 1em">Speaking of
<small>CGI,</small> another application is (or rather, will
be) to reduce the database connect/disconnect overhead from
<small>CGI</small> scripts by using proxying the
connect_cached method. The proxy server will hold the
database connections open in a cache. The <small>CGI</small>
script then trades the database connect/disconnect overhead
for the DBD::Proxy connect/disconnect overhead which is
typically much less. <i>Note that the connect_cached method
is new and still experimental.</i></p>

<h2>CONNECTING TO THE DATABASE
<a name="CONNECTING TO THE DATABASE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Before
connecting to a remote database, you must ensure, that a
Proxy server is running on the remote machine. There&rsquo;s
no default port, so you have to ask your system
administrator for the port number. See DBI::ProxyServer for
details.</p>

<p style="margin-left:11%; margin-top: 1em">Say, your Proxy
server is running on machine &quot;alpha&quot;, port 3334,
and you&rsquo;d like to connect to an <small>ODBC</small>
database called &quot;mydb&quot; as user &quot;joe&quot;
with password &quot;hello&quot;. When using
<small>DBD::ODBC</small> directly, you&rsquo;d do a</p>

<pre style="margin-left:11%; margin-top: 1em">  $dbh = DBI&minus;&gt;connect(&quot;DBI:ODBC:mydb&quot;, &quot;joe&quot;, &quot;hello&quot;);</pre>


<p style="margin-left:11%; margin-top: 1em">With DBD::Proxy
this becomes</p>

<pre style="margin-left:11%; margin-top: 1em">  $dsn = &quot;DBI:Proxy:hostname=alpha;port=3334;dsn=DBI:ODBC:mydb&quot;;
  $dbh = DBI&minus;&gt;connect($dsn, &quot;joe&quot;, &quot;hello&quot;);</pre>


<p style="margin-left:11%; margin-top: 1em">You see, this
is mainly the same. The DBD::Proxy module will create a
connection to the Proxy server on &quot;alpha&quot; which in
turn will connect to the <small>ODBC</small> database.</p>

<p style="margin-left:11%; margin-top: 1em">Refer to the
<small>DBI</small> documentation on the
<tt>&quot;connect&quot;</tt> method for a way to
automatically use DBD::Proxy without having to change your
code.</p>


<p style="margin-left:11%; margin-top: 1em">DBD::Proxy&rsquo;s
<small>DSN</small> string has the format</p>

<pre style="margin-left:11%; margin-top: 1em">  $dsn = &quot;DBI:Proxy:key1=val1; ... ;keyN=valN;dsn=valDSN&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">In other words,
it is a collection of key/value pairs. The following keys
are recognized: <br>
hostname <br>
port</p>

<p style="margin-left:17%;">Hostname and port of the Proxy
server; these keys must be present, no defaults.
Example:</p>

<pre style="margin-left:17%; margin-top: 1em">    hostname=alpha;port=3334</pre>



<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p>dsn</p></td>
<td width="2%"></td>
<td width="83%">


<p>The value of this attribute will be used as a dsn name
by the Proxy server. Thus it must have the format
<tt>&quot;DBI:driver:...&quot;</tt>, in particular it will
contain colons. The <i>dsn</i> value may contain semicolons,
hence this key *must* be the last and it&rsquo;s value will
be the complete remaining part of the dsn. Example:</p></td></tr>
</table>

<pre style="margin-left:17%; margin-top: 1em">    dsn=DBI:ODBC:mydb</pre>


<p style="margin-left:11%;">cipher</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p>key</p></td>
<td width="85%">
</td></tr>
</table>

<p style="margin-left:11%;">usercipher <br>
userkey</p>

<p style="margin-left:17%;">By using these fields you can
enable encryption. If you set, for example,</p>

<pre style="margin-left:17%; margin-top: 1em">    cipher=$class;key=$key</pre>


<p style="margin-left:17%; margin-top: 1em">(note the
semicolon) then DBD::Proxy will create a new cipher object
by executing</p>

<pre style="margin-left:17%; margin-top: 1em">    $cipherRef = $class&minus;&gt;new(pack(&quot;H*&quot;, $key));</pre>


<p style="margin-left:17%; margin-top: 1em">and pass this
object to the RPC::PlClient module when creating a client.
See RPC::PlClient. Example:</p>

<pre style="margin-left:17%; margin-top: 1em">    cipher=IDEA;key=97cd2375efa329aceef2098babdc9721</pre>


<p style="margin-left:17%; margin-top: 1em">The
usercipher/userkey attributes allow you to use two phase
encryption: The cipher/key encryption will be used in the
login and authorisation phase. Once the client is
authorised, he will change to usercipher/userkey encryption.
Thus the cipher/key pair is a <b>host</b> based secret,
typically less secure than the usercipher/userkey secret and
readable by anyone. The usercipher/userkey secret is
<b>your</b> private secret.</p>

<p style="margin-left:17%; margin-top: 1em">Of course
encryption requires an appropriately configured server. See
&lt;DBD::ProxyServer/CONFIGURATION <small>FILE</small>
&gt;.</p>

<p style="margin-left:11%;">debug</p>

<p style="margin-left:17%;">Turn on debugging mode</p>

<p style="margin-left:11%;">stderr</p>

<p style="margin-left:17%;">This attribute will set the
corresponding attribute of the RPC::PlClient object, thus
logging will not use <i>syslog()</i>, but redirected to
stderr. This is the default under Windows.</p>

<pre style="margin-left:17%; margin-top: 1em">    stderr=1</pre>


<p style="margin-left:11%;">logfile</p>

<p style="margin-left:17%;">Similar to the stderr
attribute, but output will be redirected to the given
file.</p>

<pre style="margin-left:17%; margin-top: 1em">    logfile=/dev/null</pre>


<p style="margin-left:11%;">RowCacheSize</p>

<p style="margin-left:17%;">The DBD::Proxy driver supports
this attribute (which is <small>DBI</small> standard, as of
<small>DBI 1.02</small> ). It&rsquo;s used to reduce network
round-trips by fetching multiple rows in one go. The current
default value is 20, but this may change.</p>

<p style="margin-left:11%;">proxy_no_finish</p>

<p style="margin-left:17%;">This attribute can be used to
reduce network traffic: If the application is calling
<tt>$sth</tt>&minus;&gt;<i>finish()</i> then the proxy tells
the server to finish the remote statement handle. Of course
this slows down things quite a lot, but is perfectly good
for reducing memory usage with persistent connections.</p>

<p style="margin-left:17%; margin-top: 1em">However, if you
set the <i>proxy_no_finish</i> attribute to a
<small>TRUE</small> value, either in the database handle or
in the statement handle, then <i>finish()</i> calls will be
supressed. This is what you want, for example, in small and
fast <small>CGI</small> applications.</p>

<p style="margin-left:11%;">proxy_quote</p>

<p style="margin-left:17%;">This attribute can be used to
reduce network traffic: By default calls to
<tt>$dbh</tt>&minus;&gt;<i>quote()</i> are passed to the
remote driver. Of course this slows down things quite a lot,
but is the safest default behaviour.</p>

<p style="margin-left:17%; margin-top: 1em">However, if you
set the <i>proxy_quote</i> attribute to the value
&rsquo;<tt>&quot;local&quot;</tt>&rsquo; either in the
database handle or in the statement handle, and the call to
quote has only one parameter, then the local default
<small>DBI</small> quote method will be used (which will be
faster but may be wrong).</p>

<h2>KNOWN ISSUES
<a name="KNOWN ISSUES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Unproxied
method calls</b> <br>
If a method isn&rsquo;t being proxied, try declaring a stub
sub in the appropriate package (DBD::Proxy::db for a dbh
method, and DBD::Proxy::st for an sth method). For
example:</p>

<pre style="margin-left:11%; margin-top: 1em">    sub DBD::Proxy::db::selectall_arrayref;</pre>


<p style="margin-left:11%; margin-top: 1em">That will
enable selectall_arrayref to be proxied.</p>

<p style="margin-left:11%; margin-top: 1em">Currently many
methods aren&rsquo;t explicitly proxied and so you get the
<small>DBI</small> &rsquo;s default methods executed on the
client.</p>

<p style="margin-left:11%; margin-top: 1em">Some of those
methods, like selectall_arrayref, may then call other
methods that are proxied (selectall_arrayref calls
fetchall_arrayref which calls fetch which is proxied). So
things may appear to work but operate more slowly than the
could.</p>

<p style="margin-left:11%; margin-top: 1em">This may all
change in a later version.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Complex
handle attributes</b> <br>
Sometimes handles are having complex attributes like hash
refs or array refs and not simple strings or integers. For
example, with <small>DBD::CSV,</small> you would like to
write something like</p>

<pre style="margin-left:11%; margin-top: 1em">  $dbh&minus;&gt;{&quot;csv_tables&quot;}&minus;&gt;{&quot;passwd&quot;} =
        { &quot;sep_char&quot; =&gt; &quot;:&quot;, &quot;eol&quot; =&gt; &quot;\n&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">The above
example would advice the <small>CSV</small> driver to assume
the file &quot;passwd&quot; to be in the format of the
/etc/passwd file: Colons as separators and a line feed
without carriage return as line terminator.</p>

<p style="margin-left:11%; margin-top: 1em">Surprisingly
this example doesn&rsquo;t work with the proxy driver. To
understand the reasons, you should consider the following:
The Perl compiler is executing the above example in two
steps:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>1.</p></td>
<td width="3%"></td>
<td width="83%">


<p>The first step is fetching the value of the key
&quot;csv_tables&quot; in the handle <tt>$dbh</tt>. The
value returned is complex, a hash ref.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2.</p></td>
<td width="3%"></td>
<td width="83%">


<p>The second step is storing some value (the right hand
side of the assignment) as the key &quot;passwd&quot; in the
hash ref from step 1.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">This becomes a
little bit clearer, if we rewrite the above code:</p>

<pre style="margin-left:11%; margin-top: 1em">  $tables = $dbh&minus;&gt;{&quot;csv_tables&quot;};
  $tables&minus;&gt;{&quot;passwd&quot;} = { &quot;sep_char&quot; =&gt; &quot;:&quot;, &quot;eol&quot; =&gt; &quot;\n&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">While the
examples work fine without the proxy, the fail due to a
subtle difference in step 1: By <small>DBI</small> magic,
the hash ref
<tt>$dbh</tt>&minus;&gt;{&rsquo;csv_tables&rsquo;} is
returned from the server to the client. The client creates a
local copy. This local copy is the result of step 1. In
other words, step 2 modifies a local copy of the hash ref,
but not the server&rsquo;s hash ref.</p>

<p style="margin-left:11%; margin-top: 1em">The workaround
is storing the modified local copy back to the server:</p>

<pre style="margin-left:11%; margin-top: 1em">  $tables = $dbh&minus;&gt;{&quot;csv_tables&quot;};
  $tables&minus;&gt;{&quot;passwd&quot;} = { &quot;sep_char&quot; =&gt; &quot;:&quot;, &quot;eol&quot; =&gt; &quot;\n&quot;;
  $dbh&minus;&gt;{&quot;csv_tables&quot;} = $tables;</pre>


<h2>SECURITY WARNING
<a name="SECURITY WARNING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">RPC::PlClient
used underneath is not secure due to serializing and
deserializing data with Storable module. Use the proxy
driver only in trusted environment.</p>

<h2>AUTHOR AND COPYRIGHT
<a name="AUTHOR AND COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This module is
Copyright (c) 1997, 1998</p>

<pre style="margin-left:11%; margin-top: 1em">    Jochen Wiedmann
    Am Eisteich 9
    72555 Metzingen
    Germany
    Email: joe@ispsoft.de
    Phone: +49 7123 14887</pre>


<p style="margin-left:11%; margin-top: 1em">The DBD::Proxy
module is free software; you can redistribute it and/or
modify it under the same terms as Perl itself. In particular
permission is granted to Tim Bunce for distributing this as
a part of the <small>DBI.</small></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><small>DBI</small>
, RPC::PlClient, Storable</p>
<hr>
</body>
</html>
