<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 00:22:32 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>ARPWATCH</title>

</head>
<body>

<h1 align="center">ARPWATCH</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#REPORT MESSAGES">REPORT MESSAGES</a><br>
<a href="#SYSLOG MESSAGES">SYSLOG MESSAGES</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#BUGS">BUGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">arpwatch - keep
track of ethernet/ip address pairings</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>arpwatch</b>
[ <b>-dN</b> ] [ <b>-f</b> <i>datafile</i> ] [ <b>-i</b>
<i>interface</i> ] <br>
[ <b>-n</b> <i>net</i>[/<i>width</i> ]] [ <b>-r</b>
<i>file</i> ] [ <b>-u</b> <i>username</i> ] [ <b>-e</b>
<i>username</i> ] [ <b>-s</b> <i>username</i> ]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Arpwatch</b>
keeps track for ethernet/ip address pairings. It syslogs
activity and reports certain changes via email.
<b>Arpwatch</b> uses <b>pcap</b>(3) to listen for arp
packets on a local ethernet interface.</p>

<p style="margin-left:11%; margin-top: 1em">The <b>-d</b>
flag is used enable debugging. This also inhibits forking
into the background and emailing the reports. Instead, they
are sent to <i>stderr</i>.</p>

<p style="margin-left:11%; margin-top: 1em">The <b>-f</b>
flag is used to set the ethernet/ip address database
filename. The default is <i>arp.dat</i>.</p>

<p style="margin-left:11%; margin-top: 1em">The <b>-i</b>
flag is used to override the default interface.</p>

<p style="margin-left:11%; margin-top: 1em">The <b>-n</b>
flag specifies additional local networks. This can be useful
to avoid &quot;bogon&quot; warnings when there is more than
one network running on the same wire. If the optional
<i>width</i> is not specified, the default netmask for the
network&rsquo;s class is used.</p>

<p style="margin-left:11%; margin-top: 1em">The <b>-N</b>
flag disables reporting any bogons.</p>

<p style="margin-left:11%; margin-top: 1em">The <b>-r</b>
flag is used to specify a savefile (perhaps created by
<b>tcpdump</b>(1) or <b>pcapture</b>(1)) to read from
instead of reading from the network. In this case,
<b>arpwatch</b> does not fork.</p>

<p style="margin-left:11%; margin-top: 1em">If <b>-u</b>
flag is used, <b>arpwatch</b> drops root privileges and
changes user ID to <i>username</i> and group ID to that of
the primary group of <i>username</i>. This is recommended
for security reasons.</p>

<p style="margin-left:11%; margin-top: 1em">If the
<b>-e</b> flag is used, <b>arpwatch</b> sends e-mail
messages to <i>username</i> rather than the default (root).
If a single &lsquo;-&rsquo; character is given for the
username, sending of e-mail is suppressed, but logging via
syslog is still done as usual. (This can be useful during
initial runs, to collect data without being flooded with
messages about new stations.)</p>

<p style="margin-left:11%; margin-top: 1em">If the
<b>-s</b> flag is used, <b>arpwatch</b> sends e-mail
messages with <i>username</i> as the return address, rather
than the default (root).</p>

<p style="margin-left:11%; margin-top: 1em">Note that an
empty <i>arp.dat</i> file must be created before the first
time you run <b>arpwatch</b>. Also, the default directory
(where arp.dat is stored) must be owned by <i>username</i>
if <b>-u</b> flag is used.</p>

<h2>REPORT MESSAGES
<a name="REPORT MESSAGES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Here&rsquo;s a
quick list of the report messages generated by
<b>arpwatch</b>(1) (and <b>arpsnmp</b>(1)): <b><br>
new activity</b></p>

<p style="margin-left:22%;">This ethernet/ip address pair
has been used for the first time six months or more.</p>

<p style="margin-left:11%;"><b>new station</b></p>

<p style="margin-left:22%;">The ethernet address has not
been seen before.</p>

<p style="margin-left:11%;"><b>flip flop</b></p>

<p style="margin-left:22%;">The ethernet address has
changed from the most recently seen address to the second
most recently seen address. (If either the old or new
ethernet address is a DECnet address and it is less than 24
hours, the email version of the report is suppressed.)</p>

<p style="margin-left:11%;"><b>changed ethernet
address</b></p>

<p style="margin-left:22%;">The host switched to a new
ethernet address.</p>

<h2>SYSLOG MESSAGES
<a name="SYSLOG MESSAGES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Here are some
of the syslog messages; note that messages that are reported
are also sysloged. <b><br>
ethernet broadcast</b></p>

<p style="margin-left:22%;">The mac ethernet address of the
host is a broadcast address.</p>

<p style="margin-left:11%;"><b>ip broadcast</b></p>

<p style="margin-left:22%;">The ip address of the host is a
broadcast address.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>bogon</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>The source ip address is not local to the local
subnet.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>ethernet broadcast</b></p>

<p style="margin-left:22%;">The source mac or arp ethernet
address was all ones or all zeros.</p>

<p style="margin-left:11%;"><b>ethernet mismatch</b></p>

<p style="margin-left:22%;">The source mac ethernet address
didn&rsquo;t match the address inside the arp packet.</p>

<p style="margin-left:11%;"><b>reused old ethernet
address</b></p>

<p style="margin-left:22%;">The ethernet address has
changed from the most recently seen address to the third (or
greater) least recently seen address. (This is similar to a
flip flop.)</p>

<p style="margin-left:11%;"><b>suppressed DECnet flip
flop</b></p>

<p style="margin-left:22%;">A &quot;flip flop&quot; report
was suppressed because one of the two addresses was a DECnet
address.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">/var/lib/arpwatch
- default directory <br>
arp.dat - ethernet/ip address database <br>
ethercodes.dat - vendor ethernet block list</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>arpsnmp</b>(8),
<b>arp</b>(8), <b>bpf</b>(4), <b>tcpdump</b>(1),
<b>pcapture</b>(1), <b>pcap</b>(3)</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Craig Leres of
the Lawrence Berkeley National Laboratory Network Research
Group, University of California, Berkeley, CA.</p>

<p style="margin-left:11%; margin-top: 1em">The current
version is available via anonymous ftp:</p>


<p style="margin-left:22%; margin-top: 1em"><i>ftp://ftp.ee.lbl.gov/arpwatch.tar.gz</i></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please send bug
reports to arpwatch@ee.lbl.gov.</p>

<p style="margin-left:11%; margin-top: 1em">Attempts are
made to suppress DECnet flip flops but they aren&rsquo;t
always successful.</p>

<p style="margin-left:11%; margin-top: 1em">Most error
messages are posted using syslog.</p>
<hr>
</body>
</html>
