<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 01:27:31 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SMTP-SINK</title>

</head>
<body>

<h1 align="center">SMTP-SINK</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#DUMP FILE FORMAT">DUMP FILE FORMAT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#AUTHOR(S)">AUTHOR(S)</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">smtp-sink
&minus; multi-threaded SMTP/LMTP test server</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>smtp-sink</b>
[<i>options</i>] [<b>inet:</b>][<i>host</i>]:<i>port
backlog</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>smtp-sink</b>
[<i>options</i>] <b>unix:</b><i>pathname backlog</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>smtp-sink</b></i>
listens on the named host (or address) and port. It takes
SMTP messages from the network and throws them away. The
purpose is to measure client performance, not protocol
compliance.</p>


<p style="margin-left:11%; margin-top: 1em"><b>smtp-sink</b>
may also be configured to capture each mail delivery
transaction to file. Since disk latencies are large compared
to network delays, this mode of operation can reduce the
maximal performance by several orders of magnitude.</p>

<p style="margin-left:11%; margin-top: 1em">Connections can
be accepted on IPv4 or IPv6 endpoints, or on UNIX-domain
sockets. IPv4 and IPv6 are the default. This program is the
complement of the <b>smtp-source</b>(1) program.</p>

<p style="margin-left:11%; margin-top: 1em">Note: this is
an unsupported test program. No attempt is made to maintain
compatibility between successive versions.</p>

<p style="margin-left:11%; margin-top: 1em">Arguments:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-4</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Support IPv4 only. This option has no effect when
Postfix is built without IPv6 support.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-6</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Support IPv6 only. This option is not available when
Postfix is built without IPv6 support.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-8</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Do not announce 8BITMIME support.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-a</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Do not announce SASL authentication support.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-A</b> <i>delay</i></p>

<p style="margin-left:22%;">Wait <i>delay</i> seconds after
responding to DATA, then abort prematurely with a 550 reply
status. Do not read further input from the client; this is
an attempt to block the client before it sends
&quot;.&quot;. Specify a zero delay value to abort
immediately.</p>

<p style="margin-left:11%;"><b>-b</b>
<i>soft-bounce-reply</i></p>

<p style="margin-left:22%;">Use <i>soft-bounce-reply</i>
for soft reject responses. The default reply is &quot;450
4.3.0 Error: command failed&quot;.</p>

<p style="margin-left:11%;"><b>-B</b>
<i>hard-bounce-reply</i></p>

<p style="margin-left:22%;">Use <i>hard-bounce-reply</i>
for hard reject responses. The default reply is &quot;500
5.3.0 Error: command failed&quot;.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-c</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Display running counters that are updated whenever an
SMTP session ends, a QUIT command is executed, or when
&quot;.&quot; is received.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-C</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Disable XCLIENT support.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-d</b>
<i>dump-template</i></p>

<p style="margin-left:22%;">Dump each mail transaction to a
single-message file whose name is created by expanding the
<i>dump-template</i> via strftime(3) and appending a
pseudo-random hexadecimal number (example:
&quot;%Y%m%d%H/%M.&quot; expands into
&quot;2006081203/05.809a62e3&quot;). If the template
contains &quot;/&quot; characters, missing directories are
created automatically. The message dump format is described
below.</p>

<p style="margin-left:22%; margin-top: 1em">Note: this
option keeps one capture file open for every mail
transaction in progress.</p>

<p style="margin-left:11%;"><b>-D</b>
<i>dump-template</i></p>

<p style="margin-left:22%;">Append mail transactions to a
multi-message dump file whose name is created by expanding
the <i>dump-template</i> via strftime(3). If the template
contains &quot;/&quot; characters, missing directories are
created automatically. The message dump format is described
below.</p>

<p style="margin-left:22%; margin-top: 1em">Note: this
option keeps one capture file open for every mail
transaction in progress.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-e</b></p></td>
<td width="8%"></td>
<td width="67%">


<p>Do not announce ESMTP support.</p></td>
<td width="11%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-E</b></p></td>
<td width="8%"></td>
<td width="67%">


<p>Do not announce ENHANCEDSTATUSCODES support.</p></td>
<td width="11%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>-f</b>
<i>command,command,...</i></p>

<p style="margin-left:22%;">Reject the specified commands
with a hard (5xx) error code. This option implies
<b>-p</b>.</p>

<p style="margin-left:22%; margin-top: 1em">Examples of
commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY,
DATA, ., RSET, NOOP, and QUIT. Separate command names by
white space or commas, and use quotes to protect white space
from the shell. Command names are case-insensitive.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-F</b></p></td>
<td width="8%"></td>
<td width="38%">


<p>Disable XFORWARD support.</p></td>
<td width="40%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>-h</b> <i>hostname</i></p>

<p style="margin-left:22%;">Use <i>hostname</i> in the SMTP
greeting, in the HELO response, and in the EHLO response.
The default hostname is &quot;smtp-sink&quot;.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-L</b></p></td>
<td width="8%"></td>
<td width="43%">


<p>Enable LMTP instead of SMTP.</p></td>
<td width="35%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>-m</b> <i>count</i>
(default: 256)</p>

<p style="margin-left:22%;">An upper bound on the maximal
number of simultaneous connections that <b>smtp-sink</b>
will handle. This prevents the process from running out of
file descriptors. Excess connections will stay queued in the
TCP/IP stack.</p>

<p style="margin-left:11%;"><b>-M</b> <i>count</i></p>

<p style="margin-left:22%;">Terminate after receiving
<i>count</i> messages.</p>

<p style="margin-left:11%;"><b>-n</b> <i>count</i></p>

<p style="margin-left:22%;">Terminate after <i>count</i>
sessions.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-p</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Do not announce support for ESMTP command
pipelining.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-P</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Change the server greeting so that it appears to come
through a CISCO PIX system. Implies <b>-e</b>.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-q</b>
<i>command,command,...</i></p>

<p style="margin-left:22%;">Disconnect (without replying)
after receiving one of the specified commands.</p>

<p style="margin-left:22%; margin-top: 1em">Examples of
commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY,
DATA, ., RSET, NOOP, and QUIT. Separate command names by
white space or commas, and use quotes to protect white space
from the shell. Command names are case-insensitive.</p>

<p style="margin-left:11%;"><b>-Q</b>
<i>command,command,...</i></p>

<p style="margin-left:22%;">Send a 421 reply and disconnect
after receiving one of the specified commands.</p>

<p style="margin-left:22%; margin-top: 1em">Examples of
commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY,
DATA, ., RSET, NOOP, and QUIT. Separate command names by
white space or commas, and use quotes to protect white space
from the shell. Command names are case-insensitive.</p>

<p style="margin-left:11%;"><b>-r</b>
<i>command,command,...</i></p>

<p style="margin-left:22%;">Reject the specified commands
with a soft (4xx) error code. This option implies
<b>-p</b>.</p>

<p style="margin-left:22%; margin-top: 1em">Examples of
commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY,
DATA, ., RSET, NOOP, and QUIT. Separate command names by
white space or commas, and use quotes to protect white space
from the shell. Command names are case-insensitive.</p>

<p style="margin-left:11%;"><b>-R</b>
<i>root-directory</i></p>

<p style="margin-left:22%;">Change the process root
directory to the specified location. This option requires
super-user privileges. See also the <b>-u</b> option.</p>

<p style="margin-left:11%;"><b>-s</b>
<i>command,command,...</i></p>

<p style="margin-left:22%;">Log the named commands to
syslogd.</p>

<p style="margin-left:22%; margin-top: 1em">Examples of
commands are CONNECT, HELO, EHLO, LHLO, MAIL, RCPT, VRFY,
DATA, ., RSET, NOOP, and QUIT. Separate command names by
white space or commas, and use quotes to protect white space
from the shell. Command names are case-insensitive.</p>

<p style="margin-left:11%;"><b>-S start-string</b></p>

<p style="margin-left:22%;">An optional string that is
prepended to each message that is written to a dump file
(see the dump file format description below). The following
C escape sequences are supported: \a (bell), \b (backslace),
\f (formfeed), \n (newline), \r (carriage return), \t
(horizontal tab), \v (vertical tab), \<i>ddd</i> (up to
three octal digits) and \\ (the backslash character).</p>

<p style="margin-left:11%;"><b>-t</b> <i>timeout</i>
(default: 100)</p>

<p style="margin-left:22%;">Limit the time for receiving a
command or sending a response. The time limit is specified
in seconds.</p>

<p style="margin-left:11%;"><b>-T</b> <i>windowsize</i></p>

<p style="margin-left:22%;">Override the default TCP window
size. To work around broken TCP window scaling
implementations, specify a value &gt; 0 and &lt; 65536.</p>

<p style="margin-left:11%;"><b>-u</b> <i>username</i></p>

<p style="margin-left:22%;">Switch to the specified user
privileges after opening the network socket and optionally
changing the process root directory. This option is required
when the process runs with super-user privileges. See also
the <b>-R</b> option.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-v</b></p></td>
<td width="8%"></td>
<td width="43%">


<p>Show the SMTP conversations.</p></td>
<td width="35%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>-w</b> <i>delay</i></p>

<p style="margin-left:22%;">Wait <i>delay</i> seconds
before responding to a DATA command.</p>

<p style="margin-left:11%;"><b>-W</b>
<i>command:delay[:odds]</i></p>

<p style="margin-left:22%;">Wait <i>delay</i> seconds
before responding to <i>command</i>. If <i>odds</i> is also
specified (a number between 1-99 inclusive), wait for a
random multiple of <i>delay</i>. The random multiplier is
equal to the number of times the program needs to roll a
dice with a range of 0..99 inclusive, before the dice
produces a result greater than or equal to <i>odds</i>.</p>


<p style="margin-left:11%;">[<b>inet:</b>][<i>host</i>]:<i>port</i></p>

<p style="margin-left:22%;">Listen on network interface
<i>host</i> (default: any interface) TCP port <i>port</i>.
Both <i>host</i> and <i>port</i> may be specified in numeric
or symbolic form.</p>


<p style="margin-left:11%;"><b>unix:</b><i>pathname</i></p>

<p style="margin-left:22%;">Listen on the UNIX-domain
socket at <i>pathname</i>.</p>

<p style="margin-left:11%;"><i>backlog</i></p>

<p style="margin-left:22%;">The maximum length the queue of
pending connections, as defined by the <b>listen</b>(2)
system call.</p>

<h2>DUMP FILE FORMAT
<a name="DUMP FILE FORMAT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Each dumped
message contains a sequence of text lines, terminated with
the newline character. The sequence of information is as
follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="10%"></td>
<td width="78%">


<p>The optional string specified with the <b>-S</b>
option.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="10%"></td>
<td width="78%">


<p>The <b>smtp-sink</b> generated headers as documented
below.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="10%"></td>
<td width="78%">


<p>The message header and body as received from the SMTP
client.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="10%"></td>
<td width="78%">


<p>An empty line.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The format of
the <b>smtp-sink</b> generated headers is as follows:
<b><br>
X-Client-Addr:</b> <i>text</i></p>

<p style="margin-left:22%;">The client IP address without
enclosing []. An IPv6 address is prefixed with
&quot;ipv6:&quot;. This record is always present.</p>

<p style="margin-left:11%;"><b>X-Client-Proto:</b>
<i>text</i></p>

<p style="margin-left:22%;">The client protocol: SMTP,
ESMTP or LMTP. This record is always present.</p>

<p style="margin-left:11%;"><b>X-Helo-Args:</b>
<i>text</i></p>

<p style="margin-left:22%;">The arguments of the last HELO
or EHLO command before this mail delivery transaction. This
record is present only if the client sent a recognizable
HELO or EHLO command before the DATA command.</p>

<p style="margin-left:11%;"><b>X-Mail-Args:</b>
<i>text</i></p>

<p style="margin-left:22%;">The arguments of the MAIL
command that started this mail delivery transaction. This
record is present exactly once.</p>

<p style="margin-left:11%;"><b>X-Rcpt-Args:</b>
<i>text</i></p>

<p style="margin-left:22%;">The arguments of an RCPT
command within this mail delivery transaction. There is one
record for each RCPT command, and they are in the order as
sent by the client.</p>

<p style="margin-left:11%;"><b>Received:</b>
<i>text</i></p>

<p style="margin-left:22%;">A message header for
compatibility with mail processing software. This three-line
header marks the end of the headers provided by
<b>smtp-sink</b>, and is formatted as follows: <b><br>
from</b> <i>helo</i> <b>([</b><i>addr</i><b>])</b></p>

<p style="margin-left:32%;">The HELO or EHLO command
argument and client IP address. If the client did not send
HELO or EHLO, the client IP address is used instead.</p>

<p style="margin-left:22%;"><b>by</b> <i>host</i>
<b>(smtp-sink) with</b> <i>proto</i> <b>id</b>
<i>random</i><b>;</b></p>

<p style="margin-left:32%;">The hostname specified with the
<b>-h</b> option, the client protocol (see
<b>X-Client-Proto</b> above), and the pseudo-random portion
of the per-message capture file name.</p>

<p style="margin-left:22%;"><i>time-stamp</i></p>

<p style="margin-left:32%;">A time stamp as defined in RFC
2822.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">smtp-source(1),
SMTP/LMTP message generator</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The Secure
Mailer license must be distributed with this software.</p>

<h2>AUTHOR(S)
<a name="AUTHOR(S)"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Wietse Venema
<br>
IBM T.J. Watson Research <br>
P.O. Box 704 <br>
Yorktown Heights, NY 10598, USA</p>
<hr>
</body>
</html>
