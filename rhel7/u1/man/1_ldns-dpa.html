<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 00:38:24 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>dpa</title>

</head>
<body>

<h1 align="center">dpa</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#LIST AND MATCHES">LIST AND MATCHES</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#REPORTING BUGS">REPORTING BUGS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">dpa &minus; DNS
Packet Analyzer. Analyze DNS packets in ip trace files</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>dpa</b> [
<i>OPTION</i> ] <i>TRACEFILE</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>dpa</b></i>
is used to analyze dns packets in trace files. It has 3 main
options: count, filter, and count uniques (i.e. count all
different occurences).</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>-c</b>
<i>expressionlist</i></p>

<p style="margin-left:22%;">Count occurrences of matching
expressions</p>

<p style="margin-left:11%;"><b>-f</b> <i>expression</i></p>

<p style="margin-left:22%;">Filter: only process packets
that match the expression</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-h</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Show usage</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-p</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Show the total number of correct DNS packets, and
percentage of -u and -c values (of the total of matching on
the -f filter. if no filter is given, percentages are on all
correct dns packets)</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-of</b> <i>file</i></p>

<p style="margin-left:22%;">Write all packets that match
the -f flag to file, as pcap data.</p>

<p style="margin-left:11%;"><b>-ofh</b> <i>file</i></p>

<p style="margin-left:22%;">Write all packets that match
the -f flag to file, in hexadecimal format, readable by
drill.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-s</b></p></td>
<td width="8%"></td>
<td width="38%">


<p>Show possible match names</p></td>
<td width="40%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>-s</b> <i>matchname</i></p>

<p style="margin-left:22%;">show possible match operators
and values for name</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>-sf</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>Only evaluate packets (in representation format) that
match the -f filter. If no -f was given, evaluate all
correct dns packets.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-u</b>
<i>matchnamelist</i></p>

<p style="margin-left:22%;">Count every occurence of every
value of the matchname (for instance, count all packetsizes,
see EXAMPLES in ldns-dpa(1) ).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><b>-ua</b></p></td>
<td width="5%"></td>
<td width="78%">


<p>For every matchname in -u, show the average value of all
matches. Behaviour for match types that do not have an
integer value is undefined.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><b>-uac</b></p></td>
<td width="5%"></td>
<td width="78%">


<p>For every matchname in -u, show the average number of
times this value was encountered.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>-um</b> <i>number</i></p>

<p style="margin-left:22%;">Only show the results from -u
for values that occurred more than &lt;number&gt; times.</p>

<p style="margin-left:11%;"><b>-v</b> <i>level</i></p>

<p style="margin-left:22%;">Set verbosity to level (1-5, 5
being the highest). Mostly used for debugging.</p>

<p style="margin-left:11%;"><b>-notip</b> <i>file</i></p>

<p style="margin-left:22%;">Write packets that were not
recognized as IP packets to file (as pcap data).</p>

<p style="margin-left:11%;"><b>-baddns</b> <i>file</i></p>

<p style="margin-left:22%;">Write dns packets that were too
mangled to parse to file (as pcap data).</p>

<p style="margin-left:11%;"><b>-version</b></p>

<p style="margin-left:22%;">Show version and exit</p>

<h2>LIST AND MATCHES
<a name="LIST AND MATCHES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A
&lt;matchnamelist&gt; is a comma separated list of match
names (use -s to see possible match names). A
&lt;expressionlist&gt; is a comma separated list of
expressions.</p>

<p style="margin-left:11%; margin-top: 1em">An expression
has the following form: &lt;expr&gt;: (&lt;expr&gt;) <br>
&lt;expr&gt; | &lt;expr&gt; <br>
&lt;expr&gt; &amp; &lt;expr&gt; <br>
&lt;match&gt;</p>

<p style="margin-left:11%; margin-top: 1em">&lt;match&gt;:
&lt;matchname&gt; &lt;operator&gt; &lt;value&gt;</p>


<p style="margin-left:11%; margin-top: 1em">&lt;operator&gt;:
= equal to &lt;value&gt; != not equal to &lt;value&gt; &gt;
greater than &lt;value&gt; &lt; lesser than &lt;value&gt;
&gt;= greater than or equal to &lt;value&gt; &lt;= lesser
than or equal to &lt;value&gt; ~= contains &lt;value&gt;</p>

<p style="margin-left:11%; margin-top: 1em">See the -s
option for possible matchnames, operators and values.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ldns-dpa -u
packetsize -p test.tr</p>

<p style="margin-left:22%;">Count all different packetsizes
in test.tr and show the precentages.</p>

<p style="margin-left:11%;">ldns-dpa -f
&quot;edns=1&amp;qr=0&quot; -of edns.tr test.tr</p>

<p style="margin-left:22%;">Filter out all edns enable
queries in test.tr and put them in edns.tr</p>

<p style="margin-left:11%;">ldns-dpa -f edns=1 -c tc=1 -u
rcode test.tr</p>

<p style="margin-left:22%;">For all edns packets, count the
number of truncated packets and all their rcodes in
test.tr.</p>

<p style="margin-left:11%;">ldns-dpa -c
tc=1,qr=0,qr=1,opcode=QUERY test.tr</p>

<p style="margin-left:22%;">For all packets, count the
number of truncated packets, the number of packets with
qr=0, the number of packets with qr=1 and the number of
queries in test.tr.</p>

<p style="margin-left:11%;">ldns-dpa -u packetsize -ua
test.tr</p>

<p style="margin-left:22%;">Show all packet sizes and the
average packet size per packet.</p>

<p style="margin-left:11%;">ldns-dpa -u srcaddress -uac
test.tr</p>

<p style="margin-left:22%;">Show all packet source
addresses and the average number of packets sent from this
address.</p>

<p style="margin-left:11%;">sudo tcpdump -i eth0 -s 0 -U -w
- port 53 | ldns-dpa -f qr=0 -sf</p>

<p style="margin-left:22%;">Print all query packets seen on
the specified interface.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Written by
Jelte Jansen for NLnetLabs.</p>

<h2>REPORTING BUGS
<a name="REPORTING BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Report bugs to
&lt;jelte@nlnetlabs.nl&gt;.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2005 NLnet Labs. This is free software. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.</p>
<hr>
</body>
</html>
