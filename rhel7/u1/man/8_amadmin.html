<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 00:21:49 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>AMADMIN</title>

</head>
<body>

<h1 align="center">AMADMIN</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#COMMANDS">COMMANDS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">amadmin &minus;
administrative interface to control Amanda backups</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>amadmin</b>
[&minus;&minus;version] [&minus;&minus;no&minus;default]
[&minus;&minus;print&minus;source]
[&minus;&minus;exact&minus;match]
[<b>&minus;o&nbsp;</b><i>configoption</i>...] <i>config
command</i> [<i>command_options</i>...]</p></td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Amadmin</b>
performs various administrative tasks on the <i>config</i>
Amanda configuration.</p>

<p style="margin-left:11%; margin-top: 1em">See the
<b>amanda</b>(8) man page for more details about Amanda.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;version</b></p>

<p style="margin-left:17%;">Print the version and exit.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;no&minus;default</b></p>

<p style="margin-left:17%;">Do not print default values for
<b>config</b> and <b>disklist</b> commands.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;print&minus;source</b></p>

<p style="margin-left:17%;">Print where a value is defined
for <b>config</b> and <b>disklist</b> commands.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;exact&minus;match</b></p>

<p style="margin-left:17%;">The host and disk are parsed as
exact values</p>

<h2>COMMANDS
<a name="COMMANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Commands that
take a <i>hostname</i> [ <i>disks</i> ] parameter pair
operate on all disks in the <b>disklist</b>(5) for that
<i>hostname</i> if no disks are specified. Where
<i>hostname</i> is also marked as being optional, the
command operates on all hosts and disks in the
<b>disklist</b>(5) when no hostname is given. Both
<i>hostname</i> and <i>disks</i> are match expressions; see
<b>amanda-match</b>(7) for a description.</p>


<p style="margin-left:11%; margin-top: 1em"><b>version</b></p>

<p style="margin-left:17%;">Show the current version and
some compile time and runtime parameters. The <i>config</i>
parameter must be present but is ignored.</p>


<p style="margin-left:11%; margin-top: 1em"><b>estimate</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]*</p>

<p style="margin-left:17%;">Print the server estimate for
the dles, each output lines have the following format: <br>
hostname diskname level size</p>

<p style="margin-left:17%; margin-top: 1em">hostname</p>

<p style="margin-left:23%;">The quoted hostname</p>

<p style="margin-left:17%; margin-top: 1em">diskname</p>

<p style="margin-left:23%;">The quoted diskname</p>

<p style="margin-left:17%; margin-top: 1em">level</p>

<p style="margin-left:23%;">The level of the estimate</p>

<p style="margin-left:17%; margin-top: 1em">size</p>

<p style="margin-left:23%;">The estimate size in kbytes</p>


<p style="margin-left:11%; margin-top: 1em"><b>force&minus;bump</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]+</p>

<p style="margin-left:17%;">Force the <i>disks</i> on
<i>hostname</i> to bump to a new incremental level during
the next Amanda run.</p>


<p style="margin-left:11%; margin-top: 1em"><b>force&minus;no&minus;bump</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]+</p>

<p style="margin-left:17%;">Force the <i>disks</i> on
<i>hostname</i> to not bump to a new incremental level
during the next Amanda run.</p>


<p style="margin-left:11%; margin-top: 1em"><b>unforce&minus;bump</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]+</p>

<p style="margin-left:17%;">Undo a previous
<b>force&minus;bump</b> or <b>force&minus;no&minus;bump</b>
command.</p>

<p style="margin-left:11%; margin-top: 1em"><b>force</b> [
<i>hostname</i> [ <i>disks</i> ]* ]+</p>

<p style="margin-left:17%;">Force the <i>disks</i> on
<i>hostname</i> to do a full (level 0) backup during the
next Amanda run.</p>

<p style="margin-left:11%; margin-top: 1em"><b>unforce</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]+</p>

<p style="margin-left:17%;">Undo a previous <b>force</b>
command.</p>

<p style="margin-left:11%; margin-top: 1em"><b>reuse</b>
<i>tapelabel</i> [ ... ]</p>

<p style="margin-left:17%;">The tapes listed will be
available for reuse at their point in the tape cycle.</p>


<p style="margin-left:11%; margin-top: 1em"><b>no&minus;reuse</b>
<i>tapelabel</i> [ ... ]</p>

<p style="margin-left:17%;">The tapes listed will not be
reused when their turn comes up again in the tape cycle.
Note that if this causes the number of reusable tapes to
drop below the <b>amanda.conf</b> <i>tapecycle</i> value,
Amanda will request new tapes until the count is satisfied
again.</p>

<p style="margin-left:17%; margin-top: 1em">Tape marked
<i>no&minus;reuse</i> are available for recovery, marking
them <i>no&minus;reuse</i> is a security to be sure amanda
will not overwrite them.</p>

<p style="margin-left:11%; margin-top: 1em"><b>due</b> [
<i>hostname</i> [ <i>disks</i> ]* ]*</p>

<p style="margin-left:17%;">Show when the next full dump is
due.</p>

<p style="margin-left:11%; margin-top: 1em"><b>find</b> [
<b>&minus;&minus;sort</b> <i>hkdlpbfw</i> ] [
<i>hostname</i> [ <i>disks</i> ]* ]*</p>

<p style="margin-left:17%;">Display all backups currently
on tape or in the holding disk. The tape label or holding
disk filename, file number, and status are displayed.</p>

<p style="margin-left:17%; margin-top: 1em">The
<b>&minus;&minus;sort</b> option changes the sort order
using the following flags:</p>

<p style="margin-left:17%; margin-top: 1em"><i>h</i>: host
name <i><br>
k</i>: disk name <i><br>
d</i>: dump timestamp <i><br>
l</i>: backup level <i><br>
p</i>: dump part <i><br>
b</i>: tape label <i><br>
f</i>: filenum on tape <i><br>
w</i>: write timestamp</p>

<p style="margin-left:17%; margin-top: 1em">An uppercase
letter reverses the sort order for that key. The default
sort order is <b>hkdlpbfw</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>holding
delete</b> <i>hostname</i> [ <i>disk</i> [ <i>datestamp</i>
[ .. ] ] ]</p>

<p style="margin-left:17%;">Delete holding files matching
the given specification. At least a hostname must be
provided.</p>

<p style="margin-left:11%; margin-top: 1em"><b>holding
list</b> [&minus;l] [&minus;d] [ <i>hostname</i> [
<i>disk</i> [ <i>datestamp</i> [ .. ] ] ] ]</p>

<p style="margin-left:17%;">List holding files matching the
given dump specification, or all holding files if no
specification is provided. See <b>amanda-match</b>(7) for
more information on dump specifications. With '&minus;l',
additional information (size, level, and whether the dump is
outdated) is provided. With '&minus;d', only outdated dumps
are shown.</p>

<p style="margin-left:17%; margin-top: 1em">An outdated
holding file is one which is not required for a restore of
the <i>most recent</i> dump. Note that outdated dumps may
still be required for restores at earlier dates. For
example, assume that a DLE had a level 0 on Monday, level
1's Tuesday through Thursday, and a level 2 on Friday. Then
the files required for a restore of Fridays (the most
recent) dump are those from Monday (level 0), Thursday
(level 1), and Friday (level 2). Tuesday and Wednesday's
files are outdated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>delete</b> [
<i>hostname</i> [ <i>disks</i> ]* ]+</p>

<p style="margin-left:17%;">Delete the specified
<i>disks</i> on <i>hostname</i> from the Amanda
database.</p>


<p style="margin-left:23%; margin-top: 1em"><b><big>Note</big></b>
<br>
If you do not also remove the disk from the
<b>disklist</b>(5) file, Amanda will treat it as a new disk
during the next run.</p>


<p style="margin-left:11%; margin-top: 1em"><b><big>tape</big></b></p>

<p style="margin-left:17%;"><big>Display the tape(s) Amanda
expects to write to during the next run. See also
<b>amcheck</b>(8).</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>bumpsize</b></big></p>

<p style="margin-left:17%;"><big>Display the current bump
threshold parameters, calculated for all backup
levels.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>balance</b>
[ <b>&minus;&minus;days</b> <i>&lt;num&gt;</i> ]</big></p>

<p style="margin-left:17%;"><big>Display the distribution
of full backups throughout the dump schedule.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>export</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]*</big></p>

<p style="margin-left:17%;"><big>Convert records from the
Amanda database to a text format that may be transmitted to
another Amanda machine and <b>import</b>ed.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>import</b></big></p>

<p style="margin-left:17%;"><big>Convert <b>export</b>ed
records read from standard input to a form Amanda uses and
insert them into the database on this machine.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>disklist</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]*</big></p>

<p style="margin-left:17%;"><big>Display the
<b>disklist</b>(5) information for each of the <i>disks</i>
on <i>hostname</i> (or all hosts). Mostly used for
debugging.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>hosts</b></big></p>

<p style="margin-left:17%;"><big>Output a list of distinct
hosts in the <b>disklist</b>(5), one per line, for easy use
in shell scripts.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>dles</b></big></p>

<p style="margin-left:17%;"><big>Output a list of distinct
DLEs in the <b>disklist</b>(5), one per line with host and
diskname separated by a space, for easy use in shell
scripts.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>info</b>
[ <i>hostname</i> [ <i>disks</i> ]* ]*</big></p>

<p style="margin-left:17%;"><big>Display the database
record for each of the <i>disks</i> on <i>hostname</i> (or
all hosts). Mostly used for debugging.</big></p>


<p style="margin-left:11%; margin-top: 1em"><big><b>&minus;o</b>
<i>configoption</i></big></p>

<p style="margin-left:17%;"><big>See the
&quot;CONFIGURATION OVERRIDE&quot; section in
<b>amanda</b>(8).</big></p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><big>Request
three specific file systems on <i>machine&minus;a</i> get a
full level 0 backup during the next Amanda run. <br>
$ amadmin daily force machine&minus;a / /var /usr <br>
amadmin: machine&minus;a:/ is set to a forced level 0
tonight. <br>
amadmin: machine&minus;a:/var is set to a forced level 0
tonight. <br>
amadmin: machine&minus;a:/usr is set to a forced level 0
tonight.</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>Request
all file systems on <i>machine&minus;b</i> get a full level
0 backup during the next Amanda run. <br>
$ amadmin daily force machine&minus;b <br>
amadmin: machine&minus;b:/ is set to a forced level 0
tonight. <br>
amadmin: machine&minus;b:/var is set to a forced level 0
tonight. <br>
amadmin: machine&minus;b:/usr is set to a forced level 0
tonight. <br>
amadmin: machine&minus;b:/home is set to a forced level 0
tonight.</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>Undo the
previous <b>force</b> request for /home on
<i>machine&minus;b</i>. The other file systems will still
get a full level 0 backup. <br>
$ amadmin daily unforce machine&minus;b /home <br>
amadmin: force command for machine&minus;b:/home
cleared.</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>Locate
backup images of /var from <i>machine&minus;c</i>. The
<i>tape or file</i> column displays either a tape label or a
filename depending on whether the image is on tape or is
still in the holding disk. If the image is on tape, the
<i>file</i> column tells you which file on the tape has the
image (file number zero is a tape label). This column shows
zero and is not meaningful if the image is still in the
holding disk. The <i>status</i> column tells you whether the
backup was successful or had some type of error. <br>
$ amadmin daily find machine&minus;c /var <br>
date host disk lv tape or file file part status <br>
2000&minus;11&minus;09 machine&minus;c /var 0 000110 9
&minus;&minus; OK <br>
2000&minus;11&minus;08 machine&minus;c /var 2 000109 2
&minus;&minus; OK <br>
2000&minus;11&minus;07 machine&minus;c /var 2
/amanda/20001107/machine&minus;c._var.2 0 OK <br>
2000&minus;11&minus;06 machine&minus;c /var 2 000107 2
&minus;&minus; OK <br>
2000&minus;11&minus;05 machine&minus;c /var 2 000106 3
&minus;&minus; OK <br>
2000&minus;11&minus;04 machine&minus;c /var 2 000105 2
&minus;&minus; OK <br>
2000&minus;11&minus;03 machine&minus;c /var 2 000104 2
&minus;&minus; OK <br>
2000&minus;11&minus;02 machine&minus;c /var 2 000103 2
&minus;&minus; OK <br>
2000&minus;11&minus;01 machine&minus;c /var 1 000102 5
&minus;&minus; OK <br>
2000&minus;10&minus;31 machine&minus;c /var 1 000101 3
&minus;&minus; OK</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>Forget
about the /workspace disk on <i>machine&minus;d</i>. If you
do not also remove the disk from the <b>disklist</b>(5)
file, Amanda will treat it as a new disk during the next
run. <br>
$ amadmin daily delete machine&minus;d /workspace <br>
amadmin: machine&minus;d:/workspace deleted from database.
<br>
amadmin: NOTE: you'll have to remove these from the
<b>disklist</b>(5) yourself.</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>Find the
next tape Amanda will use (in this case, 123456). <br>
$ amadmin daily tape <br>
The next Amanda run should go onto tape 123456 or a new
tape.</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>Show how
well full backups are balanced across the dump cycle. The
<i>due&minus;date</i> column is the day the backups are due
for a full backup. <i>#fs</i> shows the number of
filesystems doing full backups that night, and <i>orig
KB</i> and <i>out KB</i> show the estimated total size of
the backups before and after any compression,
respectively.</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>The
<i>balance</i> column shows how far off that night's backups
are from the average size (shown at the bottom of the
balance column). Amanda tries to keep the backups within
+/&minus; 5%, but since the amount of data on each
filesystem is always changing, and Amanda will never delay
backups just to rebalance the schedule, it is common for the
schedule to fluctuate by larger percentages. In particular,
in the case of a tape or backup failure, a bump will occur
the following night, which will not be smoothed out until
the next pass through the schedule.</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>The last
line also shows an estimate of how many Amanda runs will be
made between full backups for a file system. In the example,
a file system will probably have a full backup done every
eight times Amanda is run (e.g. every eight days). <br>
$ amadmin daily balance <br>
due&minus;date #fs orig KB out KB balance <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
11/10 Mon 21 930389 768753 +5.1% <br>
11/11 Tue 29 1236272 733211 +0.2% <br>
11/12 Wed 31 1552381 735796 +0.6% <br>
11/13 Thu 23 1368447 684552 &minus;6.4% <br>
11/14 Fri 32 1065603 758155 +3.6% <br>
11/15 Sat 14 1300535 738430 +0.9% <br>
11/16 Sun 31 1362696 740365 +1.2% <br>
11/17 Mon 30 1427936 773397 +5.7% <br>
11/18 Tue 11 1059191 721786 &minus;1.3% <br>
11/19 Wed 19 1108737 661867 &minus;9.5% <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
TOTAL 241 12412187 7316312 731631 (estimated 8 runs per
dumpcycle)</big></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><big><b>amanda</b>(8),
<b>amanda</b>(8), <b>amcheck</b>(8), <b>amdump</b>(8),
<b>amrestore</b>(8), <b>amfetchdump</b>(8),
<b>amanda-match</b>(7)</big></p>

<p style="margin-left:11%; margin-top: 1em"><big>The Amanda
Wiki: : http://wiki.zmanda.com/</big></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><big><b>James
da Silva</b> &lt;jds@amanda.org&gt;</big></p>

<p style="margin-left:11%; margin-top: 1em"><big><b>Stefan
G. Weichinger</b> &lt;sgw@amanda.org&gt;</big></p>
<hr>
</body>
</html>
