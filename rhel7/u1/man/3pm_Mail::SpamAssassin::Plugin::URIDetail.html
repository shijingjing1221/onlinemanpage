<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 01:04:00 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Mail::SpamAssassin::Plugin::URIDetail</title>

</head>
<body>

<h1 align="center">Mail::SpamAssassin::Plugin::URIDetail</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#RULE DEFINITIONS AND PRIVILEGED SETTINGS">RULE DEFINITIONS AND PRIVILEGED SETTINGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">URIDetail
&minus; test URIs using detailed URI information</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This plugin
creates a new rule test type, known as
&quot;uri_detail&quot;. These rules apply to all URIs found
in the message.</p>

<pre style="margin-left:11%; margin-top: 1em">  loadplugin    Mail::SpamAssassin::Plugin::URIDetail</pre>


<h2>RULE DEFINITIONS AND PRIVILEGED SETTINGS
<a name="RULE DEFINITIONS AND PRIVILEGED SETTINGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The format for
defining a rule is as follows:</p>

<pre style="margin-left:11%; margin-top: 1em">  uri_detail SYMBOLIC_TEST_NAME key1 =~ /value1/  key2 !~ /value2/ ...</pre>


<p style="margin-left:11%; margin-top: 1em">Supported keys
are:</p>


<p style="margin-left:11%; margin-top: 1em"><tt>&quot;raw&quot;</tt>
is the raw <small>URI</small> prior to any cleaning (e.g.
&quot;http://spamassassin.apache%2Eorg/&quot;).</p>


<p style="margin-left:11%; margin-top: 1em"><tt>&quot;type&quot;</tt>
is the tag(s) which referenced the raw_uri. <i>parsed</i> is
a faked type which specifies that the raw_uri was parsed
from the rendered text.</p>


<p style="margin-left:11%; margin-top: 1em"><tt>&quot;cleaned&quot;</tt>
is a list including the raw <small>URI</small> and various
cleaned versions of the raw <small>URI</small>
(http://spamassassin.apache%2Eorg/,
http://spamassassin.apache.org/).</p>


<p style="margin-left:11%; margin-top: 1em"><tt>&quot;text&quot;</tt>
is the anchor text(s) (text between &lt;a&gt; and
&lt;/a&gt;) that linked to the raw <small>URI.</small></p>


<p style="margin-left:11%; margin-top: 1em"><tt>&quot;domain&quot;</tt>
is the domain(s) found in the cleaned URIs.</p>

<p style="margin-left:11%; margin-top: 1em">Example rule
for matching a <small>URI</small> where the raw
<small>URI</small> matches &quot;%2Ebar&quot;, the domain
&quot;bar.com&quot; is found, and the type is &quot;a&quot;
(an anchor tag).</p>

<pre style="margin-left:11%; margin-top: 1em">  uri_detail TEST1 raw =~ /%2Ebar/  domain =~ /^bar\.com$/  type =~ /^a$/</pre>


<p style="margin-left:11%; margin-top: 1em">Example rule to
look for suspicious &quot;https&quot; links:</p>

<pre style="margin-left:11%; margin-top: 1em">  uri_detail FAKE_HTTPS text =~ /\bhttps:/  cleaned !~ /\bhttps:/</pre>


<p style="margin-left:11%; margin-top: 1em">Regular
expressions should be delimited by slashes.</p>
<hr>
</body>
</html>
