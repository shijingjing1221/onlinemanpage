<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 00:22:00 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>AMREPORT</title>

</head>
<body>

<h1 align="center">AMREPORT</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#TEXT REPORT FORMAT">TEXT REPORT FORMAT</a><br>
<a href="#LABEL PRINTING">LABEL PRINTING</a><br>
<a href="#TEMPLATES">TEMPLATES</a><br>
<a href="#EXIT CODE">EXIT CODE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">amreport
&minus; generate a formatted output of statistics for an
Amanda run</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>amreport</b>
[<b>&minus;o&nbsp;</b><i>configoption</i>...]
[(1)&nbsp;<i>command&minus;line options</i> |
(2)&nbsp;<i>script options</i>] [<i>config</i>]</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">



<p style="margin-top: 1em">(1)&nbsp;[&minus;&minus;log=<i>logfile</i>]
[&minus;&minus;ps=<i>filename</i>]
[&minus;&minus;text=<i>filename</i>]
[&minus;&minus;xml=<i>filename</i>]
[&minus;&minus;print=<i>printer</i>]
[&minus;&minus;mail&minus;text=<i>recipient</i>]</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p>(2)&nbsp;[&minus;i] [&minus;M&nbsp;<i>address</i>]
[&minus;l&nbsp;<i>logfile</i>]
[&minus;f&nbsp;<i>outputfile</i>]
[&minus;p&nbsp;<i>postscriptfile</i>]
[&minus;&minus;from&minus;amdump]</p> </td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Amreport</b>
generates a summary report of an Amanda backup run.</p>

<p style="margin-left:11%; margin-top: 1em">See the
<b>amanda</b>(8) man page for more details about Amanda.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>config</i></p>

<p style="margin-left:17%;">Name of the configuration to
process. If no configuration name is specified, amanda.conf
is read from the current directory.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;o</b>
<i>configoption</i></p>

<p style="margin-left:17%;">See the &quot;CONFIGURATION
OVERRIDE&quot; section in <b>amanda</b>(8).</p>

<p style="margin-left:11%; margin-top: 1em">Amreport
operates in two distinct modes. Command&minus;line mode is
intended for use by an administrator from the command line,
and uses long command&minus;line options for clarity. Script
mode is intended for use from scripts such as amdump, and
has a lot of non&minus;obvious default behaviors to suit
that need.</p>

<p style="margin-left:11%; margin-top: 1em">Unless a
script&minus;mode option is given, amreport defaults to
command&minus;line mode. If no options are given, amreport
writes a report for the most recent logfile to stdout.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Command&minus;Line
Mode Options <br>
&minus;&minus;log=</b><i>logfile</i></p>

<p style="margin-left:17%;">Use this logfile as the basis
for the report. If this option is given, then the report is
a &quot;historical&quot; report and will not include current
state from e.g., holding disk and curinfo. If this option is
not specified, then the most recent logfile will be
used.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;ps=</b><i>filename</i></p>

<p style="margin-left:17%;">Write a postscript label to
<i>filename</i>. See &quot;LABEL PRINTING&quot; below. If
filename is not specified, then the label is written to
stdout.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;text=</b><i>filename</i></p>

<p style="margin-left:17%;">Write a human&minus;readable
text report to <i>filename</i>. If filename is not
specified, then the report is written to stdout.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;xml=</b><i>filename</i></p>

<p style="margin-left:17%;">Write an XML&minus;formatted
report to <i>filename</i>. If filename is not specified,
then the report is written to stdout.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;print=</b><i>printer</i></p>

<p style="margin-left:17%;">Pipe a postscript label to
<b>lp</b> or <b>lpr</b>, specifying the given
<i>printer</i>. If the printer is not specified, uses the
default from the Amanda configuration, or the system default
printer.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;mail&minus;text=</b><i>recipient</i></p>

<p style="margin-left:17%;">Send a human&minus;readable
text report to the given <i>recipient</i> via the mailer
specified in the Amanda configuration. If the recipient is
not specified, this uses the <i>mailto</i> from the Amanda
configuration.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Script Mode
Options <br>
&minus;i</b></p>

<p style="margin-left:17%;">Don't email the report.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;M</b>
<i>address</i></p>

<p style="margin-left:17%;">Mail the report to
<i>address</i> instead of the <b>mailto</b> value from
<i>amanda.conf</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;l</b>
<i>logfile</i></p>

<p style="margin-left:17%;">Name of the log file to parse
to generate the report. If a log file is not specified, it
defaults to the file $logdir/log, where $logdir is the log
directory defined in amanda.conf.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;f</b>
<i>outputfile</i></p>

<p style="margin-left:17%;">Normally, <b>amreport</b> sends
the report via e&minus;mail to the <i>mailto</i> user as
defined in the amanda.conf file. If <i>outputfile</i> is
specified, then the report is put in <i>outputfile</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;p</b>
<i>postscriptfile</i></p>

<p style="margin-left:17%;">Send the postscript output to
the file <i>postscriptfile</i> instead of to the
<b>lpr</b>(1) command. This option has an effect only if the
<i>lbl&minus;templ</i> directive is specified in
amanda.conf.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;from&minus;amdump</b></p>

<p style="margin-left:17%;">Force script mode. Has no other
effect.</p>

<h2>TEXT REPORT FORMAT
<a name="TEXT REPORT FORMAT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Amanda's text
report format is divided into several sections. Some of
these sections only appear if they are not empty.</p>

<p style="margin-left:11%; margin-top: 1em">Although newer
versions of Amanda try to use the term &quot;volume&quot; to
refer to a unit of storage, amreport still uses the term
&quot;tape&quot;, even if backups are done to non&minus;tape
devices, to allow scripts which parse amreport's output to
continue to function.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Summary</b>
<br>
Hostname: bkserver <br>
Org : DailySet1 <br>
Config : Daily <br>
Date : February 25, 2009</p>

<p style="margin-left:11%; margin-top: 1em">These dumps
were to tape Daily&minus;103. <br>
The next tape Amanda expects to use is: Daily&minus;142</p>

<p style="margin-left:11%; margin-top: 1em">FAILURE DUMP
SUMMARY: <br>
jamon.slikon.local /var lev 0 FAILED [/bin/tar exited with
status 2]</p>

<p style="margin-left:11%; margin-top: 1em">The summary
section describes the run in broad terms, giving the server
hostname, organization (from the <b>org</b> configuration
parameter), configuration name, and dump date. This is
followed by a description of the volumes and holding disk
used, and an rough estimate of the volume(s) Amanda will use
on the next run.</p>

<p style="margin-left:11%; margin-top: 1em">Brief notices
of any unusual circumstances will also be included here.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Statistics</b>
<br>
STATISTICS: <br>
Total Full Incr. <br>
&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
Estimate Time (hrs:min) 0:00 <br>
Run Time (hrs:min) 0:01 <br>
Dump Time (hrs:min) 0:00 0:00 0:00 <br>
Output Size (meg) 1.6 0.0 1.6 <br>
Original Size (meg) 1.6 0.0 1.6 <br>
Avg Compressed Size (%) 100.0 100.0 100.0 (level:#disks ...)
<br>
Filesystems Dumped 4 1 3 (1:3) <br>
Avg Dump Rate (k/s) 1555.1 134.2 1787.3</p>

<p style="margin-left:11%; margin-top: 1em">Tape Time
(hrs:min) 0:00 0:00 0:00 <br>
Tape Size (meg) 1.6 0.0 1.6 <br>
Tape Used (%) 5.5 0.1 5.4 (level:#disks ...) <br>
Filesystems Taped 4 1 3 (1:3) <br>
(level:#parts ...) <br>
Parts Taped 4 1 3 (1:3) <br>
Avg Tp Write Rate (k/s) 143966 27624.3 151811</p>

<p style="margin-left:11%; margin-top: 1em">USAGE BY TAPE:
<br>
Label Time Size % DLEs Parts <br>
metals&minus;013 0:00 1650k 5.4 4 4</p>

<p style="margin-left:11%; margin-top: 1em">This section
contains aggregate statistics for the entire run. The three
columns break down the results into a total for all data
handled, only full dumps, and only incremental dumps. In the
right margin, amreport indicates the breakdown of dump
levels at the dumper and the taper.</p>

<p style="margin-left:11%; margin-top: 1em">The rows have
the following meanings:</p>

<p style="margin-left:11%; margin-top: 1em">Estimate
Time</p>

<p style="margin-left:17%;">The time used by the planner to
estimate dump sizes.</p>

<p style="margin-left:11%; margin-top: 1em">Run Time</p>

<p style="margin-left:17%;">Total runtime, from the
invocation of amdump to its completion.</p>

<p style="margin-left:11%; margin-top: 1em">Dump Time</p>

<p style="margin-left:17%;">Total time spent dumping
clients.</p>

<p style="margin-left:11%; margin-top: 1em">Output Size</p>

<p style="margin-left:17%;">Total quantity of data dumped,
after compression.</p>

<p style="margin-left:11%; margin-top: 1em">Original
Size</p>

<p style="margin-left:17%;">Total quantity of data dumped,
before compression.</p>

<p style="margin-left:11%; margin-top: 1em">Avg Compressed
Size</p>

<p style="margin-left:17%;">Compression ratio, calculated
from the previous two rows.</p>

<p style="margin-left:11%; margin-top: 1em">Filesystems
Dumped</p>

<p style="margin-left:17%;">Number of DLEs dumped.</p>

<p style="margin-left:11%; margin-top: 1em">Avg Dump
Rate</p>

<p style="margin-left:17%;">Average speed at which clients
produced data. Note that, for dumps done directly to a slow
device, rather than to holding disk, this rate may reflect a
write speed constrained by the device speed.</p>

<p style="margin-left:11%; margin-top: 1em">Tape Time</p>

<p style="margin-left:17%;">Total time spent writing to
storage volumes. This includes time spent changing tapes,
including time spent waiting for flush thresholds to be
met.</p>

<p style="margin-left:11%; margin-top: 1em">Tape Size</p>

<p style="margin-left:17%;">Total quantity of data written
to storage volumes.</p>

<p style="margin-left:11%; margin-top: 1em">Tape Used</p>

<p style="margin-left:17%;">Fraction of the total allocated
storage (tapetype length times runtapes) actually used.</p>

<p style="margin-left:11%; margin-top: 1em">Filesystems
Taped</p>

<p style="margin-left:17%;">Number of filesystems written
to storage. This may be larger or smaller than the number of
filesystems dumped, due to flushes or dumps left on holding
disk.</p>

<p style="margin-left:11%; margin-top: 1em">Parts Taped</p>

<p style="margin-left:17%;">Number of split parts writtten
to storage. If this number is very large, then the split
size may be too small.</p>

<p style="margin-left:11%; margin-top: 1em">Avg Tp Write
Rate</p>

<p style="margin-left:17%;">Taper speed, based on the tape
time and tape size, above. Note that, because the tape time
includes time spent on tasks other than writing to tape,
this does not necessary reflect the device's real write
speed. However, the value is useful for capacity planning,
as it reflects a realistic estimate of how quickly Amanda
can write data to storage.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Usage by
Tape</b> <br>
USAGE BY TAPE: <br>
Label Time Size % DLEs Parts <br>
Conf&minus;001 0:00 20320k 66.2 1 4 <br>
Conf&minus;002 0:00 6470k 21.1 0 2</p>

<p style="margin-left:11%; margin-top: 1em">This short
section gives per&minus;volume statistics: time spent
writing to the volume; bytes written to the volume; portion
of the expected tape length used; number of DLEs started,
and total number of split parts written.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Notes</b>
<br>
NOTES: <br>
taper: tape DAILY&minus;37 kb 30720 fm 3 [OK]</p>

<p style="margin-left:11%; margin-top: 1em">This section
contains any informational log messages from the run. Most
messages are self&minus;explanatory. The taper message shown
in the example is always present, and is redundant to the
previous section. It indicates that 30720 kb were written to
&quot;DAILY&minus;37&quot; in 3 files.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Failure and
Strange Details</b> <br>
FAILED DUMP DETAILS:</p>


<p style="margin-left:11%; margin-top: 1em">/&minus;&minus;
jamon.slikon.local /var lev 0 FAILED [/bin/tar exited with
status 2] <br>
sendbackup: info BACKUP=APPLICATION <br>
sendbackup: info APPLICATION=amgtar <br>
sendbackup: info RECOVER_CMD=/usr/bin/gzip &minus;dc |amgtar
&minus;f... &minus; <br>
sendbackup: info COMPRESS_SUFFIX=.gz <br>
sendbackup: info end <br>
? /bin/tar: ./gdm: Cannot savedir: Permission denied <br>
| Total bytes written: 943831040 (901MiB, 4.9MiB/s) <br>
| /bin/tar: Error exit delayed from previous errors <br>
sendbackup: error [/bin/tar exited with status 2] <br>
sendbackup: size 921710 <br>
sendbackup: end <br>

\\&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;</p>

<p style="margin-left:11%; margin-top: 1em">STRANGE DUMP
DETAILS:</p>


<p style="margin-left:11%; margin-top: 1em">/&minus;&minus;
bsdfw.slikon.local / lev 0 STRANGE <br>
sendbackup: info BACKUP=APPLICATION <br>
sendbackup: info APPLICATION=amgtar <br>
sendbackup: info RECOVER_CMD=/usr/bin/gzip &minus;dc |amgtar
&minus;f... &minus; <br>
sendbackup: info COMPRESS_SUFFIX=.gz <br>
sendbackup: info end <br>
| /bin/tar: ./tmp/.X11&minus;unix/X0: socket ignored <br>
| Total bytes written: 5530869760 (5.2GiB, 3.0MiB/s) <br>
sendbackup: size 5401240 <br>
sendbackup: end <br>

\\&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;</p>

<p style="margin-left:11%; margin-top: 1em">This section
expands on failures and strange results indicated in earlier
sections. In both cases, the details contain a messages
produced by the underlying backup tool &minus; GNU tar, in
this example. Failed dumps have actually failed, and the
reasons are usually clear. Strange dumps, however, are
regarded as successful by Amanda, but contain messages that
Amanda did not recognize and which may be of interest to the
operator.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Dump
Summary</b> <br>
DUMP SUMMARY: <br>
DUMPER STATS TAPER STATS <br>
HOSTNAME DISK L ORIG&minus;kB OUT&minus;kB COMP% MMM:SS KB/s
MMM:SS KB/s <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
strontium /etc 1 270 270 &minus;&minus; 0:00 1146.3 0:00
140918.6 <br>
strontium &minus;me/elantra 1 10 10 &minus;&minus; 0:00 65.6
0:00 9033.4 <br>
strontium /local 0 20 20 &minus;&minus; 0:00 133.9 0:00
27624.3 <br>
strontium &minus;ository_13 1 1350 1350 &minus;&minus; 0:01
2568.5 0:00 175006.5</p>

<p style="margin-left:11%; margin-top: 1em">The dump
summary table has one row for each DLE processed during the
run. The &quot;L&quot; column gives the level of the dump.
The remaining colums are divided into dumper stats and taper
stats.</p>

<p style="margin-left:11%; margin-top: 1em">The dumper
stats give the original (before compression) and output
(after compression) size of each dump, as well as a
compression ratio, if applicable. The column labeled
&quot;MMM:SS&quot; gives the time spent on that dump, and
the next column is the calculated dump rate.</p>

<p style="margin-left:11%; margin-top: 1em">The taper stats
give the time and speed with which the dump was written to
storage. This value is the sum of the times for each part,
and as such does not include time spent switching
volumes.</p>

<h2>LABEL PRINTING
<a name="LABEL PRINTING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Amanda can
print postscript labels describing the contents of tape(s)
written in a run. The labels are designed to be folded and
inserted into the tape case along with the tape or hole
punched and put in a 3&minus;ring binder. Various label
templates are provided to format data for different tape
sizes.</p>

<p style="margin-left:11%; margin-top: 1em">The information
printed varies slightly between label templates due to size
constraints. Labels contain one line for each
host/file&minus;system pair and may also contain the file
number on the tape, the level of the dump, the original size
of the dump and the size of the (possibly compressed) tape
file.</p>

<p style="margin-left:11%; margin-top: 1em">Add the
<i>lbl&minus;templ</i> parameter to the tapetype definition
in amanda.conf to enable labels. If you don't add this line
to your tapetype definition, <b>amreport</b> will not print
tape labels.</p>

<p style="margin-left:11%; margin-top: 1em">You may use the
<i>printer</i> keyword in amanda.conf to print to other than
the system default printer.</p>

<h2>TEMPLATES
<a name="TEMPLATES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Amanda provides
label templates for the following tape types. These are
pretty generic labels and should be easy to customize for
other tape types or particular site needs.</p>

<p style="margin-left:17%; margin-top: 1em">* ExaByte 8mm
tapes <br>
* DAT 4mm tapes <br>
* DLT tapes <br>
* 3&minus;ring binder</p>

<p style="margin-left:11%; margin-top: 1em">The
3&minus;ring binder type is the most generic. It may be used
to make a hardcopy log of the tapes.</p>

<h2>EXIT CODE
<a name="EXIT CODE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The exit code
of <b>amreport</b> is the ORed value of: <br>
0 = success <br>
1 = error <br>
2 = a dle give strange message <br>
4 = a dle failed <br>
8 = Don't know the status of a dle (RESULT_MISSING in the
report) <br>
16 = tape error or no more tape</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>amanda</b>(8),
<b>amflush</b>(8)</p>

<p style="margin-left:11%; margin-top: 1em">The Amanda
Wiki: : http://wiki.zmanda.com/</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Stefan G.
Weichinger</b> &lt;sgw@amanda.org&gt;</p>
<hr>
</body>
</html>
