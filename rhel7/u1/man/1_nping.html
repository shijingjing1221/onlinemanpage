<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov 12 01:08:46 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>NPING</title>

</head>
<body>

<h1 align="center">NPING</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS SUMMARY">OPTIONS SUMMARY</a><br>
<a href="#TARGET SPECIFICATION">TARGET SPECIFICATION</a><br>
<a href="#OPTION SPECIFICATION">OPTION SPECIFICATION</a><br>
<a href="#GENERAL OPERATION">GENERAL OPERATION</a><br>
<a href="#PROBE MODES">PROBE MODES</a><br>
<a href="#TCP CONNECT MODE">TCP CONNECT MODE</a><br>
<a href="#TCP MODE">TCP MODE</a><br>
<a href="#UDP MODE">UDP MODE</a><br>
<a href="#ICMP MODE">ICMP MODE</a><br>
<a href="#ARP MODE">ARP MODE</a><br>
<a href="#IPV4 OPTIONS">IPV4 OPTIONS</a><br>
<a href="#IPV6 OPTIONS">IPV6 OPTIONS</a><br>
<a href="#ETHERNET OPTIONS">ETHERNET OPTIONS</a><br>
<a href="#PAYLOAD OPTIONS">PAYLOAD OPTIONS</a><br>
<a href="#ECHO MODE">ECHO MODE</a><br>
<a href="#TIMING AND PERFORMANCE OPTIONS">TIMING AND PERFORMANCE OPTIONS</a><br>
<a href="#MISCELLANEOUS OPTIONS">MISCELLANEOUS OPTIONS</a><br>
<a href="#OUTPUT OPTIONS">OUTPUT OPTIONS</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nping &minus;
Network packet generation tool / ping utility</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="38%">


<p style="margin-top: 1em"><b>nping</b> [<i>Options</i>]
{<i>targets</i>}</p> </td>
<td width="51%">
</td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Nping is an
open&minus;source tool for network packet generation,
response analysis and response time measurement. Nping
allows users to generate network packets of a wide range of
protocols, letting them tune virtually any field of the
protocol headers. While Nping can be used as a simple ping
utility to detect active hosts, it can also be used as a raw
packet generator for network stack stress tests, ARP
poisoning, Denial of Service attacks, route tracing, and
other purposes.</p>

<p style="margin-left:11%; margin-top: 1em">Additionally,
Nping offers a special mode of operation called the
&quot;Echo Mode&quot;, that lets users see how the generated
probes change in transit, revealing the differences between
the transmitted packets and the packets received at the
other end. See section &quot;Echo Mode&quot; for
details.</p>

<p style="margin-left:11%; margin-top: 1em">The output from
Nping is a list of the packets that are being sent and
received. The level of detail depends on the options
used.</p>

<p style="margin-left:11%; margin-top: 1em">A typical Nping
execution is shown in Example&nbsp;1. The only Nping
arguments used in this example are <b>&minus;c</b>, to
specify the number of times to target each host,
<b>&minus;&minus;tcp</b> to specify TCP Probe Mode,
<b>&minus;p 80,433</b> to specify the target ports; and then
the two target hostnames.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Example&nbsp;1.&nbsp;A
representative Nping execution</b></p>

<p style="margin-left:17%; margin-top: 1em"># <b>nping
&minus;c 1 &minus;&minus;tcp &minus;p 80,433 scanme.nmap.org
google.com</b></p>

<p style="margin-left:17%; margin-top: 1em">Starting Nping
( http://nmap.org/nping ) <br>
SENT (0.0120s) TCP 96.16.226.135:50091 &gt; 64.13.134.52:80
S ttl=64 id=52072 iplen=40 seq=1077657388 win=1480 <br>
RCVD (0.1810s) TCP 64.13.134.52:80 &gt; 96.16.226.135:50091
SA ttl=53 id=0 iplen=44 seq=4158134847 win=5840 &lt;mss
1460&gt; <br>
SENT (1.0140s) TCP 96.16.226.135:50091 &gt; 74.125.45.100:80
S ttl=64 id=13932 iplen=40 seq=1077657388 win=1480 <br>
RCVD (1.1370s) TCP 74.125.45.100:80 &gt; 96.16.226.135:50091
SA ttl=52 id=52913 iplen=44 seq=2650443864 win=5720 &lt;mss
1430&gt; <br>
SENT (2.0140s) TCP 96.16.226.135:50091 &gt; 64.13.134.52:433
S ttl=64 id=8373 iplen=40 seq=1077657388 win=1480 <br>
SENT (3.0140s) TCP 96.16.226.135:50091 &gt;
74.125.45.100:433 S ttl=64 id=23624 iplen=40 seq=1077657388
win=1480</p>

<p style="margin-left:17%; margin-top: 1em">Statistics for
host scanme.nmap.org (64.13.134.52): <br>
| Probes Sent: 2 | Rcvd: 1 | Lost: 1 (50.00%) <br>
|_ Max rtt: 169.720ms | Min rtt: 169.720ms | Avg rtt:
169.720ms <br>
Statistics for host google.com (74.125.45.100): <br>
| Probes Sent: 2 | Rcvd: 1 | Lost: 1 (50.00%) <br>
|_ Max rtt: 122.686ms | Min rtt: 122.686ms | Avg rtt:
122.686ms <br>
Raw packets sent: 4 (160B) | Rcvd: 2 (92B) | Lost: 2
(50.00%) <br>
Tx time: 3.00296s | Tx bytes/s: 53.28 | Tx pkts/s: 1.33 <br>
Rx time: 3.00296s | Rx bytes/s: 30.64 | Rx pkts/s: 0.67 <br>
Nping done: 2 IP addresses pinged in 4.01 seconds</p>

<h2>OPTIONS SUMMARY
<a name="OPTIONS SUMMARY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This options
summary is printed when Nping is run with no arguments. It
helps people remember the most common options, but is no
substitute for the in&minus;depth documentation in the rest
of this manual. Some obscure options aren't even included
here.</p>

<p style="margin-left:17%; margin-top: 1em">Nping
0.5.59BETA1 ( http://nmap.org/nping ) <br>
Usage: nping [Probe mode] [Options] {target
specification}</p>

<p style="margin-left:17%; margin-top: 1em">TARGET
SPECIFICATION: <br>
Targets may be specified as hostnames, IP addresses,
networks, etc. <br>
Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1;
10.0.0&minus;255.1&minus;254 <br>
PROBE MODES: <br>
&minus;&minus;tcp&minus;connect : Unprivileged TCP connect
probe mode. <br>
&minus;&minus;tcp : TCP probe mode. <br>
&minus;&minus;udp : UDP probe mode. <br>
&minus;&minus;icmp : ICMP probe mode. <br>
&minus;&minus;arp : ARP/RARP probe mode. <br>
&minus;&minus;tr, &minus;&minus;traceroute : Traceroute mode
(can only be used with <br>
TCP/UDP/ICMP modes). <br>
TCP CONNECT MODE: <br>
&minus;p, &minus;&minus;dest&minus;port &lt;port spec&gt; :
Set destination port(s). <br>
&minus;g, &minus;&minus;source&minus;port &lt;portnumber&gt;
: Try to use a custom source port. <br>
TCP PROBE MODE: <br>
&minus;g, &minus;&minus;source&minus;port &lt;portnumber&gt;
: Set source port. <br>
&minus;p, &minus;&minus;dest&minus;port &lt;port spec&gt; :
Set destination port(s). <br>
&minus;&minus;seq &lt;seqnumber&gt; : Set sequence number.
<br>
&minus;&minus;flags &lt;flag list&gt; : Set TCP flags
(ACK,PSH,RST,SYN,FIN...) <br>
&minus;&minus;ack &lt;acknumber&gt; : Set ACK number. <br>
&minus;&minus;win &lt;size&gt; : Set window size. <br>
&minus;&minus;badsum : Use a random invalid checksum. <br>
UDP PROBE MODE: <br>
&minus;g, &minus;&minus;source&minus;port &lt;portnumber&gt;
: Set source port. <br>
&minus;p, &minus;&minus;dest&minus;port &lt;port spec&gt; :
Set destination port(s). <br>
&minus;&minus;badsum : Use a random invalid checksum. <br>
ICMP PROBE MODE: <br>
&minus;&minus;icmp&minus;type &lt;type&gt; : ICMP type. <br>
&minus;&minus;icmp&minus;code &lt;code&gt; : ICMP code. <br>
&minus;&minus;icmp&minus;id &lt;id&gt; : Set identifier.
<br>
&minus;&minus;icmp&minus;seq &lt;n&gt; : Set sequence
number. <br>
&minus;&minus;icmp&minus;redirect&minus;addr &lt;addr&gt; :
Set redirect address. <br>
&minus;&minus;icmp&minus;param&minus;pointer &lt;pnt&gt; :
Set parameter problem pointer. <br>
&minus;&minus;icmp&minus;advert&minus;lifetime &lt;time&gt;
: Set router advertisement lifetime. <br>
&minus;&minus;icmp&minus;advert&minus;entry &lt;IP,pref&gt;
: Add router advertisement entry. <br>
&minus;&minus;icmp&minus;orig&minus;time &lt;timestamp&gt; :
Set originate timestamp. <br>
&minus;&minus;icmp&minus;recv&minus;time &lt;timestamp&gt; :
Set receive timestamp. <br>
&minus;&minus;icmp&minus;trans&minus;time &lt;timestamp&gt;
: Set transmit timestamp. <br>
ARP/RARP PROBE MODE: <br>
&minus;&minus;arp&minus;type &lt;type&gt; : Type: ARP,
ARP&minus;reply, RARP, RARP&minus;reply. <br>
&minus;&minus;arp&minus;sender&minus;mac &lt;mac&gt; : Set
sender MAC address. <br>
&minus;&minus;arp&minus;sender&minus;ip &lt;addr&gt; : Set
sender IP address. <br>
&minus;&minus;arp&minus;target&minus;mac &lt;mac&gt; : Set
target MAC address. <br>
&minus;&minus;arp&minus;target&minus;ip &lt;addr&gt; : Set
target IP address. <br>
IPv4 OPTIONS: <br>
&minus;S, &minus;&minus;source&minus;ip : Set source IP
address. <br>
&minus;&minus;dest&minus;ip &lt;addr&gt; : Set destination
IP address (used as an <br>
alternative to {target specification} ). <br>
&minus;&minus;tos &lt;tos&gt; : Set type of service field
(8bits). <br>
&minus;&minus;id &lt;id&gt; : Set identification field (16
bits). <br>
&minus;&minus;df : Set Don't Fragment flag. <br>
&minus;&minus;mf : Set More Fragments flag. <br>
&minus;&minus;ttl &lt;hops&gt; : Set time to live
[0&minus;255]. <br>
&minus;&minus;badsum&minus;ip : Use a random invalid
checksum. <br>
&minus;&minus;ip&minus;options &lt;S|R [route]|L [route]|T|U
...&gt; : Set IP options <br>
&minus;&minus;ip&minus;options &lt;hex string&gt; : Set IP
options <br>
&minus;&minus;mtu &lt;size&gt; : Set MTU. Packets get
fragmented if MTU is <br>
small enough. <br>
IPv6 OPTIONS: <br>
&minus;6, &minus;&minus;IPv6 : Use IP version 6. <br>
&minus;&minus;dest&minus;ip : Set destination IP address
(used as an <br>
alternative to {target specification}). <br>
&minus;&minus;hop&minus;limit : Set hop limit (same as IPv4
TTL). <br>
&minus;&minus;traffic&minus;class &lt;class&gt; : : Set
traffic class. <br>
&minus;&minus;flow &lt;label&gt; : Set flow label. <br>
ETHERNET OPTIONS: <br>
&minus;&minus;dest&minus;mac &lt;mac&gt; : Set destination
mac address. (Disables <br>
ARP resolution) <br>
&minus;&minus;source&minus;mac &lt;mac&gt; : Set source MAC
address. <br>
&minus;&minus;ether&minus;type &lt;type&gt; : Set EtherType
value. <br>
PAYLOAD OPTIONS: <br>
&minus;&minus;data &lt;hex string&gt; : Include a custom
payload. <br>
&minus;&minus;data&minus;string &lt;text&gt; : Include a
custom ASCII text. <br>
&minus;&minus;data&minus;length &lt;len&gt; : Include len
random bytes as payload. <br>
ECHO CLIENT/SERVER: <br>
&minus;&minus;echo&minus;client &lt;passphrase&gt; : Run
Nping in client mode. <br>
&minus;&minus;echo&minus;server &lt;passphrase&gt; : Run
Nping in server mode. <br>
&minus;&minus;echo&minus;port &lt;port&gt; : Use custom
&lt;port&gt; to listen or connect. <br>
&minus;&minus;no&minus;crypto : Disable encryption and
authentication. <br>
&minus;&minus;once : Stop the server after one connection.
<br>
&minus;&minus;safe&minus;payloads : Erase application data
in echoed packets. <br>
TIMING AND PERFORMANCE: <br>
Options which take &lt;time&gt; are in seconds, or append
'ms' (milliseconds), <br>
's' (seconds), 'm' (minutes), or 'h' (hours) to the value
(e.g. 30m, 0.25h). <br>
&minus;&minus;delay &lt;time&gt; : Adjust delay between
probes. <br>
&minus;&minus;rate &lt;rate&gt; : Send num packets per
second. <br>
MISC: <br>
&minus;h, &minus;&minus;help : Display help information.
<br>
&minus;V, &minus;&minus;version : Display current version
number. <br>
&minus;c, &minus;&minus;count &lt;n&gt; : Stop after
&lt;n&gt; rounds. <br>
&minus;e, &minus;&minus;interface &lt;name&gt; : Use
supplied network interface. <br>
&minus;H, &minus;&minus;hide&minus;sent : Do not display
sent packets. <br>
&minus;N, &minus;&minus;no&minus;capture : Do not try to
capture replies. <br>
&minus;&minus;privileged : Assume user is fully privileged.
<br>
&minus;&minus;unprivileged : Assume user lacks raw socket
privileges. <br>
&minus;&minus;send&minus;eth : Send packets at the raw
ethernet layer. <br>
&minus;&minus;send&minus;ip : Send packets using raw IP
sockets. <br>
&minus;&minus;bpf&minus;filter &lt;filter spec&gt; : Specify
custom BPF filter. <br>
OUTPUT: <br>
&minus;v : Increment verbosity level by one. <br>
&minus;v[level] : Set verbosity level. E.g: &minus;v4 <br>
&minus;d : Increment debugging level by one. <br>
&minus;d[level] : Set debugging level. E.g: &minus;d3 <br>
&minus;q : Decrease verbosity level by one. <br>
&minus;q[N] : Decrease verbosity level N times <br>
&minus;&minus;quiet : Set verbosity and debug level to
minimum. <br>
&minus;&minus;debug : Set verbosity and debug to the max
level. <br>
EXAMPLES: <br>
nping scanme.nmap.org <br>
nping &minus;&minus;tcp &minus;p 80 &minus;&minus;flags rst
&minus;&minus;ttl 2 192.168.1.1 <br>
nping &minus;&minus;icmp &minus;&minus;icmp&minus;type time
&minus;&minus;delay 500ms 192.168.254.254 <br>
nping &minus;&minus;echo&minus;server &quot;public&quot;
&minus;e wlan0 &minus;vvv <br>
nping &minus;&minus;echo&minus;client &quot;public&quot;
echo.nmap.org &minus;&minus;tcp &minus;p1&minus;1024
&minus;&minus;flags ack</p>

<p style="margin-left:17%; margin-top: 1em">SEE THE MAN
PAGE FOR MANY MORE OPTIONS, DESCRIPTIONS, AND EXAMPLES</p>

<h2>TARGET SPECIFICATION
<a name="TARGET SPECIFICATION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Everything on
the Nping command line that isn't an option or an option
argument is treated as a target host specification. Nping
uses the same syntax for target specifications that Nmap
does. The simplest case is a single target given by IP
address or hostname.</p>

<p style="margin-left:11%; margin-top: 1em">Nping supports
CIDR&minus;style. addressing. You can append /<i>numbits</i>
to an IPv4 address or hostname and Nping will send probes to
every IP address for which the first <i>numbits</i> are the
same as for the reference IP or hostname given. For example,
192.168.10.0/24 would send probes to the 256 hosts between
192.168.10.0 (binary: 11000000 10101000 00001010 00000000)
and 192.168.10.255 (binary: 11000000 10101000 00001010
11111111), inclusive. 192.168.10.40/24 would ping exactly
the same targets. Given that the host scanme.nmap.org. is at
the IP address 64.13.134.52, the specification
scanme.nmap.org/16 would send probes to the 65,536 IP
addresses between 64.13.0.0 and 64.13.255.255. The smallest
allowed value is /0, which targets the whole Internet. The
largest value is /32, which targets just the named host or
IP address because all address bits are fixed.</p>

<p style="margin-left:11%; margin-top: 1em">CIDR notation
is short but not always flexible enough. For example, you
might want to send probes to 192.168.0.0/16 but skip any IPs
ending with .0 or .255 because they may be used as subnet
network and broadcast addresses. Nping supports this through
octet range addressing. Rather than specify a normal IP
address, you can specify a comma&minus;separated list of
numbers or ranges for each octet. For example,
192.168.0&minus;255.1&minus;254 will skip all addresses in
the range that end in .0 or .255, and 192.168.3&minus;5,7.1
will target the four addresses 192.168.3.1, 192.168.4.1,
192.168.5.1, and 192.168.7.1. Either side of a range may be
omitted; the default values are 0 on the left and 255 on the
right. Using &minus; by itself is the same as 0&minus;255,
but remember to use 0&minus; in the first octet so the
target specification doesn't look like a command&minus;line
option. Ranges need not be limited to the final octets: the
specifier 0&minus;.&minus;.13.37 will send probes to all IP
addresses on the Internet ending in .13.37. This sort of
broad sampling can be useful for Internet surveys and
research.</p>

<p style="margin-left:11%; margin-top: 1em">IPv6 addresses
can only be specified by their fully qualified IPv6 address
or hostname. CIDR and octet ranges aren't supported for IPv6
because they are rarely useful.</p>

<p style="margin-left:11%; margin-top: 1em">Nping accepts
multiple host specifications on the command line, and they
don't need to be the same type. The command <b>nping
scanme.nmap.org 192.168.0.0/8 10.0.0,1,3&minus;7.&minus;</b>
does what you would expect.</p>

<h2>OPTION SPECIFICATION
<a name="OPTION SPECIFICATION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Nping is
designed to be very flexible and fit a wide variety of
needs. As with most command&minus;line tools, its behavior
can be adjusted using command&minus;line options. These
general principles apply to option arguments, unless stated
otherwise.</p>

<p style="margin-left:11%; margin-top: 1em">Options that
take integer numbers can accept values specified in decimal,
octal or hexadecimal base. When a number starts with 0x, it
will be treated as hexadecimal; when it simply starts with
0, it will be treated as octal. Otherwise, Nping will assume
the number has been specified in base 10. Virtually all
numbers that can be supplied from the command line are
unsigned so, as a general rule, the minimum value is zero.
Users may also specify the word random or rand to make Nping
generate a random value within the expected range.</p>

<p style="margin-left:11%; margin-top: 1em">IP addresses
may be given as IPv4 addresses (e.g. 192.168.1.1), IPv6
addresses (e.g. 2001:db8:85a3::8e4c:760:7146), or hostnames,
which will be resolved using the default DNS server
configured in the host system.</p>

<p style="margin-left:11%; margin-top: 1em">Options that
take MAC addresses accept the usual colon&minus;separated 6
hex byte format (e.g. 00:50:56:d4:01:98). Hyphens may also
be used instead of colons (e.g.
00&minus;50&minus;56&minus;c0&minus;00&minus;08). The
special word random or rand sets a random address and the
word broadcast or bcast sets ff:ff:ff:ff:ff:ff.</p>

<h2>GENERAL OPERATION
<a name="GENERAL OPERATION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Unlike other
ping and packet generation tools, Nping supports multiple
target host and port specifications. While this provides
great flexibility, it is not obvious how Nping handles
situations where there is more than one host and/or more
than one port to send probes to. This section explains how
Nping behaves in these cases.</p>

<p style="margin-left:11%; margin-top: 1em">When multiple
target hosts are specified, Nping rotates among them in
round&minus;robin fashion. This gives slow hosts more time
to send their responses before another probe is sent to
them. Ports are also scheduled using round robin. So, unless
only one port is specified, Nping never sends two probes to
the same target host and port consecutively.</p>

<p style="margin-left:11%; margin-top: 1em">The loop around
targets is the &ldquo;inner loop&rdquo; and the loop around
ports is the &ldquo;outer loop&rdquo;. All targets will be
sent a probe for a given port before moving on to the next
port. Between probes, Nping waits a configurable amount of
time called the &ldquo;inter&minus;probe delay&rdquo;, which
is controlled by the <b>&minus;&minus;delay</b> option.
These examples show how it works.</p>

<p style="margin-left:23%; margin-top: 1em"># <b>nping
&minus;&minus;tcp &minus;c 2 1.1.1.1 &minus;p
100&minus;102</b></p>

<p style="margin-left:23%; margin-top: 1em">Starting Nping
( http://nmap.org/nping ) <br>
SENT (0.0210s) TCP 192.168.1.77 &gt; 1.1.1.1:100 <br>
SENT (1.0230s) TCP 192.168.1.77 &gt; 1.1.1.1:101 <br>
SENT (2.0250s) TCP 192.168.1.77 &gt; 1.1.1.1:102 <br>
SENT (3.0280s) TCP 192.168.1.77 &gt; 1.1.1.1:100 <br>
SENT (4.0300s) TCP 192.168.1.77 &gt; 1.1.1.1:101 <br>
SENT (5.0320s) TCP 192.168.1.77 &gt; 1.1.1.1:102</p>

<p style="margin-left:23%; margin-top: 1em"># <b>nping
&minus;&minus;tcp &minus;c 2 1.1.1.1 2.2.2.2 3.3.3.3
&minus;p 8080</b></p>

<p style="margin-left:23%; margin-top: 1em">Starting Nping
( http://nmap.org/nping ) <br>
SENT (0.0230s) TCP 192.168.0.21 &gt; 1.1.1.1:8080 <br>
SENT (1.0240s) TCP 192.168.0.21 &gt; 2.2.2.2:8080 <br>
SENT (2.0260s) TCP 192.168.0.21 &gt; 3.3.3.3:8080 <br>
SENT (3.0270s) TCP 192.168.0.21 &gt; 1.1.1.1:8080 <br>
SENT (4.0290s) TCP 192.168.0.21 &gt; 2.2.2.2:8080 <br>
SENT (5.0310s) TCP 192.168.0.21 &gt; 3.3.3.3:8080</p>

<p style="margin-left:23%; margin-top: 1em"># <b>nping
&minus;&minus;tcp &minus;c 1 &minus;&minus;delay 500ms
1.1.1.1 2.2.2.2 3.3.3.3 &minus;p 137&minus;139</b></p>

<p style="margin-left:23%; margin-top: 1em">Starting Nping
( http://nmap.org/nping ) <br>
SENT (0.0230s) TCP 192.168.0.21 &gt; 1.1.1.1:137 <br>
SENT (0.5250s) TCP 192.168.0.21 &gt; 2.2.2.2:137 <br>
SENT (1.0250s) TCP 192.168.0.21 &gt; 3.3.3.3:137 <br>
SENT (1.5280s) TCP 192.168.0.21 &gt; 1.1.1.1:138 <br>
SENT (2.0280s) TCP 192.168.0.21 &gt; 2.2.2.2:138 <br>
SENT (2.5310s) TCP 192.168.0.21 &gt; 3.3.3.3:138 <br>
SENT (3.0300s) TCP 192.168.0.21 &gt; 1.1.1.1:139 <br>
SENT (3.5330s) TCP 192.168.0.21 &gt; 2.2.2.2:139 <br>
SENT (4.0330s) TCP 192.168.0.21 &gt; 3.3.3.3:139</p>

<h2>PROBE MODES
<a name="PROBE MODES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Nping supports
a wide variety of protocols. Although in some cases Nping
can automatically determine the mode from the options used,
it is generally a good idea to specify it explicitly.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;tcp&minus;connect</b>
(TCP Connect mode) .</p>

<p style="margin-left:17%;">TCP connect mode is the default
mode when a user does not have raw packet privileges.
Instead of writing raw packets as most other modes do, Nping
asks the underlying operating system to establish a
connection with the target machine and port by issuing the
connect system call. This is the same high&minus;level
system call that web browsers, P2P clients, and most other
network&minus;enabled applications use to establish a
connection. It is part of a programming interface known as
the Berkeley Sockets API. Rather than read raw packet
responses off the wire, Nping uses this API to obtain status
information on each connection attempt. For this reason, you
will not be able to see the contents of the packets that are
sent or received but only status information about the TCP
connection establishment taking place.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;tcp</b>
(TCP mode) .</p>

<p style="margin-left:17%;">TCP is the mode that lets users
create and send any kind of TCP packet. TCP packets are sent
embedded in IP packets that can also be tuned. This mode can
be used for many different purposes. For example you could
try to discover open ports by sending TCP SYN messages
without completing the three&minus;way handshake. This
technique is often referred to as half&minus;open scanning,
because you don't open a full TCP connection. You send a SYN
packet, as if you are going to open a real connection and
then wait for a response. A SYN/ACK indicates the port is
open, while a RST indicates it's closed. If no response is
received one could assume that some intermediate network
device is filtering the responses. Another use could be to
see how a remote TCP/IP stack behaves when it receives a
non&minus;RFC&minus;compliant packet, like one with both SYN
and RST flags set. One could also do some evil by creating
custom RST packets using an spoofed IP address with the
intent of closing an active TCP connection.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;udp</b>
(UDP mode) .</p>

<p style="margin-left:17%;">UDP mode can have two different
behaviours. Under normal circumstances, it lets users create
custom IP/UDP packets. However, if Nping is run by a user
without raw packet privileges and no changes to the default
protocol headers are requested, then Nping enters the
unprivileged UDP mode which basically sends UDP packets to
the specified target hosts and ports using the sendto system
call. Note that in this unprivileged mode it is not possible
to see low&minus;level header information of the packets on
the wire but only status information about the amount of
bytes that are being transmitted and received. UDP mode can
be used to interact with any UDP&minus;based server.
Examples are DNS servers, streaming servers, online gaming
servers, and port knocking/single&minus;packet.
authorization daemons.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;icmp</b>
(ICMP mode) .</p>

<p style="margin-left:17%;">ICMP mode is the default mode
when the user runs Nping with raw packet privileges. Any
kind of ICMP message can be created. The default ICMP type
is Echo, i.e., ping. ICMP mode can be used for many
different purposes, from a simple request for a timestamp or
a netmask to the transmission of fake destination
unreachable messages, custom redirects, and router
advertisements.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;arp</b>
(ARP/RARP mode) .</p>

<p style="margin-left:17%;">ARP lets you create and send a
few different ARP&minus;related packets. These include ARP,
RARP, DRARP, and InARP requests and replies. This mode can
ban be used to perform low&minus;level host discovery, and
conduct ARP&minus;cache poisoning attacks.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;traceroute</b>
(Traceroute mode) .</p>

<p style="margin-left:17%;">Traceroute is not a mode by
itself but a complement to TCP, UDP, and ICMP modes. When
this option is specified Nping will set the IP TTL value of
the first probe to 1. When the next router receives the
packet it will drop it due to the expiration of the TTL and
it will generate an ICMP destination unreachable message.
The next probe will have a TTL of 2 so now the first router
will forward the packet while the second router will be the
one that drops the packet and generates the ICMP message.
The third probe will have a TTL value of 3 and so on. By
examining the source addresses of all those ICMP Destination
Unreachable messages it is possible to determine the path
that the probes take until they reach their final
destination.</p>

<h2>TCP CONNECT MODE
<a name="TCP CONNECT MODE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;p</b>
<i>port_spec</i>, <b>&minus;&minus;dest&minus;port</b>
<i>port_spec</i> (Target ports) .</p>

<p style="margin-left:17%;">This option specifies which
ports you want to try to connect to. It can be a single
port, a comma&minus;separated list of ports (e.g.
80,443,8080), a range (e.g. 1&minus;1023), and any
combination of those (e.g.
21&minus;25,80,443,1024&minus;2048). The beginning and/or
end values of a range may be omitted, causing Nping to use 1
and 65535, respectively. So you can specify &minus;p&minus;
to target ports from 1 through 65535. Using port zero is
allowed if you specify it explicitly.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;g</b>
<i>portnumber</i>, <b>&minus;&minus;source&minus;port</b>
<i>portnumber</i> (Spoof source port) .</p>

<p style="margin-left:17%;">This option asks Nping to use
the specified port as source port for the TCP connections.
Note that this might not work on all systems or may require
root privileges. Specified value must be an integer in the
range [0&ndash;65535].</p>

<h2>TCP MODE
<a name="TCP MODE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;p</b>
<i>port_spec</i>, <b>&minus;&minus;dest&minus;port</b>
<i>port_spec</i> (Target ports)</p>

<p style="margin-left:17%;">This option specifies which
destination ports you want to send probes to. It can be a
single port, a comma&minus;separated list of ports (e.g.
80,443,8080), a range (e.g. 1&minus;1023), and any
combination of those (e.g.
21&minus;25,80,443,1024&minus;2048). The beginning and/or
end values of a range may be omitted, causing Nping to use 1
and 65535, respectively. So you can specify &minus;p&minus;
to target ports from 1 through 65535. Using port zero is
allowed if you specify it explicitly.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;g</b>
<i>portnumber</i>, <b>&minus;&minus;source&minus;port</b>
<i>portnumber</i> (Spoof source port)</p>

<p style="margin-left:17%;">This option asks Nping to use
the specified port as source port for the TCP connections.
Note that this might not work on all systems or may require
root privileges. Specified value must be an integer in the
range [0&ndash;65535].</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;seq</b>
<i>seqnumber</i> (Sequence Number) .</p>

<p style="margin-left:17%;">Specifies the TCP sequence
number. In SYN packets this is the initial sequence number
(ISN). In a normal transmission this corresponds to the
sequence number of the first byte of data in the segment.
<i>seqnumber</i> must be a number in the range
[0&ndash;4294967295].</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;flags</b>
<i>flags</i> (TCP Flags) .</p>

<p style="margin-left:17%;">This option specifies which
flags should be set in the TCP packet. <i>flags</i> may be
specified in three different ways:</p>

<p style="margin-left:23%; margin-top: 1em">1. As a
comma&minus;separated list of flags, e.g.
<b>&minus;&minus;flags syn,ack,rst</b></p>

<p style="margin-left:23%; margin-top: 1em">2. As a list of
one&minus;character flag initials, e.g.
<b>&minus;&minus;flags SAR</b> tells Nping to set flags SYN,
ACK, and RST.</p>

<p style="margin-left:23%; margin-top: 1em">3. As an
8&minus;bit hexadecimal number, where the supplied number is
the exact value that will be placed in the flags field of
the TCP header. The number should start with the prefix 0x
and should be in the range [0x00&ndash;0xFF], e.g.
&minus;&minus;flags 0x20 sets the URG flag as 0x20
corresponds to binary 00100000 and the URG flag is
represented by the third bit.</p>

<p style="margin-left:17%; margin-top: 1em">There are 8
possible flags to set: CWR, ECN, URG, ACK, PSH, RST, SYN,
and FIN. The special value ALL means to set all flags. NONE
means to set no flags. It is important that if you don't
want any flag to be set, you request it explicitly because
in some cases the SYN flag may be set by default. Here is a
brief description of the meaning of each flag:</p>

<p style="margin-left:17%; margin-top: 1em">CWR (Congestion
Window Reduced) .</p>

<p style="margin-left:23%;">Set by an ECN&minus;Capable
sender when it reduces its congestion window (due to a
retransmit timeout, a fast retransmit or in response to an
ECN notification.</p>

<p style="margin-left:17%; margin-top: 1em">ECN (Explicit
Congestion Notification) .</p>

<p style="margin-left:23%;">During the three&minus;way
handshake it indicates that sender is capable of performing
explicit congestion notification. Normally it means that a
packet with the IP Congestion Experienced flag set was
received during normal transmission. See RFC 3168. for more
information.</p>

<p style="margin-left:17%; margin-top: 1em">URG (Urgent)
.</p>

<p style="margin-left:23%;">Segment is urgent and the
urgent pointer field carries valid information.</p>

<p style="margin-left:17%; margin-top: 1em">ACK
(Acknowledgement) .</p>

<p style="margin-left:23%;">The segment carries an
acknowledgement and the value of the acknowledgement number
field is valid and contains the next sequence number that is
expected from the receiver.</p>

<p style="margin-left:17%; margin-top: 1em">PSH (Push)
.</p>

<p style="margin-left:23%;">The data in this segment should
be immediately pushed to the application layer on
arrival.</p>

<p style="margin-left:17%; margin-top: 1em">RST (Reset)
.</p>

<p style="margin-left:23%;">There was some problem and the
sender wants to abort the connection.</p>

<p style="margin-left:17%; margin-top: 1em">SYN
(Synchronize) .</p>

<p style="margin-left:23%;">The segment is a request to
synchronize sequence numbers and establish a connection. The
sequence number field contains the sender's initial sequence
number.</p>

<p style="margin-left:17%; margin-top: 1em">FIN (Finish)
.</p>

<p style="margin-left:23%;">The sender wants to close the
connection.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;win</b>
<i>size</i> (Window Size) .</p>

<p style="margin-left:17%;">Specifies the TCP window size,
this is, the number of octets the sender of the segment is
willing to accept from the receiver at one time. This is
usually the size of the reception buffer that the OS
allocates for a given connection. <i>size</i> must be a
number in the range [0&ndash;65535].</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;badsum</b>
(Invalid Checksum) .</p>

<p style="margin-left:17%;">Asks Nping to use an invalid
TCP checksum for the packets sent to target hosts. Since
virtually all host IP stacks properly drop these packets,
any responses received are likely coming from a firewall or
an IDS that didn't bother to verify the checksum. For more
details on this technique, see
<b><font color="#0000FF">http://nmap.org/p60-12.html</font></b><font color="#000000">.</font></p>

<h2>UDP MODE
<a name="UDP MODE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;p</b>
<i>port_spec</i>, <b>&minus;&minus;dest&minus;port</b>
<i>port_spec</i> (Target ports) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies which ports you want UDP datagrams to be
sent to. It can be a single port, a comma&minus;separated
list of ports (e.g. 80,443,8080), a range (e.g.
1&minus;1023), and any combination of those (e.g.
21&minus;25,80,443,1024&minus;2048). The beginning and/or
end values of a range may be omitted, causing Nping to use 1
and 65535, respectively. So you can specify &minus;p&minus;
to target ports from 1 through 65535. Using port zero is
allowed if you specify it explicitly.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;g</b>
<i>portnumber</i>, <b>&minus;&minus;source&minus;port</b>
<i>portnumber</i> (Spoof source port) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option asks Nping to use the specified port as source port
for the transmitted datagrams. Note that this might not work
on all systems or may require root privileges. Specified
value must be an integer in the range
[0&ndash;65535].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;badsum</b>
(Invalid Checksum)</font></p>

<p style="margin-left:17%;"><font color="#000000">Asks
Nping to use an invalid UDP checksum for the packets sent to
target hosts. Since virtually all host IP stacks properly
drop these packets, any responses received are likely coming
from a firewall or an IDS that didn't bother to verify the
checksum. For more details on this technique, see</font>
<b><font color="#0000FF">http://nmap.org/p60-12.html</font></b><font color="#000000">.</font></p>

<h2>ICMP MODE
<a name="ICMP MODE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;type</b>
<i>type</i> (ICMP type) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies which type of ICMP messages should be
generated. <i>type</i> can be supplied in two different
ways. You can use the</font>
<b><font color="#0000FF">official type numbers assigned by
IANA</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">(e.g. <b>&minus;&minus;icmp&minus;type
8</b> for ICMP Echo Request), or you can use any of the
mnemonics listed in the section called &ldquo;ICMP
Types&rdquo;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;code</b>
<i>code</i> (ICMP code) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies which ICMP code should be included in the
generated ICMP messages. <i>code</i> can be supplied in two
different ways. You can use the</font>
<b><font color="#0000FF">official code numbers assigned by
IANA</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">(e.g. <b>&minus;&minus;icmp&minus;code
1</b> for Fragment Reassembly Time Exceeded), or you can use
any of the mnemonics listed in the section called
&ldquo;ICMP Codes&rdquo;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;id</b>
<i>id</i> (ICMP identifier) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies the value of the identifier used in some of
the ICMP messages. In general it is used to match request
and reply messages. <i>id</i> must be a number in the range
[0&ndash;65535].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;seq</b>
<i>seq</i> (ICMP sequence) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies the value of the sequence number field used
in some ICMP messages. In general it is used to match
request and reply messages. <i>id</i> must be a number in
the range [0&ndash;65535].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;redirect&minus;addr</b>
<i>addr</i> (ICMP Redirect address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the address field in ICMP Redirect messages. In
other words, it sets the IP address of the router that
should be used when sending IP datagrams to the original
destination. <i>addr</i> can be either an IPv4 address or a
hostname.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;param&minus;pointer</b>
<i>pointer</i> (ICMP Parameter Problem pointer) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies the pointer that indicates the location of
the problem in ICMP Parameter Problem messages.
<i>pointer</i> should be a number in the range
[0&ndash;255]. Normally this option is only used when ICMP
code is set to 0 (&quot;Pointer indicates the
error&quot;).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;advert&minus;lifetime</b>
<i>ttl</i> (ICMP Router Advertisement Lifetime) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies the router advertisement lifetime, this is,
the number of seconds the information carried in an ICMP
Router Advertisement can be considered valid for. <i>ttl</i>
must be a positive integer in the range
[0&ndash;65535].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;advert&minus;entry</b>
<i>addr</i><b>,</b><i>pref</i> (ICMP Router Advertisement
Entry) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option adds a Router Advertisement entry to an ICMP Router
Advertisement message. The parameter must be two values
separated by a comma. <i>addr</i> is the router's IP and can
be specified either as an IP address in dot&minus;decimal
notation or as a hostname. <i>pref</i> is the preference
level for the specified IP. It must be a number in the range
[0&ndash;4294967295]. An example is
<b>&minus;&minus;icmp&minus;advert&minus;entry
192.168.128.1,3</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;orig&minus;time</b>
<i>timestamp</i> (ICMP Originate Timestamp) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Originate Timestamp in ICMP Timestamp
messages. The Originate Timestamp is expressed as the number
of milliseconds since midnight UTC and it corresponds to the
time the sender last touched the Timestamp message before
its transmission. <i>timestamp</i> can be specified as a
regular time (e.g. 10s, 3h, 1000ms), or the special string
now. You can add or subtract values from now, for example
<b>&minus;&minus;icmp&minus;orig&minus;time
now&minus;2s</b>,
<b>&minus;&minus;icmp&minus;orig&minus;time now+1h</b>,
<b>&minus;&minus;icmp&minus;orig&minus;time
now+200ms</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;recv&minus;time</b>
<i>timestamp</i> (ICMP Receive Timestamp) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Receive Timestamp in ICMP Timestamp
messages. The Receive Timestamp is expressed as the number
of milliseconds since midnight UTC and it corresponds to the
time the echoer first touched the Timestamp message on
receipt. <i>timestamp</i> is as with
<b>&minus;&minus;icmp&minus;orig&minus;time</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;icmp&minus;trans&minus;time</b>
<i>timestamp</i> (ICMP Transmit Timestamp) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Transmit Timestamp in ICMP Timestamp
messages. The Transmit Timestamp is expressed as the number
of milliseconds since midnight UTC and it corresponds to the
time the echoer last touched the Timestamp message before
its transmission. <i>timestamp</i> is as with
<b>&minus;&minus;icmp&minus;orig&minus;time</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>ICMP
Types</b> <br>
These identifiers may be used as mnemonics for the ICMP type
numbers given to the <b>&minus;&minus;icmp&minus;type</b>.
option. In general there are three forms of each identifier:
the full name (e.g. destination&minus;unreachable), the
short name (e.g. dest&minus;unr), or the initials (e.g. du).
In ICMP types that request something, the word
&quot;request&quot; is omitted.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">echo&minus;reply,
echo&minus;rep, er</font></p>

<p style="margin-left:17%;"><font color="#000000">Echo
Reply (type 0). This message is sent in response to an Echo
Request message.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">destination&minus;unreachable,
dest&minus;unr, du</font></p>


<p style="margin-left:17%;"><font color="#000000">Destination
Unreachable (type 3). This message indicates that a datagram
could not be delivered to its destination.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">source&minus;quench,
sour&minus;que, sq</font></p>

<p style="margin-left:17%;"><font color="#000000">Source
Quench (type 4). This message is used by a congested IP
device to tell other device that is sending packets too fast
and that it should slow down.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">redirect,
redi, r</font></p>

<p style="margin-left:17%;"><font color="#000000">Redirect
(type 5). This message is normally used by routers to inform
a host that there is a better route to use for sending
datagrams. See also the
<b>&minus;&minus;icmp&minus;redirect&minus;addr</b>
option.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">echo&minus;request,
echo, e</font></p>

<p style="margin-left:17%;"><font color="#000000">Echo
Request (type 8). This message is used to test the
connectivity of another device on a network.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">router&minus;advertisement,
rout&minus;adv, ra</font></p>

<p style="margin-left:17%;"><font color="#000000">Router
Advertisement (type 9). This message is used by routers to
let hosts know of their existence and capabilities. See also
the <b>&minus;&minus;icmp&minus;advert&minus;lifetime</b>
option.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">router&minus;solicitation,
rout&minus;sol, rs</font></p>

<p style="margin-left:17%;"><font color="#000000">Router
Solicitation (type 10). This message is used by hosts to
request Router Advertisement messages from any listening
routers.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">time&minus;exceeded,
time&minus;exc, te</font></p>

<p style="margin-left:17%;"><font color="#000000">Time
Exceeded (type 11). This message is generated by some
intermediate device (normally a router) to indicate that a
datagram has been discarded before reaching its destination
because the IP TTL expired.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">parameter&minus;problem,
member&minus;pro, pp</font></p>


<p style="margin-left:17%;"><font color="#000000">Parameter
Problem (type 12). This message is used when a device finds
a problem with a parameter in an IP header and it cannot
continue processing it. See also the
<b>&minus;&minus;icmp&minus;param&minus;pointer</b>
option.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">timestamp,
time, tm</font></p>


<p style="margin-left:17%;"><font color="#000000">Timestamp
Request (type 13). This message is used to request a device
to send a timestamp value for propagation time calculation
and clock synchronization. See also the
<b>&minus;&minus;icmp&minus;orig&minus;time</b>,
<b>&minus;&minus;icmp&minus;recv&minus;time</b>, and
<b>&minus;&minus;icmp&minus;trans&minus;time</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">timestamp&minus;reply,
time&minus;rep, tr</font></p>


<p style="margin-left:17%;"><font color="#000000">Timestamp
Reply (type 14). This message is sent in response to a
Timestamp Request message.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">information,
info, i</font></p>


<p style="margin-left:17%;"><font color="#000000">Information
Request (type 15). This message is now obsolete but it was
originally used to request configuration information from
another device.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">information&minus;reply,
info&minus;rep, ir</font></p>


<p style="margin-left:17%;"><font color="#000000">Information
Reply (type 16). This message is now obsolete but it was
originally sent in response to an Information Request
message to provide configuration information.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mask&minus;request,
mask, m</font></p>

<p style="margin-left:17%;"><font color="#000000">Address
Mask Request (type 17). This message is used to ask a device
to send its subnet mask.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mask&minus;reply,
mask&minus;rep, mr</font></p>

<p style="margin-left:17%;"><font color="#000000">Address
Mask Reply (type 18). This message contains a subnet mask
and is sent in response to a Address Mask Request
message.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">traceroute,
trace, tc</font></p>


<p style="margin-left:17%;"><font color="#000000">Traceroute
(type 30). This message is normally sent by an intermediate
device when it receives an IP datagram with a traceroute
option. ICMP Traceroute messages are still experimental, see
RFC 1393. for more information.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>ICMP
Codes</b> <br>
These identifiers may be used as mnemonics for the ICMP code
numbers given to the <b>&minus;&minus;icmp&minus;code</b>.
option. They are listed by the ICMP type they correspond
to.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b><big>Destination
Unreachable</big></b></font></p>


<p style="margin-left:17%;"><font color="#000000">network&minus;unreachable,
netw&minus;unr, net</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 0.
Datagram could not be delivered to its destination network
(probably due to some routing problem).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">host&minus;unreachable,
host&minus;unr, host</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 1.
Datagram was delivered to the destination network but it was
impossible to reach the specified host (probably due to some
routing problem).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">protocol&minus;unreachable,
prot&minus;unr, proto</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 2.
The protocol specified in the Protocol field of the IP
datagram is not supported by the host to which the datagram
was delivered.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">port&minus;unreachable,
port&minus;unr, port</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 3.
The TCP/UDP destination port was invalid.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">needs&minus;fragmentation,
need&minus;fra, frag</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 4.
Datagram had the DF bit set but it was too large for the MTU
of the next physical network so it had to be
dropped.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">source&minus;route&minus;failed,
sour&minus;rou, routefail</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 5.
IP datagram had a Source Route option but a router couldn't
pass it to the next hop.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">network&minus;unknown,
netw&minus;unk, net?</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 6.
Destination network is unknown. This code is never used.
Instead, Network Unreachable is used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">host&minus;unknown,
host&minus;unk, host?</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 7.
Specified host is unknown. Usually generated by a router
local to the destination host to inform of a bad
address.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">host&minus;isolated,
host&minus;iso, isolated</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 8.
Source Host Isolated. Not used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">network&minus;prohibited,
netw&minus;pro, !net</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 9.
Communication with destination network is administratively
prohibited (source device is not allowed to send packets to
the destination network).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">host&minus;prohibited,
host&minus;pro, !host</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 10.
Communication with destination host is administratively
prohibited. (The source device is allowed to send packets to
the destination network but not to the destination
device.)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">network&minus;tos,
unreachable&minus;network&minus;tos, netw&minus;tos,
tosnet</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 11.
Destination network unreachable because it cannot provide
the type of service specified in the IP TOS
field.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">host&minus;tos,
unreachable&minus;host&minus;tos, toshost</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 12.
Destination host unreachable because it cannot provide the
type of service specified in the IP TOS field.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">communication&minus;prohibited,
comm&minus;pro, !comm</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 13.
Datagram could not be forwarded due to filtering that blocks
the message based on its contents.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">host&minus;precedence&minus;violation,
precedence&minus;violation, prec&minus;vio,
violation</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 14.
Precedence value in the IP TOS field is not
permitted.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">precedence&minus;cutoff,
prec&minus;cut, cutoff</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 15.
Precedence value in the IP TOS field is lower than the
minimum allowed for the network.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b><big>Redirect</big></b></font></p>


<p style="margin-left:17%;"><font color="#000000">redirect&minus;network,
redi&minus;net, net</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 0.
Redirect all future datagrams with the same destination
network as the original datagram, to the router specified in
the Address field. The use of this code is prohibited by RFC
1812..</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">redirect&minus;host,
redi&minus;host, host</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 1.
Redirect all future datagrams with the same destination host
as the original datagram, to the router specified in the
Address field.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">redirect&minus;network&minus;tos,
redi&minus;ntos, redir&minus;ntos</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 2.
Redirect all future datagrams with the same destination
network and IP TOS value as the original datagram, to the
router specified in the Address field. The use of this code
is prohibited by RFC 1812.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">redirect&minus;host&minus;tos,
redi&minus;htos, redir&minus;htos</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 3.
Redirect all future datagrams with the same destination host
and IP TOS value as the original datagram, to the router
specified in the Address field.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b><big>Router
Advertisement</big></b></font></p>


<p style="margin-left:17%;"><font color="#000000">normal&minus;advertisement,
norm&minus;adv, normal, zero, default, def</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 0.
Normal router advertisement. In Mobile IP: Mobility agent
can act as a router for IP datagrams not related to mobile
nodes.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">not&minus;route&minus;common&minus;traffic,
not&minus;rou, mobile&minus;ip, !route,
!commontraffic</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 16.
Used for Mobile IP. The mobility agent does not route common
traffic. All foreign agents must forward to a default router
any datagrams received from a registered mobile
node</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b><big>Time
Exceeded</big></b></font></p>


<p style="margin-left:17%;"><font color="#000000">ttl&minus;exceeded&minus;in&minus;transit,
ttl&minus;exc, ttl&minus;transit</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 0.
IP Time To Live expired during transit.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">fragment&minus;reassembly&minus;time&minus;exceeded,
frag&minus;exc, frag&minus;time</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 1.
Fragment reassembly time has been exceeded.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b><big>Parameter
Problem</big></b></font></p>


<p style="margin-left:17%;"><font color="#000000">pointer&minus;indicates&minus;error,
poin&minus;ind, pointer</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 0.
The pointer field indicates the location of the problem. See
the <b>&minus;&minus;icmp&minus;param&minus;pointer</b>
option.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">missing&minus;required&minus;option,
miss&minus;option, option&minus;missing</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 1.
IP datagram was expected to have an option that is not
present.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">bad&minus;length,
bad&minus;len, badlen</font></p>

<p style="margin-left:23%;"><font color="#000000">Code 2.
The length of the IP datagram is incorrect.</font></p>

<h2>ARP MODE
<a name="ARP MODE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;arp&minus;type</b>
<i>type</i> (ICMP Type) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies which type of ARP messages should be
generated. <i>type</i> can be supplied in two different
ways. You can use the</font>
<b><font color="#0000FF">official numbers assigned by
IANA</font></b>
<small><font color="#000000">[2]</font></small>
<font color="#000000">(e.g. <b>&minus;&minus;arp&minus;type
1</b> for ARP Request), or you can use one of the mnemonics
from the section called &ldquo;ARP Types&rdquo;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;arp&minus;sender&minus;mac</b>
<i>mac</i> (Sender MAC address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Sender Hardware Address field of the ARP
header. Although ARP supports many types of link layer
addresses, currently Nping only supports MAC addresses.
<i>mac</i> must be specified using the traditional MAC
notation (e.g. 00:0a:8a:32:f4:ae). You can also use hyphens
as separators (e.g.
00&minus;0a&minus;8a&minus;32&minus;f4&minus;ae).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;arp&minus;sender&minus;ip</b>
<i>addr</i> (Sender IP address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Sender IP field of the ARP header.
<i>addr</i> can be given as an IPv4 address or a
hostname.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;arp&minus;target&minus;mac</b>
<i>mac</i> (target MAC address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Target Hardware Address field of the ARP
header.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;arp&minus;target&minus;ip</b>
<i>addr</i> (target ip address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Target IP field of the ARP
header.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>ARP
Types</b> <br>
These identifiers may be used as mnemonics for the ARP type
numbers given to the <b>&minus;&minus;arp&minus;type</b>.
option.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">arp&minus;request,
arp, a</font></p>

<p style="margin-left:17%;"><font color="#000000">ARP
Request (type 1). ARP requests are used to translate network
layer addresses (normally IP addresses) to link layer
addresses (usually MAC addresses). Basically, and ARP
request is a broadcasted message that asks the host in the
same network segment that has a given IP address to provide
its MAC address.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">arp&minus;reply,
arp&minus;rep, ar</font></p>

<p style="margin-left:17%;"><font color="#000000">ARP Reply
(type 2). An ARP reply is a message that a host sends in
response to an ARP request to provide its link layer
address.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">rarp&minus;request,
rarp, r</font></p>

<p style="margin-left:17%;"><font color="#000000">RARP
Requests (type 3). RARP requests are used to translate a
link layer address (normally a MAC address) to a network
layer address (usually an IP address). Basically a RARP
request is a broadcasted message sent by a host that wants
to know his own IP address because it doesn't have any. It
was the first protocol designed to solve the bootstrapping
problem. However, RARP is now obsolete and DHCP is used
instead. For more information about RARP see RFC
903..</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">rarp&minus;reply,
rarp&minus;rep, rr</font></p>

<p style="margin-left:17%;"><font color="#000000">RARP
Reply (type 4). A RARP reply is a message sent in response
to a RARP request to provide an IP address to the host that
sent the RARP request in the first place.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">drarp&minus;request,
drarp, d</font></p>

<p style="margin-left:17%;"><font color="#000000">Dynamic
RARP Request (type 5). Dynamic RARP is an extension to RARP
used to obtain or assign a network layer address from a
fixed link layer address. DRARP was used mainly in Sun
Microsystems platforms in the late 90's but now it's no
longer used. See RFC 1931. for more information.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">drarp&minus;reply,
drarp&minus;rep, dr</font></p>

<p style="margin-left:17%;"><font color="#000000">Dynamic
RARP Reply (type 6). A DRARP reply is a message sent in
response to a RARP request to provide network layer
address.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">drarp&minus;error,
drarp&minus;err, de</font></p>

<p style="margin-left:17%;"><font color="#000000">DRARP
Error (type 7). DRARP Error messages are usually sent in
response to DRARP requests to inform of some error. In DRARP
Error messages, the Target Protocol Address field is used to
carry an error code (usually in the first byte). The error
code is intended to tell why no target protocol address is
being returned. For more information see RFC
1931.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">inarp&minus;request,
inarp, i</font></p>

<p style="margin-left:17%;"><font color="#000000">Inverse
ARP Request (type 8). InARP requests are used to translate a
link layer address to a network layer address. It is similar
to RARP request but in this case, the sender of the InARP
request wants to know the network layer address of another
node, not its own address. InARP is mainly used in Frame
Relay and ATM networks. For more information see RFC
2390..</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">inarp&minus;reply,
inarp&minus;rep, ir</font></p>

<p style="margin-left:17%;"><font color="#000000">Inverse
ARP Reply (type 9). InARP reply messages are sent in
response to InARP requests to provide the network layer
address associated with the host that has a given link layer
address.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">arp&minus;nak,
an</font></p>

<p style="margin-left:17%;"><font color="#000000">ARP NAK
(type 10). ARP NAK messages are an extension to the ATMARP
protocol and they are used to improve the robustness of the
ATMARP server mechanism. With ARP NAK, a client can
determine the difference between a catastrophic server
failure and an ATMARP table lookup failure. See RFC 1577.
for more information.</font></p>

<h2>IPV4 OPTIONS
<a name="IPV4 OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;S</b>
<i>addr</i>, <b>&minus;&minus;source&minus;ip</b>
<i>addr</i> (Source IP Address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
source IP address. This option lets you specify a custom IP
address to be used as source IP address in sent packets.
This allows spoofing the sender of the packets. <i>addr</i>
can be an IPv4 address or a hostname.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;dest&minus;ip</b>
<i>addr</i> (Destination IP Address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Adds a
target to Nping's target list. This option is provided for
consistency but its use is deprecated in favor of plain
target specifications. See the section called &ldquo;TARGET
SPECIFICATION&rdquo;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;tos</b>
<i>tos</i> (Type of Service) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
IP TOS field. The TOS field is used to carry information to
provide quality of service features. It is normally used to
support a technique called Differentiated Services. See RFC
2474. for more information. <i>tos</i> must be a number in
the range [0&ndash;255].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;id</b>
<i>id</i> (Identification) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
IPv4 Identification field. The Identification field is a
16&minus;bit value that is common to all fragments belonging
to a particular message. The value is used by the receiver
to reassemble the original message from the fragments
received. <i>id</i> must be a number in the range
[0&ndash;65535].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;df</b>
(Don't Fragment) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
Don't Fragment bit in sent packets. When an IP datagram has
its DF flag set, intermediate devices are not allowed to
fragment it so if it needs to travel across a network with a
MTU smaller that datagram length the datagram will have to
be dropped. Normally an ICMP Destination Unreachable message
is generated and sent back to the sender.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;mf</b>
(More Fragments) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
More Fragments bit in sent packets. The MF flag is set to
indicate the receiver that the current datagram is a
fragment of some larger datagram. When set to zero it
indicates that the current datagram is either the last
fragment in the set or that it is the only
fragment.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;ttl</b>
<i>hops</i> (Time To Live) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
IPv4 Time&minus;To&minus;Live (TTL) field in sent packets to
the given value. The TTL field specifies how long the
datagram is allowed to exist on the network. It was
originally intended to represent a number of seconds but it
actually represents the number of hops a packet can traverse
before being dropped. The TTL tries to avoid a situation in
which undeliverable datagrams keep being forwarded from one
router to another endlessly. <i>hops</i> must be a number in
the range [0&ndash;255].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;badsum&minus;ip</b>
(Invalid IP checksum) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Asks
Nping to use an invalid IP checksum for packets sent to
target hosts. Note that some systems (like most Linux
kernels), may fix the checksum before placing the packet on
the wire, so even if Nping shows the incorrect checksum in
its output, the packets may be transparently corrected by
the kernel.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;ip&minus;options</b>
<i>S|R [route]|L [route]|T|U ...</i>,
<b>&minus;&minus;ip&minus;options</b> <i>hex string</i> (IP
Options) .</font></p>

<p style="margin-left:17%;"><font color="#000000">The IP
protocol offers several options which may be placed in
packet headers. Unlike the ubiquitous TCP options, IP
options are rarely seen due to practicality and security
concerns. In fact, many Internet routers block the most
dangerous options such as source routing. Yet options can
still be useful in some cases for determining and
manipulating the network route to target machines. For
example, you may be able to use the record route option to
determine a path to a target even when more traditional
traceroute&minus;style approaches fail. Or if your packets
are being dropped by a certain firewall, you may be able to
specify a different route with the strict or loose source
routing options.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
most powerful way to specify IP options is to simply pass in
hexadecimal data as the argument to
<b>&minus;&minus;ip&minus;options</b>. Precede each hex byte
value with \x. You may repeat certain characters by
following them with an asterisk and then the number of times
you wish them to repeat. For example, \x01\x07\x04\x00*4 is
the same as \x01\x07\x04\x00\x00\x00\x00.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that if you specify a number of bytes that is not a multiple
of four, an incorrect IP header length will be set in the IP
packet. The reason for this is that the IP header length
field can only express multiples of four. In those cases,
the length is computed by dividing the header length by 4
and rounding down. This will affect the way the header that
follows the IP header is interpreted, showing bogus
information in Nping or in the output of any sniffer.
Although this kind of situation might be useful for some
stack stress tests, users would normally want to specify
explicit padding, so the correct header length is
set.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Nping
also offers a shortcut mechanism for specifying options.
Simply pass the letter R, T, or U to request
record&minus;route, record&minus;timestamp, or both options
together, respectively. Loose or strict source routing may
be specified with an L or S followed by a space and then a
space&minus;separated list of IP addresses.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">For
more information and examples of using IP options with
Nping, see the mailing list post at</font>
<b><font color="#0000FF">http://seclists.org/nmap-dev/2006/q3/0052.html</font></b><font color="#000000">.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;mtu</b>
<i>size</i> (Maximum Transmission Unit) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets a fictional MTU in Nping so IP datagrams larger
than <i>size</i> are fragmented before transmission.
<i>size</i> must be specified in bytes and corresponds to
the number of octets that can be carried on a single
link&minus;layer frame.</font></p>

<h2>IPV6 OPTIONS
<a name="IPV6 OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;6</b>,
<b>&minus;&minus;ipv6</b> (Use IPv6) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Tells
Nping to use IP version 6 instead of the default IPv4. It is
generally a good idea to specify this option as early as
possible in the command line so Nping can parse it soon and
know in advance that the rest of the parameters refer to
IPv6. The command syntax is the same as usual except that
you also add the <b>&minus;6</b> option. Of course, you must
use IPv6 syntax if you specify an address rather than a
hostname. An address might look like
<b>3ffe:7501:4819:2000:210:f3ff:fe03:14d0</b>, so hostnames
are recommended.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">While
IPv6 hasn't exactly taken the world by storm, it gets
significant use in some (usually Asian) countries and most
modern operating systems support it. To use Nping with IPv6,
both the source and target of your packets must be
configured for IPv6. If your ISP (like most of them) does
not allocate IPv6 addresses to you, free tunnel brokers are
widely available and work fine with Nping. You can use the
free IPv6 tunnel broker service at</font>
<b><font color="#0000FF">http://www.tunnelbroker.net</font></b><font color="#000000">.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Please
note that IPv6 support is still highly experimental and many
modes and options may not work with it.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;S</b>
<i>addr</i>, <b>&minus;&minus;source&minus;ip</b>
<i>addr</i> (Source IP Address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
source IP address. This option lets you specify a custom IP
address to be used as source IP address in sent packets.
This allows spoofing the sender of the packets. <i>addr</i>
can be an IPv6 address or a hostname.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;dest&minus;ip</b>
<i>addr</i> (Destination IP Address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Adds a
target to Nping's target list. This option is provided for
consistency but its use is deprecated in favor of plain
target specifications. See the section called &ldquo;TARGET
SPECIFICATION&rdquo;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;flow</b>
<i>label</i> (Flow Label) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
IPv6 Flow Label. The Flow Label field is 20 bits long and is
intended to provide certain quality&minus;of&minus;service
properties for real&minus;time datagram delivery. However,
it has not been widely adopted, and not all routers or
endpoints support it. Check RFC 2460. for more information.
<i>label</i> must be an integer in the range
[0&ndash;1048575].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;traffic&minus;class</b>
<i>class</i> (Traffic Class) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
IPv6 Traffic Class. This field is similar to the TOS field
in IPv4, and is intended to provide the Differentiated
Services method, enabling scalable service discrimination in
the Internet without the need for per&minus;flow state and
signaling at every hop. Check RFC 2474. for more
information. <i>class</i> must be an integer in the range
[0&ndash;255].</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;hop&minus;limit</b>
<i>hops</i> (Hop Limit) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Sets the
IPv6 Hop Limit field in sent packets to the given value. The
Hop Limit field specifies how long the datagram is allowed
to exist on the network. It represents the number of hops a
packet can traverse before being dropped. As with the TTL in
IPv4, IPv6 Hop Limit tries to avoid a situation in which
undeliverable datagrams keep being forwarded from one router
to another endlessly. <i>hops</i> must be a number in the
range [0&ndash;255].</font></p>

<h2>ETHERNET OPTIONS
<a name="ETHERNET OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">In
most cases Nping sends packets at the raw IP level. This
means that Nping creates its own IP packets and transmits
them through a raw socket. However, in some cases it may be
necessary to send packets at the raw Ethernet level. This
happens, for example, when Nping is run under Windows (as
Microsoft has disabled raw socket support since Windows XP
SP2), or when Nping is asked to send ARP packets. Since in
some cases it is necessary to construct ethernet frames,
Nping offers some options to manipulate the different
fields.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;dest&minus;mac</b>
<i>mac</i> (Ethernet Destination MAC Address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the destination MAC address that should be set
in outgoing Ethernet frames. This is useful in case Nping
can't determine the next hop's MAC address or when you want
to route probes through a router other than the configured
default gateway. The MAC address should have the usual
format of six colon&minus;separated bytes, e.g.
00:50:56:d4:01:98. Alternatively, hyphens may be used
instead of colons. Use the word random or rand to generate a
random address, and broadcast or bcast to use
ff:ff:ff:ff:ff:ff. If you set up a bogus destination MAC
address your probes may not reach the intended
targets.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;source&minus;mac</b>
<i>mac</i> (Ethernet Source MAC Address) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the source MAC address that should be set in
outgoing Ethernet frames. This is useful in case Nping can't
determine your network interface MAC address or when you
want to inject traffic into the network while hiding your
network card's real address. The syntax is the same as for
&minus;&minus;dest&minus;mac. If you set up a bogus source
MAC address you may not receive probe replies.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;ether&minus;type</b>
<i>type</i> (Ethertype) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option sets the Ethertype field of the ethernet frame. The
Ethertype is used to indicate which protocol is encapsulated
in the payload. <i>type</i> can be supplied in two different
ways. You can use the</font>
<b><font color="#0000FF">official numbers listed by the
IEEE</font></b>
<small><font color="#000000">[3]</font></small>
<font color="#000000">(e.g.
<b>&minus;&minus;ether&minus;type 0x0800</b> for IP version
4), or one of the mnemonics from the section called
&ldquo;Ethernet Types&rdquo;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Ethernet
Types</b> <br>
These identifiers may be used as mnemonics for the Ethertype
numbers given to the <b>&minus;&minus;arp&minus;type</b>.
option.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ipv4,
ip, 4</font></p>

<p style="margin-left:17%;"><font color="#000000">Internet
Protocol version 4 (type 0x0800).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ipv6,
6</font></p>

<p style="margin-left:17%;"><font color="#000000">Internet
Protocol version 6 (type 0x86DD).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">arp</font></p>

<p style="margin-left:17%;"><font color="#000000">Address
Resolution Protocol (type 0x0806).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">rarp</font></p>

<p style="margin-left:17%;"><font color="#000000">Reverse
Address Resolution Protocol (type 0x8035).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">frame&minus;relay,
frelay, fr</font></p>

<p style="margin-left:17%;"><font color="#000000">Frame
Relay (type 0x0808).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ppp</font></p>


<p style="margin-left:17%;"><font color="#000000">Point&minus;to&minus;Point
Protocol (type 0x880B).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">gsmp</font></p>

<p style="margin-left:17%;"><font color="#000000">General
Switch Management Protocol (type 0x880C).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mpls</font></p>


<p style="margin-left:17%;"><font color="#000000">Multiprotocol
Label Switching (type 0x8847).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mps&minus;ual,
mps</font></p>


<p style="margin-left:17%;"><font color="#000000">Multiprotocol
Label Switching with Upstream&minus;assigned Label (type
0x8848).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mcap</font></p>


<p style="margin-left:17%;"><font color="#000000">Multicast
Channel Allocation Protocol (type 0x8861).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">pppoe&minus;discovery,
pppoe&minus;d</font></p>

<p style="margin-left:17%;"><font color="#000000">PPP over
Ethernet Discovery Stage (type 0x8863).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">pppoe&minus;session,
pppoe&minus;s</font></p>

<p style="margin-left:17%;"><font color="#000000">PPP over
Ethernet Session Stage (type 0x8864).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ctag</font></p>

<p style="margin-left:17%;"><font color="#000000">Customer
VLAN Tag Type (type 0x8100).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">epon</font></p>

<p style="margin-left:17%;"><font color="#000000">Ethernet
Passive Optical Network (type 0x8808).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">pbnac</font></p>


<p style="margin-left:17%;"><font color="#000000">Port&minus;based
network access control (type 0x888E).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">stag</font></p>

<p style="margin-left:17%;"><font color="#000000">Service
VLAN tag identifier (type 0x88A8).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ethexp1</font></p>

<p style="margin-left:17%;"><font color="#000000">Local
Experimental Ethertype 1 (type 0x88B5).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ethexp2</font></p>

<p style="margin-left:17%;"><font color="#000000">Local
Experimental Ethertype 2 (type 0x88B6).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">ethoui</font></p>

<p style="margin-left:17%;"><font color="#000000">OUI
Extended Ethertype (type 0x88B7).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">preauth</font></p>


<p style="margin-left:17%;"><font color="#000000">Pre&minus;Authentication
(type 0x88C7).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">lldp</font></p>

<p style="margin-left:17%;"><font color="#000000">Link
Layer Discovery Protocol (type 0x88CC).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mac&minus;security,
mac&minus;sec, macsec</font></p>

<p style="margin-left:17%;"><font color="#000000">Media
Access Control Security (type 0x88E5).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mvrp</font></p>

<p style="margin-left:17%;"><font color="#000000">Multiple
VLAN Registration Protocol (type 0x88F5).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">mmrp</font></p>

<p style="margin-left:17%;"><font color="#000000">Multiple
Multicast Registration Protocol (type 0x88F6).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">frrr</font></p>

<p style="margin-left:17%;"><font color="#000000">Fast
Roaming Remote Request (type 0x890D).</font></p>

<h2>PAYLOAD OPTIONS
<a name="PAYLOAD OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;data</b>
<i>hex string</i> (Append custom binary data to sent
packets) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option lets you include binary data as payload in sent
packets. <i>hex string</i> may be specified in any of the
following formats: 0xAABBCCDDEEFF<i>...</i>,
AABBCCDDEEFF<i>...</i> or
\xAA\xBB\xCC\xDD\xEE\xFF<i>...</i>. Examples of use are
<b>&minus;&minus;data 0xdeadbeef</b> and
<b>&minus;&minus;data \xCA\xFE\x09</b>. Note that if you
specify a number like 0x00ff no byte&minus;order conversion
is performed. Make sure you specify the information in the
byte order expected by the receiver.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;data&minus;string</b>
<i>string</i> (Append custom string to sent packets)
.</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option lets you include a regular string as payload in sent
packets. <i>string</i> can contain any string. However, note
that some characters may depend on your system's locale and
the receiver may not see the same information. Also, make
sure you enclose the string in double quotes and escape any
special characters from the shell. Example:
<b>&minus;&minus;data&minus;string &quot;Jimmy
Jazz...&quot;</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;data&minus;length</b>
<i>len</i> (Append random data to sent packets) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option lets you include <i>len</i> random bytes of data as
payload in sent packets. <i>len</i> must be an integer in
the range [0&ndash;65400]. However, values higher than 1400
are not recommended because it may not be possible to
transmit packets due to network MTU limitations.</font></p>

<h2>ECHO MODE
<a name="ECHO MODE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
&quot;Echo Mode&quot; is a novel technique implemented by
Nping which lets users see how network packets change in
transit, from the host where they originated to the target
machine. Basically, the Echo mode turns Nping into two
different pieces: the Echo server and the Echo client. The
Echo server is a network service that has the ability to
capture packets from the network and send a copy (&quot;echo
them&quot;) to the originating client through a side TCP
channel. The Echo client is the part that generates such
network packets, transmits them to the server, and receives
their echoed version through a side TCP channel that it has
previously established with the Echo server.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">This
scheme lets the client see the differences between the
packets that it sends and what is actually received by the
server. By having the server send back copies of the
received packets through the side channel, things like NAT
devices become immediately apparent to the client because it
notices the changes in the source IP address (and maybe even
source port). Other devices like those that perform traffic
shaping, changing TCP window sizes or adding TCP options
transparently between hosts, turn up too.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
Echo mode is also useful for troubleshooting routing and
firewall issues. Among other things, it can be used to
determine if the traffic generated by the Nping client is
being dropped in transit and never gets to its destination
or if the responses are the ones that don't get back to
it.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Internally,
client and server communicate over an encrypted and
authenticated channel, using the Nping Echo Protocol (NEP),
whose technical specification can be found in</font>
<b><font color="#0000FF">http://nmap.org/svn/nping/docs/EchoProtoRFC.txt</font></b></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following paragraphs describe the different options
available in Nping's Echo mode.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;ec</b>
<i>passphrase</i>, <b>&minus;&minus;echo&minus;client</b>
<i>passphrase</i> (Run Echo client) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option tells Nping to run as an Echo client.
<i>passphrase</i> is a sequence of ASCII characters that is
used to generate the cryptographic keys needed for
encryption and authentication in a given session. The
passphrase should be a secret that is also known by the
server, and it may contain any number of printable ASCII
characters. Passphrases that contain whitespace or special
characters must be enclosed in double quotes.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
running Nping as an Echo client, most options from the
regular raw probe modes apply. The client may be configured
to send specific probes using flags like
<b>&minus;&minus;tcp</b>, <b>&minus;&minus;icmp</b> or
<b>&minus;&minus;udp</b>. Protocol header fields may be
manipulated normally using the appropriate options (e.g.
<b>&minus;&minus;ttl</b>, <b>&minus;&minus;seq</b>,
<b>&minus;&minus;icmp&minus;type</b>, etc.). The only
exceptions are ARP&minus;related flags, which are not
supported in Echo mode, as protocols like ARP are closely
related to the data link layer and its probes can't pass
through different network segments.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;es</b>
<i>passphrase</i>, <b>&minus;&minus;echo&minus;server</b>
<i>passphrase</i> (Run Echo server) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option tells Nping to run as an Echo server.
<i>passphrase</i> is a sequence of ASCII characters that is
used to generate the cryptographic keys needed for
encryption and authentication in a given session. The
passphrase should be a secret that is also known by the
clients, and it may contain any number of printable ASCII
characters. Passphrases that contain whitespace or special
characters must be enclosed in double quotes. Note that
although it is not recommended, it is possible to use empty
passphrases, supplying <b>&minus;&minus;echo&minus;server
&quot;&quot;</b>. However, if what you want is to set up an
open Echo server, it is better to use option
<b>&minus;&minus;no&minus;crypto</b>. See below for
details.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;ep</b>
<i>port</i>, <b>&minus;&minus;echo&minus;port</b>
<i>port</i> (Set Echo TCP port number) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option asks Nping to use the specified TCP port number for
the Echo side channel connection. If this option is used
with <b>&minus;&minus;echo&minus;server</b>, it specifies
the port on which the server listens for connections. If it
is used with <b>&minus;&minus;echo&minus;client</b>, it
specifies the port to connect to on the remote host. By
default, port number 9929 is used.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;nc</b>,
<b>&minus;&minus;no&minus;crypto</b> (Disable encryption and
authentication) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option asks Nping not to use any cryptographic operations
during an Echo session. In practical terms, this means that
the Echo side channel session data will be transmitted in
the clear, and no authentication will be performed by the
server or client during the session establishment phase.
When <b>&minus;&minus;no&minus;crypto</b> is used, the
passphrase supplied with
<b>&minus;&minus;echo&minus;server</b> or
<b>&minus;&minus;echo&minus;client</b> is
ignored.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
option must be specified if Nping was compiled without
openSSL support. Note that, for technical reasons, a
passphrase still needs to be supplied after the
&minus;&minus;echo&minus;client or
&minus;&minus;echo&minus;server flags, even though it will
be ignored.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
&minus;&minus;no&minus;crypto flag might be useful when
setting up a public Echo server, because it allows users to
connect to the Echo server without the need for any
passphrase or shared secret. However, it is strongly
recommended to not use &minus;&minus;no&minus;crypto unless
absolutely necessary. Public Echo servers should be
configured to use the passphrase &quot;public&quot; or the
empty passphrase (&minus;&minus;echo&minus;server
&quot;&quot;) as the use of cryptography does not only
provide confidentiality and authentication but also message
integrity.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;once</b>
(Serve one client and quit) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option asks the Echo server to quit after serving one
client. This is useful when only a single Echo session wants
to be established as it eliminates the need to access the
remote host to shutdown the server.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;safe&minus;payloads</b>
(Zero application data before echoing a packet) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option asks the Echo server to erase any application layer
data found in client packets before echoing them. When the
option is enabled, the Echo server parses the packets
received from Echo clients and tries to determine if they
contain data beyond the transport layer. If such data is
found, it is overwritten with zeroes before transmitting the
packets to the appropriate Echo client.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Echo
servers can handle multiple simultaneous clients running
multiple echo sessions in parallel. In order to determine
which packet needs to be echoed to which client and through
which session, the Echo server uses an heuristic algorithm.
Although we have taken every security measure that we could
think of to prevent that a client receives an echoed packet
that it did not generate, there is always a risk that our
algorithm makes a mistake and delivers a packet to the wrong
client. The &minus;&minus;safe&minus;payloads option is
useful for public echo servers or critical deployments where
that kind of mistake cannot be afforded.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following examples illustrate how Nping's Echo mode can be
used to discover intermediate devices.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Example&nbsp;2.&nbsp;Discovering
NAT devices</b></font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
<b>nping &minus;&minus;echo&minus;client &quot;public&quot;
echo.nmap.org &minus;&minus;udp</b></font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Starting
Nping ( http://nmap.org/nping ) <br>
SENT (1.0970s) UDP 10.1.20.128:53 &gt; 178.79.165.17:40125
ttl=64 id=32523 iplen=28 <br>
CAPT (1.1270s) UDP 80.38.10.21:45657 &gt;
178.79.165.17:40125 ttl=54 id=32523 iplen=28 <br>
RCVD (1.1570s) ICMP 178.79.165.17 &gt; 10.1.20.128 Port
unreachable (type=3/code=3) ttl=49 id=16619 iplen=56 <br>
[...] <br>
SENT (5.1020s) UDP 10.1.20.128:53 &gt; 178.79.165.17:40125
ttl=64 id=32523 iplen=28 <br>
CAPT (5.1335s) UDP 80.38.10.21:45657 &gt;
178.79.165.17:40125 ttl=54 id=32523 iplen=28 <br>
RCVD (5.1600s) ICMP 178.79.165.17 &gt; 10.1.20.128 Port
unreachable (type=3/code=3) ttl=49 id=16623
iplen=56</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Max
rtt: 60.628ms | Min rtt: 58.378ms | Avg rtt: 59.389ms <br>
Raw packets sent: 5 (140B) | Rcvd: 5 (280B) | Lost: 0
(0.00%)| Echoed: 5 (140B) <br>
Tx time: 4.00459s | Tx bytes/s: 34.96 | Tx pkts/s: 1.25 <br>
Rx time: 5.00629s | Rx bytes/s: 55.93 | Rx pkts/s: 1.00 <br>
Nping done: 1 IP address pinged in 6.18 seconds</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
output clearly shows the presence of a NAT device in the
client's local network. Note how the captured packet (CAPT)
differs from the SENT packet: the source address for the
original packets is in the reserved 10.0.0.0/8 range, while
the address seen by the server is 80.38.10.21, the Internet
side address of the NAT device. The source port was also
modified by the device. The line starting with RCVD
corresponds to the responses generated by the TCP/IP stack
of the machine where the Echo server is run.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Example&nbsp;3.&nbsp;Discovering
a transparent proxy</b></font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
<b>nping &minus;&minus;echo&minus;client &quot;public&quot;
echo.nmap.org &minus;&minus;tcp &minus;p80</b></font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Starting
Nping ( http://nmap.org/nping ) <br>
SENT (1.2160s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S
ttl=64 id=3317 iplen=40 seq=567704200 win=1480 <br>
RCVD (1.2180s) TCP 178.79.165.17:80 &gt; 10.0.1.77:41659 SA
ttl=128 id=13177 iplen=44 seq=3647106954 win=16384 &lt;mss
1460&gt; <br>
SENT (2.2150s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S
ttl=64 id=3317 iplen=40 seq=567704200 win=1480 <br>
SENT (3.2180s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S
ttl=64 id=3317 iplen=40 seq=567704200 win=1480 <br>
SENT (4.2190s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S
ttl=64 id=3317 iplen=40 seq=567704200 win=1480 <br>
SENT (5.2200s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S
ttl=64 id=3317 iplen=40 seq=567704200 win=1480</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Max
rtt: 2.062ms | Min rtt: 2.062ms | Avg rtt: 2.062ms <br>
Raw packets sent: 5 (200B) | Rcvd: 1 (46B) | Lost: 4
(80.00%)| Echoed: 0 (0B) <br>
Tx time: 4.00504s | Tx bytes/s: 49.94 | Tx pkts/s: 1.25 <br>
Rx time: 5.00618s | Rx bytes/s: 9.19 | Rx pkts/s: 0.20 <br>
Nping done: 1 IP address pinged in 6.39 seconds</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">In
this example, the output is a bit more tricky. The absence
of error messages shows that the Echo client has
successfully established an Echo session with the server.
However, no CAPT packets can be seen in the output. This
means that none of the transmitted packets reached the
server. Interestingly, a TCP SYN&minus;ACK packet was
received in response to the first TCP&minus;SYN packet (and
also, it is known that the target host does not have port 80
open). This behavior reveals the presence of a transparent
web proxy cache server (which in this case is an old MS ISA
server).</font></p>

<h2>TIMING AND PERFORMANCE OPTIONS
<a name="TIMING AND PERFORMANCE OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;delay</b>
<i>time</i> (Delay between probes) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option lets you control for how long will Nping wait before
sending the next probe. Like in many other ping tools, the
default delay is one second. <i>time</i> must be a positive
integer or floating point number. By default it is specified
in seconds, however you can give an explicit unit by
appending ms for milliseconds, s for seconds, m for minutes,
or h for hours (e.g. 2.5s, 45m, 2h).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;rate</b>
<i>rate</i> (Send probes at a given rate) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option specifies the number of probes that Nping should send
per second. This option and <b>&minus;&minus;delay</b> are
inverses; <b>&minus;&minus;rate 20</b> is the same as
<b>&minus;&minus;delay 0.05</b>. If both options are used,
only the last one in the parameter list counts.</font></p>

<h2>MISCELLANEOUS OPTIONS
<a name="MISCELLANEOUS OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;h</b>,
<b>&minus;&minus;help</b> (Display help) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Displays
help information and exits.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;V</b>,
<b>&minus;&minus;version</b> (Display version) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Displays
the program's version number and quits.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;c</b>
<i>rounds</i>, <b>&minus;&minus;count</b> <i>rounds</i>
(Stop after a given number of rounds) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option lets you specify the number of times that Nping
should loop over target hosts (and in some cases target
ports). Nping calls these &ldquo;rounds&rdquo;. In a basic
execution with only one target (and only one target port in
TCP/UDP modes), the number of rounds matches the number of
probes sent to the target host. However, in more complex
executions where Nping is run against multiple targets and
multiple ports, the number of rounds is the number of times
that Nping sends a complete set of probes that covers all
target IPs and all target ports. For example, if Nping is
asked to send TCP SYN packets to hosts 192.168.1.0&minus;255
and ports 80 and 433, then 256 &times; 2&nbsp;=&nbsp;512
packets are sent in one round. So if you specify <b>&minus;c
100</b>, Nping will loop over the different target hosts and
ports 100 times, sending a total of 256 &times; 2 &times;
100&nbsp;=&nbsp;51200 packets. By default Nping runs for 5
rounds. If a value of 0 is specified, Nping will run
continuously.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;e</b>
<i>name</i>, <b>&minus;&minus;interface</b> <i>name</i> (Set
the network interface to be used) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option tells Nping what interface should be used to send and
receive packets. Nping should be able to detect this
automatically, but it will tell you if it cannot.
<i>name</i> must be the name of an existing network
interface with an assigned IP address.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;privileged</b>
(Assume that the user is fully privileged) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Tells
Nping to simply assume that it is privileged enough to
perform raw socket sends, packet sniffing, and similar
operations that usually require special privileges. By
default Nping quits if such operations are requested by a
user that has no root or administrator privileges. This
option may be useful on Linux, BSD or similar systems that
can be configured to allow unprivileged users to perform
raw&minus;packet transmissions. The <b>NPING_PRIVILEGED</b>.
environment variable may be set as an alternative to using
<b>&minus;&minus;privileged</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;unprivileged</b>
(Assume that the user lacks raw socket privileges)
.</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option is the opposite of <b>&minus;&minus;privileged</b>.
It tells Nping to treat the user as lacking network raw
socket and sniffing privileges. This is useful for testing,
debugging, or when the raw network functionality of your
operating system is somehow broken. The
<b>NPING_UNPRIVILEGED</b>. environment variable may be set
as an alternative to using
<b>&minus;&minus;unprivileged</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;send&minus;eth</b>
(Use raw ethernet sending) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Asks
Nping to send packets at the raw ethernet (data link) layer
rather than the higher IP (network) layer. By default, Nping
chooses the one which is generally best for the platform it
is running on. Raw sockets (IP layer) are generally most
efficient for Unix machines, while ethernet frames are
required for Windows operation since Microsoft disabled raw
socket support. Nping still uses raw IP packets despite this
option when there is no other choice (such as
non&minus;ethernet connections).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;send&minus;ip</b>
(Send at raw IP level) .</font></p>

<p style="margin-left:17%;"><font color="#000000">Asks
Nping to send packets via raw IP sockets rather than sending
lower level ethernet frames. It is the complement to the
<b>&minus;&minus;send&minus;eth</b> option.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;bpf&minus;filter</b>
<i>filter spec</i> <b>&minus;&minus;filter</b> <i>filter
spec</i> (Set custom BPF filter) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option lets you use a custom BPF filter. By default Nping
chooses a filter that is intended to capture most common
responses to the particular probes that are sent. For
example, when sending TCP packets, the filter is set to
capture packets whose destination port matches the probe's
source port or ICMP error messages that may be generated by
the target or any intermediate device as a result of the
probe. If for some reason you expect strange packets in
response to sent probes or you just want to sniff a
particular kind of traffic, you can specify a custom filter
using the BPF syntax used by tools like tcpdump.. See the
documentation at</font>
<b><font color="#0000FF">http://www.tcpdump.org/</font></b>
<font color="#000000">for more information.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;H</b>,
<b>&minus;&minus;hide&minus;sent</b> (Do not display sent
packets) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option tells Nping not to print information about sent
packets. This can be useful when using very short
inter&minus;probe delays (i.e., when flooding), because
printing information to the standard output has a
computational cost and disabling it can probably speed
things up a bit. Also, it may be useful when using Nping to
detect active hosts or open ports (e.g. sending probes to
all TCP ports in a /24 subnet). In that case, users may not
want to see thousands of sent probes but just the replies
generated by active hosts.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;N</b>,
<b>&minus;&minus;no&minus;capture</b> (Do not attempt to
capture replies) .</font></p>

<p style="margin-left:17%;"><font color="#000000">This
option tells Nping to skip packet capture. This means that
packets in response to sent probes will not be processed or
displayed. This can be useful when doing flooding and
network stack stress tests. Note that when this option is
specified, most of the statistics shown at the end of the
execution will be useless. This option does not work with
TCP Connect mode.</font></p>

<h2>OUTPUT OPTIONS
<a name="OUTPUT OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;v[</b><i>level</i>],
<b>&minus;&minus;verbose [</b><i>level</i>] (Increase or set
verbosity level) .</font></p>


<p style="margin-left:17%;"><font color="#000000">Increases
the verbosity level, causing Nping to print more information
during its execution. There are 9 levels of verbosity
(&minus;4 to 4). Every instance of <b>&minus;v</b>
increments the verbosity level by one (from its default
value, level 0). Every instance of option <b>&minus;q</b>
decrements the verbosity level by one. Alternatively you can
specify the level directly, as in <b>&minus;v3</b> or
<b>&minus;v&minus;1</b>. These are the available
levels:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
&minus;4</font></p>

<p style="margin-left:23%;"><font color="#000000">No output
at all. In some circumstances you may not want Nping to
produce any output (like when one of your work mates is
watching over your shoulder). In that case level &minus;4
can be useful because although you won't see any response
packets, probes will still be sent.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
&minus;3</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level &minus;4 but displays fatal error messages so you can
actually see if Nping is running or it failed due to some
error.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
&minus;2</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level &minus;3 but also displays warnings and recoverable
errors.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
&minus;1</font></p>

<p style="margin-left:23%;"><font color="#000000">Displays
traditional run&minus;time information (version, start time,
statistics, etc.) but does not display sent or received
packets.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
0</font></p>

<p style="margin-left:23%;"><font color="#000000">This is
the default verbosity level. It behaves like level &minus;1
but also displays sent and received packets and some other
important information.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
1</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 0 but it displays detailed information about timing,
flags, protocol details, etc.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
2</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 1 but displays very detailed information about sent
and received packets and other interesting
information.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
3</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 2 but also displays the raw hexadecimal dump of sent
and received packets.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
4 and higher</font></p>

<p style="margin-left:23%;"><font color="#000000">Same as
level 3.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;q[</b><i>level</i>],
<b>&minus;&minus;reduce&minus;verbosity [</b><i>level</i>]
(Decrease verbosity level) .</font></p>


<p style="margin-left:17%;"><font color="#000000">Decreases
the verbosity level, causing Nping to print less information
during its execution.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;d[</b><i>level</i>]
(Increase or set debugging level) .</font></p>

<p style="margin-left:17%;"><font color="#000000">When even
verbose mode doesn't provide sufficient data for you,
debugging is available to flood you with much more! As with
the <b>&minus;v</b>, debugging is enabled with a
command&minus;line flag <b>&minus;d</b> and the debug level
can be increased by specifying it multiple times. There are
7 debugging levels (0 to 6). Every instance of
<b>&minus;d</b> increments debugging level by one. Provide
an argument to <b>&minus;d</b> to set the level directly;
for example <b>&minus;d4</b>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Debugging
output is useful when you suspect a bug in Nping, or if you
are simply confused as to what Nping is doing and why. As
this feature is mostly intended for developers, debug lines
aren't always self&minus;explanatory. You may get something
like</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">NSOCK
(1.0000s) Callback: TIMER SUCCESS for EID 12;
tcpconnect_event_handler(): Received callback of type TIMER
with status SUCCESS</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">If
you don't understand a line, your only recourses are to
ignore it, look it up in the source code, or request help
from the development list (nmap&minus;dev). Some lines are
self&minus;explanatory, but the messages become more obscure
as the debug level is increased. These are the available
levels:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
0</font></p>

<p style="margin-left:23%;"><font color="#000000">Level 0.
No debug information at all. This is the default
level.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
1</font></p>

<p style="margin-left:23%;"><font color="#000000">In this
level, only very important or high&minus;level debug
information will be printed.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
2</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 1 but also displays important or medium&minus;level
debug information</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
3</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 2 but also displays regular and low&minus;level debug
information.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
4</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 3 but also displays messages only a real Nping freak
would want to see.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
5</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 4 but it enables basic debug information related to
external libraries like Nsock..</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Level
6</font></p>

<p style="margin-left:23%;"><font color="#000000">Like
level 5 but it enables full, very detailed, debug
information related to external libraries like
Nsock.</font></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Like
its author, Nping isn't perfect. But you can help make it
better by sending bug reports or even writing patches. If
Nping doesn't behave the way you expect, first upgrade to
the latest Nmap version available from</font>
<b><font color="#0000FF">http://nmap.org/download.html</font></b><font color="#000000">.
If the problem persists, do some research to determine
whether it has already been discovered and addressed. Try
searching for the error message on our search page at</font>
<b><font color="#0000FF">http://insecure.org/search.html</font></b>
<font color="#000000">or at Google. Also try browsing the
nmap&minus;dev archives at</font>
<b><font color="#0000FF">http://seclists.org/</font></b><font color="#000000">.
Read this full manual page as well. If nothing comes out of
this, mail a bug report to &lt;dev@nmap.org&gt;. Please
include everything you have learned about the problem, as
well as what version of Nping you are running and what
operating system version it is running on. Problem reports
and Nping usage questions sent to &lt;dev@nmap.org&gt; are
far more likely to be answered than those sent to Fyodor
directly. If you subscribe to the nmap&minus;dev list before
posting, your message will bypass moderation and get through
more quickly. Subscribe at</font>
<b><font color="#0000FF">http://nmap.org/mailman/listinfo/dev</font></b><font color="#000000">.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Code
patches to fix bugs are even better than bug reports. Basic
instructions for creating patch files with your changes are
available at</font>
<b><font color="#0000FF">https://svn.nmap.org/nmap/HACKING</font></b><font color="#000000">.
Patches may be sent to nmap&minus;dev (recommended) or to
any of the authors listed in the next section
directly.</font></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Luis
MartinGarcia &lt;luis.mgarc@gmail.com&gt;
(</font><b><font color="#0000FF">http://aldabaknocking.com</font></b><font color="#000000">)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Fyodor
&lt;fyodor@nmap.org&gt;
(</font><b><font color="#0000FF">http://insecure.org</font></b><font color="#000000">)</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="2%"></td>
<td width="58%">


<p style="margin-top: 1em"><font color="#000000">official
type numbers assigned by IANA</font></p></td>
<td width="25%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://www.iana.org/assignments/icmp-parameters</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">2.</font></p> </td>
<td width="2%"></td>
<td width="51%">


<p style="margin-top: 1em"><font color="#000000">official
numbers assigned by IANA</font></p></td>
<td width="32%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://www.iana.org/assignments/arp-parameters/</font></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">3.</font></p> </td>
<td width="2%"></td>
<td width="54%">


<p style="margin-top: 1em"><font color="#000000">official
numbers listed by the IEEE</font></p></td>
<td width="29%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">http://standards.ieee.org/regauth/ethertype/eth.txt</font></p>
<hr>
</body>
</html>
