<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:01:12 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>ntpq</title>

</head>
<body>

<h1 align="center">ntpq</h1>

<a href="#NAME">NAME</a><br>
<a href="#&nbsp;">&nbsp;</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#INTERNAL COMMANDS">INTERNAL COMMANDS</a><br>
<a href="#CONTROL MESSAGE COMMANDS">CONTROL MESSAGE COMMANDS</a><br>
<a href="#STATUS WORDS AND KISS CODES">STATUS WORDS AND KISS CODES</a><br>
<a href="#SYSTEM VARIABLES">SYSTEM VARIABLES</a><br>
<a href="#PEER VARIABLES">PEER VARIABLES</a><br>
<a href="#CLOCK VARIABLES">CLOCK VARIABLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ntpq - standard
NTP query program</p>

<h2>&nbsp;
<a name="&nbsp;"></a>
</h2>


<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>ntpq
[-46dinp] [-c</b> <i>command</i><b>] [</b><i>host</i><b>]
[...]</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The <b>ntpq</b>
utility program is used to monitor NTP daemon <b>ntpd</b>
operations and determine performance. It uses the standard
NTP mode 6 control message formats defined in Appendix B of
the NTPv3 specification RFC1305. The same formats are used
in NTPv4, although some of the variable names have changed
and new ones added. The description on this page is for the
NTPv4 variables.</p>

<p style="margin-left:11%; margin-top: 1em">The program can
be run either in interactive mode or controlled using
command line arguments. Requests to read and write arbitrary
variables can be assembled, with raw and pretty-printed
output options being available. The <b>ntpq</b> can also
obtain and print a list of peers in a common format by
sending multiple queries to the server.</p>

<p style="margin-left:11%; margin-top: 1em">If one or more
request options is included on the command line when
<b>ntpq</b> is executed, each of the requests will be sent
to the NTP servers running on each of the hosts given as
command line arguments, or on localhost by default. If no
request options are given, <b>ntpq</b> will attempt to read
commands from the standard input and execute these on the
NTP server running on the first host given on the command
line, again defaulting to localhost when no other host is
specified. <b>ntpq</b> will prompt for commands if the
standard input is a terminal device.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ntpq</b>
uses NTP mode 6 packets to communicate with the NTP server,
and hence can be used to query any compatible server on the
network which permits it. Note that since NTP is a UDP
protocol this communication will be somewhat unreliable,
especially over large distances in terms of network
topology. <b>ntpq</b> makes one attempt to retransmit
requests, and will time requests out if the remote host is
not heard from within a suitable timeout time.</p>

<p style="margin-left:11%; margin-top: 1em">Note that in
contexts where a host name is expected, a <b>-4</b>
qualifier preceding the host name forces DNS resolution to
the IPv4 namespace, while a <b>-6</b> qualifier forces DNS
resolution to the IPv6 namespace.</p>

<p style="margin-left:11%; margin-top: 1em">For examples
and usage, see the NTP Debugging Techniques page.</p>

<p style="margin-left:11%; margin-top: 1em">Command line
options are described following. Specifying a command line
option other than <b>-i</b> or <b>-n</b> will cause the
specified query (queries) to be sent to the indicated
host(s) immediately. Otherwise, <b>ntpq</b> will attempt to
read interactive format commands from the standard
input.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-4</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>Force DNS resolution of following host names on the
command line to the IPv4 namespace.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-6</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>Force DNS resolution of following host names on the
command line to the IPv6 namespace.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-c</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>The following argument is interpreted as an interactive
format command and is added to the list of commands to be
executed on the specified host(s). Multiple <b>-c</b>
options may be given.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-d</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>Turn on debugging mode.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-i</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>Force <b>ntpq</b> to operate in interactive mode.
Prompts will be written to the standard output and commands
read from the standard input.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-n</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>Output all host addresses in dotted-quad numeric format
rather than converting to the canonical host names.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-p</b></p></td>
<td width="9%"></td>
<td width="77%">


<p>Print a list of the peers known to the server as well as
a summary of their state. This is equivalent to the
<b>peers</b> interactive command.</p></td></tr>
</table>

<h2>INTERNAL COMMANDS
<a name="INTERNAL COMMANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Interactive
format commands consist of a keyword followed by zero to
four arguments. Only enough characters of the full keyword
to uniquely identify the command need be typed. The output
of a command is normally sent to the standard output, but
optionally the output of individual commands may be sent to
a file by appending a <b>&gt;</b>, followed by a file name,
to the command line. A number of interactive format commands
are executed entirely within the <b>ntpq</b> program itself
and do not result in NTP mode-6 requests being sent to a
server. These are described following. <b><br>
? [</b><i>command_keyword</i><b>] <br>
help [</b><i>command_keyword</i><b>]</b></p>

<p style="margin-left:23%;">A <b>?</b> by itself will print
a list of all the command keywords known to <b>ntpq</b>. A
<b>?</b> followed by a command keyword will print function
and usage information about the command.</p>

<p style="margin-left:11%;"><b>addvars</b> <i>name</i> <b>[
=</b> <i>value</i><b>] [...] <br>
rmvars</b> <i>name</i> <b>[...] <br>
clearvars</b></p>

<p style="margin-left:23%;">The arguments to this command
consist of a list of items of the form <i>name</i> <b>=</b>
<i>value</i>, where the <b>=</b> <i>value</i> is ignored,
and can be omitted in read requests. <b>ntpq</b> maintains
an internal list in which data to be included in control
messages can be assembled, and sent using the
<b>readlist</b> and <b>writelist</b> commands described
below. The <b>addvars</b> command allows variables and
optional values to be added to the list. If more than one
variable is to be added, the list should be comma-separated
and not contain white space. The <b>rmvars</b> command can
be used to remove individual variables from the list, while
the <b>clearlist</b> command removes all variables from the
list.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>cooked</b></p></td>
<td width="3%"></td>
<td width="71%">


<p>Display server messages in prettyprint format.</p></td>
<td width="6%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>debug more | less |
off</b></p>

<p style="margin-left:23%;">Turns internal query program
debugging on and off.</p>

<p style="margin-left:11%;"><b>delay</b>
<i>milliseconds</i></p>

<p style="margin-left:23%;">Specify a time interval to be
added to timestamps included in requests which require
authentication. This is used to enable (unreliable) server
reconfiguration over long delay network paths or between
machines whose clocks are unsynchronized. Actually the
server does not now require timestamps in authenticated
requests, so this command may be obsolete.</p>

<p style="margin-left:11%;"><b>host</b> <i>name</i></p>

<p style="margin-left:23%;">Set the host to which future
queries will be sent. The name may be either a DNS name or a
numeric address.</p>

<p style="margin-left:11%;"><b>hostnames [yes | no]</b></p>

<p style="margin-left:23%;">If <b>yes</b> is specified,
host names are printed in information displays. If <b>no</b>
is specified, numeric addresses are printed instead. The
default is <b>yes</b>, unless modified using the command
line <b>-n</b> switch.</p>

<p style="margin-left:11%;"><b>keyid</b> <i>keyid</i></p>

<p style="margin-left:23%;">This command specifies the key
number to be used to authenticate configuration requests.
This must correspond to a key number the server has been
configured to use for this purpose.</p>

<p style="margin-left:11%;"><b>ntpversion 1 | 2 | 3 |
4</b></p>

<p style="margin-left:23%;">Sets the NTP version number
which <b>ntpq</b> claims in packets. Defaults to 2, Note
that mode-6 control messages (and modes, for that matter)
didn&rsquo;t exist in NTP version 1.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>passwd</b></p></td>
<td width="3%"></td>
<td width="77%">


<p>This command prompts for a password to authenticate
configuration requests. The password must correspond to the
key configured for NTP server for this purpose.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>quit</b></p></td>
<td width="3%"></td>
<td width="77%">


<p>Exit <b>ntpq</b>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>raw</b></p></td>
<td width="3%"></td>
<td width="77%">


<p>Display server messages as received and without
reformatting.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>timeout</b>
<i>milliseconds</i></p>

<p style="margin-left:23%;">Specify a timeout period for
responses to server queries. The default is about 5000
milliseconds. Note that since <b>ntpq</b> retries each query
once after a timeout, the total waiting time for a timeout
will be twice the timeout value set.</p>

<h2>CONTROL MESSAGE COMMANDS
<a name="CONTROL MESSAGE COMMANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Association IDs
are used to identify system, peer and clock variables.
System variables are assigned an association ID of zero and
system name space, while each association is assigned a
nonzero association ID and peer namespace. Most control
commands send a single mode-6 message to the server and
expect a single response message. The exceptions are the
<b>peers</b> command, which sends a series of messages, and
the <b>mreadlist</b> and <b>mreadvar</b> commands, which
iterate over a range of associations. <b><br>
associations</b></p>

<p style="margin-left:23%;">Display a list of mobilized
associations in the form <b>ind assid status conf reach auth
condition last_event cnt</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-174101.png" alt="Image grohtml-174101.png"></b></p>

<p style="margin-left:11%;"><b>clockvar</b> <i>assocID</i>
<b>[</b><i>name</i> <b>[ =</b> <i>value</i> <b>[...]] [...]
<br>
cv</b> <i>assocID</i> <b>[</b><i>name</i> <b>[ =</b>
<i>value</i> <b>[...] ][...]</b></p>

<p style="margin-left:23%;">Display a list of clock
variables for those assocations supporting a reference
clock.</p>

<p style="margin-left:11%;"><b>:config [...]</b></p>

<p style="margin-left:23%;">Send the remainder of the
command line, including whitespace, to the server as a
run-time configuration command in the same format as the
configuration file. This command is experimental until
further notice and clarification. Authentication is of
course required.</p>

<p style="margin-left:11%;"><b>config-from-file</b>
<i>filename</i></p>

<p style="margin-left:23%;">Send the each line of
<i>filename</i> to the server as run-time configuration
commands in the same format as the configuration file. This
command is experimental until further notice and
clarification. Authentication is of course required.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>keyid</b></p></td>
<td width="5%"></td>
<td width="69%">


<p>Specify the key ID to use for write requests.</p></td>
<td width="8%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>lassociations</b></p>

<p style="margin-left:23%;">Perform the same function as
the associations command, execept display mobilized and
unmobilized associations.</p>

<p style="margin-left:11%;"><b>mreadvar</b> <i>assocID
assocID</i> <b>[</b> <i>variable_name</i> <b>[ =</b>
<i>value</i><b>[ ... ] <br>
mrv</b> <i>assocID assocID</i> <b>[</b> <i>variable_name</i>
<b>[ =</b> <i>value</i><b>[ ... ]</b></p>

<p style="margin-left:23%;">Perform the same function as
the <b>readvar</b> command, except for a range of
association IDs. This range is determined from the
association list cached by the most recent
<b>associations</b> command.</p>

<p style="margin-left:11%;"><b>passociations</b></p>

<p style="margin-left:23%;">Perform the same function as
the <b>associations command</b>, except that it uses
previously stored data rather than making a new query.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>passwd</b></p></td>
<td width="3%"></td>
<td width="77%">


<p>Specify the password to use for write requests.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>peers</b></p></td>
<td width="3%"></td>
<td width="77%">


<p>Display a list of peers in the form <b>[tally]remote
refid st t when pool reach delay offset jitter</b></p></td></tr>
</table>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-174102.png" alt="Image grohtml-174102.png"></b></p>

<p style="margin-left:11%;"><b>readvar</b> <i>assocID
name</i> <b>[ =</b> <i>value</i> <b>] [,...] <br>
rv</b> <i>assocID</i> <b>[</b> <i>name</i> <b>]
[,...]</b></p>

<p style="margin-left:23%;">Display the specified
variables. If <i>assocID</i> is zero, the variables are from
the system variables name space, otherwise they are from the
peer variables name space. The <i>assocID</i> is required,
as the same name can occur in both spaces. If no <i>name</i>
is included, all operative variables in the name space are
displayed. In this case only, if the <i>assocID</i> is
omitted, it is assumed zero. Multiple names are specified
with comma separators and without whitespace. Note that time
values are represented in milliseconds and frequency values
in parts-per-million (PPM). Some NTP timestamps are
represented in the format YYYYMMDDTTTT, where YYYY is the
year, MM the month of year, DD the day of month and TTTT the
time of day.</p>

<p style="margin-left:11%;"><b>saveconfig</b>
<i>filename</i></p>

<p style="margin-left:23%;">Write the current
configuration, including any runtime modifications given
with <b>:config</b> or <b>config-from-file</b>, to the ntpd
host&rsquo;s file <i>filename</i>. This command will be
rejected by the server unless saveconfigdir appears in the
<b>ntpd</b> configuration file. <i>filename</i> can use
strftime() format specifiers to substitute the current date
and time, for example, <b>saveconfig
ntp-%Y%m%d-%H%M%S.conf</b>. The filename used is stored in
system variable <b>savedconfig</b>. Authentication is
required.</p>

<p style="margin-left:11%;"><b>writevar</b> <i>assocID
name</i> <b>=</b> <i>value</i> <b>[,...]</b></p>

<p style="margin-left:23%;">Write the specified variables.
If the <i>assocID</i> is zero, the variables are from the
system variables name space, otherwise they are from the
peer variables name space. The <i>assocID</i> is required,
as the same name can occur in both spaces.</p>

<h2>STATUS WORDS AND KISS CODES
<a name="STATUS WORDS AND KISS CODES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The current
state of the operating program is shown in a set of status
words maintained by the system and each association
separately. These words are displayed in the <b>rv</b> and
<b>as</b> commands both in hexadecimal and decoded short tip
strings. The codes, tips and short explanations are on the
Event Messages and Status Words page. The page also includes
a list of system and peer messages, the code for the latest
of which is included in the status word.</p>

<p style="margin-left:11%; margin-top: 1em">Information
resulting from protocol machine state transitions is
displayed using an informal set of ASCII strings called kiss
codes. The original purpose was for kiss-o&rsquo;-death
(KoD) packets sent by the server to advise the client of an
unusual condition. They are now displayed, when appropriate,
in the reference identifier field in various billboards.</p>

<h2>SYSTEM VARIABLES
<a name="SYSTEM VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
system variables appear in the <b>rv</b> billboard. Not all
variables are displayed in some configurations.</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-174103.png" alt="Image grohtml-174103.png"></p>

<p style="margin-left:11%;">The jitter and wander
statistics are exponentially-weighted RMS <br>
averages. The system jitter is defined in the NTPv4
specification; the <br>
clock jitter statistic is computed by the clock discipline
module. <br>
When the NTPv4 daemon is compiled with the OpenSSL software
library, <br>
additional system variables are displayed, including some or
all of the <br>
following, depending on the particular Autokey dance:</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-174104.png" alt="Image grohtml-174104.png"></p>

<h2>PEER VARIABLES
<a name="PEER VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
system variables apear in the <b>rv</b> billboard for each
association. Not all variables are displayed in some
configurations.</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-174105.png" alt="Image grohtml-174105.png"></p>

<p style="margin-left:11%;">The bias vaqriable is
calculated when the first broadcast packet is received after
the calibration volley. It represents the offset of the
broadcast subgraph relative to the unicast subgraph. The
xleave variable appears only the interleaved symmetric and
ingterleaved modes. It represents the internal queueing,
buffering and transmission delays for the preceeding
packet.</p>

<p style="margin-left:11%; margin-top: 1em">When the NTPv4
daemon is compiled with the OpenSSL software library,
additional peer variables are displayed, including the
following:</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-174106.png" alt="Image grohtml-174106.png"></p>

<h2>CLOCK VARIABLES
<a name="CLOCK VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
clock variables apear in the <b>cv</b> billboard for each
association with a reference clock. Not all variables are
displayed in some configurations.</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-174107.png" alt="Image grohtml-174107.png"></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ntp_decode(5),
ntpd(8), ntpdc(8)</p>

<p style="margin-left:11%; margin-top: 1em">The official
HTML documentation.</p>

<p style="margin-left:11%; margin-top: 1em">This file was
automatically generated from HTML source.</p>
<hr>
</body>
</html>
