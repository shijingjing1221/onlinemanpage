<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:50:52 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>virt-customize</title>

</head>
<body>

<h1 align="center">virt-customize</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#WARNING">WARNING</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#SELINUX">SELINUX</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#BUGS">BUGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">virt&minus;customize
&minus; Customize a virtual machine</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em"> virt&minus;customize
    [ &minus;a disk.img [ &minus;a disk.img ... ] | &minus;d domname ]
    [&minus;&minus;attach ISOFILE] [&minus;&minus;attach&minus;format FORMAT]
    [ &minus;c URI | &minus;&minus;connect URI ] [ &minus;n | &minus;&minus;dry&minus;run ]
    [ &minus;&minus;format FORMAT] [ &minus;m MB | &minus;&minus;memsize MB ]
    [ &minus;&minus;network | &minus;&minus;no&minus;network ]
    [ &minus;q | &minus;&minus;quiet ] [&minus;&minus;smp N] [ &minus;v | &minus;&minus;verbose ] [&minus;x]
    [&minus;&minus;chmod PERMISSIONS:FILE] [&minus;&minus;commands&minus;from&minus;file FILENAME]
    [&minus;&minus;copy SOURCE:DEST] [&minus;&minus;copy&minus;in LOCALPATH:REMOTEDIR]
    [&minus;&minus;delete PATH] [&minus;&minus;edit FILE:EXPR] [&minus;&minus;firstboot SCRIPT]
    [&minus;&minus;firstboot&minus;command 'CMD+ARGS'] [&minus;&minus;firstboot&minus;install PKG,PKG..]
    [&minus;&minus;hostname HOSTNAME] [&minus;&minus;install PKG,PKG..]
    [&minus;&minus;link TARGET:LINK[:LINK..]] [&minus;&minus;mkdir DIR] [&minus;&minus;move SOURCE:DEST]
    [&minus;&minus;password USER:SELECTOR] [&minus;&minus;root&minus;password SELECTOR]
    [&minus;&minus;run SCRIPT] [&minus;&minus;run&minus;command 'CMD+ARGS'] [&minus;&minus;scrub FILE]
    [&minus;&minus;sm&minus;attach SELECTOR] [&minus;&minus;sm&minus;register] [&minus;&minus;sm&minus;remove]
    [&minus;&minus;sm&minus;unregister] [&minus;&minus;ssh&minus;inject USER[:SELECTOR]] [&minus;&minus;truncate FILE]
    [&minus;&minus;truncate&minus;recursive PATH] [&minus;&minus;timezone TIMEZONE] [&minus;&minus;touch FILE]
    [&minus;&minus;uninstall PKG,PKG..] [&minus;&minus;update] [&minus;&minus;upload FILE:DEST]
    [&minus;&minus;write FILE:CONTENT] [&minus;&minus;no&minus;logfile]
    [&minus;&minus;password&minus;crypto md5|sha256|sha512] [&minus;&minus;selinux&minus;relabel]
    [&minus;&minus;sm&minus;credentials SELECTOR]
 virt&minus;customize [ &minus;V | &minus;&minus;version ]</pre>


<h2>WARNING
<a name="WARNING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Using
<tt>&quot;virt&minus;customize&quot;</tt> on live virtual
machines, or concurrently with other disk editing tools, can
be dangerous, potentially causing disk corruption. The
virtual machine must be shut down before you use this
command, and disk images must not be edited
concurrently.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Virt-customize
can customize a virtual machine (disk image) by installing
packages, editing configuration files, and so on.</p>

<p style="margin-left:11%; margin-top: 1em">Virt-customize
modifies the guest or disk image <i>in place</i>. The guest
must be shut down. If you want to preserve the existing
contents of the guest, <i>you must snapshot, copy or clone
the disk first</i>.</p>

<p style="margin-left:11%; margin-top: 1em">You do
<i>not</i> need to run virt-customize as root. In fact
we&rsquo;d generally recommend that you don&rsquo;t.</p>

<p style="margin-left:11%; margin-top: 1em">Related tools
include: <i>virt&minus;sysprep</i>(1) and
<i>virt&minus;builder</i>(1).</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;help</b></p>

<p style="margin-left:17%;">Display brief help.</p>

<p style="margin-left:11%;"><b>&minus;a</b> file <b><br>
&minus;&minus;add</b> file</p>

<p style="margin-left:17%;">Add <i>file</i> which should be
a disk image from a virtual machine.</p>

<p style="margin-left:17%; margin-top: 1em">The format of
the disk image is auto-detected. To override this and force
a particular format use the <i>&minus;&minus;format</i>
option.</p>

<p style="margin-left:11%;"><b>&minus;a</b>
<small>URI</small> <b><br>
&minus;&minus;add</b> <small>URI</small></p>

<p style="margin-left:17%;">Add a remote disk. The
<small>URI</small> format is compatible with guestfish. See
&quot; <small>ADDING REMOTE STORAGE&quot;</small> in
<i>guestfish</i>(1).</p>

<p style="margin-left:11%;"><b>&minus;&minus;attach</b>
<small>ISOFILE</small></p>

<p style="margin-left:17%;">The given disk is attached to
the libguestfs appliance. This is used to provide extra
software repositories or other data for customization.</p>

<p style="margin-left:17%; margin-top: 1em">You probably
want to ensure the volume(s) or filesystems in the attached
disks are labelled (or use an <small>ISO</small> volume
name) so that you can mount them by label in your
run-scripts:</p>

<pre style="margin-left:17%; margin-top: 1em"> mkdir /tmp/mount
 mount LABEL=EXTRA /tmp/mount</pre>


<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;attach</i> options, and the format
can be any disk format (not just an <small>ISO</small>
).</p>


<p style="margin-left:11%;"><b>&minus;&minus;attach&minus;format</b>
<small>FORMAT</small></p>

<p style="margin-left:17%;">Specify the disk format for the
next <i>&minus;&minus;attach</i> option. The
<tt>&quot;FORMAT&quot;</tt> is usually
<tt>&quot;raw&quot;</tt> or <tt>&quot;qcow2&quot;</tt>. Use
<tt>&quot;raw&quot;</tt> for ISOs.</p>

<p style="margin-left:11%;"><b>&minus;&minus;colors <br>
&minus;&minus;colours</b></p>

<p style="margin-left:17%;">Use <small>ANSI</small> colour
sequences to colourize messages. This is the default when
the output is a tty. If the output of the program is
redirected to a file, <small>ANSI</small> colour sequences
are disabled unless you use this option.</p>

<p style="margin-left:11%;"><b>&minus;c</b>
<small>URI</small> <b><br>
&minus;&minus;connect</b> <small>URI</small></p>

<p style="margin-left:17%;">If using libvirt, connect to
the given <i><small>URI</small></i> . If omitted, then we
connect to the default libvirt hypervisor.</p>

<p style="margin-left:17%; margin-top: 1em">If you specify
guest block devices directly (<i>&minus;a</i>), then libvirt
is not used at all.</p>

<p style="margin-left:11%;"><b>&minus;d</b> guest <b><br>
&minus;&minus;domain</b> guest</p>

<p style="margin-left:17%;">Add all the disks from the
named libvirt guest. Domain UUIDs can be used instead of
names.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;n</b></p></td>
<td width="86%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;dry&minus;run</b></p>

<p style="margin-left:17%;">Perform a read-only &quot;dry
run&quot; on the guest. This runs the sysprep operation, but
throws away any changes to the disk at the end.</p>

<p style="margin-left:11%;"><b>&minus;&minus;format</b>
raw|qcow2|.. <b><br>
&minus;&minus;format</b> auto</p>

<p style="margin-left:17%;">The default for the
<i>&minus;a</i> option is to auto-detect the format of the
disk image. Using this forces the disk format for
<i>&minus;a</i> options which follow on the command line.
Using <i>&minus;&minus;format auto</i> switches back to
auto-detection for subsequent <i>&minus;a</i> options.</p>

<p style="margin-left:17%; margin-top: 1em">For
example:</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;customize &minus;&minus;format raw &minus;a disk.img</pre>


<p style="margin-left:17%; margin-top: 1em">forces raw
format (no auto-detection) for <i>disk.img</i>.</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;customize &minus;&minus;format raw &minus;a disk.img &minus;&minus;format auto &minus;a another.img</pre>


<p style="margin-left:17%; margin-top: 1em">forces raw
format (no auto-detection) for <i>disk.img</i> and reverts
to auto-detection for <i>another.img</i>.</p>

<p style="margin-left:17%; margin-top: 1em">If you have
untrusted raw-format guest disk images, you should use this
option to specify the disk format. This avoids a possible
security problem with malicious guests (
<small>CVE&minus;2010&minus;3851</small> ).</p>

<p style="margin-left:11%;"><b>&minus;m</b>
<small>MB</small> <b><br>
&minus;&minus;memsize</b> <small>MB</small></p>

<p style="margin-left:17%;">Change the amount of memory
allocated to <i>&minus;&minus;run</i> scripts. Increase this
if you find that <i>&minus;&minus;run</i> scripts or the
<i>&minus;&minus;install</i> option are running out of
memory.</p>

<p style="margin-left:17%; margin-top: 1em">The default can
be found with this command:</p>

<pre style="margin-left:17%; margin-top: 1em"> guestfish get&minus;memsize</pre>


<p style="margin-left:11%;"><b>&minus;&minus;network <br>
&minus;&minus;no&minus;network</b></p>

<p style="margin-left:17%;">Enable or disable network
access from the guest during the installation.</p>

<p style="margin-left:17%; margin-top: 1em">Enabled is the
default. Use <i>&minus;&minus;no&minus;network</i> to
disable access.</p>

<p style="margin-left:17%; margin-top: 1em">The network
only allows outgoing connections and has other minor
limitations. See &quot; <small>NETWORK&quot;</small> in
<i>virt&minus;rescue</i>(1).</p>

<p style="margin-left:17%; margin-top: 1em">If you use
<i>&minus;&minus;no&minus;network</i> then certain other
options such as <i>&minus;&minus;install</i> will not
work.</p>

<p style="margin-left:17%; margin-top: 1em">This does not
affect whether the guest can access the network once it has
been booted, because that is controlled by your hypervisor
or cloud environment and has nothing to do with
virt-customize.</p>

<p style="margin-left:17%; margin-top: 1em">Generally
speaking you should <i>not</i> use
<i>&minus;&minus;no&minus;network</i>. But here are some
reasons why you might want to:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>1.</p></td>
<td width="3%"></td>
<td width="77%">


<p>Because the libguestfs backend that you are using
doesn&rsquo;t support the network. (See: &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3)).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>2.</p></td>
<td width="3%"></td>
<td width="77%">


<p>Any software you need to install comes from an attached
<small>ISO,</small> so you don&rsquo;t need the network.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>3.</p></td>
<td width="3%"></td>
<td width="77%">


<p>You don&rsquo;t want untrusted guest code trying to
access your host network when running virt-customize. This
is particularly an issue when you don&rsquo;t trust the
source of the operating system templates. (See &quot;
<small>SECURITY&quot;</small> below).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>4.</p></td>
<td width="3%"></td>
<td width="77%">


<p>You don&rsquo;t have a host network (eg. in
secure/restricted environments).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;q</b></p></td>
<td width="3%"></td>
<td width="77%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;&minus;quiet</b></p>

<p style="margin-left:17%;">Don&rsquo;t print log
messages.</p>

<p style="margin-left:17%; margin-top: 1em">To enable
detailed logging of individual file operations, use
<i>&minus;x</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;smp</b> N</p>

<p style="margin-left:17%;">Enable N &ge; 2 virtual CPUs
for <i>&minus;&minus;run</i> scripts to use.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;v</b></p></td>
<td width="86%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;verbose</b></p>

<p style="margin-left:17%;">Enable verbose messages for
debugging.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;V</b></p></td>
<td width="86%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;version</b></p>

<p style="margin-left:17%;">Display version number and
exit.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;x</b></p></td>
<td width="3%"></td>
<td width="60%">


<p>Enable tracing of libguestfs <small>API</small>
calls.</p> </td>
<td width="23%">
</td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>Customization
options <br>
&minus;&minus;chmod</b> <small>PERMISSIONS:FILE</small></p>

<p style="margin-left:17%;">Change the permissions of
<tt>&quot;FILE&quot;</tt> to
<tt>&quot;PERMISSIONS&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note</i>:
<tt>&quot;PERMISSIONS&quot;</tt> by default would be
decimal, unless you prefix it with <tt>0</tt> to get octal,
ie. use <tt>0700</tt> not <tt>700</tt>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;commands&minus;from&minus;file</b>
<small>FILENAME</small></p>

<p style="margin-left:17%;">Read the customize commands
from a file, one (and its arguments) each line.</p>

<p style="margin-left:17%; margin-top: 1em">Each line
contains a single customization command and its arguments,
for example:</p>

<pre style="margin-left:17%; margin-top: 1em"> delete /some/file
 install some&minus;package
 password some&minus;user:password:its&minus;new&minus;password</pre>


<p style="margin-left:17%; margin-top: 1em">Empty lines are
ignored, and lines starting with <tt>&quot;#&quot;</tt> are
comments and are ignored as well. Furthermore, arguments can
be spread across multiple lines, by adding a
<tt>&quot;\&quot;</tt> (continuation character) at the of a
line, for example</p>

<pre style="margin-left:17%; margin-top: 1em"> edit /some/file:\
   s/^OPT=.*/OPT=ok/</pre>


<p style="margin-left:17%; margin-top: 1em">The commands
are handled in the same order as they are in the file, as if
they were specified as <i>&minus;&minus;delete
/some/file</i> on the command line.</p>

<p style="margin-left:11%;"><b>&minus;&minus;copy</b>
<small>SOURCE:DEST</small></p>

<p style="margin-left:17%;">Copy files or directories
recursively inside the guest.</p>

<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>


<p style="margin-left:11%;"><b>&minus;&minus;copy&minus;in</b>
<small>LOCALPATH:REMOTEDIR</small></p>

<p style="margin-left:17%;">Copy local files or directories
recursively into the disk image, placing them in the
directory <tt>&quot;REMOTEDIR&quot;</tt> (which must
exist).</p>

<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>

<p style="margin-left:11%;"><b>&minus;&minus;delete</b>
<small>PATH</small></p>

<p style="margin-left:17%;">Delete a file from the guest.
Or delete a directory (and all its contents,
recursively).</p>

<p style="margin-left:17%; margin-top: 1em">You can use
shell glob characters in the specified path. Be careful to
escape glob characters from the host shell, if that is
required. For example:</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;customize &minus;&minus;delete '/var/log/*.log'.</pre>


<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;upload</i>, <i>&minus;&minus;scrub</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;edit</b>
<small>FILE:EXPR</small></p>

<p style="margin-left:17%;">Edit <tt>&quot;FILE&quot;</tt>
using the Perl expression <tt>&quot;EXPR&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Be careful to
properly quote the expression to prevent it from being
altered by the shell.</p>

<p style="margin-left:17%; margin-top: 1em">Note that this
option is only available when Perl 5 is installed.</p>

<p style="margin-left:17%; margin-top: 1em">See
&quot;NON-INTERACTIVE <small>EDITING&quot;</small> in
<i>virt&minus;edit</i>(1).</p>

<p style="margin-left:11%;"><b>&minus;&minus;firstboot</b>
<small>SCRIPT</small></p>

<p style="margin-left:17%;">Install
<tt>&quot;SCRIPT&quot;</tt> inside the guest, so that when
the guest first boots up, the script runs (as root, late in
the boot process).</p>

<p style="margin-left:17%; margin-top: 1em">The script is
automatically chmod +x after installation in the guest.</p>

<p style="margin-left:17%; margin-top: 1em">The alternative
version <i>&minus;&minus;firstboot&minus;command</i> is the
same, but it conveniently wraps the command up in a single
line script for you.</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;firstboot</i> options. They run in
the same order that they appear on the command line.</p>

<p style="margin-left:17%; margin-top: 1em">Please take a
look at &quot; <small>FIRST BOOT SCRIPTS&quot;</small> in
<i>virt&minus;builder</i>(1) for more information and
caveats about the first boot scripts.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;run</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;firstboot&minus;command</b>
&rsquo; <small>CMD+ARGS</small> &rsquo;</p>

<p style="margin-left:17%;">Run command (and arguments)
inside the guest when the guest first boots up (as root,
late in the boot process).</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;firstboot</i> options. They run in
the same order that they appear on the command line.</p>

<p style="margin-left:17%; margin-top: 1em">Please take a
look at &quot; <small>FIRST BOOT SCRIPTS&quot;</small> in
<i>virt&minus;builder</i>(1) for more information and
caveats about the first boot scripts.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;run</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;firstboot&minus;install</b>
<small>PKG,PKG..</small></p>

<p style="margin-left:17%;">Install the named packages (a
comma-separated list). These are installed when the guest
first boots using the guest&rsquo;s package manager (eg.
apt, yum, etc.) and the guest&rsquo;s network
connection.</p>

<p style="margin-left:17%; margin-top: 1em">For an overview
on the different ways to install packages, see &quot;
<small>INSTALLING PACKAGES&quot;</small> in
<i>virt&minus;builder</i>(1).</p>

<p style="margin-left:11%;"><b>&minus;&minus;hostname</b>
<small>HOSTNAME</small></p>

<p style="margin-left:17%;">Set the hostname of the guest
to <tt>&quot;HOSTNAME&quot;</tt>. You can use a dotted
hostname.domainname ( <small>FQDN</small> ) if you want.</p>

<p style="margin-left:11%;"><b>&minus;&minus;install</b>
<small>PKG,PKG..</small></p>

<p style="margin-left:17%;">Install the named packages (a
comma-separated list). These are installed during the image
build using the guest&rsquo;s package manager (eg. apt, yum,
etc.) and the host&rsquo;s network connection.</p>

<p style="margin-left:17%; margin-top: 1em">For an overview
on the different ways to install packages, see &quot;
<small>INSTALLING PACKAGES&quot;</small> in
<i>virt&minus;builder</i>(1).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;update</i>,
<i>&minus;&minus;uninstall</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;link</b>
TARGET:LINK[:LINK..]</p>

<p style="margin-left:17%;">Create symbolic link(s) in the
guest, starting at <tt>&quot;LINK&quot;</tt> and pointing at
<tt>&quot;TARGET&quot;</tt>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;mkdir</b>
<small>DIR</small></p>

<p style="margin-left:17%;">Create a directory in the
guest.</p>

<p style="margin-left:17%; margin-top: 1em">This uses
<tt>&quot;mkdir&nbsp;&minus;p&quot;</tt> so any intermediate
directories are created, and it also works if the directory
already exists.</p>

<p style="margin-left:11%;"><b>&minus;&minus;move</b>
<small>SOURCE:DEST</small></p>

<p style="margin-left:17%;">Move files or directories
inside the guest.</p>

<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>


<p style="margin-left:11%;"><b>&minus;&minus;no&minus;logfile</b></p>

<p style="margin-left:17%;">Scrub
<tt>&quot;builder.log&quot;</tt> (log file from build
commands) from the image after building is complete. If you
don&rsquo;t want to reveal precisely how the image was
built, use this option.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
&quot; <small>LOG FILE&quot;</small> .</p>

<p style="margin-left:11%;"><b>&minus;&minus;password</b>
<small>USER:SELECTOR</small></p>

<p style="margin-left:17%;">Set the password for
<tt>&quot;USER&quot;</tt>. (Note this option does <i>not</i>
create the user account).</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>USERS AND PASSWORDS&quot;</small> in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field, and also how to set up
user accounts.</p>


<p style="margin-left:11%;"><b>&minus;&minus;password&minus;crypto</b>
md5|sha256|sha512</p>

<p style="margin-left:17%;">When the virt tools change or
set a password in the guest, this option sets the password
encryption of that password to <tt>&quot;md5&quot;</tt>,
<tt>&quot;sha256&quot;</tt> or
<tt>&quot;sha512&quot;</tt>.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;sha256&quot;</tt>
and <tt>&quot;sha512&quot;</tt> require glibc &ge; 2.7
(check <i>crypt</i>(3) inside the guest).</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;md5&quot;</tt>
will work with relatively old Linux guests (eg. <small>RHEL
3</small> ), but is not secure against modern attacks.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
<tt>&quot;sha512&quot;</tt> unless libguestfs detects an old
guest that didn&rsquo;t have support for
<small>SHA&minus;512,</small> in which case it will use
<tt>&quot;md5&quot;</tt>. You can override libguestfs by
specifying this option.</p>

<p style="margin-left:17%; margin-top: 1em">Note this does
not change the default password encryption used by the guest
when you create new user accounts inside the guest. If you
want to do that, then you should use the
<i>&minus;&minus;edit</i> option to modify
<tt>&quot;/etc/sysconfig/authconfig&quot;</tt> (Fedora,
<small>RHEL</small> ) or
<tt>&quot;/etc/pam.d/common&minus;password&quot;</tt>
(Debian, Ubuntu).</p>


<p style="margin-left:11%;"><b>&minus;&minus;root&minus;password</b>
<small>SELECTOR</small></p>

<p style="margin-left:17%;">Set the root password.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>USERS AND PASSWORDS&quot;</small> in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field, and also how to set up
user accounts.</p>

<p style="margin-left:17%; margin-top: 1em">Note: In
virt-builder, if you <i>don&rsquo;t</i> set
<i>&minus;&minus;root&minus;password</i> then the guest is
given a <i>random</i> root password.</p>

<p style="margin-left:11%;"><b>&minus;&minus;run</b>
<small>SCRIPT</small></p>

<p style="margin-left:17%;">Run the shell script (or any
program) called <tt>&quot;SCRIPT&quot;</tt> on the disk
image. The script runs virtualized inside a small appliance,
chrooted into the guest filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">The script is
automatically chmod +x.</p>

<p style="margin-left:17%; margin-top: 1em">If libguestfs
supports it then a limited network connection is available
but it only allows outgoing network connections. You can
also attach data disks (eg. <small>ISO</small> files) as
another way to provide data (eg. software packages) to the
script without needing a network connection
(<i>&minus;&minus;attach</i>). You can also upload data
files (<i>&minus;&minus;upload</i>).</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;run</i> options. They run in the
same order that they appear on the command line.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;firstboot</i>, <i>&minus;&minus;attach</i>,
<i>&minus;&minus;upload</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;run&minus;command</b>
&rsquo; <small>CMD+ARGS</small> &rsquo;</p>

<p style="margin-left:17%;">Run the command and arguments
on the disk image. The command runs virtualized inside a
small appliance, chrooted into the guest filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">If libguestfs
supports it then a limited network connection is available
but it only allows outgoing network connections. You can
also attach data disks (eg. <small>ISO</small> files) as
another way to provide data (eg. software packages) to the
script without needing a network connection
(<i>&minus;&minus;attach</i>). You can also upload data
files (<i>&minus;&minus;upload</i>).</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;run&minus;command</i> options.
They run in the same order that they appear on the command
line.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;firstboot</i>, <i>&minus;&minus;attach</i>,
<i>&minus;&minus;upload</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;scrub</b>
<small>FILE</small></p>

<p style="margin-left:17%;">Scrub a file from the guest.
This is like <i>&minus;&minus;delete</i> except that:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>It scrubs the data so a guest could not recover it.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>It cannot delete directories, only regular files.</p></td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;selinux&minus;relabel</b></p>

<p style="margin-left:17%;">Relabel files in the guest so
that they have the correct SELinux label.</p>

<p style="margin-left:17%; margin-top: 1em">This will
attempt to relabel files immediately, but if the operation
fails this will instead touch <i>/.autorelabel</i> on the
image to schedule a relabel operation for the next time the
image boots.</p>

<p style="margin-left:17%; margin-top: 1em">You should only
use this option for guests which support SELinux.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;attach</b>
<small>SELECTOR</small></p>

<p style="margin-left:17%;">Attach to a pool using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See
&quot;SUBSCRIPTION-MANAGER&quot; in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;credentials</b>
<small>SELECTOR</small></p>

<p style="margin-left:17%;">Set the credentials for
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See
&quot;SUBSCRIPTION-MANAGER&quot; in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;register</b></p>

<p style="margin-left:17%;">Register the guest using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This requires
credentials being set using
<i>&minus;&minus;sm&minus;credentials</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;remove</b></p>

<p style="margin-left:17%;">Remove all the subscriptions
from the guest using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;unregister</b></p>

<p style="margin-left:17%;">Unregister the guest using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ssh&minus;inject</b>
USER[:SELECTOR]</p>

<p style="margin-left:17%;">Inject an ssh key so the given
<tt>&quot;USER&quot;</tt> will be able to log in over ssh
without supplying a password. The <tt>&quot;USER&quot;</tt>
must exist already in the guest.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>SSH KEYS&quot;</small> in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field.</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;ssh&minus;inject</i> options, for
different users and also for more keys for each user.</p>

<p style="margin-left:11%;"><b>&minus;&minus;timezone</b>
<small>TIMEZONE</small></p>

<p style="margin-left:17%;">Set the default timezone of the
guest to <tt>&quot;TIMEZONE&quot;</tt>. Use a location
string like <tt>&quot;Europe/London&quot;</tt></p>

<p style="margin-left:11%;"><b>&minus;&minus;touch</b>
<small>FILE</small></p>

<p style="margin-left:17%;">This command performs a
<i>touch</i>(1)&minus;like operation on
<tt>&quot;FILE&quot;</tt>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;truncate</b>
<small>FILE</small></p>

<p style="margin-left:17%;">This command truncates
<tt>&quot;FILE&quot;</tt> to a zero-length file. The file
must exist already.</p>


<p style="margin-left:11%;"><b>&minus;&minus;truncate&minus;recursive</b>
<small>PATH</small></p>

<p style="margin-left:17%;">This command recursively
truncates all files under <tt>&quot;PATH&quot;</tt> to
zero-length.</p>

<p style="margin-left:11%;"><b>&minus;&minus;uninstall</b>
<small>PKG,PKG..</small></p>

<p style="margin-left:17%;">Uninstall the named packages (a
comma-separated list). These are removed during the image
build using the guest&rsquo;s package manager (eg. apt, yum,
etc.). Dependent packages may also need to be uninstalled to
satisfy the request.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;install</i>,
<i>&minus;&minus;update</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;update</b></p>

<p style="margin-left:17%;">Do the equivalent of
<tt>&quot;yum update&quot;</tt>, <tt>&quot;apt&minus;get
upgrade&quot;</tt>, or whatever command is required to
update the packages already installed in the template to
their latest versions.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;install</i>,
<i>&minus;&minus;uninstall</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;upload</b>
<small>FILE:DEST</small></p>

<p style="margin-left:17%;">Upload local file
<tt>&quot;FILE&quot;</tt> to destination
<tt>&quot;DEST&quot;</tt> in the disk image. File owner and
permissions from the original are preserved, so you should
set them to what you want them to be in the disk image.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;DEST&quot;</tt>
could be the final filename. This can be used to rename the
file on upload.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>&quot;DEST&quot;</tt> is a directory name (which must
already exist in the guest) then the file is uploaded into
that directory, and it keeps the same name as on the local
filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;mkdir</i>, <i>&minus;&minus;delete</i>,
<i>&minus;&minus;scrub</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;write</b>
<small>FILE:CONTENT</small></p>

<p style="margin-left:17%;">Write
<tt>&quot;CONTENT&quot;</tt> to
<tt>&quot;FILE&quot;</tt>.</p>

<h2>SELINUX
<a name="SELINUX"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For guests
which make use of SELinux, special handling for them might
be needed when using operations which create new files or
alter existing ones.</p>

<p style="margin-left:11%; margin-top: 1em">For further
details, see &quot; <small>SELINUX&quot;</small> in
<i>virt&minus;builder</i>(1).</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This program
returns 0 on success, or 1 if there was an error.</p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">&quot;VIRT_TOOLS_DATA_DIR&quot;</p>

<p style="margin-left:17%;">This can point to the directory
containing data files used for Windows firstboot
installation.</p>

<p style="margin-left:17%; margin-top: 1em">Normally you do
not need to set this. If not set, a compiled-in default will
be used (something like
<i>/usr/share/virt&minus;tools</i>).</p>

<p style="margin-left:17%; margin-top: 1em">This directory
may contain the following files: <i><br>
rhsrvany.exe</i></p>

<p style="margin-left:23%;">This is the RHSrvAny Windows
binary, used to install a &quot;firstboot&quot; script in
Windows guests. It is required if you intend to use the
<i>&minus;&minus;firstboot</i> or
<i>&minus;&minus;firstboot&minus;command</i> options with
Windows guests.</p>

<p style="margin-left:23%; margin-top: 1em">See also:
<tt>&quot;https://github.com/rwmjones/rhsrvany&quot;</tt></p>

<p style="margin-left:11%; margin-top: 1em">For other
environment variables, see &quot; <small>ENVIRONMENT
VARIABLES&quot;</small> in <i>guestfs</i>(3).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>guestfs</i>(3),
<i>guestfish</i>(1), <i>virt&minus;builder</i>(1),
<i>virt&minus;clone</i>(1), <i>virt&minus;rescue</i>(1),
<i>virt&minus;resize</i>(1), <i>virt&minus;sparsify</i>(1),
<i>virt&minus;sysprep</i>(1), <i>virsh</i>(1),
<i>lvcreate</i>(8), <i>qemu&minus;img</i>(1),
<i>scrub</i>(1), http://libguestfs.org/,
http://libvirt.org/.</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Richard W.M.
Jones http://people.redhat.com/~rjones/</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2011&minus;2016 Red Hat Inc.</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This program is
free software; you can redistribute it and/or modify it
under the terms of the <small>GNU</small> General Public
License as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later
version.</p>

<p style="margin-left:11%; margin-top: 1em">This program is
distributed in the hope that it will be useful, but
<small>WITHOUT ANY WARRANTY</small> ; without even the
implied warranty of <small>MERCHANTABILITY</small> or
<small>FITNESS FOR A PARTICULAR PURPOSE.</small> See the
<small>GNU</small> General Public License for more
details.</p>

<p style="margin-left:11%; margin-top: 1em">You should have
received a copy of the <small>GNU</small> General Public
License along with this program; if not, write to the Free
Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
Boston, <small>MA 02110&minus;1301 USA.</small></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To get a list
of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p style="margin-left:11%; margin-top: 1em">To report a new
bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p style="margin-left:11%; margin-top: 1em">When reporting
a bug, please supply:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The version of libguestfs.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Where you got libguestfs (eg. which Linux distro,
compiled from source, etc)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Describe the bug accurately and give a way to reproduce
it.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Run <i>libguestfs&minus;test&minus;tool</i>(1) and paste
the <b>complete, unedited</b> output into the bug
report.</p> </td></tr>
 </table>
<hr>
</body>
</html>
