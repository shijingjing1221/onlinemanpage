<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:23:20 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>sepolicy-generate</title>

</head>
<body>

<h1 align="center">sepolicy-generate</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">sepolicy-generate
&minus; Generate an initial SELinux policy module
template.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Common
options</p>

<p style="margin-left:11%; margin-top: 1em"><b>sepolicy
generate [&minus;h ] [&minus;p PATH]</b></p>

<p style="margin-left:11%; margin-top: 1em">Confined
Applications</p>

<p style="margin-left:11%; margin-top: 1em"><b>sepolicy
generate &minus;&minus;application [&minus;n NAME] [&minus;u
USER ]command [&minus;w WRITE_PATH ] <br>
sepolicy generate &minus;&minus;cgi [&minus;n NAME] command
[&minus;w WRITE_PATH ] <br>
sepolicy generate &minus;&minus;dbus [&minus;n NAME] command
[&minus;w WRITE_PATH ] <br>
sepolicy generate &minus;&minus;inetd [&minus;n NAME]
command [&minus;w WRITE_PATH ] <br>
sepolicy generate &minus;&minus;init [&minus;n NAME] command
[&minus;w WRITE_PATH ]</b></p>

<p style="margin-left:11%; margin-top: 1em">Confined
Users</p>

<p style="margin-left:11%; margin-top: 1em"><b>sepolicy
generate &minus;&minus;admin_user [&minus;r TRANSITION_ROLE]
&minus;n NAME <br>
sepolicy generate &minus;&minus;confined_admin &minus;n NAME
[&minus;a ADMIN_DOMAIN] [&minus;u USER] [&minus;n NAME]
[&minus;w WRITE_PATH] <br>
sepolicy generate &minus;&minus;desktop_user &minus;n NAME
[&minus;w WRITE_PATH] <br>
sepolicy generate &minus;&minus;term_user &minus;n NAME
[&minus;w WRITE_PATH] <br>
sepolicy generate &minus;&minus;x_user &minus;n NAME
[&minus;w WRITE_PATH]</b></p>

<p style="margin-left:11%; margin-top: 1em">Miscellaneous
Policy</p>

<p style="margin-left:11%; margin-top: 1em"><b>sepolicy
generate &minus;&minus;customize &minus;d DOMAIN &minus;n
NAME [&minus;a ADMIN_DOMAIN] <br>
sepolicy generate &minus;&minus;newtype &minus;t type
&minus;n NAME <br>
sepolicy generate &minus;&minus;sandbox &minus;n
NAME</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Use <b>sepolicy
generate</b> to generate an SELinux policy Module.</p>

<p style="margin-left:11%; margin-top: 1em"><b>sepolicy
generate</b> will create 5 files.</p>

<p style="margin-left:11%; margin-top: 1em">When specifying
a <b>confined application</b> you must specify a path.
<b>sepolicy generate</b> will use the rpm payload of the
application along with <b>nm &minus;D APPLICATION</b> to
help it generate types and policy rules for your policy
files.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Type
Enforcing File NAME.te</b> <br>
This file can be used to define all the types rules for a
particular domain.</p>

<p style="margin-left:11%; margin-top: 1em"><i>Note:</i>
Policy generated by <b>sepolicy generate</b> will
automatically add a permissive DOMAIN to your te file. When
you are satisfied that your policy works, you need to remove
the permissive line from the te file to run your domain in
enforcing mode.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Interface
File NAME.if</b> <br>
This file defines the interfaces for the types generated in
the te file, which can be used by other policy domains.</p>

<p style="margin-left:11%; margin-top: 1em"><b>File Context
NAME.fc</b> <br>
This file defines the default file context for the system,
it takes the file types created in the te file and
associates file paths to the types. Tools like restorecon
and RPM will use these paths to put down labels.</p>

<p style="margin-left:11%; margin-top: 1em"><b>RPM Spec
File NAME_selinux.spec</b> <br>
This file is an RPM SPEC file that can be used to install
the SELinux policy on to machines and setup the labeling.
The spec file also installs the interface file and a man
page describing the policy. You can use <b>sepolicy manpage
&minus;d NAME</b> to generate the man page.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Shell File
NAME.sh</b> <br>
This is a helper shell script to compile, install and fix
the labeling on your test system. It will also generate a
man page based on the installed policy, and compile and
build an RPM suitable to be installed on other machines</p>

<p style="margin-left:11%; margin-top: 1em">If a generate
is possible, this tool will print out all generate paths
from the source domain to the target domain</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>&minus;h,
&minus;&minus;help</i></p>

<p style="margin-left:22%;">Display help message</p>

<p style="margin-left:11%;"><i>&minus;d,
&minus;&minus;domain</i></p>

<p style="margin-left:22%;">Enter domain type(s) which you
will be extending</p>

<p style="margin-left:11%;"><i>&minus;n,
&minus;&minus;name</i></p>

<p style="margin-left:22%;">Specify alternate name of
policy. The policy will default to the executable or name
specified</p>

<p style="margin-left:11%;"><i>&minus;p,
&minus;&minus;path</i></p>

<p style="margin-left:22%;">Specify the directory to store
the created policy files. (Default to current working
directory ) optional arguments:</p>

<p style="margin-left:11%;"><i>&minus;r,
&minus;&minus;role</i></p>

<p style="margin-left:22%;">Enter role(s) to which this
admin user will transition.</p>

<p style="margin-left:11%;"><i>&minus;t,
&minus;&minus;type</i></p>

<p style="margin-left:22%;">Enter type(s) for which you
will generate new definition and rule(s)</p>

<p style="margin-left:11%;"><i>&minus;u,
&minus;&minus;user</i></p>

<p style="margin-left:22%;">SELinux user(s) which will
transition to this domain</p>

<p style="margin-left:11%;"><i>&minus;w,
&minus;&minus;writepath</i></p>

<p style="margin-left:22%;">Path(s) which the confined
processes need to write</p>

<p style="margin-left:11%;"><i>&minus;a,
&minus;&minus;admin</i></p>

<p style="margin-left:22%;">Domain(s) which the confined
admin will administrate</p>


<p style="margin-left:11%;"><i>&minus;&minus;admin_user</i></p>

<p style="margin-left:22%;">Generate Policy for
Administrator Login User Role</p>


<p style="margin-left:11%;"><i>&minus;&minus;application</i></p>

<p style="margin-left:22%;">Generate Policy for User
Application</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><i>&minus;&minus;cgi</i></p></td>
<td width="4%"></td>
<td width="73%">


<p>Generate Policy for Web Application/Script (CGI)</p></td>
<td width="5%">
</td></tr>
</table>


<p style="margin-left:11%;"><i>&minus;&minus;confined_admin</i></p>

<p style="margin-left:22%;">Generate Policy for Confined
Root Administrator Role</p>


<p style="margin-left:11%;"><i>&minus;&minus;customize</i></p>

<p style="margin-left:22%;">Generate Policy for Existing
Domain Type</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>&minus;&minus;dbus</i></p></td>
<td width="2%"></td>
<td width="58%">


<p>Generate Policy for DBUS System Daemon</p></td>
<td width="20%">
</td></tr>
</table>


<p style="margin-left:11%;"><i>&minus;&minus;desktop_user</i></p>

<p style="margin-left:22%;">Generate Policy for Desktop
Login User Role</p>

<p style="margin-left:11%;"><i>&minus;&minus;inetd</i></p>

<p style="margin-left:22%;">Generate Policy for Internet
Services Daemon</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>&minus;&minus;init</i></p></td>
<td width="2%"></td>
<td width="76%">


<p>Generate Policy for Standard Init Daemon (Default)</p></td>
<td width="2%">
</td></tr>
</table>


<p style="margin-left:11%;"><i>&minus;&minus;newtype</i></p>

<p style="margin-left:22%;">Generate new policy for new
types to add to an existing policy.</p>


<p style="margin-left:11%;"><i>&minus;&minus;sandbox</i></p>

<p style="margin-left:22%;">Generate Policy for Sandbox</p>


<p style="margin-left:11%;"><i>&minus;&minus;term_user</i></p>

<p style="margin-left:22%;">Generate Policy for Minimal
Terminal Login User Role</p>


<p style="margin-left:11%;"><i>&minus;&minus;x_user</i></p>

<p style="margin-left:22%;">Generate Policy for Minimal X
Windows Login User Role</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>&gt;
sepolicy generate --init /usr/sbin/rwhod</b> <br>
Generating Policy for /usr/sbin/rwhod named rwhod <br>
Created the following files: <br>
rwhod.te # Type Enforcement file <br>
rwhod.if # Interface file <br>
rwhod.fc # File Contexts file <br>
rwhod_selinux.spec # Spec file <br>
rwhod.sh # Setup Script</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This man page
was written by Daniel Walsh &lt;dwalsh@redhat.com&gt;</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">sepolicy(8),
selinux(8)</p>
<hr>
</body>
</html>
