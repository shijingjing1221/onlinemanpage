<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:01:48 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>opaportconfig</title>

</head>
<body>

<h1 align="center">opaportconfig</h1>

<a href="#NAME">NAME</a><br>
<a href="#Syntax">Syntax</a><br>
<a href="#Options">Options</a><br>
<a href="#Configuration Options">Configuration Options</a><br>
<a href="#-h and -p options permit a variety of selections:">-h and -p options permit a variety of selections:</a><br>
<a href="#Debug Options">Debug Options</a><br>
<a href="#Examples">Examples</a><br>
<a href="#Description">Description</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">opaportconfig</p>

<p style="margin-left:11%; margin-top: 1em"><b>(Host or
Switch)</b> Controls the configuration and state of a
specified Intel(R) Omni-Path Host Fabric Interface (HFI)
port on the local host or a remote switch.</p>

<h2>Syntax
<a name="Syntax"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">opaportconfig
[-l <i>lid</i>[-m <i>dest_port</i>]] [-h <i>hfi</i>] [-p
<i>port</i>] [-r <i>secs</i>] [-z] <br>
[-S <i>state</i>] [-P <i>physstate</i>] [-s <i>speed</i>]
[-w <i>width</i>] [-c <i>LTPCRC</i>] [-K <i>mkey</i>] <br>
[-v] [-x] [-L <i>lid</i>] [#8217lt; <i>sub
command</i>&gt;]</p>

<h2>Options
<a name="Options"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em">-l <i>lid</i></p></td>
<td width="6%"></td>
<td width="60%">


<p style="margin-top: 1em">Destination LID. Default is
local port.</p></td>
<td width="14%">
</td></tr>
</table>

<p style="margin-left:11%;">-m <i>dest_port</i></p>

<p style="margin-left:26%;">Destination port. Default is
port with given LID. Used to access switch ports.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p>-h <i>hfi</i></p></td>
<td width="4%"></td>
<td width="72%">


<p>HFI to send through/to. Default is first HFI.</p></td>
<td width="2%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p>-p <i>port</i></p></td>
<td width="4%"></td>
<td width="72%">


<p>Port to send through/to. Default is first port.</p></td>
<td width="2%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p>-K <i>mkey</i></p></td>
<td width="4%"></td>
<td width="72%">


<p>SM management key to access remote ports.</p></td>
<td width="2%">
</td></tr>
</table>

<p style="margin-left:11%;"><i>sub command</i></p>

<p style="margin-left:26%;">One of the following
choices:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="26%"></td>
<td width="11%">


<p style="margin-top: 1em">enable</p></td>
<td width="5%"></td>
<td width="21%">


<p style="margin-top: 1em">Enables port.</p></td>
<td width="37%">
</td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="11%">


<p>disable</p></td>
<td width="5%"></td>
<td width="21%">


<p>Disables port.</p></td>
<td width="37%">
</td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="11%">


<p>bounce</p></td>
<td width="5%"></td>
<td width="21%">


<p>Bounces port.</p></td>
<td width="37%">
</td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em"><b>NOTE:</b>
Bouncing remote ports may cause timeouts.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="26%"></td>
<td width="9%">


<p style="margin-top: 1em">ledon</p></td>
<td width="7%"></td>
<td width="29%">


<p style="margin-top: 1em">Turns port LED on.</p></td>
<td width="29%">
</td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="9%">


<p>ledoff</p></td>
<td width="7%"></td>
<td width="29%">


<p>Turns port LED off.</p></td>
<td width="29%">
</td></tr>
</table>

<h2>Configuration Options
<a name="Configuration Options"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p style="margin-top: 1em">-r <i>secs</i></p></td>
<td width="3%"></td>
<td width="74%">


<p style="margin-top: 1em">Repeats to keep the port down
for the specified amount of seconds.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p>-S <i>state</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>New state. Default is 0.</p></td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">0</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%"></td>
<td width="14%"></td>
<td width="13%">


<p style="margin-top: 1em">No-op.</p></td>
<td width="45%">
</td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>1</p></td>
<td width="14%"></td>
<td width="13%">


<p>Down.</p></td>
<td width="45%">
</td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>2</p></td>
<td width="14%"></td>
<td width="13%">


<p>Initiate.</p></td>
<td width="45%">
</td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>3</p></td>
<td width="14%"></td>
<td width="13%">


<p>Armed.</p></td>
<td width="45%">
</td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>4</p></td>
<td width="14%"></td>
<td width="13%">


<p>Active.</p></td>
<td width="45%">
</td></tr>
</table>

<p style="margin-left:11%;">-P <i>physstate</i></p>

<p style="margin-left:26%;">New physical state. Default is
0.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="49%">


<p><b>NOTE:</b> All transitions are valid.</p></td>
<td width="40%">
</td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">0</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%"></td>
<td width="1%"></td>
<td width="74%">


<p style="margin-top: 1em">No-op.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p>2</p></td>
<td width="1%"></td>
<td width="74%">


<p>Polling.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p>3</p></td>
<td width="1%"></td>
<td width="74%">


<p>Disabled.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p>11</p></td>
<td width="1%"></td>
<td width="74%">


<p>Phy-Test. Current physstate must be disabled.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p>-s <i>speed</i></p></td>
<td width="1%"></td>
<td width="74%">


<p>New link speeds enabled. Default is 0. To enable
multiple speeds, use the sum of the desired speeds.</p></td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">0</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%"></td>
<td width="14%"></td>
<td width="26%">


<p style="margin-top: 1em">No-op.</p></td>
<td width="32%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p>2</p></td>
<td width="14%"></td>
<td width="26%">


<p>0x0002 - 25 Gb/s.</p></td>
<td width="32%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p>-w <i>width</i></p></td>
<td width="14%"></td>
<td width="26%"></td>
<td width="32%">
</td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">New link widths
enabled. Default is 0. To enable multiple widths, use sum of
desired widths.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p style="margin-top: 1em">0</p></td>
<td width="14%"></td>
<td width="15%">


<p style="margin-top: 1em">No-op.</p></td>
<td width="43%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p>1</p></td>
<td width="14%"></td>
<td width="15%">


<p>0x01 - 1x.</p></td>
<td width="43%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p>2</p></td>
<td width="14%"></td>
<td width="15%">


<p>0x02 - 2x.</p></td>
<td width="43%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p>4</p></td>
<td width="14%"></td>
<td width="15%">


<p>0x04 - 3x.</p></td>
<td width="43%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p>8</p></td>
<td width="14%"></td>
<td width="15%">


<p>0x08 - 4x.</p></td>
<td width="43%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="17%">


<p>-c <i>LTPCRC</i></p></td>
<td width="14%"></td>
<td width="15%"></td>
<td width="43%">
</td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">New LTP CRCs
enabled. Default is 0. To enable multiple LTP CRCs, use sum
of desired LTP CRCs.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p style="margin-top: 1em">0</p></td>
<td width="14%"></td>
<td width="58%">


<p style="margin-top: 1em">No-op.</p></td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>1</p></td>
<td width="14%"></td>
<td width="58%">


<p>0x1 - 14-bit LTP CRC mode.</p></td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>2</p></td>
<td width="14%"></td>
<td width="58%">


<p>0x2 - 16-bit LTP CRC mode.</p></td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>4</p></td>
<td width="14%"></td>
<td width="58%">


<p>0x4 - 48-bit LTP CRC mode.</p></td></tr>
<tr valign="top" align="left">
<td width="26%"></td>
<td width="2%">


<p>8</p></td>
<td width="14%"></td>
<td width="58%">


<p>0x8 - 12/16 bits per lane LTP CRC mode.</p></td></tr>
</table>

<h2>-h and -p options permit a variety of selections:
<a name="-h and -p options permit a variety of selections:"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p style="margin-top: 1em">-h 0</p></td>
<td width="9%"></td>
<td width="48%">


<p style="margin-top: 1em">First port in system
(default).</p> </td>
<td width="26%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p>-h <i>x</i></p></td>
<td width="9%"></td>
<td width="48%">


<p>First port on HFI <i>x</i>.</p></td>
<td width="26%">
</td></tr>
</table>

<p style="margin-left:11%;">-h 0 -p <i>y</i></p>

<p style="margin-left:26%;">Port <i>y</i> within
system.</p>

<p style="margin-left:11%;">-h <i>x</i>#8217#160;-p
<i>y</i></p>

<p style="margin-left:26%;">HFI <i>x</i>, port
<i>y</i>.</p>

<h2>Debug Options
<a name="Debug Options"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em">-v</p></td>
<td width="6%"></td>
<td width="74%">


<p style="margin-top: 1em">Verbose output. Additional
invocations turn on debugging, openib debugging, and
libibumad debugging.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>-z</p></td>
<td width="6%"></td>
<td width="74%">


<p>Does not get port info first, clears most port
attributes.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>-L <i>lid</i></p></td>
<td width="6%"></td>
<td width="74%">


<p>Sets PortInfo.LID = lid.</p></td></tr>
</table>

<h2>Examples
<a name="Examples"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">opaportconfig
-w 1 <br>
opaportconfig -p 1 -h 2 -w 3</p>

<h2>Description
<a name="Description"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Port
configuration is transient in nature. If the given host is
rebooted or its Intel(R) Omni-Path Fabric Stack is
restarted, the port reverts to its default configuration and
state. Typically, the default state is to have the port
enabled with all speeds and widths supported by the given
HFI port.</p>

<p style="margin-left:11%; margin-top: 1em">To access
switch ports using this command, the -l and -m options must
be given. The -l option specifies the lid of switch port 0
(the logical management port for the switch) and -m
specifies the actual switch port to access. If SMA mkeys are
used, the -K option is also needed. However, the Intel(R)
Omni-Path Fabric Suite Fabric Manager does not use SMA mkeys
by default, therefore this option may not be required.</p>

<p style="margin-left:11%; margin-top: 1em"><b>NOTE:</b>
The /etc/init.d/opaportconfig script is provided as an
example of changing port speed every time the server boots.
This script can be edited, then scheduled, using chkconfig
to control link settings on any set of HFI ports.</p>


<p style="margin-left:11%; margin-top: 1em"><b>CAUTION:</b>
When using this command to disable or reconfigure switch
ports, if the final port in the path between the Fabric
Management Node and the switch is disabled or fails to come
online, then opaenableports is not able to reenable it. In
this case, the switch CLI and/or a switch reboot may be
needed to correct the situation.</p>
<hr>
</body>
</html>
