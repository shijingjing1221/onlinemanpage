<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:09:41 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PMDAIB</title>

</head>
<body>

<h1 align="center">PMDAIB</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSYS">SYNOPSYS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONFIG FILE">CONFIG FILE</a><br>
<a href="#LOCAL CONTEXT">LOCAL CONTEXT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>pmdaib</b>
&minus; Infiniband performance metrics domain agent
(PMDA)</p>

<h2>SYNOPSYS
<a name="SYNOPSYS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>$PCP_PMDAS_DIR/infiniband/pmdaib</b>
[<b>&minus;c</b> <i>configFile</i>] [<b>&minus;D</b>
<i>debug</i>] [<b>&minus;d</b> <i>domain</i>]
[<b>&minus;l</b> <i>logfile</i>] [<b>&minus;w</b>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>pmdaib</b>
is a Performance Metrics Domain Agent (PMDA) which exports
information and performance metrics about local Infiniband
HCAs and local or remote Infiniband GUIDs.</p>

<p style="margin-left:11%; margin-top: 1em">A brief
description of the <b>pmdaib</b> command line options
follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;c</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>Location of the config file. By default, the config file
is named <b>$PCP_PMDAS_DIR/infiniband/config.</b> See
<b>CONFIG FILE</b> for more information.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-D</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>A debug values, as specified by <b>pmdbg (1)</b></p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;d</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>Specify an alternate performance metrics <i>domain</i>
number. Almost never necessary.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;l</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>Location of the log file. By default, a log file named
<i>ib.log</i> is written to <b>$PCP_LOG_DIR/pmcd</b>. If the
log file cannot be created or is not writable, output is
written to the standard error instead.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;w</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>Write out the default config file to
<b>$PCP_PMDAS_DIRS/infiniband</b> and exit immediately. The
written config file will contain the local HCA ports. It
will not overwrite an existing file. This argument should
only be used to create the template config file and should
never appear in <i>pmcd.conf.</i> See <b>CONFIG FILE</b> for
more information on the file format and on monitoring remote
GUIDs.</p> </td></tr>
</table>

<h2>CONFIG FILE
<a name="CONFIG FILE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">By default, the
PMDA will operate without using a config file. In this mode
of operation the local HCA ports will be monitored. Note
that if a new HCA is added to the machine that instance
domain naming may change because it will always be based on
the kernel&rsquo;s naming.</p>

<p style="margin-left:11%; margin-top: 1em">In cases where
this is not acceptable, or in the case where monitoring
remote Infiniband ports is required, a config file must be
created. A &quot;template&quot; file can be created by
running the <b>pmdaib</b> daemon with the <b>&minus;w</b>
argument. This will create a config file with the local
ports and GUIDs.</p>

<p style="margin-left:11%; margin-top: 1em">If the config
file is <i>executable</i> then it will be run and the output
will be used as the config file.</p>

<p style="margin-left:11%; margin-top: 1em">The config file
is composed of line-based records. Blank lines and
everything after the <i>hash (#)</i> character are ignored.
Each line has 6 fields:</p>


<p style="margin-left:11%; margin-top: 1em">[<b>instName</b>]
[<b>portGUID</b>] [<b>portNum</b>] via
[<b>localPortName</b>]:[<b>localPortNum</b>]</p>

<p style="margin-left:11%; margin-top: 1em">The first field
is used to give a static instance name to the Infiniband
port that has a specific GUID. All of the other fields must
be properly specified in order to monitor a particular
port.</p>

<p style="margin-left:11%; margin-top: 1em">For example, to
monitor port 1 of the local HCA called &rsquo;mthca0&rsquo;
a possible config file line would be:</p>

<p style="margin-left:11%; margin-top: 1em">myPort1
0xdeadbeef01234567 1 via mthca0:1</p>

<p style="margin-left:11%; margin-top: 1em">Remote ports
can be easily monitored by specifying the GUID of the HCA or
switch and specifying the remote port number. The
<b>localPortName</b>:<b>localPortNum</b> tuple specifies
which local HCA and port to use as the &quot;first hop&quot;
in contacting the remote GUID. E.g., to monitor port 13 of a
remote switch which is connected to the fabric on the first
port of the second HCA:</p>

<p style="margin-left:11%; margin-top: 1em">switch13
0xfeeffeefabcdabcd 13 via mthca1:1</p>

<h2>LOCAL CONTEXT
<a name="LOCAL CONTEXT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The Infiniband
pmda also supports accessing the metrics via
<b>PM_CONTEXT_LOCAL</b> when using the PMAPI interface. In
order to use the Infiniband pmda in this way, set the
environment variable <b>PMDA_LOCAL_IB</b> prior to calling
<b>pmNewContext(3).</b></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>pmcd(1),
PMAPI(3), pmContextNew(3), ibnetdiscover(8).</b></p>
<hr>
</body>
</html>
