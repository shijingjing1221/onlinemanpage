<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:02:20 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>clatrs.f</title>

</head>
<body>

<h1 align="center">clatrs.f</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#Function/Subroutine Documentation">Function/Subroutine Documentation</a><br>
<a href="#Author">Author</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">clatrs.f
&minus;</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Functions/Subroutines</b></p>

<p style="margin-left:17%;">subroutine <b>clatrs</b> (UPLO,
TRANS, DIAG, NORMIN, N, A, LDA, X, SCALE, CNORM, INFO)
<b><br>
CLATRS</b> <i>solves a triangular system of equations with
the scale factor set to prevent overflow.</i></p>

<h2>Function/Subroutine Documentation
<a name="Function/Subroutine Documentation"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>subroutine
clatrs (characterUPLO, characterTRANS, characterDIAG,
characterNORMIN, integerN, complex, dimension( lda, * )A,
integerLDA, complex, dimension( * )X, realSCALE, real,
dimension( * )CNORM, integerINFO) <br>
CLATRS</b></i> solves a triangular system of equations with
the scale factor set to prevent overflow.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Purpose:</b></p>

<p style="margin-left:17%; margin-top: 1em">CLATRS solves
one of the triangular systems</p>

<p style="margin-left:17%; margin-top: 1em">A * x = s*b,
A**T * x = s*b, or A**H * x = s*b,</p>

<p style="margin-left:17%; margin-top: 1em">with scaling to
prevent overflow. Here A is an upper or lower <br>
triangular matrix, A**T denotes the transpose of A, A**H
denotes the <br>
conjugate transpose of A, x and b are n-element vectors, and
s is a <br>
scaling factor, usually less than or equal to 1, chosen so
that the <br>
components of x will be less than the overflow threshold. If
the <br>
unscaled problem will not cause overflow, the Level 2 BLAS
routine <br>
CTRSV is called. If the matrix A is singular (A(j,j) = 0 for
some j), <br>
then s is set to 0 and a non-trivial solution to A*x = 0 is
returned.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters:</b></p>

<p style="margin-left:17%;"><i>UPLO</i></p>

<p style="margin-left:17%; margin-top: 1em">UPLO is
CHARACTER*1 <br>
Specifies whether the matrix A is upper or lower triangular.
<br>
= &rsquo;U&rsquo;: Upper triangular <br>
= &rsquo;L&rsquo;: Lower triangular</p>


<p style="margin-left:17%; margin-top: 1em"><i>TRANS</i></p>

<p style="margin-left:17%; margin-top: 1em">TRANS is
CHARACTER*1 <br>
Specifies the operation applied to A. <br>
= &rsquo;N&rsquo;: Solve A * x = s*b (No transpose) <br>
= &rsquo;T&rsquo;: Solve A**T * x = s*b (Transpose) <br>
= &rsquo;C&rsquo;: Solve A**H * x = s*b (Conjugate
transpose)</p>


<p style="margin-left:17%; margin-top: 1em"><i>DIAG</i></p>

<p style="margin-left:17%; margin-top: 1em">DIAG is
CHARACTER*1 <br>
Specifies whether or not the matrix A is unit triangular.
<br>
= &rsquo;N&rsquo;: Non-unit triangular <br>
= &rsquo;U&rsquo;: Unit triangular</p>


<p style="margin-left:17%; margin-top: 1em"><i>NORMIN</i></p>

<p style="margin-left:17%; margin-top: 1em">NORMIN is
CHARACTER*1 <br>
Specifies whether CNORM has been set or not. <br>
= &rsquo;Y&rsquo;: CNORM contains the column norms on entry
<br>
= &rsquo;N&rsquo;: CNORM is not set on entry. On exit, the
norms will <br>
be computed and stored in CNORM.</p>

<p style="margin-left:17%; margin-top: 1em"><i>N</i></p>

<p style="margin-left:17%; margin-top: 1em">N is INTEGER
<br>
The order of the matrix A. N &gt;= 0.</p>

<p style="margin-left:17%; margin-top: 1em"><i>A</i></p>

<p style="margin-left:17%; margin-top: 1em">A is COMPLEX
array, dimension (LDA,N) <br>
The triangular matrix A. If UPLO = &rsquo;U&rsquo;, the
leading n by n <br>
upper triangular part of the array A contains the upper <br>
triangular matrix, and the strictly lower triangular part of
<br>
A is not referenced. If UPLO = &rsquo;L&rsquo;, the leading
n by n lower <br>
triangular part of the array A contains the lower triangular
<br>
matrix, and the strictly upper triangular part of A is not
<br>
referenced. If DIAG = &rsquo;U&rsquo;, the diagonal elements
of A are <br>
also not referenced and are assumed to be 1.</p>

<p style="margin-left:17%; margin-top: 1em"><i>LDA</i></p>

<p style="margin-left:17%; margin-top: 1em">LDA is INTEGER
<br>
The leading dimension of the array A. LDA &gt;= max
(1,N).</p>

<p style="margin-left:17%; margin-top: 1em"><i>X</i></p>

<p style="margin-left:17%; margin-top: 1em">X is COMPLEX
array, dimension (N) <br>
On entry, the right hand side b of the triangular system.
<br>
On exit, X is overwritten by the solution vector x.</p>


<p style="margin-left:17%; margin-top: 1em"><i>SCALE</i></p>

<p style="margin-left:17%; margin-top: 1em">SCALE is REAL
<br>
The scaling factor s for the triangular system <br>
A * x = s*b, A**T * x = s*b, or A**H * x = s*b. <br>
If SCALE = 0, the matrix A is singular or badly scaled, and
<br>
the vector x is an exact or approximate solution to A*x =
0.</p>


<p style="margin-left:17%; margin-top: 1em"><i>CNORM</i></p>

<p style="margin-left:17%; margin-top: 1em">CNORM is REAL
array, dimension (N)</p>

<p style="margin-left:17%; margin-top: 1em">If NORMIN =
&rsquo;Y&rsquo;, CNORM is an input argument and CNORM(j)
<br>
contains the norm of the off-diagonal part of the j-th
column <br>
of A. If TRANS = &rsquo;N&rsquo;, CNORM(j) must be greater
than or equal <br>
to the infinity-norm, and if TRANS = &rsquo;T&rsquo; or
&rsquo;C&rsquo;, CNORM(j) <br>
must be greater than or equal to the 1-norm.</p>

<p style="margin-left:17%; margin-top: 1em">If NORMIN =
&rsquo;N&rsquo;, CNORM is an output argument and CNORM(j)
<br>
returns the 1-norm of the offdiagonal part of the j-th
column <br>
of A.</p>


<p style="margin-left:17%; margin-top: 1em"><i>INFO</i></p>

<p style="margin-left:17%; margin-top: 1em">INFO is INTEGER
<br>
= 0: successful exit <br>
&lt; 0: if INFO = -k, the k-th argument had an illegal
value</p>


<p style="margin-left:11%; margin-top: 1em"><b>Author:</b></p>

<p style="margin-left:17%;">Univ. of Tennessee</p>

<p style="margin-left:17%; margin-top: 1em">Univ. of
California Berkeley</p>

<p style="margin-left:17%; margin-top: 1em">Univ. of
Colorado Denver</p>

<p style="margin-left:17%; margin-top: 1em">NAG Ltd.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Date:</b></p>

<p style="margin-left:17%;">September 2012</p>

<p style="margin-left:11%; margin-top: 1em"><b>Further
Details:</b></p>

<p style="margin-left:17%; margin-top: 1em">A rough bound
on x is computed; if that is less than overflow, CTRSV <br>
is called, otherwise, specific code is used which checks for
possible <br>
overflow or divide-by-zero at every operation.</p>

<p style="margin-left:17%; margin-top: 1em">A columnwise
scheme is used for solving A*x = b. The basic algorithm <br>
if A is lower triangular is</p>

<p style="margin-left:17%; margin-top: 1em">x[1:n] :=
b[1:n] <br>
for j = 1, ..., n <br>
x(j) := x(j) / A(j,j) <br>
x[j+1:n] := x[j+1:n] - x(j) * A[j+1:n,j] <br>
end</p>

<p style="margin-left:17%; margin-top: 1em">Define bounds
on the components of x after j iterations of the loop: <br>
M(j) = bound on x[1:j] <br>
G(j) = bound on x[j+1:n] <br>
Initially, let M(0) = 0 and G(0) = max{x(i), i=1,...,n}.</p>

<p style="margin-left:17%; margin-top: 1em">Then for
iteration j+1 we have <br>
M(j+1) &lt;= G(j) / | A(j+1,j+1) | <br>
G(j+1) &lt;= G(j) + M(j+1) * | A[j+2:n,j+1] | <br>
&lt;= G(j) ( 1 + CNORM(j+1) / | A(j+1,j+1) | )</p>

<p style="margin-left:17%; margin-top: 1em">where
CNORM(j+1) is greater than or equal to the infinity-norm of
<br>
column j+1 of A, not counting the diagonal. Hence</p>

<p style="margin-left:17%; margin-top: 1em">G(j) &lt;= G(0)
product ( 1 + CNORM(i) / | A(i,i) | ) <br>
1&lt;=i&lt;=j <br>
and</p>

<p style="margin-left:17%; margin-top: 1em">|x(j)| &lt;= (
G(0) / |A(j,j)| ) product ( 1 + CNORM(i) / |A(i,i)| ) <br>
1&lt;=i&lt; j</p>

<p style="margin-left:17%; margin-top: 1em">Since |x(j)|
&lt;= M(j), we use the Level 2 BLAS routine CTRSV if the
<br>
reciprocal of the largest M(j), j=1,..,n, is larger than
<br>
max(underflow, 1/overflow).</p>

<p style="margin-left:17%; margin-top: 1em">The bound on
x(j) is also used to determine when a step in the <br>
columnwise method can be performed without fear of overflow.
If <br>
the computed bound is greater than a large constant, x is
scaled to <br>
prevent overflow, but if the bound overflows, x is set to 0,
x(j) to <br>
1, and scale to 0, and a non-trivial solution to A*x = 0 is
found.</p>

<p style="margin-left:17%; margin-top: 1em">Similarly, a
row-wise scheme is used to solve A**T *x = b or <br>
A**H *x = b. The basic algorithm for A upper triangular
is</p>

<p style="margin-left:17%; margin-top: 1em">for j = 1, ...,
n <br>
x(j) := ( b(j) - A[1:j-1,j]&rsquo; * x[1:j-1] ) / A(j,j)
<br>
end</p>

<p style="margin-left:17%; margin-top: 1em">We
simultaneously compute two bounds <br>
G(j) = bound on ( b(i) - A[1:i-1,i]&rsquo; * x[1:i-1] ),
1&lt;=i&lt;=j <br>
M(j) = bound on x(i), 1&lt;=i&lt;=j</p>

<p style="margin-left:17%; margin-top: 1em">The initial
values are G(0) = 0, M(0) = max{b(i), i=1,..,n}, and we <br>
add the constraint G(j) &gt;= G(j-1) and M(j) &gt;= M(j-1)
for j &gt;= 1. <br>
Then the bound on x(j) is</p>

<p style="margin-left:17%; margin-top: 1em">M(j) &lt;=
M(j-1) * ( 1 + CNORM(j) ) / | A(j,j) |</p>

<p style="margin-left:17%; margin-top: 1em">&lt;= M(0) *
product ( ( 1 + CNORM(i) ) / |A(i,i)| ) <br>
1&lt;=i&lt;=j</p>

<p style="margin-left:17%; margin-top: 1em">and we can
safely call CTRSV if 1/M(n) and 1/G(n) are both greater <br>
than max(underflow, 1/overflow).</p>

<p style="margin-left:11%; margin-top: 1em">Definition at
line 239 of file clatrs.f.</p>

<h2>Author
<a name="Author"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Generated
automatically by Doxygen for LAPACK from the source
code.</p>
<hr>
</body>
</html>
