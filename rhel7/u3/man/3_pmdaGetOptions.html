<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:09:19 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PMDAGETOPTIONS</title>

</head>
<body>

<h1 align="center">PMDAGETOPTIONS</h1>

<a href="#NAME">NAME</a><br>
<a href="#C SYNOPSIS">C SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>
<a href="#CAVEAT">CAVEAT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pmdaGetOpt</b>,
<b>pmdaGetOptions</b> &minus; get options from arguments,
parsing generic PMDA options</p>

<h2>C SYNOPSIS
<a name="C SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;pcp/pmapi.h&gt; <br>
#include &lt;pcp/impl.h&gt; <br>
#include &lt;pcp/pmda.h&gt;</b></p>

<p style="margin-left:23%; margin-top: 1em"><b>int
pmdaGetOptions(int</b> <i>argc</i><b>, char *const
*</b><i>argv</i><b>, pmdaOptions *</b><i>opts</i><b>,
pmdaInterface&nbsp;*</b><i>dispatch</i><b>);</b></p>

<p style="margin-left:23%; margin-top: 1em"><b>int
pmdaGetOpt(int</b> <i>argc</i><b>, char *const
*</b><i>argv</i><b>,
const&nbsp;char&nbsp;*</b><i>optstring</i><b>,
pmdaInterface&nbsp;*</b><i>dispatch</i><b>,
int&nbsp;*</b><i>err</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>cc ...
&minus;lpcp_pmda &minus;lpcp</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">These functions
are wrappers for <b>pmgetopt_r</b>(3). The behavior of each
function is that certain options are assumed to have a
predefined behavior which initializes several fields in the
<b>pmdaInterface</b> structure. The <b>pmdaGetOptions</b>
interface allows both short and long options to be given,
whereas <b>pmdaGetOpt</b> allows for short form options
only.</p>

<p style="margin-left:11%; margin-top: 1em">The options
that both <b>pmdaGetOptions</b> and <b>pmdaGetOpt</b> will
trap are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;D</b><i>trace</i></p></td>
<td width="8%"></td>
<td width="66%">


<p>Set the <b>PMAPI</b>(3) debug control variable
(<b>pmDebug</b>) to <i>trace</i>. Used for controlling
levels of trace output while debugging.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;d</b><i>domain</i></p></td>
<td width="8%"></td>
<td width="66%">


<p>Set the <i>domain</i> number of this agent.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;h</b><i>helpfile</i></p></td>
<td width="8%"></td>
<td width="66%">


<p>Obtain the help text (see <b>pmdaText</b>(3)) for the
metrics from this file rather than from the path specified
with <b>pmdaDSO</b>(3) or <b>pmdaDaemon</b>(3).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;i</b><i>port</i></p></td>
<td width="8%"></td>
<td width="66%">


<p>Expect PMCD to connect on inet <i>port</i> (number or
name).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;6</b><i>port</i></p></td>
<td width="8%"></td>
<td width="66%">


<p>Expect PMCD to connect on ipv6 <i>port</i> (number or
name).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;l</b><i>logfile</i></p></td>
<td width="8%"></td>
<td width="66%">


<p>Redirect diagnostics and trace output to
<i>logfile</i>.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;p</b></p></td>
<td width="8%"></td>
<td width="66%">


<p>Expect PMCD to supply stdin/stdout pipe.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>&minus;u</b><i>socket</i></p></td>
<td width="8%"></td>
<td width="66%">


<p>Expect PMCD to connect on unix domain <i>socket</i>.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The
<b>pmdaGetOptions</b> interface will also capture the
following options, and store them within the <i>opts</i>
parameter:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">



<p style="margin-top: 1em"><b>&minus;U</b><i>username</i></p> </td>
<td width="8%"></td>
<td width="66%">


<p style="margin-top: 1em">Set the user account name under
which the PMDA should execute.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Only one of
<b>&minus;i</b>, <b>&minus;6</b>, <b>&minus;p</b> and
<b>&minus;u</b> may be specified. If none of these three
options is given, a pipe (<b>&minus;p</b>) is assumed. When
these options are encountered by <b>pmdaGetOpt</b>, the
option is processed and the next option is examined.
Therefore, <b>pmdaGetOpt</b> will only return when an option
other than those listed above is found, or the end of the
list is reached. The returned value will be the argument or
EOF, respectively.</p>

<p style="margin-left:11%; margin-top: 1em">A PMDA can
control which of these options the program will accept with
either the <i>opts</i> or <i>optstring</i> argument. To
accept all the options, the PMDA should call
<b>pmdaGetOptions</b> with the short_options field of the
<i>opts</i> structure set to the PMDA_OPTIONS macro, or
<b>pmdaGetOpt</b> with the option string
&quot;D:d:h:i:l:pu:&quot;. Any PMDA specific options should
be added to these strings in the style of <b>getopt</b>(3),
and will be returned by both <b>pmdaGetOptions</b> and
<b>pmdaGetOpt</b> if encountered.</p>

<p style="margin-left:11%; margin-top: 1em">When a command
line option usage error is detected in the
<b>pmdaGetOptions</b> interface, the error field of the
<i>opts</i> structure will contain a non-zero error
count.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pmdaGetOpt</b>
takes a pointer to an int, <i>err</i>, which is used as an
error count. This variable should be initialized to zero
before <b>pmdaGetOpt</b> is first called, and tested when
<b>pmdaGetOpt</b> returns EOF.</p>

<p style="margin-left:11%; margin-top: 1em">Neither
<b>pmdaGetOptions</b> nor <b>pmdaGetOpt</b> modify their
<i>argc</i> or <i>argv</i> parameters.</p>

<p style="margin-left:11%; margin-top: 1em">The global
variables used by the system <b>getopt (3)</b> interface may
also be used by the caller of <b>pmdaGetOpt</b> within the
argument parsing loop.</p>

<p style="margin-left:11%; margin-top: 1em">On the other
hand, the <b>pmdaGetOptions</b> interface does not utilize
global variables at all (neither reading nor modifying
them). Instead, these variables can be access via the
<i>opts</i> fields of the same name.</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Both
<b>pmdaGetOptions</b> and <b>pmdaGetOpt</b> will display the
same error messages as <b>getopt</b>.</p>

<h2>CAVEAT
<a name="CAVEAT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The options
<b>&minus;D</b>, <b>&minus;d</b>, <b>&minus;i</b>,
<b>&minus;l</b>, <b>&minus;p</b> and <b>&minus;u</b> cannot
be reused for other purposes by the PMDA, unless using the
<i>override</i> method provided by the <b>pmdaGetOptions</b>
interface, which operates in the same way as described for
the <b>pmGetOptions</b>(3) interface used by PMAPI client
tools.</p>

<p style="margin-left:11%; margin-top: 1em">The PMDA must
be using <b>PMDA_INTERFACE_2</b> or later, as specified in
the call to <b>pmdaDSO</b>(3) or <b>pmdaDaemon</b>(3).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pmdbg</b>(1),
<b>getopt</b>(3), <b>pmgetopt_r</b>(3),
<b>pmGetOptions</b>(3), <b>PMAPI</b>(3), <b>PMDA</b>(3),
<b>pmdaDaemon</b>(3), <b>pmdaDSO</b>(3) and
<b>pmdaText</b>(3).</p>
<hr>
</body>
</html>
