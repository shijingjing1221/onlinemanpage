<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 20:40:08 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>CAPTEST:</title>

</head>
<body>

<h1 align="center">CAPTEST:</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">captest &minus;
a program to demonstrate capabilities</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>captest [
&minus;&minus;drop-all | &minus;&minus;drop-caps |
&minus;&minus;id ] [ &minus;&minus;init-grp ] [
&minus;&minus;lock ] [ &minus;&minus;text ]</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>captest</b>
is a program that demonstrates and prints out the current
process capabilities. Each option prints the same report. It
will output current capabilities. then it will try to access
/etc/shadow directly to show if that can be done. Then it
creates a child process that attempts to read /etc/shadow
and outputs the results of that. Then it outputs the
capabilities that a child process would have.</p>

<p style="margin-left:11%; margin-top: 1em">You can also
apply file system capabilities to this program to study how
they work. For example, filecap /usr/bin/captest chown. Then
run captest as a normal user. Another interesting test is to
make captest suid root so that you can see what the
interaction is between root&rsquo;s credentials and
capabilities. For example, chmod 4755 /usr/bin/captest. When
run as a normal user, the program will see if privilege
escalation is possible. But do not leave this app setuid
root after you are don testing so that an attacker cannot
take advantage of it.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;drop-all</b></p>

<p style="margin-left:22%;">This drops all capabilities and
clears the bounding set.</p>


<p style="margin-left:11%;"><b>&minus;&minus;drop-caps</b></p>

<p style="margin-left:22%;">This drops just traditional
capabilities.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><b>&minus;&minus;id</b></p></td>
<td width="5%"></td>
<td width="78%">


<p>This changes to uid and gid 99, drops supplemental
groups, and clears the bounding set.</p></td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;init-grp</b></p>

<p style="margin-left:22%;">This changes to uid and gid 99
and then adds any supplemental groups that comes with that
account. You would have add them prior to testing because by
default there are no supplemental groups on account 99.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;text</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>This option outputs the effective capabilities in text
rather than numerically.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;lock</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>This prevents the ability for child processes to regain
privileges if the uid is 0.</p></td></tr>
</table>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>filecap</b>(8),
<b>capabilities</b>(7)</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Steve Grubb</p>
<hr>
</body>
</html>
