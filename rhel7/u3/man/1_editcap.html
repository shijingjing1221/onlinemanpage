<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:20:05 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>EDITCAP</title>

</head>
<body>

<h1 align="center">EDITCAP</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">editcap &minus;
Edit and/or translate the format of capture files</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>editcap</b>
[&nbsp;<b>&minus;A&nbsp;</b>&lt;start&nbsp;time&gt;&nbsp;]
[&nbsp;<b>&minus;B&nbsp;</b>&lt;stop&nbsp;time&gt;&nbsp;]
[&nbsp;<b>&minus;c&nbsp;</b>&lt;packets&nbsp;per&nbsp;file&gt;&nbsp;]
[&nbsp;<b>&minus;C&nbsp;</b>&lt;choplen&gt;&nbsp;]
[&nbsp;<b>&minus;E&nbsp;</b>&lt;error&nbsp;probability&gt;&nbsp;]
[&nbsp;<b>&minus;F&nbsp;</b>&lt;file&nbsp;format&gt;&nbsp;]
[&nbsp;<b>&minus;h&nbsp;</b>]
[&nbsp;<b>&minus;i&nbsp;</b>&lt;seconds&nbsp;per&nbsp;file&gt;&nbsp;]
[&nbsp;<b>&minus;r&nbsp;</b>]
[&nbsp;<b>&minus;s&nbsp;</b>&lt;snaplen&gt;&nbsp;]
[&nbsp;<b>&minus;S&nbsp;</b>&lt;strict&nbsp;time&nbsp;adjustment&gt;&nbsp;]
[&nbsp;<b>&minus;t&nbsp;</b>&lt;time&nbsp;adjustment&gt;&nbsp;]
[&nbsp;<b>&minus;T&nbsp;</b>&lt;encapsulation&nbsp;type&gt;&nbsp;]
[&nbsp;<b>&minus;v&nbsp;</b>] <i>infile outfile</i>
[&nbsp;<i>packet#</i>[&minus;<i>packet#</i>]&nbsp;...&nbsp;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>editcap
&nbsp;&minus;d&nbsp;</b> |
&nbsp;<b>&minus;D&nbsp;</b>&lt;dup&nbsp;window&gt;&nbsp; |
&nbsp;<b>&minus;w&nbsp;</b>&lt;dup&nbsp;time&nbsp;window&gt;&nbsp;
[&nbsp;<b>&minus;v&nbsp;</b>] <i>infile outfile</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>Editcap</b></i>
is a program that reads some or all of the captured packets
from the <i>infile</i>, optionally converts them in various
ways and writes the resulting packets to the capture
<i>outfile</i> (or outfiles).</p>

<p style="margin-left:11%; margin-top: 1em">By default, it
reads all packets from the <i>infile</i> and writes them to
the <i>outfile</i> in pcap file format.</p>

<p style="margin-left:11%; margin-top: 1em">An optional
list of packet numbers can be specified on the command tail;
individual packet numbers separated by whitespace and/or
ranges of packet numbers can be specified as
<i>start</i>&minus;<i>end</i>, referring to all packets from
<i>start</i> to <i>end</i>. By default the selected packets
with those numbers will <i>not</i> be written to the capture
file. If the <b>&minus;r</b> flag is specified, the whole
packet selection is reversed; in that case <i>only</i> the
selected packets will be written to the capture file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Editcap</b>
can also be used to remove duplicate packets. Several
different options (<b>&minus;d</b>, <b>&minus;D</b> and
<b>&minus;w</b>) are used to control the packet window or
relative time window to be used for duplicate
comparison.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Editcap</b>
is able to detect, read and write the same capture files
that are supported by <b>Wireshark</b>. The input file
doesn&rsquo;t need a specific filename extension; the file
format and an optional gzip compression will be
automatically detected. Near the beginning of the
<small>DESCRIPTION</small> section of <i>wireshark</i>(1) or
&lt;http://www.wireshark.org/docs/man&minus;pages/wireshark.html&gt;
is a detailed description of the way <b>Wireshark</b>
handles this, which is the same way <b>Editcap</b> handles
this.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Editcap</b>
can write the file in several output formats. The
<b>&minus;F</b> flag can be used to specify the format in
which to write the capture file; <b>editcap &minus;F</b>
provides a list of the available output formats.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">&minus;A
&lt;start time&gt;</p>

<p style="margin-left:17%;">Saves only the packets whose
timestamp is on or after start time. The time is given in
the following format YYYY-MM-DD <small>HH:MM:SS</small></p>

<p style="margin-left:11%;">&minus;B &lt;stop time&gt;</p>

<p style="margin-left:17%;">Saves only the packets whose
timestamp is before stop time. The time is given in the
following format YYYY-MM-DD <small>HH:MM:SS</small></p>

<p style="margin-left:11%;">&minus;c &lt;packets per
file&gt;</p>

<p style="margin-left:17%;">Splits the packet output to
different files based on uniform packet counts with a
maximum of &lt;packets per file&gt; each. Each output file
will be created with a suffix &minus;nnnnn, starting with
00000. If the specified number of packets is written to the
output file, the next output file is opened. The default is
to use a single output file.</p>

<p style="margin-left:11%;">&minus;C &lt;choplen&gt;</p>

<p style="margin-left:17%;">Sets the chop length to use
when writing the packet data. Each packet is chopped by a
few &lt;choplen&gt; bytes of data. Positive values chop at
the packet beginning while negative values chop at the
packet end.</p>

<p style="margin-left:17%; margin-top: 1em">This is useful
for chopping headers for decapsulation of an entire capture
or in the rare case that the conversion between two file
formats leaves some random bytes at the end of each
packet.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&minus;d</p></td>
<td width="3%"></td>
<td width="83%">


<p>Attempts to remove duplicate packets. The length and
<small>MD5</small> hash of the current packet are compared
to the previous four (4) packets. If a match is found, the
current packet is skipped. This option is equivalent to
using the option <b>&minus;D 5</b>.</p></td></tr>
</table>

<p style="margin-left:11%;">&minus;D &lt;dup window&gt;</p>

<p style="margin-left:17%;">Attempts to remove duplicate
packets. The length and <small>MD5</small> hash of the
current packet are compared to the previous &lt;dup
window&gt; &minus; 1 packets. If a match is found, the
current packet is skipped.</p>

<p style="margin-left:17%; margin-top: 1em">The use of the
option <b>&minus;D 0</b> combined with the <b>&minus;v</b>
option is useful in that each packet&rsquo;s Packet number,
Len and <small>MD5</small> Hash will be printed to standard
out. This verbose output (specifically the
<small>MD5</small> hash strings) can be useful in scripts to
identify duplicate packets across trace files.</p>

<p style="margin-left:17%; margin-top: 1em">The &lt;dup
window&gt; is specified as an integer value between 0 and
1000000 (inclusive).</p>


<p style="margin-left:17%; margin-top: 1em"><small>NOTE:</small>
Specifying large &lt;dup window&gt; values with large
tracefiles can result in very long processing times for
<b>editcap</b>.</p>

<p style="margin-left:11%;">&minus;E &lt;error
probability&gt;</p>

<p style="margin-left:17%;">Sets the probability that bytes
in the output file are randomly changed. <b>Editcap</b> uses
that probability (between 0.0 and 1.0 inclusive) to apply
errors to each data byte in the file. For instance, a
probability of 0.02 means that each byte has a 2% chance of
having an error.</p>

<p style="margin-left:17%; margin-top: 1em">This option is
meant to be used for fuzz-testing protocol dissectors.</p>

<p style="margin-left:11%;">&minus;F &lt;file
format&gt;</p>

<p style="margin-left:17%;">Sets the file format of the
output capture file. <b>Editcap</b> can write the file in
several formats, <b>editcap &minus;F</b> provides a list of
the available output formats. The default is the <b>pcap</b>
format.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&minus;h</p></td>
<td width="3%"></td>
<td width="63%">


<p>Prints the version and options and exits.</p></td>
<td width="20%">
</td></tr>
</table>

<p style="margin-left:11%;">&minus;i &lt;seconds per
file&gt;</p>

<p style="margin-left:17%;">Splits the packet output to
different files based on uniform time intervals using a
maximum interval of &lt;seconds per file&gt; each. Each
output file will be created with a suffix &minus;nnnnn,
starting with 00000. If packets for the specified time
interval are written to the output file, the next output
file is opened. The default is to use a single output
file.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&minus;r</p></td>
<td width="3%"></td>
<td width="83%">


<p>Reverse the packet selection. Causes the packets whose
packet numbers are specified on the command line to be
written to the output capture file, instead of discarding
them.</p> </td></tr>
</table>

<p style="margin-left:11%;">&minus;s &lt;snaplen&gt;</p>

<p style="margin-left:17%;">Sets the snapshot length to use
when writing the data. If the <b>&minus;s</b> flag is used
to specify a snapshot length, packets in the input file with
more captured data than the specified snapshot length will
have only the amount of data specified by the snapshot
length written to the output file.</p>

<p style="margin-left:17%; margin-top: 1em">This may be
useful if the program that is to read the output file cannot
handle packets larger than a certain size (for example, the
versions of snoop in Solaris 2.5.1 and Solaris 2.6 appear to
reject Ethernet packets larger than the standard Ethernet
<small>MTU,</small> making them incapable of handling
gigabit Ethernet captures if jumbo packets were used).</p>

<p style="margin-left:11%;">&minus;S &lt;strict time
adjustment&gt;</p>

<p style="margin-left:17%;">Time adjust selected packets to
insure strict chronological order.</p>

<p style="margin-left:17%; margin-top: 1em">The &lt;strict
time adjustment&gt; value represents relative seconds
specified as [&minus;]<i>seconds</i>[<i>.fractional
seconds</i>].</p>

<p style="margin-left:17%; margin-top: 1em">As the capture
file is processed each packet&rsquo;s absolute time is
<i>possibly</i> adjusted to be equal to or greater than the
previous packet&rsquo;s absolute timestamp depending on the
&lt;strict time adjustment&gt; value.</p>

<p style="margin-left:17%; margin-top: 1em">If &lt;strict
time adjustment&gt; value is 0 or greater (e.g. 0.000001)
then <b>only</b> packets with a timestamp less than the
previous packet will adjusted. The adjusted timestamp value
will be set to be equal to the timestamp value of the
previous packet plus the value of the &lt;strict time
adjustment&gt; value. A &lt;strict time adjustment&gt; value
of 0 will adjust the minimum number of timestamp values
necessary to insure that the resulting capture file is in
strict chronological order.</p>

<p style="margin-left:17%; margin-top: 1em">If &lt;strict
time adjustment&gt; value is specified as a negative value,
then the timestamp values of <b>all</b> packets will be
adjusted to be equal to the timestamp value of the previous
packet plus the absolute value of the &lt;lt&gt;strict time
adjustment&lt;gt&gt; value. A &lt;strict time adjustment&gt;
value of &minus;0 will result in all packets having the
timestamp value of the first packet.</p>

<p style="margin-left:17%; margin-top: 1em">This feature is
useful when the trace file has an occasional packet with a
negative delta time relative to the previous packet.</p>

<p style="margin-left:11%;">&minus;t &lt;time
adjustment&gt;</p>

<p style="margin-left:17%;">Sets the time adjustment to use
on selected packets. If the <b>&minus;t</b> flag is used to
specify a time adjustment, the specified adjustment will be
applied to all selected packets in the capture file. The
adjustment is specified as
[&minus;]<i>seconds</i>[<i>.fractional seconds</i>]. For
example, <b>&minus;t</b> 3600 advances the timestamp on
selected packets by one hour while <b>&minus;t</b>
&minus;0.5 reduces the timestamp on selected packets by
one-half second.</p>

<p style="margin-left:17%; margin-top: 1em">This feature is
useful when synchronizing dumps collected on different
machines where the time difference between the two machines
is known or can be estimated.</p>

<p style="margin-left:11%;">&minus;T &lt;encapsulation
type&gt;</p>

<p style="margin-left:17%;">Sets the packet encapsulation
type of the output capture file. If the <b>&minus;T</b> flag
is used to specify an encapsulation type, the encapsulation
type of the output capture file will be forced to the
specified type. <b>editcap &minus;T</b> provides a list of
the available types. The default type is the one appropriate
to the encapsulation type of the input capture file.</p>

<p style="margin-left:17%; margin-top: 1em">Note: this
merely forces the encapsulation type of the output file to
be the specified type; the packet headers of the packets
will not be translated from the encapsulation type of the
input capture file to the specified encapsulation type (for
example, it will not translate an Ethernet capture to an
<small>FDDI</small> capture if an Ethernet capture is read
and &rsquo;<b>&minus;T fddi</b>&rsquo; is specified). If you
need to remove/add headers from/to a packet, you will need
<i>od</i>(1)/<i>text2pcap</i>(1).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&minus;v</p></td>
<td width="3%"></td>
<td width="83%">


<p>Causes <b>editcap</b> to print verbose messages while
it&rsquo;s working.</p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">Use of
<b>&minus;v</b> with the de-duplication switches of
<b>&minus;d</b>, <b>&minus;D</b> or <b>&minus;w</b> will
cause all <small>MD5</small> hashes to be printed whether
the packet is skipped or not.</p>

<p style="margin-left:11%;">&minus;w &lt;dup time
window&gt;</p>

<p style="margin-left:17%;">Attempts to remove duplicate
packets. The current packet&rsquo;s arrival time is compared
with up to 1000000 previous packets. If the packet&rsquo;s
relative arrival time is <i>less than or equal to</i> the
&lt;dup time window&gt; of a previous packet and the packet
length and <small>MD5</small> hash of the current packet are
the same then the packet to skipped. The duplicate
comparison test stops when the current packet&rsquo;s
relative arrival time is greater than &lt;dup time
window&gt;.</p>

<p style="margin-left:17%; margin-top: 1em">The &lt;dup
time window&gt; is specified as
<i>seconds</i>[<i>.fractional seconds</i>].</p>

<p style="margin-left:17%; margin-top: 1em">The
[.fractional seconds] component can be specified to nine (9)
decimal places (billionths of a second) but most typical
trace files have resolution to six (6) decimal places
(millionths of a second).</p>


<p style="margin-left:17%; margin-top: 1em"><small>NOTE:</small>
Specifying large &lt;dup time window&gt; values with large
tracefiles can result in very long processing times for
<b>editcap</b>.</p>


<p style="margin-left:17%; margin-top: 1em"><small>NOTE:</small>
The <b>&minus;w</b> option assumes that the packets are in
chronological order. If the packets are <small>NOT</small>
in chronological order then the <b>&minus;w</b> duplication
removal option may not identify some duplicates.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To see more
detailed description of the options use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;h</pre>


<p style="margin-left:11%; margin-top: 1em">To shrink the
capture file by truncating the packets at 64 bytes and
writing it as Sun snoop file use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;s 64 &minus;F snoop capture.pcap shortcapture.snoop</pre>


<p style="margin-left:11%; margin-top: 1em">To delete
packet 1000 from the capture file use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap capture.pcap sans1000.pcap 1000</pre>


<p style="margin-left:11%; margin-top: 1em">To limit a
capture file to packets from number 200 to 750 (inclusive)
use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;r capture.pcap small.pcap 200&minus;750</pre>


<p style="margin-left:11%; margin-top: 1em">To get all
packets from number 1&minus;500 (inclusive) use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;r capture.pcap first500.pcap 1&minus;500</pre>


<p style="margin-left:11%; margin-top: 1em">or</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap capture.pcap first500.pcap 501&minus;9999999</pre>


<p style="margin-left:11%; margin-top: 1em">To exclude
packets 1, 5, 10 to 20 and 30 to 40 from the new file
use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap capture.pcap exclude.pcap 1 5 10&minus;20 30&minus;40</pre>


<p style="margin-left:11%; margin-top: 1em">To select just
packets 1, 5, 10 to 20 and 30 to 40 for the new file
use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;r capture.pcap select.pcap 1 5 10&minus;20 30&minus;40</pre>


<p style="margin-left:11%; margin-top: 1em">To remove
duplicate packets seen within the prior four frames use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;d capture.pcap dedup.pcap</pre>


<p style="margin-left:11%; margin-top: 1em">To remove
duplicate packets seen within the prior 100 frames use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;D 101 capture.pcap dedup.pcap</pre>


<p style="margin-left:11%; margin-top: 1em">To remove
duplicate packets seen <i>equal to or less than</i> 1/10th
of a second:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;w 0.1 capture.pcap dedup.pcap</pre>


<p style="margin-left:11%; margin-top: 1em">To display the
<small>MD5</small> hash for all of the packets (and
<small>NOT</small> generate any real output file):</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;v &minus;D 0 capture.pcap /dev/null</pre>


<p style="margin-left:11%; margin-top: 1em">or on Windows
systems</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;v &minus;D 0 capture.pcap NUL</pre>


<p style="margin-left:11%; margin-top: 1em">To advance the
timestamps of each packet forward by 3.0827 seconds:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;t 3.0827 capture.pcap adjusted.pcap</pre>


<p style="margin-left:11%; margin-top: 1em">To insure all
timestamps are in strict chronological order:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;S 0 capture.pcap adjusted.pcap</pre>


<p style="margin-left:11%; margin-top: 1em">To introduce 5%
random errors in a capture file use:</p>

<pre style="margin-left:11%; margin-top: 1em">    editcap &minus;E 0.05 capture.pcap capture_error.pcap</pre>


<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>pcap</i>(3),
<i>wireshark</i>(1), <i>tshark</i>(1), <i>mergecap</i>(1),
<i>dumpcap</i>(1), <i>capinfos</i>(1), <i>text2pcap</i>(1),
<i>od</i>(1), <i>pcap&minus;filter</i>(7) or
<i>tcpdump</i>(8)</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Editcap</b>
is part of the <b>Wireshark</b> distribution. The latest
version of <b>Wireshark</b> can be found at
&lt;http://www.wireshark.org&gt;.</p>


<p style="margin-left:11%; margin-top: 1em"><small>HTML</small>
versions of the Wireshark project man pages are available
at:
&lt;http://www.wireshark.org/docs/man&minus;pages&gt;.</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em">  Original Author
  &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus; &minus;&minus;&minus;&minus;&minus;&minus;
  Richard Sharpe           &lt;sharpe[AT]ns.aus.com&gt;
  Contributors
  &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
  Guy Harris               &lt;guy[AT]alum.mit.edu&gt;
  Ulf Lamping              &lt;ulf.lamping[AT]web.de&gt;</pre>
<hr>
</body>
</html>
