<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:22:32 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>gnutls-serv</title>

</head>
<body>

<h1 align="center">gnutls-serv</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>gnutls-serv</b>
&minus; GnuTLS server</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>gnutls-serv</b>
[<b>&minus;flags</b>] [<b>&minus;flag</b> [<i>value</i>]]
[<b>&minus;&minus;option-name</b>[[=| ]<i>value</i>]]</p>

<p style="margin-left:11%; margin-top: 1em">All arguments
must be options.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Server program
that listens to incoming TLS connections.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;d</b>
<i>number</i>, <b>&minus;&minus;debug</b>=<i>number</i></p>

<p style="margin-left:22%;">Enable debugging. This option
takes an integer number as its argument. The value of
<i>number</i> is constrained to being:</p>

<p style="margin-left:28%;">in the range 0 through 9999</p>

<p style="margin-left:22%; margin-top: 1em">Specifies the
debug level.</p>


<p style="margin-left:11%;"><b>&minus;&minus;noticket</b></p>

<p style="margin-left:22%;">Don&rsquo;t accept session
tickets.</p>

<p style="margin-left:11%;"><b>&minus;g</b>,
<b>&minus;&minus;generate</b></p>

<p style="margin-left:22%;">Generate Diffie-Hellman and
RSA-export parameters.</p>

<p style="margin-left:11%;"><b>&minus;q</b>,
<b>&minus;&minus;quiet</b></p>

<p style="margin-left:22%;">Suppress some messages.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;nodb</b></p></td>
<td width="2%"></td>
<td width="50%">


<p>Do not use a resumption database.</p></td>
<td width="28%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;http</b></p></td>
<td width="2%"></td>
<td width="50%">


<p>Act as an HTTP server.</p></td>
<td width="28%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;echo</b></p></td>
<td width="2%"></td>
<td width="50%">


<p>Act as an Echo server.</p></td>
<td width="28%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;u</b>,
<b>&minus;&minus;udp</b></p>

<p style="margin-left:22%;">Use DTLS (datagram TLS) over
UDP.</p>


<p style="margin-left:11%;"><b>&minus;&minus;mtu</b>=<i>number</i></p>

<p style="margin-left:22%;">Set MTU for datagram TLS. This
option takes an integer number as its argument. The value of
<i>number</i> is constrained to being:</p>

<p style="margin-left:28%;">in the range 0 through
17000</p>


<p style="margin-left:11%;"><b>&minus;&minus;srtp&minus;profiles</b>=<i>string</i></p>

<p style="margin-left:22%;">Offer SRTP profiles.</p>

<p style="margin-left:11%;"><b>&minus;a</b>,
<b>&minus;&minus;disable&minus;client&minus;cert</b></p>

<p style="margin-left:22%;">Do not request a client
certificate.</p>

<p style="margin-left:11%;"><b>&minus;r</b>,
<b>&minus;&minus;require&minus;client&minus;cert</b></p>

<p style="margin-left:22%;">Require a client
certificate.</p>


<p style="margin-left:11%;"><b>&minus;&minus;verify&minus;client&minus;cert</b></p>

<p style="margin-left:22%;">If a client certificate is sent
then verify it..</p>

<p style="margin-left:22%; margin-top: 1em">Do not require,
but if a client certificate is sent then verify it and close
the connection if invalid.</p>

<p style="margin-left:11%;"><b>&minus;b</b>,
<b>&minus;&minus;heartbeat</b></p>

<p style="margin-left:22%;">Activate heartbeat support.</p>

<p style="margin-left:22%; margin-top: 1em">Regularly ping
client via heartbeat extension messages</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509fmtder</b></p>

<p style="margin-left:22%;">Use DER format for certificates
to read from.</p>


<p style="margin-left:11%;"><b>&minus;&minus;priority</b>=<i>string</i></p>

<p style="margin-left:22%;">Priorities string.</p>

<p style="margin-left:22%; margin-top: 1em">TLS algorithms
and protocols to enable. You can use predefined sets of
ciphersuites such as PERFORMANCE, NORMAL, SECURE128,
SECURE256. The default is NORMAL.</p>

<p style="margin-left:22%; margin-top: 1em">Check the
GnuTLS manual on section &ldquo;Priority strings&rdquo; for
more information on allowed keywords</p>


<p style="margin-left:11%;"><b>&minus;&minus;dhparams</b>=<i>file</i></p>

<p style="margin-left:22%;">DH params file to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509cafile</b>=<i>string</i></p>

<p style="margin-left:22%;">Certificate file or PKCS #11
URL to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509crlfile</b>=<i>file</i></p>

<p style="margin-left:22%;">CRL file to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pgpkeyfile</b>=<i>file</i></p>

<p style="margin-left:22%;">PGP Key file to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pgpkeyring</b>=<i>file</i></p>

<p style="margin-left:22%;">PGP Key ring file to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pgpcertfile</b>=<i>file</i></p>

<p style="margin-left:22%;">PGP Public Key (certificate)
file to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509keyfile</b>=<i>string</i></p>

<p style="margin-left:22%;">X.509 key file or PKCS #11 URL
to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509certfile</b>=<i>string</i></p>

<p style="margin-left:22%;">X.509 Certificate file or PKCS
#11 URL to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509dsakeyfile</b>=<i>string</i></p>

<p style="margin-left:22%;">Alternative X.509 key file or
PKCS #11 URL to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509dsacertfile</b>=<i>string</i></p>

<p style="margin-left:22%;">Alternative X.509 Certificate
file or PKCS #11 URL to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509ecckeyfile</b>=<i>string</i></p>

<p style="margin-left:22%;">Alternative X.509 key file or
PKCS #11 URL to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509ecccertfile</b>=<i>string</i></p>

<p style="margin-left:22%;">Alternative X.509 Certificate
file or PKCS #11 URL to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pgpsubkey</b>=<i>string</i></p>

<p style="margin-left:22%;">PGP subkey to use (hex or
auto).</p>


<p style="margin-left:11%;"><b>&minus;&minus;srppasswd</b>=<i>file</i></p>

<p style="margin-left:22%;">SRP password file to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;srppasswdconf</b>=<i>file</i></p>

<p style="margin-left:22%;">SRP password configuration file
to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pskpasswd</b>=<i>file</i></p>

<p style="margin-left:22%;">PSK password file to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pskhint</b>=<i>string</i></p>

<p style="margin-left:22%;">PSK identity hint to use.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ocsp&minus;response</b>=<i>file</i></p>

<p style="margin-left:22%;">The OCSP response to send to
client.</p>

<p style="margin-left:22%; margin-top: 1em">If the client
requested an OCSP response, return data from this file to
the client.</p>

<p style="margin-left:11%;"><b>&minus;p</b> <i>number</i>,
<b>&minus;&minus;port</b>=<i>number</i></p>

<p style="margin-left:22%;">The port to connect to. This
option takes an integer number as its argument.</p>

<p style="margin-left:11%;"><b>&minus;l</b>,
<b>&minus;&minus;list</b></p>

<p style="margin-left:22%;">Print a list of the supported
algorithms and modes.</p>

<p style="margin-left:22%; margin-top: 1em">Print a list of
the supported algorithms and modes. If a priority string is
given then only the enabled ciphersuites are shown.</p>


<p style="margin-left:11%;"><b>&minus;&minus;provider</b>=<i>file</i></p>

<p style="margin-left:22%;">Specify the PKCS #11 provider
library.</p>

<p style="margin-left:22%; margin-top: 1em">This will
override the default options in /etc/gnutls/pkcs11.conf</p>

<p style="margin-left:11%;"><b>&minus;h</b>,
<b>&minus;&minus;help</b></p>

<p style="margin-left:22%;">Display usage information and
exit.</p>

<p style="margin-left:11%;"><b>&minus;!</b>,
<b>&minus;&minus;more-help</b></p>

<p style="margin-left:22%;">Pass the extended usage
information through a pager.</p>

<p style="margin-left:11%;"><b>&minus;v</b> [{<i>v|c|n</i>
<b>&minus;&minus;version</b> [{<i>v|c|n</i>}]}]</p>

<p style="margin-left:22%;">Output version of program and
exit. The default mode is &lsquo;v&rsquo;, a simple version.
The &lsquo;c&rsquo; mode will print copyright information
and &lsquo;n&rsquo; will print the full copyright
notice.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Running your
own TLS server based on GnuTLS can be useful when debugging
clients and/or GnuTLS itself. This section describes how to
use <b>gnutls&minus;serv</b> as a simple HTTPS server.</p>

<p style="margin-left:11%; margin-top: 1em">The most basic
server can be started as:</p>


<p style="margin-left:17%; margin-top: 1em">gnutls&minus;serv
&minus;&minus;http &minus;&minus;priority
&quot;NORMAL:+ANON&minus;ECDH:+ANON&minus;DH&quot;</p>

<p style="margin-left:11%; margin-top: 1em">It will only
support anonymous ciphersuites, which many TLS clients
refuse to use.</p>

<p style="margin-left:11%; margin-top: 1em">The next step
is to add support for X.509. First we generate a CA:</p>

<p style="margin-left:17%; margin-top: 1em">$ certtool
&minus;&minus;generate&minus;privkey &gt;
x509&minus;ca&minus;key.pem <br>
$ echo &rsquo;cn = GnuTLS test CA&rsquo; &gt; ca.tmpl <br>
$ echo &rsquo;ca&rsquo; &gt;&gt; ca.tmpl <br>
$ echo &rsquo;cert_signing_key&rsquo; &gt;&gt; ca.tmpl <br>
$ certtool &minus;&minus;generate&minus;self&minus;signed
&minus;&minus;load&minus;privkey x509&minus;ca&minus;key.pem
&minus;&minus;template ca.tmpl &minus;&minus;outfile
x509&minus;ca.pem</p>

<p style="margin-left:11%; margin-top: 1em">Then generate a
server certificate. Remember to change the dns_name value to
the name of your server host, or skip that command to avoid
the field.</p>

<p style="margin-left:17%; margin-top: 1em">$ certtool
&minus;&minus;generate&minus;privkey &gt;
x509&minus;server&minus;key.pem <br>
$ echo &rsquo;organization = GnuTLS test server&rsquo; &gt;
server.tmpl <br>
$ echo &rsquo;cn = test.gnutls.org&rsquo; &gt;&gt;
server.tmpl <br>
$ echo &rsquo;tls_www_server&rsquo; &gt;&gt; server.tmpl
<br>
$ echo &rsquo;encryption_key&rsquo; &gt;&gt; server.tmpl
<br>
$ echo &rsquo;signing_key&rsquo; &gt;&gt; server.tmpl <br>
$ echo &rsquo;dns_name = test.gnutls.org&rsquo; &gt;&gt;
server.tmpl <br>
$ certtool &minus;&minus;generate&minus;certificate
&minus;&minus;load&minus;privkey
x509&minus;server&minus;key.pem
&minus;&minus;load&minus;ca&minus;certificate
x509&minus;ca.pem &minus;&minus;load&minus;ca&minus;privkey
x509&minus;ca&minus;key.pem &minus;&minus;template
server.tmpl &minus;&minus;outfile x509&minus;server.pem</p>

<p style="margin-left:11%; margin-top: 1em">For use in the
client, you may want to generate a client certificate as
well.</p>

<p style="margin-left:17%; margin-top: 1em">$ certtool
&minus;&minus;generate&minus;privkey &gt;
x509&minus;client&minus;key.pem <br>
$ echo &rsquo;cn = GnuTLS test client&rsquo; &gt;
client.tmpl <br>
$ echo &rsquo;tls_www_client&rsquo; &gt;&gt; client.tmpl
<br>
$ echo &rsquo;encryption_key&rsquo; &gt;&gt; client.tmpl
<br>
$ echo &rsquo;signing_key&rsquo; &gt;&gt; client.tmpl <br>
$ certtool &minus;&minus;generate&minus;certificate
&minus;&minus;load&minus;privkey
x509&minus;client&minus;key.pem
&minus;&minus;load&minus;ca&minus;certificate
x509&minus;ca.pem &minus;&minus;load&minus;ca&minus;privkey
x509&minus;ca&minus;key.pem &minus;&minus;template
client.tmpl &minus;&minus;outfile x509&minus;client.pem</p>

<p style="margin-left:11%; margin-top: 1em">To be able to
import the client key/certificate into some applications,
you will need to convert them into a PKCS#12 structure. This
also encrypts the security sensitive key with a
password.</p>

<p style="margin-left:17%; margin-top: 1em">$ certtool
&minus;&minus;to&minus;p12
&minus;&minus;load&minus;ca&minus;certificate
x509&minus;ca.pem &minus;&minus;load&minus;privkey
x509&minus;client&minus;key.pem
&minus;&minus;load&minus;certificate x509&minus;client.pem
&minus;&minus;outder &minus;&minus;outfile
x509&minus;client.p12</p>

<p style="margin-left:11%; margin-top: 1em">For icing,
we&rsquo;ll create a proxy certificate for the client
too.</p>

<p style="margin-left:17%; margin-top: 1em">$ certtool
&minus;&minus;generate&minus;privkey &gt;
x509&minus;proxy&minus;key.pem <br>
$ echo &rsquo;cn = GnuTLS test client proxy&rsquo; &gt;
proxy.tmpl <br>
$ certtool &minus;&minus;generate&minus;proxy
&minus;&minus;load&minus;privkey
x509&minus;proxy&minus;key.pem
&minus;&minus;load&minus;ca&minus;certificate
x509&minus;client.pem
&minus;&minus;load&minus;ca&minus;privkey
x509&minus;client&minus;key.pem
&minus;&minus;load&minus;certificate x509&minus;client.pem
&minus;&minus;template proxy.tmpl &minus;&minus;outfile
x509&minus;proxy.pem</p>

<p style="margin-left:11%; margin-top: 1em">Then start the
server again:</p>

<p style="margin-left:17%; margin-top: 1em">$
gnutls&minus;serv &minus;&minus;http
&minus;&minus;x509cafile x509&minus;ca.pem
&minus;&minus;x509keyfile x509&minus;server&minus;key.pem
&minus;&minus;x509certfile x509&minus;server.pem</p>

<p style="margin-left:11%; margin-top: 1em">Try connecting
to the server using your web browser. Note that the server
listens to port 5556 by default.</p>

<p style="margin-left:11%; margin-top: 1em">While you are
at it, to allow connections using DSA, you can also create a
DSA key and certificate for the server. These credentials
will be used in the final example below.</p>

<p style="margin-left:17%; margin-top: 1em">$ certtool
&minus;&minus;generate&minus;privkey &minus;&minus;dsa &gt;
x509&minus;server&minus;key&minus;dsa.pem <br>
$ certtool &minus;&minus;generate&minus;certificate
&minus;&minus;load&minus;privkey
x509&minus;server&minus;key&minus;dsa.pem
&minus;&minus;load&minus;ca&minus;certificate
x509&minus;ca.pem &minus;&minus;load&minus;ca&minus;privkey
x509&minus;ca&minus;key.pem &minus;&minus;template
server.tmpl &minus;&minus;outfile
x509&minus;server&minus;dsa.pem</p>

<p style="margin-left:11%; margin-top: 1em">The next step
is to create OpenPGP credentials for the server.</p>

<p style="margin-left:17%; margin-top: 1em">gpg
&minus;&minus;gen&minus;key</p>

<p style="margin-left:11%; margin-top: 1em">Make a note of
the OpenPGP key identifier of the newly generated key, here
it was <b>5D1D14D8</b>. You will need to export the key for
GnuTLS to be able to use it.</p>

<p style="margin-left:17%; margin-top: 1em">gpg &minus;a
&minus;&minus;export 5D1D14D8 &gt; openpgp&minus;server.txt
<br>
gpg &minus;&minus;export 5D1D14D8 &gt;
openpgp&minus;server.bin <br>
gpg &minus;&minus;export&minus;secret&minus;keys 5D1D14D8
&gt; openpgp&minus;server&minus;key.bin <br>
gpg &minus;a &minus;&minus;export&minus;secret&minus;keys
5D1D14D8 &gt; openpgp&minus;server&minus;key.txt</p>

<p style="margin-left:11%; margin-top: 1em">Let&rsquo;s
start the server with support for OpenPGP credentials:</p>


<p style="margin-left:17%; margin-top: 1em">gnutls&minus;serv
&minus;&minus;http &minus;&minus;priority
NORMAL:+CTYPE&minus;OPENPGP &minus;&minus;pgpkeyfile
openpgp&minus;server&minus;key.txt &minus;&minus;pgpcertfile
openpgp&minus;server.txt</p>

<p style="margin-left:11%; margin-top: 1em">The next step
is to add support for SRP authentication. This requires an
SRP password file created with <b>srptool</b>. To start the
server with SRP support:</p>


<p style="margin-left:17%; margin-top: 1em">gnutls&minus;serv
&minus;&minus;http &minus;&minus;priority
NORMAL:+SRP&minus;RSA:+SRP &minus;&minus;srppasswdconf
srp&minus;tpasswd.conf &minus;&minus;srppasswd
srp&minus;passwd.txt</p>

<p style="margin-left:11%; margin-top: 1em">Let&rsquo;s
also start a server with support for PSK. This would require
a password file created with <b>psktool</b>.</p>


<p style="margin-left:17%; margin-top: 1em">gnutls&minus;serv
&minus;&minus;http &minus;&minus;priority
NORMAL:+ECDHE&minus;PSK:+PSK &minus;&minus;pskpasswd
psk&minus;passwd.txt</p>

<p style="margin-left:11%; margin-top: 1em">Finally, we
start the server with all the earlier parameters and you get
this command:</p>


<p style="margin-left:17%; margin-top: 1em">gnutls&minus;serv
&minus;&minus;http &minus;&minus;priority
NORMAL:+PSK:+SRP:+CTYPE&minus;OPENPGP
&minus;&minus;x509cafile x509&minus;ca.pem
&minus;&minus;x509keyfile x509&minus;server&minus;key.pem
&minus;&minus;x509certfile x509&minus;server.pem
&minus;&minus;x509dsakeyfile
x509&minus;server&minus;key&minus;dsa.pem
&minus;&minus;x509dsacertfile
x509&minus;server&minus;dsa.pem &minus;&minus;pgpkeyfile
openpgp&minus;server&minus;key.txt &minus;&minus;pgpcertfile
openpgp&minus;server.txt &minus;&minus;srppasswdconf
srp&minus;tpasswd.conf &minus;&minus;srppasswd
srp&minus;passwd.txt &minus;&minus;pskpasswd
psk&minus;passwd.txt</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">One of the
following exit values will be returned: <br>
0 (EXIT_SUCCESS)</p>

<p style="margin-left:22%;">Successful program
execution.</p>

<p style="margin-left:11%;">1 (EXIT_FAILURE)</p>

<p style="margin-left:22%;">The operation failed or the
command syntax was not valid.</p>

<p style="margin-left:11%;">70 (EX_SOFTWARE)</p>

<p style="margin-left:22%;">libopts had an internal
operational error. Please report it to
autogen-users@lists.sourceforge.net. Thank you.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">gnutls&minus;cli&minus;debug(1),
gnutls&minus;cli(1)</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Nikos
Mavrogiannopoulos, Simon Josefsson and others; see
/usr/share/doc/gnutls/AUTHORS for a complete list.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2000-2016 Free Software Foundation, and others all rights
reserved. This program is released under the terms of the
GNU General Public License, version 3 or later.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please send bug
reports to: bugs@gnutls.org</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This manual
page was <i>AutoGen</i>-erated from the <b>gnutls-serv</b>
option definitions.</p>
<hr>
</body>
</html>
