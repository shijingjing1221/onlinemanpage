<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:10:15 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PMGETOPT</title>

</head>
<body>

<h1 align="center">PMGETOPT</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONFIGURATION">CONFIGURATION</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#PCP ENVIRONMENT">PCP ENVIRONMENT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pmgetopt</b>
&minus; Performance Co-Pilot shell script option parser</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>$PCP_BINADM_DIR/pmgetopt</b>
[<b>&minus;c</b>|<b>&minus;&minus;config</b> <i>file</i>]
[<b>&minus;p</b>|<b>&minus;&minus;progname</b> <i>name</i>]
[<b>&minus;u</b>|<b>&minus;&minus;usage</b>]
[<b>&minus;&minus;</b>] [<i>parameters</i>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pmgetopt</b>
is used to perform command line option parsing for shell
scripts used in the Performance Co-Pilot (PCP toolkit). It
is also used to generate usage messages for those
scripts.</p>

<p style="margin-left:11%; margin-top: 1em">The parameters
given to <b>pmgetopt</b> take two forms: initially, options
specific to <b>pmgetopt</b> itself are passed in, and
terminated using the &minus;&minus; mechanism. Thereafter,
all of the parameters passed into the shell script should be
passed (usually this is simply the &quot;$@&quot;
variable).</p>

<p style="margin-left:11%; margin-top: 1em">The options
specific to <b>pmgetopt</b> are as follows: <b><br>
&minus;c</b>,<b>&minus;&minus;config</b></p>

<p style="margin-left:18%;">A configuration <i>file</i> in
the format described below is passed to <b>pmconfig</b>
using this option. If this option is omitted, then
<b>pmconfig</b> will read its configuration from the
standard input stream.</p>


<p style="margin-left:11%;"><b>&minus;p</b>,<b>&minus;&minus;progname</b></p>

<p style="margin-left:18%;">When parsing the calling shell
scripts parameters, error and usage messages will contain
the given program <i>name</i> rather than referring to
<b>pmgetopt</b> itself as the source of the error.</p>


<p style="margin-left:11%;"><b>&minus;u</b>,<b>&minus;&minus;usage</b></p>

<p style="margin-left:18%;">A usage message appropriate for
the calling shell script to present as its own can be
generated using the option.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pmgetopt</b>
parses the given parameters, and produces output in a format
suitable for sourcing in the calling shell script. When both
short and long forms of an argument are allowed by the
specification, <b>pmgetopt</b> will always indicate the
short form for simpler shell processing. If arguments are
presented that do not match the configuration, a request for
a usage message (&minus;?) will be generated for the calling
script to respond to. Any non-option parameters will be
echoed back to the calling script preceded by the
double-hyphen delimiter. Thus a script should stop handling
options when this delimiter is detected, and begin the
handling of any non-option arguments.</p>

<p style="margin-left:11%; margin-top: 1em">Unlike with the
shell built-in <i>getopt</i> command, variables like $OPTARG
are not set and the calling script will typically employ use
of the shell built-in <i>eval</i>, <i>set</i> and positional
<i>shift</i> commands to ensure option processing occurs
correctly.</p>

<h2>CONFIGURATION
<a name="CONFIGURATION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
configuration format used by <b>pmgetopt</b> is intended to
closely reflect the usage message which would be generated
in the presence of invalid arguments (or the
<b>&minus;?</b>,<b>&minus;&minus;help</b> option).</p>

<p style="margin-left:11%; margin-top: 1em">There are
primarily two types of configuration line &minus; commands
and options. Commands allow metadata to be passed into the
option processing process, and options are the allowable
command line options that the shell script will accept.
Command lines are preceded by the hash character, whereas
option lines will always begin with a hyphen (either single
or double). Any other line in the configuration, which may
include usage headers or descriptive text, has no impact on
the option parsing and will be copied unmodified into the
usage message.</p>

<p style="margin-left:11%; margin-top: 1em">The set of
commands is: <i>getopt</i> (provide short-argument option
specification manually, if not present this will be
generated from the options presented), <i>usage</i> (provide
short one-line summary used at the head of the usage
message, which will be prefixed by the <i>progname</i>
before reporting), and <i>end</i> which informs
<b>pmgetopt</b> to stop processing further commands and
options &minus; any subsequent text encountered will be
simply appended to the usage message.</p>

<p style="margin-left:11%; margin-top: 1em">A short-hand
notation exists for each of the standard PCP options, as
described in <b>PCPIntro</b>(1). If any of these options
(e.g <b>&minus;&minus;host</b>) appears as a single word on
any line, it will be transformed into the appropriate option
for the shell script, including all metadata about that
option (whether it accepts an argument, both short and long
option forms, and so on).</p>

<p style="margin-left:11%; margin-top: 1em">Use of the
equals symbol (&quot;=&quot;) indicates the presence of a
required argument to any option, for both short and long
forms. Any non-standard option must be accompanied by a
non-empty description of that argument.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">As an example,
the following is a valid configuration:</p>

<p style="margin-left:18%; margin-top: 1em"><b># Usage:
[options] node...</b></p>

<p style="margin-left:18%; margin-top: 1em"><b>Options:
<br>
&minus;&minus;archive <br>
&minus;d, &minus;&minus;delay pause between updates for
archive replay <br>
&minus;&minus;host <br>
&minus;&minus;interval <br>
&minus;i=INST, &minus;&minus;insts=INST comma-separated
metrics instance list <br>
&minus;r output raw counters (no rate conversion) <br>
&minus;&minus;width=N set the width of each column of output
<br>
&minus;&minus;timezone <br>
&minus;&minus;help</b></p>

<p style="margin-left:11%; margin-top: 1em">This
configuration will produce the following usage message, when
run as shown.</p>

<p style="margin-left:18%; margin-top: 1em"><b>$ pmgetopt
&minus;&minus;usage &minus;&minus;progname=clusterstat
&minus;&minus; &quot;$@&quot; <br>
Usage: clusterstat [options] node...</b></p>

<p style="margin-left:18%; margin-top: 1em"><b>Options:
<br>
&minus;a FILE, &minus;&minus;archive=FILE <br>
metrics source is a PCP log archive <br>
&minus;d, &minus;&minus;delay pause between updates for
archive replay <br>
&minus;h HOST, &minus;&minus;host=HOST metrics source is
PMCD on host <br>
&minus;t DELTA, &minus;&minus;interval=DELTA <br>
sampling interval <br>
&minus;i INST, &minus;&minus;insts=INST comma-separated
metrics instance list <br>
&minus;r output raw counters (no rate conversion) <br>
&minus;&minus;width=N set the width of each column of output
<br>
&minus;Z TZ, &minus;&minus;timezone=TZ set reporting
timezone <br>
&minus;?, &minus;&minus;help show this usage message and
exit</b></p>

<p style="margin-left:11%; margin-top: 1em">Several
examples of <b>pmgetopt</b> use form part of the PCP
toolkit, in particular the <b>pcp</b>(1) and
<b>pmlogmv</b>(1) scripts provide good reference
examples.</p>

<h2>PCP ENVIRONMENT
<a name="PCP ENVIRONMENT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Environment
variables with the prefix <b>PCP_</b> are used to
parameterize the file and directory names used by PCP. On
each installation, the file <i>/etc/pcp.conf</i> contains
the local values for these variables. The <b>$PCP_CONF</b>
variable may be used to specify an alternative configuration
file, as described in <b>pcp.conf</b>(5).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>pcp</b>(1),
<b>pmlogmv</b>(1), <b>pmgetopt_r</b>(3), <b>pcp.conf</b>(5)
and <b>pcp.env</b>(5).</p>
<hr>
</body>
</html>
