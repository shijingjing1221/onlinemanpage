<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:51:25 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>libguestfs-test-tool</title>

</head>
<body>

<h1 align="center">libguestfs-test-tool</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#TRYING OUT A DIFFERENT VERSION OF QEMU">TRYING OUT A DIFFERENT VERSION OF QEMU</a><br>
<a href="#TRYING OUT A DIFFERENT KERNEL">TRYING OUT A DIFFERENT KERNEL</a><br>
<a href="#TRYING OUT A DIFFERENT VERSION OF LIBVIRT">TRYING OUT A DIFFERENT VERSION OF LIBVIRT</a><br>
<a href="#TRYING OUT WITH / WITHOUT LIBVIRT">TRYING OUT WITH / WITHOUT LIBVIRT</a><br>
<a href="#TRYING OUT DIFFERENT SELINUX SETTINGS">TRYING OUT DIFFERENT SELINUX SETTINGS</a><br>
<a href="#SELF-DIAGNOSIS">SELF-DIAGNOSIS</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#BUGS">BUGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">libguestfs&minus;test&minus;tool
&minus; Diagnostics for libguestfs</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em"> libguestfs&minus;test&minus;tool [&minus;&minus;options]</pre>


<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">libguestfs-test-tool
is a test program shipped with libguestfs to allow you to
check basic libguestfs functionality is working. This is
needed because libguestfs occasionally breaks for reasons
beyond our control: usually because of changes in the
underlying qemu or kernel packages, or the host
environment.</p>

<p style="margin-left:11%; margin-top: 1em">If you suspect
a problem in libguestfs, then just run:</p>

<pre style="margin-left:11%; margin-top: 1em"> libguestfs&minus;test&minus;tool</pre>


<p style="margin-left:11%; margin-top: 1em">It will print
lots of diagnostic messages.</p>

<p style="margin-left:11%; margin-top: 1em">If it runs to
completion successfully, you will see this near the end:</p>

<pre style="margin-left:11%; margin-top: 1em"> ===== TEST FINISHED OK =====</pre>


<p style="margin-left:11%; margin-top: 1em">and the test
tool will exit with code 0.</p>

<p style="margin-left:11%; margin-top: 1em">If it fails
(and/or exits with non-zero error code), please paste the
<i>complete, unedited</i> output of the test tool into a bug
report. More information about reporting bugs can be found
on the http://libguestfs.org/ website.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;help</b></p>

<p style="margin-left:17%;">Display short usage information
and exit.</p>

<p style="margin-left:11%;"><b>&minus;&minus;qemu
qemu_binary</b></p>

<p style="margin-left:17%;">If you have downloaded another
qemu binary, point this option at the full path of the
binary to try it.</p>

<p style="margin-left:11%;"><b>&minus;&minus;qemudir
qemu_source_dir</b></p>

<p style="margin-left:17%;">If you have compiled qemu from
source, point this option at the source directory to try
it.</p>

<p style="margin-left:11%;"><b>&minus;t N <br>
&minus;&minus;timeout N</b></p>

<p style="margin-left:17%;">Set the launch timeout to
<tt>&quot;N&quot;</tt> seconds. The default is 600 seconds
(10 minutes) which does not usually need to be adjusted.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;V</b></p></td>
<td width="86%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;version</b></p>

<p style="margin-left:17%;">Display the libguestfs version
number and exit.</p>

<h2>TRYING OUT A DIFFERENT VERSION OF QEMU
<a name="TRYING OUT A DIFFERENT VERSION OF QEMU"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">If you have
compiled another version of qemu from source and would like
to try that, then you can use the
<i>&minus;&minus;qemudir</i> option to point to the qemu
source directory.</p>

<p style="margin-left:11%; margin-top: 1em">If you have
downloaded a qemu binary from somewhere, use the
<i>&minus;&minus;qemu</i> option to point to the binary.</p>

<p style="margin-left:11%; margin-top: 1em">Note when using
these options, you can ignore the business of qemu wrapper
scripts (&quot; <small>QEMU WRAPPERS&quot;</small> in
<i>guestfs</i>(3)), since libguestfs-test-tool writes a
wrapper script for you if one is needed.</p>

<h2>TRYING OUT A DIFFERENT KERNEL
<a name="TRYING OUT A DIFFERENT KERNEL"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">You can tell
supermin to try a different kernel. You do this by setting
the environment variables
<tt>&quot;SUPERMIN_KERNEL&quot;</tt>,
<tt>&quot;SUPERMIN_KERNEL_VERSION&quot;</tt> and/or
<tt>&quot;SUPERMIN_MODULES&quot;</tt>.</p>

<p style="margin-left:11%; margin-top: 1em">Refer to &quot;
<small>ENVIRONMENT VARIABLES&quot;</small> in
<i>supermin</i>(1) for further information.</p>

<h2>TRYING OUT A DIFFERENT VERSION OF LIBVIRT
<a name="TRYING OUT A DIFFERENT VERSION OF LIBVIRT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To find out
which backend is the default in your libguestfs package,
do:</p>

<pre style="margin-left:11%; margin-top: 1em"> unset LIBGUESTFS_BACKEND
 guestfish get&minus;backend</pre>


<p style="margin-left:11%; margin-top: 1em">If you are
using the libvirt backend, then you can try out a different
(eg. upstream) version of libvirt by running these commands
(<i>not</i> as root):</p>

<pre style="margin-left:11%; margin-top: 1em"> killall libvirtd lt&minus;libvirtd
 ~/path/to/libvirt/run libguestfs&minus;test&minus;tool</pre>


<p style="margin-left:11%; margin-top: 1em">The first
command kills any session <tt>&quot;libvirtd&quot;</tt>
process(es) that may be running on the machine. The second
command uses libvirt&rsquo;s <tt>&quot;run&quot;</tt> script
(in the top-level libvirt build directory) to set some
environment variables so that the alternate version of
libvirt is used to run the program.</p>

<h2>TRYING OUT WITH / WITHOUT LIBVIRT
<a name="TRYING OUT WITH / WITHOUT LIBVIRT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To find out
which backend is the default in your libguestfs package,
do:</p>

<pre style="margin-left:11%; margin-top: 1em"> unset LIBGUESTFS_BACKEND
 guestfish get&minus;backend</pre>


<p style="margin-left:11%; margin-top: 1em">If you are
using the libvirt backend, you can try without (ie.
libguestfs directly launching qemu) by doing:</p>

<pre style="margin-left:11%; margin-top: 1em"> export LIBGUESTFS_BACKEND=direct</pre>


<p style="margin-left:11%; margin-top: 1em">Or if you are
using the default (direct) backend, then you can try
libvirt:</p>

<pre style="margin-left:11%; margin-top: 1em"> export LIBGUESTFS_BACKEND=libvirt</pre>


<p style="margin-left:11%; margin-top: 1em">or with libvirt
and a specific libvirt <small>URI</small> :</p>

<pre style="margin-left:11%; margin-top: 1em"> export LIBGUESTFS_BACKEND=libvirt:qemu:///session</pre>


<h2>TRYING OUT DIFFERENT SELINUX SETTINGS
<a name="TRYING OUT DIFFERENT SELINUX SETTINGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To find out
which backend is the default in your libguestfs package,
do:</p>

<pre style="margin-left:11%; margin-top: 1em"> unset LIBGUESTFS_BACKEND
 guestfish get&minus;backend</pre>


<p style="margin-left:11%; margin-top: 1em">To find out if
SELinux is being used, do:</p>

<pre style="margin-left:11%; margin-top: 1em"> getenforce</pre>


<p style="margin-left:11%; margin-top: 1em">If you are
using libvirt, SELinux and sVirt, then you can try to see if
changing SELinux to &quot;permissive&quot; mode makes any
difference. Use this command as root:</p>

<pre style="margin-left:11%; margin-top: 1em"> setenforce Permissive</pre>


<p style="margin-left:11%; margin-top: 1em">If this makes a
difference, look in the audit logs for recent failures
(&quot;AVCs&quot;):</p>

<pre style="margin-left:11%; margin-top: 1em"> ausearch &minus;m avc &minus;ts recent</pre>


<p style="margin-left:11%; margin-top: 1em">You can convert
AVCs into suggested SELinux policy rules using tools like
<i>audit2allow</i>(1). For more information, see the
&quot;Security Enhanced Linux User Guide&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">To reenable
SELinux and sVirt, do:</p>

<pre style="margin-left:11%; margin-top: 1em"> setenforce Enforcing</pre>


<h2>SELF-DIAGNOSIS
<a name="SELF-DIAGNOSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Refer to &quot;
<small>APPLIANCE BOOT PROCESS&quot;</small> in
<i>guestfs</i>(3) to understand the messages produced by
libguestfs-test-tool and/or possible errors.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">libguestfs-test-tool
returns <i>0</i> if the tests completed without error, or
<i>1</i> if there was an error.</p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For the full
list of environment variables which may affect libguestfs,
please see the <i>guestfs</i>(3) manual page.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>guestfs</i>(3),
http://libguestfs.org/, http://qemu.org/.</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Richard W.M.
Jones (<tt>&quot;rjones at redhat dot com&quot;</tt>)</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2009&minus;2016 Red Hat Inc.</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This program is
free software; you can redistribute it and/or modify it
under the terms of the <small>GNU</small> General Public
License as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later
version.</p>

<p style="margin-left:11%; margin-top: 1em">This program is
distributed in the hope that it will be useful, but
<small>WITHOUT ANY WARRANTY</small> ; without even the
implied warranty of <small>MERCHANTABILITY</small> or
<small>FITNESS FOR A PARTICULAR PURPOSE.</small> See the
<small>GNU</small> General Public License for more
details.</p>

<p style="margin-left:11%; margin-top: 1em">You should have
received a copy of the <small>GNU</small> General Public
License along with this program; if not, write to the Free
Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
Boston, <small>MA 02110&minus;1301 USA.</small></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To get a list
of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p style="margin-left:11%; margin-top: 1em">To report a new
bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p style="margin-left:11%; margin-top: 1em">When reporting
a bug, please supply:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The version of libguestfs.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Where you got libguestfs (eg. which Linux distro,
compiled from source, etc)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Describe the bug accurately and give a way to reproduce
it.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Run <i>libguestfs&minus;test&minus;tool</i>(1) and paste
the <b>complete, unedited</b> output into the bug
report.</p> </td></tr>
 </table>
<hr>
</body>
</html>
