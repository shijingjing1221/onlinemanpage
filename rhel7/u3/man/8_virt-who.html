<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:51:02 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>VIRT-WHO</title>

</head>
<body>

<h1 align="center">VIRT-WHO</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#ENVIRONMENT">ENVIRONMENT</a><br>
<a href="#USAGE">USAGE</a><br>
<a href="#LOGGING">LOGGING</a><br>
<a href="#SECURITY">SECURITY</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">virt-who -
Agent for reporting virtual guest IDs to Subscription Asset
Manager, Satellite 6, or Satellite 5.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">virt-who [-d]
[-i INTERVAL] [-b] [-o] [--sam|--satellite5|--satellite6]
[--libvirt|--vdsm|--esx|--rhevm|--hyperv]</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;h</b>,
<b>&minus;&minus;help</b></p>

<p style="margin-left:22%;">show this help message and
exit</p>

<p style="margin-left:11%;"><b>&minus;d</b>,
<b>&minus;&minus;debug</b></p>

<p style="margin-left:22%;">Enable debugging output</p>

<p style="margin-left:11%;"><b>&minus;o</b>,
<b>&minus;&minus;one&minus;shot</b></p>

<p style="margin-left:22%;">Send the list of guest IDs and
exit immediately</p>

<p style="margin-left:11%;"><b>&minus;i</b> INTERVAL,
<b>&minus;&minus;interval</b>=<i>INTERVAL</i></p>

<p style="margin-left:22%;">Acquire and send guest
information each N seconds; note that this option is
recommendation only, requested interval might not been
honoured and the actual interval might be longer or shorter
depending on backend that is used.</p>

<p style="margin-left:11%;"><b>&minus;p</b>,
<b>&minus;&minus;print</b></p>

<p style="margin-left:22%;">Print the host/guests
association in JSON format to stdout</p>

<p style="margin-left:11%;"><b>&minus;c</b>,
<b>&minus;&minus;config</b></p>

<p style="margin-left:22%;">Use configuration file
directly, can be used multiple times. See virt-who-config(5)
for details about configuration file format.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Virtualization
backend</b></p>

<p style="margin-left:22%;">Choose virtualization backend
that should be used to gather host/guest associations</p>


<p style="margin-left:11%;"><b>&minus;&minus;libvirt</b></p>

<p style="margin-left:22%;">Use libvirt to list virtual
guests [default]</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;vdsm</b></p></td>
<td width="2%"></td>
<td width="53%">


<p>Use vdsm to list virtual guests</p></td>
<td width="25%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;esx</b></p></td>
<td width="2%"></td>
<td width="53%">


<p>Register ESX machines using vCenter</p></td>
<td width="25%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;&minus;rhevm</b></p>

<p style="margin-left:22%;">Register guests using
RHEV&minus;M</p>


<p style="margin-left:11%;"><b>&minus;&minus;hyperv</b></p>

<p style="margin-left:22%;">Register guests using
Hyper&minus;V</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>&minus;&minus;xen</b></p></td>
<td width="4%"></td>
<td width="56%">


<p>Register XEN machines using XenServer</p></td>
<td width="22%">
</td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>Subscription
manager</b></p>

<p style="margin-left:22%;">Choose where the host/guest
associations should be reported</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p style="margin-top: 1em"><b>&minus;&minus;sam</b></p></td>
<td width="4%"></td>
<td width="78%">


<p style="margin-top: 1em">Report host/guest associations
to the Subscription Asset Manager or Satellite 6
[default]</p> </td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;satellite5</b></p>

<p style="margin-left:22%;">Report host/guest associations
to the Satellite 5 server</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;satellite6</b>
Report host/guest associations to the Satellite 6 server</p>

<p style="margin-left:11%; margin-top: 1em"><b>Libvirt
options</b></p>

<p style="margin-left:22%;">Use this options with
<b>&minus;&minus;libvirt</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;libvirt&minus;owner</b>=<i>OWNER</i></p>

<p style="margin-left:22%;">Organization who has purchased
subscriptions of the products, same as current system
registration by default</p>


<p style="margin-left:11%;"><b>&minus;&minus;libvirt&minus;env</b>=<i>ENV</i></p>

<p style="margin-left:22%;">Environment where the libvirt
server belongs to, same as current system registration by
default</p>


<p style="margin-left:11%;"><b>&minus;&minus;libvirt&minus;server</b>=<i>SERVER</i></p>

<p style="margin-left:22%;">URL of the remote libvirt
server to connect to, local server by default</p>


<p style="margin-left:11%;"><b>&minus;&minus;libvirt&minus;username</b>=<i>USERNAME</i></p>

<p style="margin-left:22%;">Username for connecting to
libvirt, username of current user by default</p>


<p style="margin-left:11%;"><b>&minus;&minus;libvirt&minus;password</b>=<i>PASSWORD</i></p>

<p style="margin-left:22%;">Password for connecting to
libvirt. This option doesn&rsquo;t work with ssh transport
(default), copy your public ssh key to the remote
machine.</p>

<p style="margin-left:11%; margin-top: 1em"><b>vCenter/ESX
options</b></p>

<p style="margin-left:22%;">Use this options with
<b>&minus;&minus;esx</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;esx&minus;owner</b>=<i>OWNER</i></p>

<p style="margin-left:22%;">Organization who has purchased
subscriptions of the products</p>


<p style="margin-left:11%;"><b>&minus;&minus;esx&minus;env</b>=<i>ENV</i></p>

<p style="margin-left:22%;">Environment where the vCenter
server belongs to</p>


<p style="margin-left:11%;"><b>&minus;&minus;esx&minus;server</b>=<i>SERVER</i></p>

<p style="margin-left:22%;">URL of the vCenter server to
connect to</p>


<p style="margin-left:11%;"><b>&minus;&minus;esx&minus;username</b>=<i>USERNAME</i></p>

<p style="margin-left:22%;">Username for connecting to
vCenter</p>


<p style="margin-left:11%;"><b>&minus;&minus;esx&minus;password</b>=<i>PASSWORD</i></p>

<p style="margin-left:22%;">Password for connecting to
vCenter</p>


<p style="margin-left:11%; margin-top: 1em"><b>RHEV&minus;M
options</b></p>

<p style="margin-left:22%;">Use this options with
<b>&minus;&minus;rhevm</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;rhevm&minus;owner</b>=<i>OWNER</i></p>

<p style="margin-left:22%;">Organization who has purchased
subscriptions of the products</p>


<p style="margin-left:11%;"><b>&minus;&minus;rhevm&minus;env</b>=<i>ENV</i></p>

<p style="margin-left:22%;">Environment where the
RHEV&minus;M belongs to</p>


<p style="margin-left:11%;"><b>&minus;&minus;rhevm&minus;server</b>=<i>SERVER</i></p>

<p style="margin-left:22%;">URL of the RHEV&minus;M server
to connect to</p>


<p style="margin-left:11%;"><b>&minus;&minus;rhevm&minus;username</b>=<i>USERNAME</i></p>

<p style="margin-left:22%;">Username for connecting to
RHEV&minus;M</p>


<p style="margin-left:11%;"><b>&minus;&minus;rhevm&minus;password</b>=<i>PASSWORD</i></p>

<p style="margin-left:22%;">Password for connecting to
RHEV&minus;M</p>


<p style="margin-left:11%; margin-top: 1em"><b>Hyper&minus;V
options</b></p>

<p style="margin-left:22%;">Use this options with
<b>&minus;&minus;hyperv</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;hyperv&minus;owner</b>=<i>OWNER</i></p>

<p style="margin-left:22%;">Organization who has purchased
subscriptions of the products</p>


<p style="margin-left:11%;"><b>&minus;&minus;hyperv&minus;env</b>=<i>ENV</i></p>

<p style="margin-left:22%;">Environment where the
Hyper&minus;V belongs to</p>


<p style="margin-left:11%;"><b>&minus;&minus;hyperv&minus;server</b>=<i>SERVER</i></p>

<p style="margin-left:22%;">URL of the Hyper&minus;V server
to connect to</p>


<p style="margin-left:11%;"><b>&minus;&minus;hyperv&minus;username</b>=<i>USERNAME</i></p>

<p style="margin-left:22%;">Username for connecting to
Hyper&minus;V</p>


<p style="margin-left:11%;"><b>&minus;&minus;hyperv&minus;password</b>=<i>PASSWORD</i></p>

<p style="margin-left:22%;">Password for connecting to
Hyper&minus;V</p>

<p style="margin-left:11%; margin-top: 1em"><b>XenServer
options</b></p>

<p style="margin-left:22%;">Use this options with
<b>&minus;&minus;xen</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;xen&minus;owner</b>=<i>OWNER</i></p>

<p style="margin-left:22%;">Organization who has purchased
subscriptions of the products</p>


<p style="margin-left:11%;"><b>&minus;&minus;xen&minus;env</b>=<i>ENV</i></p>

<p style="margin-left:22%;">Environment where the XenServer
belongs to</p>


<p style="margin-left:11%;"><b>&minus;&minus;xen&minus;server</b>=<i>SERVER</i></p>

<p style="margin-left:22%;">URL of the XenServer server to
connect to</p>


<p style="margin-left:11%;"><b>&minus;&minus;xen&minus;username</b>=<i>USERNAME</i></p>

<p style="margin-left:22%;">Username for connecting to
XenServer</p>


<p style="margin-left:11%;"><b>&minus;&minus;xen&minus;password</b>=<i>PASSWORD</i></p>

<p style="margin-left:22%;">Password for connecting to
XenServer</p>

<p style="margin-left:11%; margin-top: 1em"><b>Satellite 5
options:</b></p>

<p style="margin-left:22%;">Use this options with
<b>&minus;&minus;satellite5</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;satellite-server</b>=<i>SAT_SERVER</i></p>

<p style="margin-left:22%;">Satellite server URL</p>


<p style="margin-left:11%;"><b>&minus;&minus;satellite-username</b>=<i>SAT_USERNAME</i></p>

<p style="margin-left:22%;">Username for connecting to
Satellite server</p>


<p style="margin-left:11%;"><b>&minus;&minus;satellite-password</b>=<i>SAT_PASSWORD</i></p>

<p style="margin-left:22%;">Password for connecting to
Satellite server</p>

<h2>ENVIRONMENT
<a name="ENVIRONMENT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">virt-who also
reads environmental variables. They have the same name as
command line arguments but upper-cased, with underscore
instead of dash and prefixed with VIRTWHO_ (e.g.
VIRTWHO_ONE_SHOT). Empty variables are considered as
disabled, non-empty as enabled</p>

<h2>USAGE
<a name="USAGE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>MODE</b>
<br>
virt-who has three modes how it can run: <br>
1. one-shot mode</p>

<p style="margin-left:22%;"># virt-who -o</p>

<p style="margin-left:22%; margin-top: 1em">In this mode
virt-who just sends the host to guest association to the
server once and then exits.</p>

<p style="margin-left:11%;">2. interval mode</p>

<p style="margin-left:22%;"># virt-who</p>

<p style="margin-left:22%; margin-top: 1em">This is default
mode. virt-who will listen to change events (if available)
or do a polling with given interval, and will send the host
to guest association when it changes. The default polling
interval is 60 seconds and can be changed using &quot;-i
INTERVAL&quot; (in seconds).</p>

<p style="margin-left:11%;">3. print mode</p>

<p style="margin-left:22%;"># virt-who -p</p>

<p style="margin-left:22%; margin-top: 1em">This mode is
similar to oneshot mode but the host to guest association is
not send to server, but printed to standard output
instead.</p>


<p style="margin-left:11%; margin-top: 1em"><b>VIRTUALIZATION
BACKEND</b> <br>
virt-who can use couple of virtualization backends. <br>
1. libvirt</p>

<p style="margin-left:22%;"># virt-who</p>

<p style="margin-left:22%; margin-top: 1em"># virt-who
--libvirt</p>

<p style="margin-left:22%; margin-top: 1em">Use libvirt as
virtualization backend. This is default.</p>

<p style="margin-left:22%; margin-top: 1em">NOTE: virt-who
can monitor for events only in this mode.</p>

<p style="margin-left:11%;">2. vdsm</p>

<p style="margin-left:22%;"># virt-who --vdsm</p>

<p style="margin-left:22%; margin-top: 1em">Use vdsm as
virtualization backend.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>3. ESX</p></td>
<td width="2%"></td>
<td width="78%">


<p># virt-who --esx --esx-owner=ESX_OWNER --esx-env=ESX_ENV
--esx-server=ESX_SERVER --esx-username=ESX_USERNAME
--esx-password=ESX_PASSWORD</p> </td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">Use ESX
(vCenter) as virtualization backend and specify option
required to connect to ESX server.</p>

<p style="margin-left:11%;">4. RHEV-M</p>

<p style="margin-left:22%; margin-top: 1em"># virt-who
--rhevm --rhevm-owner=RHEVM_OWNER --rhevm-env=RHEVM_ENV
--rhevm-server=RHEVM_SERVER --rhevm-username=RHEVM_USERNAME
--rhevm-password=RHEVM_PASSWORD</p>

<p style="margin-left:22%; margin-top: 1em">Use RHEV-M as
virtualization backend and specify option required to
connect to RHEV-M server.</p>

<p style="margin-left:11%;">5. Hyper-V</p>

<p style="margin-left:22%; margin-top: 1em"># virt-who
--hyperv --hyperv-owner=HYPERV_OWNER --hyperv-env=HYPERV_ENV
--hyperv-server=HYPERV_SERVER
--hyperv-username=HYPERV_USERNAME
--hyperv-password=HYPERV_PASSWORD</p>

<p style="margin-left:22%; margin-top: 1em">Use Hyper-V as
virtualization backend and specify option required to
connect to Hyper-V server.</p>

<p style="margin-left:11%;">6. XenServer</p>

<p style="margin-left:22%; margin-top: 1em"># virt-who
--xen --xen-owner=XEN_OWNER --xen-env=XEN_ENV
--xen-server=XEN_SERVER --xen-username=XEN_USERNAME
--xen-password=XEN_PASSWORD</p>

<p style="margin-left:22%; margin-top: 1em">Use Citrix
XenServer as virtualization backend and specify option
required to connect to XenServer server.</p>

<p style="margin-left:11%;">7. Fake</p>

<p style="margin-left:22%; margin-top: 1em">Fake
virtualization backend fetches the host/guests association
from file. This can be useful in environments where the
hypervisor is not accessible by virt-who. It&rsquo;s only
available through configuration file, see virt-who-config(5)
for details about configuration of this backend.</p>


<p style="margin-left:11%; margin-top: 1em"><b>SUBSCRIPTION
MANAGER</b> <br>
virt-who can report host/guest associations to Subscription
Asset Manager (SAM), to Satellite 5, or to Satellite 6. <br>
1. Subscription Asset Manager or Satellite 6</p>

<p style="margin-left:22%;"># virt-who</p>

<p style="margin-left:22%; margin-top: 1em"># virt-who
--sam</p>

<p style="margin-left:22%; margin-top: 1em">System must be
registered using subscription-manager prior to using
virt-who. Configuration for connecting to SAM is shared
between subscription-manager and virt-who. This is
default.</p>

<p style="margin-left:11%;">2. Satellite 6</p>

<p style="margin-left:22%; margin-top: 1em"># virt-who
--satellite6</p>

<p style="margin-left:22%; margin-top: 1em">System must be
registered using subscription-manager prior to using
virt-who. Configuration for connecting to Satellite 6 is
shared between subscription-manager and virt-who.</p>

<p style="margin-left:11%;">2. Satellite 5</p>

<p style="margin-left:22%; margin-top: 1em"># virt-who
--satellite5 --satellite-server=SAT_SERVER
--satellite-username=SAT_USERNAME
--satellite-password=SAT_PASSWORD</p>

<p style="margin-left:22%; margin-top: 1em">This option
can&rsquo;t be used for monitoring local guests, use
rhn-virtualization-host instead.</p>

<h2>LOGGING
<a name="LOGGING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">virt-who always
writes error output to file /var/log/rhsm/rhsm.log. In all
modes, excluding background (&quot;-b&quot;), it writes same
output also to the standard error output.</p>

<p style="margin-left:11%; margin-top: 1em">virt-who can be
started with option &quot;-d&quot; in all modes and with all
backends. This option will enable verbose output with more
information.</p>

<h2>SECURITY
<a name="SECURITY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Virt-who may
present security concerns in some scenarios because it needs
access to every hypervisor in the environment. To minimize
security risk, virt-who is a network client, not a server.
It only does outbound connections to find and register new
hypervisors and does not need access to any virtual
machines. To further reduce risk, deploy virt-who in a small
virtual machine with a minimal installation and lock it down
from any unsolicited inbound network connections.</p>

<p style="margin-left:11%; margin-top: 1em">Here is a list
of ports that need to be open for different hypervisors:</p>

<p style="margin-left:11%; margin-top: 1em">VMWare
ESX/vCenter: 443/tcp <br>
Hyper-V: 5985/tcp <br>
RHEV-M: 443/tcp or 8443/tcp (depending on version) <br>
XenServer: 443/tcp <br>
libvirt: depending on transport type, default (for remote
connections) is qemu over ssh on port 22 <br>
local libvirt and vdsm use local connections and don&rsquo;t
need open ports</p>

<p style="margin-left:11%; margin-top: 1em">virt-who also
needs to have access to Subscription Asset Manager,
Satellite 5, or Satellite 6. Default port is 443/tcp. All
the ports might be changed by system administrators.</p>

<p style="margin-left:11%; margin-top: 1em">Using the same
network for machine running virt-who as for hypervisor
management software instead of production VM networks is
suggested.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Radek Novacek
&lt;rnovacek at redhat dot com&gt;</p>
<hr>
</body>
</html>
