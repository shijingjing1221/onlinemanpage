<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:44:52 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IPSEC.CONF</title>

</head>
<body>

<h1 align="center">IPSEC.CONF</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONN SECTIONS">CONN SECTIONS</a><br>
<a href="#CONFIG SECTIONS">CONFIG SECTIONS</a><br>
<a href="#IMPLICIT CONNS">IMPLICIT CONNS</a><br>
<a href="#POLICY GROUP FILES">POLICY GROUP FILES</a><br>
<a href="#DEFAULT POLICY GROUPS">DEFAULT POLICY GROUPS</a><br>
<a href="#OBSOLETE">OBSOLETE</a><br>
<a href="#CHOOSING A CONNECTION [THIS SECTION IS EXTREMELY OUT OF DATE">CHOOSING A CONNECTION [THIS SECTION IS EXTREMELY OUT OF DATE</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ipsec.conf
&minus; IPsec configuration and connections</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The optional
<i>ipsec.conf</i> file specifies most configuration and
control information for the Libreswan IPsec subsystem. (The
major exception is secrets for authentication; see
<b>ipsec.secrets</b>(5).) Its contents are not
security&minus;sensitive.</p>

<p style="margin-left:11%; margin-top: 1em">The file is a
text file, consisting of one or more <i>sections</i>. White
space followed by <b>#</b> followed by anything to the end
of the line is a comment and is ignored, as are empty lines
which are not within a section.</p>

<p style="margin-left:11%; margin-top: 1em">A line which
contains <b>include</b> and a file name, separated by white
space, is replaced by the contents of that file, preceded
and followed by empty lines. If the file name is not a full
pathname, it is considered to be relative to the directory
containing the including file. Such inclusions can be
nested. Only a single filename may be supplied, and it may
not contain white space, but it may include shell wildcards
(see <b>sh</b>(1)); for example:</p>

<p style="margin-left:11%; margin-top: 1em"><b>include
/etc/ipsec.d/*.conf</b></p>

<p style="margin-left:11%; margin-top: 1em">The intention
of the include facility is mostly to permit keeping
information on connections, or sets of connections, separate
from the main configuration file. This permits such
connection descriptions to be changed, copied to the other
security gateways involved, etc., without having to
constantly extract them from the configuration file and then
insert them back into it. Note also the <b>also</b> and
<b>alsoflip</b> parameters (described below) which permit
splitting a single logical section (e.g. a connection
description) into several actual sections.</p>

<p style="margin-left:11%; margin-top: 1em">The first
significant line of the file may specify a version of this
specification for backwards compatibility with freeswan and
openswan. It is ignored and unused. For compatibility with
openswan, specify:</p>

<p style="margin-left:11%; margin-top: 1em"><b>version
2</b></p>

<p style="margin-left:11%; margin-top: 1em">A section
begins with a line of the form:</p>


<p style="margin-left:11%; margin-top: 1em"><i>typename</i></p>

<p style="margin-left:11%; margin-top: 1em">where
<i>type</i> indicates what type of section follows, and
<i>name</i> is an arbitrary name which distinguishes the
section from others of the same type. (Names must start with
a letter and may contain only letters, digits, periods,
underscores, and hyphens.) All subsequent non&minus;empty
lines which begin with white space are part of the section;
comments within a section must begin with white space too.
There may be only one section of a given type with a given
name.</p>

<p style="margin-left:11%; margin-top: 1em">Lines within
the section are generally of the form
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p style="margin-left:11%; margin-top: 1em"><i>parameter</i><b>=</b><i>value</i></p>

<p style="margin-left:11%; margin-top: 1em">(note the
mandatory preceding white space). There can be white space
on either side of the <b>=</b>. Parameter names follow the
same syntax as section names, and are specific to a section
type. Unless otherwise explicitly specified, no parameter
name may appear more than once in a section.</p>

<p style="margin-left:11%; margin-top: 1em">An empty
<i>value</i> stands for the system default value (if any) of
the parameter, i.e. it is roughly equivalent to omitting the
parameter line entirely. A <i>value</i> may contain white
space only if the entire <i>value</i> is enclosed in double
quotes (<b>&quot;</b>); a <i>value</i> cannot itself contain
a double quote, nor may it be continued across more than one
line.</p>

<p style="margin-left:11%; margin-top: 1em">Numeric values
are specified to be either an &ldquo;integer&rdquo; (a
sequence of digits) or a &ldquo;decimal number&rdquo;
(sequence of digits optionally followed by &lsquo;.' and
another sequence of digits).</p>

<p style="margin-left:11%; margin-top: 1em">There is
currently one parameter which is available in any type of
section:</p>


<p style="margin-left:11%; margin-top: 1em"><b>also</b></p>

<p style="margin-left:17%;">the value is a section name;
the parameters of that section are appended to this section,
as if they had been written as part of it. The specified
section must exist, must follow the current one, and must
have the same section type. (Nesting is permitted, and there
may be more than one <b>also</b> in a single section,
although it is forbidden to append the same section more
than once.) This allows, for example, keeping the encryption
keys for a connection in a separate file from the rest of
the description, by using both an <b>also</b> parameter and
an <b>include</b> line. (Caution, see BUGS below for some
restrictions.)</p>


<p style="margin-left:11%; margin-top: 1em"><b>alsoflip</b></p>

<p style="margin-left:17%;">can be used in a <b>conn</b>
section. It acts like an <b>also</b> that flips the
referenced section's entries left&minus;for&minus;right.</p>

<p style="margin-left:11%; margin-top: 1em">Parameter names
beginning with <b>x&minus;</b> (or <b>X&minus;</b>, or
<b>x_</b>, or <b>X_</b>) are reserved for user extensions
and will never be assigned meanings by IPsec. Parameters
with such names must still observe the syntax rules (limits
on characters used in the name; no white space in a
non&minus;quoted value; no newlines or double quotes within
the value). All other as&minus;yet&minus;unused parameter
names are reserved for future IPsec improvements.</p>

<p style="margin-left:11%; margin-top: 1em">A section with
name <b>%default</b> specifies defaults for sections of the
same type. For each parameter in it, any section of that
type which does not have a parameter of the same name gets a
copy of the one from the <b>%default</b> section. There may
be multiple <b>%default</b> sections of a given type, but
only one default may be supplied for any specific parameter
name, and all <b>%default</b> sections of a given type must
precede all non&minus;<b>%default</b> sections of that type.
<b>%default</b> sections may not contain <b>also</b> or
<b>alsoflip</b> parameters.</p>

<p style="margin-left:11%; margin-top: 1em">Currently there
are two types of section: a <b>config</b> section specifies
general configuration information for IPsec, while a
<b>conn</b> section specifies an IPsec connection.</p>

<h2>CONN SECTIONS
<a name="CONN SECTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A <b>conn</b>
section contains a <i>connection specification</i>, defining
a network connection to be made using IPsec. The name given
is arbitrary, and is used to identify the connection to
<b>ipsec_auto</b>(8) Here's a simple example:</p>

<p style="margin-left:17%; margin-top: 1em"><b>conn
snt</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>left=10.11.11.1</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>leftsubnet=10.0.1.0/24</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>leftnexthop=172.16.55.66</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>leftsourceip=10.0.1.1</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>right=192.168.22.1</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>rightsubnet=10.0.2.0/24</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>rightnexthop=172.16.88.99</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>rightsourceip=10.0.2.1</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p><b>keyingtries=%forever</b></p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">A note on
terminology... In automatic keying, there are two kinds of
communications going on: transmission of user IP packets,
and gateway&minus;to&minus;gateway negotiations for keying,
rekeying, and general control. The data path (a set of
&ldquo;IPsec SAs&rdquo;) used for user packets is herein
referred to as the &ldquo;connection&rdquo;; the path used
for negotiations (built with &ldquo;ISAKMP SAs&rdquo;) is
referred to as the &ldquo;keying channel&rdquo;.</p>

<p style="margin-left:11%; margin-top: 1em">To avoid
trivial editing of the configuration file to suit it to each
system involved in a connection, connection specifications
are written in terms of <i>left</i> and <i>right</i>
participants, rather than in terms of local and remote.
Which participant is considered <i>left</i> or <i>right</i>
is arbitrary; IPsec figures out which one it is being run on
based on internal information. This permits using identical
connection specifications on both ends. There are cases
where there is no symmetry; a good convention is to use
<i>left</i> for the local side and <i>right</i> for the
remote side (the first letters are a good mnemonic).</p>

<p style="margin-left:11%; margin-top: 1em">Many of the
parameters relate to one participant or the other; only the
ones for <i>left</i> are listed here, but every parameter
whose name begins with <b>left</b> has a <b>right</b>
counterpart, whose description is the same but with
<b>left</b> and <b>right</b> reversed.</p>

<p style="margin-left:11%; margin-top: 1em">Parameters are
optional unless marked &ldquo;(required)&rdquo;</p>

<p style="margin-left:11%; margin-top: 1em"><b>CONN
PARAMETERS: GENERAL</b> <br>
The following parameters are relevant to IKE automatic
keying. Unless otherwise noted, for a connection to work, in
general it is necessary for the two ends to agree exactly on
the values of these parameters.</p>


<p style="margin-left:11%; margin-top: 1em"><b>connaddrfamily</b></p>

<p style="margin-left:17%;">the connection address family
of the connection; currently the accepted values are
<b>ipv4</b> (the default); or <b>ipv6</b>. This option is
confusing, especially when doing IPv4&minus;in&minus;IPv6 or
IPv6&minus;in&minus;IPv4 tunnels. The developers hope to
remove this option in the near future for proper
auto&minus;detection. For now, set connaddrfamily= to the
family of the *subnet= options, and if those are not
defined, to the family of the left=/right= options.</p>

<p style="margin-left:17%; margin-top: 1em">IPv6 is
supported with NETKEY and with KLIPS in all Libreswan
versions</p>


<p style="margin-left:11%; margin-top: 1em"><b>type</b></p>

<p style="margin-left:17%;">the type of the connection;
currently the accepted values are <b>tunnel</b> (the
default) signifying a host&minus;to&minus;host,
host&minus;to&minus;subnet, or subnet&minus;to&minus;subnet
tunnel; <b>transport</b>, signifying
host&minus;to&minus;host transport mode; <b>passthrough</b>,
signifying that no IPsec processing should be done at all;
<b>drop</b>, signifying that packets should be discarded;
and <b>reject</b>, signifying that packets should be
discarded and a diagnostic ICMP returned.</p>


<p style="margin-left:11%; margin-top: 1em"><b>left</b></p>

<p style="margin-left:17%;">(required) the IP address of
the left participant's public&minus;network interface, in
any form accepted by <b>ipsec_ttoaddr</b>(3). Currently,
IPv4 and IPv6 IP addresses are supported. There are several
magic values. If it is <b>%defaultroute</b>, and the
<b>config setup</b> section's, <b>interfaces</b>
specification contains <b>%defaultroute</b>, <b>left</b>
will be filled in automatically with the local address of
the default&minus;route interface (as determined at IPsec
startup time); this also overrides any value supplied for
<b>leftnexthop</b>. (Either <b>left</b> or <b>right</b> may
be <b>%defaultroute</b>, but not both.) The value
<b>%any</b> signifies an address to be filled in (by
automatic keying) during negotiation. The value
<b>%opportunistic</b> signifies that both <b>left</b> and
<b>leftnexthop</b> are to be filled in (by automatic keying)
from DNS data for <b>left</b>'s client. The value can also
contain the interface name, which will then later be used to
obtain the IP address from to fill in. For example
<b>%ppp0</b> The values <b>%group</b> and
<b>%opportunisticgroup</b> makes this a policy group conn:
one that will be instantiated into a regular or
opportunistic conn for each CIDR block listed in the policy
group file with the same name as the conn.</p>

<p style="margin-left:17%; margin-top: 1em">If using IP
addresses in combination with NAT, always use the actual
local machine's (NATed) IP address, and if the remote (eg
right=) is NATed as well, the remote's public (<b>not</b>
NATed) IP address. Note that this makes the configuration no
longer symmetrical on both sides, so you cannot use an
identical configuration file on both hosts.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftsubnet</b></p>

<p style="margin-left:17%;">private subnet behind the left
participant, expressed as
<i>network</i><b>/</b><i>netmask</i> (actually, any form
acceptable to <b>ipsec_ttosubnet</b>(3)); Currently, IPv4
and IPv6 ranges are supported. if omitted, essentially
assumed to be <i>left</i>/32, signifying that the left end
of the connection goes to the left participant only</p>

<p style="margin-left:17%; margin-top: 1em">It supports two
magic shorthands <i>vhost:</i> and <i>vnet:</i>, which can
list subnets in the same syntax as
<i>virtual&minus;private</i>. The value <i>%priv</i> expands
to the networks specified in <i>virtual&minus;private</i>.
The value <i>%no</i> means no subnet. A common use for
allowing roadwarriors to come in on public IPs or via
accepted NATed networks from RFC1918 is to use
<i>leftsubnet=vhost:%no,%priv</i>. The <i>vnet:</i> option
can be used to allow RFC1918 subnets without hardcoding
them. When using vnet the connection will instantiate,
allowing for multiple tunnels with different subnets.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftsubnets</b></p>

<p style="margin-left:17%;">specify multiple private
subnets behind the left participant, expressed as {
<i>networkA</i><b>/</b><i>netmaskAnetworkB</i><b>/</b><i>netmaskB[...]</i>
} If both a leftsubnets= and rightsubnets= are defined, all
combinations of subnet tunnels will be established as IPsec
tunnels. You cannot use leftsubnet= and leftsubnets=
together. For examples see
<i>testing/pluto/multinet&minus;*</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftaddresspool</b></p>

<p style="margin-left:17%;">address pool from with the
XAUTH server can assign IP addresses to clients. When
configured as an XAUTH server, using
<i>leftxauthserver=yes</i> this option specifies the address
pool from which IP addresses are taken to assign the the
XAUTH clients. The syntax of the address pool specifies a
range (not a CIDR), in the following syntax:
<i>rightaddresspool=192.168.1.100&minus;192.168.1.200</i>.
Generally, the <i>rightaddresspool=</i> option will be
accompanied by <i>rightxauthclient=yes</i>,
<i>leftxauthserver=yes</i> and <i>leftsubnet=0.0.0.0/0</i>
option.</p>

<p style="margin-left:17%; margin-top: 1em">When
<i>leftaddresspool=</i> is specified, the connection may not
specify either <i>leftsubnet=</i> or <i>leftsubnets=</i>.
Address pools are fully allocated when the connection is
loaded, so the ranges should be sane. For example,
specifying a range
<i>rightaddresspool=10.0.0.0&minus;11.0.0.0</i> will lead to
massive memory allocation. Address pools specifying the
exact same range are shared between different connections.
Different addresspools should not be defined to partially
overlap.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftprotoport</b></p>

<p style="margin-left:17%;">allowed protocols and ports
over connection, also called Port Selectors. The argument is
in the form <i>protocol</i>, which can be a number or a name
that will be looked up in <i>/etc/protocols</i>, such as
<i>leftprotoport=icmp</i>, or in the form of
<i>protocol/port</i>, such as <i>tcp/smtp</i>. Ports can be
defined as a number (eg. 25) or as a name (eg smtp) which
will be looked up in <i>/etc/services</i>. A special keyword
<i>%any</i> can be used to allow all ports of a certain
protocol. The most common use of this option is for L2TP
connections to only allow l2tp packets (UDP port 1701), eg:
<i>leftprotoport=17/1701</i>.</p>

<p style="margin-left:17%; margin-top: 1em">To filter on
specific icmp type and code, use the higher 8 bits for type
and the lower 8 bits for port. For example, to allow icmp
echo packets (type 8, code 0) the 'port' would be 0x0800, or
2048 in decimal, so you configure
<i>leftprotoport=icmp/2048</i>. Similarly, to allow
ipv6&minus;icmp Neighbour Discovery which has type 136
(0x88) and code 0(0x00) this becomes 0x8800 or in decimal
34816 resulting in
<i>leftprotoport=ipv6&minus;icmp/34816</i> .</p>

<p style="margin-left:17%; margin-top: 1em">Some clients,
notably older Windows XP and some Mac OSX clients, use a
random high port as source port. In those cases
<i>rightprotoport=17/%any</i> can be used to allow all UDP
traffic on the connection. Note that this option is part of
the proposal, so it cannot be arbitrarily left out if one
end does not care about the traffic selection over this
connection &minus; both peers have to agree. The Port
Selectors show up in the output of <i>ipsec eroute</i> and
<i>ipsec auto &minus;&minus;status</i>
eg:<i>&quot;l2tp&quot;:
193.110.157.131[@aivd.libreswan.org]:7/1701...%any:17/1701</i>
This option only filters outbound traffic. Inbound traffic
selection must still be based on firewall rules activated by
an updown script. The variables $PLUTO_MY_PROTOCOL,
$PLUTO_PEER_PROTOCOL, $PLUTO_MY_PORT, and $PLUTO_PEER_PORT
are available for use in <i>updown</i> scripts. Older
workarounds for bugs involved a setting of <i>17/0</i> to
denote <i>any single UDP port</i> (not UDP port 0). Some
clients, most notably OSX, uses a random high port, instead
of port 1701 for L2TP.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftnexthop</b></p>

<p style="margin-left:17%;">next&minus;hop gateway IP
address for the left participant's connection to the public
network; defaults to <b>%direct</b> (meaning <i>right</i>).
If the value is to be overridden by the
<b>left=%defaultroute</b> method (see above), an explicit
value must <i>not</i> be given. If that method is not being
used, but <b>leftnexthop</b> is <b>%defaultroute</b>, and
<b>interfaces=%defaultroute</b> is used in the <b>config
setup</b> section, the next&minus;hop gateway address of the
default&minus;route interface will be used. The magic value
<b>%direct</b> signifies a value to be filled in (by
automatic keying) with the peer's address. Relevant only
locally, other end need not agree on it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftsourceip</b></p>

<p style="margin-left:17%;">the IP address for this host to
use when transmitting a packet to the other side of this
link. Relevant only locally, the other end need not agree.
This option is used to make the gateway itself use its
internal IP, which is part of the leftsubnet, to communicate
to the rightsubnet or right. Otherwise, it will use its
<b>nearest</b> IP address, which is its public IP address.
This option is mostly used when defining subnet&minus;subnet
connections, so that the gateways can talk to each other and
the subnet at the other end, without the need to build
additional host&minus;subnet, subnet&minus;host and
host&minus;host tunnels. Both IPv4 and IPv6 addresses are
supported.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftupdown</b></p>

<p style="margin-left:17%;">what &ldquo;updown&rdquo;
script to run to adjust routing and/or firewalling when the
status of the connection changes (default <b>ipsec
_updown</b>). May include positional parameters separated by
white space (although this requires enclosing the whole
string in quotes); including shell metacharacters is unwise.
An example to enable routing when using the NETKEY stack,
one can use:</p>


<p style="margin-left:17%; margin-top: 1em">leftupdown=&quot;ipsec
_updown &minus;&minus;route yes&quot;</p>

<p style="margin-left:17%; margin-top: 1em">See
<b>ipsec_pluto</b>(8) for details. Relevant only locally,
other end need not agree on it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftfirewall</b></p>

<p style="margin-left:17%;">This option is obsolete and
should not used anymore.</p>

<p style="margin-left:11%; margin-top: 1em">If one or both
security gateways are doing forwarding firewalling (possibly
including masquerading), and this is specified using the
firewall parameters, tunnels established with IPsec are
exempted from it so that packets can flow unchanged through
the tunnels. (This means that all subnets connected in this
manner must have distinct, non&minus;overlapping subnet
address blocks.) This is done by the default <i>updown</i>
script (see <b>ipsec_pluto</b>(8)).</p>

<p style="margin-left:11%; margin-top: 1em">The
implementation of this makes certain assumptions about
firewall setup, and the availability of the <i>Linux
Advanced Routing</i> tools. In situations calling for more
control, it may be preferable for the user to supply his own
<i>updown</i> script, which makes the appropriate
adjustments for his system.</p>

<p style="margin-left:11%; margin-top: 1em"><b>CONN
PARAMETERS: AUTOMATIC KEYING</b> <br>
The following parameters are relevant to automatic keying
via IKE. Unless otherwise noted, for a connection to work,
in general it is necessary for the two ends to agree exactly
on the values of these parameters.</p>


<p style="margin-left:11%; margin-top: 1em"><b>auto</b></p>

<p style="margin-left:17%;">what operation, if any, should
be done automatically at IPsec startup;
currently&minus;accepted values are <b>add</b> (signifying
an <b>ipsec auto&minus;&minus;add</b>), <b>ondemand</b>
(signifying that plus an <b>ipsec
auto&minus;&minus;ondemand</b>), <b>start</b> (signifying
that plus an <b>ipsec auto&minus;&minus;up</b>), and
<b>ignore</b> (also the default) (signifying no automatic
startup operation). See the <b>config setup</b> discussion
below. Relevant only locally, other end need not agree on it
(but in general, for an
intended&minus;to&minus;be&minus;permanent connection, both
ends should use <b>auto=start</b> to ensure that any reboot
causes immediate renegotiation).</p>

<p style="margin-left:17%; margin-top: 1em">The option
<b>ondemand</b> used to be called <b>route</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>authby</b></p>

<p style="margin-left:17%;">how the two security gateways
should authenticate each other; acceptable values are
<b>rsasig</b> (the default) for RSA digital signatures based
authentication, <b>secret</b> for shared secrets (PSK)
authentication, <b>secret|rsasig</b> for either,
<b>never</b> if negotiation is never to be attempted or
accepted (useful for shunt&minus;only conns), and
<b>null</b> for null&minus;authentication.</p>

<p style="margin-left:17%; margin-top: 1em">Digital
signatures are superior in every way to shared secrets.
Especially IKEv1 in Aggressive Mode is vulnerable to offline
dictionary attacks and is performed routinely by at least
the NSA on monitored internet traffic globally. The never
option is only used for connections that do not actually
start an IKE negotiation, such as type=passthrough
connections. The auth method null is used for
&quot;anonymous opportunistic IPsec&quot; and should not be
used for regular pre&minus;configured IPsec VPNs.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ike</b></p>

<p style="margin-left:17%;">IKE encryption/authentication
algorithm to be used for the connection (phase 1 aka ISAKMP
SA). The format is <i>&quot;cipher&minus;hash;modpgroup,
cipher&minus;hash;modpgroup, ...&quot;</i> Any left out
option will be filled in with all allowed default options.
Multiple proposals are separated by a comma. If an
<b>ike=</b> line is specified, no other received proposals
will be accepted. Formerly there was a distinction (by using
a <b>&quot;!&quot;</b> symbol) between &quot;strict
mode&quot; or not. That mode has been obsoleted. If an
<b>ike=</b> option is specified, the mode is always strict,
meaning no other received proposals will be accepted. Some
examples are <b>ike=3des&minus;sha1,aes&minus;sha1</b>,
<b>ike=aes</b>, <b>ike=aes_ctr</b>,
<b>ike=aes_gcm256&minus;sha2</b>,
<b>ike=aes128&minus;md5;modp2048</b>,
<b>ike=aes128&minus;sha1;dh22</b>,
<b>ike=3des&minus;md5;modp1024,aes&minus;sha1;modp1536</b>.
The options must be suitable as a value of
<b>ipsec_spi</b>(8)'s <b>&minus;&minus;ike</b> option. The
default is to use IKE, and to allow all combinations of:</p>

<p style="margin-left:23%; margin-top: 1em"><b>cipher: 3des
or aes128 or aes256 <br>
hash: sha1 or md5 <br>
pfsgroup (DHgroup): modp1024 or modp1536 or modp2048</b></p>

<p style="margin-left:17%; margin-top: 1em">Note that
AES&minus;GCM is an AEAD algorithm, meaning that it performs
encryption+authentication in one step. This means that
AES&minus;GCM must not specify an authentication algorithm.
However, it does require a PRF function, so the second
argument to an AEAD algorithm denotes the PRF. So
ike=aes_gcm&minus;sha2 means propose AES_GCM with no
authentication and using SHA2 as the prf. Note that for
phase2alg, there is no prf, so AES&minus;GCM is specified
for ESP as phase2alg=aes_gcm&minus;null. The AES&minus;GCM
and AES&minus;CCM algorithms support 8,12 and 16 byte ICV's.
These can be specified using a postfix, for example
aes_gcm_a (for 8), aes_gcm_b (for 12) and aes_gcm_c (for
16). The default (aes_gcm without postfix) refers to the 16
byte ICV version. It is strongly recommended to NOT use the
8 or 12 byte versions of GCM or CCM.</p>

<p style="margin-left:17%; margin-top: 1em">Weak algorithms
are regularly removed from libreswan. Currently, 1DES and
modp768 have been removed and modp1024 will be removed in
the near future. Additionally, md5 and sha1 will be removed
within the next few years. Null encryption is available, and
should only be used for testing or benchmarking purposes.
Please do not request for insecure algorithms to be
re&minus;added to libreswan.</p>


<p style="margin-left:17%; margin-top: 1em">Diffie&minus;Hellman
groups 22, 23 and 24 are also implemented as per
RFC&minus;5114. Instead of the modp key syntax, use the
&quot;dh&quot; keyword, for example
<i>ike=3des&minus;sha1;dh23</i></p>

<p style="margin-left:17%; margin-top: 1em">The modp syntax
will be removed in favour of the dh syntax.</p>


<p style="margin-left:11%; margin-top: 1em"><b>phase2</b></p>

<p style="margin-left:17%;">Sets the type of SA that will
be produced. Valid options are: <b>esp</b> for encryption
(the default), <b>ah</b> for authentication only.</p>

<p style="margin-left:17%; margin-top: 1em">The very first
IPsec designs called for use of AH plus ESP to offer
authentication, integrity and confidentiality. That dual
protocol use was a significant burden, so ESP was extended
to offer all three services, and AH remained as an
auth/integ. Only broken configurations (often used with
racoon) require the strange double authentication using
<b>ah+esp</b>. Additionally, AH does not play well with
NATs, so it is strongly recommended to use ESP with the null
cipher if you require unencrypted authenticated
transport.</p>


<p style="margin-left:11%; margin-top: 1em"><b>phase2alg</b></p>

<p style="margin-left:17%;">Specifies the algorithms that
will be offered/accepted for a phase2 negotiation. If not
specified, a secure set of defaults will be used. Sets are
separated using comma's.</p>

<p style="margin-left:17%; margin-top: 1em">The default
values are the same as for ike= Note also that not all
ciphers available to the kernel (eg through CryptoAPI) are
necessarily supported here.</p>

<p style="margin-left:17%; margin-top: 1em">The format for
ESP is ENC&minus;AUTH followed by an optional PFSgroup. For
instance, &quot;3des&minus;md5&quot; or
&quot;aes256&minus;sha1;modp2048&quot; or
&quot;aes&minus;sha1,aes&minus;md5&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">For
RFC&minus;5114 DH groups, use the &quot;dh&quot; keyword, eg
&quot;aes256&minus;sha1;dh23&quot;</p>

<p style="margin-left:17%; margin-top: 1em">The format for
AH is AUTH followed by an optional PFSgroup. For instance,
&quot;md5&quot; or &quot;sha1;modp1536&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">AEAD algorithms
such as AES&minus;GCM and AES&minus;CCM require null for the
authentication algorithm, for example
<i>phase2alg=aes_ccm&minus;null</i> or
<i>phase2alg=aes_gcm&minus;null</i>. Note that the ike=
syntax for aes_gcm does not specify a null authentication
but specifies the prf instead. The supported key sizes are
128, 192 and 256, which are specified similarly to plain
aes, i.e. <i>phase2alg=aes_gcm256</i>. A subscript of
<i>_c</i>, <i>_b</i> or <i>_a</i> can be used to refer to
the different ICV variants where a means 8 bytes, b means 12
bytes and c means 16 bytes. The default when not using a
subscript is the 16 byte ICV, the recommended value by
RFC&minus;4106. Therefor phase2alg=aes_gcm256&minus;null is
equivalent to phase2alg=aes_gcm_c256&minus;null. It is
recommended to migrate to the _c versions (without
specifying _c), as support for smaller ICV's might be
removed in the near future.</p>

<p style="margin-left:17%; margin-top: 1em">The supported
algorithms depend on the libreswan version, OS and kernel
stack used. Possible ciphers are aes, 3des, aes_ctr,
aes_gcm, aes_ccm, camellia, serpent and twofish.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
openswan and versions of libreswan up to 3.6 require
manually adding the salt size to the key size. Therefor, to
configure an older version of openswan or libreswan, use:
&quot;phase2alg=aes_ccm_c&minus;280&minus;null&quot; to
interop with a new libreswan using
&quot;phase2alg=aes_ccm256&quot;. For CCM, the 'keysize'
needs to be increased by 24, resulted in valid keysizes of
152, 215 and 280. For GCM the 'keysize' needs to be
increased by 32, resulting valid 'keysizes' of 160, 224 and
288.</p>


<p style="margin-left:11%; margin-top: 1em"><b>sha2&minus;truncbug</b></p>

<p style="margin-left:17%;">The default ESP hash truncation
for sha2_256 is 128 bits. Some IPsec implementations (Linux
before 2.6.33, some Cisco (2811?) routers) implement the
draft version which stated 96 bits. If a draft
implementation communicates with an RFC implementation, both
ends will reject encrypted packets from each other.</p>

<p style="margin-left:17%; margin-top: 1em">This option
enables using the draft 96 bits version to interop with
those implementations. Currently the accepted values are
<b>no</b>, (the default) signifying default RFC truncation
of 128 bits, or <b>yes</b>, signifying the draft 96 bits
truncation.</p>

<p style="margin-left:17%; margin-top: 1em">Another
workaround is to switch from sha2_256 to sha2_128 or
sha2_512.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nat&minus;ikev1&minus;method</b></p>

<p style="margin-left:17%;">NAT Traversal in IKEv1 is
negotiated via Vendor ID options as specified in RFC 3947.
However, many implementations only support the draft version
of the RFC. Libreswan sends both the RFC and the most common
draft versions (02, 02_n and 03) to maximize
interoperability. Unfortunately, there are known broken
implementations of RFC 3947, notably Cisco routers that have
not been updated to the latest firmware. As the NAT&minus;T
payload is sent in the very first packet of the initiator,
there is no method to auto&minus;detect this problem and
initiate a workaround.</p>

<p style="margin-left:17%; margin-top: 1em">This option
allows fine tuning which of the NAT&minus;T payloads to
consider for sending and processing. Currently the accepted
values are <b>drafts</b>, <b>rfc</b> or <b>both</b> (the
default). To interoperate with known broken devices, use
nat&minus;ikev1&minus;method=drafts.</p>

<p style="margin-left:11%; margin-top: 1em"><b>esp</b></p>

<p style="margin-left:17%;">This option is obsolete. Please
use <b>phase2alg</b> instead.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ah</b></p>

<p style="margin-left:17%;">AH authentication algorithm to
be used for the connection, e.g here. <b>hmac&minus;md5</b>
The options must be suitable as a value of
<b>ipsec_spi</b>(8)'s <b>&minus;&minus;ah</b> option. The
default is not to use AH. If for some (invalid) reason you
still think you need AH, please use esp with the null
encryption cipher instead. Note also that not all ciphers
available to the kernel (eg through CryptoAPI) are
necessarily supported here.</p>


<p style="margin-left:11%; margin-top: 1em"><b>fragmentation</b></p>

<p style="margin-left:17%;">Whether or not to allow IKE
fragmentation. Valid values are are <b>yes</b>, (the
default), <b>no</b> or <b>force</b>.</p>

<p style="margin-left:17%; margin-top: 1em">IKEv1
fragmentation capabilities are negotiated via a
well&minus;known private <i>vendor id</i>. IKEv2
fragmentation support is implemented using RFC 7383. If
pluto does not receive the fragmentation payload, no IKE
fragments will be sent, regardless of the fragmentation=
setting. When set to <b>yes</b>, IKE fragmentation will be
attempted on the first re&minus;transmit of an IKE packet of
a size larger then 576 bytes for IPv4 and 1280 bytes for
IPv6. If fragmentation is set to force, IKE fragmentation is
used on initial transmits of such sized packets as well.
When we have received IKE fragments for a connection, pluto
behaves as if in force mode.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ikepad</b></p>

<p style="margin-left:17%;">Whether or not to pad IKEv1
messages to a multiple of 4 bytes. Valid values are are
<b>yes</b>, (the default) and <b>no</b>.</p>

<p style="margin-left:17%; margin-top: 1em">IKE padding is
allowed in IKEv1 but it is known to cause interoperability
issues. The ikepad= option can be used to disable IKEv1
padding. This is required for some devices (such as
Checkpoint in Aggressive Mode) that reject padded IKEv1
packets. In IKEv2, no padding is allowed, and this option
has no effect. If you find a device that seems to require
IKE padding in IKEv2, please contact the libreswan
developers. This option should almost never be enabled.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ikev2</b></p>

<p style="margin-left:17%;">IKEv2 (RFC4309) settings to be
used. Currently the accepted values are <b>permit</b>, (the
default) signifying no IKEv2 should be transmitted, but will
be accepted if the other ends initiates to us with IKEv2;
<b>never</b> or <b>no</b> signifying no IKEv2 negotiation
should be transmitted or accepted; <b>propose</b> or
<b>yes</b> signifying that we permit IKEv2, and also use it
as the default to initiate; <b>insist</b>, signifying we
only accept and receive IKEv2 &minus; IKEv1 negotiations
will be rejected.</p>

<p style="margin-left:17%; margin-top: 1em">If the ikev2=
setting is set to <b>permit</b> or <b>propose</b>, Libreswan
will try and detect a &quot;bid down&quot; attack from IKEv2
to IKEv1. Since there is no standard for transmitting the
IKEv2 capability with IKEv1, Libreswan uses a special Vendor
ID &quot;CAN&minus;IKEv2&quot;. If a fall back from IKEv2 to
IKEv1 was detected, and the IKEv1 negotiation contains
Vendor ID &quot;CAN&minus;IKEv2&quot;, Libreswan will
immediately attempt and IKEv2 rekey and refuse to use the
IKEv1 connection. With an ikev2= setting of <b>insist</b>,
no IKEv1 negotiation is allowed, and no bid down attack is
possible.</p>


<p style="margin-left:11%; margin-top: 1em"><b>narrowing</b></p>

<p style="margin-left:17%;">IKEv2 (RFC5996) Section 2.9
Traffic Selector narrowing options. Currently the accepted
values are <b>no</b>, (the default) signifying no narrowing
will be proposed or accepted, or <b>yes</b>, signifying
IKEv2 negotiation may allow establishing an IPsec connection
with narrowed down traffic selectors. This option is ignored
for IKEv1.</p>

<p style="margin-left:17%; margin-top: 1em">There are
security implications in allowing narrowing down the
proposal. For one, what should be done with packets that we
hoped to tunnel, but cannot. Should these be dropped or send
in the clear? Second, this could cause thousands of narrowed
down Child SAs to be created if the conn has a broad policy
(eg 0/0 to 0/0). One possible good use case scenario is that
a remote end (that you fully trust) allows you to define a
0/0 to them, while adjusting what traffic you route via
them, and what traffic remains outside the tunnel. However,
it is always preferred to setup the exact tunnel policy you
want, as this will be much clearer to the user.</p>


<p style="margin-left:11%; margin-top: 1em"><b>sareftrack</b></p>

<p style="margin-left:17%;">Set the method of tracking
reply packets with SArefs when using an SAref compatible
stack. Currently only the <i>mast</i> stack supports this.
Acceptable values are <b>yes</b> (the default), <b>no</b> or
<b>conntrack</b>. This option is ignored when SArefs are not
supported. This option is passed as PLUTO_SAREF_TRACKING to
the <i>updown</i> script which makes the actual decisions
whether to perform any iptables/ip_conntrack manipulation. A
value of yes means that an IPSEC mangle table will be
created. This table will be used to match reply packets. A
value of conntrack means that additionally, subsequent
packets using this connection will be marked as well,
reducing the lookups needed to find the proper SAref by
using the ip_conntrack state. A value of no means no IPSEC
mangle table is created, and SAref tracking is left to a
third&minus;party (kernel) module. In case of a third party
module, the SArefs can be relayed using the <i>statsbin=</i>
notification helper.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftid</b></p>

<p style="margin-left:17%;">how the left participant should
be identified for authentication; defaults to <b>left</b>.
Can be an IP address (in any <b>ipsec_ttoaddr</b>(3) syntax)
or a fully&minus;qualified domain name which will be
resolved. If preceded by <b>@</b>, the value is used as a
literal string and will not be resolved. To support opaque
identifiers (usually of type ID_KEY_ID, such as used by
Cisco to specify Group Name, use square brackets, eg
<b>rightid=@[GroupName]</b>. The magic value
<b>%fromcert</b> causes the ID to be set to a DN taken from
a certificate that is loaded. Prior to 2.5.16, this was the
default if a certificate was specified. The magic value
<b>%none</b> sets the ID to no ID. This is included for
completeness, as the ID may have been set in the default
conn, and one wishes for it to default instead of being
explicitly set. The magic value <b>%myid</b> stands for the
current setting of <i>myid</i>. This is set in <b>config
setup</b> or by <b>ipsec_whack</b>(8)), or, if not set, it
is the IP address in <b>%defaultroute</b> (if that is
supported by a TXT record in its reverse domain), or
otherwise it is the system's hostname (if that is supported
by a TXT record in its forward domain), or otherwise it is
undefined.</p>

<p style="margin-left:17%; margin-top: 1em">When using
certificate based ID's, one need to specify the full RDN,
optionally using wildcard matching (eg CN='*'). If the RDN
contains a comma, this can be masked using a comma (eg
OU='Foo,, Bar and associates')</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftrsasigkey</b></p>

<p style="margin-left:17%;">the left participant's public
key for RSA signature authentication, in RFC 2537 format
using <b>ipsec_ttodata</b>(3) encoding. The magic value
<b>%none</b> means the same as not specifying a value
(useful to override a default). The value
<b>%dnsondemand</b> (the default) means the key is to be
fetched from DNS at the time it is needed. The value
<b>%dnsonload</b> means the key is to be fetched from DNS at
the time the connection description is read from
<i>ipsec.conf</i>; currently this will be treated as
<b>%none</b> if <b>right=%any</b> or
<b>right=%opportunistic</b>. The value <b>%dns</b> is
currently treated as <b>%dnsonload</b> but will change to
<b>%dnsondemand</b> in the future. The identity used for the
left participant must be a specific host, not <b>%any</b> or
another magic value. The value <b>%cert</b> will load the
information required from a certificate defined in
<b>%leftcert</b> and automatically define leftid for you.
<b>Caution:</b> if two connection descriptions specify
different public keys for the same <b>leftid</b>, confusion
and madness will ensue.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftrsasigkey2</b></p>

<p style="margin-left:17%;">if present, a second public
key. Either key can authenticate the signature, allowing for
key rollover.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftcert</b></p>

<p style="margin-left:17%;">If you are using
<b>leftrsasigkey=%cert</b> this defines the certificate
nickname of your certificate in the NSS database. This can
be on software or hardware security device.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftca</b></p>

<p style="margin-left:17%;">specifies the authorized
Certificate Authority (CA) that signed the certificate of
the peer. If undefined, it defaults to the CA that signed
the certificate specified in <b>leftcert</b>. The special
<b>rightca=%same</b> is implied when not specifying a
<b>rightca</b> and means that only peers with certificates
signed by the same CA as the leftca will be allowed. This
option is only useful in complex multi CA certificate
situations. When using a single CA, it can be safely omitted
for both left and right.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftsendcert</b></p>

<p style="margin-left:17%;">This option configures when
Libreswan will send X.509 certificates to the remote host.
Acceptable values are <b>yes|always</b> (signifying that we
should always send a certificate), <b>sendifasked</b>
(signifying that we should send a certificate if the remote
end asks for it), and <b>no|never</b> (signifying that we
will never send a X.509 certificate). The default for this
option is <b>sendifasked</b> which may break compatibility
with other vendor's IPsec implementations, such as Cisco and
SafeNet. If you find that you are getting errors about no
ID/Key found, you likely need to set this to <b>always</b>.
This per&minus;conn option replaces the obsolete global
<b>nocrsend</b> option.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftxauthserver</b></p>

<p style="margin-left:17%;">Left is an XAUTH server. This
can use PAM for authentication or md5 passwords in
<i>/etc/ipsec.d/passwd</i>. These are additional credentials
to verify the user identity, and should not be confused with
the XAUTH <b>group secret</b>, which is just a regular PSK
defined in <i>ipsec.secrets</i>. The other side of the
connection should be configured as <b>rightxauthclient</b>.
XAUTH connections cannot rekey, so <b>rekey=no</b> should be
specified in this conn. For further details on how to
compile and use XAUTH, see README.XAUTH. Acceptable values
are <b>yes</b> or <b>no</b> (the default).</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftxauthclient</b></p>

<p style="margin-left:17%;">Left is an XAUTH client. The
xauth connection will have to be started interactively and
cannot be configured using <b>auto=start</b>. Instead, it
has to be started from the commandline using <i>ipsec auto
&minus;&minus;up connname</i>. You will then be prompted for
the username and password. To setup an XAUTH connection
non&minus;interactively, which defeats the whole purpose of
XAUTH, but is regularly requested by users, it is possible
to use a whack command &minus; <i>ipsec whack
&minus;&minus;name baduser
&minus;&minus;ipsecgroup&minus;xauth &minus;&minus;xauthname
badusername &minus;&minus;xauthpass password
&minus;&minus;initiate</i> The other side of the connection
should be configured as <b>rightxauthserver</b>. Acceptable
values are <b>yes</b> or <b>no</b> (the default).</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftxauthusername</b></p>

<p style="margin-left:17%;">The XAUTH username associated
with this XAUTH connection. The XAUTH password can be
configured in the <i>ipsec.secrets</i> file.</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftmodecfgserver</b></p>

<p style="margin-left:17%;">Left is a Mode Config server.
It can push network configuration to the client. Acceptable
values are <b>yes</b> or <b>no</b> (the default).</p>


<p style="margin-left:11%; margin-top: 1em"><b>leftmodecfgclient</b></p>

<p style="margin-left:17%;">Left is a Mode Config client.
It can receive network configuration from the server.
Acceptable values are <b>yes</b> or <b>no</b> (the
default).</p>


<p style="margin-left:11%; margin-top: 1em"><b>xauthby</b></p>

<p style="margin-left:17%;">When IKEv1 XAUTH support is
available, set the method used by XAUTH to authenticate the
user with IKEv1. The currently supported values are
<i>file</i> (the default), <i>pam</i> or <i>alwaysok</i>.
The password file is located at <i>/etc/ipsec.d/passwd</i>,
and follows a syntax similar to the Apache htpasswd file,
except an additional connection name argument (and optional
static IP address) are also present:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p style="margin-left:17%; margin-top: 1em"><i>username:password:conname:ipaddress</i></p>

<p style="margin-left:17%; margin-top: 1em">For supported
password hashing methods, see <b>crypt</b>(3). If pluto is
running in FIPS mode, some hash methods, such as MD5, might
not be available. Threads are used to launch an xauth
authentication helper for file as well as PAM methods.</p>

<p style="margin-left:17%; margin-top: 1em">The
<i>alwaysok</i> should only be used if the XAUTH user
authentication is not really used, but is required for
interoperability, as it defeats the whole point of XAUTH
which is to rely on a secret only known by a human. See also
<i>pam&minus;authorize=yes</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>xauthfail</b></p>

<p style="margin-left:17%;">When XAUTH support is
available, set the failure method desired when
authentication has failed. The currently supported values
are <i>hard</i> (the default) and <i>soft</i>. A soft
failure means the IPsec SA is allowed to be established, as
if authentication had passed successfully, but the
XAUTH_FAILED environment variable will be set to 1 for the
updown script, which can then be used to redirect the user
into a walled garden, for example a payment portal.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pam&minus;authorize</b></p>

<p style="margin-left:17%;">IKEv1 supports PAM
authorization via XAUTH using <i>xauthby=pam</i>. IKEv2 does
not support receiveing a plaintext username and password.
Libreswan does not yet support EAP authentication methods
for IKE. The pam&minus;authorize=yes option performs an
authorization call via PAM, but only includes the remote ID
(not username or password). This allows for backends to
disallow an ID based on non&minus;password situations, such
as &quot;user disabled&quot; or &quot;user over quota&quot;.
See also <i>xauthby=pam</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>modecfgpull</b></p>

<p style="margin-left:17%;">Pull the Mode Config network
information from the server. Acceptable values are
<b>yes</b> or <b>no</b> (the default).</p>


<p style="margin-left:11%; margin-top: 1em"><b>modecfgdns1</b>,
<b>modecfgdns2</b>, <b>modecfgdomain</b>,
<b>modecfgbanner</b></p>

<p style="margin-left:17%;">When configured as modecfg
server, specifying any of these options will cause those
options and values to be sent to the modecfg client during
the XAUTH+ModeCFG phase (phase 1.5).</p>

<p style="margin-left:17%; margin-top: 1em">When we are an
XAUTH client, these options will be treated as defaults. If
the remote XAUTH server did not pass us one of these
options, the configured defaults are used to reconfigure the
local DNS setup.</p>

<p style="margin-left:17%; margin-top: 1em">The split
tunneling directive will be sent automatically if the xauth
server side has configured a network other than
0.0.0.0/0</p>


<p style="margin-left:11%; margin-top: 1em"><b>remote&minus;peer&minus;type</b></p>

<p style="margin-left:17%;">Set the remote peer type. This
can enable additional processing during the IKE negotiation.
Acceptable values are <b>cisco</b> or <b>ietf</b> (the
default). When set to cisco, support for Cisco IPsec gateway
redirection and Cisco obtained DNS and domainname are
enabled. This includes automatically updating (and
restoring) /etc/resolv.conf. These options require that
XAUTH is also enabled on this connection.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nm&minus;configured</b></p>

<p style="margin-left:17%;">Mark this connection as
controlled by Network Manager. Acceptable values are
<b>yes</b> or <b>no</b> (the default). Currently, setting
this to yes will cause libreswan to skip reconfiguring
resolv.conf when used with XAUTH and ModeConfig.</p>


<p style="margin-left:11%; margin-top: 1em"><b>forceencaps</b></p>

<p style="margin-left:17%;">In some cases, for example when
ESP packets are filtered or when a broken IPsec peer does
not properly recognise NAT, it can be useful to force
RFC&minus;3948 encapsulation. <b>forceencaps=yes</b> forces
the NAT detection code to lie and tell the remote peer that
RFC&minus;3948 encapsulation (ESP in UDP port 4500 packets)
is required. Acceptable values are <b>yes</b> or <b>no</b>
(the default).</p>


<p style="margin-left:11%; margin-top: 1em"><b>nat&minus;keepalive</b></p>

<p style="margin-left:17%;">whether to send any NAT&minus;T
keep&minus;alives. These one byte packets are send to
prevent the NAT router from closing its port when there is
not enough traffic on the IPsec connection. Acceptable
values are: <b>yes</b> (the default) and <b>no</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>initial&minus;contact</b></p>

<p style="margin-left:17%;">whether to send an
INITIAL_CONTACT payload to the peer we are initiating to, if
we currently have no IPsec SAs up with that peer. Acceptable
values are: <b>no</b> (the default) and <b>yes</b>. It is
recommended to leave this option unset, unless the remote
peer requires it to allow reconnects. The only known peer at
this time is Cisco, which will not allow a reconnect
(despite authentication) to replace an existing IPsec SA
unless it receives an INITIAL_CONTACT payload. Receiving
this payload is ignored and the choice to replace or add an
IPsec SA when libreswan is a responder is purely based on
the <b>uniqueids</b> setting, which should be left enabled
unless libreswan acts as an XAUTH server using PSK
(&quot;group secret&quot;). This option can cause a few
seconds of downtime on the IPsec tunnel between the time the
remote clears the old IPsec SA in response to our
INITIAL_CONTACT message, and the time we finish setting up
the new IPsec SA. If there is an XAUTH step in between, and
especially when XAUTH requires the use of some
two&minus;factor token, this downtime could be even
longer.</p>


<p style="margin-left:11%; margin-top: 1em"><b>cisco&minus;unity</b></p>

<p style="margin-left:17%;">whether to send a CISCO_UNITY
payload to the peer. Acceptable values are: <b>no</b> (the
default) and <b>yes</b>. It is recommended to leave this
option unset, unless the remote peer (Cisco client or
server) requires it. This option does not modify local
behaviour. It can be needed to connect as a client to a
Cisco server. It can also be needed to act as a server for a
Cisco client, which otherwise might send back an error
DEL_REASON_NON_UNITY_PEER.</p>


<p style="margin-left:11%; margin-top: 1em"><b>send&minus;vendorid</b></p>

<p style="margin-left:17%;">whether to send our Vendor ID
during IKE. Acceptable values are: <b>no</b> (the default)
and <b>yes</b>. The vendor id sent can be configured using
the &quot;config setup&quot; option <b>myvendorid=</b>. It
defaults to OE&minus;Libreswan&minus;VERSION.</p>

<p style="margin-left:17%; margin-top: 1em">Vendor ID's can
be useful in tracking interoperability problems. However,
specific vendor identification and software versions can be
useful to an attacker when there are known vulnerabilities
to a specific vendor/version.</p>

<p style="margin-left:17%; margin-top: 1em">The prefix OE
stands for &quot;Opportunistic Encryption&quot;. This prefix
was historically used by The FreeS/WAN Project and The
Openswan Project (openswan up to version 2.6.38) and in one
Xeleranized openswan versions (2.6.39). Further Xeleranized
openswan's use the prefix OSW.</p>


<p style="margin-left:11%; margin-top: 1em"><b>overlapip</b></p>

<p style="margin-left:17%;">a boolean (yes/no) that
determines, when *subnet=vhost: is used, if the virtual IP
claimed by this states created from this connection can with
states created from other connections.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
connection instances created by the Opportunistic Encryption
or PKIX (x.509) instantiation system are distinct
internally. They will inherit this policy bit.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
no.</p>

<p style="margin-left:17%; margin-top: 1em">This feature is
only available with kernel drivers that support SAs to
overlapping conns. At present only the (klips) mast protocol
stack supports this feature.</p>


<p style="margin-left:11%; margin-top: 1em"><b>reqid</b></p>

<p style="margin-left:17%;">a unique identifier used to
match IPsec SAs using iptables with NETKEY/XFRM. This
identifier is normally automatically allocated in groups of
4. It is exported to the _updown script as REQID. On Linux,
reqids are supported with IP Connection Tracking and NAT
(iptables). Automatically generated values use the range
16380 and higher. Manually specified reqid values therefor
must be between 1 and 16379.</p>

<p style="margin-left:17%; margin-top: 1em">Automatically
generated reqids use a range of 0&minus;3 (eg
16380&minus;16383 for the first reqid). These are used
depending on the exact policy (AH, AH+ESP, IPCOMP, etc).
Manually assigned reqids are all identical. Instantiations
of connections (those using %any wildcards) will all use the
same reqid.</p>

<p style="margin-left:17%; margin-top: 1em">For KLIPS, when
using the MAST variant, a different mechanism called SAref
is in use. See overlapip and sareftrack.</p>


<p style="margin-left:11%; margin-top: 1em"><b>dpddelay</b></p>

<p style="margin-left:17%;">Set the delay (in seconds)
between Dead Peer Detection (RFC 3706) keepalives
(R_U_THERE, R_U_THERE_ACK) that are sent for this connection
(default 30 seconds). If dpddelay is set, dpdtimeout also
needs to be set.</p>


<p style="margin-left:11%; margin-top: 1em"><b>dpdtimeout</b></p>

<p style="margin-left:17%;">Set the length of time (in
seconds) we will idle without hearing either an R_U_THERE
poll from our peer, or an R_U_THERE_ACK reply. After this
period has elapsed with no response and no traffic, we will
declare the peer dead, and remove the SA (default 120
seconds). If dpdtimeout is set, dpdaction also needs to be
set.</p>


<p style="margin-left:11%; margin-top: 1em"><b>dpdaction</b></p>

<p style="margin-left:17%;">When a DPD enabled peer is
declared dead, what action should be taken. <b>hold</b>
(default) means the eroute will be put into %hold status,
while <b>clear</b> means the eroute and SA with both be
cleared. <b>restart</b> means that <i>ALL</i> SAs to the
dead peer will renegotiated.</p>


<p style="margin-left:17%; margin-top: 1em"><i>dpdaction=clear</i>
is really only useful on the server of a Road Warrior
config.</p>

<p style="margin-left:17%; margin-top: 1em">The value
<b>restart_by_peer</b> has been obsoleted and its
functionality moved into the regular restart action.</p>

<p style="margin-left:11%; margin-top: 1em"><b>pfs</b></p>

<p style="margin-left:17%;">whether Perfect Forward Secrecy
of keys is desired on the connection's keying channel (with
PFS, penetration of the key&minus;exchange protocol does not
compromise keys negotiated earlier); Since there is no
reason to ever refuse PFS, Libreswan will allow a connection
defined with <b>pfs=no</b> to use PFS anyway. Acceptable
values are <b>yes</b> (the default) and <b>no</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pfsgroup</b></p>

<p style="margin-left:17%;">This option is obsoleted,
please use phase2alg if you need the PFS to be different
from phase1 (the default) using:
phase2alg=aes128&minus;md5;modp1024</p>


<p style="margin-left:11%; margin-top: 1em"><b>aggrmode</b></p>

<p style="margin-left:17%;">Use IKEv1 Aggressive Mode
instead of IKEv1 Main Mode. This option has no effect when
IKEv2 is used. Acceptable values are <b>no</b> (the default)
or <b>yes</b>. When this option is enabled, IKEv1 Main Mode
will no longer be allowed for this connection.</p>

<p style="margin-left:17%; margin-top: 1em">Aggressive Mode
is less secure, and more vulnerable to Denial Of Service
attacks. It is also vulnerable to brute force attacks with
software such as <b>ikecrack</b>. It should not be used, and
it should especially not be used with XAUTH and group
secrets (PSK). If the remote system administrator insists on
staying irresponsible, enable this option.</p>

<p style="margin-left:17%; margin-top: 1em">Aggressive Mode
is further limited to only proposals with one DH group as
there is no room to negotiate the DH group. Therefor it is
mandatory for Aggressive Mode connections that both
<b>ike=</b> and <b>phase2alg=</b> options are specified with
only one fully specified proposal using one DH group.</p>

<p style="margin-left:17%; margin-top: 1em">The KE payload
is created in the first exchange packet when using
aggressive mode. The KE payload depends on the DH group
used. This is why there cannot be multiple DH groups in
IKEv1 aggressive mode. In IKEv2, which uses a similar method
to IKEv1 Aggressive Mode, there is an INVALID_KE response
payload that can inform the initiator of the responder's
desired DH group and so an IKEv2 connection can actually
recover from picking the wrong DH group by restarting its
negotiation.</p>


<p style="margin-left:11%; margin-top: 1em"><b>salifetime</b></p>

<p style="margin-left:17%;">how long a particular instance
of a connection (a set of encryption/authentication keys for
user packets) should last, from successful negotiation to
expiry; acceptable values are an integer optionally followed
by <b>s</b> (a time in seconds) or a decimal number followed
by <b>m</b>, <b>h</b>, or <b>d</b> (a time in minutes,
hours, or days respectively) (default <b>8h</b>, maximum
<b>24h</b>). Normally, the connection is renegotiated (via
the keying channel) before it expires. The two ends need not
exactly agree on <b>salifetime</b>, although if they do not,
there will be some clutter of superseded connections on the
end which thinks the lifetime is longer.</p>

<p style="margin-left:17%; margin-top: 1em">The keywords
&quot;keylife&quot; and &quot;lifetime&quot; are obsoleted
aliases for &quot;salifetime.&quot; Change your configs to
use &quot;salifetime&quot; instead.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rekey</b></p>

<p style="margin-left:17%;">whether a connection should be
renegotiated when it is about to expire; acceptable values
are <b>yes</b> (the default) and <b>no</b>. The two ends
need not agree, but while a value of <b>no</b> prevents
Pluto from requesting renegotiation, it does not prevent
responding to renegotiation requested from the other end, so
<b>no</b> will be largely ineffective unless both ends agree
on it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rekeymargin</b></p>

<p style="margin-left:17%;">how long before connection
expiry or keying&minus;channel expiry should attempts to
negotiate a replacement begin; acceptable values as for
<b>salifetime</b> (default <b>9m</b>). Relevant only
locally, other end need not agree on it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rekeyfuzz</b></p>

<p style="margin-left:17%;">maximum percentage by which
<b>rekeymargin</b> should be randomly increased to randomize
rekeying intervals (important for hosts with many
connections); acceptable values are an integer, which may
exceed 100, followed by a &lsquo;%' (default set by
<b>ipsec_pluto</b>(8), currently <b>100%</b>). The value of
<b>rekeymargin</b>, after this random increase, must not
exceed <b>salifetime</b>. The value <b>0%</b> will suppress
time randomization. Relevant only locally, other end need
not agree on it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>keyingtries</b></p>

<p style="margin-left:17%;">how many attempts (a whole
number or <b>%forever</b>) should be made to negotiate a
connection, or a replacement for one, before giving up
(default <b>%forever</b>). The value <b>%forever</b> means
&ldquo;never give up&rdquo; (obsolete: this can be written
0). Relevant only locally, other end need not agree on
it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ikelifetime</b></p>

<p style="margin-left:17%;">how long the keying channel of
a connection (buzzphrase: &ldquo;ISAKMP SA&rdquo;) should
last before being renegotiated; acceptable values as for
<b>salifetime</b> (default set by <b>ipsec_pluto</b>(8),
currently <b>1h</b>, maximum <b>24h</b>). The
two&minus;ends&minus;disagree case is similar to that of
<b>salifetime</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>retransmit&minus;timeout</b></p>

<p style="margin-left:17%;">how long a single packet,
including retransmits of that packet, may take before the
IKE attempt is aborted. If rekeying is enabled, a new IKE
attempt is started. The default set by
<b>ipsec_pluto</b>(8), currently is <b>60s</b>. See also:
<i>retransmit&minus;interval</i>, <i>rekey</i> and
<i>keyingtries</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>retransmit&minus;interval</b></p>

<p style="margin-left:17%;">the initial interval time
period, specified in msecs, that pluto waits before
retransmitting an IKE packet. This interval is doubled for
each attempt (exponential back&minus;off). The default set
by <b>ipsec_pluto</b>(8), currently is <b>500</b>. See also:
<i>retransmit&minus;timeout</i>, <i>rekey</i> and
<i>keyingtries</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>compress</b></p>

<p style="margin-left:17%;">whether IPComp compression of
content is proposed on the connection (link&minus;level
compression does not work on encrypted data, so to be
effective, compression must be done <i>before</i>
encryption); acceptable values are <b>yes</b> and <b>no</b>
(the default).</p>

<p style="margin-left:17%; margin-top: 1em">As of libreswan
3.1, both ends <b>must</b> agree. In previous versions of
libreswan, openswan and freeswan, compression was always
accepted even if not configured. In light of the BEAST
attacks on TLS, using compression and encryptions has come
under more scrutiny, and it was decided that it should be
possible for the local policy of an endpoint to disallow
compression. A value of <b>yes</b> causes pluto to propose
compression and reject proposals without it. A value of
<b>no</b> prevents pluto from proposing compression; a
proposal to compress will be <b>rejected</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>metric</b></p>

<p style="margin-left:17%;">Set the metric for the routes
to the ipsecX or mastX interface. This makes it possible to
do host failover from another interface to ipsec using route
management. This value is passed to the _updown scripts as
PLUTO_METRIC. This option is only available with KLIPS or
MAST on Linux. Acceptable values are positive numbers, with
the default being <b>1</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>mtu</b></p>

<p style="margin-left:17%;">Set the MTU for the route(s) to
the remote endpoint and/or subnets. This is sometimes
required when the overhead of the IPsec encapsulation would
cause the packet the become too big for a router on the
path. Since IPsec cannot trust any unauthenticated ICMP
messages, PATH MTU discovery does not work. This can also be
needed when using &quot;6to4&quot; IPV6 deployments, which
adds another header on the packet size. Acceptable values
are positive numbers. There is no default.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nflog</b></p>

<p style="margin-left:17%;">If set, the NFLOG group number
to log <b>this connection's</b> pre&minus;crypt and
post&minus;decrypt traffic to. The default value of <b>0</b>
means no logging at all. This option is only available on
linux kernel 2.6.14 and later. It allows common network
utilities such as tcpdump, wireshark and dumpcap, to use
nflog:XXX pseudo interfaces where XXX is the nflog group
number. During the updown phase of a connection, iptables
will be used to add and remove the source/destination pair
to the nflog group specified. The rules are setup with the
nflog&minus;prefix matching the connection name. See also
the global <b>nflog&minus;all</b> option.</p>


<p style="margin-left:11%; margin-top: 1em"><b>priority</b></p>

<p style="margin-left:17%;">The priority in the kernel
SPD/SAD database, when matching up packets. Each kernel
(NETKEY, KLIPS, OSX, etc) has its own mechanism for setting
the priority. Setting this option to non&minus;zero passes
the priority to the kernel stack unmodified. The maximum
value depends on the stack. It is recommended not to exceed
65536</p>

<p style="margin-left:17%; margin-top: 1em">KLIPS and
NETKEY use a priority system based on &quot;most specific
match first&quot;. It uses an internal algorithm to
calculate these based on network prefix length, protocol and
port selectors. A lower value means a higher priority.</p>

<p style="margin-left:17%; margin-top: 1em">Typical values
are about the 2000 range. These can be seen on the NETKEY
stack using <b>ip xfrm policy</b> when the connection is up.
For &quot;anonymous IPsec&quot; or Opportunistic Encryption
based connections, a much lower priority (65535) is used to
ensure administrator configured IPsec always takes
precedence over opportunistic IPsec.</p>


<p style="margin-left:11%; margin-top: 1em"><b>sendca</b></p>

<p style="margin-left:17%;">How much of our available X.509
trust chain to send with the End certificate, excluding any
root CA's. Specifying <b>issuer</b> sends just the issuing
intermediate CA, while <b><br>
all</b> will send the entire chain of intermediate
CA's.<b>none</b> (the default) will not send any CA
certs.</p>


<p style="margin-left:11%; margin-top: 1em"><b>disablearrivalcheck</b></p>

<p style="margin-left:17%;">whether KLIPS's normal
tunnel&minus;exit check (that a packet emerging from a
tunnel has plausible addresses in its header) should be
disabled; acceptable values are <b>yes</b> and <b>no</b>
(the default). Tunnel&minus;exit checks improve security and
do not break any normal configuration. Relevant only
locally, other end need not agree on it.</p>


<p style="margin-left:11%; margin-top: 1em"><b>labeled&minus;ipsec</b></p>

<p style="margin-left:17%;">Whether labeled IPsec should be
enabled or not; acceptable values are <b>no</b> (the
default) and <b>yes</b>. See also policy&minus;label= and
secctx&minus;attr&minus;type=</p>


<p style="margin-left:11%; margin-top: 1em"><b>policy&minus;label</b></p>

<p style="margin-left:17%;">The string representation of an
access control security label that is interpreted by the LSM
(e.g. SELinux) for use with Labeled IPsec. See also
loopback=, labeled&minus;ipsec= and
secctx&minus;attr&minus;type=. For example,
<i>policy&minus;label=system_u:object_r:ipsec_spd_t:s0&minus;s15:c0.c1023</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>failureshunt</b></p>

<p style="margin-left:17%;">what to do with packets when
negotiation fails. The default is <b>none</b>: no shunt;
<b>passthrough</b>, <b>drop</b>, and <b>reject</b> have the
obvious meanings.</p>


<p style="margin-left:11%; margin-top: 1em"><b>negotiationshunt</b></p>

<p style="margin-left:17%;">What to do with packets during
the IKE negotiation. Valid options are <b>hold</b> (the
default) or <b>passthrough</b>. This should almost always be
left to the default hold value to avoid cleartext packet
leaking. The only reason to set this to passthrough is if
plaintext service availability is more important than
service security or privacy, a scenario that also implies
failureshunt=passthrough and most likely authby=%null using
Opportunistic Encryption.</p>

<h2>CONFIG SECTIONS
<a name="CONFIG SECTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">At present, the
only <b>config</b> section known to the IPsec software is
the one named <b>setup</b>, which contains information used
when the software is being started (see
<b>ipsec_setup</b>(8)). Here's an example:</p>

<p style="margin-left:17%; margin-top: 1em"><b>config
setup</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>interfaces=&quot;ipsec0=eth1
ipsec1=ppp0&quot;</b></p> </td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>klipsdebug=none</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>plutodebug=control</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>protostack=auto</b></p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Parameters are
optional unless marked &ldquo;(required)&rdquo;.</p>

<p style="margin-left:11%; margin-top: 1em">The
currently&minus;accepted <i>parameter</i> names in a
<b>config setup</b> section are:</p>


<p style="margin-left:11%; margin-top: 1em"><b>myid</b></p>

<p style="margin-left:17%;">the identity to be used for
<b>%myid</b>. <b>%myid</b> is used in the implicit policy
group conns and can be used as an identity in explicit
conns. If unspecified, <b>%myid</b> is set to the IP address
in <b>%defaultroute</b> (if that is supported by a TXT
record in its reverse domain), or otherwise the system's
hostname (if that is supported by a TXT record in its
forward domain), or otherwise it is undefined. An explicit
value generally starts with &lsquo;&lsquo;<b>@</b>''.</p>


<p style="margin-left:11%; margin-top: 1em"><b>protostack</b></p>

<p style="margin-left:17%;">decide which protocol stack is
going to be used. Valid values are &quot;klips&quot;,
&quot;netkey&quot; (the default) and &quot;mast&quot;. The
&quot;mast&quot; stack is a variation for the KLIPS stack.
The value &quot;auto&quot; has been obsoleted.</p>


<p style="margin-left:11%; margin-top: 1em"><b>interfaces</b></p>

<p style="margin-left:17%;">virtual and physical interfaces
for IPsec to use: a single
<i>virtual</i><b>=</b><i>physical</i> pair, a (quoted!) list
of pairs separated by white space, or <b>%none</b>. One of
the pairs may be written as <b>%defaultroute</b>, which
means: find the interface <i>d</i> that the default route
points to, and then act as if the value was
&lsquo;&lsquo;<b>ipsec0=</b><i>d</i>''. <b>%defaultroute</b>
is the default; <b>%none</b> must be used to denote no
interfaces, or when using the NETKEY stack. If
<b>%defaultroute</b> is used (implicitly or explicitly)
information about the default route and its interface is
noted for use by <b>ipsec_auto</b>(8).)</p>


<p style="margin-left:11%; margin-top: 1em"><b>listen</b></p>

<p style="margin-left:17%;">IP address to listen on
(default depends on <b>interfaces=</b> setting). Currently
only accepts one IP address.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ikeport</b></p>

<p style="margin-left:17%;">The IKE port to listen on. The
default value is <b>500</b>. As IKE is an internet standard,
changing this means pluto will no longer be able to interop
with other devices, unless they have also been explicitly
configured to use a non&minus;standard IKE port. There might
also be other subtle assumptions within the kernel that port
500 is used. Changing this port is strongly discouraged, and
should probably only be done for testing or when required to
circumvent VPN blocking technologies as employed by certain
commercial companies and national governments. See also
<b>nat&minus;ikeport</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nflog&minus;all</b></p>

<p style="margin-left:17%;">If set, the NFLOG group number
to log <b>all</b> pre&minus;crypt and post&minus;decrypt
traffic to. The default value of <b>0</b> means no logging
at all. This option is only available on linux kernel 2.6.14
and later. It allows common network utilities such as
tcpdump, wireshark and dumpcap, to use nflog:XXX pseudo
interfaces where XXX is the nflog group number. During
startup and shutdown of the IPsec service, iptables commands
will be used to add or remove the global NFLOG table rules.
The rules are setup with the nflog&minus;prefix
<i>all&minus;ipsec</i>. See also the per&minus;connection
<b>nflog</b> option.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nat_traversal</b></p>

<p style="margin-left:17%;">OBSOLETE. Support for NAT
Traversal is always enabled.</p>


<p style="margin-left:11%; margin-top: 1em"><b>disable_port_floating</b></p>

<p style="margin-left:17%;">OBSOLETE</p>


<p style="margin-left:11%; margin-top: 1em"><b>force_keepalive</b></p>

<p style="margin-left:17%;">This option has been obsoleted
since libreswan version 3.2. See the
<i>nat&minus;keepalive</i> option.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nat&minus;ikeport</b></p>

<p style="margin-left:17%;">The IKE NAT Traversal floating
port (see RFC&minus;3947) to listen on. The default value is
<b>4500</b>. As IKE/NATT is an internet standard, changing
this means pluto will no longer be able to interoperate with
other devices, unless they have also been explicitly
configured to use a non&minus;standard IKE/NATT port. There
might also be other subtle assumptions within the kernel
that port 4500 is used. Changing this port is strongly
discouraged, and should probably only be done for testing or
when required to circumvent VPN blocking technologies as
employed by certain commercial companies and national
governments. See also <b>ikeport</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>keep&minus;alive</b></p>

<p style="margin-left:17%;">The delay (in seconds) for
NAT&minus;T keep&minus;alive packets, if these are enabled
using <b>nat&minus;keepalive</b> This parameter may
eventually become per&minus;connection.</p>


<p style="margin-left:11%; margin-top: 1em"><b>virtual&minus;private</b></p>

<p style="margin-left:17%;">contains the networks that are
allowed as subnet= for the remote clients when using the
<b>vhost:</b> or <b>vnet:</b> keywords in the <b>subnet=</b>
parameters. In other words, the address ranges that may live
behind a NAT router through which a client connects. This
value is usually set to all the RFC&minus;1918 address
space, excluding the space used in the local subnet behind
the NAT (An IP address cannot live at two places at once).
IPv4 address ranges are denoted as <i>%v4:a.b.c.d/mm</i> and
IPv6 is denoted as <i>%v6:aaaa::bbbb:cccc:dddd:eeee/mm</i>.
One can exclude subnets by using the <b>!</b>. For example,
if the VPN server is giving access to 192.168.1.0/24, this
option should be set to:
<i>virtual&minus;private=%v4:10.0.0.0/8,%v4:192.168.0.0/16,%v4:172.16.0.0/12,%v4:!192.168.1.0/24</i>.
This parameter is only needed on the server side and not on
the client side that resides behind the NAT router, as the
client will just use its IP address for the inner IP
setting. This parameter may eventually become
per&minus;connection. See also <b>leftsubnet=</b></p>

<p style="margin-left:17%; margin-top: 1em">Note: It seems
that T&minus;Mobile in the US and Rogers/Fido in Canada have
started using 25.0.0.0/8 as their pre&minus;NAT range. This
range technically belongs to the Defence Interoperable
Network Services Authority (DINSA), an agency of the
Ministry of Defence of the United Kingdom. The network range
seems to not have been announced for decades, which is
probably why these organisations &quot;borrowed&quot; this
range. To support roadwarriors on these 3G networks, you
might have to add it to the virtual&minus;private= line.</p>


<p style="margin-left:11%; margin-top: 1em"><b>myvendorid</b></p>

<p style="margin-left:17%;">The string to use as our vendor
id (VID) when send&minus;vendorid=yes. The default is
OE&minus;Libreswan&minus;VERSION.</p>

<p style="margin-left:11%; margin-top: 1em"><b>oe</b></p>

<p style="margin-left:17%;">This option is ignored for now.
It used to determine if Opportunistic Encryption will be
enabled. Opportunistic Encryption is the term to describe
using IPsec tunnels without prearrangement. It uses IPSECKEY
or TXT records to announce public RSA keys for certain IP's
or identities. However, this feature is going to be moved
outside of the pluto IKE daemon into a separate process,
more closely tied with a local DNS(SEC) server. The default
value used to be <b>no</b>, so this should not affect
anyone. Contact the developers if you are interested in
working on the re&minus;implementation of OE.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nhelpers</b></p>

<p style="margin-left:17%;">how many <i>pluto helpers</i>
are started to help with cryptographic operations. Pluto
will start <i>(n&minus;1)</i> of them, where <i>n</i> is the
number of CPU's you have (including hypherthreaded CPU's). A
value of 0 forces pluto to do all operations in the main
process. A value of &minus;1 tells pluto to perform the
above calculation. Any other value forces the number to that
amount.</p>


<p style="margin-left:11%; margin-top: 1em"><b>seedbits</b></p>

<p style="margin-left:17%;">Pluto uses the NSS crypto
library as its random source. Some government Three Letter
Agencies require that pluto reads additional bits from
/dev/random and feed these into the NSS RNG before drawing
random from the NSS library, despite the NSS library itself
already seeding its internal state. This process can block
pluto for an extended time during startup, depending on the
entropy of the system. Therefor, the default is to not
perform this redundant seeding. If specifying a value, it is
recommended to specify at least 460 bits (for FIPS) or 440
bits (for BSI).</p>


<p style="margin-left:11%; margin-top: 1em"><b>secctx&minus;attr&minus;type</b></p>

<p style="margin-left:17%;">The value for the IPsec SA
security context attribute identifier which is used for
Labeled IPsec. Defaults to the private use IANA value 32001
from the IPsec SA attributes registry. Old openswan versions
might still be using the (stolen) value 10, which has since
been assigned by IANA for something else. Other values are
not recommended unless IANA assigns an actual value for
this. See also labeled&minus;ipsec=, loopback= and
policy&minus;label=</p>


<p style="margin-left:11%; margin-top: 1em"><b>plutofork</b></p>

<p style="margin-left:17%;">Whether<i>pluto</i> will turn
into a daemon by forking in the background, or whether it
will remain on the foreground. Valid options are <i>yes</i>
(the default) or <i>no</i>. Older init systems, such as sysv
initscripts, require that pluto forks into the background.
Newer init systems, such as <i>systemd</i> or <i>upstart</i>
prefer the process remains in the foreground. The current
default reflects the fact that most systems are still based
on sysv init scripts. Init systems can override this
configuration option by starting pluto specifically with
<i>&minus;&minus;nofork</i> specified on the command line to
start the <i>pluto</i> daemon <b>after</b> specifying the
<i>&minus;&minus;config /etc/ipsec.conf</i> option.</p>


<p style="margin-left:11%; margin-top: 1em"><b>crlcheckinterval</b></p>

<p style="margin-left:17%;">interval expressed in second
units, for example crlcheckinterval=60 for 60 seconds, after
which pluto will verify loaded X.509 CRL's for expiration.
If any of the CRL's is expired, or if they previously failed
to get updated, a new attempt at updating the CRL is made.
The first attempt to update a CRL is started at two times
the crlcheckinterval. If set to <b>0</b>, which is also the
default value if this option is not specified, CRL updating
is disabled.</p>


<p style="margin-left:11%; margin-top: 1em"><b>crl&minus;strict</b></p>

<p style="margin-left:17%;">if not set, pluto is tolerant
about missing or expired X.509 Certificate Revocation Lists
(CRL's), and will allow peer certificates as long as they do
not appear on an expired CRL. When this option is enabled,
all connections with an expired or missing CRL will be
denied. Active connections will be terminated at rekey time.
This setup is more secure, but also dangerous. If the CRL is
fetched through an IPsec tunnel with a CRL that expired, the
entire VPN server will be dead in the water until a new CRL
is manually transferred to the machine (if it allows
non&minus;IPsec connections). Acceptable values are
<b>yes</b> or <b>no</b> (the default). This option used to
be called <b>strictcrlpolicy=</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>ocsp&minus;enable</b></p>

<p style="margin-left:17%;">Whether to perform Online
Certificate Store Protocol (&quot;OCSP&quot;) checks on
those certificates that have an OCSP URI defined. Acceptable
values are <b>yes</b> or <b>no</b> (the default).</p>


<p style="margin-left:11%; margin-top: 1em"><b>ocsp&minus;strict</b></p>

<p style="margin-left:17%;">if set to no, pluto is tolerant
about failing to obtain an OCSP responses and a certificate
is not rejected when the OCSP request fails, only when the
OCSP request succeeds and lists the certificate as revoked.
If set to yes, any failure on obtaining an OCSP status for a
certificate will be fatal and the certificate will be
rejected. Acceptable values are <b>yes</b> or <b>no</b> (the
default).</p>

<p style="margin-left:17%; margin-top: 1em">The strict mode
refers to the NSS ocspMode_FailureIsVerificationFailure
mode, while non&minus;strict mode refers to the NSS
ocspMode_FailureIsNotAVerificationFailure mode.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ocsp&minus;timeout</b></p>

<p style="margin-left:17%;">The time until an OCSP request
is aborted and considered failed. The default value is 2
seconds.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ocsp&minus;uri</b></p>

<p style="margin-left:17%;">The URI to use for OCSP
requests instead of the default OCSP URI listed in the CA
certificate. This requires the ocsp&minus;trustname option
to be set to the nick (friendly name) of the OCSP server
certificate, which needs to be present in the NSS database.
These option combined with the next option sets the OCSP
<i>default responder</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ocsp&minus;trustname</b></p>

<p style="margin-left:17%;">The nickname of the certificate
that has been imported into the NSS database of the server
handling the OCSP requests. This requires the ocsp&minus;uri
option to be set as well. This option and the previous
options sets the OCSP <i>default responder</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>forwardcontrol</b></p>

<p style="margin-left:17%;">This option is obsolete and
ignored. Please use <b>net.ipv4.ip_forward&nbsp;=&nbsp;0</b>
in /etc/sysctl.conf instead to control the ip forwarding
behaviour.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rp_filter</b></p>

<p style="margin-left:17%;">This option is obsolete and
ignored. Please use the
<b>net.ipv4.conf/[iface]/rp_filter&nbsp;=&nbsp;0</b> options
in /etc/sysctl.conf instead. This option is badly
documented; it must be 0 in many cases for ipsec to
function.</p>


<p style="margin-left:11%; margin-top: 1em"><b>syslog</b></p>

<p style="margin-left:17%;">the <b>syslog</b>(2)
&ldquo;facility&rdquo; name and priority to use for
startup/shutdown log messages, default
<b>daemon.error</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>klipsdebug</b></p>

<p style="margin-left:17%;">how much KLIPS debugging output
should be logged. An empty value, or the magic value
<b>none</b>, means no debugging output (the default). The
magic value <b>all</b> means full output. Otherwise only the
specified types of output (a quoted list, names separated by
white space) are enabled; for details on available debugging
types, see <b>ipsec_klipsdebug</b>(8). This KLIPS option has
no effect on NETKEY, Windows or BSD stacks.</p>


<p style="margin-left:11%; margin-top: 1em"><b>plutodebug</b></p>

<p style="margin-left:17%;">how much Pluto debugging output
should be logged. An empty value, or the magic value
<b>none</b>, means no debugging output (the default). The
magic value <b>all</b> means full output. Otherwise only the
specified types of output (a quoted list, names without the
<b>&minus;&minus;debug&minus;</b> prefix, separated by white
space) are enabled; for details on available debugging
types, see <b>ipsec_pluto</b>(8).</p>


<p style="margin-left:11%; margin-top: 1em"><b>uniqueids</b></p>

<p style="margin-left:17%;">whether a particular
participant ID should be kept unique, with any new
(automatically keyed) connection using an ID from a
different IP address deemed to replace all old ones using
that ID. Acceptable values are <b>yes</b> (the default) and
<b>no</b>. Participant IDs normally <i>are</i> unique, so a
new (automatically&minus;keyed) connection using the same ID
is almost invariably intended to replace an old one.</p>


<p style="margin-left:11%; margin-top: 1em"><b>plutorestartoncrash</b></p>

<p style="margin-left:17%;">prevent pluto from restarting
after it crashed. This option should only be used by
developers when debugging a crasher. It will prevent
overwriting a core file on a new start, or a cascade of core
files. This option is also required if used with
plutostderrlog= to avoid clearing the logs of the crasher.
Values can be yes (the default) or no.</p>

<p style="margin-left:17%; margin-top: 1em">This option is
ignored on modern init systems such as <b>systemd</b>(1) and
upstart. For systemd, change the <i>ipsec.service</i> file
to contain <i>Restart=no</i>. See
<b>systemd.service</b>(5)</p>


<p style="margin-left:11%; margin-top: 1em"><b>logfile</b></p>

<p style="margin-left:17%;">do not use syslog, but rather
log to stderr, and direct stderr to the argument file. This
option used to be called plutostderrlog=</p>


<p style="margin-left:11%; margin-top: 1em"><b>logappend</b></p>

<p style="margin-left:17%;">If pluto is instructed to log
to a file using <b>logfile=</b>, this option determines
whether the log file should be appended to or overwritten.
Valid options are <b>yes</b> (the default) to append and
<b>no</b> to overwrite. Since on modern systems, pluto is
restarted by other daemons, such as systemd, this option
should be left at its default yes value to preserve the log
entries of previous runs of pluto. The option is mainly of
use for running the test suite, which needs to create new
log files from scratch.</p>


<p style="margin-left:11%; margin-top: 1em"><b>logtime</b></p>

<p style="margin-left:17%;">When pluto is directed to log
to a file using <b>logfile=</b>, this option determines
whether or not to log the current timestamp as prefix.
Values are <b>yes</b> (the default) or <b>no</b>. The no
value can be used to create logs without ephemeral
timestamps, such as those created when running the test
suite. This option used to be called plutostderrlogtime=</p>


<p style="margin-left:11%; margin-top: 1em"><b>force&minus;busy</b></p>

<p style="margin-left:17%;">This option has been obsoleted,
please see <i>ddos&minus;mode</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ddos&minus;mode</b></p>

<p style="margin-left:17%;">The startup mode of the DDOS
defense mechanism. Acceptable values are <b>busy</b>,
<b>unlimited</b> or <b>auto</b> (the default). This option
can also be given to the IKE daemon while running, for
example by issuing <i>ipsec whack
&minus;&minus;ddos&minus;&minus;busy</i>. When in busy mode,
pluto activates anti&minus;DDoS counter measures. Currently,
counter measures consist of requiring IKEv2 anti&minus;DDoS
cookies on new incoming IKE requests, and a more aggressive
cleanup of partially established or AUTH_NULL
connections.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ddos&minus;ike&minus;treshold</b></p>

<p style="margin-left:17%;">The number of half&minus;open
IKE SAs before the pluto IKE daemon will be placed in busy
mode. When in busy mode, pluto activates anti&minus;DDoS
counter measures. The default is 25000. See also
<b>ddos&minus;mode</b> and <i>ipsec whack
&minus;&minus;ddos&minus;XXX</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>max&minus;halfopen&minus;ike</b></p>

<p style="margin-left:17%;">The number of half&minus;open
IKE SAs before the IKE daemon starts refusing all new IKE
attempts. Established IKE peers are not affected. The
default value is 50000.</p>


<p style="margin-left:11%; margin-top: 1em"><b>shuntlifetime</b></p>

<p style="margin-left:17%;">The time until bare shunts
(kernel policies not associated with connections) are
deleted from the kernel. The default value is 15m. When
using Opportunistic Encryption to a specific host fails, the
system will either install a %pass or %hold shunt to let the
traffic out clear text or block it. During the the
shuntlifetime, no new Opportunistic Encryption attempt will
be started, although the system will still respond to
incoming OE requests from the remote IP. See also
<b>failureshunt</b> and <b>negotiationshunt</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>xfrmlifetime</b></p>

<p style="margin-left:17%;">The time in seconds until the
NETKEY/XFRM acquire state times out. The default value is
300 seconds. For auto=ondemand connections and Opportunistic
connections an IPsec policy is installed in the kernel. If
an incoming or outgoing packet matches this policy, a state
is created in the kernel and the kernel sends an ACQUIRE
message to the IKE daemon pluto. While this state is in
place, no new acquires will come in for this connection. The
default should be fine for most people. One use case of
shortening these is if opportunistc encryption is used
towards cloud instances that can quickly re&minus;use IP
addresses. This value is only used during the libreswan
startup process by the ipsec _stackmanager helper. See also
<b>failureshunt</b> and <b>negotiationshunt</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>dumpdir</b></p>

<p style="margin-left:17%;">in what directory should things
started by <i>setup</i> (notably the Pluto daemon) be
allowed to dump core? The default value is
<i>/var/run/pluto</i>. When SELinux runs in enforced mode,
changing this requires a similar change in the SELinux
policy for the pluto daemon.</p>


<p style="margin-left:11%; margin-top: 1em"><b>statsbin</b></p>

<p style="margin-left:17%;">This option specifies an
optional external program to report tunnel state changes
too. The default is not to report tunnel state changes. This
program can be used to notify the user's desktop (dbus,
NetworkManager) or to report tunnel changes to a central
logging server.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ipsecdir</b></p>

<p style="margin-left:17%;">in what directory the X509, NSS
and OE related files should be stored. The default value is
<i>/etc/ipsec.d</i>. When SELinux runs in enforced mode,
changing this requires a similar change in the SELinux
policy for the pluto daemon. Note that NSS generated db
files contain their location within their files, so you
cannot move this directory without re&minus;creating the NSS
files.</p>


<p style="margin-left:11%; margin-top: 1em"><b>secretsfile</b></p>

<p style="margin-left:17%;">in which file the secret
credentials such as preshared keys (PSKs) are stored. See
<i>man ipsec.secrets</i> for the syntax. The default value
is <i>/etc/ipsec.secrets</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>perpeerlog</b></p>

<p style="margin-left:17%;">if pluto should split the logs
in a per&minus;peer directory. Valid options are
<b>no</b>(the default) and <b>yes</b>. When enabled, logging
is split into directories based on IP address. When
disabled, logging is done via syslog or a single log file,
as defined by <b>logfile=</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>perpeerlogdir</b></p>

<p style="margin-left:17%;">in what directory the
per&minus;peer log should be created, if enabled via the
<b>perpeerlog</b> option. This will result in sub
directories in the structure /192/0/2. The default value is
<i>/var/log/pluto/peer/</i>. When SELinux runs in enforced
mode, changing this requires a similar change in the SELinux
policy for the pluto daemon.</p>


<p style="margin-left:11%; margin-top: 1em"><b>fragicmp</b></p>

<p style="margin-left:17%;">whether a tunnel's need to
fragment a packet should be reported back with an ICMP
message, in an attempt to make the sender lower his PMTU
estimate; acceptable values are <b>no</b> (the default) and
<b>yes</b>. This KLIPS option has no effect on NETKEY,
Windows or BSD stacks.</p>


<p style="margin-left:11%; margin-top: 1em"><b>hidetos</b></p>

<p style="margin-left:17%;">whether a tunnel packet's TOS
field should be set to 0 rather than copied from the user
packet inside; acceptable values are <b>yes</b> (the
default) and <b>no</b>. This KLIPS option has no effect on
NETKEY, Windows or BSD stacks.</p>


<p style="margin-left:11%; margin-top: 1em"><b>overridemtu</b></p>

<p style="margin-left:17%;">value that the MTU of the
ipsec<i>n</i> interface(s) should be set to, overriding
IPsec's (large) default. This parameter is needed only in
special situations. This KLIPS option has no effect on
NETKEY, Windows or BSD stacks.</p>

<h2>IMPLICIT CONNS
<a name="IMPLICIT CONNS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The system
automatically defines several conns to implement default
policy groups. Each can be overridden by explicitly defining
a new conn with the same name. If the new conn has
<b>auto=ignore</b>, the definition is suppressed.</p>

<p style="margin-left:11%; margin-top: 1em">Here are the
automatically supplied definitions.</p>

<p style="margin-left:17%; margin-top: 1em"><b>conn
clear</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>type=passthrough</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>authby=never</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>left=%defaultroute</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>right=%group</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>auto=route</b></p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em"><b>conn
clear&minus;or&minus;private</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>type=passthrough</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>left=%defaultroute</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>leftid=%myid</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>right=%opportunisticgroup</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>failureshunt=passthrough</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>keyingtries=3</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>ikelifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>salifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>rekey=no</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>auto=route</b></p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em"><b>conn
private&minus;or&minus;clear</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>type=tunnel</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>left=%defaultroute</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>leftid=%myid</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>right=%opportunisticgroup</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>failureshunt=passthrough</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>keyingtries=3</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>ikelifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>salifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>rekey=no</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>auto=route</b></p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em"><b>conn
private</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>type=tunnel</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>left=%defaultroute</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>leftid=%myid</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>right=%opportunisticgroup</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>failureshunt=drop</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>keyingtries=3</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>ikelifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>salifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>rekey=no</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>auto=route</b></p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em"><b>conn
block</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>type=reject</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>authby=never</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>left=%defaultroute</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>right=%group</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>auto=route</b></p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em"><b># default
policy <br>
conn packetdefault</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>type=tunnel</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>left=%defaultroute</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>leftid=%myid</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>left=0.0.0.0/0</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>right=%opportunistic</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>failureshunt=passthrough</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>keyingtries=3</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>ikelifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>salifetime=1h</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>rekey=no</b></p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p><b>auto=route</b></p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">These conns are
<i>not</i> affected by anything in <b>conn %default</b>.
They will only work if <b>%defaultroute</b> works. The
<b>leftid</b> will be the interfaces IP address; this
requires that reverse DNS records be set up properly.</p>

<p style="margin-left:11%; margin-top: 1em">The implicit
conns are defined after all others. It is appropriate and
reasonable to use <b>also=private&minus;or&minus;clear</b>
(for example) in any other opportunistic conn.</p>

<h2>POLICY GROUP FILES
<a name="POLICY GROUP FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The optional
files under /etc/ipsec.d/policy, including</p>


<p style="margin-left:17%; margin-top: 1em">/etc/ipsec.d/policies/clear
<br>
/etc/ipsec.d/policies/clear&minus;or&minus;private <br>
/etc/ipsec.d/policies/private&minus;or&minus;clear <br>
/etc/ipsec.d/policies/private <br>
/etc/ipsec.d/policies/block</p>

<p style="margin-left:11%; margin-top: 1em">may contain
policy group configuration information to supplement
<i>ipsec.conf</i>. Their contents are not
security&minus;sensitive.</p>

<p style="margin-left:11%; margin-top: 1em">These files are
text files. Each consists of a list of CIDR blocks, one per
line. White space followed by # followed by anything to the
end of the line is a comment and is ignored, as are empty
lines.</p>

<p style="margin-left:11%; margin-top: 1em">A connection in
ipsec.conf which has <b>right=%group</b> or
<b>right=%opportunisticgroup</b> is a policy group
connection. When a policy group file of the same name is
loaded, with &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

<p style="margin-left:11%; margin-top: 1em"><b>ipsec auto
&minus;&minus;rereadgroups</b></p>

<p style="margin-left:11%; margin-top: 1em">or at system
start, the connection is instantiated such that each CIDR
block serves as an instance's <b>right</b> value. The system
treats the resulting instances as normal connections.</p>

<p style="margin-left:11%; margin-top: 1em">For example,
given a suitable connection definition <b>private</b>, and
the file /etc/ipsec.d/policy/private with an entry
192.0.2.3, the system creates a connection instance
<b>private#192.0.2.3.</b> This connection inherits all
details from <b>private</b>, except that its right client is
192.0.2.3.</p>

<h2>DEFAULT POLICY GROUPS
<a name="DEFAULT POLICY GROUPS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The standard
Libreswan install includes several policy groups which
provide a way of classifying possible peers into IPsec
security classes: <b>private</b> (talk encrypted only),
<b>private&minus;or&minus;clear</b> (prefer encryption),
<b>clear&minus;or&minus;private</b> (respond to requests for
encryption), <b>clear</b> and <b>block</b>. Implicit policy
groups apply to the local host only, and are implemented by
the <b>IMPLICIT CONNECTIONS</b> described above.</p>

<h2>OBSOLETE
<a name="OBSOLETE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Various options
have recently been obsoleted and are ignored. The options
<b>prepluto=</b> and <b>plutopost=</b> have been obsoleted
because these were used by the (obsoleted) shell wrappers
launching the pluto daemon. If this functionality is needed,
look at your initsystem for support. For example, the
<b>systemd</b> initsystem has the options
<b>ExecStartPre=</b> and <b>ExecStopPost=</b> to accomplish
the same. The option <b>plutoopts=</b> has also been
obsoleted for this reason. A replacement can be found in the
<b>PLUTO_OPTS</b> environment variable in the file
<b>/etc/sysconfig/pluto</b> (Fedora/RHEL) or
<b>/etc/defaults/pluto</b> (Debian/Ubuntu). The last two
options obsoleted by the removal of the old shell scripts
are <b>pluto=</b> and <b>plutowait=</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The following
ipsec commands have been obsoleted: <b>ipsec _confread</b>,
<b>ipsec _include</b>, <b>ipsec _plutoload</b>, <b>ipsec
_realsetup</b>, <b>ipsec _startklips</b> and <b>ipsec
_startnetkey</b> due to the new parsing and startup methods
and <b>ipsec copyright</b>, <b>ipsec lwdnsq</b>, <b>ipsec
mailkey</b>, <b>ipsec policy</b>, <b>ipsec showdefaults</b>
and <b>ipsec showpolicy</b> because they were no longer
needed or current.</p>

<h2>CHOOSING A CONNECTION [THIS SECTION IS EXTREMELY OUT OF DATE
<a name="CHOOSING A CONNECTION [THIS SECTION IS EXTREMELY OUT OF DATE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">When choosing a
connection to apply to an outbound packet caught with a
<b>%trap,</b> the system prefers the one with the most
specific eroute that includes the packet's source and
destination IP addresses. Source subnets are examined before
destination subnets. For initiating, only routed connections
are considered. For responding, unrouted but added
connections are considered.</p>

<p style="margin-left:11%; margin-top: 1em">When choosing a
connection to use to respond to a negotiation which doesn't
match an ordinary conn, an opportunistic connection may be
instantiated. Eventually, its instance will be /32
&minus;&gt; /32, but for earlier stages of the negotiation,
there will not be enough information about the client
subnets to complete the instantiation.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:17%; margin-top: 1em">/etc/ipsec.conf
<br>
/etc/ipsec.d/policies/clear <br>
/etc/ipsec.d/policies/clear&minus;or&minus;private <br>
/etc/ipsec.d/policies/private&minus;or&minus;clear <br>
/etc/ipsec.d/policies/private <br>
/etc/ipsec.d/policies/block</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>ipsec</b>(8),
<b>ipsec_ttoaddr</b>(8), <b>ipsec_auto</b>(8),
<b>ipsec_rsasigkey</b>(8)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Designed for
the FreeS/WAN project
&lt;<b><font color="#0000FF">http://www.freeswan.org</font></b><font color="#000000">&gt;
by Henry Spencer.</font></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Before
reporting new bugs, please ensure you are using the latest
version of Libreswan, and if not using KLIPS, please ensure
you are using the latest kernel code for your IPsec
stack.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">When
<b>type</b> or <b>failureshunt</b> is set to <b>drop</b> or
<b>reject,</b> Libreswan blocks outbound packets using
eroutes, but assumes inbound blocking is handled by the
firewall. Libreswan offers firewall hooks via an
&ldquo;updown&rdquo; script. However, the default <b>ipsec
_updown</b> provides no help in controlling a modern
firewall.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Including
attributes of the keying channel (authentication methods,
<b>ikelifetime</b>, etc.) as an attribute of a connection,
rather than of a participant pair, is dubious and incurs
limitations.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
use of <b>%any</b> with the <i>protoport=</i> option is
ambiguous. Should the SA permits any port through or should
the SA negotiate any single port through? The first is a
basic conn with a wildcard. The second is a template. The
second is the current behaviour, and it's wrong for quite a
number of uses involving TCP. The keyword <b>%one</b> may be
introduced in the future to separate these two
cases.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">It
would be good to have a line&minus;continuation syntax,
especially for the very long lines involved in RSA signature
keys.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>First
packet caching</b> is only implemented for the KLIPS(NG) and
MAST stacks. NETKEY returns POSIX&minus;breaking responses,
visible as <i>connect: Resource temporarily unavailable</i>
errors. This affects Opportunistic Encryption and DPD.
Functionality on the BSD and Windows stacks is
unknown.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Some
state information is only available when using KLIPS, and
will return errors on other IPsec stacks. These include
<i>ipsec eroute</i>, <i>ipsec spi</i> and <i>ipsec
look</i>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Multiple
L2TP clients behind the same NAT router, and multiple L2TP
clients behind different NAT routers using the same Virtual
IP is currently only working for the KLIPSNG
stack.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
ability to specify different identities, <b>authby</b>, and
public keys for different automatic&minus;keyed connections
between the same participants is misleading; this doesn't
work dependably because the identity of the participants is
not known early enough. This is especially awkward for the
&ldquo;Road Warrior&rdquo; case, where the remote IP address
is specified as 0.0.0.0, and that is considered to be the
&ldquo;participant&rdquo; for such connections.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">In
principle it might be necessary to control MTU on an
interface&minus;by&minus;interface basis, rather than with
the single global override that <b>overridemtu</b> provides.
This feature is planned for a future release.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">If
conns are to be added before DNS is available,
<b>left=</b><i>FQDN</i>, <b>leftnextop=</b><i>FQDN</i>, and
<b>leftrsasigkey=%dnsonload</b> will fail.
<b>ipsec_pluto</b>(8) does not actually use the public key
for our side of a conn but it isn't generally known at a
add&minus;time which side is ours (Road Warrior and
Opportunistic conns are currently exceptions).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
<b>myid</b> option does not affect explicit <b><br>
ipsec auto &minus;&minus;add</b> or <b>ipsec auto
&minus;&minus;replace</b> commands for implicit
conns.</font></p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Paul
Wouters</b></font></p>


<p style="margin-left:17%;"><font color="#000000">documenter</font></p>
<hr>
</body>
</html>
