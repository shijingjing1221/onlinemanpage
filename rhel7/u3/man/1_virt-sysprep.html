<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:50:59 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>virt-sysprep</title>

</head>
<body>

<h1 align="center">virt-sysprep</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#WARNING">WARNING</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#OPERATIONS">OPERATIONS</a><br>
<a href="#COPYING AND CLONING">COPYING AND CLONING</a><br>
<a href="#FIRSTBOOT VS SCRIPT">FIRSTBOOT VS SCRIPT</a><br>
<a href="#SECURITY">SECURITY</a><br>
<a href="#SELINUX">SELINUX</a><br>
<a href="#WINDOWS 8">WINDOWS 8</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#BUGS">BUGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">virt&minus;sysprep
&minus; Reset, unconfigure or customize a virtual machine so
clones can be made</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em"> virt&minus;sysprep [&minus;&minus;options] &minus;d domname
 virt&minus;sysprep [&minus;&minus;options] &minus;a disk.img [&minus;a disk.img ...]</pre>


<h2>WARNING
<a name="WARNING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Using
<tt>&quot;virt&minus;sysprep&quot;</tt> on live virtual
machines, or concurrently with other disk editing tools, can
be dangerous, potentially causing disk corruption. The
virtual machine must be shut down before you use this
command, and disk images must not be edited
concurrently.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Virt-sysprep
can reset or unconfigure a virtual machine so that clones
can be made from it. Steps in this process include removing
<small>SSH</small> host keys, removing persistent network
<small>MAC</small> configuration, and removing user
accounts. Virt-sysprep can also customize a virtual machine,
for instance by adding <small>SSH</small> keys, users or
logos. Each step can be enabled or disabled as required.</p>

<p style="margin-left:11%; margin-top: 1em">Virt-sysprep
modifies the guest or disk image <i>in place</i>. The guest
must be shut down. If you want to preserve the existing
contents of the guest, <i>you must snapshot, copy or clone
the disk first</i>. See &quot; <small>COPYING AND
CLONING&quot;</small> below.</p>

<p style="margin-left:11%; margin-top: 1em">You do
<i>not</i> need to run virt-sysprep as root. In fact
we&rsquo;d generally recommend that you don&rsquo;t. The
time you might want to run it as root is when you need root
in order to access the disk image, but even in this case it
would be better to change the permissions on the disk image
to be writable as the non-root user running
virt-sysprep.</p>


<p style="margin-left:11%; margin-top: 1em">&quot;Sysprep&quot;
stands for &quot;system preparation&quot; tool. The name
comes from the Microsoft program <i>sysprep.exe</i> which is
used to unconfigure Windows machines in preparation for
cloning them. Having said that, virt-sysprep does <i>not</i>
currently work on Microsoft Windows guests. We plan to
support Windows sysprepping in a future version, and we
already have code to do it.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;help</b></p>

<p style="margin-left:17%;">Display brief help.</p>

<p style="margin-left:11%;"><b>&minus;a</b> file <b><br>
&minus;&minus;add</b> file</p>

<p style="margin-left:17%;">Add <i>file</i> which should be
a disk image from a virtual machine.</p>

<p style="margin-left:17%; margin-top: 1em">The format of
the disk image is auto-detected. To override this and force
a particular format use the <i>&minus;&minus;format</i>
option.</p>

<p style="margin-left:11%;"><b>&minus;a</b>
<small>URI</small> <b><br>
&minus;&minus;add</b> <small>URI</small></p>

<p style="margin-left:17%;">Add a remote disk. The
<small>URI</small> format is compatible with guestfish. See
&quot; <small>ADDING REMOTE STORAGE&quot;</small> in
<i>guestfish</i>(1).</p>

<p style="margin-left:11%;"><b>&minus;&minus;colors <br>
&minus;&minus;colours</b></p>

<p style="margin-left:17%;">Use <small>ANSI</small> colour
sequences to colourize messages. This is the default when
the output is a tty. If the output of the program is
redirected to a file, <small>ANSI</small> colour sequences
are disabled unless you use this option.</p>

<p style="margin-left:11%;"><b>&minus;c</b>
<small>URI</small> <b><br>
&minus;&minus;connect</b> <small>URI</small></p>

<p style="margin-left:17%;">If using libvirt, connect to
the given <i><small>URI</small></i> . If omitted, then we
connect to the default libvirt hypervisor.</p>

<p style="margin-left:17%; margin-top: 1em">If you specify
guest block devices directly (<i>&minus;a</i>), then libvirt
is not used at all.</p>

<p style="margin-left:11%;"><b>&minus;d</b> guest <b><br>
&minus;&minus;domain</b> guest</p>

<p style="margin-left:17%;">Add all the disks from the
named libvirt guest. Domain UUIDs can be used instead of
names.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;n</b></p></td>
<td width="86%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;dry&minus;run</b></p>

<p style="margin-left:17%;">Perform a read-only &quot;dry
run&quot; on the guest. This runs the sysprep operation, but
throws away any changes to the disk at the end.</p>

<p style="margin-left:11%;"><b>&minus;&minus;enable</b>
operations</p>

<p style="margin-left:17%;">Choose which sysprep operations
to perform. Give a comma-separated list of operations, for
example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &minus;&minus;enable ssh&minus;hostkeys,udev&minus;persistent&minus;net</pre>


<p style="margin-left:17%; margin-top: 1em">would enable
<small>ONLY</small> <tt>&quot;ssh&minus;hostkeys&quot;</tt>
and <tt>&quot;udev&minus;persistent&minus;net&quot;</tt>
operations.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<i>&minus;&minus;enable</i> option is not given, then we
default to trying most sysprep operations (see
<i>&minus;&minus;list&minus;operations</i> to show which are
enabled).</p>

<p style="margin-left:17%; margin-top: 1em">Regardless of
the <i>&minus;&minus;enable</i> option, sysprep operations
are skipped for some guest types.</p>

<p style="margin-left:17%; margin-top: 1em">Use
<i>&minus;&minus;list&minus;operations</i> to list
operations supported by a particular version of
virt-sysprep.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>OPERATIONS&quot;</small> below for a list and an
explanation of each operation.</p>

<p style="margin-left:11%;"><b>&minus;&minus;operation</b>
operations <b><br>
&minus;&minus;operations</b> operations</p>

<p style="margin-left:17%;">Choose which sysprep operations
to perform. Give a comma-separated list of operations, for
example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &minus;&minus;operations ssh&minus;hostkeys,udev&minus;persistent&minus;net</pre>


<p style="margin-left:17%; margin-top: 1em">would enable
<small>ONLY</small> <tt>&quot;ssh&minus;hostkeys&quot;</tt>
and <tt>&quot;udev&minus;persistent&minus;net&quot;</tt>
operations.</p>


<p style="margin-left:17%; margin-top: 1em"><i>&minus;&minus;operations</i>
allows you to enable and disable any operation, including
the default ones (which would be tried when specifying
neither <i>&minus;&minus;operations</i> nor
<i>&minus;&minus;enable</i>) and all the available ones;
prepending a <tt>&quot;&minus;&quot;</tt> in front of an
operation name removes it from the list of enabled
operations, while the meta-names
<tt>&quot;defaults&quot;</tt> and <tt>&quot;all&quot;</tt>
represent respectively the operations enabled by default and
all the available ones. For example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &minus;&minus;operations firewall&minus;rules,defaults,&minus;tmp&minus;files</pre>


<p style="margin-left:17%; margin-top: 1em">would enable
the <tt>&quot;firewall&minus;rules&quot;</tt> operation
(regardless whether it is enabled by default), all the
default ones, and disable the
<tt>&quot;tmp&minus;files&quot;</tt> operation.</p>


<p style="margin-left:17%; margin-top: 1em"><i>&minus;&minus;operations</i>
can be specified multiple times; the first time the set of
enabled operations is empty, while any further
<i>&minus;&minus;operations</i> affects the operations
enabled so far.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<i>&minus;&minus;operations</i> option is not given, then we
default to trying most sysprep operations (see
<i>&minus;&minus;list&minus;operations</i> to show which are
enabled).</p>

<p style="margin-left:17%; margin-top: 1em">Regardless of
the <i>&minus;&minus;operations</i> option, sysprep
operations are skipped for some guest types.</p>

<p style="margin-left:17%; margin-top: 1em">Use
<i>&minus;&minus;list&minus;operations</i> to list
operations supported by a particular version of
virt-sysprep.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>OPERATIONS&quot;</small> below for a list and an
explanation of each operation.</p>

<p style="margin-left:11%;"><b>&minus;&minus;format</b>
raw|qcow2|.. <b><br>
&minus;&minus;format</b> auto</p>

<p style="margin-left:17%;">The default for the
<i>&minus;a</i> option is to auto-detect the format of the
disk image. Using this forces the disk format for
<i>&minus;a</i> options which follow on the command line.
Using <i>&minus;&minus;format auto</i> switches back to
auto-detection for subsequent <i>&minus;a</i> options.</p>

<p style="margin-left:17%; margin-top: 1em">For
example:</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;sysprep &minus;&minus;format raw &minus;a disk.img</pre>


<p style="margin-left:17%; margin-top: 1em">forces raw
format (no auto-detection) for <i>disk.img</i>.</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;sysprep &minus;&minus;format raw &minus;a disk.img &minus;&minus;format auto &minus;a another.img</pre>


<p style="margin-left:17%; margin-top: 1em">forces raw
format (no auto-detection) for <i>disk.img</i> and reverts
to auto-detection for <i>another.img</i>.</p>

<p style="margin-left:17%; margin-top: 1em">If you have
untrusted raw-format guest disk images, you should use this
option to specify the disk format. This avoids a possible
security problem with malicious guests (
<small>CVE&minus;2010&minus;3851</small> ).</p>


<p style="margin-left:11%;"><b>&minus;&minus;list&minus;operations</b></p>

<p style="margin-left:17%;">List the operations supported
by the virt-sysprep program.</p>

<p style="margin-left:17%; margin-top: 1em">These are
listed one per line, with one or more single-space-separated
fields, eg:</p>

<pre style="margin-left:17%; margin-top: 1em"> $ virt&minus;sysprep &minus;&minus;list&minus;operations
 bash&minus;history * Remove the bash history in the guest
 cron&minus;spool * Remove user at&minus;jobs and cron&minus;jobs
 dhcp&minus;client&minus;state * Remove DHCP client leases
 dhcp&minus;server&minus;state * Remove DHCP server leases
 [etc]</pre>


<p style="margin-left:17%; margin-top: 1em">The first field
is the operation name, which can be supplied to
<i>&minus;&minus;enable</i>. The second field is a
<tt>&quot;*&quot;</tt> character if the operation is enabled
by default or blank if not. Subsequent fields on the same
line are the description of the operation.</p>

<p style="margin-left:17%; margin-top: 1em">Before
libguestfs 1.17.33 only the first (operation name) field was
shown and all operations were enabled by default.</p>


<p style="margin-left:11%;"><b>&minus;&minus;mount&minus;options</b>
mp:opts[;mp:opts;...]</p>

<p style="margin-left:17%;">Set the mount options used when
libguestfs opens the disk image. Note this has no effect on
the guest. It is used when opening certain guests such as
ones using the <small>UFS</small> ( <small>BSD</small> )
filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">Use a
semicolon-separated list of
<tt>&quot;mountpoint:options&quot;</tt> pairs. You may need
to quote this list to protect it from the shell.</p>

<p style="margin-left:17%; margin-top: 1em">For
example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &minus;&minus;mount&minus;options &quot;/:noatime&quot;</pre>


<p style="margin-left:17%; margin-top: 1em">will mount the
root directory with <tt>&quot;notime&quot;</tt>. This
example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &minus;&minus;mount&minus;options &quot;/:noatime;/var:rw,nodiratime&quot;</pre>


<p style="margin-left:17%; margin-top: 1em">will do the
same, plus mount <i>/var</i> with
<tt>&quot;rw,nodiratime&quot;</tt>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;q</b></p></td>
<td width="86%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;&minus;quiet</b></p>

<p style="margin-left:17%;">Don&rsquo;t print log
messages.</p>

<p style="margin-left:17%; margin-top: 1em">To enable
detailed logging of individual file operations, use
<i>&minus;x</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;network <br>
&minus;&minus;no&minus;network</b></p>

<p style="margin-left:17%;">Enable or disable network
access from the guest during the installation.</p>

<p style="margin-left:17%; margin-top: 1em">In
virt-sysprep, the network is <i>disabled</i> by default. You
must use <i>&minus;&minus;network</i> to enable it, in order
that options such as <i>&minus;&minus;install</i> or
<i>&minus;&minus;update</i> will work.</p>


<p style="margin-left:17%; margin-top: 1em"><i>virt&minus;builder</i>(1)
has more information about the security advantages of
disabling the network.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;v</b></p></td>
<td width="86%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;verbose</b></p>

<p style="margin-left:17%;">Enable verbose messages for
debugging.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;V</b></p></td>
<td width="86%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;version</b></p>

<p style="margin-left:17%;">Display version number and
exit.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;x</b></p></td>
<td width="3%"></td>
<td width="60%">


<p>Enable tracing of libguestfs <small>API</small>
calls.</p> </td>
<td width="23%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;&minus;chmod</b>
<small>PERMISSIONS:FILE</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Change the permissions of
<tt>&quot;FILE&quot;</tt> to
<tt>&quot;PERMISSIONS&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note</i>:
<tt>&quot;PERMISSIONS&quot;</tt> by default would be
decimal, unless you prefix it with <tt>0</tt> to get octal,
ie. use <tt>0700</tt> not <tt>700</tt>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;commands&minus;from&minus;file</b>
<small>FILENAME</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Read the customize commands
from a file, one (and its arguments) each line.</p>

<p style="margin-left:17%; margin-top: 1em">Each line
contains a single customization command and its arguments,
for example:</p>

<pre style="margin-left:17%; margin-top: 1em"> delete /some/file
 install some&minus;package
 password some&minus;user:password:its&minus;new&minus;password</pre>


<p style="margin-left:17%; margin-top: 1em">Empty lines are
ignored, and lines starting with <tt>&quot;#&quot;</tt> are
comments and are ignored as well. Furthermore, arguments can
be spread across multiple lines, by adding a
<tt>&quot;\&quot;</tt> (continuation character) at the of a
line, for example</p>

<pre style="margin-left:17%; margin-top: 1em"> edit /some/file:\
   s/^OPT=.*/OPT=ok/</pre>


<p style="margin-left:17%; margin-top: 1em">The commands
are handled in the same order as they are in the file, as if
they were specified as <i>&minus;&minus;delete
/some/file</i> on the command line.</p>

<p style="margin-left:11%;"><b>&minus;&minus;copy</b>
<small>SOURCE:DEST</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Copy files or directories
recursively inside the guest.</p>

<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>


<p style="margin-left:11%;"><b>&minus;&minus;copy&minus;in</b>
<small>LOCALPATH:REMOTEDIR</small> (see
&quot;customize&quot; below)</p>

<p style="margin-left:17%;">Copy local files or directories
recursively into the disk image, placing them in the
directory <tt>&quot;REMOTEDIR&quot;</tt> (which must
exist).</p>

<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>

<p style="margin-left:11%;"><b>&minus;&minus;delete</b>
<small>PATH</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Delete a file from the guest.
Or delete a directory (and all its contents,
recursively).</p>

<p style="margin-left:17%; margin-top: 1em">You can use
shell glob characters in the specified path. Be careful to
escape glob characters from the host shell, if that is
required. For example:</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;customize &minus;&minus;delete '/var/log/*.log'.</pre>


<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;upload</i>, <i>&minus;&minus;scrub</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;edit</b>
<small>FILE:EXPR</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Edit <tt>&quot;FILE&quot;</tt>
using the Perl expression <tt>&quot;EXPR&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Be careful to
properly quote the expression to prevent it from being
altered by the shell.</p>

<p style="margin-left:17%; margin-top: 1em">Note that this
option is only available when Perl 5 is installed.</p>

<p style="margin-left:17%; margin-top: 1em">See
&quot;NON-INTERACTIVE <small>EDITING&quot;</small> in
<i>virt&minus;edit</i>(1).</p>

<p style="margin-left:11%;"><b>&minus;&minus;firstboot</b>
<small>SCRIPT</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Install
<tt>&quot;SCRIPT&quot;</tt> inside the guest, so that when
the guest first boots up, the script runs (as root, late in
the boot process).</p>

<p style="margin-left:17%; margin-top: 1em">The script is
automatically chmod +x after installation in the guest.</p>

<p style="margin-left:17%; margin-top: 1em">The alternative
version <i>&minus;&minus;firstboot&minus;command</i> is the
same, but it conveniently wraps the command up in a single
line script for you.</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;firstboot</i> options. They run in
the same order that they appear on the command line.</p>

<p style="margin-left:17%; margin-top: 1em">Please take a
look at &quot; <small>FIRST BOOT SCRIPTS&quot;</small> in
<i>virt&minus;builder</i>(1) for more information and
caveats about the first boot scripts.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;run</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;firstboot&minus;command</b>
&rsquo; <small>CMD+ARGS</small> &rsquo; (see
&quot;customize&quot; below)</p>

<p style="margin-left:17%;">Run command (and arguments)
inside the guest when the guest first boots up (as root,
late in the boot process).</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;firstboot</i> options. They run in
the same order that they appear on the command line.</p>

<p style="margin-left:17%; margin-top: 1em">Please take a
look at &quot; <small>FIRST BOOT SCRIPTS&quot;</small> in
<i>virt&minus;builder</i>(1) for more information and
caveats about the first boot scripts.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;run</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;firstboot&minus;install</b>
<small>PKG,PKG..</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Install the named packages (a
comma-separated list). These are installed when the guest
first boots using the guest&rsquo;s package manager (eg.
apt, yum, etc.) and the guest&rsquo;s network
connection.</p>

<p style="margin-left:17%; margin-top: 1em">For an overview
on the different ways to install packages, see &quot;
<small>INSTALLING PACKAGES&quot;</small> in
<i>virt&minus;builder</i>(1).</p>

<p style="margin-left:11%;"><b>&minus;&minus;hostname</b>
<small>HOSTNAME</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Set the hostname of the guest
to <tt>&quot;HOSTNAME&quot;</tt>. You can use a dotted
hostname.domainname ( <small>FQDN</small> ) if you want.</p>

<p style="margin-left:11%;"><b>&minus;&minus;install</b>
<small>PKG,PKG..</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Install the named packages (a
comma-separated list). These are installed during the image
build using the guest&rsquo;s package manager (eg. apt, yum,
etc.) and the host&rsquo;s network connection.</p>

<p style="margin-left:17%; margin-top: 1em">For an overview
on the different ways to install packages, see &quot;
<small>INSTALLING PACKAGES&quot;</small> in
<i>virt&minus;builder</i>(1).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;update</i>,
<i>&minus;&minus;uninstall</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;keep&minus;user&minus;accounts</b>
<small>USERS</small> (see &quot;user&minus;account&quot;
below)</p>

<p style="margin-left:17%;">The user accounts to be kept in
the guest. The value of this option is a list of user names
separated by comma, where specifying an user means it is
going to be kept. For example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &minus;&minus;keep&minus;user&minus;accounts mary</pre>


<p style="margin-left:17%; margin-top: 1em">would keep the
user account <tt>&quot;mary&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This option can
be specified multiple times.</p>

<p style="margin-left:11%;"><b>&minus;&minus;link</b>
TARGET:LINK[:LINK..] (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Create symbolic link(s) in the
guest, starting at <tt>&quot;LINK&quot;</tt> and pointing at
<tt>&quot;TARGET&quot;</tt>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;mkdir</b>
<small>DIR</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Create a directory in the
guest.</p>

<p style="margin-left:17%; margin-top: 1em">This uses
<tt>&quot;mkdir&nbsp;&minus;p&quot;</tt> so any intermediate
directories are created, and it also works if the directory
already exists.</p>

<p style="margin-left:11%;"><b>&minus;&minus;move</b>
<small>SOURCE:DEST</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Move files or directories
inside the guest.</p>

<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>


<p style="margin-left:11%;"><b>&minus;&minus;no&minus;logfile</b>
(see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Scrub
<tt>&quot;builder.log&quot;</tt> (log file from build
commands) from the image after building is complete. If you
don&rsquo;t want to reveal precisely how the image was
built, use this option.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
&quot; <small>LOG FILE&quot;</small> .</p>

<p style="margin-left:11%;"><b>&minus;&minus;password</b>
<small>USER:SELECTOR</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Set the password for
<tt>&quot;USER&quot;</tt>. (Note this option does <i>not</i>
create the user account).</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>USERS AND PASSWORDS&quot;</small> in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field, and also how to set up
user accounts.</p>


<p style="margin-left:11%;"><b>&minus;&minus;password&minus;crypto</b>
md5|sha256|sha512 (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">When the virt tools change or
set a password in the guest, this option sets the password
encryption of that password to <tt>&quot;md5&quot;</tt>,
<tt>&quot;sha256&quot;</tt> or
<tt>&quot;sha512&quot;</tt>.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;sha256&quot;</tt>
and <tt>&quot;sha512&quot;</tt> require glibc &ge; 2.7
(check <i>crypt</i>(3) inside the guest).</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;md5&quot;</tt>
will work with relatively old Linux guests (eg. <small>RHEL
3</small> ), but is not secure against modern attacks.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
<tt>&quot;sha512&quot;</tt> unless libguestfs detects an old
guest that didn&rsquo;t have support for
<small>SHA&minus;512,</small> in which case it will use
<tt>&quot;md5&quot;</tt>. You can override libguestfs by
specifying this option.</p>

<p style="margin-left:17%; margin-top: 1em">Note this does
not change the default password encryption used by the guest
when you create new user accounts inside the guest. If you
want to do that, then you should use the
<i>&minus;&minus;edit</i> option to modify
<tt>&quot;/etc/sysconfig/authconfig&quot;</tt> (Fedora,
<small>RHEL</small> ) or
<tt>&quot;/etc/pam.d/common&minus;password&quot;</tt>
(Debian, Ubuntu).</p>


<p style="margin-left:11%;"><b>&minus;&minus;remove&minus;user&minus;accounts</b>
<small>USERS</small> (see &quot;user&minus;account&quot;
below)</p>

<p style="margin-left:17%;">The user accounts to be removed
from the guest. The value of this option is a list of user
names separated by comma, where specifying an user means it
is going to be removed. For example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &minus;&minus;remove&minus;user&minus;accounts bob,eve</pre>


<p style="margin-left:17%; margin-top: 1em">would only
remove the user accounts <tt>&quot;bob&quot;</tt> and
<tt>&quot;eve&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This option can
be specified multiple times.</p>


<p style="margin-left:11%;"><b>&minus;&minus;root&minus;password</b>
<small>SELECTOR</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Set the root password.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>USERS AND PASSWORDS&quot;</small> in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field, and also how to set up
user accounts.</p>

<p style="margin-left:17%; margin-top: 1em">Note: In
virt-builder, if you <i>don&rsquo;t</i> set
<i>&minus;&minus;root&minus;password</i> then the guest is
given a <i>random</i> root password.</p>

<p style="margin-left:11%;"><b>&minus;&minus;run</b>
<small>SCRIPT</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Run the shell script (or any
program) called <tt>&quot;SCRIPT&quot;</tt> on the disk
image. The script runs virtualized inside a small appliance,
chrooted into the guest filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">The script is
automatically chmod +x.</p>

<p style="margin-left:17%; margin-top: 1em">If libguestfs
supports it then a limited network connection is available
but it only allows outgoing network connections. You can
also attach data disks (eg. <small>ISO</small> files) as
another way to provide data (eg. software packages) to the
script without needing a network connection
(<i>&minus;&minus;attach</i>). You can also upload data
files (<i>&minus;&minus;upload</i>).</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;run</i> options. They run in the
same order that they appear on the command line.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;firstboot</i>, <i>&minus;&minus;attach</i>,
<i>&minus;&minus;upload</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;run&minus;command</b>
&rsquo; <small>CMD+ARGS</small> &rsquo; (see
&quot;customize&quot; below)</p>

<p style="margin-left:17%;">Run the command and arguments
on the disk image. The command runs virtualized inside a
small appliance, chrooted into the guest filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">If libguestfs
supports it then a limited network connection is available
but it only allows outgoing network connections. You can
also attach data disks (eg. <small>ISO</small> files) as
another way to provide data (eg. software packages) to the
script without needing a network connection
(<i>&minus;&minus;attach</i>). You can also upload data
files (<i>&minus;&minus;upload</i>).</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;run&minus;command</i> options.
They run in the same order that they appear on the command
line.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;firstboot</i>, <i>&minus;&minus;attach</i>,
<i>&minus;&minus;upload</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;script</b>
<small>SCRIPT</small> (see &quot;script&quot; below)</p>

<p style="margin-left:17%;">Run the named
<tt>&quot;SCRIPT&quot;</tt> (a shell script or program)
against the guest. The script can be any program on the
host. The script&rsquo;s current directory will be the
guest&rsquo;s root directory.</p>

<p style="margin-left:17%; margin-top: 1em"><b>Note:</b> If
the script is not on the <tt>$PATH</tt>, then you must give
the full absolute path to the script.</p>

<p style="margin-left:11%;"><b>&minus;&minus;scriptdir</b>
<small>SCRIPTDIR</small> (see &quot;script&quot; below)</p>

<p style="margin-left:17%;">The mount point (an empty
directory on the host) used when the
<tt>&quot;script&quot;</tt> operation is enabled and one or
more scripts are specified using <i>&minus;&minus;script</i>
parameter(s).</p>

<p style="margin-left:17%; margin-top: 1em"><b>Note:</b>
<tt>&quot;SCRIPTDIR&quot;</tt> <b>must</b> be an absolute
path.</p>

<p style="margin-left:17%; margin-top: 1em">If
<i>&minus;&minus;scriptdir</i> is not specified then a
temporary mountpoint will be created.</p>

<p style="margin-left:11%;"><b>&minus;&minus;scrub</b>
<small>FILE</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Scrub a file from the guest.
This is like <i>&minus;&minus;delete</i> except that:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>It scrubs the data so a guest could not recover it.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>It cannot delete directories, only regular files.</p></td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;selinux&minus;relabel</b>
(see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Relabel files in the guest so
that they have the correct SELinux label.</p>

<p style="margin-left:17%; margin-top: 1em">This will
attempt to relabel files immediately, but if the operation
fails this will instead touch <i>/.autorelabel</i> on the
image to schedule a relabel operation for the next time the
image boots.</p>

<p style="margin-left:17%; margin-top: 1em">You should only
use this option for guests which support SELinux.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;attach</b>
<small>SELECTOR</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Attach to a pool using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See
&quot;SUBSCRIPTION-MANAGER&quot; in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;credentials</b>
<small>SELECTOR</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Set the credentials for
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See
&quot;SUBSCRIPTION-MANAGER&quot; in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;register</b>
(see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Register the guest using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This requires
credentials being set using
<i>&minus;&minus;sm&minus;credentials</i>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;remove</b>
(see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Remove all the subscriptions
from the guest using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;sm&minus;unregister</b>
(see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Unregister the guest using
<tt>&quot;subscription&minus;manager&quot;</tt>.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ssh&minus;inject</b>
USER[:SELECTOR] (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Inject an ssh key so the given
<tt>&quot;USER&quot;</tt> will be able to log in over ssh
without supplying a password. The <tt>&quot;USER&quot;</tt>
must exist already in the guest.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>SSH KEYS&quot;</small> in
<i>virt&minus;builder</i>(1) for the format of the
<tt>&quot;SELECTOR&quot;</tt> field.</p>

<p style="margin-left:17%; margin-top: 1em">You can have
multiple <i>&minus;&minus;ssh&minus;inject</i> options, for
different users and also for more keys for each user.</p>

<p style="margin-left:11%;"><b>&minus;&minus;timezone</b>
<small>TIMEZONE</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Set the default timezone of the
guest to <tt>&quot;TIMEZONE&quot;</tt>. Use a location
string like <tt>&quot;Europe/London&quot;</tt></p>

<p style="margin-left:11%;"><b>&minus;&minus;touch</b>
<small>FILE</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">This command performs a
<i>touch</i>(1)&minus;like operation on
<tt>&quot;FILE&quot;</tt>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;truncate</b>
<small>FILE</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">This command truncates
<tt>&quot;FILE&quot;</tt> to a zero-length file. The file
must exist already.</p>


<p style="margin-left:11%;"><b>&minus;&minus;truncate&minus;recursive</b>
<small>PATH</small> (see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">This command recursively
truncates all files under <tt>&quot;PATH&quot;</tt> to
zero-length.</p>

<p style="margin-left:11%;"><b>&minus;&minus;uninstall</b>
<small>PKG,PKG..</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Uninstall the named packages (a
comma-separated list). These are removed during the image
build using the guest&rsquo;s package manager (eg. apt, yum,
etc.). Dependent packages may also need to be uninstalled to
satisfy the request.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;install</i>,
<i>&minus;&minus;update</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;update</b>
(see &quot;customize&quot; below)</p>

<p style="margin-left:17%;">Do the equivalent of
<tt>&quot;yum update&quot;</tt>, <tt>&quot;apt&minus;get
upgrade&quot;</tt>, or whatever command is required to
update the packages already installed in the template to
their latest versions.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>&minus;&minus;install</i>,
<i>&minus;&minus;uninstall</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;upload</b>
<small>FILE:DEST</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Upload local file
<tt>&quot;FILE&quot;</tt> to destination
<tt>&quot;DEST&quot;</tt> in the disk image. File owner and
permissions from the original are preserved, so you should
set them to what you want them to be in the disk image.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;DEST&quot;</tt>
could be the final filename. This can be used to rename the
file on upload.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>&quot;DEST&quot;</tt> is a directory name (which must
already exist in the guest) then the file is uploaded into
that directory, and it keeps the same name as on the local
filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>&minus;&minus;mkdir</i>, <i>&minus;&minus;delete</i>,
<i>&minus;&minus;scrub</i>.</p>

<p style="margin-left:11%;"><b>&minus;&minus;write</b>
<small>FILE:CONTENT</small> (see &quot;customize&quot;
below)</p>

<p style="margin-left:17%;">Write
<tt>&quot;CONTENT&quot;</tt> to
<tt>&quot;FILE&quot;</tt>.</p>

<h2>OPERATIONS
<a name="OPERATIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">If the
<i>&minus;&minus;enable</i>/<i>&minus;&minus;operations</i>
option is <i>not</i> given, then most sysprep operations are
enabled.</p>

<p style="margin-left:11%; margin-top: 1em">Use
<tt>&quot;virt&minus;sysprep
&minus;&minus;list&minus;operations&quot;</tt> to list all
operations for your virt-sysprep binary. The ones which are
enabled by default are marked with a <tt>&quot;*&quot;</tt>
character. Regardless of the
<i>&minus;&minus;enable</i>/<i>&minus;&minus;operations</i>
options, sysprep operations are skipped for some guest
types.</p>

<p style="margin-left:11%; margin-top: 1em">Operations can
be individually enabled using the
<i>&minus;&minus;enable</i>/<i>&minus;&minus;operations</i>
options. Use a comma-separated list, for example:</p>

<pre style="margin-left:11%; margin-top: 1em"> virt&minus;sysprep &minus;&minus;operations ssh&minus;hostkeys,udev&minus;persistent&minus;net [etc..]</pre>


<p style="margin-left:11%; margin-top: 1em">Future versions
of virt-sysprep may add more operations. If you are using
virt-sysprep and want predictable behaviour, specify only
the operations that you want to have enabled.</p>


<p style="margin-left:11%; margin-top: 1em"><tt>&quot;*&quot;</tt>
= enabled by default when no
<i>&minus;&minus;enable</i>/<i>&minus;&minus;operations</i>
option is given.</p>

<p style="margin-left:11%; margin-top: 1em"><b>abrt-data
*</b> <br>
Remove the crash data generated by <small>ABRT.</small></p>

<p style="margin-left:11%; margin-top: 1em">Remove the
automatically generated <small>ABRT</small> crash data in
<tt>&quot;/var/spool/abrt/&quot;</tt>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>bash-history
*</b> <br>
Remove the bash history in the guest.</p>

<p style="margin-left:11%; margin-top: 1em">Remove the bash
history of user &quot;root&quot; and any other users who
have a <tt>&quot;.bash_history&quot;</tt> file in their home
directory.</p>

<p style="margin-left:11%; margin-top: 1em"><i>Notes on
bash-history</i></p>

<p style="margin-left:11%; margin-top: 1em">Currently this
only looks in <tt>&quot;/root&quot;</tt> and
<tt>&quot;/home/*&quot;</tt> for home directories, so users
with home directories in other locations won&rsquo;t have
the bash history removed.</p>

<p style="margin-left:11%; margin-top: 1em"><b>blkid-tab
*</b> <br>
Remove blkid tab in the guest.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ca-certificates</b>
<br>
Remove <small>CA</small> certificates in the guest.</p>

<p style="margin-left:11%; margin-top: 1em"><b>crash-data
*</b> <br>
Remove the crash data generated by kexec-tools.</p>

<p style="margin-left:11%; margin-top: 1em">Remove the
automatically generated kdump kernel crash data.</p>

<p style="margin-left:11%; margin-top: 1em"><b>cron-spool
*</b> <br>
Remove user at-jobs and cron-jobs.</p>

<p style="margin-left:11%; margin-top: 1em"><b>customize
*</b> <br>
Customize the guest.</p>

<p style="margin-left:11%; margin-top: 1em">Customize the
guest by providing <i>virt&minus;customize</i>(1) options
for installing packages, editing files and so on.</p>


<p style="margin-left:11%; margin-top: 1em"><b>dhcp-client-state
*</b> <br>
Remove <small>DHCP</small> client leases.</p>


<p style="margin-left:11%; margin-top: 1em"><b>dhcp-server-state
*</b> <br>
Remove <small>DHCP</small> server leases.</p>


<p style="margin-left:11%; margin-top: 1em"><b>dovecot-data
*</b> <br>
Remove Dovecot (mail server) data.</p>


<p style="margin-left:11%; margin-top: 1em"><b>firewall-rules</b>
<br>
Remove the firewall rules.</p>

<p style="margin-left:11%; margin-top: 1em">This removes
custom firewall rules by removing
<tt>&quot;/etc/sysconfig/iptables&quot;</tt> or custom
firewalld configuration in
<tt>&quot;/etc/firewalld/*/*&quot;</tt>.</p>

<p style="margin-left:11%; margin-top: 1em">Note this is
<i>not</i> enabled by default since it may expose guests to
exploits. Use with care.</p>


<p style="margin-left:11%; margin-top: 1em"><b>flag-reconfiguration</b>
<br>
Flag the system for reconfiguration.</p>

<p style="margin-left:11%; margin-top: 1em">For Linux
guests, this touches <tt>&quot;/.unconfigured&quot;</tt>,
which causes the first boot to interactively query the user
for settings such as the root password and timezone.</p>


<p style="margin-left:11%; margin-top: 1em"><b>fs-uuids</b>
<br>
Change filesystem UUIDs.</p>

<p style="margin-left:11%; margin-top: 1em">On guests and
filesystem types where this is supported, new random UUIDs
are generated and assigned to filesystems.</p>

<p style="margin-left:11%; margin-top: 1em"><i>Notes on
fs-uuids</i></p>

<p style="margin-left:11%; margin-top: 1em">The fs-uuids
operation is disabled by default because it does not yet
find and update all the places in the guest that use the
UUIDs. For example <tt>&quot;/etc/fstab&quot;</tt> or the
bootloader. Enabling this operation is more likely than not
to make your guest unbootable.</p>

<p style="margin-left:11%; margin-top: 1em">See:
https://bugzilla.redhat.com/show_bug.cgi?id=991641</p>


<p style="margin-left:11%; margin-top: 1em"><b>kerberos-data</b>
<br>
Remove Kerberos data in the guest.</p>

<p style="margin-left:11%; margin-top: 1em"><b>logfiles
*</b> <br>
Remove many log files from the guest.</p>

<p style="margin-left:11%; margin-top: 1em">On Linux the
following files are removed:</p>

<pre style="margin-left:11%; margin-top: 1em"> /etc/Pegasus/*.cnf
 /etc/Pegasus/*.crt
 /etc/Pegasus/*.csr
 /etc/Pegasus/*.pem
 /etc/Pegasus/*.srl
 /root/anaconda&minus;ks.cfg
 /root/anaconda&minus;post.log
 /root/initial&minus;setup&minus;ks.cfg
 /root/install.log
 /root/install.log.syslog
 /var/cache/fontconfig/*
 /var/cache/gdm/*
 /var/cache/man/*
 /var/lib/AccountService/users/*
 /var/lib/fprint/*
 /var/lib/logrotate.status
 /var/log/*.log*
 /var/log/BackupPC/LOG
 /var/log/ConsoleKit/*
 /var/log/anaconda.syslog
 /var/log/anaconda/*
 /var/log/apache2/*_log
 /var/log/apache2/*_log&minus;*
 /var/log/apt/*
 /var/log/aptitude*
 /var/log/audit/*
 /var/log/btmp*
 /var/log/ceph/*.log
 /var/log/chrony/*.log
 /var/log/cron*
 /var/log/cups/*_log*
 /var/log/debug*
 /var/log/dmesg*
 /var/log/exim4/*
 /var/log/faillog*
 /var/log/firewalld*
 /var/log/gdm/*
 /var/log/glusterfs/*glusterd.vol.log
 /var/log/glusterfs/glusterfs.log
 /var/log/grubby*
 /var/log/httpd/*log
 /var/log/installer/*
 /var/log/jetty/jetty&minus;console.log
 /var/log/journal/*
 /var/log/lastlog*
 /var/log/libvirt/libvirtd.log
 /var/log/libvirt/libxl/*.log
 /var/log/libvirt/lxc/*.log
 /var/log/libvirt/qemu/*.log
 /var/log/libvirt/uml/*.log
 /var/log/lightdm/*
 /var/log/mail/*
 /var/log/maillog*
 /var/log/messages*
 /var/log/ntp
 /var/log/ntpstats/*
 /var/log/ppp/connect&minus;errors
 /var/log/rhsm/*
 /var/log/sa/*
 /var/log/secure*
 /var/log/setroubleshoot/*.log
 /var/log/spooler*
 /var/log/squid/*.log
 /var/log/syslog*
 /var/log/tallylog*
 /var/log/tuned/tuned.log
 /var/log/wtmp*
 /var/log/xferlog*
 /var/named/data/named.run</pre>


<p style="margin-left:11%; margin-top: 1em"><b>lvm-uuids
*</b> <br>
Change <small>LVM2 PV</small> and <small>VG</small>
UUIDs.</p>

<p style="margin-left:11%; margin-top: 1em">On Linux guests
that have <small>LVM2</small> physical volumes (PVs) or
volume groups (VGs), new random UUIDs are generated and
assigned to those PVs and VGs.</p>

<p style="margin-left:11%; margin-top: 1em"><b>machine-id
*</b> <br>
Remove the local machine <small>ID.</small></p>

<p style="margin-left:11%; margin-top: 1em">The machine
<small>ID</small> is usually generated from a random source
during system installation and stays constant for all
subsequent boots. Optionally, for stateless systems it is
generated during runtime at boot if it is found to be
empty.</p>

<p style="margin-left:11%; margin-top: 1em"><b>mail-spool
*</b> <br>
Remove email from the local mail spool directory.</p>


<p style="margin-left:11%; margin-top: 1em"><b>net-hostname
*</b> <br>
Remove <small>HOSTNAME</small> in network interface
configuration.</p>

<p style="margin-left:11%; margin-top: 1em">For Fedora and
Red Hat Enterprise Linux, this is removed from
<tt>&quot;ifcfg&minus;*&quot;</tt> files.</p>

<p style="margin-left:11%; margin-top: 1em"><b>net-hwaddr
*</b> <br>
Remove <small>HWADDR</small> (hard-coded <small>MAC</small>
address) configuration.</p>

<p style="margin-left:11%; margin-top: 1em">For Fedora and
Red Hat Enterprise Linux, this is removed from
<tt>&quot;ifcfg&minus;*&quot;</tt> files.</p>

<p style="margin-left:11%; margin-top: 1em"><b>pacct-log
*</b> <br>
Remove the process accounting log files.</p>

<p style="margin-left:11%; margin-top: 1em">The system wide
process accounting will store to the pacct log files if the
process accounting is on.</p>


<p style="margin-left:11%; margin-top: 1em"><b>package-manager-cache
*</b> <br>
Remove package manager cache.</p>

<p style="margin-left:11%; margin-top: 1em"><b>pam-data
*</b> <br>
Remove the <small>PAM</small> data in the guest.</p>


<p style="margin-left:11%; margin-top: 1em"><b>puppet-data-log
*</b> <br>
Remove the data and log files of puppet.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rh-subscription-manager
*</b> <br>
Remove the <small>RH</small> subscription manager files.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rhn-systemid
*</b> <br>
Remove the <small>RHN</small> system <small>ID.</small></p>

<p style="margin-left:11%; margin-top: 1em"><b>rpm-db *</b>
<br>
Remove host-specific <small>RPM</small> database files.</p>

<p style="margin-left:11%; margin-top: 1em">Remove
host-specific <small>RPM</small> database files and locks.
<small>RPM</small> will recreate these files automatically
if needed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>samba-db-log
*</b> <br>
Remove the database and log files of Samba.</p>

<p style="margin-left:11%; margin-top: 1em"><b>script *</b>
<br>
Run arbitrary scripts against the guest.</p>

<p style="margin-left:11%; margin-top: 1em">The
<tt>&quot;script&quot;</tt> module lets you run arbitrary
shell scripts or programs against the guest.</p>

<p style="margin-left:11%; margin-top: 1em">Note this
feature requires <small>FUSE</small> support. You may have
to enable this in your host, for example by adding the
current user to the <tt>&quot;fuse&quot;</tt> group, or by
loading a kernel module.</p>

<p style="margin-left:11%; margin-top: 1em">Use one or more
<i>&minus;&minus;script</i> parameters to specify scripts or
programs that will be run against the guest.</p>

<p style="margin-left:11%; margin-top: 1em">The script or
program is run with its current directory being the
guest&rsquo;s root directory, so relative paths should be
used. For example: <tt>&quot;rm etc/resolv.conf&quot;</tt>
in the script would remove a Linux guest&rsquo;s
<small>DNS</small> configuration file, but <tt>&quot;rm
/etc/resolv.conf&quot;</tt> would (try to) remove the
host&rsquo;s file.</p>

<p style="margin-left:11%; margin-top: 1em">Normally a
temporary mount point for the guest is used, but you can
choose a specific one by using the
<i>&minus;&minus;scriptdir</i> parameter.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Note:</b>
This is different from <i>&minus;&minus;firstboot</i>
scripts (which run in the context of the guest when it is
booting first time). <i>&minus;&minus;script</i> scripts run
on the host, not in the guest.</p>

<p style="margin-left:11%; margin-top: 1em"><b>smolt-uuid
*</b> <br>
Remove the Smolt hardware <small>UUID.</small></p>


<p style="margin-left:11%; margin-top: 1em"><b>ssh-hostkeys
*</b> <br>
Remove the <small>SSH</small> host keys in the guest.</p>

<p style="margin-left:11%; margin-top: 1em">The
<small>SSH</small> host keys are regenerated (differently)
next time the guest is booted.</p>

<p style="margin-left:11%; margin-top: 1em">If, after
cloning, the guest gets the same <small>IP</small> address,
ssh will give you a stark warning about the host key
changing:</p>

<pre style="margin-left:11%; margin-top: 1em"> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</pre>


<p style="margin-left:11%; margin-top: 1em"><b>ssh-userdir
*</b> <br>
Remove &quot;.ssh&quot; directories in the guest.</p>

<p style="margin-left:11%; margin-top: 1em">Remove the
<tt>&quot;.ssh&quot;</tt> directory of user &quot;root&quot;
and any other users who have a <tt>&quot;.ssh&quot;</tt>
directory in their home directory.</p>

<p style="margin-left:11%; margin-top: 1em"><i>Notes on
ssh-userdir</i></p>

<p style="margin-left:11%; margin-top: 1em">Currently this
only looks in <tt>&quot;/root&quot;</tt> and
<tt>&quot;/home/*&quot;</tt> for home directories, so users
with home directories in other locations won&rsquo;t have
the ssh files removed.</p>

<p style="margin-left:11%; margin-top: 1em"><b>sssd-db-log
*</b> <br>
Remove the database and log files of sssd.</p>

<p style="margin-left:11%; margin-top: 1em"><b>tmp-files
*</b> <br>
Remove temporary files.</p>

<p style="margin-left:11%; margin-top: 1em">This removes
temporary files under <tt>&quot;/tmp&quot;</tt> and
<tt>&quot;/var/tmp&quot;</tt>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>udev-persistent-net
*</b> <br>
Remove udev persistent net rules.</p>

<p style="margin-left:11%; margin-top: 1em">Remove udev
persistent net rules which map the guest&rsquo;s existing
<small>MAC</small> address to a fixed ethernet device (eg.
eth0).</p>

<p style="margin-left:11%; margin-top: 1em">After a guest
is cloned, the <small>MAC</small> address usually changes.
Since the old <small>MAC</small> address occupies the old
name (eg. eth0), this means the fresh <small>MAC</small>
address is assigned to a new name (eg. eth1) and this is
usually undesirable. Erasing the udev persistent net rules
avoids this.</p>


<p style="margin-left:11%; margin-top: 1em"><b>user-account</b>
<br>
Remove the user accounts in the guest.</p>

<p style="margin-left:11%; margin-top: 1em">By default
remove all the user accounts and their home directories. The
&quot;root&quot; account is not removed.</p>

<p style="margin-left:11%; margin-top: 1em">See the
<i>&minus;&minus;remove&minus;user&minus;accounts</i>
parameter for a way to specify how to remove only some
users, or to not remove some others.</p>

<p style="margin-left:11%; margin-top: 1em"><b>utmp *</b>
<br>
Remove the utmp file.</p>

<p style="margin-left:11%; margin-top: 1em">This file
records who is currently logged in on a machine. In modern
Linux distros it is stored in a ramdisk and hence not part
of the virtual machine&rsquo;s disk, but it was stored on
disk in older distros.</p>

<p style="margin-left:11%; margin-top: 1em"><b>yum-uuid
*</b> <br>
Remove the yum <small>UUID.</small></p>

<p style="margin-left:11%; margin-top: 1em">Yum creates a
fresh <small>UUID</small> the next time it runs when it
notices that the original <small>UUID</small> has been
erased.</p>

<h2>COPYING AND CLONING
<a name="COPYING AND CLONING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Virt-sysprep
can be used as part of a process of cloning guests, or to
prepare a template from which guests can be cloned. There
are many different ways to achieve this using the virt
tools, and this section is just an introduction.</p>

<p style="margin-left:11%; margin-top: 1em">A virtual
machine (when switched off) consists of two parts: <i><br>
configuration</i></p>

<p style="margin-left:17%;">The configuration or
description of the guest. eg. The libvirt <small>XML</small>
(see <tt>&quot;virsh dumpxml&quot;</tt>), the running
configuration of the guest, or another external format like
<small>OVF.</small></p>

<p style="margin-left:17%; margin-top: 1em">Some
configuration items that might need to be changed:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="37%">


<p>name</p></td>
<td width="40%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="37%">


<p><small>UUID</small></p></td>
<td width="40%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="37%">


<p>path to block device(s)</p></td>
<td width="40%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="37%">


<p>network card <small>MAC</small> address</p></td>
<td width="40%">
</td></tr>
</table>

<p style="margin-left:11%;"><i>block device(s)</i></p>

<p style="margin-left:17%;">One or more hard disk images,
themselves containing files, directories, applications,
kernels, configuration, etc.</p>

<p style="margin-left:17%; margin-top: 1em">Some things
inside the block devices that might need to be changed:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="55%">


<p>hostname and other net configuration</p></td>
<td width="22%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="55%">


<p><small>UUID</small></p></td>
<td width="22%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="55%">


<p><small>SSH</small> host keys</p></td>
<td width="22%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="55%">


<p>Windows unique security <small>ID</small> (
<small>SID</small> )</p></td>
<td width="22%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="55%">


<p>Puppet registration</p></td>
<td width="22%">
</td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b><small>COPYING
THE BLOCK DEVICE</small></b> <br>
Starting with an original guest, you probably wish to copy
the guest block device and its configuration to make a
template. Then once you are happy with the template, you
will want to make many clones from it.</p>

<pre style="margin-left:11%; margin-top: 1em">                        virt&minus;sysprep
                             |
                             v
 original guest &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt; template &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt;
                                      \&minus;&minus;&minus;&minus;&minus;&minus;&gt; cloned
                                       \&minus;&minus;&minus;&minus;&minus;&gt; guests
                                        \&minus;&minus;&minus;&minus;&gt;</pre>


<p style="margin-left:11%; margin-top: 1em">You can, of
course, just copy the block device on the host using
<i>cp</i>(1) or <i>dd</i>(1).</p>

<pre style="margin-left:11%; margin-top: 1em">                   dd                 dd
 original guest &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt; template &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt;
                                      \&minus;&minus;&minus;&minus;&minus;&minus;&gt; cloned
                                       \&minus;&minus;&minus;&minus;&minus;&gt; guests
                                        \&minus;&minus;&minus;&minus;&gt;</pre>


<p style="margin-left:11%; margin-top: 1em">There are some
smarter (and faster) ways too:</p>

<pre style="margin-left:11%; margin-top: 1em">                          snapshot
                template &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt;
                            \&minus;&minus;&minus;&minus;&minus;&minus;&gt; cloned
                             \&minus;&minus;&minus;&minus;&minus;&gt; guests
                              \&minus;&minus;&minus;&minus;&gt;</pre>


<p style="margin-left:11%; margin-top: 1em">You may want to
run virt-sysprep twice, once to reset the guest (to make a
template) and a second time to customize the guest for a
specific user:</p>

<pre style="margin-left:11%; margin-top: 1em">                    virt&minus;sysprep        virt&minus;sysprep
                      (reset)      (add user, keys, logos)
                         |                   |
                 dd      v          dd       v
 original guest &minus;&minus;&minus;&minus;&gt; template &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt; copied &minus;&minus;&minus;&minus;&minus;&minus;&gt; custom
                                          template       guest</pre>



<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="51%">


<p style="margin-top: 1em">Create a snapshot using
qemu-img:</p> </td>
<td width="32%">
</td></tr>
</table>

<pre style="margin-left:17%; margin-top: 1em"> qemu&minus;img create &minus;f qcow2 &minus;o backing_file=original snapshot.qcow</pre>


<p style="margin-left:17%; margin-top: 1em">The advantage
is that you don&rsquo;t need to copy the original (very
fast) and only changes are stored (less storage
required).</p>

<p style="margin-left:17%; margin-top: 1em">Note that
writing to the backing file once you have created guests on
top of it is not possible: you will corrupt the guests.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p style="margin-top: 1em">Create a snapshot using
<tt>&quot;lvcreate &minus;&minus;snapshot&quot;</tt>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Other ways to create snapshots include using
filesystems-level tools (for filesystems such as btrfs).</p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">Most Network
Attached Storage ( <small>NAS</small> ) devices can also
create cheap snapshots from files or LUNs.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p style="margin-top: 1em">Get your <small>NAS</small> to
duplicate the <small>LUN.</small> Most <small>NAS</small>
devices can also duplicate LUNs very cheaply (they copy them
on-demand in the background).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Prepare your template using
<i>virt&minus;sparsify</i>(1). See below.</p></td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>VIRT-CLONE</b>
<br>
A separate tool, <i>virt&minus;clone</i>(1), can be used to
duplicate the block device and/or modify the external
libvirt configuration of a guest. It will reset the name,
<small>UUID</small> and <small>MAC</small> address of the
guest in the libvirt <small>XML.</small></p>


<p style="margin-left:11%; margin-top: 1em"><i>virt&minus;clone</i>(1)
does not use libguestfs and cannot look inside the disk
image. This was the original motivation to write
virt-sysprep.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>SPARSIFY</small></b></p>


<pre style="margin-left:11%;">              virt&minus;sparsify
 original guest &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt; template</pre>



<p style="margin-left:11%; margin-top: 1em"><i>virt&minus;sparsify</i>(1)
can be used to make the cloning template smaller, making it
easier to compress and/or faster to copy.</p>

<p style="margin-left:11%; margin-top: 1em">Notice that
since virt-sparsify also copies the image, you can use it to
make the initial copy (instead of
<tt>&quot;dd&quot;</tt>).</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>RESIZE</small></b></p>


<pre style="margin-left:11%;">                         virt&minus;resize
                template &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&gt;
                            \&minus;&minus;&minus;&minus;&minus;&minus;&gt; cloned
                             \&minus;&minus;&minus;&minus;&minus;&gt; guests
                              \&minus;&minus;&minus;&minus;&gt;</pre>


<p style="margin-left:11%; margin-top: 1em">If you want to
give people cloned guests, but let them pick the size of the
guest themselves (eg. depending on how much they are
prepared to pay for disk space), then instead of copying the
template, you can run <i>virt&minus;resize</i>(1).
Virt-resize performs a copy and resize, and thus is ideal
for cloning guests from a template.</p>

<h2>FIRSTBOOT VS SCRIPT
<a name="FIRSTBOOT VS SCRIPT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The two options
<i>&minus;&minus;firstboot</i> and
<i>&minus;&minus;script</i> both supply shell scripts that
are run against the guest. However these two options are
significantly different.</p>


<p style="margin-left:11%; margin-top: 1em"><i>&minus;&minus;firstboot
script</i> uploads the file <tt>&quot;script&quot;</tt> into
the guest and arranges that it will run, in the guest, when
the guest is next booted. (The script will only run once, at
the &quot;first boot&quot;).</p>


<p style="margin-left:11%; margin-top: 1em"><i>&minus;&minus;script
script</i> runs the shell <tt>&quot;script&quot;</tt> <i>on
the host</i>, with its current directory inside the guest
filesystem.</p>

<p style="margin-left:11%; margin-top: 1em">If you needed,
for example, to <tt>&quot;yum install&quot;</tt> new
packages, then you <i>must not</i> use
<i>&minus;&minus;script</i> for this, since that would (a)
run the <tt>&quot;yum&quot;</tt> command on the host and (b)
wouldn&rsquo;t have access to the same resources
(repositories, keys, etc.) as the guest. Any command that
needs to run on the guest <i>must</i> be run via
<i>&minus;&minus;firstboot</i>.</p>

<p style="margin-left:11%; margin-top: 1em">On the other
hand if you need to make adjustments to the guest filesystem
(eg. copying in files), then <i>&minus;&minus;script</i> is
ideal since (a) it has access to the host filesystem and (b)
you will get immediate feedback on errors.</p>

<p style="margin-left:11%; margin-top: 1em">Either or both
options can be used multiple times on the command line.</p>

<h2>SECURITY
<a name="SECURITY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Although
virt-sysprep removes some sensitive information from the
guest, it does not pretend to remove all of it. You should
examine the &quot; <small>OPERATIONS&quot;</small> above and
the guest afterwards.</p>

<p style="margin-left:11%; margin-top: 1em">Sensitive files
are simply removed. The data they contained may still exist
on the disk, easily recovered with a hex editor or undelete
tool. The <i>&minus;&minus;scrub</i> option can be used to
scrub files instead of just deleting them.
<i>virt&minus;sparsify</i>(1) is another way to remove this
content. See also the <i>scrub</i>(1) command to get rid of
deleted content in directory entries and inodes.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>RANDOM
SEED</small></b> <i><br>
(This section applies to Linux guests only)</i></p>

<p style="margin-left:11%; margin-top: 1em">For supported
guests, virt-sysprep writes a few bytes of randomness from
the host into the guest&rsquo;s random seed file.</p>

<p style="margin-left:11%; margin-top: 1em">If this is just
done once and the guest is cloned from the same template,
then each guest will start with the same entropy, and things
like <small>SSH</small> host keys and <small>TCP</small>
sequence numbers may be predictable.</p>

<p style="margin-left:11%; margin-top: 1em">Therefore you
should arrange to add more randomness <i>after</i> cloning
from a template too, which can be done by enabling just the
customize module:</p>

<pre style="margin-left:11%; margin-top: 1em"> cp template.img newguest.img
 virt&minus;sysprep &minus;&minus;enable customize &minus;a newguest.img</pre>


<h2>SELINUX
<a name="SELINUX"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For guests
which make use of SELinux, special handling for them might
be needed when using operations which create new files or
alter existing ones.</p>

<p style="margin-left:11%; margin-top: 1em">For further
details, see &quot; <small>SELINUX&quot;</small> in
<i>virt&minus;builder</i>(1).</p>

<h2>WINDOWS 8
<a name="WINDOWS 8"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Windows 8
&quot;fast startup&quot; can prevent virt-sysprep from
working. See &quot; <small>WINDOWS HIBERNATION AND WINDOWS 8
FAST STARTUP&quot;</small> in <i>guestfs</i>(3).</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This program
returns 0 on success, or 1 if there was an error.</p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">&quot;VIRT_TOOLS_DATA_DIR&quot;</p>

<p style="margin-left:17%;">This can point to the directory
containing data files used for Windows firstboot
installation.</p>

<p style="margin-left:17%; margin-top: 1em">Normally you do
not need to set this. If not set, a compiled-in default will
be used (something like
<i>/usr/share/virt&minus;tools</i>).</p>

<p style="margin-left:17%; margin-top: 1em">This directory
may contain the following files: <i><br>
rhsrvany.exe</i></p>

<p style="margin-left:23%;">This is the RHSrvAny Windows
binary, used to install a &quot;firstboot&quot; script in
Windows guests. It is required if you intend to use the
<i>&minus;&minus;firstboot</i> or
<i>&minus;&minus;firstboot&minus;command</i> options with
Windows guests.</p>

<p style="margin-left:23%; margin-top: 1em">See also:
<tt>&quot;https://github.com/rwmjones/rhsrvany&quot;</tt></p>

<p style="margin-left:11%; margin-top: 1em">For other
environment variables, see &quot; <small>ENVIRONMENT
VARIABLES&quot;</small> in <i>guestfs</i>(3).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>guestfs</i>(3),
<i>guestfish</i>(1), <i>virt&minus;builder</i>(1),
<i>virt&minus;clone</i>(1), <i>virt&minus;customize</i>(1),
<i>virt&minus;rescue</i>(1), <i>virt&minus;resize</i>(1),
<i>virt&minus;sparsify</i>(1), <i>virsh</i>(1),
<i>lvcreate</i>(8), <i>qemu&minus;img</i>(1),
<i>scrub</i>(1), http://libguestfs.org/,
http://libvirt.org/.</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Richard W.M.
Jones http://people.redhat.com/~rjones/</p>

<p style="margin-left:11%; margin-top: 1em">Wanlong Gao,
Fujitsu Ltd.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2011&minus;2016 Red Hat Inc.</p>

<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2012 Fujitsu Ltd.</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This program is
free software; you can redistribute it and/or modify it
under the terms of the <small>GNU</small> General Public
License as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later
version.</p>

<p style="margin-left:11%; margin-top: 1em">This program is
distributed in the hope that it will be useful, but
<small>WITHOUT ANY WARRANTY</small> ; without even the
implied warranty of <small>MERCHANTABILITY</small> or
<small>FITNESS FOR A PARTICULAR PURPOSE.</small> See the
<small>GNU</small> General Public License for more
details.</p>

<p style="margin-left:11%; margin-top: 1em">You should have
received a copy of the <small>GNU</small> General Public
License along with this program; if not, write to the Free
Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
Boston, <small>MA 02110&minus;1301 USA.</small></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To get a list
of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p style="margin-left:11%; margin-top: 1em">To report a new
bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools</p>

<p style="margin-left:11%; margin-top: 1em">When reporting
a bug, please supply:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>The version of libguestfs.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Where you got libguestfs (eg. which Linux distro,
compiled from source, etc)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Describe the bug accurately and give a way to reproduce
it.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>Run <i>libguestfs&minus;test&minus;tool</i>(1) and paste
the <b>complete, unedited</b> output into the bug
report.</p> </td></tr>
 </table>
<hr>
</body>
</html>
