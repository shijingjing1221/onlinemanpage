<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:24:41 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>FIREWALLD.RICHLANG</title>

</head>
<body>

<h1 align="center">FIREWALLD.RICHLANG</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">firewalld.richlanguage
&minus; Rich Language Documentation</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">With the rich
language more complex firewall rules can be created in an
easy to understand way. The language uses keywords with
values and is an abstract representation of ip*tables
rules.</p>

<p style="margin-left:11%; margin-top: 1em">The rich
language extends the current zone elements (service, port,
icmp&minus;block, masquerade, forward&minus;port and
source&minus;port) with additional source and destination
addresses, logging, actions and limits for logs and
actions.</p>

<p style="margin-left:11%; margin-top: 1em">This page
describes the rich language used in the command line client
and D&minus;Bus interface. For information about the rich
language representation used in the zone configuration
files, please have a look at <b>firewalld.zone</b>(5).</p>

<p style="margin-left:11%; margin-top: 1em">A rule is part
of a zone. One zone can contain several rules. If some rules
interact/contradict, the first rule that matches
&quot;wins&quot;.</p>

<p style="margin-left:11%; margin-top: 1em"><b>General rule
structure</b></p>

<p style="margin-left:17%; margin-top: 1em">rule <br>
[source] <br>
[destination] <br>

service|port|protocol|icmp&minus;block|masquerade|forward&minus;port|source&minus;port
<br>
[log] <br>
[audit] <br>
[accept|reject|drop|mark]</p>

<p style="margin-left:11%; margin-top: 1em">The complete
rule is provided as a single line string. A destination is
allowed here as long as it does not conflict with the
destination of a service.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Rule
structure for source black or white listing</b></p>

<p style="margin-left:17%; margin-top: 1em">rule <br>
source <br>
[log] <br>
[audit] <br>
accept|reject|drop|mark</p>

<p style="margin-left:11%; margin-top: 1em">This is used to
grant or limit access from a source to this machine or
machines that are reachable by this machine. A destination
is not allowed here.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Important
information about element options:</b> Options for elements
in a rule need to be added exactly after the element. If the
option is placed somewhere else it might be used for another
element as far as it matches the options of the other
element or will result in a rule error.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Rule</b></p>

<p style="margin-left:17%;">rule
[family=&quot;ipv4|ipv6&quot;]</p>

<p style="margin-left:11%; margin-top: 1em">If the rule
family is provided, it can be either &quot;ipv4&quot; or
&quot;ipv6&quot;, which limits the rule to IPv4 or IPv6. If
the rule family is not provided, the rule will be added for
IPv4 and IPv6. If source or destination addresses are used
in a rule, then the rule family need to be provided. This is
also the case for port/packet forwarding.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Source</b></p>

<p style="margin-left:17%;">source [not]
address=&quot;address[/mask]&quot;|mac=&quot;mac&minus;address&quot;|ipset=&quot;ipset&quot;</p>

<p style="margin-left:11%; margin-top: 1em">With the source
address the origin of a connection attempt can be limited to
the source address. An address is either a single IP
address, or a network IP address, a MAC address or an IPSet.
The address has to match the rule family (IPv4/IPv6). Subnet
mask is expressed in either dot&minus;decimal (/x.x.x.x) or
prefix (/x) notations for IPv4, and in prefix notation (/x)
for IPv6 network addresses. It is possible to invert the
sense of an address by adding <b>not</b> before
<b>address</b>. All but the specified address will match
then.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Destination</b></p>

<p style="margin-left:17%;">destination [not]
address=&quot;address[/mask]&quot;</p>

<p style="margin-left:11%; margin-top: 1em">With the
destination address the target can be limited to the
destination address. The destination address is using the
same syntax as the source address.</p>

<p style="margin-left:11%; margin-top: 1em">The use of
source and destination addresses is optional and the use of
a destination addresses is not possible with all elements.
This depends on the use of destination addresses for example
in service entries.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Service</b></p>

<p style="margin-left:17%;">service name=&quot;service
name&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The service
<i>service name</i> will be added to the rule. The service
name is one of the firewalld provided services. To get a
list of the supported services, use <b>firewall&minus;cmd
&minus;&minus;get&minus;services</b>.</p>

<p style="margin-left:11%; margin-top: 1em">If a service
provides a destination address, it will conflict with a
destination address in the rule and will result in an error.
The services using destination addresses internally are
mostly services using multicast.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Port</b></p>

<p style="margin-left:17%;">port port=&quot;port
value&quot; protocol=&quot;tcp|udp&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The port
<i>port value</i> can either be a single port number
<i>portid</i> or a port range
<i>portid</i>&minus;<i>portid</i>. The protocol can either
be <i>tcp</i> or <i>udp</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Protocol</b></p>

<p style="margin-left:17%;">protocol value=&quot;protocol
value&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The protocol
value can be either a protocol id number or a protocol name.
For allowed protocol entries, please have a look at
<i>/etc/protocols</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>ICMP&minus;Block</b></p>

<p style="margin-left:17%;">icmp&minus;block
name=&quot;icmptype name&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The icmptype is
the one of the icmp types firewalld supports. To get a
listing of supported icmp types: <b>firewall&minus;cmd
&minus;&minus;get&minus;icmptypes</b></p>

<p style="margin-left:11%; margin-top: 1em">It is not
allowed to specify an action here. icmp&minus;block uses the
action reject internally.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Masquerade</b></p>

<p style="margin-left:17%;">masquerade</p>

<p style="margin-left:11%; margin-top: 1em">Turn on
masquerading in the rule. A source and also a destination
address can be provided to limit masquerading to this
area.</p>

<p style="margin-left:11%; margin-top: 1em">It is not
allowed to specify an action here.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Forward&minus;Port</b></p>

<p style="margin-left:17%;">forward&minus;port
port=&quot;port value&quot; protocol=&quot;tcp|udp&quot;
to&minus;port=&quot;port value&quot;
to&minus;addr=&quot;address&quot;</p>

<p style="margin-left:11%; margin-top: 1em">Forward
port/packets from local port value with protocol
&quot;tcp&quot; or &quot;udp&quot; to either another port
locally or to another machine or to another port on another
machine.</p>

<p style="margin-left:11%; margin-top: 1em">The port value
can either be a single port number or a port range
<i>portid&minus;portid</i>. The <b>to&minus;addr</b> is an
IP address.</p>

<p style="margin-left:11%; margin-top: 1em">It is not
allowed to specify an action here. forward&minus;port uses
the action accept internally.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Source&minus;Port</b></p>

<p style="margin-left:17%;">source&minus;port
port=&quot;port value&quot; protocol=&quot;tcp|udp&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The
source&minus;port <i>port value</i> can either be a single
port number <i>portid</i> or a port range
<i>portid</i>&minus;<i>portid</i>. The protocol can either
be <i>tcp</i> or <i>udp</i>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Log</b></p>

<p style="margin-left:17%;">log [prefix=&quot;prefix
text&quot;] [level=&quot;log level&quot;] [limit
value=&quot;rate/duration&quot;]</p>

<p style="margin-left:11%; margin-top: 1em">Log new
connection attempts to the rule with kernel logging for
example in syslog. You can define a prefix text that will be
added to the log message as a prefix. Log level can be one
of &quot;<b>emerg</b>&quot;, &quot;<b>alert</b>&quot;,
&quot;<b>crit</b>&quot;, &quot;<b>error</b>&quot;,
&quot;<b>warning</b>&quot;, &quot;<b>notice</b>&quot;,
&quot;<b>info</b>&quot; or &quot;<b>debug</b>&quot;, where
default (i.e. if there's no one specified) is
&quot;<b>warning</b>&quot;. See <b>syslog</b>(3) for
description of levels. See Limit section for description of
<b>limit</b> tag.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Audit</b></p>

<p style="margin-left:17%;">audit [limit
value=&quot;rate/duration&quot;]</p>

<p style="margin-left:11%; margin-top: 1em">Audit provides
an alternative way for logging using audit records sent to
the service auditd. Audit type will be discovered from the
rule action automatically. Use of audit is optional. See
Limit section for description of <b>limit</b> tag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Action</b>
<br>
An action can be one of <b>accept</b>, <b>reject</b>,
<b>drop</b> or <b>mark</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The rule can
either contain an element or also a source only. If the rule
contains an element, then new connection matching the
element will be handled with the action. If the rule does
not contain an element, then everything from the source
address will be handled with the action.</p>

<p style="margin-left:17%; margin-top: 1em">accept [limit
value=&quot;rate/duration&quot;]</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="85%">


<p style="margin-top: 1em">reject [type=&quot;reject
type&quot;] [limit value=&quot;rate/duration&quot;]</p></td></tr>
</table>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p style="margin-top: 1em">drop [limit
value=&quot;rate/duration&quot;]</p> </td></tr>
</table>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p style="margin-top: 1em">mark set=&quot;mark[/mask]&quot;
[limit value=&quot;rate/duration&quot;]</p>

<p style="margin-left:11%; margin-top: 1em">With
<b>accept</b> all new connection attempts will be granted.
With <b>reject</b> they will not be accepted and their
source will get a reject ICMP(v6) message. The reject type
can be set to specify appropriate ICMP(v6) error message.
For valid reject types see
<b>&minus;&minus;reject&minus;with type</b> in
<b>iptables-extensions</b>(8) man page. Because reject types
are different for IPv4 and IPv6 you have to specify rule
family when using reject type. With <b>drop</b> all packets
will be dropped immediately, there is no information sent to
the source. With <b>mark</b> all packets will be marked in
the <b>PREROUTING</b> chain in the <b>mange</b> table with
the mark and mask combination. See Limit section for
description of <b>limit</b> tag.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Limit</b></p>

<p style="margin-left:17%;">limit
value=&quot;rate/duration&quot;</p>

<p style="margin-left:11%; margin-top: 1em">It is possible
to limit Log, Audit and Action. A rule using this tag will
match until this limit is reached. The rate is a natural
positive number [1, ..] The duration is of &quot;s&quot;,
&quot;m&quot;, &quot;h&quot;, &quot;d&quot;. &quot;s&quot;
means seconds, &quot;m&quot; minutes, &quot;h&quot; hours
and &quot;d&quot; days. Maximum limit value is
&quot;2/d&quot;, which means at maximum two matches per
day.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Information
about logging and actions</b> <br>
Logging can be done with the log and also with audit. A new
chain is added to all zones: zone_log. This will be jumped
into before the deny chain to be able to have a proper
ordering.</p>

<p style="margin-left:11%; margin-top: 1em">The rules or
parts of them are placed in separate chains according to the
action of the rule:</p>


<p style="margin-left:17%; margin-top: 1em"><i>zone</i>_log
<i><br>
zone</i>_deny <i><br>
zone</i>_allow</p>

<p style="margin-left:11%; margin-top: 1em">Then all
logging rules will be placed in the zone_log chain, which
will be walked first. All reject and drop rules will be
placed in the zone_deny chain, which will be walked after
the log chain. All accept rules will be placed in the
zone_allow chain, which will be walked after the deny chain.
If a rule contains log and also deny or allow actions, the
parts are placed in the matching chains.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">These are
examples of how to specify rich language rules. This format
(i.e. one string that specifies whole rule) uses for example
<b>firewall&minus;cmd
&minus;&minus;add&minus;rich&minus;rule</b> (see
<b>firewall-cmd</b>(1)) as well as D&minus;Bus
interface.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
1</b> <br>
Enable new IPv4 and IPv6 connections for protocol 'ah'</p>

<p style="margin-left:17%; margin-top: 1em">rule protocol
value=&quot;ah&quot; accept</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
2</b> <br>
Allow new IPv4 and IPv6 connections for service ftp and log
1 per minute using audit</p>

<p style="margin-left:17%; margin-top: 1em">rule service
name=&quot;ftp&quot; log limit value=&quot;1/m&quot; audit
accept</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
3</b> <br>
Allow new IPv4 connections from address 192.168.0.0/24 for
service tftp and log 1 per minutes using syslog</p>

<p style="margin-left:17%; margin-top: 1em">rule
family=&quot;ipv4&quot; source
address=&quot;192.168.0.0/24&quot; service
name=&quot;tftp&quot; log prefix=&quot;tftp&quot;
level=&quot;info&quot; limit value=&quot;1/m&quot;
accept</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
4</b> <br>
New IPv6 connections from 1:2:3:4:6:: to service radius are
all rejected and logged at a rate of 3 per minute. New IPv6
connections from other sources are accepted.</p>

<p style="margin-left:17%; margin-top: 1em">rule
family=&quot;ipv6&quot; source
address=&quot;1:2:3:4:6::&quot; service
name=&quot;radius&quot; log prefix=&quot;dns&quot;
level=&quot;info&quot; limit value=&quot;3/m&quot; reject
<br>
rule family=&quot;ipv6&quot; service name=&quot;radius&quot;
accept</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
5</b> <br>
Forward IPv6 port/packets receiving from 1:2:3:4:6:: on port
4011 with protocol tcp to 1::2:3:4:7 on port 4012</p>

<p style="margin-left:17%; margin-top: 1em">rule
family=&quot;ipv6&quot; source
address=&quot;1:2:3:4:6::&quot; forward&minus;port
to&minus;addr=&quot;1::2:3:4:7&quot;
to&minus;port=&quot;4012&quot; protocol=&quot;tcp&quot;
port=&quot;4011&quot;</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
6</b> <br>
White&minus;list source address to allow all connections
from 192.168.2.2</p>

<p style="margin-left:17%; margin-top: 1em">rule
family=&quot;ipv4&quot; source
address=&quot;192.168.2.2&quot; accept</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
7</b> <br>
Black&minus;list source address to reject all connections
from 192.168.2.3</p>

<p style="margin-left:17%; margin-top: 1em">rule
family=&quot;ipv4&quot; source
address=&quot;192.168.2.3&quot; reject
type=&quot;icmp&minus;admin&minus;prohibited&quot;</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example
8</b> <br>
Black&minus;list source address to drop all connections from
192.168.2.4</p>

<p style="margin-left:17%; margin-top: 1em">rule
family=&quot;ipv4&quot; source
address=&quot;192.168.2.4&quot; drop</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>firewall-applet</b>(1),
<b>firewalld</b>(1), <b>firewall-cmd</b>(1),
<b>firewall-config</b>(1), <b>firewalld.conf</b>(5),
<b>firewalld.direct</b>(5), <b>firewalld.dbus</b>(5),
<b>firewalld.icmptype</b>(5),
<b>firewalld.lockdown-whitelist</b>(5),
<b>firewall-offline-cmd</b>(1),
<b>firewalld.richlanguage</b>(5),
<b>firewalld.service</b>(5), <b>firewalld.zone</b>(5),
<b>firewalld.zones</b>(5)</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">firewalld home
page:</p>


<p style="margin-left:17%;"><b><font color="#0000FF">http://www.firewalld.org</font></b></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">More
documentation with examples:</font></p>


<p style="margin-left:17%;"><b><font color="#0000FF">http://fedoraproject.org/wiki/FirewallD</font></b></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b><font color="#000000">Thomas
Woerner</font></b>
<font color="#000000">&lt;twoerner@redhat.com&gt;</font></p>


<p style="margin-left:17%;"><font color="#000000">Developer</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Jiri
Popelka</b> &lt;jpopelka@redhat.com&gt;</font></p>


<p style="margin-left:17%;"><font color="#000000">Developer</font></p>
<hr>
</body>
</html>
