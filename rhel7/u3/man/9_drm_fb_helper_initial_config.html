<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:17:57 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>DRM_FB_HELPER_INITIA</title>

</head>
<body>

<h1 align="center">DRM_FB_HELPER_INITIA</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#ARGUMENTS">ARGUMENTS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#HANG DEBUGGING">HANG DEBUGGING</a><br>
<a href="#RETURNS">RETURNS</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">drm_fb_helper_initial_config
&minus; setup a sane initial connector configuration</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>int
drm_fb_helper_initial_config(struct&nbsp;drm_fb_helper&nbsp;*&nbsp;</b><i>fb_helper</i><b>,
int&nbsp;</b><i>bpp_sel</i><b>);</b></p> </td></tr>
</table>

<h2>ARGUMENTS
<a name="ARGUMENTS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b><i>fb_helper</i></b></p>

<p style="margin-left:17%;">fb_helper device struct</p>


<p style="margin-left:11%; margin-top: 1em"><i>bpp_sel</i></p>

<p style="margin-left:17%;">bpp value to use for the
framebuffer configuration</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Scans the CRTCs
and connectors and tries to put together an initial setup.
At the moment, this is a cloned configuration across all
heads with a new framebuffer object as the backing
store.</p>

<p style="margin-left:11%; margin-top: 1em">Note that this
also registers the fbdev and so allows userspace to call
into the driver through the fbdev interfaces.</p>

<p style="margin-left:11%; margin-top: 1em">This function
will call down into the &minus;&gt;fb_probe callback to let
the driver allocate and initialize the fbdev info structure
and the drm framebuffer used to back the fbdev.
<b>drm_fb_helper_fill_var</b> and
<b>drm_fb_helper_fill_fix</b> are provided as helpers to
setup simple default values for the fbdev info
structure.</p>

<h2>HANG DEBUGGING
<a name="HANG DEBUGGING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">When you have
fbcon support built&minus;in or already loaded, this
function will do a full modeset to setup the fbdev console.
Due to locking misdesign in the VT/fbdev subsystem that
entire modeset sequence has to be done while holding
console_lock. Until console_unlock is called no dmesg lines
will be sent out to consoles, not even serial console. This
means when your driver crashes, you will see absolutely
nothing else but a system stuck in this function, with no
further output. Any kind of <b>printk</b> you place within
your own driver or in the drm core modeset code will also
never show up.</p>

<p style="margin-left:11%; margin-top: 1em">Standard debug
practice is to run the fbcon setup without taking the
console_lock as a hack, to be able to see backtraces and
crashes on the serial line. This can be done by setting the
fb.lockless_register_fb=1 kernel cmdline option.</p>

<p style="margin-left:11%; margin-top: 1em">The other
option is to just disable fbdev emulation since very likely
the first modest from userspace will crash in the same way,
and is even easier to debug. This can be done by setting the
drm_kms_helper.fbdev_emulation=0 kernel cmdline option.</p>

<h2>RETURNS
<a name="RETURNS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Zero if
everything went ok, nonzero otherwise.</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Jesse
Barnes</b> &lt;jesse.barnes@intel.com&gt;</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%"></td>
<td width="7%">


<p>Intel Corporation,</p></td>
<td width="85%">
</td></tr>
</table>

<p style="margin-left:17%;">Initial version</p>

<p style="margin-left:11%; margin-top: 1em"><b>Laurent
Pinchart</b> &lt;laurent.pinchart@ideasonboard.com&gt;</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%"></td>
<td width="7%">


<p>Ideas on board SPRL,</p></td>
<td width="85%">
</td></tr>
</table>

<p style="margin-left:17%;">Driver internals</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<hr>
</body>
</html>
