<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:00:31 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>nft</title>

</head>
<body>

<h1 align="center">nft</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#INPUT FILE FORMAT">INPUT FILE FORMAT</a><br>
<a href="#ADDRESS FAMILIES">ADDRESS FAMILIES</a><br>
<a href="#TABLES">TABLES</a><br>
<a href="#CHAINS">CHAINS</a><br>
<a href="#RULES">RULES</a><br>
<a href="#EXPRESSIONS">EXPRESSIONS</a><br>
<a href="#DATA TYPES">DATA TYPES</a><br>
<a href="#PRIMARY EXPRESSIONS">PRIMARY EXPRESSIONS</a><br>
<a href="#PAYLOAD EXPRESSIONS">PAYLOAD EXPRESSIONS</a><br>
<a href="#BLA">BLA</a><br>
<a href="#STATEMENTS">STATEMENTS</a><br>
<a href="#ADDITIONAL COMMANDS">ADDITIONAL COMMANDS</a><br>
<a href="#ERROR REPORTING">ERROR REPORTING</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nft &minus;
Administration tool for packet filtering and
classification</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>nft</b> [
<b>-n | --numeric</b> ] [ <b>[-I | --includepath]</b>
<i>directory</i> ] [ <b>[-f | --file]</b> <i>filename</i> |
<b>[-i | --interactive]</b> | <i>cmd</i> ...] <b><br>
nft</b> [ <b>-h | --help</b> ] [ <b>-v | --version</b> ]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nft is used to
set up, maintain and inspect packet filtering and
classification rules in the Linux kernel.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For a full
summary of options, run <b>nft --help</b>. <b><br>
&minus;h, &minus;&minus;help</b></p>

<p style="margin-left:22%;">Show help message and all
options.</p>

<p style="margin-left:11%;"><b>&minus;v,
&minus;&minus;version</b></p>

<p style="margin-left:22%;">Show version.</p>

<p style="margin-left:11%;"><b>&minus;n,
&minus;&minus;numeric</b></p>

<p style="margin-left:22%;">Numeric output: Addresses and
other information that might need network traffic to resolve
to symbolic names are shown numerically (default behaviour).
When used twice, internet services are translated. When used
twice, internet services and UIDs/GIDs are also shown
numerically. When used three times, protocol numbers are
also shown numerically.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;N</b></p></td>
<td width="8%"></td>
<td width="55%">


<p>Translate IP addresses to DNS names.</p></td>
<td width="23%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;a,
&minus;&minus;handle</b></p>

<p style="margin-left:22%;">Show rule handles in
output.</p>

<p style="margin-left:11%;"><b>&minus;I,
&minus;&minus;includepath</b> <i>directory</i></p>

<p style="margin-left:22%;">Add the directory
<i>directory</i> to the list of directories to be searched
for included files.</p>

<p style="margin-left:11%;"><b>&minus;f,
&minus;&minus;file</b> <i>filename</i></p>

<p style="margin-left:22%;">Read input from
<i>filename</i>.</p>

<p style="margin-left:11%;"><b>&minus;i,
&minus;&minus;interactive</b></p>

<p style="margin-left:22%;">Read input from an interactive
readline CLI.</p>

<h2>INPUT FILE FORMAT
<a name="INPUT FILE FORMAT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>LEXICAL
CONVENTIONS</b> <br>
Input is parsed line-wise. When the last character of a
line, just before the newline character, is a non-quoted
backslash (\), the next line is treated as a continuation.
Multiple commands on the same line can be separated using a
semicolon (;).</p>

<p style="margin-left:11%; margin-top: 1em">A hash sign (#)
begins a comment. All following characters on the same line
are ignored.</p>

<p style="margin-left:11%; margin-top: 1em">Identifiers
begin with an alphabetic character (a&minus;z,A&minus;Z),
followed zero or more alphanumeric characters
(a&minus;z,A&minus;Z,0&minus;9) and the characters slash
(/), backslash (\), underscore (_) and dot (.). Identifiers
using different characters or clashing with a keyword need
to be enclosed in double quotes (&quot;).</p>

<p style="margin-left:11%; margin-top: 1em"><b>INCLUDE
FILES <br>
include</b> <i>filename</i></p>

<p style="margin-left:11%; margin-top: 1em">Other files can
be included by using the <b>include</b> statement. The
directories to be searched for include files can be
specified using the
<b>&minus;I/&minus;&minus;includepath</b> option.</p>

<p style="margin-left:11%; margin-top: 1em"><b>SYMBOLIC
VARIABLES <br>
define</b> variable <i>expr</i> <b><br>
$variable</b></p>

<p style="margin-left:11%; margin-top: 1em">Symbolic
variables can be defined using the <b>define</b> statement.
Variable references are expressions and can be used
initialize other variables. The scope of a definition is the
current block and all blocks contained within.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Using
symbolic variables</b></p>

<p style="margin-left:11%; margin-top: 1em">define int_if1
= eth0 <br>
define int_if2 = eth1 <br>
define int_ifs = { $int_if1, $int_if2 }</p>

<p style="margin-left:11%; margin-top: 1em">filter input
iif $int_ifs accept</p>

<h2>ADDRESS FAMILIES
<a name="ADDRESS FAMILIES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Address
families determine the type of packets which are processed.
For each address family the kernel contains so called hooks
at specific stages of the packet processing paths, which
invoke nftables if rules for these hooks exist.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>ip</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>IPv4 address family.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>ip6</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>IPv6 address family.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>inet</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Internet (IPv4/IPv6) address family.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>arp</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>ARP address family, handling packets vi</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>bridge</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Bridge address family, handling packets which traverse a
bridge device.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>netdev</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Netdev address family, handling packets from
ingress.</p> </td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">All nftables
objects exist in address family specific namespaces,
therefore all identifiers include an address family. If an
identifier is specified without an address family, the ip
family is used by default.</p>


<p style="margin-left:11%; margin-top: 1em"><b>IPV4/IPV6/INET
ADDRESS FAMILIES</b> <br>
The IPv4/IPv6/Inet address families handle IPv4, IPv6 or
both types of packets. They contain five hooks at different
packet processing stages in the network stack.</p>


<p style="margin-left:11%; margin-top: 1em"><b>IPv4/IPv6/Inet
address family hooks</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-121901.png" alt="Image grohtml-121901.png"></b></p>

<p style="margin-left:11%;"><b>ARP ADDRESS FAMILY</b> <br>
The ARP address family handles ARP packets received and sent
by the system. It is commonly used to mangle ARP packets for
clustering.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ARP address
family hooks</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-121902.png" alt="Image grohtml-121902.png"></b></p>

<p style="margin-left:11%;"><b>BRIDGE ADDRESS FAMILY</b>
<br>
The bridge address family handles ethernet packets
traversing bridge devices.</p>

<p style="margin-left:11%; margin-top: 1em"><b>NETDEV
ADDRESS FAMILY</b> <br>
The Netdev address family handles packets from ingress.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Netdev
address family hooks</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-121903.png" alt="Image grohtml-121903.png"></b></p>

<h2>TABLES
<a name="TABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">{add | delete |
list | flush} <b>table</b> [<i>family</i>]
{<i>table</i>}</p>

<p style="margin-left:11%; margin-top: 1em">Tables are
containers for chains and sets. They are identified by their
address family and their name. The address family must be
one of ip, ip6, inet, arp, bridge, netdev. The inet address
family is a dummy family which is used to create hybrid
IPv4/IPv6 tables. When no address family is specified, ip is
used by default.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>add</b></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">Add a new table for the given
family with the given name.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>delete</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Delete the specified table.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>list</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>List all chains and rules of the specified table.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>flush</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Flush all chains and rules of the specified table.</p></td></tr>
</table>

<h2>CHAINS
<a name="CHAINS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">{add}
<b>chain</b> [<i>family</i>] {<i>table</i>} {<i>chain</i>}
{<i>hook</i>} {<i>priority</i>} {<i>policy</i>}
{<i>device</i>} <br>
{add | create | delete | list | flush} <b>chain</b>
[<i>family</i>] {<i>table</i>} {<i>chain</i>} <br>
{rename} <b>chain</b> [<i>family</i>] {<i>table</i>}
{<i>chain</i>} {<i>newname</i>}</p>

<p style="margin-left:11%; margin-top: 1em">Chains are
containers for rules. They exist in two kinds, base chains
and regular chains. A base chain is an entry point for
packets from the networking stack, a regular chain may be
used as jump target and is used for better rule
organization.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>add</b></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">Add a new chain in the specified
table. When a hook and priority value are specified, the
chain is created as a base chain and hooked up to the
networking stack.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>create</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Simlar to the <b>add</b> command, but returns an error
if the chain already exists.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>delete</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Delete the specified chain. The chain must not contain
any rules or be used as jump target.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>rename</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Rename the specified chain.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>list</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>List all rules of the specified chain.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>flush</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Flush all rules of the specified chain.</p></td></tr>
</table>

<h2>RULES
<a name="RULES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">[add | insert]
<b>rule</b> [<i>family</i>] {<i>table</i>} {<i>chain</i>}
[position <i>position</i>] {<i>statement</i>}... <br>
{delete} <b>rule</b> [<i>family</i>] {<i>table</i>}
{<i>chain</i>} {handle <i>handle</i>}</p>

<p style="margin-left:11%; margin-top: 1em">Rules are
constructed from two kinds of components according to a set
of grammatical rules: expressions and statements.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>add</b></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">Add a new rule described by the
list of statements. The rule is appended to the given chain
unless a position is specified, in which case the rule is
appended to the rule given by the position.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>insert</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Similar to the <b>add</b> command, but the rule is
prepended to the beginning of the chain or before the rule
at the given position.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>delete</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Delete the specified rule.</p></td></tr>
</table>

<h2>EXPRESSIONS
<a name="EXPRESSIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Expressions
represent values, either constants like network addresses,
port numbers etc. or data gathered from the packet during
ruleset evaluation. Expressions can be combined using
binary, logical, relational and other types of expressions
to form complex or relational (match) expressions. They are
also used as arguments to certain types of operations, like
NAT, packet marking etc.</p>

<p style="margin-left:11%; margin-top: 1em">Each expression
has a data type, which determines the size, parsing and
representation of symbolic values and type compatibility
with other expressions.</p>

<p style="margin-left:11%; margin-top: 1em"><b>DESCRIBE
COMMAND <br>
describe</b> {<i>expression</i>}</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>describe</b> command shows information about the type of
an expression and its data type.</p>

<p style="margin-left:11%; margin-top: 1em"><b>The describe
command</b></p>

<p style="margin-left:11%; margin-top: 1em">$ nft describe
tcp flags <br>
payload expression, datatype tcp_flag (TCP flag) (basetype
bitmask, integer), 8 bits</p>


<p style="margin-left:11%; margin-top: 1em">pre&minus;defined
symbolic constants:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>fin</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x01</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>syn</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x02</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>rst</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x04</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>psh</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x08</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>ack</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x10</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>urg</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x20</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>ecn</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x40</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="-3%">


<p>cwr</p></td>
<td width="46%"></td>
<td width="8%"></td>
<td width="38%">


<p>0x80</p></td></tr>
</table>

<h2>DATA TYPES
<a name="DATA TYPES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Data types
determine the size, parsing and representation of symbolic
values and type compatibility of expressions. A number of
global data types exist, in addition some expression types
define further data types specific to the expression type.
Most data types have a fixed size, some however may have a
dynamic size, f.i. the string type.</p>

<p style="margin-left:11%; margin-top: 1em">Types may be
derived from lower order types, f.i. the IPv4 address type
is derived from the integer type, meaning an IPv4 address
can also be specified as an integer value.</p>

<p style="margin-left:11%; margin-top: 1em">In certain
contexts (set and map definitions) it is necessary to
explicitly specify a data type. Each type has a name which
is used for this.</p>

<p style="margin-left:11%; margin-top: 1em"><b>INTEGER
TYPE</b></p>


<p align="center"><b><img src="grohtml-121904.png" alt="Image grohtml-121904.png"></b></p>

<p style="margin-left:11%;">The integer type is used for
numeric values. It may be specified as decimal, hexadecimal
or octal number. The integer type doesn&rsquo;t have a fixed
size, its size is determined by the expression for which it
is used.</p>

<p style="margin-left:11%; margin-top: 1em"><b>BITMASK
TYPE</b></p>


<p align="center"><b><img src="grohtml-121905.png" alt="Image grohtml-121905.png"></b></p>

<p style="margin-left:11%;">The bitmask type
(<b>bitmask</b>) is used for bitmasks.</p>

<p style="margin-left:11%; margin-top: 1em"><b>STRING
TYPE</b></p>


<p align="center"><b><img src="grohtml-121906.png" alt="Image grohtml-121906.png"></b></p>

<p style="margin-left:11%;">The string type is used to for
character strings. A string begins with an alphabetic
character (a-zA-Z) followed by zero or more alphanumeric
characters or the characters /, &minus;, _ and .. In
addition anything enclosed in double quotes (&quot;) is
recognized as a string.</p>

<p style="margin-left:11%; margin-top: 1em"><b>String
specification</b></p>

<p style="margin-left:11%; margin-top: 1em"># Interface
name <br>
filter input iifname eth0</p>

<p style="margin-left:11%; margin-top: 1em"># Weird
interface name <br>
filter input iifname &quot;(eth0)&quot;</p>

<p style="margin-left:11%; margin-top: 1em"><b>LINK LAYER
ADDRESS TYPE</b></p>


<p align="center"><b><img src="grohtml-121907.png" alt="Image grohtml-121907.png"></b></p>

<p style="margin-left:11%;">The link layer address type is
used for link layer addresses. Link layer addresses are
specified as a variable amount of groups of two hexadecimal
digits separated using colons (:).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Link layer
address specification</b></p>

<p style="margin-left:11%; margin-top: 1em"># Ethernet
destination MAC address <br>
filter input ether daddr 20:c9:d0:43:12:d9</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPV4 ADDRESS
TYPE</b></p>


<p align="center"><b><img src="grohtml-121908.png" alt="Image grohtml-121908.png"></b></p>

<p style="margin-left:11%;">The IPv4 address type is used
for IPv4 addresses. Addresses are specified in either dotted
decimal, dotted hexadecimal, dotted octal, decimal,
hexadecimal, octal notation or as a host name. A host name
will be resolved using the standard system resolver.</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPv4 address
specification</b></p>

<p style="margin-left:11%; margin-top: 1em"># dotted
decimal notation <br>
filter output ip daddr 127.0.0.1</p>

<p style="margin-left:11%; margin-top: 1em"># host name
<br>
filter output ip daddr localhost</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPV6 ADDRESS
TYPE</b></p>


<p align="center"><b><img src="grohtml-121909.png" alt="Image grohtml-121909.png"></b></p>

<p style="margin-left:11%;">The IPv6 address type is used
for IPv6 addresses. FIXME</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPv6 address
specification</b></p>

<p style="margin-left:11%; margin-top: 1em"># abbreviated
loopback address <br>
filter output ip6 daddr ::1</p>

<h2>PRIMARY EXPRESSIONS
<a name="PRIMARY EXPRESSIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The lowest
order expression is a primary expression, representing
either a constant or a single datum from a packet&rsquo;s
payload, meta data or a stateful module.</p>

<p style="margin-left:11%; margin-top: 1em"><b>META
EXPRESSIONS <br>
meta</b> {length | nfproto | l4proto | protocol | priority}
<br>
[meta] {mark | iif | iifname | iiftype | oif | oifname |
oiftype | skuid | skgid | nftrace | rtclassid | ibriport |
obriport | pkttype | cpu | iifgroup | oifgroup | cgroup}</p>

<p style="margin-left:11%; margin-top: 1em">A meta
expression refers to meta data associated with a packet.</p>

<p style="margin-left:11%; margin-top: 1em">There are two
types of meta expressions: unqualified and qualified meta
expressions. Qualified meta expressions require the
<b>meta</b> keyword before the meta key, unqualified meta
expressions can be specified by using the meta key directly
or as qualified meta expressions.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Meta
expression types</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219010.png" alt="Image grohtml-1219010.png"></b></p>

<p style="margin-left:11%;"><b>Meta expression specific
types</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219011.png" alt="Image grohtml-1219011.png"></b></p>

<p style="margin-left:11%;"><b>Using meta
expressions</b></p>

<p style="margin-left:11%; margin-top: 1em"># qualified
meta expression <br>
filter output meta oif eth0</p>

<p style="margin-left:11%; margin-top: 1em"># unqualified
meta expression <br>
filter output oif eth0</p>

<h2>PAYLOAD EXPRESSIONS
<a name="PAYLOAD EXPRESSIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Payload
expressions refer to data from the packet&rsquo;s
payload.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ETHERNET
HEADER EXPRESSION <br>
ether</b> [<i>ethernet header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Ethernet
header expression types</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219012.png" alt="Image grohtml-1219012.png"></b></p>

<p style="margin-left:11%;"><b>VLAN HEADER EXPRESSION <br>
vlan</b> [<i>VLAN header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>VLAN header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219013.png" alt="Image grohtml-1219013.png"></b></p>

<p style="margin-left:11%;"><b>ARP HEADER EXPRESSION <br>
arp</b> [<i>ARP header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>ARP header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219014.png" alt="Image grohtml-1219014.png"></b></p>

<p style="margin-left:11%;"><b>IPV4 HEADER EXPRESSION <br>
ip</b> [<i>IPv4 header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPv4 header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219015.png" alt="Image grohtml-1219015.png"></b></p>

<p style="margin-left:11%;"><b>IPV6 HEADER EXPRESSION <br>
ip6</b> [<i>IPv6 header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPv6 header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219016.png" alt="Image grohtml-1219016.png"></b></p>

<p style="margin-left:11%;"><b>TCP HEADER EXPRESSION <br>
tcp</b> [<i>TCP header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>TCP header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219017.png" alt="Image grohtml-1219017.png"></b></p>

<p style="margin-left:11%;"><b>UDP HEADER EXPRESSION <br>
udp</b> [<i>UDP header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>UDP header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219018.png" alt="Image grohtml-1219018.png"></b></p>

<p style="margin-left:11%;"><b>UDP-LITE HEADER EXPRESSION
<br>
udplite</b> [<i>UDP-Lite header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>UDP-Lite
header expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219019.png" alt="Image grohtml-1219019.png"></b></p>

<p style="margin-left:11%;"><b>SCTP HEADER EXPRESSION <br>
sctp</b> [<i>SCTP header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>SCTP header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219020.png" alt="Image grohtml-1219020.png"></b></p>

<p style="margin-left:11%;"><b>DCCP HEADER EXPRESSION <br>
dccp</b> [<i>DCCP header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>DCCP header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219021.png" alt="Image grohtml-1219021.png"></b></p>

<p style="margin-left:11%;"><b>AUTHENTICATION HEADER
EXPRESSION <br>
ah</b> [<i>AH header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>AH header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219022.png" alt="Image grohtml-1219022.png"></b></p>

<p style="margin-left:11%;"><b>ENCRYPTED SECURITY PAYLOAD
HEADER EXPRESSION <br>
esp</b> [<i>ESP header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>ESP header
expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219023.png" alt="Image grohtml-1219023.png"></b></p>

<p style="margin-left:11%;"><b>IPCOMP HEADER EXPRESSION
<br>
comp</b> [<i>IPComp header field</i>]</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPComp
header expression</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219024.png" alt="Image grohtml-1219024.png"></b></p>

<h2>BLA
<a name="BLA"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>IPV6
EXTENSION HEADER EXPRESSIONS</b> <br>
IPv6 extension header expressions refer to data from an IPv6
packet&rsquo;s extension headers.</p>

<p style="margin-left:11%; margin-top: 1em"><b>CONNTRACK
EXPRESSIONS</b> <br>
Conntrack expressions refer to meta data of the connection
tracking entry associated with a packet.</p>

<p style="margin-left:11%; margin-top: 1em">There are three
types of conntrack expressions. Some conntrack expressions
require the flow direction before the conntrack key, others
must be used directly because they are direction agnostic.
The <b>packets and bytes</b> keywords can be used with or
without a direction. If the direction is omitted, the sum of
the original and the reply direction is returned.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ct</b>
{state | direction | status | mark | expiration | helper |
label | bytes | packets} {original | reply | {l3proto |
protocol | saddr | daddr | proto-src | proto-dst | bytes |
packets}}</p>

<p style="margin-left:11%; margin-top: 1em"><b>Conntrack
expressions</b></p>


<p align="center" style="margin-top: 1em"><b><img src="grohtml-1219025.png" alt="Image grohtml-1219025.png"></b></p>

<h2>STATEMENTS
<a name="STATEMENTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Statements
represent actions to be performed. They can alter control
flow (return, jump to a different chain, accept or drop the
packet) or can perform actions, such as logging, rejecting a
packet, etc.</p>

<p style="margin-left:11%; margin-top: 1em">Statements
exist in two kinds. Terminal statements unconditionally
terminate evaluation of the current rule, non-terminal
statements either only conditionally or never terminate
evaluation of the current rule, in other words, they are
passive from the ruleset evaluation perspective. There can
be an arbitrary amount of non-terminal statements in a rule,
but only a single terminal statement as the final
statement.</p>

<p style="margin-left:11%; margin-top: 1em"><b>VERDICT
STATEMENT</b> <br>
The verdict statement alters control flow in the ruleset and
issues policy decisions for packets.</p>

<p style="margin-left:11%; margin-top: 1em">{accept | drop
| queue | continue | return} <br>
{jump | goto} {<i>chain</i>}</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>accept</b></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">Terminate ruleset evaluation and
accept the packet.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>drop</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Terminate ruleset evaluation and drop the packet.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>queue</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Terminate ruleset evaluation and queue the packet to
userspace.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>continue</b></p>

<p style="margin-left:22%;">Continue ruleset evaluation
with the next rule. FIXME</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>return</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Return from the current chain and continue evaluation at
the next rule in the last chain. If issued in a base chain,
it is equivalent to <b>accept</b>.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>jump</b> <i>chain</i></p>

<p style="margin-left:22%;">Continue evaluation at the
first rule in <i>chain</i>. The current position in the
ruleset is pushed to a call stack and evaluation will
continue there when the new chain is entirely evaluated of a
<b>return</b> verdict is issued.</p>

<p style="margin-left:11%;"><b>goto</b> <i>chain</i></p>

<p style="margin-left:22%;">Similar to <b>jump</b>, but the
current position is not pushed to the call stack, meaning
that after the new chain evaluation will continue at the
last chain instead of the one containing the goto
statement.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Verdict
statements</b></p>

<p style="margin-left:11%; margin-top: 1em"># process
packets from eth0 and the internal network in from_lan <br>
# chain, drop all packets from eth0 with different source
addresses.</p>

<p style="margin-left:11%; margin-top: 1em">filter input
iif eth0 ip saddr 192.168.0.0/24 jump from_lan <br>
filter input iif eth0 drop</p>

<p style="margin-left:11%; margin-top: 1em"><b>LOG
STATEMENT <br>
REJECT STATEMENT <br>
COUNTER STATEMENT <br>
META STATEMENT <br>
LIMIT STATEMENT <br>
NAT STATEMENT <br>
QUEUE STATEMENT</b></p>

<h2>ADDITIONAL COMMANDS
<a name="ADDITIONAL COMMANDS"></a>
</h2>


<p style="margin-left:11%;">These are some additional
commands included in nft.</p>

<p style="margin-left:11%; margin-top: 1em"><b>EXPORT</b>
<br>
Export your current ruleset in XML or JSON format to
stdout.</p>

<p style="margin-left:11%; margin-top: 1em">Examples:</p>

<p style="margin-left:11%; margin-top: 1em">% nft export
xml <br>
[...] <br>
% nft export json <br>
[...]</p>

<p style="margin-left:11%; margin-top: 1em"><b>MONITOR</b>
<br>
The monitor command allows you to listen to Netlink events
produced by the nf_tables subsystem, related to creation and
deletion of objects. When they ocurr, nft will print to
stdout the monitored events in either XML, JSON or native
nft format.</p>

<p style="margin-left:11%; margin-top: 1em">To filter
events related to a concrete object, use one of the keywords
&rsquo;tables&rsquo;, &rsquo;chains&rsquo;,
&rsquo;sets&rsquo;, &rsquo;rules&rsquo;,
&rsquo;elements&rsquo;.</p>

<p style="margin-left:11%; margin-top: 1em">To filter
events related to a concrete action, use keyword
&rsquo;new&rsquo; or &rsquo;destroy&rsquo;.</p>

<p style="margin-left:11%; margin-top: 1em">Hit ^C to
finish the monitor operation.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Listen to
all events, report in native nft format</b></p>

<p style="margin-left:11%; margin-top: 1em">% nft
monitor</p>

<p style="margin-left:11%; margin-top: 1em"><b>Listen to
added tables, report in XML format</b></p>

<p style="margin-left:11%; margin-top: 1em">% nft monitor
new tables xml</p>

<p style="margin-left:11%; margin-top: 1em"><b>Listen to
deleted rules, report in JSON format</b></p>

<p style="margin-left:11%; margin-top: 1em">% nft monitor
destroy rules json</p>

<p style="margin-left:11%; margin-top: 1em"><b>Listen to
both new and destroyed chains, in native nft format</b></p>

<p style="margin-left:11%; margin-top: 1em">% nft monitor
chains</p>

<h2>ERROR REPORTING
<a name="ERROR REPORTING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">When an error
is detected, nft shows the line(s) containing the error, the
position of the erroneous parts in the input stream and
marks up the erroneous parts using carrets (^). If the error
results from the combination of two expressions or
statements, the part imposing the constraints which are
violated is marked using tildes (~).</p>

<p style="margin-left:11%; margin-top: 1em">For errors
returned by the kernel, nft can&rsquo;t detect which parts
of the input caused the error and the entire command is
marked.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Error caused
by single incorrect expression</b></p>


<p style="margin-left:11%; margin-top: 1em">&lt;cmdline&gt;:1:19&minus;22:
Error: Interface does not exist <br>
filter output oif eth0 <br>
^^^^</p>

<p style="margin-left:11%; margin-top: 1em"><b>Error caused
by invalid combination of two expressions</b></p>


<p style="margin-left:11%; margin-top: 1em">&lt;cmdline&gt;:1:28&minus;36:
Error: Right hand side of relational expression (==) must be
constant <br>
filter output tcp dport == tcp dport <br>
~~ ^^^^^^^^^</p>

<p style="margin-left:11%; margin-top: 1em"><b>Error
returned by the kernel</b></p>


<p style="margin-left:11%; margin-top: 1em">&lt;cmdline&gt;:0:0&minus;23:
Error: Could not process rule: Operation not permitted <br>
filter output oif wlan0 <br>
^^^^^^^^^^^^^^^^^^^^^^^</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">On success, nft
exits with a status of 0. Unspecified errors cause it to
exit with a status of 1, memory allocation errors with a
status of 2, unable to open Netlink socket with 3.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">iptables(8),
ip6tables(8), arptables(8), ebtables(8), ip(8), tc(8)</p>

<p style="margin-left:11%; margin-top: 1em">There is an
official wiki at: http://wiki.nftables.org</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nftables was
written by Patrick McHardy.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright
&copy; 2008-2014 Patrick McHardy &lt;kaber@trash.net&gt;</p>

<p style="margin-left:11%; margin-top: 1em">nftables is
free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License version 2
as published by the Free Software Foundation.</p>

<p style="margin-left:11%; margin-top: 1em">This
documentation is licenced under the terms of the Creative
Commons Attribution-ShareAlike 4.0 license, CC BY-SA 4.0
&lang; http://creativecommons.org/licenses/by-sa/4.0/&rang;
.</p>
<hr>
</body>
</html>
