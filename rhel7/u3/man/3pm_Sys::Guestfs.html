<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:39:25 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Sys::Guestfs</title>

</head>
<body>

<h1 align="center">Sys::Guestfs</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#ERRORS">ERRORS</a><br>
<a href="#METHODS">METHODS</a><br>
<a href="#AVAILABILITY">AVAILABILITY</a><br>
<a href="#STORING DATA IN THE HANDLE">STORING DATA IN THE HANDLE</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Sys::Guestfs
&minus; Perl bindings for libguestfs</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em"> use Sys::Guestfs;
 my $g = Sys::Guestfs&minus;&gt;new ();
 $g&minus;&gt;add_drive_opts ('guest.img', format =&gt; 'raw');
 $g&minus;&gt;launch ();
 $g&minus;&gt;mount ('/dev/sda1', '/');
 $g&minus;&gt;touch ('/hello');
 $g&minus;&gt;shutdown ();
 $g&minus;&gt;close ();</pre>


<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<tt>&quot;Sys::Guestfs&quot;</tt> module provides a Perl
<small>XS</small> binding to the libguestfs
<small>API</small> for examining and modifying virtual
machine disk images.</p>

<p style="margin-left:11%; margin-top: 1em">Amongst the
things this is good for: making batch configuration changes
to guests, getting disk used/free statistics (see also:
virt-df), migrating between virtualization systems (see
also: virt&minus;p2v), performing partial backups,
performing partial guest clones, cloning guests and changing
registry/UUID/hostname info, and much else besides.</p>

<p style="margin-left:11%; margin-top: 1em">Libguestfs uses
Linux kernel and qemu code, and can access any type of guest
filesystem that Linux and qemu can, including but not
limited to: ext2/3/4, btrfs, <small>FAT</small> and
<small>NTFS, LVM,</small> many different disk partition
schemes, qcow, qcow2, vmdk.</p>

<p style="margin-left:11%; margin-top: 1em">Libguestfs
provides ways to enumerate guest storage (eg. partitions,
LVs, what filesystem is in each <small>LV,</small> etc.). It
can also run commands in the context of the guest. Also you
can access filesystems over <small>FUSE.</small></p>

<h2>ERRORS
<a name="ERRORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">All errors turn
into calls to <tt>&quot;croak&quot;</tt> (see
<i>Carp</i>(3)).</p>

<p style="margin-left:11%; margin-top: 1em">The error
string from libguestfs is directly available from
<tt>$@</tt>. Use the <tt>&quot;last_errno&quot;</tt> method
if you want to get the errno.</p>

<h2>METHODS
<a name="METHODS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">$g =
Sys::Guestfs&minus;&gt;new ([environment =&gt; 0,]
[close_on_exit =&gt; 0]);</p>

<p style="margin-left:17%;">Create a new guestfs
handle.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
argument <tt>&quot;environment&quot;</tt> is false, then the
<tt>&quot;GUESTFS_CREATE_NO_ENVIRONMENT&quot;</tt> flag is
set.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
argument <tt>&quot;close_on_exit&quot;</tt> is false, then
the <tt>&quot;GUESTFS_CREATE_NO_CLOSE_ON_EXIT&quot;</tt>
flag is set.</p>

<p style="margin-left:11%;">$g&minus;&gt;close ();</p>

<p style="margin-left:17%;">Explicitly close the guestfs
handle.</p>

<p style="margin-left:17%; margin-top: 1em"><b>Note:</b>
You should not usually call this function. The handle will
be closed implicitly when its reference count goes to zero
(eg. when it goes out of scope or the program ends). This
call is only required in some exceptional cases, such as
where the program may contain cached references to the
handle &rsquo;somewhere&rsquo; and you really have to have
the close happen right away. After calling
<tt>&quot;close&quot;</tt> the program must not call any
method (including <tt>&quot;close&quot;</tt>) on the handle
(but the implicit call to <tt>&quot;DESTROY&quot;</tt> that
happens when the final reference is cleaned up is
<small>OK</small> ).</p>

<p style="margin-left:11%;">$Sys::Guestfs::EVENT_CLOSE</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_CLOSE&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$Sys::Guestfs::EVENT_SUBPROCESS_QUIT</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_SUBPROCESS_QUIT&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$Sys::Guestfs::EVENT_LAUNCH_DONE</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_LAUNCH_DONE&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$Sys::Guestfs::EVENT_PROGRESS</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_PROGRESS&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$Sys::Guestfs::EVENT_APPLIANCE</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_APPLIANCE&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$Sys::Guestfs::EVENT_LIBRARY</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_LIBRARY&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$Sys::Guestfs::EVENT_TRACE</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_TRACE&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$Sys::Guestfs::EVENT_ENTER</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_ENTER&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$Sys::Guestfs::EVENT_LIBVIRT_AUTH</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_LIBVIRT_AUTH&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$Sys::Guestfs::EVENT_WARNING</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_WARNING&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$Sys::Guestfs::EVENT_ALL</p>

<p style="margin-left:17%;">See &quot;
<small>GUESTFS_EVENT_ALL&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$event_handle =
$g&minus;&gt;set_event_callback (\&amp;cb,
$event_bitmask);</p>

<p style="margin-left:17%;">Register
<tt>&quot;cb&quot;</tt> as a callback function for all of
the events in <tt>$event_bitmask</tt> (one or more
<tt>&quot;$Sys::Guestfs::EVENT_*&quot;</tt> flags logically
or&rsquo;d together).</p>

<p style="margin-left:17%; margin-top: 1em">This function
returns an event handle which can be used to delete the
callback using
<tt>&quot;delete_event_callback&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The callback
function receives 4 parameters:</p>

<pre style="margin-left:17%; margin-top: 1em"> &amp;cb ($event, $event_handle, $buf, $array)</pre>


<p style="margin-left:17%;">$event</p>

<p style="margin-left:23%;">The event which happened (equal
to one of <tt>&quot;$Sys::Guestfs::EVENT_*&quot;</tt>).</p>

<p style="margin-left:17%;">$event_handle</p>

<p style="margin-left:23%;">The event handle.</p>

<p style="margin-left:17%;">$buf</p>

<p style="margin-left:23%;">For some event types, this is a
message buffer (ie. a string).</p>

<p style="margin-left:17%;">$array</p>

<p style="margin-left:23%;">For some event types (notably
progress events), this is an array of integers.</p>

<p style="margin-left:17%; margin-top: 1em">You should
carefully read the documentation for
&quot;guestfs_set_event_callback&quot; in <i>guestfs</i>(3)
before using this function.</p>


<p style="margin-left:11%;">$g&minus;&gt;delete_event_callback
($event_handle);</p>

<p style="margin-left:17%;">This removes the callback which
was previously registered using
<tt>&quot;set_event_callback&quot;</tt>.</p>

<p style="margin-left:11%;">$str =
Sys::Guestfs::event_to_string ($events);</p>

<p style="margin-left:17%;"><tt>$events</tt> is either a
single event or a bitmask of events. This returns a
printable string, useful for debugging.</p>

<p style="margin-left:17%; margin-top: 1em">Note that this
is a class function, not a method.</p>

<p style="margin-left:11%;">$errnum =
$g&minus;&gt;last_errno ();</p>

<p style="margin-left:17%;">This returns the last error
number (errno) that happened on the handle <tt>$g</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If successful,
an errno integer not equal to zero is returned.</p>

<p style="margin-left:17%; margin-top: 1em">If no error
number is available, this returns 0. See
&quot;guestfs_last_errno&quot; in <i>guestfs</i>(3) for more
details of why this can happen.</p>

<p style="margin-left:17%; margin-top: 1em">You can use the
standard Perl module <i>Errno</i>(3) to compare the numeric
error returned from this call with symbolic errnos:</p>

<pre style="margin-left:17%; margin-top: 1em"> $g&minus;&gt;mkdir (&quot;/foo&quot;);
 if ($g&minus;&gt;last_errno() == Errno::EEXIST()) {
   # mkdir failed because the directory exists already.
 }</pre>



<p style="margin-left:11%;">$g&minus;&gt;acl_delete_def_file
($dir);</p>

<p style="margin-left:17%;">This function deletes the
default <small>POSIX</small> Access Control List (
<small>ACL</small> ) attached to directory
<tt>&quot;dir&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;acl&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$acl =
$g&minus;&gt;acl_get_file ($path, $acltype);</p>

<p style="margin-left:17%;">This function returns the
<small>POSIX</small> Access Control List (
<small>ACL</small> ) attached to <tt>&quot;path&quot;</tt>.
The <small>ACL</small> is returned in &quot;long text
form&quot; (see <i>acl</i>(5)).</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;acltype&quot;</tt> parameter may be: <br>
&quot;access&quot;</p>

<p style="margin-left:23%;">Return the ordinary (access)
<small>ACL</small> for any file, directory or other
filesystem object.</p>

<p style="margin-left:17%;">&quot;default&quot;</p>

<p style="margin-left:23%;">Return the default
<small>ACL.</small> Normally this only makes sense if
<tt>&quot;path&quot;</tt> is a directory.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;acl&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;acl_set_file
($path, $acltype, $acl);</p>

<p style="margin-left:17%;">This function sets the
<small>POSIX</small> Access Control List (
<small>ACL</small> ) attached to
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;acltype&quot;</tt> parameter may be: <br>
&quot;access&quot;</p>

<p style="margin-left:23%;">Set the ordinary (access)
<small>ACL</small> for any file, directory or other
filesystem object.</p>

<p style="margin-left:17%;">&quot;default&quot;</p>

<p style="margin-left:23%;">Set the default
<small>ACL.</small> Normally this only makes sense if
<tt>&quot;path&quot;</tt> is a directory.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;acl&quot;</tt> parameter is the new
<small>ACL</small> in either &quot;long text form&quot; or
&quot;short text form&quot; (see <i>acl</i>(5)). The new
<small>ACL</small> completely replaces any previous
<small>ACL</small> on the file. The <small>ACL</small> must
contain the full Unix permissions (eg.
<tt>&quot;u::rwx,g::rx,o::rx&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">If you are
specifying individual users or groups, then the mask field
is also required (eg. <tt>&quot;m::rwx&quot;</tt>), followed
by the <tt>&quot;u:</tt><i>ID</i><tt>:...&quot;</tt> and/or
<tt>&quot;g:</tt><i>ID</i><tt>:...&quot;</tt> field(s). A
full <small>ACL</small> string might therefore look like
this:</p>

<pre style="margin-left:17%; margin-top: 1em"> u::rwx,g::rwx,o::rwx,m::rwx,u:500:rwx,g:500:rwx
 \ Unix permissions / \mask/ \      ACL        /</pre>


<p style="margin-left:17%; margin-top: 1em">You should use
numeric UIDs and GIDs. To map usernames and groupnames to
the correct numeric <small>ID</small> in the context of the
guest, use the Augeas functions (see
<tt>&quot;$g&minus;&gt;aug_init&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;acl&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;add_cdrom
($filename);</p>

<p style="margin-left:17%;">This function adds a virtual
CD-ROM disk image to the guest.</p>

<p style="margin-left:17%; margin-top: 1em">The image is
added as read-only drive, so this function is equivalent of
<tt>&quot;$g&minus;&gt;add_drive_ro&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;add_drive_ro&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$nrdisks =
$g&minus;&gt;add_domain ($dom [, libvirturi =&gt;
$libvirturi] [, <br>
readonly =&gt; $readonly] [, iface =&gt; $iface] [, live
=&gt; $live] [, <br>
allowuuid =&gt; $allowuuid] [, readonlydisk =&gt;
$readonlydisk] [, cachemode <br>
=&gt; $cachemode] [, discard =&gt; $discard] [, copyonread
=&gt; $copyonread]);</p>

<p style="margin-left:17%;">This function adds the disk(s)
attached to the named libvirt domain
<tt>&quot;dom&quot;</tt>. It works by connecting to libvirt,
requesting the domain and domain <small>XML</small> from
libvirt, parsing it for disks, and calling
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt> on each
one.</p>

<p style="margin-left:17%; margin-top: 1em">The number of
disks added is returned. This operation is atomic: if an
error is returned, then no disks are added.</p>

<p style="margin-left:17%; margin-top: 1em">This function
does some minimal checks to make sure the libvirt domain is
not running (unless <tt>&quot;readonly&quot;</tt> is true).
In a future version we will try to acquire the libvirt lock
on each disk.</p>

<p style="margin-left:17%; margin-top: 1em">Disks must be
accessible locally. This often means that adding disks from
a remote libvirt connection (see
&lt;http://libvirt.org/remote.html&gt;) will fail unless
those disks are accessible via the same device path locally
too.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;libvirturi&quot;</tt> parameter sets the libvirt
<small>URI</small> (see
&lt;http://libvirt.org/uri.html&gt;). If this is not set
then we connect to the default libvirt <small>URI</small>
(or one set through an environment variable, see the libvirt
documentation for full details).</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;live&quot;</tt> flag controls whether this call
will try to connect to a running virtual machine
<tt>&quot;guestfsd&quot;</tt> process if it sees a suitable
&lt;channel&gt; element in the libvirt <small>XML</small>
definition. The default (if the flag is omitted) is never to
try. See &quot; <small>ATTACHING TO RUNNING
DAEMONS&quot;</small> in <i>guestfs</i>(3) for more
information.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<tt>&quot;allowuuid&quot;</tt> flag is true (default is
false) then a <small>UUID</small> <i>may</i> be passed
instead of the domain name. The <tt>&quot;dom&quot;</tt>
string is treated as a <small>UUID</small> first and looked
up, and if that lookup fails then we treat
<tt>&quot;dom&quot;</tt> as a name as usual.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;readonlydisk&quot;</tt> parameter controls what we
do for disks which are marked &lt;readonly/&gt; in the
libvirt <small>XML.</small> Possible values are: <br>
readonlydisk = &quot;error&quot;</p>

<p style="margin-left:23%;">If
<tt>&quot;readonly&quot;</tt> is false:</p>

<p style="margin-left:23%; margin-top: 1em">The whole call
is aborted with an error if any disk with the
&lt;readonly/&gt; flag is found.</p>

<p style="margin-left:23%; margin-top: 1em">If
<tt>&quot;readonly&quot;</tt> is true:</p>

<p style="margin-left:23%; margin-top: 1em">Disks with the
&lt;readonly/&gt; flag are added read-only.</p>

<p style="margin-left:17%;">readonlydisk =
&quot;read&quot;</p>

<p style="margin-left:23%;">If
<tt>&quot;readonly&quot;</tt> is false:</p>

<p style="margin-left:23%; margin-top: 1em">Disks with the
&lt;readonly/&gt; flag are added read-only. Other disks are
added read/write.</p>

<p style="margin-left:23%; margin-top: 1em">If
<tt>&quot;readonly&quot;</tt> is true:</p>

<p style="margin-left:23%; margin-top: 1em">Disks with the
&lt;readonly/&gt; flag are added read-only.</p>

<p style="margin-left:17%;">readonlydisk =
&quot;write&quot; (default)</p>

<p style="margin-left:23%;">If
<tt>&quot;readonly&quot;</tt> is false:</p>

<p style="margin-left:23%; margin-top: 1em">Disks with the
&lt;readonly/&gt; flag are added read/write.</p>

<p style="margin-left:23%; margin-top: 1em">If
<tt>&quot;readonly&quot;</tt> is true:</p>

<p style="margin-left:23%; margin-top: 1em">Disks with the
&lt;readonly/&gt; flag are added read-only.</p>

<p style="margin-left:17%;">readonlydisk =
&quot;ignore&quot;</p>

<p style="margin-left:23%;">If
<tt>&quot;readonly&quot;</tt> is true or false:</p>

<p style="margin-left:23%; margin-top: 1em">Disks with the
&lt;readonly/&gt; flag are skipped.</p>

<p style="margin-left:17%; margin-top: 1em">The other
optional parameters are passed directly through to
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;add_drive
($filename [, readonly =&gt; $readonly] [, format =&gt; <br>
$format] [, iface =&gt; $iface] [, name =&gt; $name] [,
label =&gt; $label] [, <br>
protocol =&gt; $protocol] [, server =&gt; $server] [,
username =&gt; $username] <br>
[, secret =&gt; $secret] [, cachemode =&gt; $cachemode] [,
discard =&gt; <br>
$discard] [, copyonread =&gt; $copyonread]);</p>

<p style="margin-left:17%;">This function adds a disk image
called <i>filename</i> to the handle. <i>filename</i> may be
a regular host file or a host device.</p>

<p style="margin-left:17%; margin-top: 1em">When this
function is called before
<tt>&quot;$g&minus;&gt;launch&quot;</tt> (the usual case)
then the first time you call this function, the disk appears
in the <small>API</small> as <i>/dev/sda</i>, the second
time as <i>/dev/sdb</i>, and so on.</p>

<p style="margin-left:17%; margin-top: 1em">In libguestfs X
1.20 you can also call this function after launch (with some
restrictions). This is called &quot;hotplugging&quot;. When
hotplugging, you must specify a <tt>&quot;label&quot;</tt>
so that the new disk gets a predictable name. For more
information see &quot; <small>HOTPLUGGING&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em">You don&rsquo;t
necessarily need to be root when using libguestfs. However
you obviously do need sufficient permissions to access the
filename for whatever operations you want to perform (ie.
read access if you just want to read the image or write
access if you want to modify the image).</p>

<p style="margin-left:17%; margin-top: 1em">This call
checks that <i>filename</i> exists.</p>


<p style="margin-left:17%; margin-top: 1em"><i>filename</i>
may be the special string <tt>&quot;/dev/null&quot;</tt>.
See &quot; <small>NULL DISKS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments are: <br>
&quot;readonly&quot;</p>

<p style="margin-left:23%;">If true then the image is
treated as read-only. Writes are still allowed, but they are
stored in a temporary snapshot overlay which is discarded at
the end. The disk that you add is not modified.</p>

<p style="margin-left:17%;">&quot;format&quot;</p>

<p style="margin-left:23%;">This forces the image format.
If you omit this (or use
<tt>&quot;$g&minus;&gt;add_drive&quot;</tt> or
<tt>&quot;$g&minus;&gt;add_drive_ro&quot;</tt>) then the
format is automatically detected. Possible formats include
<tt>&quot;raw&quot;</tt> and <tt>&quot;qcow2&quot;</tt>.</p>

<p style="margin-left:23%; margin-top: 1em">Automatic
detection of the format opens you up to a potential security
hole when dealing with untrusted raw-format images. See
<small>CVE&minus;2010&minus;3851</small> and RHBZ#642934.
Specifying the format closes this security hole.</p>

<p style="margin-left:17%;">&quot;iface&quot;</p>

<p style="margin-left:23%;">This rarely-used option lets
you emulate the behaviour of the deprecated
<tt>&quot;$g&minus;&gt;add_drive_with_if&quot;</tt> call
(q.v.)</p>

<p style="margin-left:17%;">&quot;name&quot;</p>

<p style="margin-left:23%;">The name the drive had in the
original guest, e.g. <i>/dev/sdb</i>. This is used as a hint
to the guest inspection process if it is available.</p>

<p style="margin-left:17%;">&quot;label&quot;</p>

<p style="margin-left:23%;">Give the disk a label. The
label should be a unique, short string using <i>only</i>
<small>ASCII</small> characters
<tt>&quot;[a&minus;zA&minus;Z]&quot;</tt>. As well as its
usual name in the <small>API</small> (such as
<i>/dev/sda</i>), the drive will also be named
<i>/dev/disk/guestfs/label</i>.</p>

<p style="margin-left:23%; margin-top: 1em">See &quot;
<small>DISK LABELS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%;">&quot;protocol&quot;</p>

<p style="margin-left:23%;">The optional protocol argument
can be used to select an alternate source protocol.</p>

<p style="margin-left:23%; margin-top: 1em">See also:
&quot; <small>REMOTE STORAGE&quot;</small> in
<i>guestfs</i>(3). <br>
&quot;protocol = &quot;file&quot;&quot;</p>

<p style="margin-left:29%;"><i>filename</i> is interpreted
as a local file or device. This is the default if the
optional protocol parameter is omitted.</p>

<p style="margin-left:23%;">&quot;protocol =
&quot;nbd&quot;&quot;</p>

<p style="margin-left:29%;">Connect to the Network Block
Device server. The <tt>&quot;server&quot;</tt> parameter
must also be supplied &minus; see below.</p>

<p style="margin-left:29%; margin-top: 1em">See also:
&quot; <small>NETWORK BLOCK DEVICE&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:23%;">&quot;protocol =
&quot;rbd&quot;&quot;</p>

<p style="margin-left:29%;">Connect to the Ceph
(librbd/RBD) server. The <tt>&quot;server&quot;</tt>
parameter must also be supplied &minus; see below. The
<tt>&quot;username&quot;</tt> parameter may be supplied. See
below. The <tt>&quot;secret&quot;</tt> parameter may be
supplied. See below.</p>

<p style="margin-left:29%; margin-top: 1em">See also:
&quot; <small>CEPH&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%;">&quot;server&quot;</p>

<p style="margin-left:23%;">For protocols which require
access to a remote server, this is a list of server(s).</p>

<pre style="margin-left:23%; margin-top: 1em"> Protocol       Number of servers required
 &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;       &minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
 file           List must be empty or param not used at all
 nbd            Exactly one
 rbd            Zero or more</pre>


<p style="margin-left:23%; margin-top: 1em">Each list
element is a string specifying a server. The string must be
in one of the following formats:</p>

<pre style="margin-left:23%; margin-top: 1em"> hostname
 hostname:port
 tcp:hostname
 tcp:hostname:port
 unix:/path/to/socket</pre>


<p style="margin-left:23%; margin-top: 1em">If the port
number is omitted, then the standard port number for the
protocol is used (see <i>/etc/services</i>).</p>

<p style="margin-left:17%;">&quot;username&quot;</p>

<p style="margin-left:23%;">For the
<tt>&quot;rbd&quot;</tt> protocol, this specifies the remote
username.</p>

<p style="margin-left:23%; margin-top: 1em">If not given,
then no authentication is attempted for ceph. But note this
sometimes may give unexpected results, for example if using
the libvirt backend and if the libvirt backend is configured
to start the qemu appliance as a special user such as
<tt>&quot;qemu.qemu&quot;</tt>. If in doubt, specify the
remote username you want.</p>

<p style="margin-left:17%;">&quot;secret&quot;</p>

<p style="margin-left:23%;">For the
<tt>&quot;rbd&quot;</tt> protocol only, this specifies the
&rsquo;secret&rsquo; to use when connecting to the remote
device. It must be base64 encoded.</p>

<p style="margin-left:23%; margin-top: 1em">If not given,
then a secret matching the given username will be looked up
in the default keychain locations, or if no username is
given, then no authentication will be used.</p>

<p style="margin-left:17%;">&quot;cachemode&quot;</p>

<p style="margin-left:23%;">Choose whether or not
libguestfs will obey sync operations (safe but slow) or not
(unsafe but fast). The possible values for this string are:
<br>
&quot;cachemode = &quot;writeback&quot;&quot;</p>

<p style="margin-left:29%;">This is the default.</p>

<p style="margin-left:29%; margin-top: 1em">Write
operations in the <small>API</small> do not return until a
<i>write</i>(2) call has completed in the host [but note
this does not imply that anything gets written to disk].</p>

<p style="margin-left:29%; margin-top: 1em">Sync operations
in the <small>API,</small> including implicit syncs caused
by filesystem journalling, will not return until an
<i>fdatasync</i>(2) call has completed in the host,
indicating that data has been committed to disk.</p>

<p style="margin-left:23%;">&quot;cachemode =
&quot;unsafe&quot;&quot;</p>

<p style="margin-left:29%;">In this mode, there are no
guarantees. Libguestfs may cache anything and ignore sync
requests. This is suitable only for scratch or temporary
disks.</p>

<p style="margin-left:17%;">&quot;discard&quot;</p>

<p style="margin-left:23%;">Enable or disable discard
(a.k.a. trim or unmap) support on this drive. If enabled,
operations such as <tt>&quot;$g&minus;&gt;fstrim&quot;</tt>
will be able to discard / make thin / punch holes in the
underlying host file or device.</p>

<p style="margin-left:23%; margin-top: 1em">Possible
discard settings are: <br>
&quot;discard = &quot;disable&quot;&quot;</p>

<p style="margin-left:29%;">Disable discard support. This
is the default.</p>

<p style="margin-left:23%;">&quot;discard =
&quot;enable&quot;&quot;</p>

<p style="margin-left:29%;">Enable discard support. Fail if
discard is not possible.</p>

<p style="margin-left:23%;">&quot;discard =
&quot;besteffort&quot;&quot;</p>

<p style="margin-left:29%;">Enable discard support if
possible, but don&rsquo;t fail if it is not supported.</p>

<p style="margin-left:29%; margin-top: 1em">Since not all
backends and not all underlying systems support discard,
this is a good choice if you want to use discard if
possible, but don&rsquo;t mind if it doesn&rsquo;t work.</p>

<p style="margin-left:17%;">&quot;copyonread&quot;</p>

<p style="margin-left:23%;">The boolean parameter
<tt>&quot;copyonread&quot;</tt> enables copy-on-read
support. This only affects disk formats which have backing
files, and causes reads to be stored in the overlay layer,
speeding up multiple reads of the same area of disk.</p>

<p style="margin-left:23%; margin-top: 1em">The default is
false.</p>

<p style="margin-left:11%;">$g&minus;&gt;add_drive_opts
($filename [, readonly =&gt; $readonly] [, format =&gt; <br>
$format] [, iface =&gt; $iface] [, name =&gt; $name] [,
label =&gt; $label] [, <br>
protocol =&gt; $protocol] [, server =&gt; $server] [,
username =&gt; $username] <br>
[, secret =&gt; $secret] [, cachemode =&gt; $cachemode] [,
discard =&gt; <br>
$discard] [, copyonread =&gt; $copyonread]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;add_drive&quot;.</p>

<p style="margin-left:11%;">$g&minus;&gt;add_drive_ro
($filename);</p>

<p style="margin-left:17%;">This function is the equivalent
of calling <tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>
with the optional parameter
<tt>&quot;GUESTFS_ADD_DRIVE_OPTS_READONLY&quot;</tt> set to
1, so the disk is added read-only, with the format being
detected automatically.</p>


<p style="margin-left:11%;">$g&minus;&gt;add_drive_ro_with_if
($filename, $iface);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;add_drive_ro&quot;</tt> but it allows
you to specify the <small>QEMU</small> interface emulation
to use at run time.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;add_drive&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;add_drive_scratch
($size [, name =&gt; $name] [, label =&gt; $label]);</p>

<p style="margin-left:17%;">This command adds a temporary
scratch drive to the handle. The <tt>&quot;size&quot;</tt>
parameter is the virtual size (in bytes). The scratch drive
is blank initially (all reads return zeroes until you start
writing to it). The drive is deleted when the handle is
closed.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments <tt>&quot;name&quot;</tt> and
<tt>&quot;label&quot;</tt> are passed through to
<tt>&quot;$g&minus;&gt;add_drive&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;add_drive_with_if
($filename, $iface);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;add_drive&quot;</tt> but it allows
you to specify the <small>QEMU</small> interface emulation
to use at run time.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;add_drive&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$nrdisks =
$g&minus;&gt;add_libvirt_dom ($dom [, readonly =&gt;
$readonly] [, iface <br>
=&gt; $iface] [, live =&gt; $live] [, readonlydisk =&gt;
$readonlydisk] [, <br>
cachemode =&gt; $cachemode] [, discard =&gt; $discard] [,
copyonread =&gt; <br>
$copyonread]);</p>

<p style="margin-left:17%;">This function adds the disk(s)
attached to the libvirt domain <tt>&quot;dom&quot;</tt>. It
works by requesting the domain <small>XML</small> from
libvirt, parsing it for disks, and calling
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt> on each
one.</p>

<p style="margin-left:17%; margin-top: 1em">In the C
<small>API</small> we declare <tt>&quot;void
*dom&quot;</tt>, but really it has type
<tt>&quot;virDomainPtr dom&quot;</tt>. This is so we
don&rsquo;t need &lt;libvirt.h&gt;.</p>

<p style="margin-left:17%; margin-top: 1em">The number of
disks added is returned. This operation is atomic: if an
error is returned, then no disks are added.</p>

<p style="margin-left:17%; margin-top: 1em">This function
does some minimal checks to make sure the libvirt domain is
not running (unless <tt>&quot;readonly&quot;</tt> is true).
In a future version we will try to acquire the libvirt lock
on each disk.</p>

<p style="margin-left:17%; margin-top: 1em">Disks must be
accessible locally. This often means that adding disks from
a remote libvirt connection (see
&lt;http://libvirt.org/remote.html&gt;) will fail unless
those disks are accessible via the same device path locally
too.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;live&quot;</tt> flag controls whether this call
will try to connect to a running virtual machine
<tt>&quot;guestfsd&quot;</tt> process if it sees a suitable
&lt;channel&gt; element in the libvirt <small>XML</small>
definition. The default (if the flag is omitted) is never to
try. See &quot; <small>ATTACHING TO RUNNING
DAEMONS&quot;</small> in <i>guestfs</i>(3) for more
information.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;readonlydisk&quot;</tt> parameter controls what we
do for disks which are marked &lt;readonly/&gt; in the
libvirt <small>XML.</small> See
<tt>&quot;$g&minus;&gt;add_domain&quot;</tt> for possible
values.</p>

<p style="margin-left:17%; margin-top: 1em">The other
optional parameters are passed directly through to
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_clear
($augpath);</p>

<p style="margin-left:17%;">Set the value associated with
<tt>&quot;path&quot;</tt> to <tt>&quot;NULL&quot;</tt>. This
is the same as the <i>augtool</i>(1)
<tt>&quot;clear&quot;</tt> command.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_close ();</p>

<p style="margin-left:17%;">Close the current Augeas handle
and free up any resources used by it. After calling this,
you have to call <tt>&quot;$g&minus;&gt;aug_init&quot;</tt>
again before you can use any other Augeas functions.</p>

<p style="margin-left:11%;">%nrnodescreated =
$g&minus;&gt;aug_defnode ($name, $expr, $val);</p>

<p style="margin-left:17%;">Defines a variable
<tt>&quot;name&quot;</tt> whose value is the result of
evaluating <tt>&quot;expr&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>&quot;expr&quot;</tt> evaluates to an empty nodeset, a
node is created, equivalent to calling
<tt>&quot;$g&minus;&gt;aug_set&quot; &quot;expr&quot;</tt>,
<tt>&quot;value&quot;</tt>. <tt>&quot;name&quot;</tt> will
be the nodeset containing that single node.</p>

<p style="margin-left:17%; margin-top: 1em">On success this
returns a pair containing the number of nodes in the
nodeset, and a boolean flag if a node was created.</p>

<p style="margin-left:11%;">$nrnodes =
$g&minus;&gt;aug_defvar ($name, $expr);</p>

<p style="margin-left:17%;">Defines an Augeas variable
<tt>&quot;name&quot;</tt> whose value is the result of
evaluating <tt>&quot;expr&quot;</tt>. If
<tt>&quot;expr&quot;</tt> is <small>NULL,</small> then
<tt>&quot;name&quot;</tt> is undefined.</p>

<p style="margin-left:17%; margin-top: 1em">On success this
returns the number of nodes in <tt>&quot;expr&quot;</tt>, or
<tt>0</tt> if <tt>&quot;expr&quot;</tt> evaluates to
something which is not a nodeset.</p>

<p style="margin-left:11%;">$val = $g&minus;&gt;aug_get
($augpath);</p>

<p style="margin-left:17%;">Look up the value associated
with <tt>&quot;path&quot;</tt>. If <tt>&quot;path&quot;</tt>
matches exactly one node, the <tt>&quot;value&quot;</tt> is
returned.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_init ($root,
$flags);</p>

<p style="margin-left:17%;">Create a new Augeas handle for
editing configuration files. If there was any previous
Augeas handle associated with this guestfs session, then it
is closed.</p>

<p style="margin-left:17%; margin-top: 1em">You must call
this before using any other
<tt>&quot;$g&minus;&gt;aug_*&quot;</tt> commands.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;root&quot;</tt>
is the filesystem root. <tt>&quot;root&quot;</tt> must not
be <small>NULL,</small> use <i>/</i> instead.</p>

<p style="margin-left:17%; margin-top: 1em">The flags are
the same as the flags defined in &lt;augeas.h&gt;, the
logical <i>or</i> of the following integers: <br>
&quot;AUG_SAVE_BACKUP&quot; = 1</p>

<p style="margin-left:23%;">Keep the original file with a
<tt>&quot;.augsave&quot;</tt> extension.</p>

<p style="margin-left:17%;">&quot;AUG_SAVE_NEWFILE&quot; =
2</p>

<p style="margin-left:23%;">Save changes into a file with
extension <tt>&quot;.augnew&quot;</tt>, and do not overwrite
original. Overrides
<tt>&quot;AUG_SAVE_BACKUP&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;AUG_TYPE_CHECK&quot; =
4</p>

<p style="margin-left:23%;">Typecheck lenses.</p>

<p style="margin-left:23%; margin-top: 1em">This option is
only useful when debugging Augeas lenses. Use of this option
may require additional memory for the libguestfs appliance.
You may need to set the
<tt>&quot;LIBGUESTFS_MEMSIZE&quot;</tt> environment variable
or call <tt>&quot;$g&minus;&gt;set_memsize&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;AUG_NO_STDINC&quot; =
8</p>

<p style="margin-left:23%;">Do not use standard load path
for modules.</p>

<p style="margin-left:17%;">&quot;AUG_SAVE_NOOP&quot; =
16</p>

<p style="margin-left:23%;">Make save a no-op, just record
what would have been changed.</p>

<p style="margin-left:17%;">&quot;AUG_NO_LOAD&quot; =
32</p>

<p style="margin-left:23%;">Do not load the tree in
<tt>&quot;$g&minus;&gt;aug_init&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">To close the
handle, you can call
<tt>&quot;$g&minus;&gt;aug_close&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">To find out
more about Augeas, see &lt;http://augeas.net/&gt;.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_insert
($augpath, $label, $before);</p>

<p style="margin-left:17%;">Create a new sibling
<tt>&quot;label&quot;</tt> for <tt>&quot;path&quot;</tt>,
inserting it into the tree before or after
<tt>&quot;path&quot;</tt> (depending on the boolean flag
<tt>&quot;before&quot;</tt>).</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;path&quot;</tt>
must match exactly one existing node in the tree, and
<tt>&quot;label&quot;</tt> must be a label, ie. not contain
<i>/</i>, <tt>&quot;*&quot;</tt> or end with a bracketed
index <tt>&quot;[N]&quot;</tt>.</p>

<p style="margin-left:11%;">$label = $g&minus;&gt;aug_label
($augpath);</p>

<p style="margin-left:17%;">The label (name of the last
element) of the Augeas path expression
<tt>&quot;augpath&quot;</tt> is returned.
<tt>&quot;augpath&quot;</tt> must match exactly one node,
else this function returns an error.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_load ();</p>

<p style="margin-left:17%;">Load files into the tree.</p>

<p style="margin-left:17%; margin-top: 1em">See
<tt>&quot;aug_load&quot;</tt> in the Augeas documentation
for the full gory details.</p>

<p style="margin-left:11%;">@matches = $g&minus;&gt;aug_ls
($augpath);</p>

<p style="margin-left:17%;">This is just a shortcut for
listing <tt>&quot;$g&minus;&gt;aug_match&quot;
&quot;path/*&quot;</tt> and sorting the resulting nodes into
alphabetical order.</p>

<p style="margin-left:11%;">@matches =
$g&minus;&gt;aug_match ($augpath);</p>

<p style="margin-left:17%;">Returns a list of paths which
match the path expression <tt>&quot;path&quot;</tt>. The
returned paths are sufficiently qualified so that they match
exactly one node in the current tree.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_mv ($src,
$dest);</p>

<p style="margin-left:17%;">Move the node
<tt>&quot;src&quot;</tt> to <tt>&quot;dest&quot;</tt>.
<tt>&quot;src&quot;</tt> must match exactly one node.
<tt>&quot;dest&quot;</tt> is overwritten if it exists.</p>

<p style="margin-left:11%;">$nrnodes = $g&minus;&gt;aug_rm
($augpath);</p>

<p style="margin-left:17%;">Remove
<tt>&quot;path&quot;</tt> and all of its children.</p>

<p style="margin-left:17%; margin-top: 1em">On success this
returns the number of entries which were removed.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_save ();</p>

<p style="margin-left:17%;">This writes all pending changes
to disk.</p>

<p style="margin-left:17%; margin-top: 1em">The flags which
were passed to <tt>&quot;$g&minus;&gt;aug_init&quot;</tt>
affect exactly how files are saved.</p>

<p style="margin-left:11%;">$g&minus;&gt;aug_set ($augpath,
$val);</p>

<p style="margin-left:17%;">Set the value associated with
<tt>&quot;path&quot;</tt> to <tt>&quot;val&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">In the Augeas
<small>API,</small> it is possible to clear a node by
setting the value to <small>NULL.</small> Due to an
oversight in the libguestfs <small>API</small> you cannot do
that with this call. Instead you must use the
<tt>&quot;$g&minus;&gt;aug_clear&quot;</tt> call.</p>

<p style="margin-left:11%;">$nodes = $g&minus;&gt;aug_setm
($base, $sub, $val);</p>

<p style="margin-left:17%;">Change multiple Augeas nodes in
a single operation. <tt>&quot;base&quot;</tt> is an
expression matching multiple nodes. <tt>&quot;sub&quot;</tt>
is a path expression relative to <tt>&quot;base&quot;</tt>.
All nodes matching <tt>&quot;base&quot;</tt> are found, and
then for each node, <tt>&quot;sub&quot;</tt> is changed to
<tt>&quot;val&quot;</tt>. <tt>&quot;sub&quot;</tt> may also
be <tt>&quot;NULL&quot;</tt> in which case the
<tt>&quot;base&quot;</tt> nodes are modified.</p>

<p style="margin-left:17%; margin-top: 1em">This returns
the number of nodes modified.</p>

<p style="margin-left:11%;">$g&minus;&gt;available
(\@groups);</p>

<p style="margin-left:17%;">This command is used to check
the availability of some groups of functionality in the
appliance, which not all builds of the libguestfs appliance
will be able to provide.</p>

<p style="margin-left:17%; margin-top: 1em">The libguestfs
groups, and the functions that those groups correspond to,
are listed in &quot; <small>AVAILABILITY&quot;</small> in
<i>guestfs</i>(3). You can also fetch this list at runtime
by calling
<tt>&quot;$g&minus;&gt;available_all_groups&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The argument
<tt>&quot;groups&quot;</tt> is a list of group names, eg:
<tt>&quot;[&quot;inotify&quot;,
&quot;augeas&quot;]&quot;</tt> would check for the
availability of the Linux inotify functions and Augeas
(configuration file editing) functions.</p>

<p style="margin-left:17%; margin-top: 1em">The command
returns no error if <i>all</i> requested groups are
available.</p>

<p style="margin-left:17%; margin-top: 1em">It fails with
an error if one or more of the requested groups is
unavailable in the appliance.</p>

<p style="margin-left:17%; margin-top: 1em">If an unknown
group name is included in the list of groups then an error
is always returned.</p>


<p style="margin-left:17%; margin-top: 1em"><i>Notes:</i></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p><tt>&quot;$g&minus;&gt;feature_available&quot;</tt> is
the same as this call, but with a slightly simpler to use
<small>API:</small> that call returns a boolean true/false
instead of throwing an error.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>You must call <tt>&quot;$g&minus;&gt;launch&quot;</tt>
before calling this function.</p></td></tr>
</table>

<p style="margin-left:23%; margin-top: 1em">The reason is
because we don&rsquo;t know what groups are supported by the
appliance/daemon until it is running and can be queried.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p style="margin-top: 1em">If a group of functions is
available, this does not necessarily mean that they will
work. You still have to check for errors when calling
individual <small>API</small> functions even if they are
available.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>It is usually the job of distro packagers to build
complete functionality into the libguestfs appliance.
Upstream libguestfs, if built from source with all
requirements satisfied, will support everything.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>This call was added in version <tt>1.0.80</tt>. In
previous versions of libguestfs all you could do would be to
speculatively execute a command to find out if the daemon
implemented it. See also
<tt>&quot;$g&minus;&gt;version&quot;</tt>.</p> </td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;filesystem_available&quot;</tt>.</p>

<p style="margin-left:11%;">@groups =
$g&minus;&gt;available_all_groups ();</p>

<p style="margin-left:17%;">This command returns a list of
all optional groups that this daemon knows about. Note this
returns both supported and unsupported groups. To find out
which ones the daemon can actually support you have to call
<tt>&quot;$g&minus;&gt;available&quot;</tt> /
<tt>&quot;$g&minus;&gt;feature_available&quot;</tt> on each
member of the returned list.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;available&quot;</tt>,
<tt>&quot;$g&minus;&gt;feature_available&quot;</tt> and
&quot; <small>AVAILABILITY&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;base64_in
($base64file, $filename);</p>

<p style="margin-left:17%;">This command uploads
base64&minus;encoded data from
<tt>&quot;base64file&quot;</tt> to <i>filename</i>.</p>

<p style="margin-left:11%;">$g&minus;&gt;base64_out
($filename, $base64file);</p>

<p style="margin-left:17%;">This command downloads the
contents of <i>filename</i>, writing it out to local file
<tt>&quot;base64file&quot;</tt> encoded as base64.</p>

<p style="margin-left:11%;">$g&minus;&gt;blkdiscard
($device);</p>

<p style="margin-left:17%;">This discards all blocks on the
block device <tt>&quot;device&quot;</tt>, giving the free
space back to the host.</p>

<p style="margin-left:17%; margin-top: 1em">This operation
requires support in libguestfs, the host filesystem, qemu
and the host kernel. If this support isn&rsquo;t present it
may give an error or even appear to run but do nothing. You
must also set the <tt>&quot;discard&quot;</tt> attribute on
the underlying drive (see
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;blkdiscard&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$zeroes =
$g&minus;&gt;blkdiscardzeroes ($device);</p>

<p style="margin-left:17%;">This call returns true if
blocks on <tt>&quot;device&quot;</tt> that have been
discarded by a call to
<tt>&quot;$g&minus;&gt;blkdiscard&quot;</tt> are returned as
blocks of zero bytes when read the next time.</p>

<p style="margin-left:17%; margin-top: 1em">If it returns
false, then it may be that discarded blocks are read as
stale or random data.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature
<tt>&quot;blkdiscardzeroes&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">%info = $g&minus;&gt;blkid
($device);</p>

<p style="margin-left:17%;">This command returns block
device attributes for <tt>&quot;device&quot;</tt>. The
following fields are usually present in the returned hash.
Other fields may also be present. <br>
&quot;UUID&quot;</p>

<p style="margin-left:23%;">The uuid of this device.</p>

<p style="margin-left:17%;">&quot;LABEL&quot;</p>

<p style="margin-left:23%;">The label of this device.</p>

<p style="margin-left:17%;">&quot;VERSION&quot;</p>

<p style="margin-left:23%;">The version of blkid
command.</p>

<p style="margin-left:17%;">&quot;TYPE&quot;</p>

<p style="margin-left:23%;">The filesystem type or
<small>RAID</small> of this device.</p>

<p style="margin-left:17%;">&quot;USAGE&quot;</p>

<p style="margin-left:23%;">The usage of this device, for
example <tt>&quot;filesystem&quot;</tt> or
<tt>&quot;raid&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;blockdev_flushbufs
($device);</p>

<p style="margin-left:17%;">This tells the kernel to flush
internal buffers associated with
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$blocksize =
$g&minus;&gt;blockdev_getbsz ($device);</p>

<p style="margin-left:17%;">This returns the block size of
a device.</p>

<p style="margin-left:17%; margin-top: 1em">Note: this is
different from both <i>size in blocks</i> and <i>filesystem
block size</i>. Also this setting is not really used by
anything. You should probably not use it for anything.
Filesystems have their own idea about what block size to
choose.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$ro =
$g&minus;&gt;blockdev_getro ($device);</p>

<p style="margin-left:17%;">Returns a boolean indicating if
the block device is read-only (true if read-only, false if
not).</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$sizeinbytes =
$g&minus;&gt;blockdev_getsize64 ($device);</p>

<p style="margin-left:17%;">This returns the size of the
device in bytes.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;blockdev_getsz&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$sectorsize =
$g&minus;&gt;blockdev_getss ($device);</p>

<p style="margin-left:17%;">This returns the size of
sectors on a block device. Usually 512, but can be larger
for modern devices.</p>

<p style="margin-left:17%; margin-top: 1em">(Note, this is
not the size in sectors, use
<tt>&quot;$g&minus;&gt;blockdev_getsz&quot;</tt> for
that).</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$sizeinsectors =
$g&minus;&gt;blockdev_getsz ($device);</p>

<p style="margin-left:17%;">This returns the size of the
device in units of 512&minus;byte sectors (even if the
sectorsize isn&rsquo;t 512 bytes ... weird).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;blockdev_getss&quot;</tt> for the
real sector size of the device, and
<tt>&quot;$g&minus;&gt;blockdev_getsize64&quot;</tt> for the
more useful <i>size in bytes</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$g&minus;&gt;blockdev_rereadpt
($device);</p>

<p style="margin-left:17%;">Reread the partition table on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$g&minus;&gt;blockdev_setbsz
($device, $blocksize);</p>

<p style="margin-left:17%;">This call does nothing and has
never done anything because of a bug in blockdev. <b>Do not
use it.</b></p>

<p style="margin-left:17%; margin-top: 1em">If you need to
set the filesystem block size, use the
<tt>&quot;blocksize&quot;</tt> option of
<tt>&quot;$g&minus;&gt;mkfs&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mkfs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;blockdev_setra
($device, $sectors);</p>

<p style="margin-left:17%;">Set readahead (in
512&minus;byte sectors) for the device.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$g&minus;&gt;blockdev_setro
($device);</p>

<p style="margin-left:17%;">Sets the block device named
<tt>&quot;device&quot;</tt> to read-only.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>

<p style="margin-left:11%;">$g&minus;&gt;blockdev_setrw
($device);</p>

<p style="margin-left:17%;">Sets the block device named
<tt>&quot;device&quot;</tt> to read-write.</p>

<p style="margin-left:17%; margin-top: 1em">This uses the
<i>blockdev</i>(8) command.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_balance_cancel
($path);</p>

<p style="margin-left:17%;">Cancel a running balance on a
btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_balance_pause
($path);</p>

<p style="margin-left:17%;">Pause a running balance on a
btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_balance_resume
($path);</p>

<p style="margin-left:17%;">Resume a paused balance on a
btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">%status =
$g&minus;&gt;btrfs_balance_status ($path);</p>

<p style="margin-left:17%;">Show the status of a running or
paused balance on a btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;btrfs_device_add
(\@devices, $fs);</p>

<p style="margin-left:17%;">Add the list of device(s) in
<tt>&quot;devices&quot;</tt> to the btrfs filesystem mounted
at <tt>&quot;fs&quot;</tt>. If <tt>&quot;devices&quot;</tt>
is an empty list, this does nothing.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_device_delete
(\@devices, $fs);</p>

<p style="margin-left:17%;">Remove the
<tt>&quot;devices&quot;</tt> from the btrfs filesystem
mounted at <tt>&quot;fs&quot;</tt>. If
<tt>&quot;devices&quot;</tt> is an empty list, this does
nothing.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_filesystem_balance
($fs);</p>

<p style="margin-left:17%;">Balance the chunks in the btrfs
filesystem mounted at <tt>&quot;fs&quot;</tt> across the
underlying devices.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_filesystem_defragment
($path [, flush =&gt; $flush] [, compress <br>
=&gt; $compress]);</p>

<p style="margin-left:17%;">Defragment a file or directory
on a btrfs filesystem. compress is one of zlib or lzo.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_filesystem_resize
($mountpoint [, size =&gt; $size]);</p>

<p style="margin-left:17%;">This command resizes a btrfs
filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
unlike other resize calls, the filesystem has to be mounted
and the parameter is the mountpoint not the device (this is
a requirement of btrfs itself).</p>

<p style="margin-left:17%; margin-top: 1em">The optional
parameters are: <br>
&quot;size&quot;</p>

<p style="margin-left:23%;">The new size (in bytes) of the
filesystem. If omitted, the filesystem is resized to the
maximum size.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>btrfs</i>(8).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_filesystem_sync
($fs);</p>

<p style="margin-left:17%;">Force sync on the btrfs
filesystem mounted at <tt>&quot;fs&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;btrfs_fsck
($device [, superblock =&gt; $superblock] [, repair =&gt;
<br>
$repair]);</p>

<p style="margin-left:17%;">Used to check a btrfs
filesystem, <tt>&quot;device&quot;</tt> is the device file
where the filesystem is stored.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;btrfs_image
(\@source, $image [, compresslevel =&gt;
$compresslevel]);</p>

<p style="margin-left:17%;">This is used to create an image
of a btrfs filesystem. All data will be zeroed, but metadata
and the like is preserved.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_qgroup_assign
($src, $dst, $path);</p>

<p style="margin-left:17%;">Add qgroup
<tt>&quot;src&quot;</tt> to parent qgroup
<tt>&quot;dst&quot;</tt>. This command can group several
qgroups into a parent qgroup to share common limit.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_qgroup_create
($qgroupid, $subvolume);</p>

<p style="margin-left:17%;">Create a quota group (qgroup)
for subvolume at <tt>&quot;subvolume&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_qgroup_destroy
($qgroupid, $subvolume);</p>

<p style="margin-left:17%;">Destroy a quota group.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_qgroup_limit
($subvolume, $size);</p>

<p style="margin-left:17%;">Limit the size of a subvolume
which&rsquo;s path is <tt>&quot;subvolume&quot;</tt>.
<tt>&quot;size&quot;</tt> can have suffix of G, M, or K.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_qgroup_remove
($src, $dst, $path);</p>

<p style="margin-left:17%;">Remove qgroup
<tt>&quot;src&quot;</tt> from the parent qgroup
<tt>&quot;dst&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@qgroups =
$g&minus;&gt;btrfs_qgroup_show ($path);</p>

<p style="margin-left:17%;">Show all subvolume quota groups
in a btrfs filesystem, including their usages.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_quota_enable
($fs, $enable);</p>

<p style="margin-left:17%;">Enable or disable subvolume
quota support for filesystem which contains
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_quota_rescan
($fs);</p>

<p style="margin-left:17%;">Trash all qgroup numbers and
scan the metadata again with the current config.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;btrfs_replace
($srcdev, $targetdev, $mntpoint);</p>

<p style="margin-left:17%;">Replace device of a btrfs
filesystem. On a live filesystem, duplicate the data to the
target device which is currently stored on the source
device. After completion of the operation, the source device
is wiped out and removed from the filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;targetdev&quot;</tt> needs to be same size or
larger than the <tt>&quot;srcdev&quot;</tt>. Devices which
are currently mounted are never allowed to be used as the
<tt>&quot;targetdev&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_rescue_chunk_recover
($device);</p>

<p style="margin-left:17%;">Recover the chunk tree of btrfs
filesystem by scanning the devices one by one.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_rescue_super_recover
($device);</p>

<p style="margin-left:17%;">Recover bad superblocks from
good copies.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_scrub_cancel
($path);</p>

<p style="margin-left:17%;">Cancel a running scrub on a
btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_scrub_resume
($path);</p>

<p style="margin-left:17%;">Resume a previously canceled or
interrupted scrub on a btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;btrfs_scrub_start
($path);</p>

<p style="margin-left:17%;">Reads all the data and metadata
on the filesystem, and uses checksums and the duplicate
copies from <small>RAID</small> storage to identify and
repair any corrupt data.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">%status =
$g&minus;&gt;btrfs_scrub_status ($path);</p>

<p style="margin-left:17%;">Show status of running or
finished scrub on a btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;btrfs_set_seeding
($device, $seeding);</p>

<p style="margin-left:17%;">Enable or disable the seeding
feature of a device that contains a btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_subvolume_create
($dest [, qgroupid =&gt; $qgroupid]);</p>

<p style="margin-left:17%;">Create a btrfs subvolume. The
<tt>&quot;dest&quot;</tt> argument is the destination
directory and the name of the subvolume, in the form
<i>/path/to/dest/name</i>. The optional parameter
<tt>&quot;qgroupid&quot;</tt> represents the qgroup which
the newly created subvolume will be added to.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_subvolume_create_opts
($dest [, qgroupid =&gt; $qgroupid]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;btrfs_subvolume_create&quot;.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_subvolume_delete
($subvolume);</p>

<p style="margin-left:17%;">Delete the named btrfs
subvolume or snapshot.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$id =
$g&minus;&gt;btrfs_subvolume_get_default ($fs);</p>

<p style="margin-left:17%;">Get the default subvolume or
snapshot of a filesystem mounted at
<tt>&quot;mountpoint&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@subvolumes =
$g&minus;&gt;btrfs_subvolume_list ($fs);</p>

<p style="margin-left:17%;">List the btrfs snapshots and
subvolumes of the btrfs filesystem which is mounted at
<tt>&quot;fs&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_subvolume_set_default
($id, $fs);</p>

<p style="margin-left:17%;">Set the subvolume of the btrfs
filesystem <tt>&quot;fs&quot;</tt> which will be mounted by
default. See
<tt>&quot;$g&minus;&gt;btrfs_subvolume_list&quot;</tt> to
get a list of subvolumes.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">%btrfssubvolumeinfo =
$g&minus;&gt;btrfs_subvolume_show ($subvolume);</p>

<p style="margin-left:17%;">Return detailed information of
the subvolume.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_subvolume_snapshot
($source, $dest [, ro =&gt; $ro] [, qgroupid <br>
=&gt; $qgroupid]);</p>

<p style="margin-left:17%;">Create a snapshot of the btrfs
subvolume <tt>&quot;source&quot;</tt>. The
<tt>&quot;dest&quot;</tt> argument is the destination
directory and the name of the snapshot, in the form
<i>/path/to/dest/name</i>. By default the newly created
snapshot is writable, if the value of optional parameter
<tt>&quot;ro&quot;</tt> is true, then a readonly snapshot is
created. The optional parameter
<tt>&quot;qgroupid&quot;</tt> represents the qgroup which
the newly created snapshot will be added to.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfs_subvolume_snapshot_opts
($source, $dest [, ro =&gt; $ro] [, <br>
qgroupid =&gt; $qgroupid]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;btrfs_subvolume_snapshot&quot;.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfstune_enable_extended_inode_refs
($device);</p>

<p style="margin-left:17%;">This will Enable extended inode
refs.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;btrfstune_enable_skinny_metadata_extent_refs
($device);</p>

<p style="margin-left:17%;">This enable skinny metadata
extent refs.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;btrfstune_seeding
($device, $seeding);</p>

<p style="margin-left:17%;">Enable seeding of a btrfs
device, this will force a fs readonly so that you can use it
to build other filesystems.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$ptr = $g&minus;&gt;c_pointer
();</p>

<p style="margin-left:17%;">In non-C language bindings,
this allows you to retrieve the underlying C pointer to the
handle (ie. <tt>&quot;$g&minus;&gt;h *&quot;</tt>). The
purpose of this is to allow other libraries to interwork
with libguestfs.</p>

<p style="margin-left:11%;">$canonical =
$g&minus;&gt;canonical_device_name ($device);</p>

<p style="margin-left:17%;">This utility function is useful
when displaying device names to the user. It takes a number
of irregular device names and returns them in a consistent
format: <i><br>
/dev/hdX <br>
/dev/vdX</i></p>

<p style="margin-left:23%;">These are returned as
<i>/dev/sdX</i>. Note this works for device names and
partition names. This is approximately the reverse of the
algorithm described in &quot; <small>BLOCK DEVICE
NAMING&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%;"><i>/dev/mapper/VG&minus;LV <br>
/dev/dm&minus;N</i></p>

<p style="margin-left:23%;">Converted to <i>/dev/VG/LV</i>
form using
<tt>&quot;$g&minus;&gt;lvm_canonical_lv_name&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Other strings
are returned unmodified.</p>

<p style="margin-left:11%;">$cap =
$g&minus;&gt;cap_get_file ($path);</p>

<p style="margin-left:17%;">This function returns the Linux
capabilities attached to <tt>&quot;path&quot;</tt>. The
capabilities set is returned in text form (see
<i>cap_to_text</i>(3)).</p>

<p style="margin-left:17%; margin-top: 1em">If no
capabilities are attached to a file, an empty string is
returned.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxcaps&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;cap_set_file
($path, $cap);</p>

<p style="margin-left:17%;">This function sets the Linux
capabilities attached to <tt>&quot;path&quot;</tt>. The
capabilities set <tt>&quot;cap&quot;</tt> should be passed
in text form (see <i>cap_from_text</i>(3)).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxcaps&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$rpath =
$g&minus;&gt;case_sensitive_path ($path);</p>

<p style="margin-left:17%;">This can be used to resolve
case insensitive paths on a filesystem which is case
sensitive. The use case is to resolve paths which you have
read from Windows configuration files or the Windows
Registry, to the true path.</p>

<p style="margin-left:17%; margin-top: 1em">The command
handles a peculiarity of the Linux ntfs&minus;3g filesystem
driver (and probably others), which is that although the
underlying filesystem is case-insensitive, the driver
exports the filesystem to Linux as case-sensitive.</p>

<p style="margin-left:17%; margin-top: 1em">One consequence
of this is that special directories such as
<i>C:\windows</i> may appear as <i>/WINDOWS</i> or
<i>/windows</i> (or other things) depending on the precise
details of how they were created. In Windows itself this
would not be a problem.</p>

<p style="margin-left:17%; margin-top: 1em">Bug or feature?
You decide:
&lt;http://www.tuxera.com/community/ntfs&minus;3g&minus;faq/#posixfilenames1&gt;</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;$g&minus;&gt;case_sensitive_path&quot;</tt>
attempts to resolve the true case of each element in the
path. It will return a resolved path if either the full path
or its parent directory exists. If the parent directory
exists but the full path does not, the case of the parent
directory will be correctly resolved, and the remainder
appended unmodified. For example, if the file
<tt>&quot;/Windows/System32/netkvm.sys&quot;</tt> exists:
<br>
&quot;$g&minus;&gt;case_sensitive_path&quot;
(&quot;/windows/system32/netkvm.sys&quot;)</p>


<p style="margin-left:23%;">&quot;Windows/System32/netkvm.sys&quot;</p>


<p style="margin-left:17%;">&quot;$g&minus;&gt;case_sensitive_path&quot;
(&quot;/windows/system32/NoSuchFile&quot;)</p>


<p style="margin-left:23%;">&quot;Windows/System32/NoSuchFile&quot;</p>


<p style="margin-left:17%;">&quot;$g&minus;&gt;case_sensitive_path&quot;
(&quot;/windows/system33/netkvm.sys&quot;)</p>


<p style="margin-left:23%;"><i><small>ERROR</small></i></p>

<p style="margin-left:17%; margin-top: 1em"><i>Note</i>:
Because of the above behaviour,
<tt>&quot;$g&minus;&gt;case_sensitive_path&quot;</tt> cannot
be used to check for the existence of a file.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note</i>:
This function does not handle drive names, backslashes
etc.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;realpath&quot;</tt>.</p>

<p style="margin-left:11%;">$content = $g&minus;&gt;cat
($path);</p>

<p style="margin-left:17%;">Return the contents of the file
named <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Because, in C,
this function returns a <tt>&quot;char *&quot;</tt>, there
is no way to differentiate between a <tt>&quot;\0&quot;</tt>
character in a file and end of string. To handle binary
files, use the <tt>&quot;$g&minus;&gt;read_file&quot;</tt>
or <tt>&quot;$g&minus;&gt;download&quot;</tt> functions.</p>

<p style="margin-left:11%;">$checksum =
$g&minus;&gt;checksum ($csumtype, $path);</p>

<p style="margin-left:17%;">This call computes the
<small>MD5,</small> SHAx or <small>CRC</small> checksum of
the file named <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The type of
checksum to compute is given by the
<tt>&quot;csumtype&quot;</tt> parameter which must have one
of the following values: <br>
&quot;crc&quot;</p>

<p style="margin-left:23%;">Compute the cyclic redundancy
check ( <small>CRC</small> ) specified by
<small>POSIX</small> for the <tt>&quot;cksum&quot;</tt>
command.</p>

<p style="margin-left:17%;">&quot;md5&quot;</p>

<p style="margin-left:23%;">Compute the <small>MD5</small>
hash (using the <tt>&quot;md5sum&quot;</tt> program).</p>

<p style="margin-left:17%;">&quot;sha1&quot;</p>

<p style="margin-left:23%;">Compute the <small>SHA1</small>
hash (using the <tt>&quot;sha1sum&quot;</tt> program).</p>

<p style="margin-left:17%;">&quot;sha224&quot;</p>

<p style="margin-left:23%;">Compute the
<small>SHA224</small> hash (using the
<tt>&quot;sha224sum&quot;</tt> program).</p>

<p style="margin-left:17%;">&quot;sha256&quot;</p>

<p style="margin-left:23%;">Compute the
<small>SHA256</small> hash (using the
<tt>&quot;sha256sum&quot;</tt> program).</p>

<p style="margin-left:17%;">&quot;sha384&quot;</p>

<p style="margin-left:23%;">Compute the
<small>SHA384</small> hash (using the
<tt>&quot;sha384sum&quot;</tt> program).</p>

<p style="margin-left:17%;">&quot;sha512&quot;</p>

<p style="margin-left:23%;">Compute the
<small>SHA512</small> hash (using the
<tt>&quot;sha512sum&quot;</tt> program).</p>

<p style="margin-left:17%; margin-top: 1em">The checksum is
returned as a printable string.</p>

<p style="margin-left:17%; margin-top: 1em">To get the
checksum for a device, use
<tt>&quot;$g&minus;&gt;checksum_device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">To get the
checksums for many files, use
<tt>&quot;$g&minus;&gt;checksums_out&quot;</tt>.</p>

<p style="margin-left:11%;">$checksum =
$g&minus;&gt;checksum_device ($csumtype, $device);</p>

<p style="margin-left:17%;">This call computes the
<small>MD5,</small> SHAx or <small>CRC</small> checksum of
the contents of the device named
<tt>&quot;device&quot;</tt>. For the types of checksums
supported see the <tt>&quot;$g&minus;&gt;checksum&quot;</tt>
command.</p>

<p style="margin-left:11%;">$g&minus;&gt;checksums_out
($csumtype, $directory, $sumsfile);</p>

<p style="margin-left:17%;">This command computes the
checksums of all regular files in <i>directory</i> and then
emits a list of those checksums to the local output file
<tt>&quot;sumsfile&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This can be
used for verifying the integrity of a virtual machine.
However to be properly secure you should pay attention to
the output of the checksum command (it uses the ones from
<small>GNU</small> coreutils). In particular when the
filename is not printable, coreutils uses a special
backslash syntax. For more information, see the
<small>GNU</small> coreutils info file.</p>

<p style="margin-left:11%;">$g&minus;&gt;chmod ($mode,
$path);</p>

<p style="margin-left:17%;">Change the mode (permissions)
of <tt>&quot;path&quot;</tt> to <tt>&quot;mode&quot;</tt>.
Only numeric modes are supported.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note</i>:
When using this command from guestfish,
<tt>&quot;mode&quot;</tt> by default would be decimal,
unless you prefix it with <tt>0</tt> to get octal, ie. use
<tt>0700</tt> not <tt>700</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The mode
actually set is affected by the umask.</p>

<p style="margin-left:11%;">$g&minus;&gt;chown ($owner,
$group, $path);</p>

<p style="margin-left:17%;">Change the file owner to
<tt>&quot;owner&quot;</tt> and group to
<tt>&quot;group&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Only numeric
uid and gid are supported. If you want to use names, you
will need to locate and parse the password file yourself
(Augeas support makes this relatively easy).</p>

<p style="margin-left:11%;">$count =
$g&minus;&gt;clear_backend_setting ($name);</p>

<p style="margin-left:17%;">If there is a backend setting
string matching <tt>&quot;name&quot;</tt> or beginning with
<tt>&quot;name=&quot;</tt>, then that string is removed from
the backend settings.</p>

<p style="margin-left:17%; margin-top: 1em">This call
returns the number of strings which were removed (which may
be 0, 1 or greater than 1).</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3), &quot;
<small>BACKEND SETTINGS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$output = $g&minus;&gt;command
(\@arguments);</p>

<p style="margin-left:17%;">This call runs a command from
the guest filesystem. The filesystem must be mounted, and
must contain a compatible operating system (ie. something
Linux, with the same or compatible processor
architecture).</p>

<p style="margin-left:17%; margin-top: 1em">The single
parameter is an argv-style list of arguments. The first
element is the name of the program to run. Subsequent
elements are parameters. The list must be non-empty (ie.
must contain a program name). Note that the command runs
directly, and is <i>not</i> invoked via the shell (see
<tt>&quot;$g&minus;&gt;sh&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">The return
value is anything printed to <i>stdout</i> by the
command.</p>

<p style="margin-left:17%; margin-top: 1em">If the command
returns a non-zero exit status, then this function returns
an error message. The error message string is the content of
<i>stderr</i> from the command.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>$PATH</tt> environment variable will contain at least
<i>/usr/bin</i> and <i>/bin</i>. If you require a program
from another location, you should provide the full path in
the first parameter.</p>

<p style="margin-left:17%; margin-top: 1em">Shared
libraries and data files required by the program must be
available on filesystems which are mounted in the correct
places. It is the caller&rsquo;s responsibility to ensure
all filesystems that are needed are mounted at the right
locations.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">@lines =
$g&minus;&gt;command_lines (\@arguments);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;command&quot;</tt>, but splits the
result into a list of lines.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;sh_lines&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$g&minus;&gt;compress_device_out
($ctype, $device, $zdevice [, level =&gt; <br>
$level]);</p>

<p style="margin-left:17%;">This command compresses
<tt>&quot;device&quot;</tt> and writes it out to the local
file <tt>&quot;zdevice&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;ctype&quot;</tt> and optional
<tt>&quot;level&quot;</tt> parameters have the same meaning
as in <tt>&quot;$g&minus;&gt;compress_out&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;compress_out
($ctype, $file, $zfile [, level =&gt; $level]);</p>

<p style="margin-left:17%;">This command compresses
<i>file</i> and writes it out to the local file
<i>zfile</i>.</p>

<p style="margin-left:17%; margin-top: 1em">The compression
program used is controlled by the <tt>&quot;ctype&quot;</tt>
parameter. Currently this includes:
<tt>&quot;compress&quot;</tt>, <tt>&quot;gzip&quot;</tt>,
<tt>&quot;bzip2&quot;</tt>, <tt>&quot;xz&quot;</tt> or
<tt>&quot;lzop&quot;</tt>. Some compression types may not be
supported by particular builds of libguestfs, in which case
you will get an error containing the substring &quot;not
supported&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;level&quot;</tt> parameter controls compression
level. The meaning and default for this parameter depends on
the compression program being used.</p>

<p style="margin-left:11%;">$g&minus;&gt;config ($hvparam,
$hvvalue);</p>

<p style="margin-left:17%;">This can be used to add
arbitrary hypervisor parameters of the form <i>&minus;param
value</i>. Actually it&rsquo;s not quite arbitrary &minus;
we prevent you from setting some parameters which would
interfere with parameters that we use.</p>

<p style="margin-left:17%; margin-top: 1em">The first
character of <tt>&quot;hvparam&quot;</tt> string must be a
<tt>&quot;&minus;&quot;</tt> (dash).</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;hvvalue&quot;</tt>
can be <small>NULL.</small></p>

<p style="margin-left:11%;">$g&minus;&gt;copy_attributes
($src, $dest [, all =&gt; $all] [, mode =&gt; $mode] [, <br>
xattributes =&gt; $xattributes] [, ownership =&gt;
$ownership]);</p>

<p style="margin-left:17%;">Copy the attributes of a path
(which can be a file or a directory) to another path.</p>

<p style="margin-left:17%; margin-top: 1em">By default
<tt>&quot;no&quot;</tt> attribute is copied, so make sure to
specify any (or <tt>&quot;all&quot;</tt> to copy
everything).</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments specify which attributes can be copied: <br>
&quot;mode&quot;</p>

<p style="margin-left:23%;">Copy part of the file mode from
<tt>&quot;source&quot;</tt> to
<tt>&quot;destination&quot;</tt>. Only the
<small>UNIX</small> permissions and the sticky/setuid/setgid
bits can be copied.</p>

<p style="margin-left:17%;">&quot;xattributes&quot;</p>

<p style="margin-left:23%;">Copy the Linux extended
attributes (xattrs) from <tt>&quot;source&quot;</tt> to
<tt>&quot;destination&quot;</tt>. This flag does nothing if
the <i>linuxxattrs</i> feature is not available (see
<tt>&quot;$g&minus;&gt;feature_available&quot;</tt>).</p>

<p style="margin-left:17%;">&quot;ownership&quot;</p>

<p style="margin-left:23%;">Copy the owner uid and the
group gid of <tt>&quot;source&quot;</tt> to
<tt>&quot;destination&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;all&quot;</p>

<p style="margin-left:23%;">Copy <b>all</b> the attributes
from <tt>&quot;source&quot;</tt> to
<tt>&quot;destination&quot;</tt>. Enabling it enables all
the other flags, if they are not specified already.</p>


<p style="margin-left:11%;">$g&minus;&gt;copy_device_to_device
($src, $dest [, srcoffset =&gt; $srcoffset] [, <br>
destoffset =&gt; $destoffset] [, size =&gt; $size] [, sparse
=&gt; $sparse] [, <br>
append =&gt; $append]);</p>

<p style="margin-left:17%;">The four calls
<tt>&quot;$g&minus;&gt;copy_device_to_device&quot;</tt>,
<tt>&quot;$g&minus;&gt;copy_device_to_file&quot;</tt>,
<tt>&quot;$g&minus;&gt;copy_file_to_device&quot;</tt>, and
<tt>&quot;$g&minus;&gt;copy_file_to_file&quot;</tt> let you
copy from a source (device|file) to a destination
(device|file).</p>

<p style="margin-left:17%; margin-top: 1em">Partial copies
can be made since you can specify optionally the source
offset, destination offset and size to copy. These values
are all specified in bytes. If not given, the offsets both
default to zero, and the size defaults to copying as much as
possible until we hit the end of the source.</p>

<p style="margin-left:17%; margin-top: 1em">The source and
destination may be the same object. However overlapping
regions may not be copied correctly.</p>

<p style="margin-left:17%; margin-top: 1em">If the
destination is a file, it is created if required. If the
destination file is not large enough, it is extended.</p>

<p style="margin-left:17%; margin-top: 1em">If the
destination is a file and the <tt>&quot;append&quot;</tt>
flag is not set, then the destination file is truncated. If
the <tt>&quot;append&quot;</tt> flag is set, then the copy
appends to the destination file. The
<tt>&quot;append&quot;</tt> flag currently cannot be set for
devices.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<tt>&quot;sparse&quot;</tt> flag is true then the call
avoids writing blocks that contain only zeroes, which can
help in some situations where the backing disk is
thin-provisioned. Note that unless the target is already
zeroed, using this option will result in incorrect
copying.</p>


<p style="margin-left:11%;">$g&minus;&gt;copy_device_to_file
($src, $dest [, srcoffset =&gt; $srcoffset] [, <br>
destoffset =&gt; $destoffset] [, size =&gt; $size] [, sparse
=&gt; $sparse] [, <br>
append =&gt; $append]);</p>

<p style="margin-left:17%;">See
<tt>&quot;$g&minus;&gt;copy_device_to_device&quot;</tt> for
a general overview of this call.</p>


<p style="margin-left:11%;">$g&minus;&gt;copy_file_to_device
($src, $dest [, srcoffset =&gt; $srcoffset] [, <br>
destoffset =&gt; $destoffset] [, size =&gt; $size] [, sparse
=&gt; $sparse] [, <br>
append =&gt; $append]);</p>

<p style="margin-left:17%;">See
<tt>&quot;$g&minus;&gt;copy_device_to_device&quot;</tt> for
a general overview of this call.</p>

<p style="margin-left:11%;">$g&minus;&gt;copy_file_to_file
($src, $dest [, srcoffset =&gt; $srcoffset] [, <br>
destoffset =&gt; $destoffset] [, size =&gt; $size] [, sparse
=&gt; $sparse] [, <br>
append =&gt; $append]);</p>

<p style="margin-left:17%;">See
<tt>&quot;$g&minus;&gt;copy_device_to_device&quot;</tt> for
a general overview of this call.</p>

<p style="margin-left:17%; margin-top: 1em">This is
<b>not</b> the function you want for copying files. This is
for copying blocks within existing files. See
<tt>&quot;$g&minus;&gt;cp&quot;</tt>,
<tt>&quot;$g&minus;&gt;cp_a&quot;</tt> and
<tt>&quot;$g&minus;&gt;mv&quot;</tt> for general file
copying and moving functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;copy_in
($localpath, $remotedir);</p>


<p style="margin-left:17%;"><tt>&quot;$g&minus;&gt;copy_in&quot;</tt>
copies local files or directories recursively into the disk
image, placing them in the directory called
<tt>&quot;remotedir&quot;</tt> (which must exist).</p>

<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>

<p style="margin-left:11%;">$g&minus;&gt;copy_out
($remotepath, $localdir);</p>


<p style="margin-left:17%;"><tt>&quot;$g&minus;&gt;copy_out&quot;</tt>
copies remote files or directories recursively out of the
disk image, placing them on the host disk in a local
directory called <tt>&quot;localdir&quot;</tt> (which must
exist).</p>

<p style="margin-left:17%; margin-top: 1em">To download to
the current directory, use <tt>&quot;.&quot;</tt> as in:</p>

<pre style="margin-left:17%; margin-top: 1em"> C&lt;$g&minus;E&lt;gt&gt;copy_out&gt; /home .</pre>


<p style="margin-left:17%; margin-top: 1em">Wildcards
cannot be used.</p>

<p style="margin-left:11%;">$g&minus;&gt;copy_size ($src,
$dest, $size);</p>

<p style="margin-left:17%;">This command copies exactly
<tt>&quot;size&quot;</tt> bytes from one source device or
file <tt>&quot;src&quot;</tt> to another destination device
or file <tt>&quot;dest&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Note this will
fail if the source is too short or if the destination is not
large enough.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;copy_device_to_device&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;cp ($src,
$dest);</p>

<p style="margin-left:17%;">This copies a file from
<tt>&quot;src&quot;</tt> to <tt>&quot;dest&quot;</tt> where
<tt>&quot;dest&quot;</tt> is either a destination filename
or destination directory.</p>

<p style="margin-left:11%;">$g&minus;&gt;cp_a ($src,
$dest);</p>

<p style="margin-left:17%;">This copies a file or directory
from <tt>&quot;src&quot;</tt> to <tt>&quot;dest&quot;</tt>
recursively using the <tt>&quot;cp &minus;a&quot;</tt>
command.</p>

<p style="margin-left:11%;">$g&minus;&gt;cp_r ($src,
$dest);</p>

<p style="margin-left:17%;">This copies a file or directory
from <tt>&quot;src&quot;</tt> to <tt>&quot;dest&quot;</tt>
recursively using the <tt>&quot;cp &minus;rP&quot;</tt>
command.</p>

<p style="margin-left:17%; margin-top: 1em">Most users
should use <tt>&quot;$g&minus;&gt;cp_a&quot;</tt> instead.
This command is useful when you don&rsquo;t want to preserve
permissions, because the target filesystem does not support
it (primarily when writing to <small>DOS FAT</small>
filesystems).</p>

<p style="margin-left:11%;">$g&minus;&gt;cpio_out
($directory, $cpiofile [, format =&gt; $format]);</p>

<p style="margin-left:17%;">This command packs the contents
of <i>directory</i> and downloads it to local file
<tt>&quot;cpiofile&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;format&quot;</tt> parameter can be used to select
the format. Only the following formats are currently
permitted: <br>
&quot;newc&quot;</p>

<p style="margin-left:23%;">New ( <small>SVR4</small> )
portable format. This format happens to be compatible with
the cpio-like format used by the Linux kernel for
initramfs.</p>

<p style="margin-left:23%; margin-top: 1em">This is the
default format.</p>

<p style="margin-left:17%;">&quot;crc&quot;</p>

<p style="margin-left:23%;">New ( <small>SVR4</small> )
portable format with a checksum.</p>

<p style="margin-left:11%;">$g&minus;&gt;dd ($src,
$dest);</p>

<p style="margin-left:17%;">This command copies from one
source device or file <tt>&quot;src&quot;</tt> to another
destination device or file <tt>&quot;dest&quot;</tt>.
Normally you would use this to copy to or from a device or
partition, for example to duplicate a filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">If the
destination is a device, it must be as large or larger than
the source file or device, otherwise the copy will fail.
This command cannot do partial copies (see
<tt>&quot;$g&minus;&gt;copy_device_to_device&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;copy_device_to_device&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$index =
$g&minus;&gt;device_index ($device);</p>

<p style="margin-left:17%;">This function takes a device
name (eg. &quot;/dev/sdb&quot;) and returns the index of the
device in the list of devices.</p>

<p style="margin-left:17%; margin-top: 1em">Index numbers
start from 0. The named device must exist, for example as a
string returned from
<tt>&quot;$g&minus;&gt;list_devices&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;list_devices&quot;</tt>,
<tt>&quot;$g&minus;&gt;part_to_dev&quot;</tt>.</p>

<p style="margin-left:11%;">$output = $g&minus;&gt;df
();</p>

<p style="margin-left:17%;">This command runs the
<tt>&quot;df&quot;</tt> command to report disk space
used.</p>

<p style="margin-left:17%; margin-top: 1em">This command is
mostly useful for interactive sessions. It is <i>not</i>
intended that you try to parse the output string. Use
<tt>&quot;$g&minus;&gt;statvfs&quot;</tt> from programs.</p>

<p style="margin-left:11%;">$output = $g&minus;&gt;df_h
();</p>

<p style="margin-left:17%;">This command runs the
<tt>&quot;df &minus;h&quot;</tt> command to report disk
space used in human-readable format.</p>

<p style="margin-left:17%; margin-top: 1em">This command is
mostly useful for interactive sessions. It is <i>not</i>
intended that you try to parse the output string. Use
<tt>&quot;$g&minus;&gt;statvfs&quot;</tt> from programs.</p>

<p style="margin-left:11%;">$g&minus;&gt;disk_create
($filename, $format, $size [, backingfile =&gt; <br>
$backingfile] [, backingformat =&gt; $backingformat] [,
preallocation =&gt; <br>
$preallocation] [, compat =&gt; $compat] [, clustersize
=&gt; $clustersize]);</p>

<p style="margin-left:17%;">Create a blank disk image
called <i>filename</i> (a host file) with format
<tt>&quot;format&quot;</tt> (usually
<tt>&quot;raw&quot;</tt> or <tt>&quot;qcow2&quot;</tt>). The
size is <tt>&quot;size&quot;</tt> bytes.</p>

<p style="margin-left:17%; margin-top: 1em">If used with
the optional <tt>&quot;backingfile&quot;</tt> parameter,
then a snapshot is created on top of the backing file. In
this case, <tt>&quot;size&quot;</tt> must be passed as
<tt>&quot;&minus;1&quot;</tt>. The size of the snapshot is
the same as the size of the backing file, which is
discovered automatically. You are encouraged to also pass
<tt>&quot;backingformat&quot;</tt> to describe the format of
<tt>&quot;backingfile&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If
<i>filename</i> refers to a block device, then the device is
formatted. The <tt>&quot;size&quot;</tt> is ignored since
block devices have an intrinsic size.</p>

<p style="margin-left:17%; margin-top: 1em">The other
optional parameters are: <br>
&quot;preallocation&quot;</p>

<p style="margin-left:23%;">If format is
<tt>&quot;raw&quot;</tt>, then this can be either
<tt>&quot;off&quot;</tt> (or <tt>&quot;sparse&quot;</tt>) or
<tt>&quot;full&quot;</tt> to create a sparse or fully
allocated file respectively. The default is
<tt>&quot;off&quot;</tt>.</p>

<p style="margin-left:23%; margin-top: 1em">If format is
<tt>&quot;qcow2&quot;</tt>, then this can be
<tt>&quot;off&quot;</tt> (or <tt>&quot;sparse&quot;</tt>),
<tt>&quot;metadata&quot;</tt> or <tt>&quot;full&quot;</tt>.
Preallocating metadata can be faster when doing lots of
writes, but uses more space. The default is
<tt>&quot;off&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;compat&quot;</p>

<p style="margin-left:23%;"><tt>&quot;qcow2&quot;</tt>
only: Pass the string <tt>1.1</tt> to use the advanced qcow2
format supported by qemu X 1.1.</p>

<p style="margin-left:17%;">&quot;clustersize&quot;</p>

<p style="margin-left:23%;"><tt>&quot;qcow2&quot;</tt>
only: Change the qcow2 cluster size. The default is 65536
(bytes) and this setting may be any power of two between 512
and 2097152.</p>

<p style="margin-left:17%; margin-top: 1em">Note that this
call does not add the new disk to the handle. You may need
to call <tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>
separately.</p>

<p style="margin-left:11%;">$format =
$g&minus;&gt;disk_format ($filename);</p>

<p style="margin-left:17%;">Detect and return the format of
the disk image called <i>filename</i>. <i>filename</i> can
also be a host device, etc. If the format of the image could
not be detected, then <tt>&quot;unknown&quot;</tt> is
returned.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
detecting the disk format can be insecure under some
circumstances. See &quot;
<small>CVE&minus;2010&minus;3851&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em">See also:
&quot; <small>DISK IMAGE FORMATS&quot;</small> in
<i>guestfs</i>(3)</p>

<p style="margin-left:11%;">$backingfile =
$g&minus;&gt;disk_has_backing_file ($filename);</p>

<p style="margin-left:17%;">Detect and return whether the
disk image <i>filename</i> has a backing file.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
detecting disk features can be insecure under some
circumstances. See &quot;
<small>CVE&minus;2010&minus;3851&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$size =
$g&minus;&gt;disk_virtual_size ($filename);</p>

<p style="margin-left:17%;">Detect and return the virtual
size in bytes of the disk image called <i>filename</i>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
detecting disk features can be insecure under some
circumstances. See &quot;
<small>CVE&minus;2010&minus;3851&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$kmsgs = $g&minus;&gt;dmesg
();</p>

<p style="margin-left:17%;">This returns the kernel
messages (<tt>&quot;dmesg&quot;</tt> output) from the guest
kernel. This is sometimes useful for extended debugging of
problems.</p>

<p style="margin-left:17%; margin-top: 1em">Another way to
get the same information is to enable verbose messages with
<tt>&quot;$g&minus;&gt;set_verbose&quot;</tt> or by setting
the environment variable
<tt>&quot;LIBGUESTFS_DEBUG=1&quot;</tt> before running the
program.</p>

<p style="margin-left:11%;">$g&minus;&gt;download
($remotefilename, $filename);</p>

<p style="margin-left:17%;">Download file
<i>remotefilename</i> and save it as <i>filename</i> on the
local machine.</p>


<p style="margin-left:17%; margin-top: 1em"><i>filename</i>
can also be a named pipe.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;upload&quot;</tt>,
<tt>&quot;$g&minus;&gt;cat&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;download_offset
($remotefilename, $filename, $offset, $size);</p>

<p style="margin-left:17%;">Download file
<i>remotefilename</i> and save it as <i>filename</i> on the
local machine.</p>


<p style="margin-left:17%; margin-top: 1em"><i>remotefilename</i>
is read for <tt>&quot;size&quot;</tt> bytes starting at
<tt>&quot;offset&quot;</tt> (this region must be within the
file or device).</p>

<p style="margin-left:17%; margin-top: 1em">Note that there
is no limit on the amount of data that can be downloaded
with this call, unlike with
<tt>&quot;$g&minus;&gt;pread&quot;</tt>, and this call
always reads the full amount unless an error occurs.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;download&quot;</tt>,
<tt>&quot;$g&minus;&gt;pread&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;drop_caches
($whattodrop);</p>

<p style="margin-left:17%;">This instructs the guest kernel
to drop its page cache, and/or dentries and inode caches.
The parameter <tt>&quot;whattodrop&quot;</tt> tells the
kernel what precisely to drop, see
&lt;http://linux&minus;mm.org/Drop_Caches&gt;</p>

<p style="margin-left:17%; margin-top: 1em">Setting
<tt>&quot;whattodrop&quot;</tt> to 3 should drop
everything.</p>

<p style="margin-left:17%; margin-top: 1em">This
automatically calls <i>sync</i>(2) before the operation, so
that the maximum guest memory is freed.</p>

<p style="margin-left:11%;">$sizekb = $g&minus;&gt;du
($path);</p>

<p style="margin-left:17%;">This command runs the
<tt>&quot;du &minus;s&quot;</tt> command to estimate file
space usage for <tt>&quot;path&quot;</tt>.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;path&quot;</tt>
can be a file or a directory. If <tt>&quot;path&quot;</tt>
is a directory then the estimate includes the contents of
the directory and all subdirectories (recursively).</p>

<p style="margin-left:17%; margin-top: 1em">The result is
the estimated size in <i>kilobytes</i> (ie. units of 1024
bytes).</p>

<p style="margin-left:11%;">$g&minus;&gt;e2fsck ($device [,
correct =&gt; $correct] [, forceall =&gt; $forceall]);</p>

<p style="margin-left:17%;">This runs the ext2/ext3
filesystem checker on <tt>&quot;device&quot;</tt>. It can
take the following optional arguments: <br>
&quot;correct&quot;</p>

<p style="margin-left:23%;">Automatically repair the file
system. This option will cause e2fsck to automatically fix
any filesystem problems that can be safely fixed without
human intervention.</p>

<p style="margin-left:23%; margin-top: 1em">This option may
not be specified at the same time as the
<tt>&quot;forceall&quot;</tt> option.</p>

<p style="margin-left:17%;">&quot;forceall&quot;</p>

<p style="margin-left:23%;">Assume an answer of
&rsquo;yes&rsquo; to all questions; allows e2fsck to be used
non-interactively.</p>

<p style="margin-left:23%; margin-top: 1em">This option may
not be specified at the same time as the
<tt>&quot;correct&quot;</tt> option.</p>

<p style="margin-left:11%;">$g&minus;&gt;e2fsck_f
($device);</p>

<p style="margin-left:17%;">This runs <tt>&quot;e2fsck
&minus;p &minus;f device&quot;</tt>, ie. runs the ext2/ext3
filesystem checker on <tt>&quot;device&quot;</tt>,
noninteractively (<i>&minus;p</i>), even if the filesystem
appears to be clean (<i>&minus;f</i>).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;e2fsck&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$output =
$g&minus;&gt;echo_daemon (\@words);</p>

<p style="margin-left:17%;">This command concatenates the
list of <tt>&quot;words&quot;</tt> passed with single spaces
between them and returns the resulting string.</p>

<p style="margin-left:17%; margin-top: 1em">You can use
this command to test the connection through to the
daemon.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;ping_daemon&quot;</tt>.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;egrep
($regex, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;egrep&quot;</tt> program and returns the matching
lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;egrepi
($regex, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;egrep &minus;i&quot;</tt> program and returns the
matching lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$equality = $g&minus;&gt;equal
($file1, $file2);</p>

<p style="margin-left:17%;">This compares the two files
<i>file1</i> and <i>file2</i> and returns true if their
content is exactly equal, or false otherwise.</p>

<p style="margin-left:17%; margin-top: 1em">The external
<i>cmp</i>(1) program is used for the comparison.</p>

<p style="margin-left:11%;">$existsflag =
$g&minus;&gt;exists ($path);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a file,
directory (or anything) with the given
<tt>&quot;path&quot;</tt> name.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;is_file&quot;</tt>,
<tt>&quot;$g&minus;&gt;is_dir&quot;</tt>,
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;extlinux
($directory);</p>

<p style="margin-left:17%;">Install the
<small>SYSLINUX</small> bootloader on the device mounted at
<i>directory</i>. Unlike
<tt>&quot;$g&minus;&gt;syslinux&quot;</tt> which requires a
<small>FAT</small> filesystem, this can be used on an
ext2/3/4 or btrfs filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">The
<i>directory</i> parameter can be either a mountpoint, or a
directory within the mountpoint.</p>

<p style="margin-left:17%; margin-top: 1em">You also have
to mark the partition as &quot;active&quot;
(<tt>&quot;$g&minus;&gt;part_set_bootable&quot;</tt>) and a
Master Boot Record must be installed (eg. using
<tt>&quot;$g&minus;&gt;pwrite_device&quot;</tt>) on the
first sector of the whole disk. The <small>SYSLINUX</small>
package comes with some suitable Master Boot Records. See
the <i>extlinux</i>(1) man page for further information.</p>

<p style="margin-left:17%; margin-top: 1em">Additional
configuration can be supplied to <small>SYSLINUX</small> by
placing a file called <i>extlinux.conf</i> on the filesystem
under <i>directory</i>. For further information about the
contents of this file, see <i>extlinux</i>(1).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;syslinux&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;extlinux&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;fallocate ($path,
$len);</p>

<p style="margin-left:17%;">This command preallocates a
file (containing zero bytes) named <tt>&quot;path&quot;</tt>
of size <tt>&quot;len&quot;</tt> bytes. If the file exists
already, it is overwritten.</p>

<p style="margin-left:17%; margin-top: 1em">Do not confuse
this with the guestfish-specific <tt>&quot;alloc&quot;</tt>
command which allocates a file in the host and attaches it
as a device.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;fallocate64&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;fallocate64
($path, $len);</p>

<p style="margin-left:17%;">This command preallocates a
file (containing zero bytes) named <tt>&quot;path&quot;</tt>
of size <tt>&quot;len&quot;</tt> bytes. If the file exists
already, it is overwritten.</p>

<p style="margin-left:17%; margin-top: 1em">Note that this
call allocates disk blocks for the file. To create a sparse
file use <tt>&quot;$g&minus;&gt;truncate_size&quot;</tt>
instead.</p>

<p style="margin-left:17%; margin-top: 1em">The deprecated
call <tt>&quot;$g&minus;&gt;fallocate&quot;</tt> does the
same, but owing to an oversight it only allowed 30 bit
lengths to be specified, effectively limiting the maximum
size of files created through that call to 1GB.</p>

<p style="margin-left:17%; margin-top: 1em">Do not confuse
this with the guestfish-specific <tt>&quot;alloc&quot;</tt>
and <tt>&quot;sparse&quot;</tt> commands which create a file
in the host and attach it as a device.</p>

<p style="margin-left:11%;">$isavailable =
$g&minus;&gt;feature_available (\@groups);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;available&quot;</tt>, but unlike that
call it returns a simple true/false boolean result, instead
of throwing an exception if a feature is not found. For
other documentation see
<tt>&quot;$g&minus;&gt;available&quot;</tt>.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;fgrep
($pattern, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;fgrep&quot;</tt> program and returns the matching
lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;fgrepi
($pattern, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;fgrep &minus;i&quot;</tt> program and returns the
matching lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$description =
$g&minus;&gt;file ($path);</p>

<p style="margin-left:17%;">This call uses the standard
<i>file</i>(1) command to determine the type or contents of
the file.</p>

<p style="margin-left:17%; margin-top: 1em">This call will
also transparently look inside various types of compressed
file.</p>

<p style="margin-left:17%; margin-top: 1em">The exact
command which runs is <tt>&quot;file &minus;zb
path&quot;</tt>. Note in particular that the filename is not
prepended to the output (the <i>&minus;b</i> option).</p>

<p style="margin-left:17%; margin-top: 1em">The output
depends on the output of the underlying <i>file</i>(1)
command and it can change in future in ways beyond our
control. In other words, the output is not guaranteed by the
<small>ABI.</small></p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>file</i>(1), <tt>&quot;$g&minus;&gt;vfs_type&quot;</tt>,
<tt>&quot;$g&minus;&gt;lstat&quot;</tt>,
<tt>&quot;$g&minus;&gt;is_file&quot;</tt>,
<tt>&quot;$g&minus;&gt;is_blockdev&quot;</tt> (etc),
<tt>&quot;$g&minus;&gt;is_zero&quot;</tt>.</p>

<p style="margin-left:11%;">$arch =
$g&minus;&gt;file_architecture ($filename);</p>

<p style="margin-left:17%;">This detects the architecture
of the binary <i>filename</i>, and returns it if known.</p>

<p style="margin-left:17%; margin-top: 1em">Currently
defined architectures are: <br>
&quot;i386&quot;</p>

<p style="margin-left:23%;">This string is returned for all
32 bit i386, i486, i586, i686 binaries irrespective of the
precise processor requirements of the binary.</p>

<p style="margin-left:17%;">&quot;x86_64&quot;</p>

<p style="margin-left:23%;">64 bit x86&minus;64.</p>

<p style="margin-left:17%;">&quot;sparc&quot;</p>

<p style="margin-left:23%;">32 bit
<small>SPARC.</small></p>

<p style="margin-left:17%;">&quot;sparc64&quot;</p>

<p style="margin-left:23%;">64 bit <small>SPARC V9</small>
and above.</p>

<p style="margin-left:17%;">&quot;ia64&quot;</p>

<p style="margin-left:23%;">Intel Itanium.</p>

<p style="margin-left:17%;">&quot;ppc&quot;</p>

<p style="margin-left:23%;">32 bit Power
<small>PC.</small></p>

<p style="margin-left:17%;">&quot;ppc64&quot;</p>

<p style="margin-left:23%;">64 bit Power
<small>PC.</small></p>

<p style="margin-left:17%;">&quot;arm&quot;</p>

<p style="margin-left:23%;">32 bit <small>ARM.</small></p>

<p style="margin-left:17%;">&quot;aarch64&quot;</p>

<p style="margin-left:23%;">64 bit <small>ARM.</small></p>

<p style="margin-left:17%; margin-top: 1em">Libguestfs may
return other architecture strings in future.</p>

<p style="margin-left:17%; margin-top: 1em">The function
works on at least the following types of files:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="66%">


<p>many types of Un*x and Linux binary</p></td>
<td width="11%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="66%">


<p>many types of Un*x and Linux shared library</p></td>
<td width="11%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="66%">


<p>Windows Win32 and Win64 binaries</p></td>
<td width="11%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="66%">


<p>Windows Win32 and Win64 DLLs</p></td>
<td width="11%">
</td></tr>
</table>

<p style="margin-left:23%; margin-top: 1em">Win32 binaries
and DLLs return <tt>&quot;i386&quot;</tt>.</p>

<p style="margin-left:23%; margin-top: 1em">Win64 binaries
and DLLs return <tt>&quot;x86_64&quot;</tt>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="52%">


<p style="margin-top: 1em">Linux kernel modules</p></td>
<td width="25%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="52%">


<p>Linux new-style initrd images</p></td>
<td width="25%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="52%">


<p>some non&minus;x86 Linux vmlinuz kernels</p></td>
<td width="25%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">What it
can&rsquo;t do currently:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p style="margin-top: 1em">static libraries (libfoo.a)</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Linux old-style initrd as compressed ext2 filesystem (
<small>RHEL 3</small> )</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>x86 Linux vmlinuz kernels</p></td></tr>
</table>

<p style="margin-left:23%; margin-top: 1em">x86 vmlinuz
images (bzImage format) consist of a mix of 16&minus;,
32&minus; and compressed code, and are horribly hard to
unpack. If you want to find the architecture of a kernel,
use the architecture of the associated initrd or kernel
module(s) instead.</p>

<p style="margin-left:11%;">$size = $g&minus;&gt;filesize
($file);</p>

<p style="margin-left:17%;">This command returns the size
of <i>file</i> in bytes.</p>

<p style="margin-left:17%; margin-top: 1em">To get other
stats about a file, use
<tt>&quot;$g&minus;&gt;stat&quot;</tt>,
<tt>&quot;$g&minus;&gt;lstat&quot;</tt>,
<tt>&quot;$g&minus;&gt;is_dir&quot;</tt>,
<tt>&quot;$g&minus;&gt;is_file&quot;</tt> etc. To get the
size of block devices, use
<tt>&quot;$g&minus;&gt;blockdev_getsize64&quot;</tt>.</p>

<p style="margin-left:11%;">$fsavail =
$g&minus;&gt;filesystem_available ($filesystem);</p>

<p style="margin-left:17%;">Check whether libguestfs
supports the named filesystem. The argument
<tt>&quot;filesystem&quot;</tt> is a filesystem name, such
as <tt>&quot;ext3&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">You must call
<tt>&quot;$g&minus;&gt;launch&quot;</tt> before using this
command.</p>

<p style="margin-left:17%; margin-top: 1em">This is mainly
useful as a negative test. If this returns true, it
doesn&rsquo;t mean that a particular filesystem can be
created or mounted, since filesystems can fail for other
reasons such as it being a later version of the filesystem,
or having incompatible features, or lacking the right
mkfs.&lt;<i>fs</i>&gt; tool.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;available&quot;</tt>,
<tt>&quot;$g&minus;&gt;feature_available&quot;</tt>, &quot;
<small>AVAILABILITY&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;fill ($c, $len,
$path);</p>

<p style="margin-left:17%;">This command creates a new file
called <tt>&quot;path&quot;</tt>. The initial content of the
file is <tt>&quot;len&quot;</tt> octets of
<tt>&quot;c&quot;</tt>, where <tt>&quot;c&quot;</tt> must be
a number in the range <tt>&quot;[0..255]&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">To fill a file
with zero bytes (sparsely), it is much more efficient to use
<tt>&quot;$g&minus;&gt;truncate_size&quot;</tt>. To create a
file with a pattern of repeating bytes use
<tt>&quot;$g&minus;&gt;fill_pattern&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;fill_dir ($dir,
$nr);</p>

<p style="margin-left:17%;">This function, useful for
testing filesystems, creates <tt>&quot;nr&quot;</tt> empty
files in the directory <tt>&quot;dir&quot;</tt> with names
<tt>00000000</tt> through <tt>&quot;nr&minus;1&quot;</tt>
(ie. each file name is 8 digits long padded with
zeroes).</p>

<p style="margin-left:11%;">$g&minus;&gt;fill_pattern
($pattern, $len, $path);</p>

<p style="margin-left:17%;">This function is like
<tt>&quot;$g&minus;&gt;fill&quot;</tt> except that it
creates a new file of length <tt>&quot;len&quot;</tt>
containing the repeating pattern of bytes in
<tt>&quot;pattern&quot;</tt>. The pattern is truncated if
necessary to ensure the length of the file is exactly
<tt>&quot;len&quot;</tt> bytes.</p>

<p style="margin-left:11%;">@names = $g&minus;&gt;find
($directory);</p>

<p style="margin-left:17%;">This command lists out all
files and directories, recursively, starting at
<i>directory</i>. It is essentially equivalent to running
the shell command <tt>&quot;find directory
&minus;print&quot;</tt> but some post-processing happens on
the output, described below.</p>

<p style="margin-left:17%; margin-top: 1em">This returns a
list of strings <i>without any prefix</i>. Thus if the
directory structure was:</p>

<pre style="margin-left:17%; margin-top: 1em"> /tmp/a
 /tmp/b
 /tmp/c/d</pre>


<p style="margin-left:17%; margin-top: 1em">then the
returned list from <tt>&quot;$g&minus;&gt;find&quot;</tt>
<i>/tmp</i> would be 4 elements:</p>

<pre style="margin-left:17%; margin-top: 1em"> a
 b
 c
 c/d</pre>


<p style="margin-left:17%; margin-top: 1em">If
<i>directory</i> is not a directory, then this command
returns an error.</p>

<p style="margin-left:17%; margin-top: 1em">The returned
list is sorted.</p>

<p style="margin-left:11%;">$g&minus;&gt;find0 ($directory,
$files);</p>

<p style="margin-left:17%;">This command lists out all
files and directories, recursively, starting at
<i>directory</i>, placing the resulting list in the external
file called <i>files</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This command
works the same way as <tt>&quot;$g&minus;&gt;find&quot;</tt>
with the following exceptions:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>The resulting list is written to an external file.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Items (filenames) in the result are separated by
<tt>&quot;\0&quot;</tt> characters. See <i>find</i>(1)
option <i>&minus;print0</i>.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>The result list is not sorted.</p></td></tr>
</table>

<p style="margin-left:11%;">$device =
$g&minus;&gt;findfs_label ($label);</p>

<p style="margin-left:17%;">This command searches the
filesystems and returns the one which has the given label.
An error is returned if no such filesystem can be found.</p>

<p style="margin-left:17%; margin-top: 1em">To find the
label of a filesystem, use
<tt>&quot;$g&minus;&gt;vfs_label&quot;</tt>.</p>

<p style="margin-left:11%;">$device =
$g&minus;&gt;findfs_uuid ($uuid);</p>

<p style="margin-left:17%;">This command searches the
filesystems and returns the one which has the given
<small>UUID.</small> An error is returned if no such
filesystem can be found.</p>

<p style="margin-left:17%; margin-top: 1em">To find the
<small>UUID</small> of a filesystem, use
<tt>&quot;$g&minus;&gt;vfs_uuid&quot;</tt>.</p>

<p style="margin-left:11%;">$status = $g&minus;&gt;fsck
($fstype, $device);</p>

<p style="margin-left:17%;">This runs the filesystem
checker (fsck) on <tt>&quot;device&quot;</tt> which should
have filesystem type <tt>&quot;fstype&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The returned
integer is the status. See <i>fsck</i>(8) for the list of
status codes from <tt>&quot;fsck&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Notes:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Multiple status codes can be summed together.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>A non-zero return code can mean &quot;success&quot;, for
example if errors have been corrected on the filesystem.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Checking or repairing <small>NTFS</small> volumes is not
supported (by linux-ntfs).</p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">This command is
entirely equivalent to running <tt>&quot;fsck &minus;a
&minus;t fstype device&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;fstrim
($mountpoint [, offset =&gt; $offset] [, length =&gt;
$length] [, <br>
minimumfreeextent =&gt; $minimumfreeextent]);</p>

<p style="margin-left:17%;">Trim the free space in the
filesystem mounted on <tt>&quot;mountpoint&quot;</tt>. The
filesystem must be mounted read-write.</p>

<p style="margin-left:17%; margin-top: 1em">The filesystem
contents are not affected, but any free space in the
filesystem is &quot;trimmed&quot;, that is, given back to
the host device, thus making disk images more sparse,
allowing unused space in qcow2 files to be reused, etc.</p>

<p style="margin-left:17%; margin-top: 1em">This operation
requires support in libguestfs, the mounted filesystem, the
host filesystem, qemu and the host kernel. If this support
isn&rsquo;t present it may give an error or even appear to
run but do nothing.</p>

<p style="margin-left:17%; margin-top: 1em">In the case
where the kernel vfs driver does not support trimming, this
call will fail with errno set to
<tt>&quot;ENOTSUP&quot;</tt>. Currently this happens when
trying to trim <small>FAT</small> filesystems.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;zero_free_space&quot;</tt>. That is a
slightly different operation that turns free space in the
filesystem into zeroes. It is valid to call
<tt>&quot;$g&minus;&gt;fstrim&quot;</tt> either instead of,
or after calling
<tt>&quot;$g&minus;&gt;zero_free_space&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;fstrim&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$append =
$g&minus;&gt;get_append ();</p>

<p style="margin-left:17%;">Return the additional kernel
options which are added to the libguestfs appliance kernel
command line.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>&quot;NULL&quot;</tt> then no options are added.</p>

<p style="margin-left:11%;">$backend =
$g&minus;&gt;get_attach_method ();</p>

<p style="margin-left:17%;">Return the current backend.</p>

<p style="margin-left:17%; margin-top: 1em">See
<tt>&quot;$g&minus;&gt;set_backend&quot;</tt> and &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;get_backend&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$autosync =
$g&minus;&gt;get_autosync ();</p>

<p style="margin-left:17%;">Get the autosync flag.</p>

<p style="margin-left:11%;">$backend =
$g&minus;&gt;get_backend ();</p>

<p style="margin-left:17%;">Return the current backend.</p>

<p style="margin-left:17%; margin-top: 1em">This handle
property was previously called the &quot;attach
method&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">See
<tt>&quot;$g&minus;&gt;set_backend&quot;</tt> and &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$val =
$g&minus;&gt;get_backend_setting ($name);</p>

<p style="margin-left:17%;">Find a backend setting string
which is either <tt>&quot;name&quot;</tt> or begins with
<tt>&quot;name=&quot;</tt>. If <tt>&quot;name&quot;</tt>,
this returns the string <tt>&quot;1&quot;</tt>. If
<tt>&quot;name=&quot;</tt>, this returns the part after the
equals sign (which may be an empty string).</p>

<p style="margin-left:17%; margin-top: 1em">If no such
setting is found, this function throws an error. The errno
(see <tt>&quot;$g&minus;&gt;last_errno&quot;</tt>) will be
<tt>&quot;ESRCH&quot;</tt> in this case.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3), &quot;
<small>BACKEND SETTINGS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">@settings =
$g&minus;&gt;get_backend_settings ();</p>

<p style="margin-left:17%;">Return the current backend
settings.</p>

<p style="margin-left:17%; margin-top: 1em">This call
returns all backend settings strings. If you want to find a
single backend setting, see
<tt>&quot;$g&minus;&gt;get_backend_setting&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3), &quot;
<small>BACKEND SETTINGS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$cachedir =
$g&minus;&gt;get_cachedir ();</p>

<p style="margin-left:17%;">Get the directory used by the
handle to store the appliance cache.</p>

<p style="margin-left:11%;">$direct =
$g&minus;&gt;get_direct ();</p>

<p style="margin-left:17%;">Return the direct appliance
mode flag.</p>

<p style="margin-left:11%;">$attrs =
$g&minus;&gt;get_e2attrs ($file);</p>

<p style="margin-left:17%;">This returns the file
attributes associated with <i>file</i>.</p>

<p style="margin-left:17%; margin-top: 1em">The attributes
are a set of bits associated with each inode which affect
the behaviour of the file. The attributes are returned as a
string of letters (described below). The string may be
empty, indicating that no file attributes are set for this
file.</p>

<p style="margin-left:17%; margin-top: 1em">These
attributes are only present when the file is located on an
ext2/3/4 filesystem. Using this call on other filesystem
types will result in an error.</p>

<p style="margin-left:17%; margin-top: 1em">The characters
(file attributes) in the returned string are currently:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;A&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>When the file is accessed, its atime is not
modified.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;a&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file is append-only.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;c&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file is compressed on-disk.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;D&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>(Directories only.) Changes to this directory are
written synchronously to disk.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;d&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file is not a candidate for backup (see
<i>dump</i>(8)).</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;E&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file has compression errors.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;e&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file is using extents.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;h&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file is storing its blocks in units of the
filesystem blocksize instead of sectors.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;I&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>(Directories only.) The directory is using hashed
trees.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;i&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file is immutable. It cannot be modified, deleted or
renamed. No link can be created to this file.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;j&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The file is data-journaled.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;s&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>When the file is deleted, all its blocks will be
zeroed.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;S&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Changes to this file are written synchronously to
disk.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;T&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>(Directories only.) This is a hint to the block
allocator that subdirectories contained in this directory
should be spread across blocks. If not present, the block
allocator will try to group subdirectories together.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;t&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>For a file, this disables tail-merging. (Not used by
upstream implementations of ext2.)</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;u&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>When the file is deleted, its blocks will be saved,
allowing the file to be undeleted.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;X&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The raw contents of the compressed file may be
accessed.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;Z&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The compressed file is dirty.</p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">More file
attributes may be added to this list later. Not all file
attributes may be set for all kinds of files. For detailed
information, consult the <i>chattr</i>(1) man page.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;set_e2attrs&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
confuse these attributes with extended attributes (see
<tt>&quot;$g&minus;&gt;getxattr&quot;</tt>).</p>

<p style="margin-left:11%;">$generation =
$g&minus;&gt;get_e2generation ($file);</p>

<p style="margin-left:17%;">This returns the ext2 file
generation of a file. The generation (which used to be
called the &quot;version&quot;) is a number associated with
an inode. This is most commonly used by <small>NFS</small>
servers.</p>

<p style="margin-left:17%; margin-top: 1em">The generation
is only present when the file is located on an ext2/3/4
filesystem. Using this call on other filesystem types will
result in an error.</p>

<p style="margin-left:17%; margin-top: 1em">See
<tt>&quot;$g&minus;&gt;set_e2generation&quot;</tt>.</p>

<p style="margin-left:11%;">$label =
$g&minus;&gt;get_e2label ($device);</p>

<p style="margin-left:17%;">This returns the ext2/3/4
filesystem label of the filesystem on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;vfs_label&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$uuid = $g&minus;&gt;get_e2uuid
($device);</p>

<p style="margin-left:17%;">This returns the ext2/3/4
filesystem <small>UUID</small> of the filesystem on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;vfs_uuid&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$hv = $g&minus;&gt;get_hv
();</p>

<p style="margin-left:17%;">Return the current hypervisor
binary.</p>

<p style="margin-left:17%; margin-top: 1em">This is always
non-NULL. If it wasn&rsquo;t set already, then this will
return the default qemu binary name.</p>

<p style="margin-left:11%;">$identifier =
$g&minus;&gt;get_identifier ();</p>

<p style="margin-left:17%;">Get the handle identifier. See
<tt>&quot;$g&minus;&gt;set_identifier&quot;</tt>.</p>

<p style="margin-left:11%;">$challenge =
$g&minus;&gt;get_libvirt_requested_credential_challenge
($index);</p>

<p style="margin-left:17%;">Get the challenge (provided by
libvirt) for the <tt>&quot;index&quot;</tt>&rsquo;th
requested credential. If libvirt did not provide a
challenge, this returns the empty string
<tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>LIBVIRT AUTHENTICATION&quot;</small> in
<i>guestfs</i>(3) for documentation and example code.</p>

<p style="margin-left:11%;">$defresult =
$g&minus;&gt;get_libvirt_requested_credential_defresult
($index);</p>

<p style="margin-left:17%;">Get the default result
(provided by libvirt) for the
<tt>&quot;index&quot;</tt>&rsquo;th requested credential. If
libvirt did not provide a default result, this returns the
empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>LIBVIRT AUTHENTICATION&quot;</small> in
<i>guestfs</i>(3) for documentation and example code.</p>

<p style="margin-left:11%;">$prompt =
$g&minus;&gt;get_libvirt_requested_credential_prompt
($index);</p>

<p style="margin-left:17%;">Get the prompt (provided by
libvirt) for the <tt>&quot;index&quot;</tt>&rsquo;th
requested credential. If libvirt did not provide a prompt,
this returns the empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>LIBVIRT AUTHENTICATION&quot;</small> in
<i>guestfs</i>(3) for documentation and example code.</p>

<p style="margin-left:11%;">@creds =
$g&minus;&gt;get_libvirt_requested_credentials ();</p>

<p style="margin-left:17%;">This should only be called
during the event callback for events of type
<tt>&quot;GUESTFS_EVENT_LIBVIRT_AUTH&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Return the list
of credentials requested by libvirt. Possible values are a
subset of the strings provided when you called
<tt>&quot;$g&minus;&gt;set_libvirt_supported_credentials&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>LIBVIRT AUTHENTICATION&quot;</small> in
<i>guestfs</i>(3) for documentation and example code.</p>

<p style="margin-left:11%;">$memsize =
$g&minus;&gt;get_memsize ();</p>

<p style="margin-left:17%;">This gets the memory size in
megabytes allocated to the hypervisor.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>&quot;$g&minus;&gt;set_memsize&quot;</tt> was not called
on this handle, and if
<tt>&quot;LIBGUESTFS_MEMSIZE&quot;</tt> was not set, then
this returns the compiled-in default value for memsize.</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on the architecture of libguestfs, see
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$network =
$g&minus;&gt;get_network ();</p>

<p style="margin-left:17%;">This returns the enable network
flag.</p>

<p style="margin-left:11%;">$path = $g&minus;&gt;get_path
();</p>

<p style="margin-left:17%;">Return the current search
path.</p>

<p style="margin-left:17%; margin-top: 1em">This is always
non-NULL. If it wasn&rsquo;t set already, then this will
return the default path.</p>

<p style="margin-left:11%;">$pgroup =
$g&minus;&gt;get_pgroup ();</p>

<p style="margin-left:17%;">This returns the process group
flag.</p>

<p style="margin-left:11%;">$pid = $g&minus;&gt;get_pid
();</p>

<p style="margin-left:17%;">Return the process
<small>ID</small> of the hypervisor. If there is no
hypervisor running, then this will return an error.</p>

<p style="margin-left:17%; margin-top: 1em">This is an
internal call used for debugging and testing.</p>

<p style="margin-left:11%;">$program =
$g&minus;&gt;get_program ();</p>

<p style="margin-left:17%;">Get the program name. See
<tt>&quot;$g&minus;&gt;set_program&quot;</tt>.</p>

<p style="margin-left:11%;">$hv = $g&minus;&gt;get_qemu
();</p>

<p style="margin-left:17%;">Return the current hypervisor
binary (usually qemu).</p>

<p style="margin-left:17%; margin-top: 1em">This is always
non-NULL. If it wasn&rsquo;t set already, then this will
return the default qemu binary name.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;get_hv&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$recoveryproc =
$g&minus;&gt;get_recovery_proc ();</p>

<p style="margin-left:17%;">Return the recovery process
enabled flag.</p>

<p style="margin-left:11%;">$selinux =
$g&minus;&gt;get_selinux ();</p>

<p style="margin-left:17%;">This returns the current
setting of the selinux flag which is passed to the appliance
at boot time. See
<tt>&quot;$g&minus;&gt;set_selinux&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on the architecture of libguestfs, see
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;selinux_relabel&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$smp = $g&minus;&gt;get_smp
();</p>

<p style="margin-left:17%;">This returns the number of
virtual CPUs assigned to the appliance.</p>

<p style="margin-left:11%;">$state = $g&minus;&gt;get_state
();</p>

<p style="margin-left:17%;">This returns the current state
as an opaque integer. This is only useful for printing debug
and internal error messages.</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on states, see <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$tmpdir =
$g&minus;&gt;get_tmpdir ();</p>

<p style="margin-left:17%;">Get the directory used by the
handle to store temporary files.</p>

<p style="margin-left:11%;">$trace = $g&minus;&gt;get_trace
();</p>

<p style="margin-left:17%;">Return the command trace
flag.</p>

<p style="margin-left:11%;">$mask = $g&minus;&gt;get_umask
();</p>

<p style="margin-left:17%;">Return the current umask. By
default the umask is <tt>022</tt> unless it has been set by
calling <tt>&quot;$g&minus;&gt;umask&quot;</tt>.</p>

<p style="margin-left:11%;">$verbose =
$g&minus;&gt;get_verbose ();</p>

<p style="margin-left:17%;">This returns the verbose
messages flag.</p>

<p style="margin-left:11%;">$context = $g&minus;&gt;getcon
();</p>

<p style="margin-left:17%;">This gets the SELinux security
context of the daemon.</p>

<p style="margin-left:17%; margin-top: 1em">See the
documentation about <small>SELINUX</small> in
<i>guestfs</i>(3), and
<tt>&quot;$g&minus;&gt;setcon&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;selinux&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;selinux_relabel&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$xattr = $g&minus;&gt;getxattr
($path, $name);</p>

<p style="margin-left:17%;">Get a single extended attribute
from file <tt>&quot;path&quot;</tt> named
<tt>&quot;name&quot;</tt>. This call follows symlinks. If
you want to lookup an extended attribute for the symlink
itself, use <tt>&quot;$g&minus;&gt;lgetxattr&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Normally it is
better to get all extended attributes from a file in one go
by calling <tt>&quot;$g&minus;&gt;getxattrs&quot;</tt>.
However some Linux filesystem implementations are buggy and
do not provide a way to list out attributes. For these
filesystems (notably ntfs&minus;3g) you have to know the
names of the extended attributes you want in advance and
call this function.</p>

<p style="margin-left:17%; margin-top: 1em">Extended
attribute values are blobs of binary data. If there is no
extended attribute named <tt>&quot;name&quot;</tt>, this
returns an error.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;getxattrs&quot;</tt>,
<tt>&quot;$g&minus;&gt;lgetxattr&quot;</tt>,
<i>attr</i>(5).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@xattrs =
$g&minus;&gt;getxattrs ($path);</p>

<p style="margin-left:17%;">This call lists the extended
attributes of the file or directory
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">At the system
call level, this is a combination of the <i>listxattr</i>(2)
and <i>getxattr</i>(2) calls.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;lgetxattrs&quot;</tt>,
<i>attr</i>(5).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@paths =
$g&minus;&gt;glob_expand ($pattern [, directoryslash =&gt;
<br>
$directoryslash]);</p>

<p style="margin-left:17%;">This command searches for all
the pathnames matching <tt>&quot;pattern&quot;</tt>
according to the wildcard expansion rules used by the
shell.</p>

<p style="margin-left:17%; margin-top: 1em">If no paths
match, then this returns an empty list (note: not an
error).</p>

<p style="margin-left:17%; margin-top: 1em">It is just a
wrapper around the C <i>glob</i>(3) function with flags
<tt>&quot;GLOB_MARK|GLOB_BRACE&quot;</tt>. See that manual
page for more details.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;directoryslash&quot;</tt>
controls whether use the <tt>&quot;GLOB_MARK&quot;</tt> flag
for <i>glob</i>(3), and it defaults to true. It can be
explicitly set as off to return no trailing slashes in
filenames of directories.</p>

<p style="margin-left:17%; margin-top: 1em">Notice that
there is no equivalent command for expanding a device name
(eg. <i>/dev/sd*</i>). Use
<tt>&quot;$g&minus;&gt;list_devices&quot;</tt>,
<tt>&quot;$g&minus;&gt;list_partitions&quot;</tt> etc
functions instead.</p>

<p style="margin-left:11%;">@paths =
$g&minus;&gt;glob_expand_opts ($pattern [, directoryslash
=&gt; <br>
$directoryslash]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;glob_expand&quot;.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;grep
($regex, $path [, extended =&gt; $extended] [, fixed =&gt;
<br>
$fixed] [, insensitive =&gt; $insensitive] [, compressed
=&gt; $compressed]);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;grep&quot;</tt> program and returns the matching
lines.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
flags are: <br>
&quot;extended&quot;</p>

<p style="margin-left:23%;">Use extended regular
expressions. This is the same as using the <i>&minus;E</i>
flag.</p>

<p style="margin-left:17%;">&quot;fixed&quot;</p>

<p style="margin-left:23%;">Match fixed (don&rsquo;t use
regular expressions). This is the same as using the
<i>&minus;F</i> flag.</p>

<p style="margin-left:17%;">&quot;insensitive&quot;</p>

<p style="margin-left:23%;">Match case-insensitive. This is
the same as using the <i>&minus;i</i> flag.</p>

<p style="margin-left:17%;">&quot;compressed&quot;</p>

<p style="margin-left:23%;">Use <tt>&quot;zgrep&quot;</tt>
instead of <tt>&quot;grep&quot;</tt>. This allows the input
to be compress&minus; or gzip-compressed.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;grep_opts
($regex, $path [, extended =&gt; $extended] [, <br>
fixed =&gt; $fixed] [, insensitive =&gt; $insensitive] [,
compressed =&gt; <br>
$compressed]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;grep&quot;.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;grepi
($regex, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;grep &minus;i&quot;</tt> program and returns the
matching lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;grub_install
($root, $device);</p>

<p style="margin-left:17%;">This command installs
<small>GRUB 1</small> (the Grand Unified Bootloader) on
<tt>&quot;device&quot;</tt>, with the root directory being
<tt>&quot;root&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Notes:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>There is currently no way in the <small>API</small> to
install grub2, which is used by most modern Linux guests. It
is possible to run the grub2 command from the guest,
although see the caveats in &quot; <small>RUNNING
COMMANDS&quot;</small> in <i>guestfs</i>(3).</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>This uses <tt>&quot;grub&minus;install&quot;</tt> from
the host. Unfortunately grub is not always compatible with
itself, so this only works in rather narrow circumstances.
Careful testing with each guest version is advisable.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>If grub-install reports the error &quot;No suitable
drive was found in the generated device map.&quot; it may be
that you need to create a <i>/boot/grub/device.map</i> file
first that contains the mapping between grub device names
and Linux device names. It is usually sufficient to create a
file containing:</p></td></tr>
</table>

<pre style="margin-left:23%; margin-top: 1em"> (hd0) /dev/vda</pre>


<p style="margin-left:23%; margin-top: 1em">replacing
<i>/dev/vda</i> with the name of the installation
device.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;grub&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;head
($path);</p>

<p style="margin-left:17%;">This command returns up to the
first 10 lines of a file as a list of strings.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;head_n
($nrlines, $path);</p>

<p style="margin-left:17%;">If the parameter
<tt>&quot;nrlines&quot;</tt> is a positive number, this
returns the first <tt>&quot;nrlines&quot;</tt> lines of the
file <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If the
parameter <tt>&quot;nrlines&quot;</tt> is a negative number,
this returns lines from the file <tt>&quot;path&quot;</tt>,
excluding the last <tt>&quot;nrlines&quot;</tt> lines.</p>

<p style="margin-left:17%; margin-top: 1em">If the
parameter <tt>&quot;nrlines&quot;</tt> is zero, this returns
an empty list.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$dump = $g&minus;&gt;hexdump
($path);</p>

<p style="margin-left:17%;">This runs <tt>&quot;hexdump
&minus;C&quot;</tt> on the given <tt>&quot;path&quot;</tt>.
The result is the human-readable, canonical hex dump of the
file.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;hivex_close
();</p>

<p style="margin-left:17%;">Close the current hivex
handle.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;hivex_commit
($filename);</p>

<p style="margin-left:17%;">Commit (write) changes to the
hive.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
<i>filename</i> parameter is null, then the changes are
written back to the same hive that was opened. If this is
not null then they are written to the alternate filename
given and the original hive is left untouched.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$nodeh =
$g&minus;&gt;hivex_node_add_child ($parent, $name);</p>

<p style="margin-left:17%;">Add a child node to
<tt>&quot;parent&quot;</tt> named
<tt>&quot;name&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@nodehs =
$g&minus;&gt;hivex_node_children ($nodeh);</p>

<p style="margin-left:17%;">Return the list of nodes which
are subkeys of <tt>&quot;nodeh&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;hivex_node_delete_child
($nodeh);</p>

<p style="margin-left:17%;">Delete
<tt>&quot;nodeh&quot;</tt>, recursively if necessary.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$child =
$g&minus;&gt;hivex_node_get_child ($nodeh, $name);</p>

<p style="margin-left:17%;">Return the child of
<tt>&quot;nodeh&quot;</tt> with the name
<tt>&quot;name&quot;</tt>, if it exists. This can return
<tt>0</tt> meaning the name was not found.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$valueh =
$g&minus;&gt;hivex_node_get_value ($nodeh, $key);</p>

<p style="margin-left:17%;">Return the value attached to
<tt>&quot;nodeh&quot;</tt> which has the name
<tt>&quot;key&quot;</tt>, if it exists. This can return
<tt>0</tt> meaning the key was not found.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$name =
$g&minus;&gt;hivex_node_name ($nodeh);</p>

<p style="margin-left:17%;">Return the name of
<tt>&quot;nodeh&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$parent =
$g&minus;&gt;hivex_node_parent ($nodeh);</p>

<p style="margin-left:17%;">Return the parent node of
<tt>&quot;nodeh&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;hivex_node_set_value
($nodeh, $key, $t, $val);</p>

<p style="margin-left:17%;">Set or replace a single value
under the node <tt>&quot;nodeh&quot;</tt>. The
<tt>&quot;key&quot;</tt> is the name, <tt>&quot;t&quot;</tt>
is the type, and <tt>&quot;val&quot;</tt> is the data.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@valuehs =
$g&minus;&gt;hivex_node_values ($nodeh);</p>

<p style="margin-left:17%;">Return the array of (key,
datatype, data) tuples attached to
<tt>&quot;nodeh&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;hivex_open
($filename [, verbose =&gt; $verbose] [, debug =&gt; $debug]
<br>
[, write =&gt; $write]);</p>

<p style="margin-left:17%;">Open the Windows Registry hive
file named <i>filename</i>. If there was any previous hivex
handle associated with this guestfs session, then it is
closed.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$nodeh =
$g&minus;&gt;hivex_root ();</p>

<p style="margin-left:17%;">Return the root node of the
hive.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$key =
$g&minus;&gt;hivex_value_key ($valueh);</p>

<p style="margin-left:17%;">Return the key (name) field of
a (key, datatype, data) tuple.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$datatype =
$g&minus;&gt;hivex_value_type ($valueh);</p>

<p style="margin-left:17%;">Return the data type field from
a (key, datatype, data) tuple.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$databuf =
$g&minus;&gt;hivex_value_utf8 ($valueh);</p>

<p style="margin-left:17%;">This calls
<tt>&quot;$g&minus;&gt;hivex_value_value&quot;</tt> (which
returns the data field from a hivex value tuple). It then
assumes that the field is a <small>UTF&minus;16LE</small>
string and converts the result to <small>UTF&minus;8</small>
(or if this is not possible, it returns an error).</p>

<p style="margin-left:17%; margin-top: 1em">This is useful
for reading strings out of the Windows registry. However it
is not foolproof because the registry is not strongly-typed
and fields can contain arbitrary or unexpected data.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$databuf =
$g&minus;&gt;hivex_value_value ($valueh);</p>

<p style="margin-left:17%;">Return the data field of a
(key, datatype, data) tuple.</p>

<p style="margin-left:17%; margin-top: 1em">This is a
wrapper around the <i>hivex</i>(3) call of the same
name.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;hivex_value_utf8&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;hivex&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$content =
$g&minus;&gt;initrd_cat ($initrdpath, $filename);</p>

<p style="margin-left:17%;">This command unpacks the file
<i>filename</i> from the initrd file called
<i>initrdpath</i>. The filename must be given <i>without</i>
the initial <i>/</i> character.</p>

<p style="margin-left:17%; margin-top: 1em">For example, in
guestfish you could use the following command to examine the
boot script (usually called <i>/init</i>) contained in a
Linux initrd or initramfs image:</p>

<pre style="margin-left:17%; margin-top: 1em"> initrd&minus;cat /boot/initrd&minus;&lt;version&gt;.img init</pre>


<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;initrd_list&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">@filenames =
$g&minus;&gt;initrd_list ($path);</p>

<p style="margin-left:17%;">This command lists out files
contained in an initrd.</p>

<p style="margin-left:17%; margin-top: 1em">The files are
listed without any initial <i>/</i> character. The files are
listed in the order they appear (not necessarily
alphabetical). Directory names are listed as separate
items.</p>

<p style="margin-left:17%; margin-top: 1em">Old Linux
kernels (2.4 and earlier) used a compressed ext2 filesystem
as initrd. We <i>only</i> support the newer initramfs format
(compressed cpio files).</p>

<p style="margin-left:11%;">$wd =
$g&minus;&gt;inotify_add_watch ($path, $mask);</p>

<p style="margin-left:17%;">Watch <tt>&quot;path&quot;</tt>
for the events listed in <tt>&quot;mask&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that if
<tt>&quot;path&quot;</tt> is a directory then events within
that directory are watched, but this does <i>not</i> happen
recursively (in subdirectories).</p>

<p style="margin-left:17%; margin-top: 1em">Note for non-C
or non-Linux callers: the inotify events are defined by the
Linux kernel <small>ABI</small> and are listed in
<i>/usr/include/sys/inotify.h</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;inotify&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;inotify_close
();</p>

<p style="margin-left:17%;">This closes the inotify handle
which was previously opened by inotify_init. It removes all
watches, throws away any pending events, and deallocates all
resources.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;inotify&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@paths =
$g&minus;&gt;inotify_files ();</p>

<p style="margin-left:17%;">This function is a helpful
wrapper around
<tt>&quot;$g&minus;&gt;inotify_read&quot;</tt> which just
returns a list of pathnames of objects that were touched.
The returned pathnames are sorted and deduplicated.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;inotify&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;inotify_init
($maxevents);</p>

<p style="margin-left:17%;">This command creates a new
inotify handle. The inotify subsystem can be used to notify
events which happen to objects in the guest filesystem.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;maxevents&quot;</tt>
is the maximum number of events which will be queued up
between calls to
<tt>&quot;$g&minus;&gt;inotify_read&quot;</tt> or
<tt>&quot;$g&minus;&gt;inotify_files&quot;</tt>. If this is
passed as <tt>0</tt>, then the kernel (or previously set)
default is used. For Linux 2.6.29 the default was 16384
events. Beyond this limit, the kernel throws away events,
but records the fact that it threw them away by setting a
flag <tt>&quot;IN_Q_OVERFLOW&quot;</tt> in the returned
structure list (see
<tt>&quot;$g&minus;&gt;inotify_read&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">Before any
events are generated, you have to add some watches to the
internal watch list. See:
<tt>&quot;$g&minus;&gt;inotify_add_watch&quot;</tt> and
<tt>&quot;$g&minus;&gt;inotify_rm_watch&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Queued up
events should be read periodically by calling
<tt>&quot;$g&minus;&gt;inotify_read&quot;</tt> (or
<tt>&quot;$g&minus;&gt;inotify_files&quot;</tt> which is
just a helpful wrapper around
<tt>&quot;$g&minus;&gt;inotify_read&quot;</tt>). If you
don&rsquo;t read the events out often enough then you risk
the internal queue overflowing.</p>

<p style="margin-left:17%; margin-top: 1em">The handle
should be closed after use by calling
<tt>&quot;$g&minus;&gt;inotify_close&quot;</tt>. This also
removes any watches automatically.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>inotify</i>(7) for an overview of the inotify interface
as exposed by the Linux kernel, which is roughly what we
expose via libguestfs. Note that there is one global inotify
handle per libguestfs instance.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;inotify&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@events =
$g&minus;&gt;inotify_read ();</p>

<p style="margin-left:17%;">Return the complete queue of
events that have happened since the previous read call.</p>

<p style="margin-left:17%; margin-top: 1em">If no events
have happened, this returns an empty list.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note</i>: In
order to make sure that all events have been read, you must
call this function repeatedly until it returns an empty
list. The reason is that the call will read events up to the
maximum appliance-to-host message size and leave remaining
events in the queue.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;inotify&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;inotify_rm_watch
($wd);</p>

<p style="margin-left:17%;">Remove a previously defined
inotify watch. See
<tt>&quot;$g&minus;&gt;inotify_add_watch&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;inotify&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$arch =
$g&minus;&gt;inspect_get_arch ($root);</p>

<p style="margin-left:17%;">This returns the architecture
of the inspected operating system. The possible return
values are listed under
<tt>&quot;$g&minus;&gt;file_architecture&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If the
architecture could not be determined, then the string
<tt>&quot;unknown&quot;</tt> is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$distro =
$g&minus;&gt;inspect_get_distro ($root);</p>

<p style="margin-left:17%;">This returns the distro
(distribution) of the inspected operating system.</p>

<p style="margin-left:17%; margin-top: 1em">Currently
defined distros are: <br>
&quot;alpinelinux&quot;</p>

<p style="margin-left:23%;">Alpine Linux.</p>

<p style="margin-left:17%;">&quot;altlinux&quot;</p>

<p style="margin-left:23%;"><small>ALT</small> Linux.</p>

<p style="margin-left:17%;">&quot;archlinux&quot;</p>

<p style="margin-left:23%;">Arch Linux.</p>

<p style="margin-left:17%;">&quot;buildroot&quot;</p>

<p style="margin-left:23%;">Buildroot-derived distro, but
not one we specifically recognize.</p>

<p style="margin-left:17%;">&quot;centos&quot;</p>

<p style="margin-left:23%;">CentOS.</p>

<p style="margin-left:17%;">&quot;cirros&quot;</p>

<p style="margin-left:23%;">Cirros.</p>

<p style="margin-left:17%;">&quot;coreos&quot;</p>

<p style="margin-left:23%;">CoreOS.</p>

<p style="margin-left:17%;">&quot;debian&quot;</p>

<p style="margin-left:23%;">Debian.</p>

<p style="margin-left:17%;">&quot;fedora&quot;</p>

<p style="margin-left:23%;">Fedora.</p>

<p style="margin-left:17%;">&quot;freebsd&quot;</p>

<p style="margin-left:23%;">FreeBSD.</p>

<p style="margin-left:17%;">&quot;freedos&quot;</p>

<p style="margin-left:23%;">FreeDOS.</p>

<p style="margin-left:17%;">&quot;frugalware&quot;</p>

<p style="margin-left:23%;">Frugalware.</p>

<p style="margin-left:17%;">&quot;gentoo&quot;</p>

<p style="margin-left:23%;">Gentoo.</p>

<p style="margin-left:17%;">&quot;linuxmint&quot;</p>

<p style="margin-left:23%;">Linux Mint.</p>

<p style="margin-left:17%;">&quot;mageia&quot;</p>

<p style="margin-left:23%;">Mageia.</p>

<p style="margin-left:17%;">&quot;mandriva&quot;</p>

<p style="margin-left:23%;">Mandriva.</p>

<p style="margin-left:17%;">&quot;meego&quot;</p>

<p style="margin-left:23%;">MeeGo.</p>

<p style="margin-left:17%;">&quot;netbsd&quot;</p>

<p style="margin-left:23%;">NetBSD.</p>

<p style="margin-left:17%;">&quot;openbsd&quot;</p>

<p style="margin-left:23%;">OpenBSD.</p>

<p style="margin-left:17%;">&quot;opensuse&quot;</p>

<p style="margin-left:23%;">OpenSUSE.</p>

<p style="margin-left:17%;">&quot;oraclelinux&quot;</p>

<p style="margin-left:23%;">Oracle Linux.</p>

<p style="margin-left:17%;">&quot;pardus&quot;</p>

<p style="margin-left:23%;">Pardus.</p>

<p style="margin-left:17%;">&quot;pldlinux&quot;</p>

<p style="margin-left:23%;"><small>PLD</small> Linux.</p>

<p style="margin-left:17%;">&quot;redhat-based&quot;</p>

<p style="margin-left:23%;">Some Red Hat-derived
distro.</p>

<p style="margin-left:17%;">&quot;rhel&quot;</p>

<p style="margin-left:23%;">Red Hat Enterprise Linux.</p>


<p style="margin-left:17%;">&quot;scientificlinux&quot;</p>

<p style="margin-left:23%;">Scientific Linux.</p>

<p style="margin-left:17%;">&quot;slackware&quot;</p>

<p style="margin-left:23%;">Slackware.</p>

<p style="margin-left:17%;">&quot;sles&quot;</p>

<p style="margin-left:23%;">SuSE Linux Enterprise Server or
Desktop.</p>

<p style="margin-left:17%;">&quot;suse-based&quot;</p>

<p style="margin-left:23%;">Some openSuSE-derived
distro.</p>

<p style="margin-left:17%;">&quot;ttylinux&quot;</p>

<p style="margin-left:23%;">ttylinux.</p>

<p style="margin-left:17%;">&quot;ubuntu&quot;</p>

<p style="margin-left:23%;">Ubuntu.</p>

<p style="margin-left:17%;">&quot;unknown&quot;</p>

<p style="margin-left:23%;">The distro could not be
determined.</p>

<p style="margin-left:17%;">&quot;windows&quot;</p>

<p style="margin-left:23%;">Windows does not have
distributions. This string is returned if the
<small>OS</small> type is Windows.</p>

<p style="margin-left:17%; margin-top: 1em">Future versions
of libguestfs may return other strings here. The caller
should be prepared to handle any string.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">%drives =
$g&minus;&gt;inspect_get_drive_mappings ($root);</p>

<p style="margin-left:17%;">This call is useful for Windows
which uses a primitive system of assigning drive letters
(like <i>C:\</i>) to partitions. This inspection
<small>API</small> examines the Windows Registry to find out
how disks/partitions are mapped to drive letters, and
returns a hash table as in the example below:</p>

<pre style="margin-left:17%; margin-top: 1em"> C      =&gt;     /dev/vda2
 E      =&gt;     /dev/vdb1
 F      =&gt;     /dev/vdc1</pre>


<p style="margin-left:17%; margin-top: 1em">Note that keys
are drive letters. For Windows, the key is case insensitive
and just contains the drive letter, without the customary
colon separator character.</p>

<p style="margin-left:17%; margin-top: 1em">In future we
may support other operating systems that also used drive
letters, but the keys for those might not be case
insensitive and might be longer than 1 character. For
example in <small>OS&minus;9,</small> hard drives were named
<tt>&quot;h0&quot;</tt>, <tt>&quot;h1&quot;</tt> etc.</p>

<p style="margin-left:17%; margin-top: 1em">For Windows
guests, currently only hard drive mappings are returned.
Removable disks (eg. DVD-ROMs) are ignored.</p>

<p style="margin-left:17%; margin-top: 1em">For guests that
do not use drive mappings, or if the drive mappings could
not be determined, this returns an empty hash table.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details. See also
<tt>&quot;$g&minus;&gt;inspect_get_mountpoints&quot;</tt>,
<tt>&quot;$g&minus;&gt;inspect_get_filesystems&quot;</tt>.</p>

<p style="margin-left:11%;">@filesystems =
$g&minus;&gt;inspect_get_filesystems ($root);</p>

<p style="margin-left:17%;">This returns a list of all the
filesystems that we think are associated with this operating
system. This includes the root filesystem, other ordinary
filesystems, and non-mounted devices like swap
partitions.</p>

<p style="margin-left:17%; margin-top: 1em">In the case of
a multi-boot virtual machine, it is possible for a
filesystem to be shared between operating systems.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details. See also
<tt>&quot;$g&minus;&gt;inspect_get_mountpoints&quot;</tt>.</p>

<p style="margin-left:11%;">$format =
$g&minus;&gt;inspect_get_format ($root);</p>

<p style="margin-left:17%;">This returns the format of the
inspected operating system. You can use it to detect install
images, live CDs and similar.</p>

<p style="margin-left:17%; margin-top: 1em">Currently
defined formats are: <br>
&quot;installed&quot;</p>

<p style="margin-left:23%;">This is an installed operating
system.</p>

<p style="margin-left:17%;">&quot;installer&quot;</p>

<p style="margin-left:23%;">The disk image being inspected
is not an installed operating system, but a <i>bootable</i>
install disk, live <small>CD,</small> or similar.</p>

<p style="margin-left:17%;">&quot;unknown&quot;</p>

<p style="margin-left:23%;">The format of this disk image
is not known.</p>

<p style="margin-left:17%; margin-top: 1em">Future versions
of libguestfs may return other strings here. The caller
should be prepared to handle any string.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$hostname =
$g&minus;&gt;inspect_get_hostname ($root);</p>

<p style="margin-left:17%;">This function returns the
hostname of the operating system as found by inspection of
the guest&rsquo;s configuration files.</p>

<p style="margin-left:17%; margin-top: 1em">If the hostname
could not be determined, then the string
<tt>&quot;unknown&quot;</tt> is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$icon =
$g&minus;&gt;inspect_get_icon ($root [, favicon =&gt;
$favicon] [, <br>
highquality =&gt; $highquality]);</p>

<p style="margin-left:17%;">This function returns an icon
corresponding to the inspected operating system. The icon is
returned as a buffer containing a <small>PNG</small> image
(re-encoded to <small>PNG</small> if necessary).</p>

<p style="margin-left:17%; margin-top: 1em">If it was not
possible to get an icon this function returns a zero-length
(non-NULL) buffer. <i>Callers must check for this
case</i>.</p>

<p style="margin-left:17%; margin-top: 1em">Libguestfs will
start by looking for a file called <i>/etc/favicon.png</i>
or <i>C:\etc\favicon.png</i> and if it has the correct
format, the contents of this file will be returned. You can
disable favicons by passing the optional
<tt>&quot;favicon&quot;</tt> boolean as false (default is
true).</p>

<p style="margin-left:17%; margin-top: 1em">If finding the
favicon fails, then we look in other places in the guest for
a suitable icon.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
<tt>&quot;highquality&quot;</tt> boolean is true then only
high quality icons are returned, which means only icons of
high resolution with an alpha channel. The default (false)
is to return any icon we can, even if it is of substandard
quality.</p>

<p style="margin-left:17%; margin-top: 1em">Notes:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Unlike most other inspection <small>API</small> calls,
the guest&rsquo;s disks must be mounted up before you call
this, since it needs to read information from the guest
filesystem during the call.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p><b>Security:</b> The icon data comes from the untrusted
guest, and should be treated with caution.
<small>PNG</small> files have been known to contain
exploits. Ensure that libpng (or other relevant libraries)
are fully up to date before trying to process or display the
icon.</p> </td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>The <small>PNG</small> image returned can be any size.
It might not be square. Libguestfs tries to return the
largest, highest quality icon available. The application
must scale the icon to the required size.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Extracting icons from Windows guests requires the
external <tt>&quot;wrestool&quot;</tt> program from the
<tt>&quot;icoutils&quot;</tt> package, and several programs
(<tt>&quot;bmptopnm&quot;</tt>,
<tt>&quot;pnmtopng&quot;</tt>, <tt>&quot;pamcut&quot;</tt>)
from the <tt>&quot;netpbm&quot;</tt> package. These must be
installed separately.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="77%">


<p>Operating system icons are usually trademarks. Seek
legal advice before using trademarks in applications.</p></td></tr>
</table>

<p style="margin-left:11%;">$major =
$g&minus;&gt;inspect_get_major_version ($root);</p>

<p style="margin-left:17%;">This returns the major version
number of the inspected operating system.</p>

<p style="margin-left:17%; margin-top: 1em">Windows uses a
consistent versioning scheme which is <i>not</i> reflected
in the popular public names used by the operating system.
Notably the operating system known as &quot;Windows 7&quot;
is really version 6.1 (ie. major = 6, minor = 1). You can
find out the real versions corresponding to releases of
Windows by consulting Wikipedia or <small>MSDN.</small></p>

<p style="margin-left:17%; margin-top: 1em">If the version
could not be determined, then <tt>0</tt> is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$minor =
$g&minus;&gt;inspect_get_minor_version ($root);</p>

<p style="margin-left:17%;">This returns the minor version
number of the inspected operating system.</p>

<p style="margin-left:17%; margin-top: 1em">If the version
could not be determined, then <tt>0</tt> is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details. See also
<tt>&quot;$g&minus;&gt;inspect_get_major_version&quot;</tt>.</p>

<p style="margin-left:11%;">%mountpoints =
$g&minus;&gt;inspect_get_mountpoints ($root);</p>

<p style="margin-left:17%;">This returns a hash of where we
think the filesystems associated with this operating system
should be mounted. Callers should note that this is at best
an educated guess made by reading configuration files such
as <i>/etc/fstab</i>. <i>In particular note</i> that this
may return filesystems which are non-existent or not
mountable and callers should be prepared to handle or ignore
failures if they try to mount them.</p>

<p style="margin-left:17%; margin-top: 1em">Each element in
the returned hashtable has a key which is the path of the
mountpoint (eg. <i>/boot</i>) and a value which is the
filesystem that would be mounted there (eg.
<i>/dev/sda1</i>).</p>

<p style="margin-left:17%; margin-top: 1em">Non-mounted
devices such as swap devices are <i>not</i> returned in this
list.</p>

<p style="margin-left:17%; margin-top: 1em">For operating
systems like Windows which still use drive letters, this
call will only return an entry for the first drive
&quot;mounted on&quot; <i>/</i>. For information about the
mapping of drive letters to partitions, see
<tt>&quot;$g&minus;&gt;inspect_get_drive_mappings&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details. See also
<tt>&quot;$g&minus;&gt;inspect_get_filesystems&quot;</tt>.</p>

<p style="margin-left:11%;">$packageformat =
$g&minus;&gt;inspect_get_package_format ($root);</p>

<p style="margin-left:17%;">This function and
<tt>&quot;$g&minus;&gt;inspect_get_package_management&quot;</tt>
return the package format and package management tool used
by the inspected operating system. For example for Fedora
these functions would return <tt>&quot;rpm&quot;</tt>
(package format), and <tt>&quot;yum&quot;</tt> or
<tt>&quot;dnf&quot;</tt> (package management).</p>

<p style="margin-left:17%; margin-top: 1em">This returns
the string <tt>&quot;unknown&quot;</tt> if we could not
determine the package format <i>or</i> if the operating
system does not have a real packaging system (eg.
Windows).</p>

<p style="margin-left:17%; margin-top: 1em">Possible
strings include: <tt>&quot;rpm&quot;</tt>,
<tt>&quot;deb&quot;</tt>, <tt>&quot;ebuild&quot;</tt>,
<tt>&quot;pisi&quot;</tt>, <tt>&quot;pacman&quot;</tt>,
<tt>&quot;pkgsrc&quot;</tt>, <tt>&quot;apk&quot;</tt>.
Future versions of libguestfs may return other strings.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$packagemanagement =
$g&minus;&gt;inspect_get_package_management ($root);</p>


<p style="margin-left:17%;"><tt>&quot;$g&minus;&gt;inspect_get_package_format&quot;</tt>
and this function return the package format and package
management tool used by the inspected operating system. For
example for Fedora these functions would return
<tt>&quot;rpm&quot;</tt> (package format), and
<tt>&quot;yum&quot;</tt> or <tt>&quot;dnf&quot;</tt>
(package management).</p>

<p style="margin-left:17%; margin-top: 1em">This returns
the string <tt>&quot;unknown&quot;</tt> if we could not
determine the package management tool <i>or</i> if the
operating system does not have a real packaging system (eg.
Windows).</p>

<p style="margin-left:17%; margin-top: 1em">Possible
strings include: <tt>&quot;yum&quot;</tt>,
<tt>&quot;dnf&quot;</tt>, <tt>&quot;up2date&quot;</tt>,
<tt>&quot;apt&quot;</tt> (for all Debian derivatives),
<tt>&quot;portage&quot;</tt>, <tt>&quot;pisi&quot;</tt>,
<tt>&quot;pacman&quot;</tt>, <tt>&quot;urpmi&quot;</tt>,
<tt>&quot;zypper&quot;</tt>, <tt>&quot;apk&quot;</tt>.
Future versions of libguestfs may return other strings.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$product =
$g&minus;&gt;inspect_get_product_name ($root);</p>

<p style="margin-left:17%;">This returns the product name
of the inspected operating system. The product name is
generally some freeform string which can be displayed to the
user, but should not be parsed by programs.</p>

<p style="margin-left:17%; margin-top: 1em">If the product
name could not be determined, then the string
<tt>&quot;unknown&quot;</tt> is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$variant =
$g&minus;&gt;inspect_get_product_variant ($root);</p>

<p style="margin-left:17%;">This returns the product
variant of the inspected operating system.</p>

<p style="margin-left:17%; margin-top: 1em">For Windows
guests, this returns the contents of the Registry key
<tt>&quot;HKLM\Software\Microsoft\Windows
NT\CurrentVersion&quot; &quot;InstallationType&quot;</tt>
which is usually a string such as
<tt>&quot;Client&quot;</tt> or <tt>&quot;Server&quot;</tt>
(other values are possible). This can be used to distinguish
consumer and enterprise versions of Windows that have the
same version number (for example, Windows 7 and Windows 2008
Server are both version 6.1, but the former is
<tt>&quot;Client&quot;</tt> and the latter is
<tt>&quot;Server&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">For enterprise
Linux guests, in future we intend this to return the product
variant such as <tt>&quot;Desktop&quot;</tt>,
<tt>&quot;Server&quot;</tt> and so on. But this is not
implemented at present.</p>

<p style="margin-left:17%; margin-top: 1em">If the product
variant could not be determined, then the string
<tt>&quot;unknown&quot;</tt> is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details. See also
<tt>&quot;$g&minus;&gt;inspect_get_product_name&quot;</tt>,
<tt>&quot;$g&minus;&gt;inspect_get_major_version&quot;</tt>.</p>

<p style="margin-left:11%;">@roots =
$g&minus;&gt;inspect_get_roots ();</p>

<p style="margin-left:17%;">This function is a convenient
way to get the list of root devices, as returned from a
previous call to
<tt>&quot;$g&minus;&gt;inspect_os&quot;</tt>, but without
redoing the whole inspection process.</p>

<p style="margin-left:17%; margin-top: 1em">This returns an
empty list if either no root devices were found or the
caller has not called
<tt>&quot;$g&minus;&gt;inspect_os&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$name =
$g&minus;&gt;inspect_get_type ($root);</p>

<p style="margin-left:17%;">This returns the type of the
inspected operating system. Currently defined types are:
<br>
&quot;linux&quot;</p>

<p style="margin-left:23%;">Any Linux-based operating
system.</p>

<p style="margin-left:17%;">&quot;windows&quot;</p>

<p style="margin-left:23%;">Any Microsoft Windows operating
system.</p>

<p style="margin-left:17%;">&quot;freebsd&quot;</p>

<p style="margin-left:23%;">FreeBSD.</p>

<p style="margin-left:17%;">&quot;netbsd&quot;</p>

<p style="margin-left:23%;">NetBSD.</p>

<p style="margin-left:17%;">&quot;openbsd&quot;</p>

<p style="margin-left:23%;">OpenBSD.</p>

<p style="margin-left:17%;">&quot;hurd&quot;</p>

<p style="margin-left:23%;">GNU/Hurd.</p>

<p style="margin-left:17%;">&quot;dos&quot;</p>

<p style="margin-left:23%;">MS-DOS, FreeDOS and others.</p>

<p style="margin-left:17%;">&quot;minix&quot;</p>

<p style="margin-left:23%;"><small>MINIX.</small></p>

<p style="margin-left:17%;">&quot;unknown&quot;</p>

<p style="margin-left:23%;">The operating system type could
not be determined.</p>

<p style="margin-left:17%; margin-top: 1em">Future versions
of libguestfs may return other strings here. The caller
should be prepared to handle any string.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$controlset =
$g&minus;&gt;inspect_get_windows_current_control_set
($root);</p>

<p style="margin-left:17%;">This returns the Windows
CurrentControlSet of the inspected guest. The
CurrentControlSet is a registry key name such as
<tt>&quot;ControlSet001&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This call
assumes that the guest is Windows and that the Registry
could be examined by inspection. If this is not the case
then an error is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$systemroot =
$g&minus;&gt;inspect_get_windows_systemroot ($root);</p>

<p style="margin-left:17%;">This returns the Windows
systemroot of the inspected guest. The systemroot is a
directory path such as <i>/WINDOWS</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This call
assumes that the guest is Windows and that the systemroot
could be determined by inspection. If this is not the case
then an error is returned.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$live =
$g&minus;&gt;inspect_is_live ($root);</p>

<p style="margin-left:17%;">If
<tt>&quot;$g&minus;&gt;inspect_get_format&quot;</tt> returns
<tt>&quot;installer&quot;</tt> (this is an install disk),
then this returns true if a live image was detected on the
disk.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$multipart =
$g&minus;&gt;inspect_is_multipart ($root);</p>

<p style="margin-left:17%;">If
<tt>&quot;$g&minus;&gt;inspect_get_format&quot;</tt> returns
<tt>&quot;installer&quot;</tt> (this is an install disk),
then this returns true if the disk is part of a set.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">$netinst =
$g&minus;&gt;inspect_is_netinst ($root);</p>

<p style="margin-left:17%;">If
<tt>&quot;$g&minus;&gt;inspect_get_format&quot;</tt> returns
<tt>&quot;installer&quot;</tt> (this is an install disk),
then this returns true if the disk is a network installer,
ie. not a self-contained install <small>CD</small> but one
which is likely to require network access to complete the
install.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">@applications =
$g&minus;&gt;inspect_list_applications ($root);</p>

<p style="margin-left:17%;">Return the list of applications
installed in the operating system.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note:</i>
This call works differently from other parts of the
inspection <small>API.</small> You have to call
<tt>&quot;$g&minus;&gt;inspect_os&quot;</tt>, then
<tt>&quot;$g&minus;&gt;inspect_get_mountpoints&quot;</tt>,
then mount up the disks, before calling this. Listing
applications is a significantly more difficult operation
which requires access to the full filesystem. Also note that
unlike the other
<tt>&quot;$g&minus;&gt;inspect_get_*&quot;</tt> calls which
are just returning data cached in the libguestfs handle,
this call actually reads parts of the mounted filesystems
during the call.</p>

<p style="margin-left:17%; margin-top: 1em">This returns an
empty list if the inspection code was not able to determine
the list of applications.</p>

<p style="margin-left:17%; margin-top: 1em">The application
structure contains the following fields: <br>
&quot;app_name&quot;</p>

<p style="margin-left:23%;">The name of the application.
For Red Hat-derived and Debian-derived Linux guests, this is
the package name.</p>


<p style="margin-left:17%;">&quot;app_display_name&quot;</p>

<p style="margin-left:23%;">The display name of the
application, sometimes localized to the install language of
the guest operating system.</p>

<p style="margin-left:23%; margin-top: 1em">If unavailable
this is returned as an empty string <tt>&quot;&quot;</tt>.
Callers needing to display something can use
<tt>&quot;app_name&quot;</tt> instead.</p>

<p style="margin-left:17%;">&quot;app_epoch&quot;</p>

<p style="margin-left:23%;">For package managers which use
epochs, this contains the epoch of the package (an integer).
If unavailable, this is returned as <tt>0</tt>.</p>

<p style="margin-left:17%;">&quot;app_version&quot;</p>

<p style="margin-left:23%;">The version string of the
application or package. If unavailable this is returned as
an empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app_release&quot;</p>

<p style="margin-left:23%;">The release string of the
application or package, for package managers that use this.
If unavailable this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>


<p style="margin-left:17%;">&quot;app_install_path&quot;</p>

<p style="margin-left:23%;">The installation path of the
application (on operating systems such as Windows which use
installation paths). This path is in the format used by the
guest operating system, it is not a libguestfs path.</p>

<p style="margin-left:23%; margin-top: 1em">If unavailable
this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app_trans_path&quot;</p>

<p style="margin-left:23%;">The install path translated
into a libguestfs path. If unavailable this is returned as
an empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app_publisher&quot;</p>

<p style="margin-left:23%;">The name of the publisher of
the application, for package managers that use this. If
unavailable this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app_url&quot;</p>

<p style="margin-left:23%;">The <small>URL</small> (eg.
upstream <small>URL</small> ) of the application. If
unavailable this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>


<p style="margin-left:17%;">&quot;app_source_package&quot;</p>

<p style="margin-left:23%;">For packaging systems which
support this, the name of the source package. If unavailable
this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app_summary&quot;</p>

<p style="margin-left:23%;">A short (usually one line)
description of the application or package. If unavailable
this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>


<p style="margin-left:17%;">&quot;app_description&quot;</p>

<p style="margin-left:23%;">A longer description of the
application or package. If unavailable this is returned as
an empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;inspect_list_applications2&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@applications2 =
$g&minus;&gt;inspect_list_applications2 ($root);</p>

<p style="margin-left:17%;">Return the list of applications
installed in the operating system.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note:</i>
This call works differently from other parts of the
inspection <small>API.</small> You have to call
<tt>&quot;$g&minus;&gt;inspect_os&quot;</tt>, then
<tt>&quot;$g&minus;&gt;inspect_get_mountpoints&quot;</tt>,
then mount up the disks, before calling this. Listing
applications is a significantly more difficult operation
which requires access to the full filesystem. Also note that
unlike the other
<tt>&quot;$g&minus;&gt;inspect_get_*&quot;</tt> calls which
are just returning data cached in the libguestfs handle,
this call actually reads parts of the mounted filesystems
during the call.</p>

<p style="margin-left:17%; margin-top: 1em">This returns an
empty list if the inspection code was not able to determine
the list of applications.</p>

<p style="margin-left:17%; margin-top: 1em">The application
structure contains the following fields: <br>
&quot;app2_name&quot;</p>

<p style="margin-left:23%;">The name of the application.
For Red Hat-derived and Debian-derived Linux guests, this is
the package name.</p>


<p style="margin-left:17%;">&quot;app2_display_name&quot;</p>

<p style="margin-left:23%;">The display name of the
application, sometimes localized to the install language of
the guest operating system.</p>

<p style="margin-left:23%; margin-top: 1em">If unavailable
this is returned as an empty string <tt>&quot;&quot;</tt>.
Callers needing to display something can use
<tt>&quot;app2_name&quot;</tt> instead.</p>

<p style="margin-left:17%;">&quot;app2_epoch&quot;</p>

<p style="margin-left:23%;">For package managers which use
epochs, this contains the epoch of the package (an integer).
If unavailable, this is returned as <tt>0</tt>.</p>

<p style="margin-left:17%;">&quot;app2_version&quot;</p>

<p style="margin-left:23%;">The version string of the
application or package. If unavailable this is returned as
an empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app2_release&quot;</p>

<p style="margin-left:23%;">The release string of the
application or package, for package managers that use this.
If unavailable this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app2_arch&quot;</p>

<p style="margin-left:23%;">The architecture string of the
application or package, for package managers that use this.
If unavailable this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>


<p style="margin-left:17%;">&quot;app2_install_path&quot;</p>

<p style="margin-left:23%;">The installation path of the
application (on operating systems such as Windows which use
installation paths). This path is in the format used by the
guest operating system, it is not a libguestfs path.</p>

<p style="margin-left:23%; margin-top: 1em">If unavailable
this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>


<p style="margin-left:17%;">&quot;app2_trans_path&quot;</p>

<p style="margin-left:23%;">The install path translated
into a libguestfs path. If unavailable this is returned as
an empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app2_publisher&quot;</p>

<p style="margin-left:23%;">The name of the publisher of
the application, for package managers that use this. If
unavailable this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app2_url&quot;</p>

<p style="margin-left:23%;">The <small>URL</small> (eg.
upstream <small>URL</small> ) of the application. If
unavailable this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>


<p style="margin-left:17%;">&quot;app2_source_package&quot;</p>

<p style="margin-left:23%;">For packaging systems which
support this, the name of the source package. If unavailable
this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;app2_summary&quot;</p>

<p style="margin-left:23%;">A short (usually one line)
description of the application or package. If unavailable
this is returned as an empty string
<tt>&quot;&quot;</tt>.</p>


<p style="margin-left:17%;">&quot;app2_description&quot;</p>

<p style="margin-left:23%;">A longer description of the
application or package. If unavailable this is returned as
an empty string <tt>&quot;&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:11%;">@roots =
$g&minus;&gt;inspect_os ();</p>

<p style="margin-left:17%;">This function uses other
libguestfs functions and certain heuristics to inspect the
disk(s) (usually disks belonging to a virtual machine),
looking for operating systems.</p>

<p style="margin-left:17%; margin-top: 1em">The list
returned is empty if no operating systems were found.</p>

<p style="margin-left:17%; margin-top: 1em">If one
operating system was found, then this returns a list with a
single element, which is the name of the root filesystem of
this operating system. It is also possible for this function
to return a list containing more than one element,
indicating a dual-boot or multi-boot virtual machine, with
each element being the root filesystem of one of the
operating systems.</p>

<p style="margin-left:17%; margin-top: 1em">You can pass
the root string(s) returned to other
<tt>&quot;$g&minus;&gt;inspect_get_*&quot;</tt> functions in
order to query further information about each operating
system, such as the name and version.</p>

<p style="margin-left:17%; margin-top: 1em">This function
uses other libguestfs features such as
<tt>&quot;$g&minus;&gt;mount_ro&quot;</tt> and
<tt>&quot;$g&minus;&gt;umount_all&quot;</tt> in order to
mount and unmount filesystems and look at the contents. This
should be called with no disks currently mounted. The
function may also use Augeas, so any existing Augeas handle
will be closed.</p>

<p style="margin-left:17%; margin-top: 1em">This function
cannot decrypt encrypted disks. The caller must do that
first (supplying the necessary keys) if the disk is
encrypted.</p>

<p style="margin-left:17%; margin-top: 1em">Please read
&quot; <small>INSPECTION&quot;</small> in <i>guestfs</i>(3)
for more details.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;list_filesystems&quot;</tt>.</p>

<p style="margin-left:11%;">$flag =
$g&minus;&gt;is_blockdev ($path [, followsymlinks =&gt;
$followsymlinks]);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a block
device with the given <tt>&quot;path&quot;</tt> name.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
flag <tt>&quot;followsymlinks&quot;</tt> is true, then a
symlink (or chain of symlinks) that ends with a block device
also causes the function to return true.</p>

<p style="margin-left:17%; margin-top: 1em">This call only
looks at files within the guest filesystem. Libguestfs
partitions and block devices (eg. <i>/dev/sda</i>) cannot be
used as the <tt>&quot;path&quot;</tt> parameter of this
call.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$flag =
$g&minus;&gt;is_blockdev_opts ($path [, followsymlinks =&gt;
<br>
$followsymlinks]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;is_blockdev&quot;.</p>

<p style="margin-left:11%;">$busy = $g&minus;&gt;is_busy
();</p>

<p style="margin-left:17%;">This always returns false. This
function is deprecated with no replacement. Do not use this
function.</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on states, see <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$flag = $g&minus;&gt;is_chardev
($path [, followsymlinks =&gt; $followsymlinks]);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a
character device with the given <tt>&quot;path&quot;</tt>
name.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
flag <tt>&quot;followsymlinks&quot;</tt> is true, then a
symlink (or chain of symlinks) that ends with a chardev also
causes the function to return true.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$flag =
$g&minus;&gt;is_chardev_opts ($path [, followsymlinks =&gt;
<br>
$followsymlinks]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;is_chardev&quot;.</p>

<p style="margin-left:11%;">$config =
$g&minus;&gt;is_config ();</p>

<p style="margin-left:17%;">This returns true iff this
handle is being configured (in the
<tt>&quot;CONFIG&quot;</tt> state).</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on states, see <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$dirflag = $g&minus;&gt;is_dir
($path [, followsymlinks =&gt; $followsymlinks]);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a
directory with the given <tt>&quot;path&quot;</tt> name.
Note that it returns false for other objects like files.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
flag <tt>&quot;followsymlinks&quot;</tt> is true, then a
symlink (or chain of symlinks) that ends with a directory
also causes the function to return true.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$dirflag =
$g&minus;&gt;is_dir_opts ($path [, followsymlinks =&gt; <br>
$followsymlinks]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;is_dir&quot;.</p>

<p style="margin-left:11%;">$flag = $g&minus;&gt;is_fifo
($path [, followsymlinks =&gt; $followsymlinks]);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a
<small>FIFO</small> (named pipe) with the given
<tt>&quot;path&quot;</tt> name.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
flag <tt>&quot;followsymlinks&quot;</tt> is true, then a
symlink (or chain of symlinks) that ends with a
<small>FIFO</small> also causes the function to return
true.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$flag =
$g&minus;&gt;is_fifo_opts ($path [, followsymlinks =&gt;
$followsymlinks]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;is_fifo&quot;.</p>

<p style="margin-left:11%;">$fileflag =
$g&minus;&gt;is_file ($path [, followsymlinks =&gt;
$followsymlinks]);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a regular
file with the given <tt>&quot;path&quot;</tt> name. Note
that it returns false for other objects like
directories.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
flag <tt>&quot;followsymlinks&quot;</tt> is true, then a
symlink (or chain of symlinks) that ends with a file also
causes the function to return true.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$fileflag =
$g&minus;&gt;is_file_opts ($path [, followsymlinks =&gt;
<br>
$followsymlinks]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;is_file&quot;.</p>

<p style="margin-left:11%;">$launching =
$g&minus;&gt;is_launching ();</p>

<p style="margin-left:17%;">This returns true iff this
handle is launching the subprocess (in the
<tt>&quot;LAUNCHING&quot;</tt> state).</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on states, see <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$lvflag = $g&minus;&gt;is_lv
($device);</p>

<p style="margin-left:17%;">This command tests whether
<tt>&quot;device&quot;</tt> is a logical volume, and returns
true iff this is the case.</p>

<p style="margin-left:11%;">$ready = $g&minus;&gt;is_ready
();</p>

<p style="margin-left:17%;">This returns true iff this
handle is ready to accept commands (in the
<tt>&quot;READY&quot;</tt> state).</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on states, see <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$flag = $g&minus;&gt;is_socket
($path [, followsymlinks =&gt; $followsymlinks]);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a Unix
domain socket with the given <tt>&quot;path&quot;</tt>
name.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
flag <tt>&quot;followsymlinks&quot;</tt> is true, then a
symlink (or chain of symlinks) that ends with a socket also
causes the function to return true.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$flag =
$g&minus;&gt;is_socket_opts ($path [, followsymlinks =&gt;
<br>
$followsymlinks]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;is_socket&quot;.</p>

<p style="margin-left:11%;">$flag = $g&minus;&gt;is_symlink
($path);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if there is a symbolic
link with the given <tt>&quot;path&quot;</tt> name.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;stat&quot;</tt>.</p>

<p style="margin-left:11%;">$flag =
$g&minus;&gt;is_whole_device ($device);</p>

<p style="margin-left:17%;">This returns
<tt>&quot;true&quot;</tt> if and only if
<tt>&quot;device&quot;</tt> refers to a whole block device.
That is, not a partition or a logical device.</p>

<p style="margin-left:11%;">$zeroflag =
$g&minus;&gt;is_zero ($path);</p>

<p style="margin-left:17%;">This returns true iff the file
exists and the file is empty or it contains all zero
bytes.</p>

<p style="margin-left:11%;">$zeroflag =
$g&minus;&gt;is_zero_device ($device);</p>

<p style="margin-left:17%;">This returns true iff the
device exists and contains all zero bytes.</p>

<p style="margin-left:17%; margin-top: 1em">Note that for
large devices this can take a long time to run.</p>

<p style="margin-left:11%;">%isodata = $g&minus;&gt;isoinfo
($isofile);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;isoinfo_device&quot;</tt> except that
it works for an <small>ISO</small> file located inside some
other mounted filesystem. Note that in the common case where
you have added an <small>ISO</small> file as a libguestfs
device, you would <i>not</i> call this. Instead you would
call <tt>&quot;$g&minus;&gt;isoinfo_device&quot;</tt>.</p>

<p style="margin-left:11%;">%isodata =
$g&minus;&gt;isoinfo_device ($device);</p>

<p style="margin-left:17%;"><tt>&quot;device&quot;</tt> is
an <small>ISO</small> device. This returns a struct of
information read from the primary volume descriptor (the
<small>ISO</small> equivalent of the superblock) of the
device.</p>

<p style="margin-left:17%; margin-top: 1em">Usually it is
more efficient to use the <i>isoinfo</i>(1) command with the
<i>&minus;d</i> option on the host to analyze
<small>ISO</small> files, instead of going through
libguestfs.</p>

<p style="margin-left:17%; margin-top: 1em">For information
on the primary volume descriptor fields, see
&lt;http://wiki.osdev.org/ISO_9660#The_Primary_Volume_Descriptor&gt;</p>

<p style="margin-left:11%;">$g&minus;&gt;journal_close
();</p>

<p style="margin-left:17%;">Close the journal handle.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@fields =
$g&minus;&gt;journal_get ();</p>

<p style="margin-left:17%;">Read the current journal entry.
This returns all the fields in the journal as a set of
<tt>&quot;(attrname, attrval)&quot;</tt> pairs. The
<tt>&quot;attrname&quot;</tt> is the field name (a
string).</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;attrval&quot;</tt> is the field value (a binary
blob, often but not always a string). Please note that
<tt>&quot;attrval&quot;</tt> is a byte array, <i>not</i> a
\0&minus;terminated C string.</p>

<p style="margin-left:17%; margin-top: 1em">The length of
data may be truncated to the data threshold (see:
<tt>&quot;$g&minus;&gt;journal_set_data_threshold&quot;</tt>,
<tt>&quot;$g&minus;&gt;journal_get_data_threshold&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">If you set the
data threshold to unlimited (<tt>0</tt>) then this call can
read a journal entry of any size, ie. it is not limited by
the libguestfs protocol.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$threshold =
$g&minus;&gt;journal_get_data_threshold ();</p>

<p style="margin-left:17%;">Get the current data threshold
for reading journal entries. This is a hint to the journal
that it may truncate data fields to this size when reading
them (note also that it may not truncate them). If this
returns <tt>0</tt>, then the threshold is unlimited.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;journal_set_data_threshold&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$usec =
$g&minus;&gt;journal_get_realtime_usec ();</p>

<p style="margin-left:17%;">Get the realtime (wallclock)
timestamp of the current journal entry.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$more =
$g&minus;&gt;journal_next ();</p>

<p style="margin-left:17%;">Move to the next journal entry.
You have to call this at least once after opening the handle
before you are able to read data.</p>

<p style="margin-left:17%; margin-top: 1em">The returned
boolean tells you if there are any more journal records to
read. <tt>&quot;true&quot;</tt> means you can read the next
record (eg. using
<tt>&quot;$g&minus;&gt;journal_get&quot;</tt>), and
<tt>&quot;false&quot;</tt> means you have reached the end of
the journal.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;journal_open
($directory);</p>

<p style="margin-left:17%;">Open the systemd journal
located in <i>directory</i>. Any previously opened journal
handle is closed.</p>

<p style="margin-left:17%; margin-top: 1em">The contents of
the journal can be read using
<tt>&quot;$g&minus;&gt;journal_next&quot;</tt> and
<tt>&quot;$g&minus;&gt;journal_get&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">After you have
finished using the journal, you should close the handle by
calling <tt>&quot;$g&minus;&gt;journal_close&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;journal_set_data_threshold
($threshold);</p>

<p style="margin-left:17%;">Set the data threshold for
reading journal entries. This is a hint to the journal that
it may truncate data fields to this size when reading them
(note also that it may not truncate them). If you set this
to <tt>0</tt>, then the threshold is unlimited.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;journal_get_data_threshold&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$rskip =
$g&minus;&gt;journal_skip ($skip);</p>

<p style="margin-left:17%;">Skip forwards (<tt>&quot;skip X
0&quot;</tt>) or backwards (<tt>&quot;skip &lt;
0&quot;</tt>) in the journal.</p>

<p style="margin-left:17%; margin-top: 1em">The number of
entries actually skipped is returned (note
<tt>&quot;rskip&nbsp;X&nbsp;0&quot;</tt>). If this is not
the same as the absolute value of the skip parameter
(<tt>&quot;|skip|&quot;</tt>) you passed in then it means
you have reached the end or the start of the journal.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;journal&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;kill_subprocess
();</p>

<p style="margin-left:17%;">This kills the hypervisor.</p>

<p style="margin-left:17%; margin-top: 1em">Do not call
this. See: <tt>&quot;$g&minus;&gt;shutdown&quot;</tt>
instead.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;shutdown&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;launch ();</p>

<p style="margin-left:17%;">You should call this after
configuring the handle (eg. adding drives) but before
performing any actions.</p>

<p style="margin-left:17%; margin-top: 1em">Do not call
<tt>&quot;$g&minus;&gt;launch&quot;</tt> twice on the same
handle. Although it will not give an error (for historical
reasons), the precise behaviour when you do this is not well
defined. Handles are very cheap to create, so create a new
one for each launch.</p>

<p style="margin-left:11%;">$g&minus;&gt;lchown ($owner,
$group, $path);</p>

<p style="margin-left:17%;">Change the file owner to
<tt>&quot;owner&quot;</tt> and group to
<tt>&quot;group&quot;</tt>. This is like
<tt>&quot;$g&minus;&gt;chown&quot;</tt> but if
<tt>&quot;path&quot;</tt> is a symlink then the link itself
is changed, not the target.</p>

<p style="margin-left:17%; margin-top: 1em">Only numeric
uid and gid are supported. If you want to use names, you
will need to locate and parse the password file yourself
(Augeas support makes this relatively easy).</p>


<p style="margin-left:11%;">$g&minus;&gt;ldmtool_create_all
();</p>

<p style="margin-left:17%;">This function scans all block
devices looking for Windows dynamic disk volumes and
partitions, and creates devices for any that were found.</p>

<p style="margin-left:17%; margin-top: 1em">Call
<tt>&quot;$g&minus;&gt;list_ldm_volumes&quot;</tt> and
<tt>&quot;$g&minus;&gt;list_ldm_partitions&quot;</tt> to
return all devices.</p>

<p style="margin-left:17%; margin-top: 1em">Note that you
<b>don&rsquo;t</b> normally need to call this explicitly,
since it is done automatically at
<tt>&quot;$g&minus;&gt;launch&quot;</tt> time. However you
might want to call this function if you have hotplugged
disks or have just created a Windows dynamic disk.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@disks =
$g&minus;&gt;ldmtool_diskgroup_disks ($diskgroup);</p>

<p style="margin-left:17%;">Return the disks in a Windows
dynamic disk group. The <tt>&quot;diskgroup&quot;</tt>
parameter should be the <small>GUID</small> of a disk group,
one element from the list returned by
<tt>&quot;$g&minus;&gt;ldmtool_scan&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$name =
$g&minus;&gt;ldmtool_diskgroup_name ($diskgroup);</p>

<p style="margin-left:17%;">Return the name of a Windows
dynamic disk group. The <tt>&quot;diskgroup&quot;</tt>
parameter should be the <small>GUID</small> of a disk group,
one element from the list returned by
<tt>&quot;$g&minus;&gt;ldmtool_scan&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@volumes =
$g&minus;&gt;ldmtool_diskgroup_volumes ($diskgroup);</p>

<p style="margin-left:17%;">Return the volumes in a Windows
dynamic disk group. The <tt>&quot;diskgroup&quot;</tt>
parameter should be the <small>GUID</small> of a disk group,
one element from the list returned by
<tt>&quot;$g&minus;&gt;ldmtool_scan&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;ldmtool_remove_all
();</p>

<p style="margin-left:17%;">This is essentially the
opposite of
<tt>&quot;$g&minus;&gt;ldmtool_create_all&quot;</tt>. It
removes the device mapper mappings for all Windows dynamic
disk volumes</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@guids =
$g&minus;&gt;ldmtool_scan ();</p>

<p style="margin-left:17%;">This function scans for Windows
dynamic disks. It returns a list of identifiers (GUIDs) for
all disk groups that were found. These identifiers can be
passed to other <tt>&quot;$g&minus;&gt;ldmtool_*&quot;</tt>
functions.</p>

<p style="margin-left:17%; margin-top: 1em">This function
scans all block devices. To scan a subset of block devices,
call <tt>&quot;$g&minus;&gt;ldmtool_scan_devices&quot;</tt>
instead.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@guids =
$g&minus;&gt;ldmtool_scan_devices (\@devices);</p>

<p style="margin-left:17%;">This function scans for Windows
dynamic disks. It returns a list of identifiers (GUIDs) for
all disk groups that were found. These identifiers can be
passed to other <tt>&quot;$g&minus;&gt;ldmtool_*&quot;</tt>
functions.</p>

<p style="margin-left:17%; margin-top: 1em">The parameter
<tt>&quot;devices&quot;</tt> is a list of block devices
which are scanned. If this list is empty, all block devices
are scanned.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$hint =
$g&minus;&gt;ldmtool_volume_hint ($diskgroup, $volume);</p>

<p style="margin-left:17%;">Return the hint field of the
volume named <tt>&quot;volume&quot;</tt> in the disk group
with <small>GUID</small> <tt>&quot;diskgroup&quot;</tt>.
This may not be defined, in which case the empty string is
returned. The hint field is often, though not always, the
name of a Windows drive, eg. <tt>&quot;E:&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@partitions =
$g&minus;&gt;ldmtool_volume_partitions ($diskgroup,
$volume);</p>

<p style="margin-left:17%;">Return the list of partitions
in the volume named <tt>&quot;volume&quot;</tt> in the disk
group with <small>GUID</small>
<tt>&quot;diskgroup&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$voltype =
$g&minus;&gt;ldmtool_volume_type ($diskgroup, $volume);</p>

<p style="margin-left:17%;">Return the type of the volume
named <tt>&quot;volume&quot;</tt> in the disk group with
<small>GUID</small> <tt>&quot;diskgroup&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Possible volume
types that can be returned here include:
<tt>&quot;simple&quot;</tt>, <tt>&quot;spanned&quot;</tt>,
<tt>&quot;striped&quot;</tt>, <tt>&quot;mirrored&quot;</tt>,
<tt>&quot;raid5&quot;</tt>. Other types may also be
returned.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$xattr = $g&minus;&gt;lgetxattr
($path, $name);</p>

<p style="margin-left:17%;">Get a single extended attribute
from file <tt>&quot;path&quot;</tt> named
<tt>&quot;name&quot;</tt>. If <tt>&quot;path&quot;</tt> is a
symlink, then this call returns an extended attribute from
the symlink.</p>

<p style="margin-left:17%; margin-top: 1em">Normally it is
better to get all extended attributes from a file in one go
by calling <tt>&quot;$g&minus;&gt;getxattrs&quot;</tt>.
However some Linux filesystem implementations are buggy and
do not provide a way to list out attributes. For these
filesystems (notably ntfs&minus;3g) you have to know the
names of the extended attributes you want in advance and
call this function.</p>

<p style="margin-left:17%; margin-top: 1em">Extended
attribute values are blobs of binary data. If there is no
extended attribute named <tt>&quot;name&quot;</tt>, this
returns an error.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;lgetxattrs&quot;</tt>,
<tt>&quot;$g&minus;&gt;getxattr&quot;</tt>,
<i>attr</i>(5).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@xattrs =
$g&minus;&gt;lgetxattrs ($path);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;getxattrs&quot;</tt>, but if
<tt>&quot;path&quot;</tt> is a symbolic link, then it
returns the extended attributes of the link itself.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@devices =
$g&minus;&gt;list_devices ();</p>

<p style="margin-left:17%;">List all the block devices.</p>

<p style="margin-left:17%; margin-top: 1em">The full block
device names are returned, eg. <i>/dev/sda</i>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;list_filesystems&quot;</tt>.</p>

<p style="margin-left:11%;">%labels =
$g&minus;&gt;list_disk_labels ();</p>

<p style="margin-left:17%;">If you add drives using the
optional <tt>&quot;label&quot;</tt> parameter of
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>, you can
use this call to map between disk labels, and raw block
device and partition names (like <i>/dev/sda</i> and
<i>/dev/sda1</i>).</p>

<p style="margin-left:17%; margin-top: 1em">This returns a
hashtable, where keys are the disk labels (<i>without</i>
the <i>/dev/disk/guestfs</i> prefix), and the values are the
full raw block device and partition names (eg.
<i>/dev/sda</i> and <i>/dev/sda1</i>).</p>

<p style="margin-left:11%;">@devices =
$g&minus;&gt;list_dm_devices ();</p>

<p style="margin-left:17%;">List all device mapper
devices.</p>

<p style="margin-left:17%; margin-top: 1em">The returned
list contains <i>/dev/mapper/*</i> devices, eg. ones created
by a previous call to
<tt>&quot;$g&minus;&gt;luks_open&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Device mapper
devices which correspond to logical volumes are <i>not</i>
returned in this list. Call
<tt>&quot;$g&minus;&gt;lvs&quot;</tt> if you want to list
logical volumes.</p>

<p style="margin-left:11%;">%fses =
$g&minus;&gt;list_filesystems ();</p>

<p style="margin-left:17%;">This inspection command looks
for filesystems on partitions, block devices and logical
volumes, returning a list of <tt>&quot;mountables&quot;</tt>
containing filesystems and their type.</p>

<p style="margin-left:17%; margin-top: 1em">The return
value is a hash, where the keys are the devices containing
filesystems, and the values are the filesystem types. For
example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &quot;/dev/sda1&quot; =&gt; &quot;ntfs&quot;
 &quot;/dev/sda2&quot; =&gt; &quot;ext2&quot;
 &quot;/dev/vg_guest/lv_root&quot; =&gt; &quot;ext4&quot;
 &quot;/dev/vg_guest/lv_swap&quot; =&gt; &quot;swap&quot;</pre>


<p style="margin-left:17%; margin-top: 1em">The key is not
necessarily a block device. It may also be an opaque
&rsquo;mountable&rsquo; string which can be passed to
<tt>&quot;$g&minus;&gt;mount&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The value can
have the special value &quot;unknown&quot;, meaning the
content of the device is undetermined or empty.
&quot;swap&quot; means a Linux swap partition.</p>

<p style="margin-left:17%; margin-top: 1em">This command
runs other libguestfs commands, which might include
<tt>&quot;$g&minus;&gt;mount&quot;</tt> and
<tt>&quot;$g&minus;&gt;umount&quot;</tt>, and therefore you
should use this soon after launch and only when nothing is
mounted.</p>

<p style="margin-left:17%; margin-top: 1em">Not all of the
filesystems returned will be mountable. In particular, swap
partitions are returned in the list. Also this command does
not check that each filesystem found is valid and mountable,
and some filesystems might be mountable but require special
options. Filesystems may not all belong to a single logical
operating system (use
<tt>&quot;$g&minus;&gt;inspect_os&quot;</tt> to look for
OSes).</p>

<p style="margin-left:11%;">@devices =
$g&minus;&gt;list_ldm_partitions ();</p>

<p style="margin-left:17%;">This function returns all
Windows dynamic disk partitions that were found at launch
time. It returns a list of device names.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@devices =
$g&minus;&gt;list_ldm_volumes ();</p>

<p style="margin-left:17%;">This function returns all
Windows dynamic disk volumes that were found at launch time.
It returns a list of device names.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ldm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@devices =
$g&minus;&gt;list_md_devices ();</p>

<p style="margin-left:17%;">List all Linux md devices.</p>

<p style="margin-left:11%;">@partitions =
$g&minus;&gt;list_partitions ();</p>

<p style="margin-left:17%;">List all the partitions
detected on all block devices.</p>

<p style="margin-left:17%; margin-top: 1em">The full
partition device names are returned, eg.
<i>/dev/sda1</i></p>

<p style="margin-left:17%; margin-top: 1em">This does not
return logical volumes. For that you will need to call
<tt>&quot;$g&minus;&gt;lvs&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;list_filesystems&quot;</tt>.</p>

<p style="margin-left:11%;">$listing = $g&minus;&gt;ll
($directory);</p>

<p style="margin-left:17%;">List the files in
<i>directory</i> (relative to the root directory, there is
no cwd) in the format of &rsquo;ls &minus;la&rsquo;.</p>

<p style="margin-left:17%; margin-top: 1em">This command is
mostly useful for interactive sessions. It is <i>not</i>
intended that you try to parse the output string.</p>

<p style="margin-left:11%;">$listing = $g&minus;&gt;llz
($directory);</p>

<p style="margin-left:17%;">List the files in
<i>directory</i> in the format of &rsquo;ls
&minus;laZ&rsquo;.</p>

<p style="margin-left:17%; margin-top: 1em">This command is
mostly useful for interactive sessions. It is <i>not</i>
intended that you try to parse the output string.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;lgetxattrs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;ln ($target,
$linkname);</p>

<p style="margin-left:17%;">This command creates a hard
link using the <tt>&quot;ln&quot;</tt> command.</p>

<p style="margin-left:11%;">$g&minus;&gt;ln_f ($target,
$linkname);</p>

<p style="margin-left:17%;">This command creates a hard
link using the <tt>&quot;ln &minus;f&quot;</tt> command. The
<i>&minus;f</i> option removes the link
(<tt>&quot;linkname&quot;</tt>) if it exists already.</p>

<p style="margin-left:11%;">$g&minus;&gt;ln_s ($target,
$linkname);</p>

<p style="margin-left:17%;">This command creates a symbolic
link using the <tt>&quot;ln &minus;s&quot;</tt> command.</p>

<p style="margin-left:11%;">$g&minus;&gt;ln_sf ($target,
$linkname);</p>

<p style="margin-left:17%;">This command creates a symbolic
link using the <tt>&quot;ln &minus;sf&quot;</tt> command,
The <i>&minus;f</i> option removes the link
(<tt>&quot;linkname&quot;</tt>) if it exists already.</p>

<p style="margin-left:11%;">$g&minus;&gt;lremovexattr
($xattr, $path);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;removexattr&quot;</tt>, but if
<tt>&quot;path&quot;</tt> is a symbolic link, then it
removes an extended attribute of the link itself.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@listing = $g&minus;&gt;ls
($directory);</p>

<p style="margin-left:17%;">List the files in
<i>directory</i> (relative to the root directory, there is
no cwd). The &rsquo;.&rsquo; and &rsquo;..&rsquo; entries
are not returned, but hidden files are shown.</p>

<p style="margin-left:11%;">$g&minus;&gt;ls0 ($dir,
$filenames);</p>

<p style="margin-left:17%;">This specialized command is
used to get a listing of the filenames in the directory
<tt>&quot;dir&quot;</tt>. The list of filenames is written
to the local file <i>filenames</i> (on the host).</p>

<p style="margin-left:17%; margin-top: 1em">In the output
file, the filenames are separated by <tt>&quot;\0&quot;</tt>
characters.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;.&quot;</tt>
and <tt>&quot;..&quot;</tt> are not returned. The filenames
are not sorted.</p>

<p style="margin-left:11%;">$g&minus;&gt;lsetxattr ($xattr,
$val, $vallen, $path);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;setxattr&quot;</tt>, but if
<tt>&quot;path&quot;</tt> is a symbolic link, then it sets
an extended attribute of the link itself.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">%statbuf = $g&minus;&gt;lstat
($path);</p>

<p style="margin-left:17%;">Returns file information for
the given <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as <tt>&quot;$g&minus;&gt;stat&quot;</tt> except that
if <tt>&quot;path&quot;</tt> is a symbolic link, then the
link is stat-ed, not the file it refers to.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as the <i>lstat</i>(2) system call.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;lstatns&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@statbufs =
$g&minus;&gt;lstatlist ($path, \@names);</p>

<p style="margin-left:17%;">This call allows you to perform
the <tt>&quot;$g&minus;&gt;lstat&quot;</tt> operation on
multiple files, where all files are in the directory
<tt>&quot;path&quot;</tt>. <tt>&quot;names&quot;</tt> is the
list of files from this directory.</p>

<p style="margin-left:17%; margin-top: 1em">On return you
get a list of stat structs, with a one-to-one correspondence
to the <tt>&quot;names&quot;</tt> list. If any name did not
exist or could not be lstat&rsquo;d, then the
<tt>&quot;st_ino&quot;</tt> field of that structure is set
to <tt>&quot;&minus;1&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This call is
intended for programs that want to efficiently list a
directory contents without making many round-trips. See also
<tt>&quot;$g&minus;&gt;lxattrlist&quot;</tt> for a similarly
efficient call for getting extended attributes.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;lstatnslist&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">%statbuf = $g&minus;&gt;lstatns
($path);</p>

<p style="margin-left:17%;">Returns file information for
the given <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as <tt>&quot;$g&minus;&gt;statns&quot;</tt> except that
if <tt>&quot;path&quot;</tt> is a symbolic link, then the
link is stat-ed, not the file it refers to.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as the <i>lstat</i>(2) system call.</p>

<p style="margin-left:11%;">@statbufs =
$g&minus;&gt;lstatnslist ($path, \@names);</p>

<p style="margin-left:17%;">This call allows you to perform
the <tt>&quot;$g&minus;&gt;lstatns&quot;</tt> operation on
multiple files, where all files are in the directory
<tt>&quot;path&quot;</tt>. <tt>&quot;names&quot;</tt> is the
list of files from this directory.</p>

<p style="margin-left:17%; margin-top: 1em">On return you
get a list of stat structs, with a one-to-one correspondence
to the <tt>&quot;names&quot;</tt> list. If any name did not
exist or could not be lstat&rsquo;d, then the
<tt>&quot;st_ino&quot;</tt> field of that structure is set
to <tt>&quot;&minus;1&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This call is
intended for programs that want to efficiently list a
directory contents without making many round-trips. See also
<tt>&quot;$g&minus;&gt;lxattrlist&quot;</tt> for a similarly
efficient call for getting extended attributes.</p>

<p style="margin-left:11%;">$g&minus;&gt;luks_add_key
($device, $key, $newkey, $keyslot);</p>

<p style="margin-left:17%;">This command adds a new key on
<small>LUKS</small> device <tt>&quot;device&quot;</tt>.
<tt>&quot;key&quot;</tt> is any existing key, and is used to
access the device. <tt>&quot;newkey&quot;</tt> is the new
key to add. <tt>&quot;keyslot&quot;</tt> is the key slot
that will be replaced.</p>

<p style="margin-left:17%; margin-top: 1em">Note that if
<tt>&quot;keyslot&quot;</tt> already contains a key, then
this command will fail. You have to use
<tt>&quot;$g&minus;&gt;luks_kill_slot&quot;</tt> first to
remove that key.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;luks&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;luks_close
($device);</p>

<p style="margin-left:17%;">This closes a
<small>LUKS</small> device that was created earlier by
<tt>&quot;$g&minus;&gt;luks_open&quot;</tt> or
<tt>&quot;$g&minus;&gt;luks_open_ro&quot;</tt>. The
<tt>&quot;device&quot;</tt> parameter must be the name of
the <small>LUKS</small> mapping device (ie.
<i>/dev/mapper/mapname</i>) and <i>not</i> the name of the
underlying block device.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;luks&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;luks_format
($device, $key, $keyslot);</p>

<p style="margin-left:17%;">This command erases existing
data on <tt>&quot;device&quot;</tt> and formats the device
as a <small>LUKS</small> encrypted device.
<tt>&quot;key&quot;</tt> is the initial key, which is added
to key slot <tt>&quot;slot&quot;</tt>. ( <small>LUKS</small>
supports 8 key slots, numbered 0&minus;7).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;luks&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;luks_format_cipher
($device, $key, $keyslot, $cipher);</p>

<p style="margin-left:17%;">This command is the same as
<tt>&quot;$g&minus;&gt;luks_format&quot;</tt> but it also
allows you to set the <tt>&quot;cipher&quot;</tt> used.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;luks&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;luks_kill_slot
($device, $key, $keyslot);</p>

<p style="margin-left:17%;">This command deletes the key in
key slot <tt>&quot;keyslot&quot;</tt> from the encrypted
<small>LUKS</small> device <tt>&quot;device&quot;</tt>.
<tt>&quot;key&quot;</tt> must be one of the <i>other</i>
keys.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;luks&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;luks_open
($device, $key, $mapname);</p>

<p style="margin-left:17%;">This command opens a block
device which has been encrypted according to the Linux
Unified Key Setup ( <small>LUKS</small> ) standard.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;device&quot;</tt>
is the encrypted block device or partition.</p>

<p style="margin-left:17%; margin-top: 1em">The caller must
supply one of the keys associated with the
<small>LUKS</small> block device, in the
<tt>&quot;key&quot;</tt> parameter.</p>

<p style="margin-left:17%; margin-top: 1em">This creates a
new block device called <i>/dev/mapper/mapname</i>. Reads
and writes to this block device are decrypted from and
encrypted to the underlying <tt>&quot;device&quot;</tt>
respectively.</p>

<p style="margin-left:17%; margin-top: 1em">If this block
device contains <small>LVM</small> volume groups, then
calling <tt>&quot;$g&minus;&gt;vgscan&quot;</tt> followed by
<tt>&quot;$g&minus;&gt;vg_activate_all&quot;</tt> will make
them visible.</p>

<p style="margin-left:17%; margin-top: 1em">Use
<tt>&quot;$g&minus;&gt;list_dm_devices&quot;</tt> to list
all device mapper devices.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;luks&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;luks_open_ro
($device, $key, $mapname);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;luks_open&quot;</tt> except that a
read-only mapping is created.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;luks&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvcreate ($logvol,
$volgroup, $mbytes);</p>

<p style="margin-left:17%;">This creates an
<small>LVM</small> logical volume called
<tt>&quot;logvol&quot;</tt> on the volume group
<tt>&quot;volgroup&quot;</tt>, with
<tt>&quot;size&quot;</tt> megabytes.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvcreate_free
($logvol, $volgroup, $percent);</p>

<p style="margin-left:17%;">Create an <small>LVM</small>
logical volume called <i>/dev/volgroup/logvol</i>, using
approximately <tt>&quot;percent&quot;</tt> % of the free
space remaining in the volume group. Most usefully, when
<tt>&quot;percent&quot;</tt> is <tt>100</tt> this will
create the largest possible <small>LV.</small></p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$lv =
$g&minus;&gt;lvm_canonical_lv_name ($lvname);</p>

<p style="margin-left:17%;">This converts alternative
naming schemes for LVs that you might find to the canonical
name. For example, <i>/dev/mapper/VG&minus;LV</i> is
converted to <i>/dev/VG/LV</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This command
returns an error if the <tt>&quot;lvname&quot;</tt>
parameter does not refer to a logical volume.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;is_lv&quot;</tt>,
<tt>&quot;$g&minus;&gt;canonical_device_name&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvm_clear_filter
();</p>

<p style="margin-left:17%;">This undoes the effect of
<tt>&quot;$g&minus;&gt;lvm_set_filter&quot;</tt>.
<small>LVM</small> will be able to see every block
device.</p>

<p style="margin-left:17%; margin-top: 1em">This command
also clears the <small>LVM</small> cache and performs a
volume group scan.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvm_remove_all
();</p>

<p style="margin-left:17%;">This command removes all
<small>LVM</small> logical volumes, volume groups and
physical volumes.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvm_set_filter
(\@devices);</p>

<p style="margin-left:17%;">This sets the
<small>LVM</small> device filter so that <small>LVM</small>
will only be able to &quot;see&quot; the block devices in
the list <tt>&quot;devices&quot;</tt>, and will ignore all
other attached block devices.</p>

<p style="margin-left:17%; margin-top: 1em">Where disk
image(s) contain duplicate PVs or VGs, this command is
useful to get <small>LVM</small> to ignore the duplicates,
otherwise <small>LVM</small> can get confused. Note also
there are two types of duplication possible: either cloned
PVs/VGs which have identical UUIDs; or VGs that are not
cloned but just happen to have the same name. In normal
operation you cannot create this situation, but you can do
it outside <small>LVM,</small> eg. by cloning disk images or
by bit twiddling inside the <small>LVM</small> metadata.</p>

<p style="margin-left:17%; margin-top: 1em">This command
also clears the <small>LVM</small> cache and performs a
volume group scan.</p>

<p style="margin-left:17%; margin-top: 1em">You can filter
whole block devices or individual partitions.</p>

<p style="margin-left:17%; margin-top: 1em">You cannot use
this if any <small>VG</small> is currently in use (eg.
contains a mounted filesystem), even if you are not
filtering out that <small>VG.</small></p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvremove
($device);</p>

<p style="margin-left:17%;">Remove an <small>LVM</small>
logical volume <tt>&quot;device&quot;</tt>, where
<tt>&quot;device&quot;</tt> is the path to the
<small>LV,</small> such as <i>/dev/VG/LV</i>.</p>

<p style="margin-left:17%; margin-top: 1em">You can also
remove all LVs in a volume group by specifying the
<small>VG</small> name, <i>/dev/VG</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvrename ($logvol,
$newlogvol);</p>

<p style="margin-left:17%;">Rename a logical volume
<tt>&quot;logvol&quot;</tt> with the new name
<tt>&quot;newlogvol&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvresize ($device,
$mbytes);</p>

<p style="margin-left:17%;">This resizes (expands or
shrinks) an existing <small>LVM</small> logical volume to
<tt>&quot;mbytes&quot;</tt>. When reducing, data in the
reduced part is lost.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;lvresize_free
($lv, $percent);</p>

<p style="margin-left:17%;">This expands an existing
logical volume <tt>&quot;lv&quot;</tt> so that it fills
<tt>&quot;pc&quot;</tt>% of the remaining free space in the
volume group. Commonly you would call this with pc = 100
which expands the logical volume as much as possible, using
all remaining free space in the volume group.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@logvols = $g&minus;&gt;lvs
();</p>

<p style="margin-left:17%;">List all the logical volumes
detected. This is the equivalent of the <i>lvs</i>(8)
command.</p>

<p style="margin-left:17%; margin-top: 1em">This returns a
list of the logical volume device names (eg.
<i>/dev/VolGroup00/LogVol00</i>).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;lvs_full&quot;</tt>,
<tt>&quot;$g&minus;&gt;list_filesystems&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@logvols =
$g&minus;&gt;lvs_full ();</p>

<p style="margin-left:17%;">List all the logical volumes
detected. This is the equivalent of the <i>lvs</i>(8)
command. The &quot;full&quot; version includes all
fields.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$uuid = $g&minus;&gt;lvuuid
($device);</p>

<p style="margin-left:17%;">This command returns the
<small>UUID</small> of the <small>LVM LV</small>
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:11%;">@xattrs =
$g&minus;&gt;lxattrlist ($path, \@names);</p>

<p style="margin-left:17%;">This call allows you to get the
extended attributes of multiple files, where all files are
in the directory <tt>&quot;path&quot;</tt>.
<tt>&quot;names&quot;</tt> is the list of files from this
directory.</p>

<p style="margin-left:17%; margin-top: 1em">On return you
get a flat list of xattr structs which must be interpreted
sequentially. The first xattr struct always has a
zero-length <tt>&quot;attrname&quot;</tt>.
<tt>&quot;attrval&quot;</tt> in this struct is zero-length
to indicate there was an error doing
<tt>&quot;lgetxattr&quot;</tt> for this file, <i>or</i> is a
C string which is a decimal number (the number of following
attributes for this file, which could be
<tt>&quot;0&quot;</tt>). Then after the first xattr struct
are the zero or more attributes for the first named file.
This repeats for the second and subsequent files.</p>

<p style="margin-left:17%; margin-top: 1em">This call is
intended for programs that want to efficiently list a
directory contents without making many round-trips. See also
<tt>&quot;$g&minus;&gt;lstatlist&quot;</tt> for a similarly
efficient call for getting standard stats.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$disks = $g&minus;&gt;max_disks
();</p>

<p style="margin-left:17%;">Return the maximum number of
disks that may be added to a handle (eg. by
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt> and similar
calls).</p>

<p style="margin-left:17%; margin-top: 1em">This function
was added in libguestfs 1.19.7. In previous versions of
libguestfs the limit was 25.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>MAXIMUM NUMBER OF DISKS&quot;</small> in
<i>guestfs</i>(3) for additional information on this
topic.</p>

<p style="margin-left:11%;">$g&minus;&gt;md_create ($name,
\@devices [, missingbitmap =&gt; $missingbitmap] [, <br>
nrdevices =&gt; $nrdevices] [, spare =&gt; $spare] [, chunk
=&gt; $chunk] [, <br>
level =&gt; $level]);</p>

<p style="margin-left:17%;">Create a Linux md (
<small>RAID</small> ) device named <tt>&quot;name&quot;</tt>
on the devices in the list <tt>&quot;devices&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
parameters are: <br>
&quot;missingbitmap&quot;</p>

<p style="margin-left:23%;">A bitmap of missing devices. If
a bit is set it means that a missing device is added to the
array. The least significant bit corresponds to the first
device in the array.</p>

<p style="margin-left:23%; margin-top: 1em">As
examples:</p>

<p style="margin-left:23%; margin-top: 1em">If
<tt>&quot;devices = [&quot;/dev/sda&quot;]&quot;</tt> and
<tt>&quot;missingbitmap = 0x1&quot;</tt> then the resulting
array would be <tt>&quot;[&lt;missing&gt;,
&quot;/dev/sda&quot;]&quot;</tt>.</p>

<p style="margin-left:23%; margin-top: 1em">If
<tt>&quot;devices = [&quot;/dev/sda&quot;]&quot;</tt> and
<tt>&quot;missingbitmap = 0x2&quot;</tt> then the resulting
array would be <tt>&quot;[&quot;/dev/sda&quot;,
&lt;missing&gt;]&quot;</tt>.</p>

<p style="margin-left:23%; margin-top: 1em">This defaults
to <tt>0</tt> (no missing devices).</p>

<p style="margin-left:23%; margin-top: 1em">The length of
<tt>&quot;devices&quot;</tt> + the number of bits set in
<tt>&quot;missingbitmap&quot;</tt> must equal
<tt>&quot;nrdevices&quot;</tt> +
<tt>&quot;spare&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;nrdevices&quot;</p>

<p style="margin-left:23%;">The number of active
<small>RAID</small> devices.</p>

<p style="margin-left:23%; margin-top: 1em">If not set,
this defaults to the length of <tt>&quot;devices&quot;</tt>
plus the number of bits set in
<tt>&quot;missingbitmap&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;spare&quot;</p>

<p style="margin-left:23%;">The number of spare
devices.</p>

<p style="margin-left:23%; margin-top: 1em">If not set,
this defaults to <tt>0</tt>.</p>

<p style="margin-left:17%;">&quot;chunk&quot;</p>

<p style="margin-left:23%;">The chunk size in bytes.</p>

<p style="margin-left:17%;">&quot;level&quot;</p>

<p style="margin-left:23%;">The <small>RAID</small> level,
which can be one of: <i>linear</i>, <i>raid0</i>, <i>0</i>,
<i>stripe</i>, <i>raid1</i>, <i>1</i>, <i>mirror</i>,
<i>raid4</i>, <i>4</i>, <i>raid5</i>, <i>5</i>,
<i>raid6</i>, <i>6</i>, <i>raid10</i>, <i>10</i>. Some of
these are synonymous, and more levels may be added in
future.</p>

<p style="margin-left:23%; margin-top: 1em">If not set,
this defaults to <tt>&quot;raid1&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mdadm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">%info = $g&minus;&gt;md_detail
($md);</p>

<p style="margin-left:17%;">This command exposes the output
of &rsquo;mdadm &minus;DY &lt;md&gt;&rsquo;. The following
fields are usually present in the returned hash. Other
fields may also be present. <br>
&quot;level&quot;</p>

<p style="margin-left:23%;">The raid level of the
<small>MD</small> device.</p>

<p style="margin-left:17%;">&quot;devices&quot;</p>

<p style="margin-left:23%;">The number of underlying
devices in the <small>MD</small> device.</p>

<p style="margin-left:17%;">&quot;metadata&quot;</p>

<p style="margin-left:23%;">The metadata version used.</p>

<p style="margin-left:17%;">&quot;uuid&quot;</p>

<p style="margin-left:23%;">The <small>UUID</small> of the
<small>MD</small> device.</p>

<p style="margin-left:17%;">&quot;name&quot;</p>

<p style="margin-left:23%;">The name of the
<small>MD</small> device.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mdadm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@devices = $g&minus;&gt;md_stat
($md);</p>

<p style="margin-left:17%;">This call returns a list of the
underlying devices which make up the single software
<small>RAID</small> array device
<tt>&quot;md&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">To get a list
of software <small>RAID</small> devices, call
<tt>&quot;$g&minus;&gt;list_md_devices&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Each structure
returned corresponds to one device along with additional
status information: <br>
&quot;mdstat_device&quot;</p>

<p style="margin-left:23%;">The name of the underlying
device.</p>

<p style="margin-left:17%;">&quot;mdstat_index&quot;</p>

<p style="margin-left:23%;">The index of this device within
the array.</p>

<p style="margin-left:17%;">&quot;mdstat_flags&quot;</p>

<p style="margin-left:23%;">Flags associated with this
device. This is a string containing (in no specific order)
zero or more of the following flags:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="23%"></td>
<td width="5%">


<p>&quot;W&quot;</p></td>
<td width="1%"></td>
<td width="34%">


<p>write-mostly</p></td>
<td width="37%">
</td></tr>
<tr valign="top" align="left">
<td width="23%"></td>
<td width="5%">


<p>&quot;F&quot;</p></td>
<td width="1%"></td>
<td width="34%">


<p>device is faulty</p></td>
<td width="37%">
</td></tr>
<tr valign="top" align="left">
<td width="23%"></td>
<td width="5%">


<p>&quot;S&quot;</p></td>
<td width="1%"></td>
<td width="34%">


<p>device is a <small>RAID</small> spare</p></td>
<td width="37%">
</td></tr>
<tr valign="top" align="left">
<td width="23%"></td>
<td width="5%">


<p>&quot;R&quot;</p></td>
<td width="1%"></td>
<td width="34%">


<p>replacement</p></td>
<td width="37%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mdadm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;md_stop ($md);</p>

<p style="margin-left:17%;">This command deactivates the
<small>MD</small> array named <tt>&quot;md&quot;</tt>. The
device is stopped, but it is not destroyed or zeroed.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mdadm&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkdir ($path);</p>

<p style="margin-left:17%;">Create a directory named
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkdir_mode ($path,
$mode);</p>

<p style="margin-left:17%;">This command creates a
directory, setting the initial permissions of the directory
to <tt>&quot;mode&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">For common
Linux filesystems, the actual mode which is set will be
<tt>&quot;mode &amp; ~umask &amp; 01777&quot;</tt>.
Non-native-Linux filesystems may interpret the mode in other
ways.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;mkdir&quot;</tt>,
<tt>&quot;$g&minus;&gt;umask&quot;</tt></p>

<p style="margin-left:11%;">$g&minus;&gt;mkdir_p
($path);</p>

<p style="margin-left:17%;">Create a directory named
<tt>&quot;path&quot;</tt>, creating any parent directories
as necessary. This is like the <tt>&quot;mkdir
&minus;p&quot;</tt> shell command.</p>

<p style="margin-left:11%;">$dir = $g&minus;&gt;mkdtemp
($tmpl);</p>

<p style="margin-left:17%;">This command creates a
temporary directory. The <tt>&quot;tmpl&quot;</tt> parameter
should be a full pathname for the temporary directory name
with the final six characters being &quot;
<small>XXXXXX&quot;.</small></p>

<p style="margin-left:17%; margin-top: 1em">For example:
&quot;/tmp/myprogXXXXXX&quot; or
&quot;/Temp/myprogXXXXXX&quot;, the second one being
suitable for Windows filesystems.</p>

<p style="margin-left:17%; margin-top: 1em">The name of the
temporary directory that was created is returned.</p>

<p style="margin-left:17%; margin-top: 1em">The temporary
directory is created with mode 0700 and is owned by
root.</p>

<p style="margin-left:17%; margin-top: 1em">The caller is
responsible for deleting the temporary directory and its
contents after use.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<i>mkdtemp</i>(3)</p>

<p style="margin-left:11%;">$g&minus;&gt;mke2fs ($device [,
blockscount =&gt; $blockscount] [, blocksize =&gt; <br>
$blocksize] [, fragsize =&gt; $fragsize] [, blockspergroup
=&gt; <br>
$blockspergroup] [, numberofgroups =&gt; $numberofgroups] [,
bytesperinode <br>
=&gt; $bytesperinode] [, inodesize =&gt; $inodesize] [,
journalsize =&gt; <br>
$journalsize] [, numberofinodes =&gt; $numberofinodes] [,
stridesize =&gt; <br>
$stridesize] [, stripewidth =&gt; $stripewidth] [,
maxonlineresize =&gt; <br>
$maxonlineresize] [, reservedblockspercentage =&gt; <br>
$reservedblockspercentage] [, mmpupdateinterval =&gt;
$mmpupdateinterval] <br>
[, journaldevice =&gt; $journaldevice] [, label =&gt;
$label] [, <br>
lastmounteddir =&gt; $lastmounteddir] [, creatoros =&gt;
$creatoros] [, <br>
fstype =&gt; $fstype] [, usagetype =&gt; $usagetype] [, uuid
=&gt; $uuid] [, <br>
forcecreate =&gt; $forcecreate] [, writesbandgrouponly =&gt;
<br>
$writesbandgrouponly] [, lazyitableinit =&gt;
$lazyitableinit] [, <br>
lazyjournalinit =&gt; $lazyjournalinit] [, testfs =&gt;
$testfs] [, discard <br>
=&gt; $discard] [, quotatype =&gt; $quotatype] [, extent
=&gt; $extent] [, <br>
filetype =&gt; $filetype] [, flexbg =&gt; $flexbg] [,
hasjournal =&gt; <br>
$hasjournal] [, journaldev =&gt; $journaldev] [, largefile
=&gt; $largefile] <br>
[, quota =&gt; $quota] [, resizeinode =&gt; $resizeinode] [,
sparsesuper =&gt; <br>
$sparsesuper] [, uninitbg =&gt; $uninitbg]);</p>

<p style="margin-left:17%;"><tt>&quot;mke2fs&quot;</tt> is
used to create an ext2, ext3, or ext4 filesystem on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;blockscount&quot;</tt> is the size of the
filesystem in blocks. If omitted it defaults to the size of
<tt>&quot;device&quot;</tt>. Note if the filesystem is too
small to contain a journal, <tt>&quot;mke2fs&quot;</tt> will
silently create an ext2 filesystem instead.</p>

<p style="margin-left:11%;">$g&minus;&gt;mke2fs_J ($fstype,
$blocksize, $device, $journal);</p>

<p style="margin-left:17%;">This creates an ext2/3/4
filesystem on <tt>&quot;device&quot;</tt> with an external
journal on <tt>&quot;journal&quot;</tt>. It is equivalent to
the command:</p>

<pre style="margin-left:17%; margin-top: 1em"> mke2fs &minus;t fstype &minus;b blocksize &minus;J device=&lt;journal&gt; &lt;device&gt;</pre>


<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;mke2journal&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mke2fs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mke2fs_JL
($fstype, $blocksize, $device, $label);</p>

<p style="margin-left:17%;">This creates an ext2/3/4
filesystem on <tt>&quot;device&quot;</tt> with an external
journal on the journal labeled
<tt>&quot;label&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;mke2journal_L&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mke2fs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mke2fs_JU
($fstype, $blocksize, $device, $uuid);</p>

<p style="margin-left:17%;">This creates an ext2/3/4
filesystem on <tt>&quot;device&quot;</tt> with an external
journal on the journal with <small>UUID</small>
<tt>&quot;uuid&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;mke2journal_U&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxfsuuid&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mke2fs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mke2journal
($blocksize, $device);</p>

<p style="margin-left:17%;">This creates an ext2 external
journal on <tt>&quot;device&quot;</tt>. It is equivalent to
the command:</p>

<pre style="margin-left:17%; margin-top: 1em"> mke2fs &minus;O journal_dev &minus;b blocksize device</pre>


<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mke2fs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mke2journal_L
($blocksize, $label, $device);</p>

<p style="margin-left:17%;">This creates an ext2 external
journal on <tt>&quot;device&quot;</tt> with label
<tt>&quot;label&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mke2fs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mke2journal_U
($blocksize, $uuid, $device);</p>

<p style="margin-left:17%;">This creates an ext2 external
journal on <tt>&quot;device&quot;</tt> with
<small>UUID</small> <tt>&quot;uuid&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxfsuuid&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mke2fs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkfifo ($mode,
$path);</p>

<p style="margin-left:17%;">This call creates a
<small>FIFO</small> (named pipe) called
<tt>&quot;path&quot;</tt> with mode
<tt>&quot;mode&quot;</tt>. It is just a convenient wrapper
around <tt>&quot;$g&minus;&gt;mknod&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Unlike with
<tt>&quot;$g&minus;&gt;mknod&quot;</tt>,
<tt>&quot;mode&quot;</tt> <b>must</b> contain only
permissions bits.</p>

<p style="margin-left:17%; margin-top: 1em">The mode
actually set is affected by the umask.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mknod&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkfs ($fstype,
$device [, blocksize =&gt; $blocksize] [, features =&gt;
<br>
$features] [, inode =&gt; $inode] [, sectorsize =&gt;
$sectorsize] [, label <br>
=&gt; $label]);</p>

<p style="margin-left:17%;">This function creates a
filesystem on <tt>&quot;device&quot;</tt>. The filesystem
type is <tt>&quot;fstype&quot;</tt>, for example
<tt>&quot;ext3&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments are: <br>
&quot;blocksize&quot;</p>

<p style="margin-left:23%;">The filesystem block size.
Supported block sizes depend on the filesystem type, but
typically they are <tt>1024</tt>, <tt>2048</tt> or
<tt>4096</tt> for Linux ext2/3 filesystems.</p>

<p style="margin-left:23%; margin-top: 1em">For
<small>VFAT</small> and <small>NTFS</small> the
<tt>&quot;blocksize&quot;</tt> parameter is treated as the
requested cluster size.</p>

<p style="margin-left:23%; margin-top: 1em">For
<small>UFS</small> block sizes, please see
<i>mkfs.ufs</i>(8).</p>

<p style="margin-left:17%;">&quot;features&quot;</p>

<p style="margin-left:23%;">This passes the <i>&minus;O</i>
parameter to the external mkfs program.</p>

<p style="margin-left:23%; margin-top: 1em">For certain
filesystem types, this allows extra filesystem features to
be selected. See <i>mke2fs</i>(8) and <i>mkfs.ufs</i>(8) for
more details.</p>

<p style="margin-left:23%; margin-top: 1em">You cannot use
this optional parameter with the <tt>&quot;gfs&quot;</tt> or
<tt>&quot;gfs2&quot;</tt> filesystem type.</p>

<p style="margin-left:17%;">&quot;inode&quot;</p>

<p style="margin-left:23%;">This passes the <i>&minus;I</i>
parameter to the external <i>mke2fs</i>(8) program which
sets the inode size (only for ext2/3/4 filesystems at
present).</p>

<p style="margin-left:17%;">&quot;sectorsize&quot;</p>

<p style="margin-left:23%;">This passes the <i>&minus;S</i>
parameter to external <i>mkfs.ufs</i>(8) program, which sets
sector size for ufs filesystem.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkfs_opts
($fstype, $device [, blocksize =&gt; $blocksize] [, features
<br>
=&gt; $features] [, inode =&gt; $inode] [, sectorsize =&gt;
$sectorsize] [, <br>
label =&gt; $label]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;mkfs&quot;.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkfs_b ($fstype,
$blocksize, $device);</p>

<p style="margin-left:17%;">This call is similar to
<tt>&quot;$g&minus;&gt;mkfs&quot;</tt>, but it allows you to
control the block size of the resulting filesystem.
Supported block sizes depend on the filesystem type, but
typically they are <tt>1024</tt>, <tt>2048</tt> or
<tt>4096</tt> only.</p>

<p style="margin-left:17%; margin-top: 1em">For
<small>VFAT</small> and <small>NTFS</small> the
<tt>&quot;blocksize&quot;</tt> parameter is treated as the
requested cluster size.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mkfs&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkfs_btrfs
(\@devices [, allocstart =&gt; $allocstart] [, bytecount
=&gt; <br>
$bytecount] [, datatype =&gt; $datatype] [, leafsize =&gt;
$leafsize] [, <br>
label =&gt; $label] [, metadata =&gt; $metadata] [, nodesize
=&gt; $nodesize] [, <br>
sectorsize =&gt; $sectorsize]);</p>

<p style="margin-left:17%;">Create a btrfs filesystem,
allowing all configurables to be set. For more information
on the optional arguments, see <i>mkfs.btrfs</i>(8).</p>

<p style="margin-left:17%; margin-top: 1em">Since btrfs
filesystems can span multiple devices, this takes a
non-empty list of devices.</p>

<p style="margin-left:17%; margin-top: 1em">To create
general filesystems, use
<tt>&quot;$g&minus;&gt;mkfs&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;btrfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mklost_and_found
($mountpoint);</p>

<p style="margin-left:17%;">Make the
<tt>&quot;lost+found&quot;</tt> directory, normally in the
root directory of an ext2/3/4 filesystem.
<tt>&quot;mountpoint&quot;</tt> is the directory under which
we try to create the <tt>&quot;lost+found&quot;</tt>
directory.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkmountpoint
($exemptpath);</p>


<p style="margin-left:17%;"><tt>&quot;$g&minus;&gt;mkmountpoint&quot;</tt>
and <tt>&quot;$g&minus;&gt;rmmountpoint&quot;</tt> are
specialized calls that can be used to create extra
mountpoints before mounting the first filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">These calls are
<i>only</i> necessary in some very limited circumstances,
mainly the case where you want to mount a mix of unrelated
and/or read-only filesystems together.</p>

<p style="margin-left:17%; margin-top: 1em">For example,
live CDs often contain a &quot;Russian doll&quot; nest of
filesystems, an <small>ISO</small> outer layer, with a
squashfs image inside, with an ext2/3 image inside that. You
can unpack this as follows in guestfish:</p>

<pre style="margin-left:17%; margin-top: 1em"> add&minus;ro Fedora&minus;11&minus;i686&minus;Live.iso
 run
 mkmountpoint /cd
 mkmountpoint /sqsh
 mkmountpoint /ext3fs
 mount /dev/sda /cd
 mount&minus;loop /cd/LiveOS/squashfs.img /sqsh
 mount&minus;loop /sqsh/LiveOS/ext3fs.img /ext3fs</pre>


<p style="margin-left:17%; margin-top: 1em">The inner
filesystem is now unpacked under the /ext3fs mountpoint.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;$g&minus;&gt;mkmountpoint&quot;</tt>
is not compatible with
<tt>&quot;$g&minus;&gt;umount_all&quot;</tt>. You may get
unexpected errors if you try to mix these calls. It is
safest to manually unmount filesystems and remove
mountpoints after use.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;$g&minus;&gt;umount_all&quot;</tt>
unmounts filesystems by sorting the paths longest first, so
for this to work for manual mountpoints, you must ensure
that the innermost mountpoints have the longest pathnames,
as in the example code above.</p>

<p style="margin-left:17%; margin-top: 1em">For more
details see
&lt;https://bugzilla.redhat.com/show_bug.cgi?id=599503&gt;</p>

<p style="margin-left:17%; margin-top: 1em">Autosync [see
<tt>&quot;$g&minus;&gt;set_autosync&quot;</tt>, this is set
by default on handles] can cause
<tt>&quot;$g&minus;&gt;umount_all&quot;</tt> to be called
when the handle is closed which can also trigger these
issues.</p>

<p style="margin-left:11%;">$g&minus;&gt;mknod ($mode,
$devmajor, $devminor, $path);</p>

<p style="margin-left:17%;">This call creates block or
character special devices, or named pipes (FIFOs).</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;mode&quot;</tt> parameter should be the mode,
using the standard constants. <tt>&quot;devmajor&quot;</tt>
and <tt>&quot;devminor&quot;</tt> are the device major and
minor numbers, only used when creating block and character
special devices.</p>

<p style="margin-left:17%; margin-top: 1em">Note that, just
like <i>mknod</i>(2), the mode must be bitwise
<small>OR</small> &rsquo;d with S_IFBLK, S_IFCHR, S_IFIFO or
S_IFSOCK (otherwise this call just creates a regular file).
These constants are available in the standard Linux header
files, or you can use
<tt>&quot;$g&minus;&gt;mknod_b&quot;</tt>,
<tt>&quot;$g&minus;&gt;mknod_c&quot;</tt> or
<tt>&quot;$g&minus;&gt;mkfifo&quot;</tt> which are wrappers
around this command which bitwise <small>OR</small> in the
appropriate constant for you.</p>

<p style="margin-left:17%; margin-top: 1em">The mode
actually set is affected by the umask.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mknod&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mknod_b ($mode,
$devmajor, $devminor, $path);</p>

<p style="margin-left:17%;">This call creates a block
device node called <tt>&quot;path&quot;</tt> with mode
<tt>&quot;mode&quot;</tt> and device major/minor
<tt>&quot;devmajor&quot;</tt> and
<tt>&quot;devminor&quot;</tt>. It is just a convenient
wrapper around <tt>&quot;$g&minus;&gt;mknod&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Unlike with
<tt>&quot;$g&minus;&gt;mknod&quot;</tt>,
<tt>&quot;mode&quot;</tt> <b>must</b> contain only
permissions bits.</p>

<p style="margin-left:17%; margin-top: 1em">The mode
actually set is affected by the umask.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mknod&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mknod_c ($mode,
$devmajor, $devminor, $path);</p>

<p style="margin-left:17%;">This call creates a char device
node called <tt>&quot;path&quot;</tt> with mode
<tt>&quot;mode&quot;</tt> and device major/minor
<tt>&quot;devmajor&quot;</tt> and
<tt>&quot;devminor&quot;</tt>. It is just a convenient
wrapper around <tt>&quot;$g&minus;&gt;mknod&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Unlike with
<tt>&quot;$g&minus;&gt;mknod&quot;</tt>,
<tt>&quot;mode&quot;</tt> <b>must</b> contain only
permissions bits.</p>

<p style="margin-left:17%; margin-top: 1em">The mode
actually set is affected by the umask.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;mknod&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkswap ($device [,
label =&gt; $label] [, uuid =&gt; $uuid]);</p>

<p style="margin-left:17%;">Create a Linux swap partition
on <tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The option
arguments <tt>&quot;label&quot;</tt> and
<tt>&quot;uuid&quot;</tt> allow you to set the label and/or
<small>UUID</small> of the new swap partition.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkswap_opts
($device [, label =&gt; $label] [, uuid =&gt; $uuid]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;mkswap&quot;.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkswap_L ($label,
$device);</p>

<p style="margin-left:17%;">Create a swap partition on
<tt>&quot;device&quot;</tt> with label
<tt>&quot;label&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that you
cannot attach a swap label to a block device (eg.
<i>/dev/sda</i>), just to a partition. This appears to be a
limitation of the kernel or swap tools.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mkswap&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkswap_U ($uuid,
$device);</p>

<p style="margin-left:17%;">Create a swap partition on
<tt>&quot;device&quot;</tt> with <small>UUID</small>
<tt>&quot;uuid&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxfsuuid&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;mkswap&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;mkswap_file
($path);</p>

<p style="margin-left:17%;">Create a swap file.</p>

<p style="margin-left:17%; margin-top: 1em">This command
just writes a swap file signature to an existing file. To
create the file itself, use something like
<tt>&quot;$g&minus;&gt;fallocate&quot;</tt>.</p>

<p style="margin-left:11%;">$path = $g&minus;&gt;mktemp
($tmpl [, suffix =&gt; $suffix]);</p>

<p style="margin-left:17%;">This command creates a
temporary file. The <tt>&quot;tmpl&quot;</tt> parameter
should be a full pathname for the temporary directory name
with the final six characters being &quot;
<small>XXXXXX&quot;.</small></p>

<p style="margin-left:17%; margin-top: 1em">For example:
&quot;/tmp/myprogXXXXXX&quot; or
&quot;/Temp/myprogXXXXXX&quot;, the second one being
suitable for Windows filesystems.</p>

<p style="margin-left:17%; margin-top: 1em">The name of the
temporary file that was created is returned.</p>

<p style="margin-left:17%; margin-top: 1em">The temporary
file is created with mode 0600 and is owned by root.</p>

<p style="margin-left:17%; margin-top: 1em">The caller is
responsible for deleting the temporary file after use.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
<tt>&quot;suffix&quot;</tt> parameter is given, then the
suffix (eg. <tt>&quot;.txt&quot;</tt>) is appended to the
temporary name.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;mkdtemp&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;modprobe
($modulename);</p>

<p style="margin-left:17%;">This loads a kernel module in
the appliance.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxmodules&quot;</tt>.
See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mount ($mountable,
$mountpoint);</p>

<p style="margin-left:17%;">Mount a guest disk at a
position in the filesystem. Block devices are named
<i>/dev/sda</i>, <i>/dev/sdb</i> and so on, as they were
added to the guest. If those block devices contain
partitions, they will have the usual names (eg.
<i>/dev/sda1</i>). Also <small>LVM</small>
<i>/dev/VG/LV</i>&minus;style names can be used, or
&rsquo;mountable&rsquo; strings returned by
<tt>&quot;$g&minus;&gt;list_filesystems&quot;</tt> or
<tt>&quot;$g&minus;&gt;inspect_get_mountpoints&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The rules are
the same as for <i>mount</i>(2): A filesystem must first be
mounted on <i>/</i> before others can be mounted. Other
filesystems can only be mounted on directories which already
exist.</p>

<p style="margin-left:17%; margin-top: 1em">The mounted
filesystem is writable, if we have sufficient permissions on
the underlying device.</p>

<p style="margin-left:17%; margin-top: 1em">Before
libguestfs 1.13.16, this call implicitly added the options
<tt>&quot;sync&quot;</tt> and <tt>&quot;noatime&quot;</tt>.
The <tt>&quot;sync&quot;</tt> option greatly slowed writes
and caused many problems for users. If your program might
need to work with older versions of libguestfs, use
<tt>&quot;$g&minus;&gt;mount_options&quot;</tt> instead
(using an empty string for the first parameter if you
don&rsquo;t want any options).</p>

<p style="margin-left:11%;">$g&minus;&gt;mount_local
($localmountpoint [, readonly =&gt; $readonly] [, options
<br>
=&gt; $options] [, cachetimeout =&gt; $cachetimeout] [,
debugcalls =&gt; <br>
$debugcalls]);</p>

<p style="margin-left:17%;">This call exports the
libguestfs-accessible filesystem to a local mountpoint
(directory) called <tt>&quot;localmountpoint&quot;</tt>.
Ordinary reads and writes to files and directories under
<tt>&quot;localmountpoint&quot;</tt> are redirected through
libguestfs.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
<tt>&quot;readonly&quot;</tt> flag is set to true, then
writes to the filesystem return error
<tt>&quot;EROFS&quot;</tt>.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;options&quot;</tt>
is a comma-separated list of mount options. See
<i>guestmount</i>(1) for some useful options.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;cachetimeout&quot;</tt>
sets the timeout (in seconds) for cached directory entries.
The default is 60 seconds. See <i>guestmount</i>(1) for
further information.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>&quot;debugcalls&quot;</tt> is set to true, then
additional debugging information is generated for every
<small>FUSE</small> call.</p>

<p style="margin-left:17%; margin-top: 1em">When
<tt>&quot;$g&minus;&gt;mount_local&quot;</tt> returns, the
filesystem is ready, but is not processing requests (access
to it will block). You have to call
<tt>&quot;$g&minus;&gt;mount_local_run&quot;</tt> to run the
main loop.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>MOUNT LOCAL&quot;</small> in <i>guestfs</i>(3) for
full documentation.</p>

<p style="margin-left:11%;">$g&minus;&gt;mount_local_run
();</p>

<p style="margin-left:17%;">Run the main loop which
translates kernel calls to libguestfs calls.</p>

<p style="margin-left:17%; margin-top: 1em">This should
only be called after
<tt>&quot;$g&minus;&gt;mount_local&quot;</tt> returns
successfully. The call will not return until the filesystem
is unmounted.</p>

<p style="margin-left:17%; margin-top: 1em"><b>Note</b> you
must <i>not</i> make concurrent libguestfs calls on the same
handle from another thread.</p>

<p style="margin-left:17%; margin-top: 1em">You may call
this from a different thread than the one which called
<tt>&quot;$g&minus;&gt;mount_local&quot;</tt>, subject to
the usual rules for threads and libguestfs (see &quot;
<small>MULTIPLE HANDLES AND MULTIPLE THREADS&quot;</small>
in <i>guestfs</i>(3)).</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>MOUNT LOCAL&quot;</small> in <i>guestfs</i>(3) for
full documentation.</p>

<p style="margin-left:11%;">$g&minus;&gt;mount_loop ($file,
$mountpoint);</p>

<p style="margin-left:17%;">This command lets you mount
<i>file</i> (a filesystem image in a file) on a mount point.
It is entirely equivalent to the command <tt>&quot;mount
&minus;o loop file mountpoint&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;mount_options
($options, $mountable, $mountpoint);</p>

<p style="margin-left:17%;">This is the same as the
<tt>&quot;$g&minus;&gt;mount&quot;</tt> command, but it
allows you to set the mount options as for the
<i>mount</i>(8) <i>&minus;o</i> flag.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<tt>&quot;options&quot;</tt> parameter is an empty string,
then no options are passed (all options default to whatever
the filesystem uses).</p>

<p style="margin-left:11%;">$g&minus;&gt;mount_ro
($mountable, $mountpoint);</p>

<p style="margin-left:17%;">This is the same as the
<tt>&quot;$g&minus;&gt;mount&quot;</tt> command, but it
mounts the filesystem with the read-only (<i>&minus;o
ro</i>) flag.</p>

<p style="margin-left:11%;">$g&minus;&gt;mount_vfs
($options, $vfstype, $mountable, $mountpoint);</p>

<p style="margin-left:17%;">This is the same as the
<tt>&quot;$g&minus;&gt;mount&quot;</tt> command, but it
allows you to set both the mount options and the vfstype as
for the <i>mount</i>(8) <i>&minus;o</i> and <i>&minus;t</i>
flags.</p>

<p style="margin-left:11%;">%mps = $g&minus;&gt;mountpoints
();</p>

<p style="margin-left:17%;">This call is similar to
<tt>&quot;$g&minus;&gt;mounts&quot;</tt>. That call returns
a list of devices. This one returns a hash table (map) of
device name to directory where the device is mounted.</p>

<p style="margin-left:11%;">@devices = $g&minus;&gt;mounts
();</p>

<p style="margin-left:17%;">This returns the list of
currently mounted filesystems. It returns the list of
devices (eg. <i>/dev/sda1</i>, <i>/dev/VG/LV</i>).</p>

<p style="margin-left:17%; margin-top: 1em">Some internal
mounts are not shown.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;mountpoints&quot;</tt></p>

<p style="margin-left:11%;">$g&minus;&gt;mv ($src,
$dest);</p>

<p style="margin-left:17%;">This moves a file from
<tt>&quot;src&quot;</tt> to <tt>&quot;dest&quot;</tt> where
<tt>&quot;dest&quot;</tt> is either a destination filename
or destination directory.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;rename&quot;</tt>.</p>

<p style="margin-left:11%;">$nrdisks =
$g&minus;&gt;nr_devices ();</p>

<p style="margin-left:17%;">This returns the number of
whole block devices that were added. This is the same as the
number of devices that would be returned if you called
<tt>&quot;$g&minus;&gt;list_devices&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">To find out the
maximum number of devices that could be added, call
<tt>&quot;$g&minus;&gt;max_disks&quot;</tt>.</p>

<p style="margin-left:11%;">$status =
$g&minus;&gt;ntfs_3g_probe ($rw, $device);</p>

<p style="margin-left:17%;">This command runs the
<i>ntfs&minus;3g.probe</i>(8) command which probes an
<small>NTFS</small> <tt>&quot;device&quot;</tt> for
mountability. (Not all <small>NTFS</small> volumes can be
mounted read-write, and some cannot be mounted at all).</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;rw&quot;</tt>
is a boolean flag. Set it to true if you want to test if the
volume can be mounted read-write. Set it to false if you
want to test if the volume can be mounted read-only.</p>

<p style="margin-left:17%; margin-top: 1em">The return
value is an integer which <tt>0</tt> if the operation would
succeed, or some non-zero value documented in the
<i>ntfs&minus;3g.probe</i>(8) manual page.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ntfs3g&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;ntfsclone_in
($backupfile, $device);</p>

<p style="margin-left:17%;">Restore the
<tt>&quot;backupfile&quot;</tt> (from a previous call to
<tt>&quot;$g&minus;&gt;ntfsclone_out&quot;</tt>) to
<tt>&quot;device&quot;</tt>, overwriting any existing
contents of this device.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ntfs3g&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;ntfsclone_out
($device, $backupfile [, metadataonly =&gt; <br>
$metadataonly] [, rescue =&gt; $rescue] [, ignorefscheck
=&gt; <br>
$ignorefscheck] [, preservetimestamps =&gt;
$preservetimestamps] [, force <br>
=&gt; $force]);</p>

<p style="margin-left:17%;">Stream the <small>NTFS</small>
filesystem <tt>&quot;device&quot;</tt> to the local file
<tt>&quot;backupfile&quot;</tt>. The format used for the
backup file is a special format used by the
<i>ntfsclone</i>(8) tool.</p>

<p style="margin-left:17%; margin-top: 1em">If the optional
<tt>&quot;metadataonly&quot;</tt> flag is true, then
<i>only</i> the metadata is saved, losing all the user data
(this is useful for diagnosing some filesystem
problems).</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;rescue&quot;</tt>,
<tt>&quot;ignorefscheck&quot;</tt>,
<tt>&quot;preservetimestamps&quot;</tt> and
<tt>&quot;force&quot;</tt> flags have precise meanings
detailed in the <i>ntfsclone</i>(8) man page.</p>

<p style="margin-left:17%; margin-top: 1em">Use
<tt>&quot;$g&minus;&gt;ntfsclone_in&quot;</tt> to restore
the file back to a libguestfs device.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ntfs3g&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;ntfsfix ($device
[, clearbadsectors =&gt; $clearbadsectors]);</p>

<p style="margin-left:17%;">This command repairs some
fundamental <small>NTFS</small> inconsistencies, resets the
<small>NTFS</small> journal file, and schedules an
<small>NTFS</small> consistency check for the first boot
into Windows.</p>

<p style="margin-left:17%; margin-top: 1em">This is
<i>not</i> an equivalent of Windows
<tt>&quot;chkdsk&quot;</tt>. It does <i>not</i> scan the
filesystem for inconsistencies.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;clearbadsectors&quot;</tt> flag clears the list of
bad sectors. This is useful after cloning a disk with bad
sectors to a new disk.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ntfs3g&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;ntfsresize
($device [, size =&gt; $size] [, force =&gt; $force]);</p>

<p style="margin-left:17%;">This command resizes an
<small>NTFS</small> filesystem, expanding or shrinking it to
the size of the underlying device.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
parameters are: <br>
&quot;size&quot;</p>

<p style="margin-left:23%;">The new size (in bytes) of the
filesystem. If omitted, the filesystem is resized to fit the
container (eg. partition).</p>

<p style="margin-left:17%;">&quot;force&quot;</p>

<p style="margin-left:23%;">If this option is true, then
force the resize of the filesystem even if the filesystem is
marked as requiring a consistency check.</p>

<p style="margin-left:23%; margin-top: 1em">After the
resize operation, the filesystem is always marked as
requiring a consistency check (for safety). You have to boot
into Windows to perform this check and clear this condition.
If you <i>don&rsquo;t</i> set the <tt>&quot;force&quot;</tt>
option then it is not possible to call
<tt>&quot;$g&minus;&gt;ntfsresize&quot;</tt> multiple times
on a single filesystem without booting into Windows between
each resize.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>ntfsresize</i>(8).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ntfsprogs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;ntfsresize_opts
($device [, size =&gt; $size] [, force =&gt; $force]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;ntfsresize&quot;.</p>

<p style="margin-left:11%;">$g&minus;&gt;ntfsresize_size
($device, $size);</p>

<p style="margin-left:17%;">This command is the same as
<tt>&quot;$g&minus;&gt;ntfsresize&quot;</tt> except that it
allows you to specify the new size (in bytes)
explicitly.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;ntfsprogs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;ntfsresize&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;parse_environment
();</p>

<p style="margin-left:17%;">Parse the program&rsquo;s
environment and set flags in the handle accordingly. For
example if <tt>&quot;LIBGUESTFS_DEBUG=1&quot;</tt> then the
&rsquo;verbose&rsquo; flag is set in the handle.</p>

<p style="margin-left:17%; margin-top: 1em"><i>Most
programs do not need to call this</i>. It is done implicitly
when you call <tt>&quot;$g&minus;&gt;create&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>ENVIRONMENT VARIABLES&quot;</small> in
<i>guestfs</i>(3) for a list of environment variables that
can affect libguestfs handles. See also
&quot;guestfs_create_flags&quot; in <i>guestfs</i>(3), and
<tt>&quot;$g&minus;&gt;parse_environment_list&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;parse_environment_list
(\@environment);</p>

<p style="margin-left:17%;">Parse the list of strings in
the argument <tt>&quot;environment&quot;</tt> and set flags
in the handle accordingly. For example if
<tt>&quot;LIBGUESTFS_DEBUG=1&quot;</tt> is a string in the
list, then the &rsquo;verbose&rsquo; flag is set in the
handle.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as <tt>&quot;$g&minus;&gt;parse_environment&quot;</tt>
except that it parses an explicit list of strings instead of
the program&rsquo;s environment.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_add ($device,
$prlogex, $startsect, $endsect);</p>

<p style="margin-left:17%;">This command adds a partition
to <tt>&quot;device&quot;</tt>. If there is no partition
table on the device, call
<tt>&quot;$g&minus;&gt;part_init&quot;</tt> first.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;prlogex&quot;</tt> parameter is the type of
partition. Normally you should pass <tt>&quot;p&quot;</tt>
or <tt>&quot;primary&quot;</tt> here, but <small>MBR</small>
partition tables also support <tt>&quot;l&quot;</tt> (or
<tt>&quot;logical&quot;</tt>) and <tt>&quot;e&quot;</tt> (or
<tt>&quot;extended&quot;</tt>) partition types.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;startsect&quot;</tt>
and <tt>&quot;endsect&quot;</tt> are the start and end of
the partition in <i>sectors</i>.
<tt>&quot;endsect&quot;</tt> may be negative, which means it
counts backwards from the end of the disk
(<tt>&quot;&minus;1&quot;</tt> is the last sector).</p>

<p style="margin-left:17%; margin-top: 1em">Creating a
partition which covers the whole disk is not so easy. Use
<tt>&quot;$g&minus;&gt;part_disk&quot;</tt> to do that.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_del ($device,
$partnum);</p>

<p style="margin-left:17%;">This command deletes the
partition numbered <tt>&quot;partnum&quot;</tt> on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that in
the case of <small>MBR</small> partitioning, deleting an
extended partition also deletes any logical partitions it
contains.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_disk
($device, $parttype);</p>

<p style="margin-left:17%;">This command is simply a
combination of <tt>&quot;$g&minus;&gt;part_init&quot;</tt>
followed by <tt>&quot;$g&minus;&gt;part_add&quot;</tt> to
create a single primary partition covering the whole
disk.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;parttype&quot;</tt>
is the partition table type, usually
<tt>&quot;mbr&quot;</tt> or <tt>&quot;gpt&quot;</tt>, but
other possible values are described in
<tt>&quot;$g&minus;&gt;part_init&quot;</tt>.</p>

<p style="margin-left:11%;">$bootable =
$g&minus;&gt;part_get_bootable ($device, $partnum);</p>

<p style="margin-left:17%;">This command returns true if
the partition <tt>&quot;partnum&quot;</tt> on
<tt>&quot;device&quot;</tt> has the bootable flag set.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;part_set_bootable&quot;</tt>.</p>

<p style="margin-left:11%;">$guid =
$g&minus;&gt;part_get_gpt_guid ($device, $partnum);</p>

<p style="margin-left:17%;">Return the <small>GUID</small>
of numbered <small>GPT</small> partition
<tt>&quot;partnum&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;gdisk&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$guid =
$g&minus;&gt;part_get_gpt_type ($device, $partnum);</p>

<p style="margin-left:17%;">Return the type
<small>GUID</small> of numbered <small>GPT</small> partition
<tt>&quot;partnum&quot;</tt>. For <small>MBR</small>
partitions, return an appropriate <small>GUID</small>
corresponding to the <small>MBR</small> type. Behaviour is
undefined for other partition types.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;gdisk&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$idbyte =
$g&minus;&gt;part_get_mbr_id ($device, $partnum);</p>

<p style="margin-left:17%;">Returns the <small>MBR</small>
type byte (also known as the <small>ID</small> byte) from
the numbered partition <tt>&quot;partnum&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that only
<small>MBR</small> (old DOS-style) partitions have type
bytes. You will get undefined results for other partition
table types (see
<tt>&quot;$g&minus;&gt;part_get_parttype&quot;</tt>).</p>

<p style="margin-left:11%;">$partitiontype =
$g&minus;&gt;part_get_mbr_part_type ($device, $partnum);</p>

<p style="margin-left:17%;">This returns the partition type
of an <small>MBR</small> partition numbered
<tt>&quot;partnum&quot;</tt> on device
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">It returns
<tt>&quot;primary&quot;</tt>, <tt>&quot;logical&quot;</tt>,
or <tt>&quot;extended&quot;</tt>.</p>

<p style="margin-left:11%;">$name =
$g&minus;&gt;part_get_name ($device, $partnum);</p>

<p style="margin-left:17%;">This gets the partition name on
partition numbered <tt>&quot;partnum&quot;</tt> on device
<tt>&quot;device&quot;</tt>. Note that partitions are
numbered from 1.</p>

<p style="margin-left:17%; margin-top: 1em">The partition
name can only be read on certain types of partition table.
This works on <tt>&quot;gpt&quot;</tt> but not on
<tt>&quot;mbr&quot;</tt> partitions.</p>

<p style="margin-left:11%;">$parttype =
$g&minus;&gt;part_get_parttype ($device);</p>

<p style="margin-left:17%;">This command examines the
partition table on <tt>&quot;device&quot;</tt> and returns
the partition table type (format) being used.</p>

<p style="margin-left:17%; margin-top: 1em">Common return
values include: <tt>&quot;msdos&quot;</tt> (a DOS/Windows
style <small>MBR</small> partition table),
<tt>&quot;gpt&quot;</tt> (a GPT/EFI&minus;style partition
table). Other values are possible, although unusual. See
<tt>&quot;$g&minus;&gt;part_init&quot;</tt> for a full
list.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_init
($device, $parttype);</p>

<p style="margin-left:17%;">This creates an empty partition
table on <tt>&quot;device&quot;</tt> of one of the partition
types listed below. Usually <tt>&quot;parttype&quot;</tt>
should be either <tt>&quot;msdos&quot;</tt> or
<tt>&quot;gpt&quot;</tt> (for large disks).</p>

<p style="margin-left:17%; margin-top: 1em">Initially there
are no partitions. Following this, you should call
<tt>&quot;$g&minus;&gt;part_add&quot;</tt> for each
partition required.</p>

<p style="margin-left:17%; margin-top: 1em">Possible values
for <tt>&quot;parttype&quot;</tt> are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>efi</b></p></td>
<td width="1%"></td>
<td width="49%">
</td>
<td width="28%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>gpt</b></p></td>
<td width="1%"></td>
<td width="49%">


<p>Intel <small>EFI / GPT</small> partition table.</p></td>
<td width="28%">
</td></tr>
</table>

<p style="margin-left:23%; margin-top: 1em">This is
recommended for &gt;= 2 <small>TB</small> partitions that
will be accessed from Linux and Intel-based Mac <small>OS
X.</small> It also has limited backwards compatibility with
the <tt>&quot;mbr&quot;</tt> format.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p style="margin-top: 1em"><b>mbr</b></p></td>
<td width="78%">
</td></tr>
</table>

<p style="margin-left:17%;"><b>msdos</b></p>

<p style="margin-left:23%;">The standard <small>PC</small>
&quot;Master Boot Record&quot; ( <small>MBR</small> ) format
used by MS-DOS and Windows. This partition type will
<b>only</b> work for device sizes up to 2 <small>TB.</small>
For large disks we recommend using
<tt>&quot;gpt&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Other partition
table types that may work but are not supported include:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>aix</b></p></td>
<td width="1%"></td>
<td width="25%">


<p><small>AIX</small> disk labels.</p></td>
<td width="52%">
</td></tr>
</table>

<p style="margin-left:17%;"><b>amiga</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>rdb</b></p></td>
<td width="1%"></td>
<td width="49%">


<p>Amiga &quot;Rigid Disk Block&quot; format.</p></td>
<td width="28%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>bsd</b></p></td>
<td width="1%"></td>
<td width="49%">


<p><small>BSD</small> disk labels.</p></td>
<td width="28%">
</td></tr>
</table>

<p style="margin-left:17%;"><b>dasd</b></p>

<p style="margin-left:23%;"><small>DASD,</small> used on
<small>IBM</small> mainframes.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>dvh</b></p></td>
<td width="1%"></td>
<td width="75%">


<p><small>MIPS/SGI</small> volumes.</p></td>
<td width="2%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>mac</b></p></td>
<td width="1%"></td>
<td width="75%">


<p>Old Mac partition format. Modern Macs use
<tt>&quot;gpt&quot;</tt>.</p> </td>
<td width="2%">
</td></tr>
</table>

<p style="margin-left:17%;"><b>pc98</b></p>

<p style="margin-left:23%;"><small>NEC PC&minus;98</small>
format, common in Japan apparently.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><b>sun</b></p></td>
<td width="1%"></td>
<td width="25%">


<p>Sun disk labels.</p></td>
<td width="52%">
</td></tr>
</table>

<p style="margin-left:11%;">@partitions =
$g&minus;&gt;part_list ($device);</p>

<p style="margin-left:17%;">This command parses the
partition table on <tt>&quot;device&quot;</tt> and returns
the list of partitions found.</p>

<p style="margin-left:17%; margin-top: 1em">The fields in
the returned structure are: <b><br>
part_num</b></p>

<p style="margin-left:23%;">Partition number, counting from
1.</p>

<p style="margin-left:17%;"><b>part_start</b></p>

<p style="margin-left:23%;">Start of the partition <i>in
bytes</i>. To get sectors you have to divide by the
device&rsquo;s sector size, see
<tt>&quot;$g&minus;&gt;blockdev_getss&quot;</tt>.</p>

<p style="margin-left:17%;"><b>part_end</b></p>

<p style="margin-left:23%;">End of the partition in
bytes.</p>

<p style="margin-left:17%;"><b>part_size</b></p>

<p style="margin-left:23%;">Size of the partition in
bytes.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_set_bootable
($device, $partnum, $bootable);</p>

<p style="margin-left:17%;">This sets the bootable flag on
partition numbered <tt>&quot;partnum&quot;</tt> on device
<tt>&quot;device&quot;</tt>. Note that partitions are
numbered from 1.</p>

<p style="margin-left:17%; margin-top: 1em">The bootable
flag is used by some operating systems (notably Windows) to
determine which partition to boot from. It is by no means
universally recognized.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_set_gpt_guid
($device, $partnum, $guid);</p>

<p style="margin-left:17%;">Set the <small>GUID</small> of
numbered <small>GPT</small> partition
<tt>&quot;partnum&quot;</tt> to <tt>&quot;guid&quot;</tt>.
Return an error if the partition table of
<tt>&quot;device&quot;</tt> isn&rsquo;t <small>GPT,</small>
or if <tt>&quot;guid&quot;</tt> is not a valid
<small>GUID.</small></p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;gdisk&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_set_gpt_type
($device, $partnum, $guid);</p>

<p style="margin-left:17%;">Set the type
<small>GUID</small> of numbered <small>GPT</small> partition
<tt>&quot;partnum&quot;</tt> to <tt>&quot;guid&quot;</tt>.
Return an error if the partition table of
<tt>&quot;device&quot;</tt> isn&rsquo;t <small>GPT,</small>
or if <tt>&quot;guid&quot;</tt> is not a valid
<small>GUID.</small></p>

<p style="margin-left:17%; margin-top: 1em">See
&lt;http://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs&gt;
for a useful list of type GUIDs.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;gdisk&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;part_set_mbr_id
($device, $partnum, $idbyte);</p>

<p style="margin-left:17%;">Sets the <small>MBR</small>
type byte (also known as the <small>ID</small> byte) of the
numbered partition <tt>&quot;partnum&quot;</tt> to
<tt>&quot;idbyte&quot;</tt>. Note that the type bytes quoted
in most documentation are in fact hexadecimal numbers, but
usually documented without any leading &quot;0x&quot; which
might be confusing.</p>

<p style="margin-left:17%; margin-top: 1em">Note that only
<small>MBR</small> (old DOS-style) partitions have type
bytes. You will get undefined results for other partition
table types (see
<tt>&quot;$g&minus;&gt;part_get_parttype&quot;</tt>).</p>

<p style="margin-left:11%;">$g&minus;&gt;part_set_name
($device, $partnum, $name);</p>

<p style="margin-left:17%;">This sets the partition name on
partition numbered <tt>&quot;partnum&quot;</tt> on device
<tt>&quot;device&quot;</tt>. Note that partitions are
numbered from 1.</p>

<p style="margin-left:17%; margin-top: 1em">The partition
name can only be set on certain types of partition table.
This works on <tt>&quot;gpt&quot;</tt> but not on
<tt>&quot;mbr&quot;</tt> partitions.</p>

<p style="margin-left:11%;">$device =
$g&minus;&gt;part_to_dev ($partition);</p>

<p style="margin-left:17%;">This function takes a partition
name (eg. &quot;/dev/sdb1&quot;) and removes the partition
number, returning the device name (eg.
&quot;/dev/sdb&quot;).</p>

<p style="margin-left:17%; margin-top: 1em">The named
partition must exist, for example as a string returned from
<tt>&quot;$g&minus;&gt;list_partitions&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;part_to_partnum&quot;</tt>,
<tt>&quot;$g&minus;&gt;device_index&quot;</tt>.</p>

<p style="margin-left:11%;">$partnum =
$g&minus;&gt;part_to_partnum ($partition);</p>

<p style="margin-left:17%;">This function takes a partition
name (eg. &quot;/dev/sdb1&quot;) and returns the partition
number (eg. <tt>1</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">The named
partition must exist, for example as a string returned from
<tt>&quot;$g&minus;&gt;list_partitions&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;part_to_dev&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;ping_daemon
();</p>

<p style="margin-left:17%;">This is a test probe into the
guestfs daemon running inside the libguestfs appliance.
Calling this function checks that the daemon responds to the
ping message, without affecting the daemon or attached block
device(s) in any other way.</p>

<p style="margin-left:11%;">$content = $g&minus;&gt;pread
($path, $count, $offset);</p>

<p style="margin-left:17%;">This command lets you read part
of a file. It reads <tt>&quot;count&quot;</tt> bytes of the
file, starting at <tt>&quot;offset&quot;</tt>, from file
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This may read
fewer bytes than requested. For further details see the
<i>pread</i>(2) system call.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;pwrite&quot;</tt>,
<tt>&quot;$g&minus;&gt;pread_device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$content =
$g&minus;&gt;pread_device ($device, $count, $offset);</p>

<p style="margin-left:17%;">This command lets you read part
of a block device. It reads <tt>&quot;count&quot;</tt> bytes
of <tt>&quot;device&quot;</tt>, starting at
<tt>&quot;offset&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This may read
fewer bytes than requested. For further details see the
<i>pread</i>(2) system call.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;pread&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;pvchange_uuid
($device);</p>

<p style="margin-left:17%;">Generate a new random
<small>UUID</small> for the physical volume
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;pvchange_uuid_all
();</p>

<p style="margin-left:17%;">Generate new random UUIDs for
all physical volumes.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;pvcreate
($device);</p>

<p style="margin-left:17%;">This creates an
<small>LVM</small> physical volume on the named
<tt>&quot;device&quot;</tt>, where
<tt>&quot;device&quot;</tt> should usually be a partition
name such as <i>/dev/sda1</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;pvremove
($device);</p>

<p style="margin-left:17%;">This wipes a physical volume
<tt>&quot;device&quot;</tt> so that <small>LVM</small> will
no longer recognise it.</p>

<p style="margin-left:17%; margin-top: 1em">The
implementation uses the <tt>&quot;pvremove&quot;</tt>
command which refuses to wipe physical volumes that contain
any volume groups, so you have to remove those first.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;pvresize
($device);</p>

<p style="margin-left:17%;">This resizes (expands or
shrinks) an existing <small>LVM</small> physical volume to
match the new size of the underlying device.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;pvresize_size
($device, $size);</p>

<p style="margin-left:17%;">This command is the same as
<tt>&quot;$g&minus;&gt;pvresize&quot;</tt> except that it
allows you to specify the new size (in bytes)
explicitly.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@physvols = $g&minus;&gt;pvs
();</p>

<p style="margin-left:17%;">List all the physical volumes
detected. This is the equivalent of the <i>pvs</i>(8)
command.</p>

<p style="margin-left:17%; margin-top: 1em">This returns a
list of just the device names that contain PVs (eg.
<i>/dev/sda2</i>).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;pvs_full&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@physvols =
$g&minus;&gt;pvs_full ();</p>

<p style="margin-left:17%;">List all the physical volumes
detected. This is the equivalent of the <i>pvs</i>(8)
command. The &quot;full&quot; version includes all
fields.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$uuid = $g&minus;&gt;pvuuid
($device);</p>

<p style="margin-left:17%;">This command returns the
<small>UUID</small> of the <small>LVM PV</small>
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:11%;">$nbytes = $g&minus;&gt;pwrite
($path, $content, $offset);</p>

<p style="margin-left:17%;">This command writes to part of
a file. It writes the data buffer
<tt>&quot;content&quot;</tt> to the file
<tt>&quot;path&quot;</tt> starting at offset
<tt>&quot;offset&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This command
implements the <i>pwrite</i>(2) system call, and like that
system call it may not write the full data requested. The
return value is the number of bytes that were actually
written to the file. This could even be 0, although short
writes are unlikely for regular files in ordinary
circumstances.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;pread&quot;</tt>,
<tt>&quot;$g&minus;&gt;pwrite_device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$nbytes =
$g&minus;&gt;pwrite_device ($device, $content, $offset);</p>

<p style="margin-left:17%;">This command writes to part of
a device. It writes the data buffer
<tt>&quot;content&quot;</tt> to <tt>&quot;device&quot;</tt>
starting at offset <tt>&quot;offset&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This command
implements the <i>pwrite</i>(2) system call, and like that
system call it may not write the full data requested
(although short writes to disk devices and partitions are
probably impossible with standard Linux kernels).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;pwrite&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$content =
$g&minus;&gt;read_file ($path);</p>

<p style="margin-left:17%;">This calls returns the contents
of the file <tt>&quot;path&quot;</tt> as a buffer.</p>

<p style="margin-left:17%; margin-top: 1em">Unlike
<tt>&quot;$g&minus;&gt;cat&quot;</tt>, this function can
correctly handle files that contain embedded <small>ASCII
NUL</small> characters.</p>

<p style="margin-left:11%;">@lines =
$g&minus;&gt;read_lines ($path);</p>

<p style="margin-left:17%;">Return the contents of the file
named <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The file
contents are returned as a list of lines. Trailing
<tt>&quot;LF&quot;</tt> and <tt>&quot;CRLF&quot;</tt>
character sequences are <i>not</i> returned.</p>

<p style="margin-left:17%; margin-top: 1em">Note that this
function cannot correctly handle binary files (specifically,
files containing <tt>&quot;\0&quot;</tt> character which is
treated as end of string). For those you need to use the
<tt>&quot;$g&minus;&gt;read_file&quot;</tt> function and
split the buffer into lines yourself.</p>

<p style="margin-left:11%;">@entries = $g&minus;&gt;readdir
($dir);</p>

<p style="margin-left:17%;">This returns the list of
directory entries in directory <tt>&quot;dir&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">All entries in
the directory are returned, including <tt>&quot;.&quot;</tt>
and <tt>&quot;..&quot;</tt>. The entries are <i>not</i>
sorted, but returned in the same order as the underlying
filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">Also this call
returns basic file type information about each file. The
<tt>&quot;ftyp&quot;</tt> field will contain one of the
following characters:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;b&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Block special</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;c&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Char special</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;d&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Directory</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;f&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p><small>FIFO</small> (named pipe)</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;l&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Symbolic link</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;r&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Regular file</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;s&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Socket</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;u&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>Unknown file type</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>&rsquo;?&rsquo;</p></td>
<td width="1%"></td>
<td width="77%">


<p>The <i>readdir</i>(3) call returned a
<tt>&quot;d_type&quot;</tt> field with an unexpected
value</p> </td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">This function
is primarily intended for use by programs. To get a simple
list of names, use <tt>&quot;$g&minus;&gt;ls&quot;</tt>. To
get a printable directory for human consumption, use
<tt>&quot;$g&minus;&gt;ll&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$link = $g&minus;&gt;readlink
($path);</p>

<p style="margin-left:17%;">This command reads the target
of a symbolic link.</p>

<p style="margin-left:11%;">@links =
$g&minus;&gt;readlinklist ($path, \@names);</p>

<p style="margin-left:17%;">This call allows you to do a
<tt>&quot;readlink&quot;</tt> operation on multiple files,
where all files are in the directory
<tt>&quot;path&quot;</tt>. <tt>&quot;names&quot;</tt> is the
list of files from this directory.</p>

<p style="margin-left:17%; margin-top: 1em">On return you
get a list of strings, with a one-to-one correspondence to
the <tt>&quot;names&quot;</tt> list. Each string is the
value of the symbolic link.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<i>readlink</i>(2) operation fails on any name, then the
corresponding result string is the empty string
<tt>&quot;&quot;</tt>. However the whole operation is
completed even if there were <i>readlink</i>(2) errors, and
so you can call this function with names where you
don&rsquo;t know if they are symbolic links already (albeit
slightly less efficient).</p>

<p style="margin-left:17%; margin-top: 1em">This call is
intended for programs that want to efficiently list a
directory contents without making many round-trips.</p>

<p style="margin-left:11%;">$rpath = $g&minus;&gt;realpath
($path);</p>

<p style="margin-left:17%;">Return the canonicalized
absolute pathname of <tt>&quot;path&quot;</tt>. The returned
path has no <tt>&quot;.&quot;</tt>, <tt>&quot;..&quot;</tt>
or symbolic link path elements.</p>

<p style="margin-left:11%;">$g&minus;&gt;remount
($mountpoint [, rw =&gt; $rw]);</p>

<p style="margin-left:17%;">This call allows you to change
the <tt>&quot;rw&quot;</tt> (readonly/read&minus;write) flag
on an already mounted filesystem at
<tt>&quot;mountpoint&quot;</tt>, converting a readonly
filesystem to be read-write, or vice-versa.</p>

<p style="margin-left:17%; margin-top: 1em">Note that at
the moment you must supply the &quot;optional&quot;
<tt>&quot;rw&quot;</tt> parameter. In future we may allow
other flags to be adjusted.</p>

<p style="margin-left:11%;">$g&minus;&gt;remove_drive
($label);</p>

<p style="margin-left:17%;">This function is conceptually
the opposite of
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>. It removes
the drive that was previously added with label
<tt>&quot;label&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that in
order to remove drives, you have to add them with labels
(see the optional <tt>&quot;label&quot;</tt> argument to
<tt>&quot;$g&minus;&gt;add_drive_opts&quot;</tt>). If you
didn&rsquo;t use a label, then they cannot be removed.</p>

<p style="margin-left:17%; margin-top: 1em">You can call
this function before or after launching the handle. If
called after launch, if the backend supports it, we try to
hot unplug the drive: see &quot;
<small>HOTPLUGGING&quot;</small> in <i>guestfs</i>(3). The
disk <b>must not</b> be in use (eg. mounted) when you do
this. We try to detect if the disk is in use and stop you
from doing this.</p>

<p style="margin-left:11%;">$g&minus;&gt;removexattr
($xattr, $path);</p>

<p style="margin-left:17%;">This call removes the extended
attribute named <tt>&quot;xattr&quot;</tt> of the file
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;lremovexattr&quot;</tt>,
<i>attr</i>(5).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;rename ($oldpath,
$newpath);</p>

<p style="margin-left:17%;">Rename a file to a new place on
the same filesystem. This is the same as the Linux
<i>rename</i>(2) system call. In most cases you are better
to use <tt>&quot;$g&minus;&gt;mv&quot;</tt> instead.</p>

<p style="margin-left:11%;">$g&minus;&gt;resize2fs
($device);</p>

<p style="margin-left:17%;">This resizes an ext2, ext3 or
ext4 filesystem to match the size of the underlying
device.</p>

<p style="margin-left:17%; margin-top: 1em">See also &quot;
<small>RESIZE2FS ERRORS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;resize2fs_M
($device);</p>

<p style="margin-left:17%;">This command is the same as
<tt>&quot;$g&minus;&gt;resize2fs&quot;</tt>, but the
filesystem is resized to its minimum size. This works like
the <i>&minus;M</i> option to the
<tt>&quot;resize2fs&quot;</tt> command.</p>

<p style="margin-left:17%; margin-top: 1em">To get the
resulting size of the filesystem you should call
<tt>&quot;$g&minus;&gt;tune2fs_l&quot;</tt> and read the
<tt>&quot;Block size&quot;</tt> and <tt>&quot;Block
count&quot;</tt> values. These two numbers, multiplied
together, give the resulting size of the minimal filesystem
in bytes.</p>

<p style="margin-left:17%; margin-top: 1em">See also &quot;
<small>RESIZE2FS ERRORS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;resize2fs_size
($device, $size);</p>

<p style="margin-left:17%;">This command is the same as
<tt>&quot;$g&minus;&gt;resize2fs&quot;</tt> except that it
allows you to specify the new size (in bytes)
explicitly.</p>

<p style="margin-left:17%; margin-top: 1em">See also &quot;
<small>RESIZE2FS ERRORS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;rm ($path);</p>

<p style="margin-left:17%;">Remove the single file
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;rm_f ($path);</p>

<p style="margin-left:17%;">Remove the file
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If the file
doesn&rsquo;t exist, that error is ignored. (Other errors,
eg. I/O errors or bad paths, are not ignored)</p>

<p style="margin-left:17%; margin-top: 1em">This call
cannot remove directories. Use
<tt>&quot;$g&minus;&gt;rmdir&quot;</tt> to remove an empty
directory, or <tt>&quot;$g&minus;&gt;rm_rf&quot;</tt> to
remove directories recursively.</p>

<p style="margin-left:11%;">$g&minus;&gt;rm_rf ($path);</p>

<p style="margin-left:17%;">Remove the file or directory
<tt>&quot;path&quot;</tt>, recursively removing the contents
if its a directory. This is like the <tt>&quot;rm
&minus;rf&quot;</tt> shell command.</p>

<p style="margin-left:11%;">$g&minus;&gt;rmdir ($path);</p>

<p style="margin-left:17%;">Remove the single directory
<tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;rmmountpoint
($exemptpath);</p>

<p style="margin-left:17%;">This calls removes a mountpoint
that was previously created with
<tt>&quot;$g&minus;&gt;mkmountpoint&quot;</tt>. See
<tt>&quot;$g&minus;&gt;mkmountpoint&quot;</tt> for full
details.</p>

<p style="margin-left:11%;">$g&minus;&gt;rsync ($src, $dest
[, archive =&gt; $archive] [, deletedest =&gt; <br>
$deletedest]);</p>

<p style="margin-left:17%;">This call may be used to copy
or synchronize two directories under the same libguestfs
handle. This uses the <i>rsync</i>(1) program which uses a
fast algorithm that avoids copying files unnecessarily.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;src&quot;</tt>
and <tt>&quot;dest&quot;</tt> are the source and destination
directories. Files are copied from <tt>&quot;src&quot;</tt>
to <tt>&quot;dest&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments are: <br>
&quot;archive&quot;</p>

<p style="margin-left:23%;">Turns on archive mode. This is
the same as passing the <i>&minus;&minus;archive</i> flag to
<tt>&quot;rsync&quot;</tt>.</p>

<p style="margin-left:17%;">&quot;deletedest&quot;</p>

<p style="margin-left:23%;">Delete files at the destination
that do not exist at the source.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;rsync&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;rsync_in ($remote,
$dest [, archive =&gt; $archive] [, deletedest =&gt; <br>
$deletedest]);</p>

<p style="margin-left:17%;">This call may be used to copy
or synchronize the filesystem on the host or on a remote
computer with the filesystem within libguestfs. This uses
the <i>rsync</i>(1) program which uses a fast algorithm that
avoids copying files unnecessarily.</p>

<p style="margin-left:17%; margin-top: 1em">This call only
works if the network is enabled. See
<tt>&quot;$g&minus;&gt;set_network&quot;</tt> or the
<i>&minus;&minus;network</i> option to various tools like
<i>guestfish</i>(1).</p>

<p style="margin-left:17%; margin-top: 1em">Files are
copied from the remote server and directory specified by
<tt>&quot;remote&quot;</tt> to the destination directory
<tt>&quot;dest&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The format of
the remote server string is defined by <i>rsync</i>(1). Note
that there is no way to supply a password or passphrase so
the target must be set up not to require one.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments are the same as those of
<tt>&quot;$g&minus;&gt;rsync&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;rsync&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;rsync_out ($src,
$remote [, archive =&gt; $archive] [, deletedest =&gt; <br>
$deletedest]);</p>

<p style="margin-left:17%;">This call may be used to copy
or synchronize the filesystem within libguestfs with a
filesystem on the host or on a remote computer. This uses
the <i>rsync</i>(1) program which uses a fast algorithm that
avoids copying files unnecessarily.</p>

<p style="margin-left:17%; margin-top: 1em">This call only
works if the network is enabled. See
<tt>&quot;$g&minus;&gt;set_network&quot;</tt> or the
<i>&minus;&minus;network</i> option to various tools like
<i>guestfish</i>(1).</p>

<p style="margin-left:17%; margin-top: 1em">Files are
copied from the source directory <tt>&quot;src&quot;</tt> to
the remote server and directory specified by
<tt>&quot;remote&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The format of
the remote server string is defined by <i>rsync</i>(1). Note
that there is no way to supply a password or passphrase so
the target must be set up not to require one.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments are the same as those of
<tt>&quot;$g&minus;&gt;rsync&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Globbing does
not happen on the <tt>&quot;src&quot;</tt> parameter. In
programs which use the <small>API</small> directly you have
to expand wildcards yourself (see
<tt>&quot;$g&minus;&gt;glob_expand&quot;</tt>). In guestfish
you can use the <tt>&quot;glob&quot;</tt> command (see
&quot;glob&quot; in <i>guestfish</i>(1)), for example:</p>

<pre style="margin-left:17%; margin-top: 1em"> &gt;&lt;fs&gt; glob rsync&minus;out /* rsync://remote/</pre>


<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;rsync&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;scrub_device
($device);</p>

<p style="margin-left:17%;">This command writes patterns
over <tt>&quot;device&quot;</tt> to make data retrieval more
difficult.</p>

<p style="margin-left:17%; margin-top: 1em">It is an
interface to the <i>scrub</i>(1) program. See that manual
page for more details.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;scrub&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;scrub_file
($file);</p>

<p style="margin-left:17%;">This command writes patterns
over a file to make data retrieval more difficult.</p>

<p style="margin-left:17%; margin-top: 1em">The file is
<i>removed</i> after scrubbing.</p>

<p style="margin-left:17%; margin-top: 1em">It is an
interface to the <i>scrub</i>(1) program. See that manual
page for more details.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;scrub&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;scrub_freespace
($dir);</p>

<p style="margin-left:17%;">This command creates the
directory <tt>&quot;dir&quot;</tt> and then fills it with
files until the filesystem is full, and scrubs the files as
for <tt>&quot;$g&minus;&gt;scrub_file&quot;</tt>, and
deletes them. The intention is to scrub any free space on
the partition containing <tt>&quot;dir&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">It is an
interface to the <i>scrub</i>(1) program. See that manual
page for more details.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;scrub&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;selinux_relabel
($specfile, $path [, force =&gt; $force]);</p>

<p style="margin-left:17%;">SELinux relabel parts of the
filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;specfile&quot;</tt> parameter controls the policy
spec file used. You have to parse
<tt>&quot;/etc/selinux/config&quot;</tt> to find the correct
SELinux policy and then pass the spec file, usually:
<tt>&quot;/etc/selinux/&quot;</tt> + <i>selinuxtype</i> +
<tt>&quot;/contexts/files/file_contexts&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The required
<tt>&quot;path&quot;</tt> parameter is the top level
directory where relabelling starts. Normally you should pass
<tt>&quot;path&quot;</tt> as <tt>&quot;/&quot;</tt> to
relabel the whole guest filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;force&quot;</tt> boolean controls whether the
context is reset for customizable files, and also whether
the user, role and range parts of the file context is
changed.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;selinuxrelabel&quot;</tt>.
See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_append
($append);</p>

<p style="margin-left:17%;">This function is used to add
additional options to the libguestfs appliance kernel
command line.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
<tt>&quot;NULL&quot;</tt> unless overridden by setting
<tt>&quot;LIBGUESTFS_APPEND&quot;</tt> environment
variable.</p>

<p style="margin-left:17%; margin-top: 1em">Setting
<tt>&quot;append&quot;</tt> to <tt>&quot;NULL&quot;</tt>
means <i>no</i> additional options are passed (libguestfs
always adds a few of its own).</p>

<p style="margin-left:11%;">$g&minus;&gt;set_attach_method
($backend);</p>

<p style="margin-left:17%;">Set the method that libguestfs
uses to connect to the backend guestfsd daemon.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;set_backend&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_autosync
($autosync);</p>

<p style="margin-left:17%;">If
<tt>&quot;autosync&quot;</tt> is true, this enables
autosync. Libguestfs will make a best effort attempt to make
filesystems consistent and synchronized when the handle is
closed (also if the program exits without closing
handles).</p>

<p style="margin-left:17%; margin-top: 1em">This is enabled
by default (since libguestfs 1.5.24, previously it was
disabled by default).</p>

<p style="margin-left:11%;">$g&minus;&gt;set_backend
($backend);</p>

<p style="margin-left:17%;">Set the method that libguestfs
uses to connect to the backend guestfsd daemon.</p>

<p style="margin-left:17%; margin-top: 1em">This handle
property was previously called the &quot;attach
method&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$g&minus;&gt;set_backend_setting
($name, $val);</p>

<p style="margin-left:17%;">Append
<tt>&quot;name=value&quot;</tt> to the backend settings
string list. However if a string already exists matching
<tt>&quot;name&quot;</tt> or beginning with
<tt>&quot;name=&quot;</tt>, then that setting is
replaced.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3), &quot;
<small>BACKEND SETTINGS&quot;</small> in
<i>guestfs</i>(3).</p>


<p style="margin-left:11%;">$g&minus;&gt;set_backend_settings
(\@settings);</p>

<p style="margin-left:17%;">Set a list of zero or more
settings which are passed through to the current backend.
Each setting is a string which is interpreted in a
backend-specific way, or ignored if not understood by the
backend.</p>

<p style="margin-left:17%; margin-top: 1em">The default
value is an empty list, unless the environment variable
<tt>&quot;LIBGUESTFS_BACKEND_SETTINGS&quot;</tt> was set
when the handle was created. This environment variable
contains a colon-separated list of settings.</p>

<p style="margin-left:17%; margin-top: 1em">This call
replaces all backend settings. If you want to replace a
single backend setting, see
<tt>&quot;$g&minus;&gt;set_backend_setting&quot;</tt>. If
you want to clear a single backend setting, see
<tt>&quot;$g&minus;&gt;clear_backend_setting&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>BACKEND&quot;</small> in <i>guestfs</i>(3), &quot;
<small>BACKEND SETTINGS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;set_cachedir
($cachedir);</p>

<p style="margin-left:17%;">Set the directory used by the
handle to store the appliance cache, when using a supermin
appliance. The appliance is cached and shared between all
handles which have the same effective user
<small>ID.</small></p>

<p style="margin-left:17%; margin-top: 1em">The environment
variables <tt>&quot;LIBGUESTFS_CACHEDIR&quot;</tt> and
<tt>&quot;TMPDIR&quot;</tt> control the default value: If
<tt>&quot;LIBGUESTFS_CACHEDIR&quot;</tt> is set, then that
is the default. Else if <tt>&quot;TMPDIR&quot;</tt> is set,
then that is the default. Else <i>/var/tmp</i> is the
default.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_direct
($direct);</p>

<p style="margin-left:17%;">If the direct appliance mode
flag is enabled, then stdin and stdout are passed directly
through to the appliance once it is launched.</p>

<p style="margin-left:17%; margin-top: 1em">One consequence
of this is that log messages aren&rsquo;t caught by the
library and handled by
<tt>&quot;$g&minus;&gt;set_log_message_callback&quot;</tt>,
but go straight to stdout.</p>

<p style="margin-left:17%; margin-top: 1em">You probably
don&rsquo;t want to use this unless you know what you are
doing.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
disabled.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_e2attrs
($file, $attrs [, clear =&gt; $clear]);</p>

<p style="margin-left:17%;">This sets or clears the file
attributes <tt>&quot;attrs&quot;</tt> associated with the
inode <i>file</i>.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;attrs&quot;</tt>
is a string of characters representing file attributes. See
<tt>&quot;$g&minus;&gt;get_e2attrs&quot;</tt> for a list of
possible attributes. Not all attributes can be changed.</p>

<p style="margin-left:17%; margin-top: 1em">If optional
boolean <tt>&quot;clear&quot;</tt> is not present or false,
then the <tt>&quot;attrs&quot;</tt> listed are set in the
inode.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>&quot;clear&quot;</tt> is true, then the
<tt>&quot;attrs&quot;</tt> listed are cleared in the
inode.</p>

<p style="margin-left:17%; margin-top: 1em">In both cases,
other attributes not present in the
<tt>&quot;attrs&quot;</tt> string are left unchanged.</p>

<p style="margin-left:17%; margin-top: 1em">These
attributes are only present when the file is located on an
ext2/3/4 filesystem. Using this call on other filesystem
types will result in an error.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_e2generation
($file, $generation);</p>

<p style="margin-left:17%;">This sets the ext2 file
generation of a file.</p>

<p style="margin-left:17%; margin-top: 1em">See
<tt>&quot;$g&minus;&gt;get_e2generation&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_e2label
($device, $label);</p>

<p style="margin-left:17%;">This sets the ext2/3/4
filesystem label of the filesystem on
<tt>&quot;device&quot;</tt> to <tt>&quot;label&quot;</tt>.
Filesystem labels are limited to 16 characters.</p>

<p style="margin-left:17%; margin-top: 1em">You can use
either <tt>&quot;$g&minus;&gt;tune2fs_l&quot;</tt> or
<tt>&quot;$g&minus;&gt;get_e2label&quot;</tt> to return the
existing label on a filesystem.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;set_label&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_e2uuid
($device, $uuid);</p>

<p style="margin-left:17%;">This sets the ext2/3/4
filesystem <small>UUID</small> of the filesystem on
<tt>&quot;device&quot;</tt> to <tt>&quot;uuid&quot;</tt>.
The format of the <small>UUID</small> and alternatives such
as <tt>&quot;clear&quot;</tt>, <tt>&quot;random&quot;</tt>
and <tt>&quot;time&quot;</tt> are described in the
<i>tune2fs</i>(8) manpage.</p>

<p style="margin-left:17%; margin-top: 1em">You can use
<tt>&quot;$g&minus;&gt;vfs_uuid&quot;</tt> to return the
existing <small>UUID</small> of a filesystem.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;set_uuid&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_hv ($hv);</p>

<p style="margin-left:17%;">Set the hypervisor binary that
we will use. The hypervisor depends on the backend, but is
usually the location of the qemu/KVM hypervisor. For the uml
backend, it is the location of the
<tt>&quot;linux&quot;</tt> or <tt>&quot;vmlinux&quot;</tt>
binary.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
chosen when the library was compiled by the configure
script.</p>

<p style="margin-left:17%; margin-top: 1em">You can also
override this by setting the
<tt>&quot;LIBGUESTFS_HV&quot;</tt> environment variable.</p>

<p style="margin-left:17%; margin-top: 1em">Note that you
should call this function as early as possible after
creating the handle. This is because some pre-launch
operations depend on testing qemu features (by running
<tt>&quot;qemu &minus;help&quot;</tt>). If the qemu binary
changes, we don&rsquo;t retest features, and so you might
see inconsistent results. Using the environment variable
<tt>&quot;LIBGUESTFS_HV&quot;</tt> is safest of all since
that picks the qemu binary at the same time as the handle is
created.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_identifier
($identifier);</p>

<p style="margin-left:17%;">This is an informative string
which the caller may optionally set in the handle. It is
printed in various places, allowing the current handle to be
identified in debugging output.</p>

<p style="margin-left:17%; margin-top: 1em">One important
place is when tracing is enabled. If the identifier string
is not an empty string, then trace messages change from
this:</p>

<pre style="margin-left:17%; margin-top: 1em"> libguestfs: trace: get_tmpdir
 libguestfs: trace: get_tmpdir = &quot;/tmp&quot;</pre>


<p style="margin-left:17%; margin-top: 1em">to this:</p>

<pre style="margin-left:17%; margin-top: 1em"> libguestfs: trace: ID: get_tmpdir
 libguestfs: trace: ID: get_tmpdir = &quot;/tmp&quot;</pre>


<p style="margin-left:17%; margin-top: 1em">where
<tt>&quot;ID&quot;</tt> is the identifier string set by this
call.</p>

<p style="margin-left:17%; margin-top: 1em">The identifier
must only contain alphanumeric <small>ASCII</small>
characters, underscore and minus sign. The default is the
empty string.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;set_program&quot;</tt>,
<tt>&quot;$g&minus;&gt;set_trace&quot;</tt>,
<tt>&quot;$g&minus;&gt;get_identifier&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_label
($mountable, $label);</p>

<p style="margin-left:17%;">Set the filesystem label on
<tt>&quot;mountable&quot;</tt> to
<tt>&quot;label&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Only some
filesystem types support labels, and libguestfs supports
setting labels on only a subset of these. <br>
ext2, ext3, ext4</p>

<p style="margin-left:23%;">Labels are limited to 16
bytes.</p>

<p style="margin-left:17%;"><small>NTFS</small></p>

<p style="margin-left:23%;">Labels are limited to 128
unicode characters.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p><small>XFS</small></p></td>
<td width="1%"></td>
<td width="77%">


<p>The label is limited to 12 bytes. The filesystem must
not be mounted when trying to set the label.</p></td></tr>
</table>

<p style="margin-left:17%;">btrfs</p>

<p style="margin-left:23%;">The label is limited to 255
bytes and some characters are not allowed. Setting the label
on a btrfs subvolume will set the label on its parent
filesystem. The filesystem must not be mounted when trying
to set the label.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="5%">


<p>fat</p></td>
<td width="1%"></td>
<td width="51%">


<p>The label is limited to 11 bytes.</p></td>
<td width="26%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">If there is no
support for changing the label for the type of the specified
filesystem, set_label will fail and set errno as
<small>ENOTSUP.</small></p>

<p style="margin-left:17%; margin-top: 1em">To read the
label on a filesystem, call
<tt>&quot;$g&minus;&gt;vfs_label&quot;</tt>.</p>


<p style="margin-left:11%;">$g&minus;&gt;set_libvirt_requested_credential
($index, $cred);</p>

<p style="margin-left:17%;">After requesting the
<tt>&quot;index&quot;</tt>&rsquo;th credential from the
user, call this function to pass the answer back to
libvirt.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>LIBVIRT AUTHENTICATION&quot;</small> in
<i>guestfs</i>(3) for documentation and example code.</p>


<p style="margin-left:11%;">$g&minus;&gt;set_libvirt_supported_credentials
(\@creds);</p>

<p style="margin-left:17%;">Call this function before
setting an event handler for
<tt>&quot;GUESTFS_EVENT_LIBVIRT_AUTH&quot;</tt>, to supply
the list of credential types that the program knows how to
process.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;creds&quot;</tt> list must be a non-empty list of
strings. Possible strings are: <br>
&quot;username&quot; <br>
&quot;authname&quot; <br>
&quot;language&quot; <br>
&quot;cnonce&quot; <br>
&quot;passphrase&quot; <br>
&quot;echoprompt&quot; <br>
&quot;noechoprompt&quot; <br>
&quot;realm&quot; <br>
&quot;external&quot;</p>

<p style="margin-left:17%; margin-top: 1em">See libvirt
documentation for the meaning of these credential types.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>LIBVIRT AUTHENTICATION&quot;</small> in
<i>guestfs</i>(3) for documentation and example code.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_memsize
($memsize);</p>

<p style="margin-left:17%;">This sets the memory size in
megabytes allocated to the hypervisor. This only has any
effect if called before
<tt>&quot;$g&minus;&gt;launch&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">You can also
change this by setting the environment variable
<tt>&quot;LIBGUESTFS_MEMSIZE&quot;</tt> before the handle is
created.</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on the architecture of libguestfs, see
<i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;set_network
($network);</p>

<p style="margin-left:17%;">If <tt>&quot;network&quot;</tt>
is true, then the network is enabled in the libguestfs
appliance. The default is false.</p>

<p style="margin-left:17%; margin-top: 1em">This affects
whether commands are able to access the network (see &quot;
<small>RUNNING COMMANDS&quot;</small> in
<i>guestfs</i>(3)).</p>

<p style="margin-left:17%; margin-top: 1em">You must call
this before calling
<tt>&quot;$g&minus;&gt;launch&quot;</tt>, otherwise it has
no effect.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_path
($searchpath);</p>

<p style="margin-left:17%;">Set the path that libguestfs
searches for kernel and initrd.img.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
<tt>&quot;$libdir/guestfs&quot;</tt> unless overridden by
setting <tt>&quot;LIBGUESTFS_PATH&quot;</tt> environment
variable.</p>

<p style="margin-left:17%; margin-top: 1em">Setting
<tt>&quot;path&quot;</tt> to <tt>&quot;NULL&quot;</tt>
restores the default path.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_pgroup
($pgroup);</p>

<p style="margin-left:17%;">If <tt>&quot;pgroup&quot;</tt>
is true, child processes are placed into their own process
group.</p>

<p style="margin-left:17%; margin-top: 1em">The practical
upshot of this is that signals like
<tt>&quot;SIGINT&quot;</tt> (from users pressing
<tt>&quot;^C&quot;</tt>) won&rsquo;t be received by the
child process.</p>

<p style="margin-left:17%; margin-top: 1em">The default for
this flag is false, because usually you want
<tt>&quot;^C&quot;</tt> to kill the subprocess. Guestfish
sets this flag to true when used interactively, so that
<tt>&quot;^C&quot;</tt> can cancel long-running commands
gracefully (see
<tt>&quot;$g&minus;&gt;user_cancel&quot;</tt>).</p>

<p style="margin-left:11%;">$g&minus;&gt;set_program
($program);</p>

<p style="margin-left:17%;">Set the program name. This is
an informative string which the main program may optionally
set in the handle.</p>

<p style="margin-left:17%; margin-top: 1em">When the handle
is created, the program name in the handle is set to the
basename from <tt>&quot;argv[0]&quot;</tt>. If that was not
possible, it is set to the empty string (but never
<tt>&quot;NULL&quot;</tt>).</p>

<p style="margin-left:11%;">$g&minus;&gt;set_qemu
($hv);</p>

<p style="margin-left:17%;">Set the hypervisor binary
(usually qemu) that we will use.</p>

<p style="margin-left:17%; margin-top: 1em">The default is
chosen when the library was compiled by the configure
script.</p>

<p style="margin-left:17%; margin-top: 1em">You can also
override this by setting the
<tt>&quot;LIBGUESTFS_HV&quot;</tt> environment variable.</p>

<p style="margin-left:17%; margin-top: 1em">Setting
<tt>&quot;hv&quot;</tt> to <tt>&quot;NULL&quot;</tt>
restores the default qemu binary.</p>

<p style="margin-left:17%; margin-top: 1em">Note that you
should call this function as early as possible after
creating the handle. This is because some pre-launch
operations depend on testing qemu features (by running
<tt>&quot;qemu &minus;help&quot;</tt>). If the qemu binary
changes, we don&rsquo;t retest features, and so you might
see inconsistent results. Using the environment variable
<tt>&quot;LIBGUESTFS_HV&quot;</tt> is safest of all since
that picks the qemu binary at the same time as the handle is
created.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;set_hv&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_recovery_proc
($recoveryproc);</p>

<p style="margin-left:17%;">If this is called with the
parameter <tt>&quot;false&quot;</tt> then
<tt>&quot;$g&minus;&gt;launch&quot;</tt> does not create a
recovery process. The purpose of the recovery process is to
stop runaway hypervisor processes in the case where the main
program aborts abruptly.</p>

<p style="margin-left:17%; margin-top: 1em">This only has
any effect if called before
<tt>&quot;$g&minus;&gt;launch&quot;</tt>, and the default is
true.</p>

<p style="margin-left:17%; margin-top: 1em">About the only
time when you would want to disable this is if the main
process will fork itself into the background
(&quot;daemonize&quot; itself). In this case the recovery
process thinks that the main program has disappeared and so
kills the hypervisor, which is not very helpful.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_selinux
($selinux);</p>

<p style="margin-left:17%;">This sets the selinux flag that
is passed to the appliance at boot time. The default is
<tt>&quot;selinux=0&quot;</tt> (disabled).</p>

<p style="margin-left:17%; margin-top: 1em">Note that if
SELinux is enabled, it is always in Permissive mode
(<tt>&quot;enforcing=0&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">For more
information on the architecture of libguestfs, see
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;selinux_relabel&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_smp
($smp);</p>

<p style="margin-left:17%;">Change the number of virtual
CPUs assigned to the appliance. The default is <tt>1</tt>.
Increasing this may improve performance, though often it has
no effect.</p>

<p style="margin-left:17%; margin-top: 1em">This function
must be called before
<tt>&quot;$g&minus;&gt;launch&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_tmpdir
($tmpdir);</p>

<p style="margin-left:17%;">Set the directory used by the
handle to store temporary files.</p>

<p style="margin-left:17%; margin-top: 1em">The environment
variables <tt>&quot;LIBGUESTFS_TMPDIR&quot;</tt> and
<tt>&quot;TMPDIR&quot;</tt> control the default value: If
<tt>&quot;LIBGUESTFS_TMPDIR&quot;</tt> is set, then that is
the default. Else if <tt>&quot;TMPDIR&quot;</tt> is set,
then that is the default. Else <i>/tmp</i> is the
default.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_trace
($trace);</p>

<p style="margin-left:17%;">If the command trace flag is
set to 1, then libguestfs calls, parameters and return
values are traced.</p>

<p style="margin-left:17%; margin-top: 1em">If you want to
trace C <small>API</small> calls into libguestfs (and other
libraries) then possibly a better way is to use the external
<i>ltrace</i>(1) command.</p>

<p style="margin-left:17%; margin-top: 1em">Command traces
are disabled unless the environment variable
<tt>&quot;LIBGUESTFS_TRACE&quot;</tt> is defined and set to
<tt>1</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Trace messages
are normally sent to <tt>&quot;stderr&quot;</tt>, unless you
register a callback to send them somewhere else (see
<tt>&quot;$g&minus;&gt;set_event_callback&quot;</tt>).</p>

<p style="margin-left:11%;">$g&minus;&gt;set_uuid ($device,
$uuid);</p>

<p style="margin-left:17%;">Set the filesystem
<small>UUID</small> on <tt>&quot;device&quot;</tt> to
<tt>&quot;uuid&quot;</tt>. If this fails and the errno is
<small>ENOTSUP,</small> means that there is no support for
changing the <small>UUID</small> for the type of the
specified filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">Only some
filesystem types support setting UUIDs.</p>

<p style="margin-left:17%; margin-top: 1em">To read the
<small>UUID</small> on a filesystem, call
<tt>&quot;$g&minus;&gt;vfs_uuid&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_uuid_random
($device);</p>

<p style="margin-left:17%;">Set the filesystem
<small>UUID</small> on <tt>&quot;device&quot;</tt> to a
random <small>UUID.</small> If this fails and the errno is
<small>ENOTSUP,</small> means that there is no support for
changing the <small>UUID</small> for the type of the
specified filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">Only some
filesystem types support setting UUIDs.</p>

<p style="margin-left:17%; margin-top: 1em">To read the
<small>UUID</small> on a filesystem, call
<tt>&quot;$g&minus;&gt;vfs_uuid&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;set_verbose
($verbose);</p>

<p style="margin-left:17%;">If <tt>&quot;verbose&quot;</tt>
is true, this turns on verbose messages.</p>

<p style="margin-left:17%; margin-top: 1em">Verbose
messages are disabled unless the environment variable
<tt>&quot;LIBGUESTFS_DEBUG&quot;</tt> is defined and set to
<tt>1</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Verbose
messages are normally sent to <tt>&quot;stderr&quot;</tt>,
unless you register a callback to send them somewhere else
(see
<tt>&quot;$g&minus;&gt;set_event_callback&quot;</tt>).</p>

<p style="margin-left:11%;">$g&minus;&gt;setcon
($context);</p>

<p style="margin-left:17%;">This sets the SELinux security
context of the daemon to the string
<tt>&quot;context&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See the
documentation about <small>SELINUX</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;selinux&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;selinux_relabel&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;setxattr ($xattr,
$val, $vallen, $path);</p>

<p style="margin-left:17%;">This call sets the extended
attribute named <tt>&quot;xattr&quot;</tt> of the file
<tt>&quot;path&quot;</tt> to the value
<tt>&quot;val&quot;</tt> (of length
<tt>&quot;vallen&quot;</tt>). The value is arbitrary 8 bit
data.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;lsetxattr&quot;</tt>,
<i>attr</i>(5).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxxattrs&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;sfdisk ($device,
$cyls, $heads, $sectors, \@lines);</p>

<p style="margin-left:17%;">This is a direct interface to
the <i>sfdisk</i>(8) program for creating partitions on
block devices.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;device&quot;</tt>
should be a block device, for example <i>/dev/sda</i>.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;cyls&quot;</tt>,
<tt>&quot;heads&quot;</tt> and <tt>&quot;sectors&quot;</tt>
are the number of cylinders, heads and sectors on the
device, which are passed directly to sfdisk as the
<i>&minus;C</i>, <i>&minus;H</i> and <i>&minus;S</i>
parameters. If you pass <tt>0</tt> for any of these, then
the corresponding parameter is omitted. Usually for
&rsquo;large&rsquo; disks, you can just pass <tt>0</tt> for
these, but for small (floppy-sized) disks, sfdisk (or
rather, the kernel) cannot work out the right geometry and
you will need to tell it.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;lines&quot;</tt>
is a list of lines that we feed to
<tt>&quot;sfdisk&quot;</tt>. For more information refer to
the <i>sfdisk</i>(8) manpage.</p>

<p style="margin-left:17%; margin-top: 1em">To create a
single partition occupying the whole disk, you would pass
<tt>&quot;lines&quot;</tt> as a single element list, when
the single element being the string <tt>&quot;,&quot;</tt>
(comma).</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;sfdisk_l&quot;</tt>,
<tt>&quot;$g&minus;&gt;sfdisk_N&quot;</tt>,
<tt>&quot;$g&minus;&gt;part_init&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;part_add&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;sfdiskM ($device,
\@lines);</p>

<p style="margin-left:17%;">This is a simplified interface
to the <tt>&quot;$g&minus;&gt;sfdisk&quot;</tt> command,
where partition sizes are specified in megabytes only
(rounded to the nearest cylinder) and you don&rsquo;t need
to specify the cyls, heads and sectors parameters which were
rarely if ever used anyway.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;sfdisk&quot;</tt>, the
<i>sfdisk</i>(8) manpage and
<tt>&quot;$g&minus;&gt;part_disk&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;part_add&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;sfdisk_N ($device,
$partnum, $cyls, $heads, $sectors, $line);</p>

<p style="margin-left:17%;">This runs <i>sfdisk</i>(8)
option to modify just the single partition
<tt>&quot;n&quot;</tt> (note: <tt>&quot;n&quot;</tt> counts
from 1).</p>

<p style="margin-left:17%; margin-top: 1em">For other
parameters, see <tt>&quot;$g&minus;&gt;sfdisk&quot;</tt>.
You should usually pass <tt>0</tt> for the
cyls/heads/sectors parameters.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;part_add&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;part_add&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$partitions =
$g&minus;&gt;sfdisk_disk_geometry ($device);</p>

<p style="margin-left:17%;">This displays the disk geometry
of <tt>&quot;device&quot;</tt> read from the partition
table. Especially in the case where the underlying block
device has been resized, this can be different from the
kernel&rsquo;s idea of the geometry (see
<tt>&quot;$g&minus;&gt;sfdisk_kernel_geometry&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">The result is
in human-readable format, and not designed to be parsed.</p>

<p style="margin-left:11%;">$partitions =
$g&minus;&gt;sfdisk_kernel_geometry ($device);</p>

<p style="margin-left:17%;">This displays the
kernel&rsquo;s idea of the geometry of
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The result is
in human-readable format, and not designed to be parsed.</p>

<p style="margin-left:11%;">$partitions =
$g&minus;&gt;sfdisk_l ($device);</p>

<p style="margin-left:17%;">This displays the partition
table on <tt>&quot;device&quot;</tt>, in the human-readable
output of the <i>sfdisk</i>(8) command. It is not intended
to be parsed.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;part_list&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;part_list&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$output = $g&minus;&gt;sh
($command);</p>

<p style="margin-left:17%;">This call runs a command from
the guest filesystem via the guest&rsquo;s
<i>/bin/sh</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This is like
<tt>&quot;$g&minus;&gt;command&quot;</tt>, but passes the
command to:</p>

<pre style="margin-left:17%; margin-top: 1em"> /bin/sh &minus;c &quot;command&quot;</pre>


<p style="margin-left:17%; margin-top: 1em">Depending on
the guest&rsquo;s shell, this usually results in wildcards
being expanded, shell expressions being interpolated and so
on.</p>

<p style="margin-left:17%; margin-top: 1em">All the
provisos about <tt>&quot;$g&minus;&gt;command&quot;</tt>
apply to this call.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;sh_lines
($command);</p>

<p style="margin-left:17%;">This is the same as
<tt>&quot;$g&minus;&gt;sh&quot;</tt>, but splits the result
into a list of lines.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;command_lines&quot;</tt></p>

<p style="margin-left:11%;">$g&minus;&gt;shutdown ();</p>

<p style="margin-left:17%;">This is the opposite of
<tt>&quot;$g&minus;&gt;launch&quot;</tt>. It performs an
orderly shutdown of the backend process(es). If the autosync
flag is set (which is the default) then the disk image is
synchronized.</p>

<p style="margin-left:17%; margin-top: 1em">If the
subprocess exits with an error then this function will
return an error, which should <i>not</i> be ignored (it may
indicate that the disk image could not be written out
properly).</p>

<p style="margin-left:17%; margin-top: 1em">It is safe to
call this multiple times. Extra calls are ignored.</p>

<p style="margin-left:17%; margin-top: 1em">This call does
<i>not</i> close or free up the handle. You still need to
call <tt>&quot;$g&minus;&gt;close&quot;</tt> afterwards.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;$g&minus;&gt;close&quot;</tt>
will call this if you don&rsquo;t do it explicitly, but note
that any errors are ignored in that case.</p>

<p style="margin-left:11%;">$g&minus;&gt;sleep ($secs);</p>

<p style="margin-left:17%;">Sleep for
<tt>&quot;secs&quot;</tt> seconds.</p>

<p style="margin-left:11%;">%statbuf = $g&minus;&gt;stat
($path);</p>

<p style="margin-left:17%;">Returns file information for
the given <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as the <i>stat</i>(2) system call.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;statns&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">%statbuf = $g&minus;&gt;statns
($path);</p>

<p style="margin-left:17%;">Returns file information for
the given <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as the <i>stat</i>(2) system call.</p>

<p style="margin-left:11%;">%statbuf = $g&minus;&gt;statvfs
($path);</p>

<p style="margin-left:17%;">Returns file system statistics
for any mounted file system. <tt>&quot;path&quot;</tt>
should be a file or directory in the mounted file system
(typically it is the mount point itself, but it
doesn&rsquo;t need to be).</p>

<p style="margin-left:17%; margin-top: 1em">This is the
same as the <i>statvfs</i>(2) system call.</p>

<p style="margin-left:11%;">@stringsout =
$g&minus;&gt;strings ($path);</p>

<p style="margin-left:17%;">This runs the <i>strings</i>(1)
command on a file and returns the list of printable strings
found.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;strings&quot;</tt> command has, in the past, had
problems with parsing untrusted files. These are mitigated
in the current version of libguestfs, but see &quot;
<small>CVE&minus;2014&minus;8484&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">@stringsout =
$g&minus;&gt;strings_e ($encoding, $path);</p>

<p style="margin-left:17%;">This is like the
<tt>&quot;$g&minus;&gt;strings&quot;</tt> command, but
allows you to specify the encoding of strings that are
looked for in the source file <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Allowed
encodings are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>s</p></td>
<td width="5%"></td>
<td width="77%">


<p>Single 7&minus;bit&minus;byte characters like
<small>ASCII</small> and the ASCII-compatible parts of
<small>ISO&minus;8859&minus;X</small> (this is what
<tt>&quot;$g&minus;&gt;strings&quot;</tt> uses).</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>S</p></td>
<td width="5%"></td>
<td width="77%">


<p>Single 8&minus;bit&minus;byte characters.</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>b</p></td>
<td width="5%"></td>
<td width="77%">


<p>16&minus;bit big endian strings such as those encoded in
<small>UTF&minus;16BE</small> or
<small>UCS&minus;2BE.</small></p> </td></tr>
</table>

<p style="margin-left:17%;">l (lower case letter L)</p>

<p style="margin-left:23%;">16&minus;bit little endian such
as <small>UTF&minus;16LE</small> and
<small>UCS&minus;2LE.</small> This is useful for examining
binaries in Windows guests.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>B</p></td>
<td width="5%"></td>
<td width="57%">


<p>32&minus;bit big endian such as
<small>UCS&minus;4BE.</small></p> </td>
<td width="20%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="1%">


<p>L</p></td>
<td width="5%"></td>
<td width="57%">


<p>32&minus;bit little endian such as
<small>UCS&minus;4LE.</small></p> </td>
<td width="20%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">The returned
strings are transcoded to <small>UTF&minus;8.</small></p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>&quot;strings&quot;</tt> command has, in the past, had
problems with parsing untrusted files. These are mitigated
in the current version of libguestfs, but see &quot;
<small>CVE&minus;2014&minus;8484&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;swapoff_device
($device);</p>

<p style="margin-left:17%;">This command disables the
libguestfs appliance swap device or partition named
<tt>&quot;device&quot;</tt>. See
<tt>&quot;$g&minus;&gt;swapon_device&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;swapoff_file
($file);</p>

<p style="margin-left:17%;">This command disables the
libguestfs appliance swap on file.</p>

<p style="margin-left:11%;">$g&minus;&gt;swapoff_label
($label);</p>

<p style="margin-left:17%;">This command disables the
libguestfs appliance swap on labeled swap partition.</p>

<p style="margin-left:11%;">$g&minus;&gt;swapoff_uuid
($uuid);</p>

<p style="margin-left:17%;">This command disables the
libguestfs appliance swap partition with the given
<small>UUID.</small></p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxfsuuid&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;swapon_device
($device);</p>

<p style="margin-left:17%;">This command enables the
libguestfs appliance to use the swap device or partition
named <tt>&quot;device&quot;</tt>. The increased memory is
made available for all commands, for example those run using
<tt>&quot;$g&minus;&gt;command&quot;</tt> or
<tt>&quot;$g&minus;&gt;sh&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that you
should not swap to existing guest swap partitions unless you
know what you are doing. They may contain hibernation
information, or other information that the guest
doesn&rsquo;t want you to trash. You also risk leaking
information about the host to the guest this way. Instead,
attach a new host device to the guest and swap on that.</p>

<p style="margin-left:11%;">$g&minus;&gt;swapon_file
($file);</p>

<p style="margin-left:17%;">This command enables swap to a
file. See <tt>&quot;$g&minus;&gt;swapon_device&quot;</tt>
for other notes.</p>

<p style="margin-left:11%;">$g&minus;&gt;swapon_label
($label);</p>

<p style="margin-left:17%;">This command enables swap to a
labeled swap partition. See
<tt>&quot;$g&minus;&gt;swapon_device&quot;</tt> for other
notes.</p>

<p style="margin-left:11%;">$g&minus;&gt;swapon_uuid
($uuid);</p>

<p style="margin-left:17%;">This command enables swap to a
swap partition with the given <small>UUID.</small> See
<tt>&quot;$g&minus;&gt;swapon_device&quot;</tt> for other
notes.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;linuxfsuuid&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;sync ();</p>

<p style="margin-left:17%;">This syncs the disk, so that
any writes are flushed through to the underlying disk
image.</p>

<p style="margin-left:17%; margin-top: 1em">You should
always call this if you have modified a disk image, before
closing the handle.</p>

<p style="margin-left:11%;">$g&minus;&gt;syslinux ($device
[, directory =&gt; $directory]);</p>

<p style="margin-left:17%;">Install the
<small>SYSLINUX</small> bootloader on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The device
parameter must be either a whole disk formatted as a
<small>FAT</small> filesystem, or a partition formatted as a
<small>FAT</small> filesystem. In the latter case, the
partition should be marked as &quot;active&quot;
(<tt>&quot;$g&minus;&gt;part_set_bootable&quot;</tt>) and a
Master Boot Record must be installed (eg. using
<tt>&quot;$g&minus;&gt;pwrite_device&quot;</tt>) on the
first sector of the whole disk. The <small>SYSLINUX</small>
package comes with some suitable Master Boot Records. See
the <i>syslinux</i>(1) man page for further information.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
arguments are: <i><br>
directory</i></p>

<p style="margin-left:23%;">Install <small>SYSLINUX</small>
in the named subdirectory, instead of in the root directory
of the <small>FAT</small> filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">Additional
configuration can be supplied to <small>SYSLINUX</small> by
placing a file called <i>syslinux.cfg</i> on the
<small>FAT</small> filesystem, either in the root directory,
or under <i>directory</i> if that optional argument is being
used. For further information about the contents of this
file, see <i>syslinux</i>(1).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;extlinux&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;syslinux&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;tail
($path);</p>

<p style="margin-left:17%;">This command returns up to the
last 10 lines of a file as a list of strings.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;tail_n
($nrlines, $path);</p>

<p style="margin-left:17%;">If the parameter
<tt>&quot;nrlines&quot;</tt> is a positive number, this
returns the last <tt>&quot;nrlines&quot;</tt> lines of the
file <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If the
parameter <tt>&quot;nrlines&quot;</tt> is a negative number,
this returns lines from the file <tt>&quot;path&quot;</tt>,
starting with the <tt>&quot;&minus;nrlines&quot;</tt>th
line.</p>

<p style="margin-left:17%; margin-top: 1em">If the
parameter <tt>&quot;nrlines&quot;</tt> is zero, this returns
an empty list.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:11%;">$g&minus;&gt;tar_in ($tarfile,
$directory [, compress =&gt; $compress] [, xattrs =&gt; <br>
$xattrs] [, selinux =&gt; $selinux] [, acls =&gt;
$acls]);</p>

<p style="margin-left:17%;">This command uploads and
unpacks local file <tt>&quot;tarfile&quot;</tt> into
<i>directory</i>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;compress&quot;</tt> flag controls compression. If
not given, then the input should be an uncompressed tar
file. Otherwise one of the following strings may be given to
select the compression type of the input file:
<tt>&quot;compress&quot;</tt>, <tt>&quot;gzip&quot;</tt>,
<tt>&quot;bzip2&quot;</tt>, <tt>&quot;xz&quot;</tt>,
<tt>&quot;lzop&quot;</tt>. (Note that not all builds of
libguestfs will support all of these compression types).</p>

<p style="margin-left:17%; margin-top: 1em">The other
optional arguments are: <br>
&quot;xattrs&quot;</p>

<p style="margin-left:23%;">If set to true, extended
attributes are restored from the tar file.</p>

<p style="margin-left:17%;">&quot;selinux&quot;</p>

<p style="margin-left:23%;">If set to true, SELinux
contexts are restored from the tar file.</p>

<p style="margin-left:17%;">&quot;acls&quot;</p>

<p style="margin-left:23%;">If set to true,
<small>POSIX</small> ACLs are restored from the tar
file.</p>

<p style="margin-left:11%;">$g&minus;&gt;tar_in_opts
($tarfile, $directory [, compress =&gt; $compress] [, <br>
xattrs =&gt; $xattrs] [, selinux =&gt; $selinux] [, acls
=&gt; $acls]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;tar_in&quot;.</p>

<p style="margin-left:11%;">$g&minus;&gt;tar_out
($directory, $tarfile [, compress =&gt; $compress] [, <br>
numericowner =&gt; $numericowner] [, excludes =&gt;
$excludes] [, xattrs =&gt; <br>
$xattrs] [, selinux =&gt; $selinux] [, acls =&gt;
$acls]);</p>

<p style="margin-left:17%;">This command packs the contents
of <i>directory</i> and downloads it to local file
<tt>&quot;tarfile&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
<tt>&quot;compress&quot;</tt> flag controls compression. If
not given, then the output will be an uncompressed tar file.
Otherwise one of the following strings may be given to
select the compression type of the output file:
<tt>&quot;compress&quot;</tt>, <tt>&quot;gzip&quot;</tt>,
<tt>&quot;bzip2&quot;</tt>, <tt>&quot;xz&quot;</tt>,
<tt>&quot;lzop&quot;</tt>. (Note that not all builds of
libguestfs will support all of these compression types).</p>

<p style="margin-left:17%; margin-top: 1em">The other
optional arguments are: <br>
&quot;excludes&quot;</p>

<p style="margin-left:23%;">A list of wildcards. Files are
excluded if they match any of the wildcards.</p>

<p style="margin-left:17%;">&quot;numericowner&quot;</p>

<p style="margin-left:23%;">If set to true, the output tar
file will contain <small>UID/GID</small> numbers instead of
user/group names.</p>

<p style="margin-left:17%;">&quot;xattrs&quot;</p>

<p style="margin-left:23%;">If set to true, extended
attributes are saved in the output tar.</p>

<p style="margin-left:17%;">&quot;selinux&quot;</p>

<p style="margin-left:23%;">If set to true, SELinux
contexts are saved in the output tar.</p>

<p style="margin-left:17%;">&quot;acls&quot;</p>

<p style="margin-left:23%;">If set to true,
<small>POSIX</small> ACLs are saved in the output tar.</p>

<p style="margin-left:11%;">$g&minus;&gt;tar_out_opts
($directory, $tarfile [, compress =&gt; $compress] [, <br>
numericowner =&gt; $numericowner] [, excludes =&gt;
$excludes] [, xattrs =&gt; <br>
$xattrs] [, selinux =&gt; $selinux] [, acls =&gt;
$acls]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;tar_out&quot;.</p>

<p style="margin-left:11%;">$g&minus;&gt;tgz_in ($tarball,
$directory);</p>

<p style="margin-left:17%;">This command uploads and
unpacks local file <tt>&quot;tarball&quot;</tt> (a <i>gzip
compressed</i> tar file) into <i>directory</i>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;tar_in&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;tgz_out
($directory, $tarball);</p>

<p style="margin-left:17%;">This command packs the contents
of <i>directory</i> and downloads it to local file
<tt>&quot;tarball&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;tar_out&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;touch ($path);</p>

<p style="margin-left:17%;">Touch acts like the
<i>touch</i>(1) command. It can be used to update the
timestamps on a file, or, if the file does not exist, to
create a new zero-length file.</p>

<p style="margin-left:17%; margin-top: 1em">This command
only works on regular files, and will fail on other file
types such as directories, symbolic links, block special
etc.</p>

<p style="margin-left:11%;">$g&minus;&gt;truncate
($path);</p>

<p style="margin-left:17%;">This command truncates
<tt>&quot;path&quot;</tt> to a zero-length file. The file
must exist already.</p>

<p style="margin-left:11%;">$g&minus;&gt;truncate_size
($path, $size);</p>

<p style="margin-left:17%;">This command truncates
<tt>&quot;path&quot;</tt> to size <tt>&quot;size&quot;</tt>
bytes. The file must exist already.</p>

<p style="margin-left:17%; margin-top: 1em">If the current
file size is less than <tt>&quot;size&quot;</tt> then the
file is extended to the required size with zero bytes. This
creates a sparse file (ie. disk blocks are not allocated for
the file until you write to it). To create a non-sparse file
of zeroes, use <tt>&quot;$g&minus;&gt;fallocate64&quot;</tt>
instead.</p>

<p style="margin-left:11%;">$g&minus;&gt;tune2fs ($device
[, force =&gt; $force] [, maxmountcount =&gt; <br>
$maxmountcount] [, mountcount =&gt; $mountcount] [,
errorbehavior =&gt; <br>
$errorbehavior] [, group =&gt; $group] [,
intervalbetweenchecks =&gt; <br>
$intervalbetweenchecks] [, reservedblockspercentage =&gt;
<br>
$reservedblockspercentage] [, lastmounteddirectory =&gt;
<br>
$lastmounteddirectory] [, reservedblockscount =&gt;
$reservedblockscount] <br>
[, user =&gt; $user]);</p>

<p style="margin-left:17%;">This call allows you to adjust
various filesystem parameters of an ext2/ext3/ext4
filesystem called <tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The optional
parameters are: <br>
&quot;force&quot;</p>

<p style="margin-left:23%;">Force tune2fs to complete the
operation even in the face of errors. This is the same as
the tune2fs <tt>&quot;&minus;f&quot;</tt> option.</p>

<p style="margin-left:17%;">&quot;maxmountcount&quot;</p>

<p style="margin-left:23%;">Set the number of mounts after
which the filesystem is checked by <i>e2fsck</i>(8). If this
is <tt>0</tt> then the number of mounts is disregarded. This
is the same as the tune2fs <tt>&quot;&minus;c&quot;</tt>
option.</p>

<p style="margin-left:17%;">&quot;mountcount&quot;</p>

<p style="margin-left:23%;">Set the number of times the
filesystem has been mounted. This is the same as the tune2fs
<tt>&quot;&minus;C&quot;</tt> option.</p>

<p style="margin-left:17%;">&quot;errorbehavior&quot;</p>

<p style="margin-left:23%;">Change the behavior of the
kernel code when errors are detected. Possible values
currently are: <tt>&quot;continue&quot;</tt>,
<tt>&quot;remount&minus;ro&quot;</tt>,
<tt>&quot;panic&quot;</tt>. In practice these options
don&rsquo;t really make any difference, particularly for
write errors.</p>

<p style="margin-left:23%; margin-top: 1em">This is the
same as the tune2fs <tt>&quot;&minus;e&quot;</tt>
option.</p>

<p style="margin-left:17%;">&quot;group&quot;</p>

<p style="margin-left:23%;">Set the group which can use
reserved filesystem blocks. This is the same as the tune2fs
<tt>&quot;&minus;g&quot;</tt> option except that it can only
be specified as a number.</p>


<p style="margin-left:17%;">&quot;intervalbetweenchecks&quot;</p>

<p style="margin-left:23%;">Adjust the maximal time between
two filesystem checks (in seconds). If the option is passed
as <tt>0</tt> then time-dependent checking is disabled.</p>

<p style="margin-left:23%; margin-top: 1em">This is the
same as the tune2fs <tt>&quot;&minus;i&quot;</tt>
option.</p>


<p style="margin-left:17%;">&quot;reservedblockspercentage&quot;</p>

<p style="margin-left:23%;">Set the percentage of the
filesystem which may only be allocated by privileged
processes. This is the same as the tune2fs
<tt>&quot;&minus;m&quot;</tt> option.</p>


<p style="margin-left:17%;">&quot;lastmounteddirectory&quot;</p>

<p style="margin-left:23%;">Set the last mounted directory.
This is the same as the tune2fs
<tt>&quot;&minus;M&quot;</tt> option.</p>


<p style="margin-left:17%;">&quot;reservedblockscount&quot;
Set the number of reserved filesystem blocks. <br>
This is the same as the tune2fs &quot;&minus;r&quot; option.
<br>
&quot;user&quot;</p>

<p style="margin-left:23%;">Set the user who can use the
reserved filesystem blocks. This is the same as the tune2fs
<tt>&quot;&minus;u&quot;</tt> option except that it can only
be specified as a number.</p>

<p style="margin-left:17%; margin-top: 1em">To get the
current values of filesystem parameters, see
<tt>&quot;$g&minus;&gt;tune2fs_l&quot;</tt>. For precise
details of how tune2fs works, see the <i>tune2fs</i>(8) man
page.</p>

<p style="margin-left:11%;">%superblock =
$g&minus;&gt;tune2fs_l ($device);</p>

<p style="margin-left:17%;">This returns the contents of
the ext2, ext3 or ext4 filesystem superblock on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">It is the same
as running <tt>&quot;tune2fs &minus;l device&quot;</tt>. See
<i>tune2fs</i>(8) manpage for more details. The list of
fields returned isn&rsquo;t clearly defined, and depends on
both the version of <tt>&quot;tune2fs&quot;</tt> that
libguestfs was built against, and the filesystem itself.</p>

<p style="margin-left:11%;">$g&minus;&gt;txz_in ($tarball,
$directory);</p>

<p style="margin-left:17%;">This command uploads and
unpacks local file <tt>&quot;tarball&quot;</tt> (an <i>xz
compressed</i> tar file) into <i>directory</i>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;xz&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;tar_in&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;txz_out
($directory, $tarball);</p>

<p style="margin-left:17%;">This command packs the contents
of <i>directory</i> and downloads it to local file
<tt>&quot;tarball&quot;</tt> (as an xz compressed tar
archive).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;xz&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;tar_out&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$oldmask = $g&minus;&gt;umask
($mask);</p>

<p style="margin-left:17%;">This function sets the mask
used for creating new files and device nodes to
<tt>&quot;mask &amp; 0777&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Typical umask
values would be <tt>022</tt> which creates new files with
permissions like
&quot;&minus;rw&minus;r--r&minus;&minus;&quot; or
&quot;&minus;rwxr&minus;xr&minus;x&quot;, and <tt>002</tt>
which creates new files with permissions like
&quot;&minus;rw&minus;rw&minus;r&minus;&minus;&quot; or
&quot;&minus;rwxrwxr&minus;x&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">The default
umask is <tt>022</tt>. This is important because it means
that directories and device nodes will be created with
<tt>0644</tt> or <tt>0755</tt> mode even if you specify
<tt>0777</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;get_umask&quot;</tt>,
<i>umask</i>(2), <tt>&quot;$g&minus;&gt;mknod&quot;</tt>,
<tt>&quot;$g&minus;&gt;mkdir&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This call
returns the previous umask.</p>

<p style="margin-left:11%;">$g&minus;&gt;umount
($pathordevice [, force =&gt; $force] [, lazyunmount =&gt;
<br>
$lazyunmount]);</p>

<p style="margin-left:17%;">This unmounts the given
filesystem. The filesystem may be specified either by its
mountpoint (path) or the device which contains the
filesystem.</p>

<p style="margin-left:11%;">$g&minus;&gt;umount_opts
($pathordevice [, force =&gt; $force] [, lazyunmount =&gt;
<br>
$lazyunmount]);</p>

<p style="margin-left:17%;">This is an alias of
&quot;umount&quot;.</p>

<p style="margin-left:11%;">$g&minus;&gt;umount_all ();</p>

<p style="margin-left:17%;">This unmounts all mounted
filesystems.</p>

<p style="margin-left:17%; margin-top: 1em">Some internal
mounts are not unmounted by this call.</p>

<p style="margin-left:11%;">$g&minus;&gt;umount_local
([retry =&gt; $retry]);</p>

<p style="margin-left:17%;">If libguestfs is exporting the
filesystem on a local mountpoint, then this unmounts it.</p>

<p style="margin-left:17%; margin-top: 1em">See &quot;
<small>MOUNT LOCAL&quot;</small> in <i>guestfs</i>(3) for
full documentation.</p>

<p style="margin-left:11%;">$g&minus;&gt;upload ($filename,
$remotefilename);</p>

<p style="margin-left:17%;">Upload local file
<i>filename</i> to <i>remotefilename</i> on the
filesystem.</p>


<p style="margin-left:17%; margin-top: 1em"><i>filename</i>
can also be a named pipe.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;download&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;upload_offset
($filename, $remotefilename, $offset);</p>

<p style="margin-left:17%;">Upload local file
<i>filename</i> to <i>remotefilename</i> on the
filesystem.</p>


<p style="margin-left:17%; margin-top: 1em"><i>remotefilename</i>
is overwritten starting at the byte
<tt>&quot;offset&quot;</tt> specified. The intention is to
overwrite parts of existing files or devices, although if a
non-existent file is specified then it is created with a
&quot;hole&quot; before <tt>&quot;offset&quot;</tt>. The
size of the data written is implicit in the size of the
source <i>filename</i>.</p>

<p style="margin-left:17%; margin-top: 1em">Note that there
is no limit on the amount of data that can be uploaded with
this call, unlike with
<tt>&quot;$g&minus;&gt;pwrite&quot;</tt>, and this call
always writes the full amount unless an error occurs.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;upload&quot;</tt>,
<tt>&quot;$g&minus;&gt;pwrite&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;user_cancel
();</p>

<p style="margin-left:17%;">This function cancels the
current upload or download operation.</p>

<p style="margin-left:17%; margin-top: 1em">Unlike most
other libguestfs calls, this function is signal safe and
thread safe. You can call it from a signal handler or from
another thread, without needing to do any locking.</p>

<p style="margin-left:17%; margin-top: 1em">The transfer
that was in progress (if there is one) will stop shortly
afterwards, and will return an error. The errno (see
&quot;guestfs_last_errno&quot;) is set to
<tt>&quot;EINTR&quot;</tt>, so you can test for this to find
out if the operation was cancelled or failed because of
another error.</p>

<p style="margin-left:17%; margin-top: 1em">No cleanup is
performed: for example, if a file was being uploaded then
after cancellation there may be a partially uploaded file.
It is the caller&rsquo;s responsibility to clean up if
necessary.</p>

<p style="margin-left:17%; margin-top: 1em">There are two
common places that you might call
<tt>&quot;$g&minus;&gt;user_cancel&quot;</tt>:</p>

<p style="margin-left:17%; margin-top: 1em">In an
interactive text-based program, you might call it from a
<tt>&quot;SIGINT&quot;</tt> signal handler so that pressing
<tt>&quot;^C&quot;</tt> cancels the current operation. (You
also need to call &quot;guestfs_set_pgroup&quot; so that
child processes don&rsquo;t receive the
<tt>&quot;^C&quot;</tt> signal).</p>

<p style="margin-left:17%; margin-top: 1em">In a graphical
program, when the main thread is displaying a progress bar
with a cancel button, wire up the cancel button to call this
function.</p>

<p style="margin-left:11%;">$g&minus;&gt;utimens ($path,
$atsecs, $atnsecs, $mtsecs, $mtnsecs);</p>

<p style="margin-left:17%;">This command sets the
timestamps of a file with nanosecond precision.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;atsecs,
atnsecs&quot;</tt> are the last access time (atime) in secs
and nanoseconds from the epoch.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;mtsecs,
mtnsecs&quot;</tt> are the last modification time (mtime) in
secs and nanoseconds from the epoch.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<tt>*nsecs</tt> field contains the special value
<tt>&quot;&minus;1&quot;</tt> then the corresponding
timestamp is set to the current time. (The <tt>*secs</tt>
field is ignored in this case).</p>

<p style="margin-left:17%; margin-top: 1em">If the
<tt>*nsecs</tt> field contains the special value
<tt>&quot;&minus;2&quot;</tt> then the corresponding
timestamp is left unchanged. (The <tt>*secs</tt> field is
ignored in this case).</p>

<p style="margin-left:11%;">%uts = $g&minus;&gt;utsname
();</p>

<p style="margin-left:17%;">This returns the kernel version
of the appliance, where this is available. This information
is only useful for debugging. Nothing in the returned
structure is defined by the <small>API.</small></p>

<p style="margin-left:11%;">%version = $g&minus;&gt;version
();</p>

<p style="margin-left:17%;">Return the libguestfs version
number that the program is linked against.</p>

<p style="margin-left:17%; margin-top: 1em">Note that
because of dynamic linking this is not necessarily the
version of libguestfs that you compiled against. You can
compile the program, and then at runtime dynamically link
against a completely different <i>libguestfs.so</i>
library.</p>

<p style="margin-left:17%; margin-top: 1em">This call was
added in version <tt>1.0.58</tt>. In previous versions of
libguestfs there was no way to get the version number. From
C code you can use dynamic linker functions to find out if
this symbol exists (if it doesn&rsquo;t, then it&rsquo;s an
earlier version).</p>

<p style="margin-left:17%; margin-top: 1em">The call
returns a structure with four elements. The first three
(<tt>&quot;major&quot;</tt>, <tt>&quot;minor&quot;</tt> and
<tt>&quot;release&quot;</tt>) are numbers and correspond to
the usual version triplet. The fourth element
(<tt>&quot;extra&quot;</tt>) is a string and is normally
empty, but may be used for distro-specific information.</p>

<p style="margin-left:17%; margin-top: 1em">To construct
the original version string:
<tt>&quot;$major.$minor.$release$extra&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em">See also:
&quot; <small>LIBGUESTFS VERSION NUMBERS&quot;</small> in
<i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>Note:</i>
Don&rsquo;t use this call to test for availability of
features. In enterprise distributions we backport features
from later versions into earlier versions, making this an
unreliable way to test for features. Use
<tt>&quot;$g&minus;&gt;available&quot;</tt> or
<tt>&quot;$g&minus;&gt;feature_available&quot;</tt>
instead.</p>

<p style="margin-left:11%;">$label = $g&minus;&gt;vfs_label
($mountable);</p>

<p style="margin-left:17%;">This returns the label of the
filesystem on <tt>&quot;mountable&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If the
filesystem is unlabeled, this returns the empty string.</p>

<p style="margin-left:17%; margin-top: 1em">To find a
filesystem from the label, use
<tt>&quot;$g&minus;&gt;findfs_label&quot;</tt>.</p>

<p style="margin-left:11%;">$sizeinbytes =
$g&minus;&gt;vfs_minimum_size ($mountable);</p>

<p style="margin-left:17%;">Get the minimum size of
filesystem in bytes. This is the minimum possible size for
filesystem shrinking.</p>

<p style="margin-left:17%; margin-top: 1em">If getting
minimum size of specified filesystem is not supported, this
will fail and set errno as <small>ENOTSUP.</small></p>

<p style="margin-left:17%; margin-top: 1em">See also
<i>ntfsresize</i>(8), <i>resize2fs</i>(8), <i>btrfs</i>(8),
<i>xfs_info</i>(8).</p>

<p style="margin-left:11%;">$fstype = $g&minus;&gt;vfs_type
($mountable);</p>

<p style="margin-left:17%;">This command gets the
filesystem type corresponding to the filesystem on
<tt>&quot;mountable&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">For most
filesystems, the result is the name of the Linux
<small>VFS</small> module which would be used to mount this
filesystem if you mounted it without specifying the
filesystem type. For example a string such as
<tt>&quot;ext3&quot;</tt> or <tt>&quot;ntfs&quot;</tt>.</p>

<p style="margin-left:11%;">$uuid = $g&minus;&gt;vfs_uuid
($mountable);</p>

<p style="margin-left:17%;">This returns the filesystem
<small>UUID</small> of the filesystem on
<tt>&quot;mountable&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">If the
filesystem does not have a <small>UUID,</small> this returns
the empty string.</p>

<p style="margin-left:17%; margin-top: 1em">To find a
filesystem from the <small>UUID,</small> use
<tt>&quot;$g&minus;&gt;findfs_uuid&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vg_activate
($activate, \@volgroups);</p>

<p style="margin-left:17%;">This command activates or (if
<tt>&quot;activate&quot;</tt> is false) deactivates all
logical volumes in the listed volume groups
<tt>&quot;volgroups&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This command is
the same as running <tt>&quot;vgchange &minus;a y|n
volgroups...&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em">Note that if
<tt>&quot;volgroups&quot;</tt> is an empty list then
<b>all</b> volume groups are activated or deactivated.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vg_activate_all
($activate);</p>

<p style="margin-left:17%;">This command activates or (if
<tt>&quot;activate&quot;</tt> is false) deactivates all
logical volumes in all volume groups.</p>

<p style="margin-left:17%; margin-top: 1em">This command is
the same as running <tt>&quot;vgchange &minus;a
y|n&quot;</tt></p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vgchange_uuid
($vg);</p>

<p style="margin-left:17%;">Generate a new random
<small>UUID</small> for the volume group
<tt>&quot;vg&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vgchange_uuid_all
();</p>

<p style="margin-left:17%;">Generate new random UUIDs for
all volume groups.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vgcreate
($volgroup, \@physvols);</p>

<p style="margin-left:17%;">This creates an
<small>LVM</small> volume group called
<tt>&quot;volgroup&quot;</tt> from the non-empty list of
physical volumes <tt>&quot;physvols&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@uuids = $g&minus;&gt;vglvuuids
($vgname);</p>

<p style="margin-left:17%;">Given a <small>VG</small>
called <tt>&quot;vgname&quot;</tt>, this returns the UUIDs
of all the logical volumes created in this volume group.</p>

<p style="margin-left:17%; margin-top: 1em">You can use
this along with <tt>&quot;$g&minus;&gt;lvs&quot;</tt> and
<tt>&quot;$g&minus;&gt;lvuuid&quot;</tt> calls to associate
logical volumes and volume groups.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;vgpvuuids&quot;</tt>.</p>

<p style="margin-left:11%;">$metadata = $g&minus;&gt;vgmeta
($vgname);</p>

<p style="margin-left:17%;"><tt>&quot;vgname&quot;</tt> is
an <small>LVM</small> volume group. This command examines
the volume group and returns its metadata.</p>

<p style="margin-left:17%; margin-top: 1em">Note that the
metadata is an internal structure used by
<small>LVM,</small> subject to change at any time, and is
provided for information only.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@uuids = $g&minus;&gt;vgpvuuids
($vgname);</p>

<p style="margin-left:17%;">Given a <small>VG</small>
called <tt>&quot;vgname&quot;</tt>, this returns the UUIDs
of all the physical volumes that this volume group resides
on.</p>

<p style="margin-left:17%; margin-top: 1em">You can use
this along with <tt>&quot;$g&minus;&gt;pvs&quot;</tt> and
<tt>&quot;$g&minus;&gt;pvuuid&quot;</tt> calls to associate
physical volumes and volume groups.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;vglvuuids&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vgremove
($vgname);</p>

<p style="margin-left:17%;">Remove an <small>LVM</small>
volume group <tt>&quot;vgname&quot;</tt>, (for example
<tt>&quot;VG&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">This also
forcibly removes all logical volumes in the volume group (if
any).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vgrename
($volgroup, $newvolgroup);</p>

<p style="margin-left:17%;">Rename a volume group
<tt>&quot;volgroup&quot;</tt> with the new name
<tt>&quot;newvolgroup&quot;</tt>.</p>

<p style="margin-left:11%;">@volgroups = $g&minus;&gt;vgs
();</p>

<p style="margin-left:17%;">List all the volumes groups
detected. This is the equivalent of the <i>vgs</i>(8)
command.</p>

<p style="margin-left:17%; margin-top: 1em">This returns a
list of just the volume group names that were detected (eg.
<tt>&quot;VolGroup00&quot;</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;vgs_full&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@volgroups =
$g&minus;&gt;vgs_full ();</p>

<p style="margin-left:17%;">List all the volumes groups
detected. This is the equivalent of the <i>vgs</i>(8)
command. The &quot;full&quot; version includes all
fields.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;lvm2&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;vgscan ();</p>

<p style="margin-left:17%;">This rescans all block devices
and rebuilds the list of <small>LVM</small> physical
volumes, volume groups and logical volumes.</p>

<p style="margin-left:11%;">$uuid = $g&minus;&gt;vguuid
($vgname);</p>

<p style="margin-left:17%;">This command returns the
<small>UUID</small> of the <small>LVM VG</small> named
<tt>&quot;vgname&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;wait_ready ();</p>

<p style="margin-left:17%;">This function is a no op.</p>

<p style="margin-left:17%; margin-top: 1em">In versions of
the <small>API</small> &lt; 1.0.71 you had to call this
function just after calling
<tt>&quot;$g&minus;&gt;launch&quot;</tt> to wait for the
launch to complete. However this is no longer necessary
because <tt>&quot;$g&minus;&gt;launch&quot;</tt> now does
the waiting.</p>

<p style="margin-left:17%; margin-top: 1em">If you see any
calls to this function in code then you can just remove
them, unless you want to retain compatibility with older
versions of the <small>API.</small></p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;launch&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$chars = $g&minus;&gt;wc_c
($path);</p>

<p style="margin-left:17%;">This command counts the
characters in a file, using the <tt>&quot;wc
&minus;c&quot;</tt> external command.</p>

<p style="margin-left:11%;">$lines = $g&minus;&gt;wc_l
($path);</p>

<p style="margin-left:17%;">This command counts the lines
in a file, using the <tt>&quot;wc &minus;l&quot;</tt>
external command.</p>

<p style="margin-left:11%;">$words = $g&minus;&gt;wc_w
($path);</p>

<p style="margin-left:17%;">This command counts the words
in a file, using the <tt>&quot;wc &minus;w&quot;</tt>
external command.</p>

<p style="margin-left:11%;">$g&minus;&gt;wipefs
($device);</p>

<p style="margin-left:17%;">This command erases filesystem
or <small>RAID</small> signatures from the specified
<tt>&quot;device&quot;</tt> to make the filesystem invisible
to libblkid.</p>

<p style="margin-left:17%; margin-top: 1em">This does not
erase the filesystem itself nor any other data from the
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Compare with
<tt>&quot;$g&minus;&gt;zero&quot;</tt> which zeroes the
first few blocks of a device.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;wipefs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;write ($path,
$content);</p>

<p style="margin-left:17%;">This call creates a file called
<tt>&quot;path&quot;</tt>. The content of the file is the
string <tt>&quot;content&quot;</tt> (which can contain any 8
bit data).</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;write_append&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;write_append
($path, $content);</p>

<p style="margin-left:17%;">This call appends
<tt>&quot;content&quot;</tt> to the end of file
<tt>&quot;path&quot;</tt>. If <tt>&quot;path&quot;</tt> does
not exist, then a new file is created.</p>

<p style="margin-left:17%; margin-top: 1em">See also
<tt>&quot;$g&minus;&gt;write&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;write_file ($path,
$content, $size);</p>

<p style="margin-left:17%;">This call creates a file called
<tt>&quot;path&quot;</tt>. The contents of the file is the
string <tt>&quot;content&quot;</tt> (which can contain any 8
bit data), with length <tt>&quot;size&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">As a special
case, if <tt>&quot;size&quot;</tt> is <tt>0</tt> then the
length is calculated using <tt>&quot;strlen&quot;</tt> (so
in this case the content cannot contain embedded
<small>ASCII</small> NULs).</p>


<p style="margin-left:17%; margin-top: 1em"><i><small>NB.</small></i>
Owing to a bug, writing content containing <small>ASCII
NUL</small> characters does <i>not</i> work, even if the
length is specified.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;write&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;xfs_admin ($device
[, extunwritten =&gt; $extunwritten] [, imgfile =&gt; <br>
$imgfile] [, v2log =&gt; $v2log] [, projid32bit =&gt;
$projid32bit] [, <br>
lazycounter =&gt; $lazycounter] [, label =&gt; $label] [,
uuid =&gt; $uuid]);</p>

<p style="margin-left:17%;">Change the parameters of the
<small>XFS</small> filesystem on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Devices that
are mounted cannot be modified. Administrators must unmount
filesystems before this call can modify parameters.</p>

<p style="margin-left:17%; margin-top: 1em">Some of the
parameters of a mounted filesystem can be examined and
modified using the
<tt>&quot;$g&minus;&gt;xfs_info&quot;</tt> and
<tt>&quot;$g&minus;&gt;xfs_growfs&quot;</tt> calls.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;xfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$g&minus;&gt;xfs_growfs ($path
[, datasec =&gt; $datasec] [, logsec =&gt; $logsec] [, <br>
rtsec =&gt; $rtsec] [, datasize =&gt; $datasize] [, logsize
=&gt; $logsize] [, <br>
rtsize =&gt; $rtsize] [, rtextsize =&gt; $rtextsize] [,
maxpct =&gt; $maxpct]);</p>

<p style="margin-left:17%;">Grow the <small>XFS</small>
filesystem mounted at <tt>&quot;path&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The returned
struct contains geometry information. Missing fields are
returned as <tt>&quot;&minus;1&quot;</tt> (for numeric
fields) or empty string.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;xfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">%info = $g&minus;&gt;xfs_info
($pathordevice);</p>


<p style="margin-left:17%;"><tt>&quot;pathordevice&quot;</tt>
is a mounted <small>XFS</small> filesystem or a device
containing an <small>XFS</small> filesystem. This command
returns the geometry of the filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">The returned
struct contains geometry information. Missing fields are
returned as <tt>&quot;&minus;1&quot;</tt> (for numeric
fields) or empty string.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;xfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">$status =
$g&minus;&gt;xfs_repair ($device [, forcelogzero =&gt;
$forcelogzero] [, <br>
nomodify =&gt; $nomodify] [, noprefetch =&gt; $noprefetch]
[, forcegeometry <br>
=&gt; $forcegeometry] [, maxmem =&gt; $maxmem] [, ihashsize
=&gt; $ihashsize] [, <br>
bhashsize =&gt; $bhashsize] [, agstride =&gt; $agstride] [,
logdev =&gt; <br>
$logdev] [, rtdev =&gt; $rtdev]);</p>

<p style="margin-left:17%;">Repair corrupt or damaged
<small>XFS</small> filesystem on
<tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">The filesystem
is specified using the <tt>&quot;device&quot;</tt> argument
which should be the device name of the disk partition or
volume containing the filesystem. If given the name of a
block device, <tt>&quot;xfs_repair&quot;</tt> will attempt
to find the raw device associated with the specified block
device and will use the raw device instead.</p>

<p style="margin-left:17%; margin-top: 1em">Regardless, the
filesystem to be repaired must be unmounted, otherwise, the
resulting filesystem may be inconsistent or corrupt.</p>

<p style="margin-left:17%; margin-top: 1em">The returned
status indicates whether filesystem corruption was detected
(returns <tt>1</tt>) or was not detected (returns
<tt>0</tt>).</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;xfs&quot;</tt>. See also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;zegrep
($regex, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;zegrep&quot;</tt> program and returns the matching
lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;zegrepi
($regex, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;zegrep &minus;i&quot;</tt> program and returns the
matching lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$g&minus;&gt;zero
($device);</p>

<p style="margin-left:17%;">This command writes zeroes over
the first few blocks of <tt>&quot;device&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">How many blocks
are zeroed isn&rsquo;t specified (but it&rsquo;s <i>not</i>
enough to securely wipe the device). It should be sufficient
to remove any partition tables, filesystem superblocks and
so on.</p>

<p style="margin-left:17%; margin-top: 1em">If blocks are
already zero, then this command avoids writing zeroes. This
prevents the underlying device from becoming non-sparse or
growing unnecessarily.</p>

<p style="margin-left:17%; margin-top: 1em">See also:
<tt>&quot;$g&minus;&gt;zero_device&quot;</tt>,
<tt>&quot;$g&minus;&gt;scrub_device&quot;</tt>,
<tt>&quot;$g&minus;&gt;is_zero_device&quot;</tt></p>

<p style="margin-left:11%;">$g&minus;&gt;zero_device
($device);</p>

<p style="margin-left:17%;">This command writes zeroes over
the entire <tt>&quot;device&quot;</tt>. Compare with
<tt>&quot;$g&minus;&gt;zero&quot;</tt> which just zeroes the
first few blocks of a device.</p>

<p style="margin-left:17%; margin-top: 1em">If blocks are
already zero, then this command avoids writing zeroes. This
prevents the underlying device from becoming non-sparse or
growing unnecessarily.</p>

<p style="margin-left:11%;">$g&minus;&gt;zero_free_space
($directory);</p>

<p style="margin-left:17%;">Zero the free space in the
filesystem mounted on <i>directory</i>. The filesystem must
be mounted read-write.</p>

<p style="margin-left:17%; margin-top: 1em">The filesystem
contents are not affected, but any free space in the
filesystem is freed.</p>

<p style="margin-left:17%; margin-top: 1em">Free space is
not &quot;trimmed&quot;. You may want to call
<tt>&quot;$g&minus;&gt;fstrim&quot;</tt> either as an
alternative to this, or after calling this, depending on
your requirements.</p>

<p style="margin-left:11%;">$g&minus;&gt;zerofree
($device);</p>

<p style="margin-left:17%;">This runs the <i>zerofree</i>
program on <tt>&quot;device&quot;</tt>. This program claims
to zero unused inodes and disk blocks on an ext2/3
filesystem, thus making it possible to compress the
filesystem more effectively.</p>

<p style="margin-left:17%; margin-top: 1em">You should
<b>not</b> run this program if the filesystem is
mounted.</p>

<p style="margin-left:17%; margin-top: 1em">It is possible
that using this program can damage the filesystem or data on
the filesystem.</p>

<p style="margin-left:17%; margin-top: 1em">This function
depends on the feature <tt>&quot;zerofree&quot;</tt>. See
also
<tt>&quot;$g&minus;&gt;feature&minus;available&quot;</tt>.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;zfgrep
($pattern, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;zfgrep&quot;</tt> program and returns the matching
lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;zfgrepi
($pattern, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;zfgrep &minus;i&quot;</tt> program and returns the
matching lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">$description =
$g&minus;&gt;zfile ($meth, $path);</p>

<p style="margin-left:17%;">This command runs <i>file</i>
after first decompressing <tt>&quot;path&quot;</tt> using
<tt>&quot;method&quot;</tt>.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>&quot;method&quot;</tt>
must be one of <tt>&quot;gzip&quot;</tt>,
<tt>&quot;compress&quot;</tt> or
<tt>&quot;bzip2&quot;</tt>.</p>

<p style="margin-left:17%; margin-top: 1em">Since 1.0.63,
use <tt>&quot;$g&minus;&gt;file&quot;</tt> instead which can
now process compressed files.</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;file&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;zgrep
($regex, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;zgrep&quot;</tt> program and returns the matching
lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<p style="margin-left:11%;">@lines = $g&minus;&gt;zgrepi
($regex, $path);</p>

<p style="margin-left:17%;">This calls the external
<tt>&quot;zgrep &minus;i&quot;</tt> program and returns the
matching lines.</p>

<p style="margin-left:17%; margin-top: 1em">Because of the
message protocol, there is a transfer limit of somewhere
between 2MB and 4MB. See &quot; <small>PROTOCOL
LIMITS&quot;</small> in <i>guestfs</i>(3).</p>

<p style="margin-left:17%; margin-top: 1em"><i>This
function is deprecated.</i> In new code, use the
&quot;grep&quot; call instead.</p>

<p style="margin-left:17%; margin-top: 1em">Deprecated
functions will not be removed from the <small>API,</small>
but the fact that they are deprecated indicates that there
are problems with correct use of these functions.</p>

<h2>AVAILABILITY
<a name="AVAILABILITY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">From time to
time we add new libguestfs APIs. Also some libguestfs APIs
won&rsquo;t be available in all builds of libguestfs (the
Fedora build is full-featured, but other builds may disable
features). How do you test whether the APIs that your Perl
program needs are available in the version of
<tt>&quot;Sys::Guestfs&quot;</tt> that you are using?</p>

<p style="margin-left:11%; margin-top: 1em">To test if a
particular function is available in the
<tt>&quot;Sys::Guestfs&quot;</tt> class, use the ordinary
Perl <small>UNIVERSAL</small> method
<tt>&quot;can(METHOD)&quot;</tt> (see <i>perlobj</i>(1)).
For example:</p>

<pre style="margin-left:11%; margin-top: 1em"> use Sys::Guestfs;
 if (defined (Sys::Guestfs&minus;&gt;can (&quot;set_verbose&quot;))) {
   print &quot;\$g&minus;&gt;set_verbose is available\n&quot;;
 }</pre>


<p style="margin-left:11%; margin-top: 1em">Perl does not
offer a way to list the arguments of a method, and from time
to time we may add extra arguments to calls that take
optional arguments. For this reason, we provide a global
hash variable <tt>%guestfs_introspection</tt> which contains
the arguments and their types for each libguestfs method.
The keys of this hash are the method names, and the values
are an hashref containing useful introspection information
about the method (further fields may be added to this in
future).</p>

<pre style="margin-left:11%; margin-top: 1em"> use Sys::Guestfs;
 $Sys::Guestfs::guestfs_introspection{mkfs}
 =&gt; {
    ret =&gt; 'void',                    # return type
    args =&gt; [                         # required arguments
      [ 'fstype', 'string', 0 ],
      [ 'device', 'string(device)', 1 ],
    ],
    optargs =&gt; {                      # optional arguments
      blocksize =&gt; [ 'blocksize', 'int', 0 ],
      features =&gt; [ 'features', 'string', 1 ],
      inode =&gt; [ 'inode', 'int', 2 ],
      sectorsize =&gt; [ 'sectorsize', 'int', 3 ],
    },
    name =&gt; &quot;mkfs&quot;,
    description =&gt; &quot;make a filesystem&quot;,
  }</pre>


<p style="margin-left:11%; margin-top: 1em">To test if
particular features are supported by the current build, use
the &quot;feature_available&quot; method like the example
below. Note that the appliance must be launched first.</p>

<pre style="margin-left:11%; margin-top: 1em"> $g&minus;&gt;feature_available ( [&quot;augeas&quot;] );</pre>


<p style="margin-left:11%; margin-top: 1em">For further
discussion on this topic, refer to &quot;
<small>AVAILABILITY&quot;</small> in <i>guestfs</i>(3).</p>

<h2>STORING DATA IN THE HANDLE
<a name="STORING DATA IN THE HANDLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The handle
returned from &quot;new&quot; is a hash reference. The hash
normally contains some elements:</p>

<pre style="margin-left:11%; margin-top: 1em"> {
   _g =&gt; [private data used by libguestfs],
   _flags =&gt; [flags provided when creating the handle]
 }</pre>


<p style="margin-left:11%; margin-top: 1em">Callers can add
other elements to this hash to store data for their own
purposes. The data lasts for the lifetime of the handle.</p>

<p style="margin-left:11%; margin-top: 1em">Any fields
whose names begin with an underscore are reserved for
private use by libguestfs. We may add more in future.</p>

<p style="margin-left:11%; margin-top: 1em">It is
recommended that callers prefix the name of their field(s)
with some unique string, to avoid conflicts with other
users.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2009&minus;2016 Red Hat Inc.</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please see the
file <small>COPYING.LIB</small> for the full license.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>guestfs</i>(3),
<i>guestfish</i>(1), &lt;http://libguestfs.org&gt;.</p>
<hr>
</body>
</html>
