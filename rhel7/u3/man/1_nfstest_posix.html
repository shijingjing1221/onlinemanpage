<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:00:28 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>NFSTEST_POSIX</title>

</head>
<body>

<h1 align="center">NFSTEST_POSIX</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#TESTS">TESTS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfstest_posix -
POSIX file system level access tests</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfstest_posix
--server &lt;server&gt; [options]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Verify POSIX
file system level access over the specified path using
positive and negative testing.</p>

<p style="margin-left:11%; margin-top: 1em">Valid for any
version of NFS.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">--version</p>

<p style="margin-left:22%;">show program&rsquo;s version
number and exit</p>

<p style="margin-left:11%;">-h, --help</p>

<p style="margin-left:22%;">show this help message and
exit</p>

<p style="margin-left:11%;">-f FILE, --file=FILE</p>

<p style="margin-left:22%;">File where options are
specified besides the system wide file /etc/nfstest, user
wide file $HOME/.nfstest or in the current directory
.nfstest file</p>

<p style="margin-left:11%; margin-top: 1em"><b>NFS specific
options:</b> <br>
-s SERVER, --server=SERVER</p>

<p style="margin-left:22%;">Server name or IP address</p>

<p style="margin-left:11%;">-e EXPORT, --export=EXPORT</p>

<p style="margin-left:22%;">Exported file system to mount
[default: &rsquo;/&rsquo;]</p>

<p style="margin-left:11%;">--nfsversion=NFSVERSION</p>

<p style="margin-left:22%;">NFS version, e.g., 3, 4, 4.1,
etc. [default: 4.1]</p>

<p style="margin-left:11%;">-m MTPOINT,
--mtpoint=MTPOINT</p>

<p style="margin-left:22%;">Mount point [default:
&rsquo;/mnt/t&rsquo;]</p>

<p style="margin-left:11%;">-p PORT, --port=PORT</p>

<p style="margin-left:22%;">NFS server port [default:
2049]</p>

<p style="margin-left:11%;">--proto=PROTO</p>

<p style="margin-left:22%;">NFS protocol name [default:
&rsquo;tcp&rsquo;]</p>

<p style="margin-left:11%;">--sec=SEC</p>

<p style="margin-left:22%;">Security flavor [default:
&rsquo;sys&rsquo;]</p>

<p style="margin-left:11%;">-o MTOPTS, --mtopts=MTOPTS</p>

<p style="margin-left:22%;">Mount options [default:
&rsquo;hard,rsize=4096,wsize=4096&rsquo;]</p>

<p style="margin-left:11%;">--datadir=DATADIR</p>

<p style="margin-left:22%;">Data directory where files are
created, directory is created on the mount point [default:
&rsquo;&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Logging
options:</b> <br>
-v VERBOSE, --verbose=VERBOSE</p>

<p style="margin-left:22%;">Verbose level for debug
messages [default: &rsquo;none&rsquo;]</p>

<p style="margin-left:11%;">--tverbose=TVERBOSE</p>

<p style="margin-left:22%;">Verbose level for test messages
[default: &rsquo;1&rsquo;]</p>

<p style="margin-left:11%;">--createlog</p>

<p style="margin-left:22%;">Create log file</p>

<p style="margin-left:11%;">--warnings</p>

<p style="margin-left:22%;">Display warnings</p>

<p style="margin-left:11%;">--tag=TAG</p>

<p style="margin-left:22%;">Informational tag, it is
displayed as an INFO message [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Packet trace
options:</b> <br>
--createtraces</p>

<p style="margin-left:22%;">Create a packet trace for each
test</p>

<p style="margin-left:11%;">--tbsize=TBSIZE</p>

<p style="margin-left:22%;">Capture buffer size for tcpdump
[default: &rsquo;50000&rsquo;]</p>

<p style="margin-left:11%;">--trcdelay=TRCDELAY</p>

<p style="margin-left:22%;">Seconds to delay before
stopping packet trace [default: 0.0]</p>

<p style="margin-left:11%;">--keeptraces</p>

<p style="margin-left:22%;">Do not remove any trace files
[default: remove trace files if no errors]</p>

<p style="margin-left:11%;">--rmtraces</p>

<p style="margin-left:22%;">Remove trace files [default:
remove trace files if no errors]</p>

<p style="margin-left:11%;">-i INTERFACE,
--interface=INTERFACE</p>

<p style="margin-left:22%;">Device interface [default:
automatically selected]</p>

<p style="margin-left:11%; margin-top: 1em"><b>File
options:</b> <br>
--nfiles=NFILES</p>

<p style="margin-left:22%;">Number of files to create
[default: 2]</p>

<p style="margin-left:11%;">--filesize=FILESIZE</p>

<p style="margin-left:22%;">File size to use for test files
[default: 65536]</p>

<p style="margin-left:11%;">--rsize=RSIZE</p>

<p style="margin-left:22%;">Read size to use when reading
files [default: 4096]</p>

<p style="margin-left:11%;">--wsize=WSIZE</p>

<p style="margin-left:22%;">Write size to use when writing
files [default: 4096]</p>

<p style="margin-left:11%;">--iodelay=IODELAY</p>

<p style="margin-left:22%;">Seconds to delay I/O operations
[default: 0.1]</p>


<p style="margin-left:11%;">--offset-delta=OFFSET_DELTA</p>

<p style="margin-left:22%;">Read/Write offset delta
[default: 4096]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Path
options:</b> <br>
--sudo=SUDO</p>

<p style="margin-left:22%;">Full path of binary for sudo
[default: &rsquo;/usr/bin/sudo&rsquo;]</p>

<p style="margin-left:11%;">--tcpdump=TCPDUMP</p>

<p style="margin-left:22%;">Full path of binary for tcpdump
[default: &rsquo;/usr/sbin/tcpdump&rsquo;]</p>

<p style="margin-left:11%;">--iptables=IPTABLES</p>

<p style="margin-left:22%;">Full path of binary for
iptables [default: &rsquo;/sbin/iptables&rsquo;]</p>

<p style="margin-left:11%;">--messages=MESSAGES</p>

<p style="margin-left:22%;">Full path of log messages file
[default: &rsquo;/var/log/messages&rsquo;]</p>

<p style="margin-left:11%;">--tmpdir=TMPDIR</p>

<p style="margin-left:22%;">Temporary directory [default:
&rsquo;/tmp&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Debug
options:</b> <br>
--nocleanup</p>

<p style="margin-left:22%;">Do not cleanup created
files</p>

<p style="margin-left:11%;">--bugmsgs=BUGMSGS</p>

<p style="margin-left:22%;">File containing test messages
to mark as bugs if they failed</p>

<p style="margin-left:11%;">--ignore</p>

<p style="margin-left:22%;">Ignore all bugs given by
bugmsgs</p>

<p style="margin-left:11%;">--nomount</p>

<p style="margin-left:22%;">Do not mount server and run the
tests on local disk space</p>

<p style="margin-left:11%;">--basename=BASENAME</p>

<p style="margin-left:22%;">Base name for all files and
logs [default: automatically generated]</p>

<p style="margin-left:11%;">--nfsdebug=NFSDEBUG</p>

<p style="margin-left:22%;">Set NFS kernel debug flags and
save log messages [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%;">--rpcdebug=RPCDEBUG</p>

<p style="margin-left:22%;">Set RPC kernel debug flags and
save log messages [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Test
options:</b> <br>
--runtest=RUNTEST</p>

<p style="margin-left:22%;">Comma separated list of tests
to run, if list starts with a &rsquo;^&rsquo; then all tests
are run except the ones listed [default:
&rsquo;all&rsquo;]</p>

<h2>TESTS
<a name="TESTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>access</b>
<br>
Verify POSIX API access() on files with different modes.</p>

<p style="margin-left:11%; margin-top: 1em"><b>chdir</b>
<br>
Verify POSIX API chdir() by changing to a newly created
directory <br>
and then by changing back to the original directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>close</b>
<br>
Verify POSIX API close() works and that writing to a closed
file <br>
descriptor returns an error.</p>


<p style="margin-left:11%; margin-top: 1em"><b>closedir</b>
<br>
Verify POSIX API closedir() works and that reading to a
closed file <br>
descriptor returns an error.</p>

<p style="margin-left:11%; margin-top: 1em"><b>creat</b>
<br>
Verify POSIX API creat(path, mode) is equivalent to <br>
open(path, O_WRONLY|O_CREAT|O_TRUNC, mode). First test with
a path <br>
that does not exist to verify the file was created and then
test <br>
with a path that does exist to verify that the file is
truncated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>fcntl</b>
<br>
Verify the POSIX API fcntl() commands F_DUPFD, F_GETFD,
F_SETFD, <br>
F_GETFL, F_SETFL, and FD_CLOEXEC. The F_DUPFD command is
tested <br>
by performing operations on the original and dupped file
descriptor <br>
to ensure they behave correctly. The F_GETFD and F_SETFD
commands <br>
are tested by setting the FD_CLOEXEC flag and making sure it
gets set. <br>
The F_GETFL and F_SETFL commands are tested by setting the
O_APPEND <br>
flag and making sure it gets set. <br>
Run the test for both &rsquo;read&rsquo; and
&rsquo;write&rsquo;.</p>


<p style="margin-left:11%; margin-top: 1em"><b>fdatasync</b>
<br>
Verify POSIX API fdatasync().</p>

<p style="margin-left:11%; margin-top: 1em"><b>fstat</b>
<br>
Verify POSIX API fstat() by checking the mode on a file and
that <br>
it returns the expected structure members. Create a symlink
and <br>
verify that fstat returns information about the link.</p>


<p style="margin-left:11%; margin-top: 1em"><b>fstatvfs</b>
<br>
Verify POSIX API fstatvfs() by making sure all the members
of the <br>
structure are returned.</p>

<p style="margin-left:11%; margin-top: 1em"><b>fsync</b>
<br>
Verify POSIX API fsync().</p>

<p style="margin-left:11%; margin-top: 1em"><b>link</b>
<br>
Verify POSIX API link(src, dst) creates a link and updates
<br>
st_ctime field for the file. Verify that link updates the
<br>
st_ctime and st_mtime for the directory. Verify st_link
count <br>
incremented by 1 for the file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>lseek</b>
<br>
Verify POSIX API lseek() with different offsets and whence
<br>
values including seeking past the end of the file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>lstat</b>
<br>
Verify POSIX API lstat() by checking the mode on a file and
that <br>
it returns the expected structure members. Create a symlink
and <br>
verify that lstat returns information about the link.</p>

<p style="margin-left:11%; margin-top: 1em"><b>mkdir</b>
<br>
Verify POSIX API mkdir(). Verify that mkdir with a path of a
symbolic <br>
link fails. Verify that the st_ctime and st_mtime fields of
the <br>
parent directory are updated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>mmap</b>
<br>
Verify POSIX API mmap() by mapping a file and verifying I/O
<br>
operations. Verify mmap followed by memory read of existing
<br>
file works. Verify mmap followed by memory write to file
works.</p>

<p style="margin-left:11%; margin-top: 1em"><b>munmap</b>
<br>
Verify POSIX API munmap() by mapping a file and then
unmapping <br>
the file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>opendir</b>
<br>
Verify POSIX API opendir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>read</b>
<br>
Verify POSIX API read() by reading data from a file. Verify
that <br>
the st_atime of the file is updated after the read. Verify a
read <br>
of 0 bytes returns 0.</p>

<p style="margin-left:11%; margin-top: 1em"><b>readdir</b>
<br>
Verify POSIX API readdir() on a directory.</p>


<p style="margin-left:11%; margin-top: 1em"><b>readlink</b>
<br>
Verify Test POSIX API readlink() by reading a symbolic
link.</p>

<p style="margin-left:11%; margin-top: 1em"><b>rename</b>
<br>
Verify POSIX API rename() by renaming a file, directory, and
a <br>
symbolic link. Verify that a rename from a file to a
symbolic <br>
link will cause the symbolic link to be removed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rewinddir</b>
<br>
Verify POSIX API rewinddir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>rmdir</b>
<br>
Verify POSIX API rmdir() by removing a directory. Verify
that the <br>
parent&rsquo;s st_ctime and st_mtime are updated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>seekdir</b>
<br>
Verify POSIX API seekdir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>stat</b>
<br>
Verify POSIX API stat() by checking the mode on a file and
that <br>
it returns the expected structure members. Create a symlink
and <br>
verify that stat returns information about the file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>statvfs</b>
<br>
Verify POSIX API statvfs() by making sure all the members of
the <br>
structure are returned.</p>

<p style="margin-left:11%; margin-top: 1em"><b>symlink</b>
<br>
Verify POSIX API symlink() by creating a symbolic link and
verify <br>
that the file type is slnk.</p>

<p style="margin-left:11%; margin-top: 1em"><b>sync</b>
<br>
Verify POSIX API sync().</p>

<p style="margin-left:11%; margin-top: 1em"><b>telldir</b>
<br>
Verify POSIX API telldir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>unlink</b>
<br>
Verify POSIX API unlink() by unlinking a file and verify
that it <br>
was removed. Verify that the st_ctime and st_mtime fields of
the <br>
parent directory were updated. Then unlink a symbolic link
and <br>
verify that the symbolic link was removed but not the
referenced <br>
file. Then remove an opened file and verify that I/O still
occurs <br>
to the file after the unlink and that the file gets removed
when <br>
the file is closed. Create a file and then hard link to it
so the <br>
link count is greater than 1. Unlink the hard file and
verify that <br>
st_ctime field is updated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>write</b>
<br>
Verify POSIX API write() by writing 0 bytes and verifying 0
<br>
is returned. Write a pattern the file, seek +N, write
another <br>
pattern, and close the file. Open the file and read in both
<br>
written patterns and verify that it is the correct pattern.
<br>
Read in the data from the hole in the file and verify that
it is 0.</p>

<p style="margin-left:11%; margin-top: 1em"><b>open</b>
<br>
Verify POSIX API open() on a file. Verify file creation
using <br>
the O_CREAT flag and verifying the file mode is set to the
<br>
specified value. Verify the st_ctime and st_mtime are
updated <br>
on the parent directory after the file was created. Verify
open <br>
on existing file fails with the O_EXCL flag set. Verify
write <br>
succeeds and read fails if file was open with O_WRONLY.
Verify <br>
read succeeds and write fails if file was open with
O_RDONLY. <br>
Verify that all writes with O_APPEND set are to the end of
the file. <br>
Use O_DSYNC, O_RSYNC, and O_SYNC flags in open calls. <br>
Verify file open with O_CREAT and O_TRUNC set will truncate
an <br>
existing file. Verify that it updates the file st_ctime and
st_mtime.</p>

<p style="margin-left:11%; margin-top: 1em"><b>chmod</b>
<br>
Verify POSIX API chmod() on a file and directory by trying
all valid <br>
combinations of modes. Verify that the st_ctime files is
updated <br>
for both the file and directory.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The only
required option is --server <br>
$ nfstest_posix --server 192.168.0.11</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The user id in
the local host must have access to run commands as root
using the &rsquo;sudo&rsquo; command without the need for a
password.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>nfstest.test_util(3),
nfstest_alloc(1), nfstest_cache(1), nfstest_delegation(1),
nfstest_dio(1), nfstest_file(1), nfstest_interop(1),
nfstest_io(1), nfstest_lock(1), nfstest_pkt(1),
nfstest_pnfs(1), nfstest_sparse(1), nfstest_xid(1)</b></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">No known
bugs.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Jorge Mora
(mora@netapp.com)</p>
<hr>
</body>
</html>
