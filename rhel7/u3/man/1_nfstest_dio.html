<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:00:26 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>NFSTEST_DIO</title>

</head>
<body>

<h1 align="center">NFSTEST_DIO</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#TESTS">TESTS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfstest_dio -
Direct I/O tests</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfstest_dio
--server &lt;server&gt; [options]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Functional
direct I/O tests verify that every READ/WRITE is sent to the
server instead of the client caching the requests. Client
bypasses read ahead by sending the READ with only the
requested bytes. Verify the client correctly handles eof
marker when reading the whole file. Verify client ignores
delegation while writing a file.</p>

<p style="margin-left:11%; margin-top: 1em">Direct I/O on
pNFS tests verify the client sends the READ/WRITE to the
correct DS or the MDS if using a PAGESIZE aligned buffer or
not, respectively.</p>

<p style="margin-left:11%; margin-top: 1em">Direct I/O data
correctness tests verify that a file written with buffered
I/O is read correctly with direct I/O. Verify that a file
written with direct I/O is read correctly with buffered
I/O.</p>

<p style="margin-left:11%; margin-top: 1em">Vectored I/O
tests verify coalescence of multiple vectors into one
READ/WRITE packet when all vectors are PAGESIZE aligned.
Vectors with different alignments are sent on separate
packets.</p>

<p style="margin-left:11%; margin-top: 1em">Valid for
NFSv4.0 and NFSv4.1 including pNFS.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">--version</p>

<p style="margin-left:22%;">show program&rsquo;s version
number and exit</p>

<p style="margin-left:11%;">-h, --help</p>

<p style="margin-left:22%;">show this help message and
exit</p>

<p style="margin-left:11%;">-f FILE, --file=FILE</p>

<p style="margin-left:22%;">File where options are
specified besides the system wide file /etc/nfstest, user
wide file $HOME/.nfstest or in the current directory
.nfstest file</p>

<p style="margin-left:11%; margin-top: 1em"><b>NFS specific
options:</b> <br>
-s SERVER, --server=SERVER</p>

<p style="margin-left:22%;">Server name or IP address</p>

<p style="margin-left:11%;">-e EXPORT, --export=EXPORT</p>

<p style="margin-left:22%;">Exported file system to mount
[default: &rsquo;/&rsquo;]</p>

<p style="margin-left:11%;">--nfsversion=NFSVERSION</p>

<p style="margin-left:22%;">NFS version, e.g., 3, 4, 4.1,
etc. [default: 4.1]</p>

<p style="margin-left:11%;">-m MTPOINT,
--mtpoint=MTPOINT</p>

<p style="margin-left:22%;">Mount point [default:
&rsquo;/mnt/t&rsquo;]</p>

<p style="margin-left:11%;">-p PORT, --port=PORT</p>

<p style="margin-left:22%;">NFS server port [default:
2049]</p>

<p style="margin-left:11%;">--proto=PROTO</p>

<p style="margin-left:22%;">NFS protocol name [default:
&rsquo;tcp&rsquo;]</p>

<p style="margin-left:11%;">--sec=SEC</p>

<p style="margin-left:22%;">Security flavor [default:
&rsquo;sys&rsquo;]</p>

<p style="margin-left:11%;">-o MTOPTS, --mtopts=MTOPTS</p>

<p style="margin-left:22%;">Mount options [default:
&rsquo;hard,intr&rsquo;]</p>

<p style="margin-left:11%;">--datadir=DATADIR</p>

<p style="margin-left:22%;">Data directory where files are
created, directory is created on the mount point [default:
&rsquo;&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Logging
options:</b> <br>
-v VERBOSE, --verbose=VERBOSE</p>

<p style="margin-left:22%;">Verbose level for debug
messages [default: &rsquo;none&rsquo;]</p>

<p style="margin-left:11%;">--tverbose=TVERBOSE</p>

<p style="margin-left:22%;">Verbose level for test messages
[default: &rsquo;1&rsquo;]</p>

<p style="margin-left:11%;">--createlog</p>

<p style="margin-left:22%;">Create log file</p>

<p style="margin-left:11%;">--warnings</p>

<p style="margin-left:22%;">Display warnings</p>

<p style="margin-left:11%;">--tag=TAG</p>

<p style="margin-left:22%;">Informational tag, it is
displayed as an INFO message [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Packet trace
options:</b> <br>
--createtraces</p>

<p style="margin-left:22%;">Create a packet trace for each
test</p>

<p style="margin-left:11%;">--tbsize=TBSIZE</p>

<p style="margin-left:22%;">Capture buffer size for tcpdump
[default: &rsquo;50000&rsquo;]</p>

<p style="margin-left:11%;">--trcdelay=TRCDELAY</p>

<p style="margin-left:22%;">Seconds to delay before
stopping packet trace [default: 0.0]</p>

<p style="margin-left:11%;">--keeptraces</p>

<p style="margin-left:22%;">Do not remove any trace files
[default: remove trace files if no errors]</p>

<p style="margin-left:11%;">--rmtraces</p>

<p style="margin-left:22%;">Remove trace files [default:
remove trace files if no errors]</p>

<p style="margin-left:11%;">-i INTERFACE,
--interface=INTERFACE</p>

<p style="margin-left:22%;">Device interface [default:
automatically selected]</p>

<p style="margin-left:11%; margin-top: 1em"><b>File
options:</b> <br>
--nfiles=NFILES</p>

<p style="margin-left:22%;">Number of files to create
[default: 2]</p>

<p style="margin-left:11%;">--filesize=FILESIZE</p>

<p style="margin-left:22%;">File size to use for test files
[default: 262144]</p>

<p style="margin-left:11%;">--rsize=RSIZE</p>

<p style="margin-left:22%;">Read size to use when reading
files [default: 4096]</p>

<p style="margin-left:11%;">--wsize=WSIZE</p>

<p style="margin-left:22%;">Write size to use when writing
files [default: 4096]</p>

<p style="margin-left:11%;">--iodelay=IODELAY</p>

<p style="margin-left:22%;">Seconds to delay I/O operations
[default: 0.1]</p>


<p style="margin-left:11%;">--offset-delta=OFFSET_DELTA</p>

<p style="margin-left:22%;">Read/Write offset delta
[default: 4096]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Path
options:</b> <br>
--sudo=SUDO</p>

<p style="margin-left:22%;">Full path of binary for sudo
[default: &rsquo;/usr/bin/sudo&rsquo;]</p>

<p style="margin-left:11%;">--tcpdump=TCPDUMP</p>

<p style="margin-left:22%;">Full path of binary for tcpdump
[default: &rsquo;/usr/sbin/tcpdump&rsquo;]</p>

<p style="margin-left:11%;">--iptables=IPTABLES</p>

<p style="margin-left:22%;">Full path of binary for
iptables [default: &rsquo;/sbin/iptables&rsquo;]</p>

<p style="margin-left:11%;">--messages=MESSAGES</p>

<p style="margin-left:22%;">Full path of log messages file
[default: &rsquo;/var/log/messages&rsquo;]</p>

<p style="margin-left:11%;">--tmpdir=TMPDIR</p>

<p style="margin-left:22%;">Temporary directory [default:
&rsquo;/tmp&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Debug
options:</b> <br>
--nocleanup</p>

<p style="margin-left:22%;">Do not cleanup created
files</p>

<p style="margin-left:11%;">--bugmsgs=BUGMSGS</p>

<p style="margin-left:22%;">File containing test messages
to mark as bugs if they failed</p>

<p style="margin-left:11%;">--ignore</p>

<p style="margin-left:22%;">Ignore all bugs given by
bugmsgs</p>

<p style="margin-left:11%;">--nomount</p>

<p style="margin-left:22%;">Do not mount server and run the
tests on local disk space</p>

<p style="margin-left:11%;">--basename=BASENAME</p>

<p style="margin-left:22%;">Base name for all files and
logs [default: automatically generated]</p>

<p style="margin-left:11%;">--nfsdebug=NFSDEBUG</p>

<p style="margin-left:22%;">Set NFS kernel debug flags and
save log messages [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%;">--rpcdebug=RPCDEBUG</p>

<p style="margin-left:22%;">Set RPC kernel debug flags and
save log messages [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%; margin-top: 1em"><b>Test
options:</b> <br>
--runtest=RUNTEST</p>

<p style="margin-left:22%;">Comma separated list of tests
to run, if list starts with a &rsquo;^&rsquo; then all tests
are run except the ones listed [default:
&rsquo;all&rsquo;]</p>

<p style="margin-left:11%;">--iotype=IOTYPE</p>

<p style="margin-left:22%;">List of I/O types to test
[default: &rsquo;read,write&rsquo;]</p>

<p style="margin-left:11%;">--biotype=BIOTYPE</p>

<p style="margin-left:22%;">List of buffered I/O types to
test [default: &rsquo;none,read,write&rsquo;]</p>

<p style="margin-left:11%;">--withdeleg=WITHDELEG</p>

<p style="margin-left:22%;">Use delegation on tests
[default: both without and with delegation]</p>

<h2>TESTS
<a name="TESTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>eof</b> <br>
Verify eof marker is handled correctly when reading the end
<br>
of the file.</p>


<p style="margin-left:11%; margin-top: 1em"><b>correctness</b>
<br>
Verify data correctness when reading/writing using direct
I/O. <br>
File created with buffered I/O is read correctly with direct
I/O. <br>
File created with direct I/O is read correctly with buffered
I/O.</p>

<p style="margin-left:11%; margin-top: 1em"><b>fstat</b>
<br>
Verify fstat() gets correct file size after writing.</p>

<p style="margin-left:11%; margin-top: 1em"><b>read</b>
<br>
Verify READ is sent after writing when the file is open for
<br>
both read and write.</p>


<p style="margin-left:11%; margin-top: 1em"><b>read_ahead</b>
<br>
Verify READ is sent with only the requested bytes bypassing
<br>
read ahead.</p>

<p style="margin-left:11%; margin-top: 1em"><b>basic</b>
<br>
Verify a packet is sent for each I/O request.</p>

<p style="margin-left:11%; margin-top: 1em"><b>rsize</b>
<br>
Verify multiple READ packets are sent for each read request
<br>
having request size &gt; rsize.</p>

<p style="margin-left:11%; margin-top: 1em"><b>wsize</b>
<br>
Verify multiple WRITE packets are sent for each write
request <br>
having request size &gt; wsize</p>

<p style="margin-left:11%; margin-top: 1em"><b>aligned</b>
<br>
Verify packet is sent to correct DS server when using a
memory <br>
which is PAGESIZE aligned.</p>


<p style="margin-left:11%; margin-top: 1em"><b>nonaligned</b>
<br>
Verify packet is sent to the MDS when using a memory which
<br>
is not PAGESIZE aligned.</p>


<p style="margin-left:11%; margin-top: 1em"><b>diffalign</b>
<br>
Verify packets are sent to both the MDS and correct DS on
same open <br>
using buffers with different alignments.</p>


<p style="margin-left:11%; margin-top: 1em"><b>stripesize</b>
<br>
Verify multiple packets are sent for each request having the
<br>
request size greater than stripe size.</p>


<p style="margin-left:11%; margin-top: 1em"><b>vectored_io</b>
<br>
Verify vectored I/O functionality.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The only
required option is --server <br>
$ nfstest_dio --server 192.168.0.11</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The user id in
the local host must have access to run commands as root
using the &rsquo;sudo&rsquo; command without the need for a
password.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>nfstest.test_util(3),
nfstest_alloc(1), nfstest_cache(1), nfstest_delegation(1),
nfstest_file(1), nfstest_interop(1), nfstest_io(1),
nfstest_lock(1), nfstest_pkt(1), nfstest_pnfs(1),
nfstest_posix(1), nfstest_sparse(1), nfstest_xid(1),
packet.nfs.nfs4_const(3)</b></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">No known
bugs.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Jorge Mora
(mora@netapp.com)</p>
<hr>
</body>
</html>
