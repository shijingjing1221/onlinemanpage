<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:44:55 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IPSEC_EROUTE</title>

</head>
<body>

<h1 align="center">IPSEC_EROUTE</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#SAID DESCRIPTION">SAID DESCRIPTION</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ipsec_eroute
&minus; manipulate IPSEC extended routing tables</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>ipsec eroute</b>
<i>&minus;&minus;add&nbsp;</i><b>&minus;&minus;eraf&nbsp;</b><i>(inet&nbsp;|&nbsp;inet6)&nbsp;</i><b>&minus;&minus;src&nbsp;</b><i>src/srcmaskbits|srcmask&nbsp;</i><b>&minus;&minus;dst&nbsp;</b><i>dst/dstmaskbits|dstmask&nbsp;</i>[[<b>&minus;&minus;transport&minus;proto&nbsp;</b><i>transport&minus;protocol</i>]]&nbsp;[<b>&minus;&minus;src&minus;port&nbsp;</b><i>source&minus;port</i>]&nbsp;[<b>&minus;&minus;dst&minus;port&nbsp;</b><i>dest&minus;port</i>]&nbsp;[&lt;SAID&gt;]</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>ipsec eroute</b>
<i>&minus;&minus;replace&nbsp;</i><b>&minus;&minus;eraf&nbsp;</b><i>(inet&nbsp;|&nbsp;inet6)&nbsp;</i><b>&minus;&minus;src&nbsp;</b><i>src/srcmaskbits|srcmask&nbsp;</i><b>&minus;&minus;dst&nbsp;</b><i>dst/dstmaskbits|dstmask&nbsp;</i>[[<b>&minus;&minus;transport&minus;proto&nbsp;</b><i>transport&minus;protocol</i>]]&nbsp;[<b>&minus;&minus;src&minus;port&nbsp;</b><i>source&minus;port</i>]&nbsp;[<b>&minus;&minus;dst&minus;port&nbsp;</b><i>dest&minus;port</i>]&nbsp;[&lt;SAID&gt;]</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>ipsec eroute</b>
<i>&minus;&minus;del</i>&minus;&minus;del<b>&minus;&minus;eraf&nbsp;</b><i>(inet&nbsp;|&nbsp;inet6)&nbsp;</i><b>&minus;&minus;src</b><i>src/srcmaskbits|srcmask</i><b>&minus;&minus;dst</b><i>dst/dstmaskbits|dstmask&nbsp;</i>[[<b>&minus;&minus;transport&minus;proto&nbsp;</b><i>transport&minus;protocol</i>]]&nbsp;[<b>&minus;&minus;src&minus;port&nbsp;</b><i>source&minus;port</i>]&nbsp;[<b>&minus;&minus;dst&minus;port&nbsp;</b><i>dest&minus;port</i>]&nbsp;[&lt;SAID&gt;]</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>ipsec eroute</b>
&minus;&minus;clear</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>ipsec eroute</b>
&minus;&minus;help</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>ipsec eroute</b>
&minus;&minus;version</p> </td></tr>
</table>

<h2>SAID DESCRIPTION
<a name="SAID DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Where
&lt;SAID&gt; is &minus;&minus;af (inet | inet6)
&minus;&minus;edst edst &minus;&minus;spi spi
&minus;&minus;proto proto OR &minus;&minus;said said OR
&minus;&minus;said (%passthrough | %passthrough4 |
%passthrough6 | %drop | %reject | %trap | %hold | %pass
)</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>Eroute</i>
manages the IPSEC extended routing tables, which control
what (if any) processing is applied to non&minus;encrypted
packets arriving for IPSEC processing and forwarding. The
form with no additional arguments lists the contents of
/proc/net/ipsec_eroute. The <b>&minus;&minus;add</b> form
adds a table entry, the <b>&minus;&minus;replace</b> form
replaces a table entry, while the <b>&minus;&minus;del</b>
form deletes one. The <b>&minus;&minus;clear</b> form
deletes the entire table.</p>

<p style="margin-left:11%; margin-top: 1em">A table entry
consists of:</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">source and destination
addresses, with masks, source and destination ports and
protocol for selection of packets. The source and
destination ports are only legal if the transport protocol
is <b>TCP</b> or <b>UDP.</b> A port can be specified as
either decimal, hexadecimal (leading 0x), octal (leading 0)
or a name listed in the first column of /etc/services. A
transport protocol can be specified as either decimal,
hexadecimal (leading 0x), octal (leading 0) or a name listed
in the first column of /etc/protocols. If a transport
protocol or port is not specified then it defaults to 0
which means all protocols or all ports respectively.</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">Security Association
IDentifier, comprised of:</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">protocol (<i>proto</i>),
indicating (together with the effective destination and the
security parameters index) which Security Association should
be used to process the packet</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">address family (<i>af</i>),</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">Security Parameters Index
(<i>spi</i>), indicating (together with the effective
destination and protocol) which Security Association should
be used to process the packet (must be larger than or equal
to 0x100)</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">effective destination
(<i>edst</i>), where the packet should be forwarded after
processing (normally the other security gateway)</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">OR</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">SAID (<i>said</i>), indicating
which Security Association should be used to process the
packet</p>

<p style="margin-left:11%; margin-top: 1em">Addresses are
written as IPv4 dotted quads or IPv6 coloned hex, protocol
is one of &quot;ah&quot;, &quot;esp&quot;, &quot;comp&quot;
or &quot;tun&quot; and SPIs are prefixed hexadecimal numbers
where '.' represents IPv4 and ':' stands for IPv6.</p>

<p style="margin-left:11%; margin-top: 1em">SAIDs are
written as &quot;protoafSPI@address&quot;. There are also 5
&quot;magic&quot; SAIDs which have special meaning:</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;"><b>%drop</b> means that matches
are to be dropped</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;"><b>%reject</b> means that
matches are to be dropped and an ICMP returned, if possible
to inform</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;"><b>%trap</b> means that matches
are to trigger an ACQUIRE message to the Key Management
daemon(s) and a hold eroute will be put in place to prevent
subsequent packets also triggering ACQUIRE messages.</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;"><b>%hold</b> means that matches
are to stored until the eroute is replaced or until that
eroute gets reaped</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;"><b>%pass</b> means that matches
are to allowed to pass without IPSEC processing</p>

<p style="margin-left:11%; margin-top: 1em">The format of
/proc/net/ipsec_eroute is listed in ipsec_eroute(5).</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>ipsec eroute
&minus;&minus;add &minus;&minus;eraf inet &minus;&minus;src
192.168.0.1/32 \ &minus;&minus;dst 192.168.2.0/24
&minus;&minus;af inet &minus;&minus;edst 192.168.0.2 \
&minus;&minus;spi 0x135 &minus;&minus;proto tun</b></p>

<p style="margin-left:11%; margin-top: 1em">sets up an
<b>eroute</b> on a Security Gateway to protect traffic
between the host 192.168.0.1 and the subnet 192.168.2.0 with
24 bits of subnet mask via Security Gateway 192.168.0.2
using the Security Association with address 192.168.0.2,
Security Parameters Index <b>0x135</b> and protocol
<b>tun</b> (50, IPPROTO_ESP).</p>

<p style="margin-left:11%; margin-top: 1em"><b>ipsec eroute
&minus;&minus;add &minus;&minus;eraf inet6 &minus;&minus;src
3049:1::1/128 \ &minus;&minus;dst 3049:2::/64
&minus;&minus;af inet6 &minus;&minus;edst 3049:1::2 \
&minus;&minus;spi 0x145 &minus;&minus;proto tun</b></p>

<p style="margin-left:11%; margin-top: 1em">sets up an
<b>eroute</b> on a Security Gateway to protect traffic
between the host <b>3049:1::1</b> and the subnet
<b>3049:2::</b> with 64 bits of subnet mask via Security
Gateway <b>3049:1::2</b> using the Security Association with
address <b>3049:1::2</b>, Security Parameters Index
<b>0x145</b> and protocol <b>tun</b> (50, IPPROTO_ESP).</p>

<p style="margin-left:11%; margin-top: 1em"><b>ipsec eroute
&minus;&minus;replace &minus;&minus;eraf inet
&minus;&minus;src company.com/24 \ &minus;&minus;dst
ftp.ngo.org/32 &minus;&minus;said tun.135@gw.ngo.org</b></p>

<p style="margin-left:11%; margin-top: 1em">replaces an
<b>eroute</b> on a Security Gateway to protect traffic
between the subnet <b>company.com</b> with 24 bits of subnet
mask and the host <b>ftp.ngo.org</b> via Security Gateway
<b>gw.ngo.org</b> using the Security Association with
Security Association ID <b>tun0x135@gw.ngo.org</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>ipsec eroute
&minus;&minus;del &minus;&minus;eraf inet &minus;&minus;src
company.com/24 \ &minus;&minus;dst www.ietf.org/32
&minus;&minus;said %passthrough4</b></p>

<p style="margin-left:11%; margin-top: 1em">deletes an
<b>eroute</b> on a Security Gateway that allowed traffic
between the subnet <b>company.com</b> with 24 bits of subnet
mask and the host <b>www.ietf.org</b> to pass in the clear,
unprocessed.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ipsec eroute
&minus;&minus;add &minus;&minus;eraf inet &minus;&minus;src
company.com/24 \ &minus;&minus;dst mail.ngo.org/32
&minus;&minus;transport&minus;proto 6 \
&minus;&minus;dst&minus;port 110 &minus;&minus;said
tun.135@mail.ngo.org</b></p>

<p style="margin-left:11%; margin-top: 1em">sets up an
<b>eroute</b> on on a Security Gateway to protect only TCP
traffic on port 110 (pop3) between the subnet
<b>company.com</b> with 24 bits of subnet mask and the host
<b>ftp.ngo.org</b> via Security Gateway <b>mail.ngo.org</b>
using the Security Association with Security Association ID
<b>tun0x135@mail.ngo.org.</b> Note that any other traffic
bound for <b>mail.ngo.org</b> that is routed via the ipsec
device will be dropped. If you wish to allow other traffic
to pass through then you must add a %pass rule. For example
the following rule when combined with the above will ensure
that POP3 messages read from <b>mail.ngo.org</b> will be
encrypted but all other traffic to/from <b>mail.ngo.org</b>
will be in clear text.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ipsec eroute
&minus;&minus;add &minus;&minus;eraf inet &minus;&minus;src
company.com/24 \ &minus;&minus;dst mail.ngo.org/32
&minus;&minus;said %pass</b></p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">/proc/net/ipsec_eroute,
/usr/local/bin/ipsec</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ipsec(8),
ipsec_tncfg(8), ipsec_spi(8), ipsec_spigrp(8),
ipsec_klipsdebug(8), ipsec_eroute(5)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Written for the
Linux FreeS/WAN project
&lt;<b><font color="#0000FF">http://www.freeswan.org/</font></b><font color="#000000">&gt;
by Richard Guy Briggs.</font></p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Paul
Wouters</b></font></p>


<p style="margin-left:17%;"><font color="#000000">placeholder
to suppress warning</font></p>
<hr>
</body>
</html>
