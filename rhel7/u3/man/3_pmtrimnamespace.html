<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 22:10:57 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PMTRIMNAMESPACE</title>

</head>
<body>

<h1 align="center">PMTRIMNAMESPACE</h1>

<a href="#NAME">NAME</a><br>
<a href="#C SYNOPSIS">C SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pmTrimNameSpace</b>
&minus; prune a performance metrics name space</p>

<h2>C SYNOPSIS
<a name="C SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;pcp/pmapi.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
pmTrimNameSpace(void);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>cc ...
&minus;lpcp</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">In some (rare)
cases it is helpful to prune the Performance Metrics Name
Space (PMNS) to match the available metrics.</p>

<p style="margin-left:11%; margin-top: 1em">The default
PMNS that is accessible to a Performance Metrics Application
Programming Interface (PMAPI) client is provided by the
current PMAPI context:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="3%"></td>
<td width="85%">


<p>for a PMAPI context of type <b>PM_CONTEXT_HOST</b> the
PMNS is provided by <b>pmcd</b>(1) on the associated host
and no pruning is required</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="3%"></td>
<td width="85%">


<p>for a PMAPI context of type <b>PM_CONTEXT_ARCHIVE</b>
the PMNS is stored within the associated Performance
Co-Pilot (PCP) archive log and no pruning is required</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="3%"></td>
<td width="85%">


<p>for a PMAPI context of type <b>PM_CONTEXT_LOCAL</b> at
the first PMAPI call requiring access to the PMNS it is
loaded from the default local location
<b>$PCP_VAR_DIR/pmns/root</b> (or <b>$PMNS_DEFAULT</b>) and
no pruning is required.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">If the default
PMNS is in effect then calling <b>pmTrimNameSpace</b> is a
no-op and returns zero with no change to the PMNS.</p>

<p style="margin-left:11%; margin-top: 1em">PMAPI clients
also have the option of over-riding the default PMNS by
loading a <i>local</i> PMNS from a file (see <b>pmns</b>(5)
for the format) by calling <b>pmLoadASCIINameSpace</b>(3) or
<b>pmLoadNameSpace</b>(3) and this is when some PMNS pruning
<i>may</i> be useful.</p>

<p style="margin-left:11%; margin-top: 1em">If a
<i>local</i> PMNS is in effect when <b>pmTrimNameSpace</b>
is called then the first action is to restore the PMNS to
the state as of the completion of the last
<b>pmLoadASCIINameSpace</b>(3) or <b>pmLoadNameSpace</b>(3),
so that the effects of consecutive calls to
<b>pmTrimNameSpace</b> are <b>not</b> additive.</p>

<p style="margin-left:11%; margin-top: 1em">The subsequent
actions of <b>pmTrimNameSpace</b> depend on the type of the
current PMAPI context.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="3%"></td>
<td width="85%">


<p style="margin-top: 1em">For a context of type
<b>PM_CONTEXT_ARCHIVE</b> the <i>local</i> PMNS is trimmed
to exclude metrics for which no description can be found in
the PCP archive log. The PMNS is further trimmed to remove
empty subtrees that do not contain any performance metric.
Since PCP archives usually contain some subset of all
metrics named in a PMNS, <b>pmTrimNameSpace</b> effectively
prunes the application&rsquo;s PMNS to contain only the
names of the metrics in the archive.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="3%"></td>
<td width="85%">


<p>For a context of type <b>PM_CONTEXT_HOST</b> or
<b>PM_CONTEXT_LOCAL</b> no further action is required.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">On success,
<b>pmTrimNameSpace</b> returns zero.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pmlogger</b>(1),
<b>PMAPI</b>(3), <b>pmLoadASCIINameSpace</b>(3),
<b>pmLoadNameSpace</b>(3), <b>pmNewContext</b>(3) and
<b>pmns</b>(5).</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>PM_ERR_NOPMNS</b></p>

<p style="margin-left:22%;">there has been some earlier
problem with establishing the relevant PMNS</p>

<p style="margin-left:11%;"><b>PM_ERR_NOCONTEXT</b></p>

<p style="margin-left:22%;">the current PMAPI context is
invalid</p>
<hr>
</body>
</html>
