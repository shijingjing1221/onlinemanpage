<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 21:59:13 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Net::DNS::Header</title>

</head>
<body>

<h1 align="center">Net::DNS::Header</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#METHODS">METHODS</a><br>
<a href="#EDNS Protocol Extensions">EDNS Protocol Extensions</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Net::DNS::Header
&minus; DNS packet header</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em">    use Net::DNS;
    $packet = new Net::DNS::Packet;
    $header = $packet&minus;&gt;header;</pre>


<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><tt>&quot;Net::DNS::Header&quot;</tt>
represents the header portion of a <small>DNS</small>
packet.</p>

<h2>METHODS
<a name="METHODS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>new</b></p>

<pre style="margin-left:11%;">    $header = new Net::DNS::Header($packet);</pre>


<p style="margin-left:11%; margin-top: 1em">Constructor
method which returns a <tt>&quot;Net::DNS::Header&quot;</tt>
object representing the header section of the specified
packet.</p>


<p style="margin-left:11%; margin-top: 1em"><b>string</b></p>


<pre style="margin-left:11%;">    print $packet&minus;&gt;header&minus;&gt;string;</pre>


<p style="margin-left:11%; margin-top: 1em">Returns a
string representation of the packet header.</p>

<p style="margin-left:11%; margin-top: 1em"><b>id</b></p>

<pre style="margin-left:11%;">    print &quot;query id = &quot;, $packet&minus;&gt;header&minus;&gt;id, &quot;\n&quot;;
    $packet&minus;&gt;header&minus;&gt;id(1234);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the query identification number.</p>

<p style="margin-left:11%; margin-top: 1em">A random value
is assigned if the argument value is undefined.</p>


<p style="margin-left:11%; margin-top: 1em"><b>opcode</b></p>


<pre style="margin-left:11%;">    print &quot;query opcode = &quot;, $packet&minus;&gt;header&minus;&gt;opcode, &quot;\n&quot;;
    $packet&minus;&gt;header&minus;&gt;opcode(&quot;UPDATE&quot;);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the query opcode (the purpose of the query).</p>


<p style="margin-left:11%; margin-top: 1em"><b>rcode</b></p>


<pre style="margin-left:11%;">    print &quot;query response code = &quot;, $packet&minus;&gt;header&minus;&gt;rcode, &quot;\n&quot;;
    $packet&minus;&gt;header&minus;&gt;rcode(&quot;SERVFAIL&quot;);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the query response code (the status of the query).</p>

<p style="margin-left:11%; margin-top: 1em"><b>qr</b></p>

<pre style="margin-left:11%;">    print &quot;query response flag = &quot;, $packet&minus;&gt;header&minus;&gt;qr, &quot;\n&quot;;
    $packet&minus;&gt;header&minus;&gt;qr(0);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the query response flag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>aa</b></p>

<pre style="margin-left:11%;">    print &quot;answer is &quot;, $packet&minus;&gt;header&minus;&gt;aa ? &quot;&quot; : &quot;non&minus;&quot;, &quot;authoritative\n&quot;;
    $packet&minus;&gt;header&minus;&gt;aa(0);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the authoritative answer flag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>tc</b></p>

<pre style="margin-left:11%;">    print &quot;packet is &quot;, $packet&minus;&gt;header&minus;&gt;tc ? &quot;&quot; : &quot;not &quot;, &quot;truncated\n&quot;;
    $packet&minus;&gt;header&minus;&gt;tc(0);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the truncated packet flag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>rd</b></p>

<pre style="margin-left:11%;">    print &quot;recursion was &quot;, $packet&minus;&gt;header&minus;&gt;rd ? &quot;&quot; : &quot;not &quot;, &quot;desired\n&quot;;
    $packet&minus;&gt;header&minus;&gt;rd(0);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the recursion desired flag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ra</b></p>

<pre style="margin-left:11%;">    print &quot;recursion is &quot;, $packet&minus;&gt;header&minus;&gt;ra ? &quot;&quot; : &quot;not &quot;, &quot;available\n&quot;;
    $packet&minus;&gt;header&minus;&gt;ra(0);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the recursion available flag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>z</b> <br>
Unassigned bit, should always be zero.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ad</b></p>

<pre style="margin-left:11%;">    print &quot;The result has &quot;, $packet&minus;&gt;header&minus;&gt;ad ? &quot;&quot; : &quot;not&quot;, &quot;been verified\n&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">Relevant in
<small>DNSSEC</small> context.</p>

<p style="margin-left:11%; margin-top: 1em">(The
<small>AD</small> bit is only set on answers where
signatures have been cryptographically verified or the
server is authoritative for the data and is allowed to set
the bit by policy.)</p>

<p style="margin-left:11%; margin-top: 1em"><b>cd</b></p>

<pre style="margin-left:11%;">    print &quot;checking was &quot;, $packet&minus;&gt;header&minus;&gt;cd ? &quot;not&quot; : &quot;&quot;, &quot;desired\n&quot;;
    $packet&minus;&gt;header&minus;&gt;cd(0);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the checking disabled flag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>qdcount,
zocount</b></p>

<pre style="margin-left:11%;">    print &quot;# of question records: &quot;, $packet&minus;&gt;header&minus;&gt;qdcount, &quot;\n&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">Returns the
number of records in the question section of the packet. In
dynamic update packets, this field is known as
<tt>&quot;zocount&quot;</tt> and refers to the number of RRs
in the zone section.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ancount,
prcount</b></p>

<pre style="margin-left:11%;">    print &quot;# of answer records: &quot;, $packet&minus;&gt;header&minus;&gt;ancount, &quot;\n&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">Returns the
number of records in the answer section of the packet which
may, in the case of corrupt packets, differ from the actual
number of records. In dynamic update packets, this field is
known as <tt>&quot;prcount&quot;</tt> and refers to the
number of RRs in the prerequisite section.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nscount,
upcount</b></p>

<pre style="margin-left:11%;">    print &quot;# of authority records: &quot;, $packet&minus;&gt;header&minus;&gt;nscount, &quot;\n&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">Returns the
number of records in the authority section of the packet
which may, in the case of corrupt packets, differ from the
actual number of records. In dynamic update packets, this
field is known as <tt>&quot;upcount&quot;</tt> and refers to
the number of RRs in the update section.</p>

<p style="margin-left:11%; margin-top: 1em"><b>arcount,
adcount</b></p>

<pre style="margin-left:11%;">    print &quot;# of additional records: &quot;, $packet&minus;&gt;header&minus;&gt;arcount, &quot;\n&quot;;</pre>


<p style="margin-left:11%; margin-top: 1em">Returns the
number of records in the additional section of the packet
which may, in the case of corrupt packets, differ from the
actual number of records. In dynamic update packets, this
field is known as <tt>&quot;adcount&quot;</tt>.</p>

<h2>EDNS Protocol Extensions
<a name="EDNS Protocol Extensions"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>do</b></p>

<pre style="margin-left:11%;">    print &quot;DNSSEC_OK flag was &quot;, $packet&minus;&gt;header&minus;&gt;do ? &quot;not&quot; : &quot;&quot;, &quot;set\n&quot;;
    $packet&minus;&gt;header&minus;&gt;do(1);</pre>


<p style="margin-left:11%; margin-top: 1em">Gets or sets
the <small>EDNS DNSSEC OK</small> flag.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Extended
rcode</b> <small><br>
EDNS</small> extended rcodes are handled transparently by
<tt>$packet</tt>&minus;&gt;header&minus;&gt;<i>rcode()</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b><small>UDP</small>
packet size</b></p>

<pre style="margin-left:11%;">    $udp_max = $packet&minus;&gt;edns&minus;&gt;size;
    $udp_max = $packet&minus;&gt;header&minus;&gt;size;</pre>



<p style="margin-left:11%; margin-top: 1em"><small>EDNS</small>
offers a mechanism to advertise the maximum
<small>UDP</small> packet size which can be assembled by the
local network stack.</p>


<p style="margin-left:11%; margin-top: 1em"><small>UDP</small>
size advertisement can be viewed as either a header
extension or an <small>EDNS</small> feature. Endless debate
is avoided by supporting both views.</p>


<p style="margin-left:11%; margin-top: 1em"><b>edns</b></p>


<pre style="margin-left:11%;">    $header  = $packet&minus;&gt;header;
    $version = $header&minus;&gt;edns&minus;&gt;version;
    @options = $header&minus;&gt;edns&minus;&gt;options;
    $option  = $header&minus;&gt;edns&minus;&gt;option(n);
    $udp_max = $packet&minus;&gt;edns&minus;&gt;size;</pre>


<p style="margin-left:11%; margin-top: 1em">Auxiliary
function which provides access to the <small>EDNS</small>
protocol extension <small>OPT RR.</small></p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright
(c)1997&minus;2002 Michael Fuhr.</p>

<p style="margin-left:11%; margin-top: 1em">Portions
Copyright (c)2002&minus;2004 Chris Reinhardt.</p>

<p style="margin-left:11%; margin-top: 1em">Portions
Copyright (c)2012 Dick Franks.</p>

<p style="margin-left:11%; margin-top: 1em">All rights
reserved.</p>

<p style="margin-left:11%; margin-top: 1em">This program is
free software; you may redistribute it and/or modify it
under the same terms as Perl itself.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">perl, Net::DNS,
Net::DNS::Packet, Net::DNS::RR::OPT <small>RFC 1035</small>
Section 4.1.1</p>
<hr>
</body>
</html>
