<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:03:18 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>opaportconfig</title>

</head>
<body>

<h1 align="center">opaportconfig</h1>

<a href="#NAME">NAME</a><br>
<a href="#Syntax">Syntax</a><br>
<a href="#Options">Options</a><br>
<a href="#Configuration options--&gt;">Configuration options--&gt;</a><br>
<a href="#Debug Options--&gt;">Debug Options--&gt;</a><br>
<a href="#Examples">Examples</a><br>
<a href="#Description">Description</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">opaportconfig</p>

<p style="margin-left:11%; margin-top: 1em"><b>(Host or
Switch)</b> Controls the configuration and state of a
specified Intel(R) Omni-Path Host Fabric Interface (HFI)
port on the local host or a remote switch.</p>

<h2>Syntax
<a name="Syntax"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">opaportconfig
[-l <i>lid</i>[-m <i>dest_port</i>]] [-h <i>hfi</i>] [-p
<i>port</i>] [-r <i>secs</i>] [-z] [-S <i>state</i>] [-P
<i>physstate</i>] [-s <i>speed</i>] [-w <i>width</i>] [-c
<i>LTPCRC</i>] [-K <i>mkey</i>] [-v] [-x] [-L <i>lid</i>]
[&lt; <i>sub command</i>&gt;]</p>

<h2>Options
<a name="Options"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em">-l <i>lid</i></p></td>
<td width="6%"></td>
<td width="60%">


<p style="margin-top: 1em">Destination lid, default is
local port.</p></td>
<td width="14%">
</td></tr>
</table>

<p style="margin-left:11%;">-m <i>dest_port</i></p>

<p style="margin-left:26%;">Destination port, default is
port with given lid, useful to access switch ports.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p>-h <i>hfi</i></p></td>
<td width="4%"></td>
<td width="72%">


<p>HFI to send through/to, default is first HFI.</p></td>
<td width="2%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p>-p <i>port</i></p></td>
<td width="4%"></td>
<td width="72%">


<p>Port to send through/to, default is first port.</p></td>
<td width="2%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p>-K <i>mkey</i></p></td>
<td width="4%"></td>
<td width="72%">


<p>SM management key to access remote ports .</p></td>
<td width="2%">
</td></tr>
</table>

<p style="margin-left:11%;"><i>sub command</i></p>

<p style="margin-left:26%;">One of the following
choices:</p>

<p style="margin-left:26%; margin-top: 1em">enable Enable
port.</p>

<p style="margin-left:26%; margin-top: 1em">disable Disable
port.</p>

<p style="margin-left:26%; margin-top: 1em">bounce Bounce
port.</p>

<h2>Configuration options--&gt;
<a name="Configuration options--&gt;"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p style="margin-top: 1em">-r <i>secs</i></p></td>
<td width="3%"></td>
<td width="74%">


<p style="margin-top: 1em">Repeat to keep the port down for
designated amount of seconds.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p>-S <i>state</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>New State (default is 0).</p></td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">0 No-op.</p>

<p style="margin-left:26%; margin-top: 1em">1 Down.</p>

<p style="margin-left:26%; margin-top: 1em">2 Initiate.</p>

<p style="margin-left:26%; margin-top: 1em">3 Armed.</p>

<p style="margin-left:26%; margin-top: 1em">4 Active.</p>

<p style="margin-left:11%;">-P <i>physstate</i></p>

<p style="margin-left:26%;">New physical State (default is
0).</p>

<p style="margin-left:26%; margin-top: 1em">0 no-op.</p>

<p style="margin-left:26%; margin-top: 1em">2 Polling.</p>

<p style="margin-left:26%; margin-top: 1em">3 Disabled.</p>

<p style="margin-left:26%; margin-top: 1em">11 Phy-Test (OP
only).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p>-s <i>speed</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>New link speeds enabled (default is 0). To enable
multiple speeds, use the sum of the desired speeds.</p></td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">0 No-op.</p>

<p style="margin-left:26%; margin-top: 1em">1 0x0001 - 12.5
Gb/s.</p>

<p style="margin-left:26%; margin-top: 1em">2 0x0002 - 25
Gb/s.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p style="margin-top: 1em">-w <i>width</i></p></td>
<td width="3%"></td>
<td width="74%">


<p style="margin-top: 1em">New link widths enabled (default
is 0). To enable multiple widths, use sum of desired
widths.</p> </td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">0 No-op.</p>

<p style="margin-left:26%; margin-top: 1em">1 0x01 -
1x.</p>

<p style="margin-left:26%; margin-top: 1em">2 0x02 -
2x.</p>

<p style="margin-left:26%; margin-top: 1em">4 0x04 -
3x.</p>

<p style="margin-left:26%; margin-top: 1em">8 0x08 -
4x.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p style="margin-top: 1em">-c <i>LTPCRC</i></p></td>
<td width="1%"></td>
<td width="74%">


<p style="margin-top: 1em">New LPT CRCs enabled (default is
0). To enable multiple LPT CRCs, use sum of desired LPT
CRCs</p> </td></tr>
</table>

<p style="margin-left:26%; margin-top: 1em">0 No-op</p>

<p style="margin-left:26%; margin-top: 1em">1 0x1 - 14-bit
LTP CRC mode.</p>

<p style="margin-left:26%; margin-top: 1em">2 0x2 - 16-bit
LTP CRC mode.</p>

<p style="margin-left:26%; margin-top: 1em">4 0x4 - 48-bit
LTP CRC mode.</p>

<p style="margin-left:26%; margin-top: 1em">8 0x8 - 12/16
bits per lane LTP CRC mode</p>

<p style="margin-left:26%; margin-top: 1em">0xF - Enable
all supported.</p>

<p style="margin-left:11%; margin-top: 1em">The -h and -p
options permit a variety of selections:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p style="margin-top: 1em">-h 0</p></td>
<td width="9%"></td>
<td width="66%">


<p style="margin-top: 1em">First port in system (this is
the default).</p></td>
<td width="8%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p>-h <i>x</i></p></td>
<td width="9%"></td>
<td width="66%">


<p>First port on HFI <i>x</i> .</p></td>
<td width="8%">
</td></tr>
</table>

<p style="margin-left:11%;">-h 0 -p <i>y</i></p>

<p style="margin-left:26%;">Port <i>y</i> within
system.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p>-h <i>x</i>-p <i>y</i></p></td>
<td width="3%"></td>
<td width="28%">


<p>HFI <i>x</i> , port <i>y</i> .</p></td>
<td width="46%">
</td></tr>
</table>

<h2>Debug Options--&gt;
<a name="Debug Options--&gt;"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em">-v</p></td>
<td width="6%"></td>
<td width="74%">


<p style="margin-top: 1em">Verbose output. Additional
invocations will turn on debugging, openib debugging and
libibumad debugging.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>-z</p></td>
<td width="6%"></td>
<td width="74%">


<p>Do not get port info first, clear most port
attributes</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>-L <i>lid</i></p></td>
<td width="6%"></td>
<td width="74%">


<p>Set PortInfo.LID = lid.</p></td></tr>
</table>

<h2>Examples
<a name="Examples"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">opaportconfig
-w 1 <br>
opaportconfig -p 2 -h 2 -w 3</p>

<h2>Description
<a name="Description"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The port
configuration is transient in nature. If the given host is
rebooted or its Intel(R) Omni-Path Fabric Stack is
restarted, the port will revert to its default configuration
and state. Typically, the default state is to have the port
enabled with all speeds and widths supported by the given
HFI port enabled.</p>

<p style="margin-left:11%; margin-top: 1em">To access
switch ports using this command, the -l and -m options must
be given. The -l option will specify the lid of switch port
0 (the logical management port for the switch) and -m will
specify the actual switch port to access. if SMA mkeys are
being used, the -K option will also be needed. By default
the Intel(R) Omni-Path Fabric Suite Fabric Manager does not
use SMA mkeys, in which case this option does not need to be
used.</p>

<p style="margin-left:11%; margin-top: 1em"><b>NOTE:</b>
The /etc/init.d/opaportconfig script is provided as an
example of changing port speed every time the server boots.
This script can be edited then scheduled using chkconfig to
control link settings on any set of HFI ports</p>


<p style="margin-left:11%; margin-top: 1em"><b>CAUTION:</b>
When using this command to disable or reconfigure switch
ports, if the final port in the path between the Fabric
Management Node and the switch is disabled or fails to come
online, then opaenableports will not be able to reenable it.
In which case the switch CLI and/or a switch reboot may be
needed to correct the situation.</p>
<hr>
</body>
</html>
