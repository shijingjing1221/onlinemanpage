<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 01:14:10 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>AMGTAR</title>

</head>
<body>

<h1 align="center">AMGTAR</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#PROPERTIES">PROPERTIES</a><br>
<a href="#INCLUDE AND EXCLUDE LISTS">INCLUDE AND EXCLUDE LISTS</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">amgtar &minus;
Amanda Application to interface with GNU Tar</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Amgtar is an
Amanda Application API script. It should not be run by users
directly. It uses GNU Tar to backup and restore data.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>diskdevice</b> in the disklist (DLE) must be the
directory to backup.</p>

<h2>PROPERTIES
<a name="PROPERTIES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This section
lists the properties that control amgtar's functionality.
See <b>amanda-applications</b>(7) for information on
application properties and how they are configured.</p>


<p style="margin-left:11%; margin-top: 1em">ATIME&minus;PRESERVE</p>

<p style="margin-left:17%; margin-top: 1em">If
&quot;YES&quot; (the default), amgtar use the
<i>&minus;&minus;atime&minus;preserve=system</i> option of
gnutar to not update the atime of all files accessed; if
&quot;NO&quot;, gnutar will updates the atime for all files
accessed. This property works only if you have gnutar
1.15.90 or newer, if not, you must set ATIME_PRESERVE to
&quot;NO&quot;.</p>


<p style="margin-left:11%; margin-top: 1em">CHECK&minus;DEVICE</p>

<p style="margin-left:17%; margin-top: 1em">If
&quot;YES&quot; (the default), amgtar checks that the device
number doesn't change for each file. If &quot;NO&quot;,
changes in device number are ignored. To ignore device
numbers, tar must support the
<i>&minus;&minus;no&minus;check&minus;device</i> option
(gnutar 1.19.90 and newer). This option is needed for some
filesystems and devices on which device numbers change
frequently, such as LVM or FiberChannel.</p>


<p style="margin-left:11%; margin-top: 1em">COMMAND&minus;OPTIONS</p>

<p style="margin-left:17%;">If set, theses options are
passed asis to gtar. Each option must be a different value
of the property. Some option can break how amanda do backup,
use it with care.</p>

<p style="margin-left:17%; margin-top: 1em">Use: <br>
property &quot;COMMAND&minus;OPTIONS&quot;
&quot;&minus;&minus;foo&quot; &quot;bar&quot;</p>

<p style="margin-left:17%; margin-top: 1em">Do not use:
<br>
property &quot;COMMAND&minus;OPTIONS&quot;
&quot;&minus;&minus;foo bar&quot;</p>

<p style="margin-left:11%; margin-top: 1em">DIRECTORY</p>

<p style="margin-left:17%; margin-top: 1em">If set, gnutar
will backup from that directory instead of the
<i>diskdevice</i> set by the DLE. On restore, the data is
restore in that directory instead of the current working
directory.</p>


<p style="margin-left:11%; margin-top: 1em">GNUTAR&minus;LISTDIR</p>

<p style="margin-left:17%; margin-top: 1em">The directory
where gnutar stores the database it uses to generate
incremental dumps. The default is set when Amanda is
built.</p>


<p style="margin-left:11%; margin-top: 1em">GNUTAR&minus;PATH</p>

<p style="margin-left:17%; margin-top: 1em">The path to the
gnutar binary. The default is set when Amanda is built.</p>


<p style="margin-left:11%; margin-top: 1em">IGNORE&minus;ZEROS</p>

<p style="margin-left:17%; margin-top: 1em">If
&quot;YES&quot; (the default), use the
<i>&minus;&minus;ignore&minus;zeros</i> argument of gtar on
recovery, set it to &quot;NO&quot; if you do not want that
argument.</p>


<p style="margin-left:11%; margin-top: 1em">INCLUDE&minus;LIST&minus;GLOB</p>

<p style="margin-left:17%; margin-top: 1em">A filename
containing include glob expression for the restore
command.</p>


<p style="margin-left:11%; margin-top: 1em">EXCLUDE&minus;LIST&minus;GLOB</p>

<p style="margin-left:17%; margin-top: 1em">A filename
containing exclude glob expression for the restore
command.</p>


<p style="margin-left:11%; margin-top: 1em">ONE&minus;FILE&minus;SYSTEM</p>

<p style="margin-left:17%; margin-top: 1em">If
&quot;YES&quot; (the default), do not allow gnutar to cross
filesystem boundaries. If &quot;NO&quot;, gnutar will cross
filesystem boundaries. This corresponds to the
<i>&minus;&minus;one&minus;filesystem</i> option of
gnutar.</p>


<p style="margin-left:11%; margin-top: 1em">TAR&minus;BLOCKSIZE</p>

<p style="margin-left:17%; margin-top: 1em">Block size of
Nx512 bytes (default N=20). This corresponds to the
<i>&minus;&minus;blocking&minus;factor</i> option of
gnutar.</p>

<p style="margin-left:11%; margin-top: 1em">SPARSE</p>

<p style="margin-left:17%; margin-top: 1em">If
&quot;YES&quot; (the default), gnutar will store sparse
files efficiently. If &quot;NO&quot;, then the
<i>&minus;&minus;sparse</i> option is not given to gnutar,
and it will not try to detect sparse files.</p>


<p style="margin-left:11%; margin-top: 1em">NO&minus;UNQUOTE</p>

<p style="margin-left:17%; margin-top: 1em">If
&quot;NO&quot; (the default), gnutar doesn't get the
<i>&minus;&minus;no&minus;unquote</i> option and the
diskname can't have some characters, eg. '\'. If
&quot;YES&quot;, then the
<i>&minus;&minus;no&minus;unquote</i> option is given to
gnutar and the diskname can have any characters. This option
is available only if you are using tar&minus;1.16 or
newer.</p>

<p style="margin-left:11%; margin-top: 1em">ACLS</p>

<p style="margin-left:17%; margin-top: 1em">Default
&quot;NO&quot;. If &quot;YES&quot;, gnutar will preserve ACL
extended attributes. This corresponds to the
<i>&minus;&minus;acls</i> gnutar option. Requires a GNU Tar
with nonstandard extended attribute patches from the Fedora
Project.</p>

<p style="margin-left:11%; margin-top: 1em">SELINUX</p>

<p style="margin-left:17%; margin-top: 1em">Default
&quot;NO&quot;. If &quot;YES&quot;, gnutar will preserve
SELinux extended attributes on Linux. This corresponds to
the <i>&minus;&minus;selinux</i> gnutar option. Requires a
GNU Tar with nonstandard extended attribute patches from the
Fedora Project.</p>

<p style="margin-left:11%; margin-top: 1em">XATTRS</p>

<p style="margin-left:17%; margin-top: 1em">Default
&quot;NO&quot;. If &quot;YES&quot;, gnutar will preserve all
extended attributes. This corresponds to the
<i>&minus;&minus;xattrs</i> gnutar option. If enabled, this
option also implies the ACLS and SELINUX properties,
regardless of their settings, as they are implemented as
extended attributes. Requires a GNU Tar with nonstandard
extended attribute patches from the Fedora Project.</p>


<p style="margin-left:11%; margin-top: 1em">EXIT&minus;HANDLING</p>

<p style="margin-left:17%; margin-top: 1em">List which exit
status of gtar are good or bad. eg. &quot;1=GOOD
2=BAD&quot;, exit status of 1 will produce a good backup,
exit status of 2 will give an error.</p>

<p style="margin-left:11%; margin-top: 1em">NORMAL</p>

<p style="margin-left:17%; margin-top: 1em">List all regex
(POSIX Extended Regular Expression syntax) that are normal
output from gtar. These output are in the &quot;FAILED DUMP
DETAILS&quot; section of the email report if the dump result
is STRANGE or FAILED. Default values: <br>
&quot;^could not open conf file&quot; <br>
&quot;^Elapsed time:&quot; <br>
&quot;^Throughput&quot; <br>
&quot;: socket ignored$&quot; <br>
&quot;: File .* shrunk by [0&minus;9][0&minus;9]* bytes,
padding with zeros&quot; <br>
&quot;: Cannot add file .*: No such file or directory$&quot;
<br>
&quot;: Error exit delayed from previous errors&quot; <br>
To treat one of these default patterns differently, specify
it explicitly in a different property.</p>

<p style="margin-left:11%; margin-top: 1em">IGNORE</p>

<p style="margin-left:17%; margin-top: 1em">List all regex
(POSIX Extended Regular Expression syntax) that amanda
ignore. These output are never in the email report. Default
values: <br>
&quot;: Directory is new$&quot; <br>
&quot;: Directory has been renamed&quot; <br>
To treat one of these default patterns differently, specify
it explicitly in a different property.</p>

<p style="margin-left:11%; margin-top: 1em">STRANGE</p>

<p style="margin-left:17%; margin-top: 1em">List all regex
(POSIX Extended Regular Expression syntax) that are strange
output from gtar. All gtar output that doesn't match a
normal or ignore regex are strange by default. The result of
the dump is STRANGE if gtar produce a strange output. These
output are in the &quot;FAILED DUMP DETAILS&quot; section of
the email report.</p>

<p style="margin-left:11%; margin-top: 1em">VERBOSE</p>

<p style="margin-left:17%; margin-top: 1em">Default:
&quot;NO&quot;. If &quot;YES&quot;, amgtar print more
verbose debugging message and can leave temporary files in
AMANDA_TMPDIR.</p>

<h2>INCLUDE AND EXCLUDE LISTS
<a name="INCLUDE AND EXCLUDE LISTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This
application supplies exclude lists via the <b>GNU&minus;tar
&minus;&minus;exclude&minus;from</b> option. This option
accepts normal shell&minus;style wildcard expressions, using
<b>*</b> to match any number of characters and <b>?</b> to
match a single character. Character classes are represented
with <b>[..]</b>, which will match any of the characters in
the brackets. Expressions can be &quot;anchored&quot; to the
base directory of the DLE by prefixing them with
&quot;./&quot;. Without this prefix, they will match at any
directory level. Expressions that begin or end with a
&quot;/&quot; will not match anything: to completely exclude
a directory, do not include the trailing slash. Example
expressions:</p>


<p style="margin-left:11%; margin-top: 1em">./temp&minus;files
# exclude top&minus;level directory entirely <br>
./temp&minus;files/ # BAD: does nothing <br>
/temp&minus;files # BAD: does nothing <br>
./temp&minus;files/* # exclude directory contents; include
directory <br>
temp&minus;files # exclude anything named
&quot;temp&minus;files&quot; <br>
generated&minus;* # exclude anything beginning with
&quot;generated&minus;&quot; <br>
*.iso # exclude ISO files <br>
proxy/local/cache # exclude &quot;cache&quot; in dir
&quot;local&quot; in &quot;proxy&quot;</p>

<p style="margin-left:11%; margin-top: 1em">Similarly,
include expressions are supplied to <b>GNU&minus;tar</b>'s
<b>&minus;&minus;files&minus;from</b> option. This option
ordinarily does not accept any sort of wildcards, but amgtar
&quot;manually&quot; applies glob pattern matching to
include expressions with only one slash. The expressions
must still begin with &quot;./&quot;, so this effectively
only allows expressions like &quot;./[abc]*&quot; or
&quot;./*.txt&quot;.</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">define
application&minus;tool app_amgtar { <br>
plugin &quot;amgtar&quot;</p>

<p style="margin-left:11%; margin-top: 1em">property
&quot;ATIME&minus;PRESERVE&quot; &quot;NO&quot; <br>
property &quot;CHECK&minus;DEVICE&quot; &quot;YES&quot; <br>
property &quot;GNUTAR&minus;LISTDIR&quot;
&quot;/path/to/listdir&quot; <br>
property &quot;GNUTAR&minus;PATH&quot; &quot;/bin/tar&quot;
<br>
property &quot;ONE&minus;FILE&minus;SYSTEM&quot;
&quot;YES&quot; <br>
property &quot;TAR&minus;BLOCKSIZE&quot; &quot;20&quot; <br>
property &quot;SPARSE&quot; &quot;YES&quot; <br>
property &quot;ACLS&quot; &quot;NO&quot; <br>
property &quot;SELINUX&quot; &quot;NO&quot; <br>
property &quot;XATTRS&quot; &quot;NO&quot; <br>
property &quot;EXIT&minus;HANDLING&quot; &quot;1=GOOD
2=BAD&quot; <br>
# change a default NORMAL regex to a STRANGE regex. <br>
property &quot;STRANGE&quot; &quot;: socket ignored$&quot;
<br>
# add three new IGNORE regex <br>
property &quot;IGNORE&quot; &quot;: Directory is new$&quot;
<br>
property append &quot;IGNORE&quot; &quot;: Directory has
been renamed&quot; <br>
property append &quot;IGNORE&quot; &quot;file changed as we
read it$&quot; <br>
} <br>
A dumptype using this application might look like:</p>

<p style="margin-left:11%; margin-top: 1em">define dumptype
amgtar_app_dtyp { <br>
global <br>
program &quot;APPLICATION&quot; <br>
application &quot;app_amgtar&quot; <br>
} <br>
Note that the <i>program</i> parameter must be set to
<i>&quot;APPLICATION&quot;</i> to use the <i>application</i>
parameter.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>amanda</b>(8),
<b>tar</b>(1), <b>amanda.conf</b>(5),
<b>amanda-applications</b>(7)</p>

<p style="margin-left:11%; margin-top: 1em">The Amanda
Wiki: : http://wiki.zmanda.com/</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Jean&minus;Louis
Martineau</b> &lt;martineau@zmanda.com&gt;</p>

<p style="margin-left:17%;">Zmanda, Inc.
(http://www.zmanda.com)</p>

<p style="margin-left:11%; margin-top: 1em"><b>Dustin J.
Mitchell</b> &lt;dustin@zmanda.com&gt;</p>

<p style="margin-left:17%;">Zmanda, Inc.
(http://www.zmanda.com)</p>
<hr>
</body>
</html>
