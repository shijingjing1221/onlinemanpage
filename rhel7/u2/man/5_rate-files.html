<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:13:13 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>rate-files</title>

</head>
<body>

<h1 align="center">rate-files</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">rate-files
&minus; Format of rate-files</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The rate-files
used by isdnlog(8) and by isdnrate(1) are textfiles defining
the telephone fees for different destinations at certain
dates/times for all providers of one country. <br>
The rate-files have the following overall layout:</p>

<p style="margin-left:11%; margin-top: 1em"><i>Header
entries</i></p>

<p style="margin-left:11%; margin-top: 1em"><i>Provider
entries</i></p>

<p style="margin-left:11%; margin-top: 1em">Comments
starting with a hash-sign &rsquo;#&rsquo; and empty lines
are ignored. The first letter (tag) followed by a colon
separates the entries. Additional white space may be used
after the tags to group content more readably.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Special
entries <br>
I:includefile</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>i:includefile</b></p>


<p style="margin-left:22%; margin-top: 1em"><i>includefile</i>
get&rsquo;s substituted at the current position. There are
two possibilities. In the rate source file (which is
prepared by <i>pp_rate</i>) a small <i>&rsquo;i&rsquo;</i>
puts the contents of the include file in the outputfile. An
<i>&rsquo;I&rsquo;</i>-Tag means, for the preprocessor,
write a new output file (the includefile) and leave the tag
in the rate-files. This is for real include files. <br>
Includes may be nested twice. The filename should not
contain any paths (except for &rsquo;i&rsquo; of course),
they are taken relative to their parent file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Header
entries <br>
V:versionsstring</b></p>

<p style="margin-left:22%; margin-top: 1em">e.g.
V:1.0-Germany [18-Mar-1999]</p>


<p style="margin-left:11%; margin-top: 1em"><b>S:Servicename</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>N:Servicenumber[,Servicenumber...]</b></p>

<p style="margin-left:22%; margin-top: 1em">This defines
telephone services with special numbers. Special numbers are
numbers which a) start with no &rsquo;0&rsquo; or b) can not
be dialed with every provider. A number with a variable
length should have the wildcard &rsquo;*&rsquo; at the end,
eg. <i>07189*</i> which matches all numbers starting with
<i>07189</i>. Numbers with wildcards should be placed after
numbers which would match the wildcard, because matching is
done straight top down. There may be multiple <b>N:</b> tags
for one telephone service.</p>

<p style="margin-left:22%; margin-top: 1em">e.g. <br>
S:Internet <br>
N:07189*,19430 <br>
N:19440</p>


<p style="margin-left:11%; margin-top: 1em"><b>U:currencyfmt
currency</b></p>

<p style="margin-left:22%; margin-top: 1em">If the first
char of <i>currencyfmt</i> is ^, the amount is multiplied by
100 before it is displayed without leading ^.</p>

<p style="margin-left:22%; margin-top: 1em">e.g. (one of
these, &cent; = cent) <br>
U:%.3f EUR <br>
U:^%.3f &cent;</p>


<p style="margin-left:11%; margin-top: 1em"><b>X:num_wildcard
= provider[zZone] [,...]</b></p>

<p style="margin-left:22%; margin-top: 1em">Define
exception. If a certain number is always routed to a certain
provider and not to the preselected provider, you should use
this tag. <br>
e.g. in Austria, online service numbers 194x or 07189 go
always via Telekom, ignoring your preselection: <br>
X: 194*=1,07189*=1 <br>
or</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="22%"></td>
<td width="-14%">


<p>X: 194*=1z6</p></td>
<td width="15%"></td>
<td width="8%"></td>
<td width="69%">


<p># Provider 1 Zone 6</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Provider
entries</b> <br>
A new provider starts always with a <b>P:</b> tag and
consists of a <i>Providerheader</i> followed by
<i>Providerzones.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>Providerheader
<br>
P:</b>[<b>daterange</b>] <b>providernumber
providername</b></p>


<p style="margin-left:22%; margin-top: 1em"><i>daterange</i>
is <b>[</b>[<b>fromDate</b>][<b>-toDate</b>]<b>]</b> <br>
This defines a time range for the validity of rates for this
provider. Dates have to be numeric in format
<b>dd.mm.yyyy</b>. Note: as time is assumed as 00:00, take
for <i>toDate</i> the day+1. The daterange has to be
enclosed in square brackets. Either <i>fromDate</i> or
<i>-toDate</i> or both may be given. <br>
The <i>providernumber</i> may be a simple number, normally
the last digits of the VBN-number, or
<b>providernumber,variant</b> if a provider has different
connection fees. <br>
e.g. <br>
P:02 UTA <br>
or <br>
P:[01.01.1999] 1,1 Telekom Minimumfee</p>


<p style="margin-left:11%; margin-top: 1em"><b>B:vbn</b></p>

<p style="margin-left:11%; margin-top: 1em">VBN-Number for
provider</p>

<p style="margin-left:22%; margin-top: 1em">e.g. B:1002
<br>
This is the number to select this provider and depends on
your country.</p>

<p style="margin-left:11%; margin-top: 1em"><b>C:COMMENT:
comment</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>COMMENT</b>
may be an arbitrary string, but the following entries are
used already:</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-134291.png" alt="Image grohtml-134291.png"></p>

<p style="margin-left:11%; margin-top: 1em">If there are
multiple comments with the same comment name, they get
appended separated by a newline char.</p>


<p style="margin-left:11%; margin-top: 1em"><b>D:zone</b></p>

<p style="margin-left:11%; margin-top: 1em">Name of zone
file (inserted for <b>%s</b> in ZONEFILE =
/usr/lib/isdn/zone-<i>CC</i>-%s.dat from isdn.conf)</p>

<p style="margin-left:22%; margin-top: 1em">e.g. D:1001 #
zone file is zone-at-1001.gdbm</p>

<p style="margin-left:11%; margin-top: 1em">Note: if the
provider has no different domestic zones, you should not
define a D:tag.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Providerzones</b>
<br>
A Providerzone entry starts with a <b>Z:</b> tag followed by
one or more <b>A:</b> and <b>T:</b> tags.</p>

<p style="margin-left:11%; margin-top: 1em">A zone is a
region of areas, for which the same rates apply. Domestic
and foreign zones should not be mixed and all foreign zones
should follow domestic zones.</p>

<p style="margin-left:11%; margin-top: 1em"><b>R:prov, sub
; zonelist</b></p>

<p style="margin-left:11%; margin-top: 1em">Read zones from
provider <i>prov</i> subprovider number <i>sub</i>. A
<i>zonelist</i> is defined below. If the referenced provider
doesn&rsquo;t have a subprovider number, the <i>sub</i> must
be -1. The referenced provider may be defined before or
after the R:-tag. The referenced zones must be real
Z:-entries, not references themself. The zone numbers and
names are taken from the referenced provider. The last
<i>to_zone</i> may be missing then all zones from the start
zone are used. <br>
e.g. <br>
R:1,1 ; 1-4,6, 10-</p>

<p style="margin-left:11%; margin-top: 1em">There some
limitations: <br>
The reference cannot be more exact than the referenced
providerzones. R:42,0;1 will not work as desired if P:42,0
defines Z:1-4. <br>
It is not possible to reference a providerzone without areas
when the default domestic zone (with your countrycode as
area) is not included in the same range of referenced zones.
This applies mainly to zones for different distances in the
national fixed network, e.g. Z:1-3 in Germany.</p>

<p style="margin-left:11%; margin-top: 1em"><b>r:prov, sub
; start_zone-</b></p>

<p style="margin-left:11%; margin-top: 1em">This tag is
related to the R:-tag. It is interpreted by the
rate-preprocessor <i>pp_rate</i>. All providerzones with a
zone number greater or equal <i>start_zone</i> are copied
from provider <i>prov[,sub]</i> and replace the r:-tag. If
an <i>area</i> is already used in a previous providerzone of
the current provider, it will not be copied. If all areas of
a providerzone are already defined, the entire zone will not
be copied. Lines that contain only comments are also not
copied, but comments at the end of other lines are.</p>

<p style="margin-left:11%; margin-top: 1em">This tag is
designed for providers with a rate variant that offers
different fees for some foreign destinations.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Z:zonelist
zonename</b></p>

<p style="margin-left:11%; margin-top: 1em">where
<i>zonelist</i> is
<b>zone</b>[<b>-to_zone</b>][<b>,...</b>]</p>

<p style="margin-left:22%; margin-top: 1em">e.g. Z:1-2,4
Interior</p>


<p style="margin-left:11%; margin-top: 1em"><b>A:area</b>[<b>,area...</b>]</p>

<p style="margin-left:11%; margin-top: 1em"><i>area</i> may
be a telephone number (including +countrycode for numbers
which may be reached from everywhere, a telephone number
without +countrycode for numbers only reachable in the own
country) or an area name or alias as defined in country.dat.
Country names have to be translated to their code by the
rate-preprocessor <i>pp_rate</i>.</p>

<p style="margin-left:22%; margin-top: 1em">e.g.
A:19430,07189 # Online</p>

<p style="margin-left:22%; margin-top: 1em">e.g.
A:+31,Belgium # Int 1</p>

<p style="margin-left:11%; margin-top: 1em">Note: There
should always be exactly one zone with your countrycode or
countryname respectively:</p>

<p style="margin-left:22%; margin-top: 1em">Z:4 <br>
A:+49 <br>
T:...</p>

<p style="margin-left:11%; margin-top: 1em">Countrynames
like <i>Belgium</i> in the above example are replaced by
their ISO-Code (or TLD) with the rate preprocessor
<i>pp_rate</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>T:</b>[<b>daterange</b>]<b>daylist/timelist</b>[<b>!</b>]<b>=chargelist
chargename</b></p>

<p style="margin-left:11%; margin-top: 1em">where
<i>daterange</i> is
<b>[</b>[<b>fromDate</b>][<b>-toDate</b>]<b>]</b> like the
corresonding provider entry. Note that the <i>daterange</i>
is enclosed in sqare brackets, either <i>fromDate</i> or
<i>-toDate</i> are optional.</p>

<p style="margin-left:11%; margin-top: 1em"><i>daylist</i>
is <b>day</b>[<b>-day</b>][<b>,...</b>] and day is a
daynumber (1=Mon, 2=Tue, ...) or W (workday, Monday to
Friday), E (weekend), H (holiday) or * (everyday). If more
than one of these days match a given date, the following
order of priority (highest first) applies: H 7 .. 1 E W
*.</p>


<p style="margin-left:11%; margin-top: 1em"><i>timelist</i>
is <b>hour</b>[<b>-hour</b>][<b>,hour</b>] where hour is a
number 0..23 or * for everytime.</p>

<p style="margin-left:11%; margin-top: 1em">After
<i>daylist/timelist</i> follows <b>=</b> or <b>!=</b> which
means, provider doesn&rsquo;t adjust rates on a rate
boundary e.g. at 18h00.</p>

<p style="margin-left:11%; margin-top: 1em">A
<i>chargelist</i> consists of</p>


<p style="margin-left:11%; margin-top: 1em">[<b>MinCharge|</b>]<b>Charge</b>[<b>(Divider)</b>]<b>/Duration</b>[<b>:Delay</b>][<b>/Duration...</b>]</p>

<p style="margin-left:11%; margin-top: 1em">where
<i>MinCharge|</i> is an (optional) minimum charge,
<i>Charge</i> the rate per <i>Duration</i> seconds or
optional rate per <i>(Divider)</i> seconds, <i>Duration</i>
is the length of one charge unit in seconds. After
<i>Delay</i> the next duration is taken. If delay is not
given it equals to the duration. The last duration may not
have a delay and may not be zero.</p>

<p style="margin-left:22%; margin-top: 1em">EXAMPLES <br>
T:1-4/8-18=1.5(60)/60/1 workday</p>

<p style="margin-left:22%; margin-top: 1em">Monday until
Thursday, daytime the charge is 1.50 per minute, first
charge is for one minute after this charging is calculated
in seconds interval.</p>


<p style="margin-left:22%; margin-top: 1em">T:W/18-8=0.30|1.2(60)/1
night</p>

<p style="margin-left:22%; margin-top: 1em">On workdays,
night, charge is the bigger of 1.20 per minute or 0.30</p>


<p style="margin-left:22%; margin-top: 1em">T:*/*=0.50/0,1(60)/1
always</p>

<p style="margin-left:22%; margin-top: 1em">Everyday,
everytime there is a connection fee of 0.50, then charge is
1 per minute.</p>


<p style="margin-left:22%; margin-top: 1em">T:H/*=0.5/60:600,0.5/30
holidays</p>

<p style="margin-left:22%; margin-top: 1em">On holidays,
everytime a charge of 0.5 per minute in a minutes interval,
after 10 minutes 0.5 per half minute in half a minutes
interval.</p>


<p style="margin-left:22%; margin-top: 1em">T:*/*=1.3/0,0/1</p>

<p style="margin-left:22%; margin-top: 1em">Everyday,
everytime the charge is 1.30 independent of duration, which
could also be written as T:*/*=1.3|0/1.</p>

<p style="margin-left:22%; margin-top: 1em">T:
[-01.02.2000] */17-19=0.79(60)/60/1 Happy Hour <br>
T: [-01.02.2000] */19-17=0.90(60)/60/1 Normal</p>

<p style="margin-left:22%; margin-top: 1em">Until the first
of Feb 0:00h (i.e. end is 31.1.2000 24:00), everyday between
17 and 19h a charge of 0.79 per minute, the first minute is
always charged fully, after this, charging is calculated in
seconds interval. <br>
The second entry defines a charge of 0.90 in the time
outside the happy hour.</p>


<p style="margin-left:22%; margin-top: 1em">T:[15.11.1999-01.02.2000]*/17-19=0.79(60)/60/1
HH</p>

<p style="margin-left:22%; margin-top: 1em">Like above, but
a full date range is given.</p>

<p style="margin-left:11%; margin-top: 1em">The next two
t:-tags are interpreted by <i>pp_rate</i> and replaced by
one or more T:-lines. Both methods can be used together.</p>


<p style="margin-left:11%; margin-top: 1em"><b>t:[daterange]?[H]=chargelist
chargename</b></p>

<p style="margin-left:11%; margin-top: 1em">This line is
replaced by according T:-lines for not yet defined
<i>day/hour</i> pairs.</p>

<p style="margin-left:11%; margin-top: 1em">If a
<i>daterange</i> is given, only previous T:-lines without a
daterange or with the same daterange will be considered as
earlier definitions. If <i>H</i> is noted, definitions will
also be added for holidays.</p>

<p style="margin-left:22%; margin-top: 1em">EXAMPLE <br>
T:W/08-18=0.10/60 normal time <br>
t:?H=0.04/60 save time</p>

<p style="margin-left:22%; margin-top: 1em">This lines will
lead to the following lines after <i>pp_rate</i>:</p>


<p style="margin-left:22%; margin-top: 1em">T:W/08-18=0.10/60
normal time <br>
T:W/18-08=0.04/60 save time <br>
T:E,H/*=0.04 save time</p>


<p style="margin-left:11%; margin-top: 1em"><b>t:daterange=srcrange
[chargename]</b></p>

<p style="margin-left:11%; margin-top: 1em">Generates
T:-lines for <i>daterange</i> by copying previous T:-lines
with <i>srcrange</i> in the same zone. If a
<i>chargename</i> is given, it will replace the chargename
of the originating line. <i>srcrange</i> can be shortened as
long as it remains definite.</p>

<p style="margin-left:22%; margin-top: 1em">EXAMPLE <br>
T:[-24.12.2003]W/*=0.08/60 on workdays <br>
T:[-24.12.2003]E,H/*=0.06 weekend <br>
T:[24.12.2003-25.12.2003]*/*=0.04 Christmas Eve <br>
t:[25.12.2003-31.12.2003]=[-24.12.2003] <br>
t:[31.12.2003-01.01.2004]=[24.12.] New Year&rsquo;s Eve <br>
t:[01.01.2004]=[-24.12.]</p>

<p style="margin-left:22%; margin-top: 1em">This will be
transformed into:</p>


<p style="margin-left:22%; margin-top: 1em">T:[-24.12.2003]W/*=0.08/60
on workdays <br>
T:[-24.12.2003]E,H/*=0.06/60 weekend <br>
T:[24.12.2003-25.12.2003]*/*=0.04/60 Christmas Eve <br>
T:[25.12.2003-31.12.2003]W/*=0.08/60 on workdays <br>
T:[25.12.2003-31.12.2003]E,H/*=0.06/60 weekend <br>
T:[31.12.2003-01.01.2004]=0.04/60 New Years&rsquo; Eve <br>
T:[01.01.2004]W/*=0.08/60 on workdays <br>
T:[01.01.2004]E,H/*=0.06/60 weekend</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>isdnlog(8)</i>,
<i>isdnrate(1)</i>, <i>rate.conf(5)</i>, isdnlog/README,
rate-at.dat</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Leopold Toetsch
&lt;lt@toetsch.at&gt; (of this man page of course). Tobias
Becker &lt;tobiasb@isdn4linux.de&gt; added the tags r: and
t:.</p>
<hr>
</body>
</html>
