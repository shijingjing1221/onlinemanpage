<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:12:59 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>QMC_GROUP</title>

</head>
<body>

<h1 align="center">QMC_GROUP</h1>

<a href="#NAME">NAME</a><br>
<a href="#C++ SYNOPSIS">C++ SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONSTRUCTORS &amp; DESTRUCTOR">CONSTRUCTORS &amp; DESTRUCTOR</a><br>
<a href="#CONTEXTS">CONTEXTS</a><br>
<a href="#METRICS">METRICS</a><br>
<a href="#TIMEZONES">TIMEZONES</a><br>
<a href="#DEBUGGING">DEBUGGING</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>QmcGroup</b>
&minus; container representing a single fetch group of
metrics from multiple sources</p>

<h2>C++ SYNOPSIS
<a name="C++ SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;QmcGroup.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>CC ...
&minus;lqmc &minus;lpcp</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A
<b>QmcGroup</b> object is a container for contexts and
metrics that should be fetched at the same time. The class
manages the <b>QmcContext</b>(3) objects, timezones and
bounds for every context created with <b>QmcGroup::use</b>
and <b>QmcGroup::addMetric</b>.</p>

<h2>CONSTRUCTORS &amp; DESTRUCTOR
<a name="CONSTRUCTORS &amp; DESTRUCTOR"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>~QmcGroup();</b></p>

<p style="margin-left:17%;">Destructor which destroys all
metrics and contexts created by this group.</p>

<p style="margin-left:11%;"><b>QmcGroup(bool
restrictArchives = false);</b></p>

<p style="margin-left:17%;">Construct a new fetch group.
<i>restrictArchives</i> will restrict the creating of
multiple archive contexts created from the same host.</p>

<h2>CONTEXTS
<a name="CONTEXTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The default
context of the group is defined as the first context created
with <b>QmcGroup::use</b> before the first call to
<b>QmcGroup::addMetric</b>. If no context is created before
the first metric is added, the localhost is used as the
default context. Therefore, if any metrics specifications
contain archive sources, an archive source must have been
created with <b>QmcGroup::use</b> to avoid an error for
mixing context types. <b><br>
uint_t numContexts() const;</b></p>

<p style="margin-left:17%;">The number of valid contexts
created in this group.</p>

<p style="margin-left:11%;"><b>QmcContext const&amp;
context(uint_t index) const</b></p>

<p style="margin-left:17%;">Return a handle to a
context.</p>

<p style="margin-left:11%;"><b>QmcContext&amp;
context(uint_t index);</b></p>

<p style="margin-left:17%;">Return a modifiable handle to a
context.</p>

<p style="margin-left:11%;"><b>int mode() const;</b></p>

<p style="margin-left:17%;">Return the type of context,
either <b>PM_CONTEXT_LOCAL</b>, <b>PM_CONTEXT_HOST</b> or
<b>PM_CONTEXT_ARCHIVE</b>.</p>

<p style="margin-left:11%;"><b>QmcContext* which()
const;</b></p>

<p style="margin-left:17%;">Return a handle to the current
context of this group. This does not call
<b>pmUseContext</b>(3) so it may not be the current
<b>PMAPI</b>(3) context.</p>

<p style="margin-left:11%;"><b>uint_t whichIndex()
const</b></p>

<p style="margin-left:17%;">The index to the current group
context.</p>

<p style="margin-left:11%;"><b>int use(int type, char
const* source);</b></p>

<p style="margin-left:17%;">Use the context of <i>type</i>
from <i>source</i>. If a context to this <i>source</i>
already exists in this group, that context will become the
current <b>PMAPI</b>(3) context. Otherwise a new context
will be created. The result is the <b>PMAPI</b>(3) context
handle for the <b>QmcGroup::context</b> or a <b>PMAPI</b>(3)
error code if the context failed.</p>

<p style="margin-left:11%;"><b>bool defaultDefined()
const;</b></p>

<p style="margin-left:17%;">Returns <b>true</b> if a
default context has been determined.</p>

<p style="margin-left:11%;"><b>int useDefault();</b></p>

<p style="margin-left:17%;">Use the default context. If a
default context has not been created, the context to the
local host will be attempted. A result less than zero
indicates that the method failed with the <b>PMAPI</b>(3)
error encoded in the result.</p>

<p style="margin-left:11%;"><b>void
createLocalContext();</b></p>

<p style="margin-left:17%;">Create and use a context to the
local host. A result less than zero indicates that the
method failed with the <b>PMAPI</b>(3) error encoded in the
result.</p>

<h2>METRICS
<a name="METRICS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">These
<b>addMetric</b> methods should be used to create new
metrics as the <b>QmcMetric</b> constructors are private.
These methods will always return a pointer to a
<b>QmcMetric</b> object, however the
<b>QmcMetric::status()</b> field should be checked to ensure
the metric is valid. <b><br>
QmcMetric* addMetric(char const* str, double theScale =
0.0,</b></p>

<p style="margin-left:17%;"><b>bool active =
false);</b></p>

<p style="margin-left:17%; margin-top: 1em">Add the metric
<i>str</i> to the group, with a scaling factor of
<i>scale</i>. If <i>active</i> is set the metric will use
only active instances (see <b>QmcMetric</b>(3)).</p>

<p style="margin-left:11%;"><b>QmcMetric*
addMetric(pmMetricSpec* theMetric, double theScale</b></p>

<p style="margin-left:17%;"><b>= 0.0, bool active);</b></p>

<p style="margin-left:17%; margin-top: 1em">Add the metric
<i>theMetric</i> to the group, with a scaling factor of
<i>scale</i>. If <i>active</i> is set the metric will use
only active instances (see <b>QmcMetric</b>(3)).</p>

<p style="margin-left:11%;"><b>int fetch(bool update =
true);</b></p>

<p style="margin-left:17%;">Fetch all the metrics in all
the contexts in this group. If <i>update</i> is equal to
<b>true</b>, all counter metrics will be automatically
converted to rates (see <b>QmcMetric</b>(3)).</p>

<p style="margin-left:11%;"><b>int setArchiveMode(int mode,
const struct timeval *when,</b></p>

<p style="margin-left:17%;"><b>int interval);</b></p>

<p style="margin-left:17%; margin-top: 1em">Set the mode
and time to access all archive contexts in this group. See
<b>pmSetmode</b>(3) for more details.</p>

<h2>TIMEZONES
<a name="TIMEZONES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">These methods
assist in the management of multiple timezones and help to
control the current timezone. <b><br>
enum TimeZoneFlag { localTZ, userTZ, groupTZ, unknownTZ
};</b></p>

<p style="margin-left:17%;">Enumeration used to describe
the origin of the default timezone. <b>localTZ</b>,
<b>userTZ</b> and <b>groupTZ</b> indicate that the timezone
was set with <b>QmcGroup::useLocalTZ</b>,
<b>QmcGroup::useTZ(QString const&amp;)</b> and
<b>QmcGroup::useTZ()</b> respectively. <b>unknownTZ</b>
indicates that a timezone has not been set. <b>userTZ</b>
indicates that the timezone was</p>

<p style="margin-left:11%;"><b>int useTZ();</b></p>

<p style="margin-left:17%;">Use the timezone of the current
group context as the default.</p>

<p style="margin-left:11%;"><b>int useTZ(const QString
&amp;tz);</b></p>

<p style="margin-left:17%;">Add and use <i>tz</i> as the
default timezone of this group.</p>

<p style="margin-left:11%;"><b>int useLocalTZ();</b></p>

<p style="margin-left:17%;">Use the timezone of the
localhost as the default for this group.</p>

<p style="margin-left:11%;"><b>void defaultTZ(QString
&amp;label, QString &amp;tz);</b></p>

<p style="margin-left:17%;">Return the <i>label</i> and
<i>tz</i> string of the default timezone of this group.</p>

<p style="margin-left:11%;"><b>TimeZoneFlag defaultTZ()
const</b></p>

<p style="margin-left:17%;">Return the origin of the
default timezone.</p>

<p style="margin-left:11%;"><b>int useDefaultTZ();</b></p>

<p style="margin-left:17%;">Set the timezone to be the
default timezone as defined in a previous call to
<b>QmcGroup::useTZ</b> or <b>QmcGroup::useLocalTZ</b>.</p>

<p style="margin-left:11%;"><b>struct timeval const&amp;
logStart() const;</b></p>

<p style="margin-left:17%;">Return the earliest starting
time of any archives in this group. Assumes that
<b>QmcGroup::updateBounds</b> has been called.</p>

<p style="margin-left:11%;"><b>struct timeval const&amp;
logEnd() const;</b></p>

<p style="margin-left:17%;">Return the latest finish time
of any archives in this group. Assumes that
<b>QmcGroup::updateBounds</b> has been called.</p>

<p style="margin-left:11%;"><b>void updateBounds();</b></p>

<p style="margin-left:17%;">Determine the earliest start
and latest finish times of all archives in this group.</p>

<p style="margin-left:11%;"><b>int sendTimezones();</b></p>

<p style="margin-left:17%;">Send the current timezones to
<b>kmtime (3).</b></p>

<h2>DEBUGGING
<a name="DEBUGGING"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>void
dump(ostream &amp;os);</b></p>

<p style="margin-left:17%;">Dump state information about
this group to <i>os</i>.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>PMAPI</b>(3),
<b>QMC</b>(3), <b>QmcContext</b>(3), <b>QmcMetric</b>(3),
<b>pmflush</b>(3), <b>pmprintf</b>(3) and
<b>pmSetMode</b>(3).</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Error messages
are generated using <b>pmprintf</b>(3) but are not flushed.
It is the responsibility of the user to call
<b>pmflush</b>(3) to output any messages.</p>

<p style="margin-left:11%; margin-top: 1em">Additional
diagnostics may be activated by adding <b>DBG_TRACE_PMC</b>
to the global <i>pmDebug</i>.</p>
<hr>
</body>
</html>
