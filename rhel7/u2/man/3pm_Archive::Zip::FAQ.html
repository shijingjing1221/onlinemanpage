<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 01:14:24 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Archive::Zip::FAQ</title>

</head>
<body>

<h1 align="center">Archive::Zip::FAQ</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#Install problems on RedHat 8 or 9 with Perl 5.8.0">Install problems on RedHat 8 or 9 with Perl 5.8.0</a><br>
<a href="#Why is my zip file so big?">Why is my zip file so big?</a><br>
<a href="#Sample code?">Sample code?</a><br>
<a href="#Can&rsquo;t Read/modify/write same Zip file">Can&rsquo;t Read/modify/write same Zip file</a><br>
<a href="#File creation time not set">File creation time not set</a><br>
<a href="#Can&rsquo;t use Archive::Zip on gzip files">Can&rsquo;t use Archive::Zip on gzip files</a><br>
<a href="#Add a directory/tree to a Zip">Add a directory/tree to a Zip</a><br>
<a href="#Extract a directory/tree">Extract a directory/tree</a><br>
<a href="#Update a directory/tree">Update a directory/tree</a><br>
<a href="#Zip times might be off by 1 second">Zip times might be off by 1 second</a><br>
<a href="#Zip times don&rsquo;t include time zone information">Zip times don&rsquo;t include time zone information</a><br>
<a href="#How do I make a self-extracting Zip">How do I make a self-extracting Zip</a><br>
<a href="#How can I deal with Zips with prepended garbage (i.e. from Sircam)">How can I deal with Zips with prepended garbage (i.e. from Sircam)</a><br>
<a href="#Can&rsquo;t extract Shrunk files">Can&rsquo;t extract Shrunk files</a><br>
<a href="#Can&rsquo;t do decryption">Can&rsquo;t do decryption</a><br>
<a href="#How to test file integrity?">How to test file integrity?</a><br>
<a href="#Duplicate files in Zip?">Duplicate files in Zip?</a><br>
<a href="#File ownership/permissions/ACLS/etc">File ownership/permissions/ACLS/etc</a><br>
<a href="#I can&rsquo;t compile but ActiveState only has an old version of Archive::Zip">I can&rsquo;t compile but ActiveState only has an old version of Archive::Zip</a><br>
<a href="#My JPEGs (or MP3&rsquo;s) don&rsquo;t compress when I put them into Zips!">My JPEGs (or MP3&rsquo;s) don&rsquo;t compress when I put them into Zips!</a><br>
<a href="#Under Windows, things lock up/get damaged">Under Windows, things lock up/get damaged</a><br>
<a href="#Zip contents in a scalar">Zip contents in a scalar</a><br>
<a href="#Reading from streams">Reading from streams</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Archive::Zip::FAQ
&minus; Answers to a few frequently asked questions about
Archive::Zip</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">It seems that I
keep answering the same questions over and over again. I
assume that this is because my documentation is deficient,
rather than that people don&rsquo;t read the
documentation.</p>

<p style="margin-left:11%; margin-top: 1em">So this
<small>FAQ</small> is an attempt to cut down on the number
of personal answers I have to give. At least I can now say
&quot;You <i>did</i> read the <small>FAQ,</small>
right?&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">The questions
are not in any particular order. The answers assume the
current version of Archive::Zip; some of the answers depend
on newly added/fixed functionality.</p>

<h2>Install problems on RedHat 8 or 9 with Perl 5.8.0
<a name="Install problems on RedHat 8 or 9 with Perl 5.8.0"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b>
Archive::Zip won&rsquo;t install on my RedHat 9 system!
It&rsquo;s broke!</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> This
has become something of a <small>FAQ.</small> Basically,
RedHat broke some versions of Perl by setting
<small>LANG</small> to <small>UTF8.</small> They apparently
have a fixed version out as an update.</p>

<p style="margin-left:11%; margin-top: 1em">You might try
running <small>CPAN</small> or creating your Makefile after
exporting the <small>LANG</small> environment variable
as</p>


<p style="margin-left:11%; margin-top: 1em"><tt>&quot;LANG=C&quot;</tt></p>


<p style="margin-left:11%; margin-top: 1em">&lt;https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=87682&gt;</p>

<h2>Why is my zip file so big?
<a name="Why is my zip file so big?"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> My
zip file is actually bigger than what I stored in it!
Why?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> Some
things to make sure of: <br>
Make sure that you are requesting
<small>COMPRESSION_DEFLATED</small> if you are <br>
storing strings.</p>


<p style="margin-left:17%;"><tt>$member</tt>&minus;&gt;desiredCompressionMethod(
<small>COMPRESSION_DEFLATED</small> );</p>

<p style="margin-left:11%;">Don&rsquo;t make lots of little
files if you can help it.</p>

<p style="margin-left:17%;">Since zip computes the
compression tables for each member, small members without
much entropy won&rsquo;t compress well. Instead, if
you&rsquo;ve got lots of repeated strings in your data, try
to combine them into one big member.</p>

<p style="margin-left:11%;">Make sure that you are
requesting <small>COMPRESSION_STORED</small> if you are
storing <br>
things that are already compressed.</p>

<p style="margin-left:17%;">If you&rsquo;re storing a .zip,
.jpg, .mp3, or other compressed file in a zip, then
don&rsquo;t compress them again. They&rsquo;ll get
bigger.</p>

<h2>Sample code?
<a name="Sample code?"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> Can
you send me code to do (whatever)?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> Have
you looked in the <tt>&quot;examples/&quot;</tt> directory
yet? It contains: <br>
examples/calcSizes.pl -- How to find out how big a Zip file
will be <br>
before writing it <br>
examples/copy.pl -- Copies one Zip file to another <br>
examples/extract.pl -- extract file(s) from a Zip <br>
examples/mailZip.pl -- make and mail a zip file <br>
examples/mfh.pl -- demo for use of MockFileHandle <br>
examples/readScalar.pl -- shows how to use IO::Scalar as the
source <br>
of a Zip read <br>
examples/selfex.pl -- a brief example of a self-extracting
Zip <br>
examples/unzipAll.pl -- uses Archive::Zip::Tree to unzip an
entire <br>
Zip <br>
examples/updateZip.pl -- shows how to read/modify/write a
Zip <br>
examples/updateTree.pl -- shows how to update a Zip in place
<br>
examples/writeScalar.pl -- shows how to use IO::Scalar as
the <br>
destination of a Zip write <br>
examples/writeScalar2.pl -- shows how to use IO::String as
the <br>
destination of a Zip write <br>
examples/zip.pl -- Constructs a Zip file <br>
examples/zipcheck.pl -- One way to check a Zip file for
validity <br>
examples/zipinfo.pl -- Prints out information about a Zip
archive <br>
file <br>
examples/zipGrep.pl -- Searches for text in Zip files <br>
examples/ziptest.pl -- Lists a Zip file and checks member
CRCs <br>
examples/ziprecent.pl -- Puts recent files into a zipfile
<br>
examples/ziptest.pl -- Another way to check a Zip file for
<br>
validity</p>

<h2>Can&rsquo;t Read/modify/write same Zip file
<a name="Can&rsquo;t Read/modify/write same Zip file"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> Why
can&rsquo;t I open a Zip file, add a member, and write it
back? I get an error message when I try.</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b>
Because Archive::Zip doesn&rsquo;t (and can&rsquo;t,
generally) read file contents into memory, the original Zip
file is required to stay around until the writing of the new
file is completed.</p>

<p style="margin-left:11%; margin-top: 1em">The best way to
do this is to write the Zip to a temporary file and then
rename the temporary file to have the old name (possibly
after deleting the old one).</p>

<p style="margin-left:11%; margin-top: 1em">Archive::Zip
v1.02 added the archive methods
<tt>&quot;overwrite()&quot;</tt> and
<tt>&quot;overwriteAs()&quot;</tt> to do this simply and
carefully.</p>

<p style="margin-left:11%; margin-top: 1em">See
<tt>&quot;examples/updateZip.pl&quot;</tt> for an example of
this technique.</p>

<h2>File creation time not set
<a name="File creation time not set"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> Upon
extracting files, I see that their modification (and access)
times are set to the time in the Zip archive. However, their
creation time is not set to the same time. Why?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b>
Mostly because Perl doesn&rsquo;t give cross-platform access
to <i>creation time</i>. Indeed, many systems (like Unix)
don&rsquo;t support such a concept. However, if yours does,
you can easily set it. Get the modification time from the
member using <tt>&quot;lastModTime()&quot;</tt>.</p>

<h2>Can&rsquo;t use Archive::Zip on gzip files
<a name="Can&rsquo;t use Archive::Zip on gzip files"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> Can I
use Archive::Zip to extract Unix gzip files?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b>
No.</p>

<p style="margin-left:11%; margin-top: 1em">There is a
distinction between Unix gzip files, and Zip archives that
also can use the gzip compression.</p>

<p style="margin-left:11%; margin-top: 1em">Depending on
the format of the gzip file, you can use
Compress::Raw::Zlib, or Archive::Tar to decompress it (and
de-archive it in the case of Tar files).</p>

<p style="margin-left:11%; margin-top: 1em">You can unzip
PKZIP/WinZip/etc/ archives using Archive::Zip (that&rsquo;s
what it&rsquo;s for) as long as any compressed members are
compressed using Deflate compression.</p>

<h2>Add a directory/tree to a Zip
<a name="Add a directory/tree to a Zip"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
can I add a directory (or tree) full of files to a Zip?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> You
can use the Archive::Zip::addTree*() methods:</p>

<pre style="margin-left:11%; margin-top: 1em">   use Archive::Zip;
   my $zip = Archive::Zip&minus;&gt;new();
   # add all readable files and directories below . as xyz/*
   $zip&minus;&gt;addTree( '.', 'xyz' );
   # add all readable plain files below /abc as def/*
   $zip&minus;&gt;addTree( '/abc', 'def', sub { &minus;f &amp;&amp; &minus;r } );
   # add all .c files below /tmp as stuff/*
   $zip&minus;&gt;addTreeMatching( '/tmp', 'stuff', '\.c$' );
   # add all .o files below /tmp as stuff/* if they aren't writable
   $zip&minus;&gt;addTreeMatching( '/tmp', 'stuff', '\.o$', sub { ! &minus;w } );
   # add all .so files below /tmp that are smaller than 200 bytes as stuff/*
   $zip&minus;&gt;addTreeMatching( '/tmp', 'stuff', '\.o$', sub { &minus;s &lt; 200 } );
   # and write them into a file
   $zip&minus;&gt;writeToFileNamed('xxx.zip');</pre>


<h2>Extract a directory/tree
<a name="Extract a directory/tree"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
can I extract some (or all) files from a Zip into a
different directory?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> You
can use the <i>Archive::Zip::extractTree()</i> method: ???
||</p>

<pre style="margin-left:11%; margin-top: 1em">   # now extract the same files into /tmpx
   $zip&minus;&gt;extractTree( 'stuff', '/tmpx' );</pre>


<h2>Update a directory/tree
<a name="Update a directory/tree"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
can I update a Zip from a directory tree, adding or
replacing only the newer files?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> You
can use the <i>Archive::Zip::updateTree()</i> method that
was added in version 1.09.</p>

<h2>Zip times might be off by 1 second
<a name="Zip times might be off by 1 second"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> It
bothers me greatly that my file times are wrong by one
second about half the time. Why don&rsquo;t you do something
about it?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> Get
over it. This is a result of the Zip format storing times in
<small>DOS</small> format, which has a resolution of only
two seconds.</p>

<h2>Zip times don&rsquo;t include time zone information
<a name="Zip times don&rsquo;t include time zone information"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> My
file times don&rsquo;t respect time zones. What gives?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> If
this is important to you, please submit patches to read the
various Extra Fields that encode times with time zones.
I&rsquo;m just using the <small>DOS</small> Date/Time, which
doesn&rsquo;t have a time zone.</p>

<h2>How do I make a self-extracting Zip
<a name="How do I make a self-extracting Zip"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> I
want to make a self-extracting Zip file. Can I do this?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> Yes.
You can write a self-extracting archive stub (that is, a
version of unzip) to the output filehandle that you pass to
<i>writeToFileHandle()</i>. See examples/selfex.pl for how
to write a self-extracting archive.</p>

<p style="margin-left:11%; margin-top: 1em">However, you
should understand that this will only work on one kind of
platform (the one for which the stub was compiled).</p>

<h2>How can I deal with Zips with prepended garbage (i.e. from Sircam)
<a name="How can I deal with Zips with prepended garbage (i.e. from Sircam)"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
can I tell if a Zip has been damaged by adding garbage to
the beginning or inside the file?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> I
added code for this for the Amavis virus scanner. You can
query archives for their &rsquo;eocdOffset&rsquo; property,
which should be 0:</p>

<pre style="margin-left:11%; margin-top: 1em">  if ($zip&minus;&gt;eocdOffset &gt; 0)
    { warn($zip&minus;&gt;eocdOffset . &quot; bytes of garbage at beginning or within Zip&quot;) }</pre>


<p style="margin-left:11%; margin-top: 1em">When members
are extracted, this offset will be used to adjust the start
of the member if necessary.</p>

<h2>Can&rsquo;t extract Shrunk files
<a name="Can&rsquo;t extract Shrunk files"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b>
I&rsquo;m trying to extract a file out of a Zip produced by
<small>PKZIP,</small> and keep getting this error
message:</p>

<pre style="margin-left:11%; margin-top: 1em">  error: Unsupported compression combination: read 6, write 0</pre>


<p style="margin-left:11%; margin-top: 1em"><b>A:</b> You
can&rsquo;t uncompress this archive member. Archive::Zip
only supports uncompressed members, and compressed members
that are compressed using the compression supported by
Compress::Raw::Zlib. That means only Deflated and Stored
members.</p>

<p style="margin-left:11%; margin-top: 1em">Your file is
compressed using the Shrink format, which isn&rsquo;t
supported by Compress::Raw::Zlib.</p>

<p style="margin-left:11%; margin-top: 1em">You could,
perhaps, use a command-line UnZip program (like the Info-Zip
one) to extract this.</p>

<h2>Can&rsquo;t do decryption
<a name="Can&rsquo;t do decryption"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
do I decrypt encrypted Zip members?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> With
some other program or library. Archive::Zip doesn&rsquo;t
support decryption, and probably never will (unless
<i>you</i> write it).</p>

<h2>How to test file integrity?
<a name="How to test file integrity?"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
can Archive::Zip can test the validity of a Zip file?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> If
you try to decompress the file, the gzip streams will report
errors if you have garbage. Most of the time.</p>

<p style="margin-left:11%; margin-top: 1em">If you try to
open the file and a central directory structure can&rsquo;t
be found, an error will be reported.</p>

<p style="margin-left:11%; margin-top: 1em">When a file is
being read, if we can&rsquo;t find a proper
<small>PK..</small> signature in the right places we report
a format error.</p>

<p style="margin-left:11%; margin-top: 1em">If there is
added garbage at the beginning of a Zip file (as inserted by
some viruses), you can find out about it, but Archive::Zip
will ignore it, and you can still use the archive. When it
gets written back out the added stuff will be gone.</p>

<p style="margin-left:11%; margin-top: 1em">There are two
ready-to-use utilities in the examples directory that can be
used to test file integrity, or that you can use as examples
for your own code: <br>
examples/zipcheck.pl shows how to use an attempted
extraction to test a <br>
file. <br>
examples/ziptest.pl shows how to test CRCs in a file.</p>

<h2>Duplicate files in Zip?
<a name="Duplicate files in Zip?"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b>
Archive::Zip let me put the same file in my Zip twice! Why
don&rsquo;t you prevent this?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> As
far as I can tell, this is not disallowed by the Zip spec.
If you think it&rsquo;s a bad idea, check for it
yourself:</p>

<pre style="margin-left:11%; margin-top: 1em">  $zip&minus;&gt;addFile($someFile, $someName) unless $zip&minus;&gt;memberNamed($someName);</pre>


<p style="margin-left:11%; margin-top: 1em">I can even
imagine cases where this might be useful (for instance,
multiple versions of files).</p>

<h2>File ownership/permissions/ACLS/etc
<a name="File ownership/permissions/ACLS/etc"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> Why
doesn&rsquo;t Archive::Zip deal with file ownership, ACLs,
etc.?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> There
is no standard way to represent these in the Zip file
format. If you want to send me code to properly handle the
various extra fields that have been used to represent these
through the years, I&rsquo;ll look at it.</p>

<h2>I can&rsquo;t compile but ActiveState only has an old version of Archive::Zip
<a name="I can&rsquo;t compile but ActiveState only has an old version of Archive::Zip"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b>
I&rsquo;ve only installed modules using ActiveState&rsquo;s
<small>PPM</small> program and repository. But they have a
much older version of Archive::Zip than is in
<small>CPAN.</small> Will you send me a newer
<small>PPM</small> ?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b>
Probably not, unless I get lots of extra time. But
there&rsquo;s no reason you can&rsquo;t install the version
from <small>CPAN.</small> Archive::Zip is pure Perl, so all
you need is <small>NMAKE,</small> which you can get for free
from Microsoft (see the <small>FAQ</small> in the
ActiveState documentation for details on how to install
<small>CPAN</small> modules).</p>

<h2>My JPEGs (or MP3&rsquo;s) don&rsquo;t compress when I put them into Zips!
<a name="My JPEGs (or MP3&rsquo;s) don&rsquo;t compress when I put them into Zips!"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
come my JPEGs and <small>MP3</small> &rsquo;s don&rsquo;t
compress much when I put them into Zips?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b>
Because they&rsquo;re already compressed.</p>

<h2>Under Windows, things lock up/get damaged
<a name="Under Windows, things lock up/get damaged"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b>
I&rsquo;m using Windows. When I try to use Archive::Zip, my
machine locks up/makes funny sounds/displays a BSOD/corrupts
data. How can I fix this?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b>
First, try the newest version of Compress::Raw::Zlib. I know
of Windows-related problems prior to v1.14 of that
library.</p>

<p style="margin-left:11%; margin-top: 1em">If that
doesn&rsquo;t get rid of the problem, fix your computer or
get rid of Windows.</p>

<h2>Zip contents in a scalar
<a name="Zip contents in a scalar"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> I
want to read a Zip file from (or write one to) a scalar
variable instead of a file. How can I do this?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> Use
<tt>&quot;IO::String&quot;</tt> and the
<tt>&quot;readFromFileHandle()&quot;</tt> and
<tt>&quot;writeToFileHandle()&quot;</tt> methods. See
<tt>&quot;examples/readScalar.pl&quot;</tt> and
<tt>&quot;examples/writeScalar.pl&quot;</tt>.</p>

<h2>Reading from streams
<a name="Reading from streams"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> How
do I read from a stream (like for the Info-Zip
<tt>&quot;funzip&quot;</tt> program)?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> This
isn&rsquo;t currently supported, though writing to a stream
is.</p>
<hr>
</body>
</html>
