<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 01:24:06 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Date::Manip::TZ</title>

</head>
<body>

<h1 align="center">Date::Manip::TZ</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#METHODS">METHODS</a><br>
<a href="#TIME ZONE INFORMATION IN DATE::MANIP">TIME ZONE INFORMATION IN DATE::MANIP</a><br>
<a href="#DETERMINING THE SYSTEM TIME ZONE">DETERMINING THE SYSTEM TIME ZONE</a><br>
<a href="#DESIGN ISSUES">DESIGN ISSUES</a><br>
<a href="#KNOWN PROBLEMS OR ISSUES">KNOWN PROBLEMS OR ISSUES</a><br>
<a href="#KNOWN BUGS">KNOWN BUGS</a><br>
<a href="#BUGS AND QUESTIONS">BUGS AND QUESTIONS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Date::Manip::TZ
&minus; an interface to the time zone data</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em">   use Date::Manip::TZ;
   $tz = new Date::Manip::TZ;</pre>


<p style="margin-left:11%; margin-top: 1em">Data for most
(and hopefully all) time zones used around the world have
been gathered and is publicly available in the zoneinfo (or
Olson) database.</p>

<p style="margin-left:11%; margin-top: 1em">This module
uses the data from the zoneinfo database to perform various
time zone operations.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Every time zone
has some of the following characteristics: <b><br>
name</b></p>

<p style="margin-left:17%;">Every time zone has a unique
name. In the zoneinfo database, these are something similar
to:</p>

<pre style="margin-left:17%; margin-top: 1em">   America/New_York</pre>


<p style="margin-left:11%;"><b>aliases</b></p>

<p style="margin-left:17%;">Time zones may have (but are
not required to have) one or more aliases. Each alias is
unique, and is not the same as any time zone name. An alias
can be used in exactly the same way as a name.</p>

<p style="margin-left:11%;"><b>periods</b></p>

<p style="margin-left:17%;">Every time zone is broken up
into periods. Each period describes how a portion of time
relates to <small>GMT,</small> and how it might be
expressed.</p>

<p style="margin-left:11%; margin-top: 1em">Each period
includes the following information: <b><br>
start time, end time</b></p>

<p style="margin-left:17%;">The period begin and ends at
certain times. The times are included both as an absolute
<small>GMT</small> time, and as a wallclock time. The
wallclock start time is the time that will be on a clock
just as the period starts (i.e. after a time change). The
wallclock end time is the time on a clock immediately before
the period ends.</p>

<p style="margin-left:11%;"><b>offset</b></p>

<p style="margin-left:17%;">The entire period has an offset
which is how much the wallclock time differs from
<small>GMT.</small></p>

<p style="margin-left:11%;"><b>abbreviation</b></p>

<p style="margin-left:17%;">When expressing the time
period, an abbreviation (such as <small>EST</small> ) is
typically used.</p>

<p style="margin-left:11%;"><b>daylight saving time
flag</b></p>

<p style="margin-left:17%;">Every period is categorized as
a standard time or a daylight saving time. The flag will be
1 if it is a daylight saving time, or 0 if it is a standard
time.</p>

<p style="margin-left:11%; margin-top: 1em">Date::Manip
includes all of the data for all of the time zones from the
zoneinfo database. This data is available from:</p>

<pre style="margin-left:11%; margin-top: 1em">   ftp://ftp.iana.org/tz/</pre>


<p style="margin-left:11%; margin-top: 1em">Additional data
from other standards are also used.</p>

<p style="margin-left:11%; margin-top: 1em">The zoneinfo
database is not necessary in order to use Date::Manip.
Instead, all of that data has been extracted and stored in a
series of other modules which are used to handle each time
zone. In that way, Date::Manip has no dependency on any
other source of data.</p>

<p style="margin-left:11%; margin-top: 1em">The
Date::Manip::Zones document contains detailed information on
the data available.</p>

<h2>METHODS
<a name="METHODS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">In all methods,
the following variables are used: <b><br>
$zone</b></p>

<p style="margin-left:17%;">This is a string which contains
a valid time zone name. For example:</p>

<pre style="margin-left:17%; margin-top: 1em">  America/New_York</pre>


<p style="margin-left:11%;"><b>$alias</b></p>

<p style="margin-left:17%;">This is a strings which
contains a valid time zone name, or a valid time zone alias.
For example:</p>

<pre style="margin-left:17%; margin-top: 1em">  America/New_York
  US/Eastern
  EST5EDT</pre>


<p style="margin-left:11%;"><b>$abbrev</b></p>

<p style="margin-left:17%;">This is a string which contains
a valid time zone abbreviation. For example:</p>
<pre style="margin-left:17%; margin-top: 1em">  EST</pre>

<p style="margin-left:11%;"><b>$offset</b></p>

<p style="margin-left:17%;">This is a time zone entered as
an offset. An offset is either a string of one of the
formats:</p>

<pre style="margin-left:17%; margin-top: 1em">  +HH
  +HHMM
  +HHMMSS
  +HH:MM
  +HH:MM:SS</pre>


<p style="margin-left:17%; margin-top: 1em">or it can be a
list reference:</p>

<pre style="margin-left:17%; margin-top: 1em">  [HH,MM,SS]</pre>


<p style="margin-left:17%; margin-top: 1em">If a list
reference is used, the sign must be included with all
values. So, the offset &quot;&minus;05:30&quot; would be the
list reference:</p>

<pre style="margin-left:17%; margin-top: 1em">  [&minus;5,&minus;30,0]</pre>


<p style="margin-left:11%;"><b>$dstflag</b></p>

<p style="margin-left:17%;">This is always one of the
values: std, stdonly, dst, dstonly</p>

<p style="margin-left:17%; margin-top: 1em">It defaults to
&quot;std&quot; if it is not present. When determining a
time zone, it is usually necessary to check a number of
different time zone and <small>DST</small> combinations.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>$dstflag</tt> is &quot;std&quot;, it will check both
standard and daylight saving times, but will give preference
to standard times. If <tt>$dstflag</tt> is
&quot;stdonly&quot;, only standard times will be
checked.</p>

<p style="margin-left:17%; margin-top: 1em">The
&quot;dst&quot; flag will search both, but give preference
to daylight saving times. The &quot;dstonly&quot; values
will only use daylight saving times.</p>

<p style="margin-left:11%;"><b>$date</b></p>

<p style="margin-left:17%;">A date is always a string
containing a date in one of the formats:</p>

<pre style="margin-left:17%; margin-top: 1em">   YYYYMMDDHH:MN:SS
   YYYY&minus;MM&minus;DD&minus;HH:MN:SS
   YYYYMMDDHHMNSS</pre>


<p style="margin-left:17%; margin-top: 1em">or a list
reference:</p>

<pre style="margin-left:17%; margin-top: 1em">   [Y,M,D,H,MN,S]</pre>


<p style="margin-left:11%;"><b>$isdst</b></p>

<p style="margin-left:17%;">This is 0 if a date is in
standard time, 1 if it is in daylight saving time.</p>

<p style="margin-left:11%;"><b>$period</b></p>

<p style="margin-left:17%;">A period is a list reference
currently containing the following items:</p>

<pre style="margin-left:17%; margin-top: 1em">   [ $dateUT, $dateLT, $offsetstr, $offset, $abbrev, $isdst,
     $endUT, $endLT, $begUTs, $begLTs, $endUTs, $endLTs ]</pre>


<p style="margin-left:17%; margin-top: 1em">$dateUT and
<tt>$dateLT</tt> are the starting date of the period (i.e.
the first second in a period) in universal (
<small>GMT</small> ) time and local (wallclock) time.
<tt>$endUT</tt> and <tt>$endLT</tt> are the end date of the
period (i.e. the last second in a period) in universal and
local time. These are all stored as list references.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>$offsetstr</tt>
is the string representation of the offset
(&quot;+05:00:00&quot;) and <tt>$offset</tt> is the
corresponding list reference form ([5,0,0]).</p>


<p style="margin-left:17%; margin-top: 1em"><tt>$abbrev</tt>
is the abbreviation that applies during this period, and
<tt>$isdst</tt> is 0 or 1 if it is standard or daylight
saving time.</p>

<p style="margin-left:17%; margin-top: 1em">When accessing
the elements in a period, use <small>ONLY</small> positive
indices. In other words, to get <tt>$endUT</tt>, access it
as $$period[6], <small>NOT</small> as $$period[&minus;2],
since I am considering adding more information to the period
description that may speed up performance.</p>


<p style="margin-left:17%; margin-top: 1em"><tt>$begUTs</tt>
is the string representation (
<small>YYYYMMDDHH:MN:SS</small> ) of <tt>$begUT</tt>.
Similar for <tt>$begLTs</tt>, <tt>$endUTs</tt>, and
<tt>$endLTs</tt>.</p>

<p style="margin-left:11%; margin-top: 1em">The following
methods are available: <b><br>
base <br>
config</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>err</b></p></td>
<td width="85%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>new</b></p></td>
<td width="85%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>new_config</b></p>

<p style="margin-left:17%;">Please refer to the
Date::Manip::Obj documentation for these methods.</p>

<p style="margin-left:11%;"><b>all_periods</b></p>

<pre style="margin-left:17%;">   @periods = $tz&minus;&gt;all_periods($zone,$year);</pre>


<p style="margin-left:17%; margin-top: 1em">This returns
the description of all time zone periods that occur (in full
or in part) during the given year.</p>

<p style="margin-left:11%;"><b>convert <br>
convert_to_gmt <br>
convert_from_gmt <br>
convert_to_local <br>
convert_from_local</b></p>

<p style="margin-left:17%;">These functions convert a date
from one time zone to another.</p>

<pre style="margin-left:17%; margin-top: 1em">   ($err,$date,$offset,$isdst,$abbrev) =
      $tz&minus;&gt;convert($date,$from,$to [,$isdst]);</pre>


<p style="margin-left:17%; margin-top: 1em">This converts a
date in the time zone given by <tt>$from</tt> to the time
zone given by <tt>$to</tt>.</p>

<pre style="margin-left:17%; margin-top: 1em">   ($err,$date,$offset,$isdst,$abbrev) =
      $tz&minus;&gt;convert_to_gmt($date [,$from] [,$isdst]);</pre>


<p style="margin-left:17%; margin-top: 1em">This converts a
date to <small>GMT.</small> If <tt>$from</tt> is given, it
is the current time zone of the date. If <tt>$from</tt> is
omitted, it defaults to the local time zone.</p>

<p style="margin-left:17%; margin-top: 1em">The value of
<tt>$isdst</tt> returned is always 0.</p>

<pre style="margin-left:17%; margin-top: 1em">   ($err,$date,$offset,$isdst,$abbrev) =
      $tz&minus;&gt;convert_from_gmt($date [,$to]);</pre>


<p style="margin-left:17%; margin-top: 1em">This converts a
date from <small>GMT</small> to another time zone. If
<tt>$to</tt> is given, the date is converted to that time
zone. Otherwise, it is converted to the local time zone.</p>

<pre style="margin-left:17%; margin-top: 1em">   ($err,$date,$offset,$isdst,$abbrev) =
      $tz&minus;&gt;convert_to_local($date [,$from] [,$isdst]);
   ($err,$date,$offset,$isdst,$abbrev) =
      $tz&minus;&gt;convert_from_local($date [,$to] [,$isdst]);</pre>


<p style="margin-left:17%; margin-top: 1em">Similar to the
convert_to_gmt and convert_from_gmt functions. If
<tt>$from</tt> or <tt>$to</tt> are omitted, they default to
<small>GMT.</small></p>

<p style="margin-left:17%; margin-top: 1em">If there is any
ambiguity about whether <tt>$date</tt> is in
<small>DST</small> or not (i.e. if it is a date that is
repeated during a time change due to the clock being moved
back), the <tt>$isdst</tt> option can be passed in as an
argument (it should be 0 or 1) to say which time to use. It
is ignored in all cases where <tt>$date</tt> can be
determined without that information.</p>

<p style="margin-left:17%; margin-top: 1em">The
<tt>$isdst</tt> value passed back is 1 if the converted date
is in <small>DST.</small> The <tt>$offset</tt> value passed
back is a list reference containing the offset from
<small>GMT.</small> <tt>$abbrev</tt> passed back is the time
zone abbreviation.</p>

<p style="margin-left:17%; margin-top: 1em">Error codes
are:</p>

<pre style="margin-left:17%; margin-top: 1em">   0  No error
   1  Invalid arguments
   2  Invalid FROM zone
   3  Invalid TO zone
   4  Invalid date</pre>


<p style="margin-left:11%;"><b>curr_zone</b></p>

<pre style="margin-left:17%;">   $tz&minus;&gt;curr_zone();</pre>


<p style="margin-left:17%; margin-top: 1em">This returns
the system time zone. The system time zone is determined
using the methods described below in the <small>DETERMINING
THE SYSTEM TIME ZONE</small> section.</p>

<p style="margin-left:17%; margin-top: 1em">This is the
time zone that is used by default unless the SetDate or
ForceDate config variable is set to a different zone.</p>

<pre style="margin-left:17%; margin-top: 1em">   $tz&minus;&gt;curr_zone(1);</pre>


<p style="margin-left:17%; margin-top: 1em">This clears the
system time zone and re-determines it using the methods
described below.</p>

<p style="margin-left:17%; margin-top: 1em">The main reason
to do this is if the curr_zone_methods method is used to
change how the time zone is determined.</p>

<p style="margin-left:11%;"><b>curr_zone_methods</b></p>

<pre style="margin-left:17%;">   $tz&minus;&gt;curr_zone_methods(@methods);</pre>


<p style="margin-left:17%; margin-top: 1em">This sets the
list and order of methods to use in determining the local
time zone. The various methods available are listed below in
the section <small>DETERMINING THE SYSTEM TIME
ZONE.</small></p>

<p style="margin-left:17%; margin-top: 1em">Some methods
may require one or more arguments. For example, the method
named &quot;mainvar&quot; takes an option that is the name
of a variable. The arguments must be included in the
<tt>@methods</tt> list immediately after the method name (so
<tt>@methods</tt> is actually a mixture of method names and
arguments).</p>

<p style="margin-left:17%; margin-top: 1em">This method may
not be used in any environment where taint checking is
enabled. If it is, it will issue a warning, but will
<small>NOT</small> change the method list.</p>

<p style="margin-left:11%;"><b>date_period</b></p>

<pre style="margin-left:17%;">   $period = $tz&minus;&gt;date_period($date,$zone,$wallclock [,$isdst]);</pre>


<p style="margin-left:17%; margin-top: 1em">This returns
the period information for the given date. <tt>$date</tt>
defaults to <small>GMT,</small> but may be given as local
(i.e. wallclock) time if <tt>$wallclock</tt> is non-zero.
The period information is described in the periods method
below.</p>

<p style="margin-left:17%; margin-top: 1em">If a wallclock
time is given, no period is returned if the wallclock time
doesn&rsquo;t ever appear (such as when a time change
results in the clock moving forward &quot;skipping&quot; a
period of time). If the wallclock time appears twice (i.e.
when a time change results in the clock being set back), the
<tt>$isdst</tt> variable is used. The standard time is used
unless <tt>$isdst</tt> is non-zero. <tt>$isdst</tt> is
ignored except in the case where there are two possible
periods.</p>

<p style="margin-left:11%;"><b>define_abbrev</b></p>

<pre style="margin-left:17%;">   ($err,$val) = $tz&minus;&gt;define_abbrev($abbrev,@zone);</pre>


<p style="margin-left:17%; margin-top: 1em">When
encountering an abbreviation, by default, all time zones
which ever include the abbreviation will be examine in the
order given in the Date::Manip::Zones manual.</p>

<p style="margin-left:17%; margin-top: 1em">Occasionally,
it may be necessary to change the order. This is true if you
are parsing dates in a time zone which uses an abbreviation
which is also used in another time zone, and where the other
time zone is given preference. As an example, the
abbreviation &quot; <small>ADT&quot;</small> will default to
the &quot;Atlantic/Bermuda&quot; time zone. If you are in
the &quot;America/Halifax&quot; time zone (which also uses
that abbreviation), you may want to change the order of time
zones.</p>

<p style="margin-left:17%; margin-top: 1em">This will take
an abbreviation (which must be a known abbreviation... there
is no means of defining a totally new abbreviation) and a
list of zones. This will set the list of zones that will be
checked, and the order in which they are checked, when a
date is encountered with the given abbreviation. It is not
necessary that the list include every zone that has ever
used the abbreviation, but it may not include a zone that
has never used it.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>$abbrev</tt> is &quot;reset&quot;, all abbreviations are
reset to the standard values. If <tt>@zone</tt> includes
only the element &rsquo;reset&rsquo;, the default list for
<tt>$abbrev</tt> is restored.</p>

<p style="margin-left:17%; margin-top: 1em">The following
error codes are returned:</p>

<pre style="margin-left:17%; margin-top: 1em">   0  No error
   1  $abbrev is not a valid abbreviation in any time zone
   2  A zone (returned as $val) is not a valid time zone
   3  A zone (returned as $val) does not use the abbreviation</pre>


<p style="margin-left:17%; margin-top: 1em">For more
information about the different zones which may correspond
to each abbreviation, and the order in which they will be
examined by default, refer to the Date::Manip::Zones
manual.</p>

<p style="margin-left:11%;"><b>define_alias</b></p>

<pre style="margin-left:17%;">   $err = $tz&minus;&gt;define_alias($alias,$zone);</pre>


<p style="margin-left:17%; margin-top: 1em">This will
define a new alias (or override an existing alias).
<tt>$zone</tt> must be a valid zone or an error is
returned.</p>

<p style="margin-left:17%; margin-top: 1em">For more
information about the different aliases which are set by
default, refer to the Date::Manip::Zones manual.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>$alias</tt> is &quot;reset&quot;, all aliases will be
reset to the standard values. If <tt>$zone</tt> is
&quot;reset&quot;, <tt>$alias</tt> will be reset to the
standard value.</p>

<p style="margin-left:11%;"><b>define_offset</b></p>

<pre style="margin-left:17%;">   ($err,$val) = $tz&minus;&gt;define_offset($offset, [$dstflag,] @zone);</pre>


<p style="margin-left:17%; margin-top: 1em">This is similar
to the define_abbrev method. When an offset is encountered,
all time zones which have ever included that offset are
checked. This will defined which time zones, and in what
order, they should be checked.</p>

<p style="margin-left:17%; margin-top: 1em">The zones to
both standard and daylight saving times which include the
offset (if <tt>$dstflag</tt> is &quot;std&quot; or
&quot;dst&quot;) or to only one or the other.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>$offset</tt> is &quot;reset&quot;, all lists are reset
to the default values. If <tt>@zone</tt> includes only the
element &rsquo;reset&rsquo;, the default list and order is
restored for <tt>$offset</tt> ($dstflag must not be
given).</p>

<p style="margin-left:17%; margin-top: 1em">The following
error codes are returned:</p>

<pre style="margin-left:17%; margin-top: 1em">   0  No error
   1  $offset is not a valid offset in any time zone
   2  $offset is not a valid offset in the selected
      time (if doing &quot;dstonly&quot; or &quot;stdonly&quot;)
   3  A zone (returned as $val) is not a valid time zone
   4  A zone (returned as $val) does not use the offset
   5  A zone (returned as $val) does not include the
      offset in the selected time (if doing &quot;dstonly&quot;
      or &quot;stdonly&quot;)
   9  Offset is not a valid offset</pre>


<p style="margin-left:11%;"><b>periods</b></p>

<pre style="margin-left:17%;">   @periods = $tz&minus;&gt;periods($zone,$year);</pre>


<p style="margin-left:17%; margin-top: 1em">This returns
the description of all time zone periods that begin during
the year given. The year is measured in universal (
<small>GMT</small> ) time.</p>

<p style="margin-left:17%; margin-top: 1em">If no time zone
period starts in the given year, nothing is returned.</p>

<pre style="margin-left:17%; margin-top: 1em">   @periods = $tz&minus;&gt;periods($zone,undef,$year);</pre>


<p style="margin-left:17%; margin-top: 1em">This returns
all periods that begin in any year from 0001 to
<tt>$year</tt>.</p>

<pre style="margin-left:17%; margin-top: 1em">   @periods = $tz&minus;&gt;periods($zone,$year0,$year1);</pre>


<p style="margin-left:17%; margin-top: 1em">This returns
all periods that begin in any year from <tt>$year0</tt> to
<tt>$year1</tt>.</p>

<p style="margin-left:11%;"><b>tzdata <br>
tzcode</b></p>

<pre style="margin-left:17%;">   $vers = $tz&minus;&gt;tzdata();
   $vers = $tz&minus;&gt;tzcode();</pre>


<p style="margin-left:17%; margin-top: 1em">These return
the versions of the tzdata and tzcode packages used to
generate the modules.</p>

<p style="margin-left:11%;"><b>zone</b></p>

<pre style="margin-left:17%;">   $zone = $tz&minus;&gt;zone(@args);
   @zone = $tz&minus;&gt;zone(@args);</pre>


<p style="margin-left:17%; margin-top: 1em">This function
will return a list of all zones, or the default zone, which
matches all of the supplied information. In scalar context,
it will return only the default zone. In list context, it
will return all zones.</p>

<p style="margin-left:17%; margin-top: 1em"><tt>@args</tt>
may include any of the following items, and the order is not
important.</p>

<pre style="margin-left:17%; margin-top: 1em">   A zone name or alias ($alias)
   A zone abbreviation ($abbrev)
   An offset ($offset)
   A dstflag ($dstflag)
   A date ($date)</pre>


<p style="margin-left:17%; margin-top: 1em">It is
<small>NOT</small> valid to include two of any of the items.
Any time zone returned will match all of the data
supplied.</p>

<p style="margin-left:17%; margin-top: 1em">If an error
occurs, undef is returned. If no zone matches, an empty
string, or an empty list is returned.</p>

<p style="margin-left:17%; margin-top: 1em">The order of
the zones will be determined in the following way:</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>$abbrev</tt> is given, the order of time zones will be
determined by it (and <tt>$dstflag</tt>). If
<tt>$dstflag</tt> is &quot;std&quot;, all zones which match
<tt>$abbrev</tt> in standard time are included, followed by
all that match <tt>$abbrev</tt> in saving time (but no
duplication is allowed). The reverse is true if
<tt>$dstflag</tt> is &quot;dst&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>$abbrev</tt> is not given, but <tt>$offset</tt> is,
<tt>$offset</tt> (and <tt>$dstflag</tt>) will determine the
order given. If <tt>$dstflag</tt> is &quot;std&quot;, all
zones which match <tt>$offset</tt> in standard time are
included, followed by all that match <tt>$offset</tt> in
saving time (but no duplication is allowed). The reverse is
true if <tt>$dstflag</tt> is &quot;dst&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">If
<tt>$date</tt> is given, only zones in which <tt>$date</tt>
will appear in a zone that matches all other information are
given. <tt>$date</tt> is a wallclock time.</p>

<p style="margin-left:17%; margin-top: 1em">If no
<tt>$zone</tt>, <tt>$abbrev</tt>, or <tt>$offset</tt> are
entered, the local time zone may be returned (unless
<tt>$date</tt> is entered, and it doesn&rsquo;t exist in the
local time zone).</p>


<p style="margin-left:17%; margin-top: 1em"><small>NOTE:</small>
there is one important thing to note with respect to
<tt>$dstflag</tt> when you are working with a timezone
expressed as an offset and a date is passed in. In this
case, the default value of <tt>$dstflag</tt> is
&quot;dst&quot; ( <small>NOT</small> &quot;stdonly&quot;),
and you probably never want to pass in a value of
&quot;std&quot; (though passing in &quot;stdonly&quot; is
okay).</p>

<p style="margin-left:17%; margin-top: 1em">For standard
offsets (with no minute component), there is always a
standard timezone which matches that offset. For example,
the timezone &quot;+0100&quot; matches the timezone
&quot;Etc/GMT+01&quot;, so you will never get a timezone in
daylight saving time if <tt>$dstflag</tt> is
&quot;std&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">If you want to
pass in a date of 2001&minus;07&minus;01&minus;00:00:00 and
an timezone of &quot;+0100&quot; and you want to get a
timezone that refers to that date as a daylight saving time
date, you must use the <tt>$dstflag</tt> of &quot;dst&quot;
(or &quot;dstonly&quot;).</p>

<p style="margin-left:17%; margin-top: 1em">Because this is
almost always the behavior desired, when a zone is passed in
as an offset, and a date is passed in, the default
<tt>$dstflag</tt> is &quot;dst&quot; instead of
&quot;std&quot;. In all other situations, the default is
still &quot;std&quot;.</p>

<p style="margin-left:17%; margin-top: 1em">If the timezone
is expressed as an abbreviation, this problem does not
occur.</p>

<h2>TIME ZONE INFORMATION IN DATE::MANIP
<a name="TIME ZONE INFORMATION IN DATE::MANIP"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Date::Manip
makes use of three potentially different time zones when
working with a date.</p>

<p style="margin-left:11%; margin-top: 1em">The first time
zone that may be used is the actual local time zone. This is
the time zone that the computer is actually running in.</p>

<p style="margin-left:11%; margin-top: 1em">The second time
zone is the working time zone. Usually, you will want the
default time zone to be the local time zone, but
occasionally, you may want the default time zone to be
different.</p>

<p style="margin-left:11%; margin-top: 1em">The third time
zone is the actual time zone that was parsed, or set, for a
date. If a date contains no time zone information, it will
default to the working time zone.</p>

<p style="margin-left:11%; margin-top: 1em">The local time
zone is determined using the methods described in the
following section. The preferred way is to locate the time
zone in some system file, or using some system command, or
(in the case of a Windows operating system) to look it up in
the registry. If all of these methods fail, the local time
zone may be set using either the <tt>$::TZ</tt> or
<tt>$ENV</tt>{ <small>TZ</small> } variables. Please note
that these should <small>ONLY</small> be used to set the
actual local time zone.</p>

<p style="margin-left:11%; margin-top: 1em">If you are
running in one time zone, but you want to force dates to be
specified in an alternate time zone by default, you need to
set the working time zone. The working time zone defaults to
the local time zone, but this can be changed using either
the SetDate or ForceDate config variables. Refer to the
Date::Manip::Config manual for more information.</p>

<p style="margin-left:11%; margin-top: 1em">Finally, when a
date is actually parsed, if it contains any time zone
information, the date is stored in that time zone.</p>

<h2>DETERMINING THE SYSTEM TIME ZONE
<a name="DETERMINING THE SYSTEM TIME ZONE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">There are a
large number of ways available for determining the time
zone. Some or all of them may be checked. A list of methods
to use is provided by default, and may be overridden by the
curr_zone_methods function described above. To override the
default order and/or list of methods, just pass in a list of
method names (with arguments where necessary), and only
those methods will be done, and in the order given.</p>

<p style="margin-left:11%; margin-top: 1em">The following
methods are available:</p>

<pre style="margin-left:11%; margin-top: 1em">   Method     Argument(s)    Procedure
   ======     ===========    =========
   main       VAR            The main variable named VAR is
                             checked. E.g. &quot;main TZ&quot; checks
                             the variable $::TZ .
   env        TYPE VAR       The named environment variable
                             is checked and the type of
                             data stored there (TYPE can
                             be 'zone' or 'offset' which
                             is the number of seconds from
                             UTC).
   file       FILE           Look in the given file for any
                             one of the following case
                             insensitive lines:
                                ZONE
                                tz = ZONE
                                zone = ZONE
                                timezone = ZONE
                             ZONE may be quoted (single or
                             double) and whitespace is
                             ignored (except that underscores
                             in the zone name may be replaced
                             by whitespace on some OSes). If
                             the entire line is a zone, it must
                             be the first non&minus;blank non&minus;comment
                             line in the file.
   command    COMMAND        Runs a command which produces
                             a time zone as the output.
   cmdfield   COMMAND N      Runs a command which produces
                             whitespace separated fields,
                             the Nth one containing the
                             time zone (fields are numbered
                             starting at 0, or from the
                             end starting at &minus;1).
   gmtoff                    Uses the current offset from
                             GMT to come up with a best guess.
   registry                  Look up the value in the
                             Windows registry. This is only
                             available to hosts running a
                             Windows operating system.</pre>


<p style="margin-left:11%; margin-top: 1em">Note that the
&quot;main&quot; and &quot;env&quot; methods should only be
used to specify the actual time zone the system is running
in. Use the SetDate and ForceDate config variables to
specify an alternate time zone that you want to work in.</p>

<p style="margin-left:11%; margin-top: 1em">By default, the
following methods are checked (in the order given) on Unix
systems:</p>

<pre style="margin-left:11%; margin-top: 1em">   main     TZ
   env      zone TZ
   file     /etc/TIMEZONE
   file     /etc/timezone
   file     /etc/sysconfig/clock
   file     /etc/default/init
   command  &quot;/bin/date +%Z&quot;
   command  &quot;/usr/bin/date +%Z&quot;
   command  &quot;/usr/local/bin/date +%Z&quot;
   cmdfield /bin/date             &minus;2
   cmdfield /usr/bin/date         &minus;2
   cmdfield /usr/local/bin/date   &minus;2
   gmtoff</pre>


<p style="margin-left:11%; margin-top: 1em">The default
methods for Windows systems are:</p>

<pre style="margin-left:11%; margin-top: 1em">   main     TZ
   env      zone TZ
   registry
   gmtoff</pre>


<p style="margin-left:11%; margin-top: 1em">The default
methods for <small>VMS</small> systems are:</p>

<pre style="margin-left:11%; margin-top: 1em">   main     TZ
   env      zone TZ
   env      zone SYS$TIMEZONE_NAME
   env      zone UCX$TZ
   env      zone TCPIP$TZ
   env      zone MULTINET_TIMEZONE
   env      offset SYS$TIMEZONE_DIFFERENTIAL
   gmtoff</pre>


<p style="margin-left:11%; margin-top: 1em">The default
methods for all other systems are:</p>

<pre style="margin-left:11%; margin-top: 1em">   main     TZ
   env      zone TZ
   gmtoff</pre>


<p style="margin-left:11%; margin-top: 1em">If anyone wants
better support for a specific <small>OS,</small> please
contact me and we&rsquo;ll coordinate adding it.</p>

<p style="margin-left:11%; margin-top: 1em">In all cases,
the value returned from the method may be any of the
following:</p>

<pre style="margin-left:11%; margin-top: 1em">   the full name of a time zone (e.g. America/New_York)
   or an alias
   an abbreviation (e.g. EDT) which will be used to
   determine the zone if possible
   an offset (+hh, +hhmn, +hh:mm, +hh:mm:ss) from GMT</pre>


<p style="margin-left:11%; margin-top: 1em">The
Date::Manip::Zones module contains information about the
time zones and aliases available, and what time zones
contain the abbreviations.</p>

<h2>DESIGN ISSUES
<a name="DESIGN ISSUES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The design
decisions made in writing this module may cause some
questions (and probably complaints). The time zone modules
are all generated using scripts (included in the Date::Manip
distribution) which use the standard tzdata tools to parse
the tzdata files and store that information in perl
modules.</p>

<p style="margin-left:11%; margin-top: 1em">I&rsquo;d like
to address some of them, to avoid answering some of the
&quot;why did you do it that way&quot; remarks. I do welcome
discussion about these decisions... but preferably after you
understand why those decisions were made so that that we
have an informed basis to begin a discussion. <b><br>
Why not use existing zoneinfo files</b></p>

<p style="margin-left:17%;">Some people will probably think
that I should have written an interface to the zoneinfo
files which are distributed with most operating systems.
Although I considered doing that, I rejected the idea for
two reasons.</p>

<p style="margin-left:17%; margin-top: 1em">First, not all
operating systems come with the zoneinfo databases in a user
accessible state (Microsoft for example). Even those that do
include them store the information in various formats and
locations. In order to bypass all that, I have included the
data directly in these modules.</p>

<p style="margin-left:17%; margin-top: 1em">Second, as I
was doing my initial investigations into this, I ran into a
bug in the Solaris zoneinfo tools (long since fixed
I&rsquo;m sure). I decided then that I didn&rsquo;t want to
depend on an implementation where I could not control and
fix the bugs.</p>

<p style="margin-left:11%;"><b>Why not use the native
tzdata files</b></p>

<p style="margin-left:17%;">Another decision people may
question is that I parse the tzdata files and store the data
from them in a large number of perl modules instead of
creating an interface to the tzdata files directly. This was
done solely for the sake of speed. Date::Manip is already a
slow module. I didn&rsquo;t want to slow it down further by
doing the complex parsing required to interpret the tzdata
files while manipulating dates. By storing the data in these
modules, there is little or no parsing done while using
Date::Manip modules. It costs a little disk space to store
this information... but very little of it is actually loaded
at runtime (time zone data is only loaded when the time zone
is actually referred to), so I feel it&rsquo;s a good
tradeoff.</p>

<p style="margin-left:11%;"><b>Why store the information in
so many files</b></p>

<p style="margin-left:17%;">The data from the native tzdata
files are parsed and stored in two sets of modules. These
include almost 500 Date::Manip::Offset::* modules and almost
450 Date::Manip::TZ::* modules.</p>

<p style="margin-left:17%; margin-top: 1em">I note that on
my linux box, /usr/share/zoneinfo (which contains data files
generated from the tzdata files) contains over 1700 files,
so I&rsquo;m not doing anything &quot;new&quot; by breaking
up the information into separate files. And doing so has a
huge impact on performance... it is not necessary to load
and/or manipulate data from time zones which are not in
use.</p>

<p style="margin-left:17%; margin-top: 1em">The minute I
made the decision to distribute the timezone information
myself, as opposed to using the system version, it was a
given that there would be a lot of files.</p>

<p style="margin-left:17%; margin-top: 1em">These modules
are loaded only when the time zone or offset is actually
used, so, unless dates from around the world are being
parsed, only a very small number of these modules will
actually be loaded. In many applications, only a single
<small>TZ</small> module will be loaded. If parsing dates
which have timezone information stored as offsets, one or
two Offset modules will also be loaded.</p>

<p style="margin-left:11%;"><b>The disk space seems
excessive</b></p>

<p style="margin-left:17%;">Currently, the disk usage of
the perl files is around 9 <small>MB.</small> Total disk
usage for /usr/share/zoneinfo on my computer is around 4
<small>MB.</small> There are a couple of differences.</p>

<p style="margin-left:17%; margin-top: 1em">The primary
difference is that the zoneinfo files are stored in a binary
(and hence, more compressed) version, where the perl modules
have all the data in pure text.</p>

<p style="margin-left:17%; margin-top: 1em">Since these are
all automatically generated and used, it may be beneficial
to store the data in some packed binary format instead of
the fully expanded text form that is currently in use. This
would decrease the disk space usage, and might improve
performance. However, the performance improvement would
happen only once per timezone, and would make for more
complicated code, so I&rsquo;m not very interested in
pursuing this.</p>

<p style="margin-left:17%; margin-top: 1em">Another aspect
of the current modules is that they all include pod
documentation. Although not necessary, this allows users to
easily see what modules handle which time zones, and
that&rsquo;s nice. It also allows me to use pod_coverage
tests for the module which is a nice check to make sure that
the documentation is accurate.</p>

<p style="margin-left:17%; margin-top: 1em">All told, I
don&rsquo;t consider the disk usage excessive at all.</p>

<h2>KNOWN PROBLEMS OR ISSUES
<a name="KNOWN PROBLEMS OR ISSUES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Unable to
determine Time Zone</b></p>

<p style="margin-left:17%;">When using Date::Manip, when
the module is initialized, it must be able to determine the
local time zone. If it fails to do so, an error will
occur:</p>

<pre style="margin-left:17%; margin-top: 1em">   Unable to determine Time Zone</pre>


<p style="margin-left:17%; margin-top: 1em">and the script
will exit.</p>

<p style="margin-left:17%; margin-top: 1em">In the past,
this was the most common problem with using Date::Manip .
With the release of 6.00, this problem should be
significantly less common. If you do get this error, please
refer to the section above <small>DETERMINING THE SYSTEM
TIME ZONE</small> for information about determining the
local time zone. I am also interested in hearing about this
so that I can update the default list of methods to be able
to determine the local time zone better.</p>

<p style="margin-left:11%;"><b>Asia/Jerusalem time
zone</b></p>

<p style="margin-left:17%;">The Asia/Jerusalem time zone
has a non-standard way of specifying the start and end of
Daylight Saving Time based on the Hebrew calendar.</p>

<p style="margin-left:17%; margin-top: 1em">As a result,
there is no way to specify a simple rule to define time zone
changes for all years in the future. As such, this module
supports all time zone changes currently specified in the
zoneinfo database (which currently goes to the year 2037)
but does not attempt to correctly handle zone changes beyond
that date. As a result, Date::Manip should not be used to
parse dates in the Jerusalem time zone that are far enough
in the future that information is not included in the
current version of the zoneinfo database.</p>

<p style="margin-left:11%;"><b><small>LMT</small> and zzz
abbreviations</b></p>

<p style="margin-left:17%;">Both the <small>LMT</small> and
zzz abbreviations are used in the zoneinfo databases.
<small>LMT</small> is use for most time zones for the times
before the Gregorian calendar was adopted, and zzz is used
for a few where the time zone was created and no description
of dates prior to that are supported. Both
<small>LMT</small> and zzz are basically ignored in parsing
dates (because there is no reasonable way to determine which
zone they are referring to), and will be treated as the
local time zone regardless.</p>

<h2>KNOWN BUGS
<a name="KNOWN BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">None known.</p>

<h2>BUGS AND QUESTIONS
<a name="BUGS AND QUESTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please refer to
the Date::Manip::Problems documentation for information on
submitting bug reports or questions to the author.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Date::Manip
&minus; main module documentation</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This script is
free software; you can redistribute it and/or modify it
under the same terms as Perl itself.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Sullivan Beck
(sbeck@cpan.org)</p>
<hr>
</body>
</html>
