<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov  5 22:08:46 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>openvpn</title>

</head>
<body>

<h1 align="center">openvpn</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#INTRODUCTION">INTRODUCTION</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#SCRIPTING AND ENVIRONMENTAL VARIABLES">SCRIPTING AND ENVIRONMENTAL VARIABLES</a><br>
<a href="#INLINE FILE SUPPORT">INLINE FILE SUPPORT</a><br>
<a href="#SIGNALS">SIGNALS</a><br>
<a href="#TUN/TAP DRIVER SETUP">TUN/TAP DRIVER SETUP</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#FIREWALLS">FIREWALLS</a><br>
<a href="#FAQ">FAQ</a><br>
<a href="#HOWTO">HOWTO</a><br>
<a href="#PROTOCOL">PROTOCOL</a><br>
<a href="#WEB">WEB</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">openvpn -
secure IP tunnel daemon.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>openvpn [
options ... ]</b></p>

<h2>INTRODUCTION
<a name="INTRODUCTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">OpenVPN is an
open source VPN daemon by James Yonan. Because OpenVPN tries
to be a universal VPN tool offering a great deal of
flexibility, there are a lot of options on this manual page.
If you&rsquo;re new to OpenVPN, you might want to skip ahead
to the examples section where you will see how to construct
simple VPNs on the command line without even needing a
configuration file.</p>

<p style="margin-left:11%; margin-top: 1em">Also note that
there&rsquo;s more documentation and examples on the OpenVPN
web site: <i>http://openvpn.net/</i></p>

<p style="margin-left:11%; margin-top: 1em">And if you
would like to see a shorter version of this manual, see the
openvpn usage message which can be obtained by running
<b>openvpn</b> without any parameters.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">OpenVPN is a
robust and highly flexible VPN daemon. OpenVPN supports
SSL/TLS security, ethernet bridging, TCP or UDP tunnel
transport through proxies or NAT, support for dynamic IP
addresses and DHCP, scalability to hundreds or thousands of
users, and portability to most major OS platforms.</p>

<p style="margin-left:11%; margin-top: 1em">OpenVPN is
tightly bound to the OpenSSL library, and derives much of
its crypto capabilities from it.</p>

<p style="margin-left:11%; margin-top: 1em">OpenVPN
supports conventional encryption using a pre-shared secret
key <b>(Static Key mode)</b> or public key security
<b>(SSL/TLS mode)</b> using client &amp; server
certificates. OpenVPN also supports non-encrypted TCP/UDP
tunnels.</p>

<p style="margin-left:11%; margin-top: 1em">OpenVPN is
designed to work with the <b>TUN/TAP</b> virtual networking
interface that exists on most platforms.</p>

<p style="margin-left:11%; margin-top: 1em">Overall,
OpenVPN aims to offer many of the key features of IPSec but
with a relatively lightweight footprint.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">OpenVPN allows
any option to be placed either on the command line or in a
configuration file. Though all command line options are
preceded by a double-leading-dash
(&quot;&minus;&minus;&quot;), this prefix can be removed
when an option is placed in a configuration file.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;help</b></p></td>
<td width="2%"></td>
<td width="20%">


<p>Show options.</p></td>
<td width="58%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;&minus;config
file</b></p>

<p style="margin-left:22%;">Load additional config options
from <b>file</b> where each line corresponds to one command
line option, but with the leading
&rsquo;&minus;&minus;&rsquo; removed.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>&minus;&minus;config file</b> is the only option to the
openvpn command, the <b>&minus;&minus;config</b> can be
removed, and the command can be given as <b>openvpn
file</b></p>

<p style="margin-left:22%; margin-top: 1em">Note that
configuration files can be nested to a reasonable depth.</p>

<p style="margin-left:22%; margin-top: 1em">Double
quotation or single quotation characters (&quot;&quot;,
&rsquo;&rsquo;) can be used to enclose single parameters
containing whitespace, and &quot;#&quot; or &quot;;&quot;
characters in the first column can be used to denote
comments.</p>

<p style="margin-left:22%; margin-top: 1em">Note that
OpenVPN 2.0 and higher performs backslash-based shell
escaping for characters not in single quotations, so the
following mappings should be observed:</p>

<p style="margin-left:28%; margin-top: 1em"><b>\\ Maps to a
single backslash character (\). <br>
\&quot; Pass a literal doublequote character (&quot;),
don&rsquo;t <br>
interpret it as enclosing a parameter. <br>
\[SPACE] Pass a literal space or tab character, don&rsquo;t
<br>
interpret it as a parameter delimiter.</b></p>

<p style="margin-left:22%; margin-top: 1em">For example on
Windows, use double backslashes to represent pathnames:</p>

<p style="margin-left:28%; margin-top: 1em"><b>secret
&quot;c:\\OpenVPN\\secret.key&quot;</b></p>

<p style="margin-left:22%; margin-top: 1em">For examples of
configuration files, see
<i>http://openvpn.net/examples.html</i></p>

<p style="margin-left:22%; margin-top: 1em">Here is an
example configuration file:</p>

<p style="margin-left:28%; margin-top: 1em"><b># <br>
# Sample OpenVPN configuration file for <br>
# using a pre-shared static key. <br>
# <br>
# &rsquo;#&rsquo; or &rsquo;;&rsquo; may be used to delimit
comments.</b></p>

<p style="margin-left:28%; margin-top: 1em"><b># Use a
dynamic tun device. <br>
dev tun</b></p>

<p style="margin-left:28%; margin-top: 1em"><b># Our remote
peer <br>
remote mypeer.mydomain</b></p>

<p style="margin-left:28%; margin-top: 1em"><b># 10.1.0.1
is our local VPN endpoint <br>
# 10.1.0.2 is our remote VPN endpoint <br>
ifconfig 10.1.0.1 10.1.0.2</b></p>

<p style="margin-left:28%; margin-top: 1em"><b># Our
pre-shared static key <br>
secret static.key</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>Tunnel
Options: <br>
&minus;&minus;mode m</b></p>

<p style="margin-left:22%;">Set OpenVPN major mode. By
default, OpenVPN runs in point-to-point mode
(&quot;p2p&quot;). OpenVPN 2.0 introduces a new mode
(&quot;server&quot;) which implements a multi-client server
capability.</p>

<p style="margin-left:11%;"><b>&minus;&minus;local
host</b></p>

<p style="margin-left:22%;">Local host name or IP address
for bind. If specified, OpenVPN will bind to this address
only. If unspecified, OpenVPN will bind to all
interfaces.</p>

<p style="margin-left:11%;"><b>&minus;&minus;remote host
[port] [proto]</b></p>

<p style="margin-left:22%;">Remote host name or IP address.
On the client, multiple <b>&minus;&minus;remote</b> options
may be specified for redundancy, each referring to a
different OpenVPN server. Specifying multiple
<b>&minus;&minus;remote</b> options for this purpose is a
special case of the more general connection-profile feature.
See the <b>&lt;connection&gt;</b> documentation below.</p>

<p style="margin-left:22%; margin-top: 1em">The OpenVPN
client will try to connect to a server at <b>host:port</b>
in the order specified by the list of
<b>&minus;&minus;remote</b> options.</p>

<p style="margin-left:22%; margin-top: 1em"><b>proto</b>
indicates the protocol to use when connecting with the
remote, and may be &quot;tcp&quot; or &quot;udp&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">The client will
move on to the next host in the list, in the event of
connection failure. Note that at any given time, the OpenVPN
client will at most be connected to one server.</p>

<p style="margin-left:22%; margin-top: 1em">Note that since
UDP is connectionless, connection failure is defined by the
<b>&minus;&minus;ping</b> and
<b>&minus;&minus;ping&minus;restart</b> options.</p>

<p style="margin-left:22%; margin-top: 1em">Note the
following corner case: If you use multiple
<b>&minus;&minus;remote</b> options, AND you are dropping
root privileges on the client with <b>&minus;&minus;user</b>
and/or <b>&minus;&minus;group,</b> AND the client is running
a non-Windows OS, if the client needs to switch to a
different server, and that server pushes back different
TUN/TAP or route settings, the client may lack the necessary
privileges to close and reopen the TUN/TAP interface. This
could cause the client to exit with a fatal error.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>&minus;&minus;remote</b> is unspecified, OpenVPN will
listen for packets from any IP address, but will not act on
those packets unless they pass all authentication tests.
This requirement for authentication is binding on all
potential peers, even those from known and supposedly
trusted IP addresses (it is very easy to forge a source IP
address on a UDP packet).</p>

<p style="margin-left:22%; margin-top: 1em">When used in
TCP mode, <b>&minus;&minus;remote</b> will act as a filter,
rejecting connections from any host which does not match
<b>host.</b></p>

<p style="margin-left:22%; margin-top: 1em">If <b>host</b>
is a DNS name which resolves to multiple IP addresses, the
first address returned by the system getaddrinfo() function
will be used (no DNS randomization inside OpenVPN 2.3.x, and
it will not try multiple addresses).</p>


<p style="margin-left:11%;"><b>&minus;&minus;remote&minus;random&minus;hostname</b></p>

<p style="margin-left:22%;">Prepend a random string (6
bytes, 12 hex characters) to hostname to prevent DNS
caching. For example, &quot;foo.bar.gov&quot; would be
modified to
&quot;&lt;random-chars&gt;.foo.bar.gov&quot;.</p>

<p style="margin-left:11%;"><b>&lt;connection&gt;</b></p>

<p style="margin-left:22%;">Define a client connection
profile. Client connection profiles are groups of OpenVPN
options that describe how to connect to a given OpenVPN
server. Client connection profiles are specified within an
OpenVPN configuration file, and each profile is bracketed by
<b>&lt;connection&gt;</b> and
<b>&lt;/connection&gt;.</b></p>

<p style="margin-left:22%; margin-top: 1em">An OpenVPN
client will try each connection profile sequentially until
it achieves a successful connection.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;remote&minus;random</b>
can be used to initially &quot;scramble&quot; the connection
list.</p>

<p style="margin-left:22%; margin-top: 1em">Here is an
example of connection profile usage:</p>

<p style="margin-left:28%; margin-top: 1em"><b>client <br>
dev tun</b></p>


<p style="margin-left:28%; margin-top: 1em"><b>&lt;connection&gt;
<br>
remote 198.19.34.56 1194 udp <br>
&lt;/connection&gt;</b></p>


<p style="margin-left:28%; margin-top: 1em"><b>&lt;connection&gt;
<br>
remote 198.19.34.56 443 tcp <br>
&lt;/connection&gt;</b></p>


<p style="margin-left:28%; margin-top: 1em"><b>&lt;connection&gt;
<br>
remote 198.19.34.56 443 tcp <br>
http-proxy 192.168.0.8 8080 <br>
http-proxy-retry <br>
&lt;/connection&gt;</b></p>


<p style="margin-left:28%; margin-top: 1em"><b>&lt;connection&gt;
<br>
remote 198.19.36.99 443 tcp <br>
http-proxy 192.168.0.8 8080 <br>
http-proxy-retry <br>
&lt;/connection&gt;</b></p>

<p style="margin-left:28%; margin-top: 1em"><b>persist-key
<br>
persist-tun <br>
pkcs12 client.p12 <br>
ns-cert-type server <br>
verb 3</b></p>

<p style="margin-left:22%; margin-top: 1em">First we try to
connect to a server at 198.19.34.56:1194 using UDP. If that
fails, we then try to connect to 198.19.34.56:443 using TCP.
If that also fails, then try connecting through an HTTP
proxy at 192.168.0.8:8080 to 198.19.34.56:443 using TCP.
Finally, try to connect through the same proxy to a server
at 198.19.36.99:443 using TCP.</p>

<p style="margin-left:22%; margin-top: 1em">The following
OpenVPN options may be used inside of a
<b>&lt;connection&gt;</b> block:</p>

<p style="margin-left:22%; margin-top: 1em"><b>bind,
connect-retry, connect-retry-max, connect-timeout,
explicit-exit-notify, float, fragment, http-proxy,
http-proxy-option, http-proxy-retry, http-proxy-timeout,
link-mtu, local, lport, mssfix, mtu-disc, nobind, port,
proto, remote, rport, socks-proxy, socks-proxy-retry,
tun-mtu and tun-mtu-extra.</b></p>

<p style="margin-left:22%; margin-top: 1em">A defaulting
mechanism exists for specifying options to apply to all
<b>&lt;connection&gt;</b> profiles. If any of the above
options (with the exception of <b>remote</b> ) appear
outside of a <b>&lt;connection&gt;</b> block, but in a
configuration file which has one or more
<b>&lt;connection&gt;</b> blocks, the option setting will be
used as a default for <b>&lt;connection&gt;</b> blocks which
follow it in the configuration file.</p>

<p style="margin-left:22%; margin-top: 1em">For example,
suppose the <b>nobind</b> option were placed in the sample
configuration file above, near the top of the file, before
the first <b>&lt;connection&gt;</b> block. The effect would
be as if <b>nobind</b> were declared in all
<b>&lt;connection&gt;</b> blocks below it.</p>


<p style="margin-left:11%;"><b>&minus;&minus;proto&minus;force
p</b></p>

<p style="margin-left:22%;">When iterating through
connection profiles, only consider profiles using protocol
<b>p</b> (&rsquo;tcp&rsquo;|&rsquo;udp&rsquo;).</p>


<p style="margin-left:11%;"><b>&minus;&minus;remote&minus;random</b></p>

<p style="margin-left:22%;">When multiple
<b>&minus;&minus;remote</b> address/ports are specified, or
if connection profiles are being used, initially randomize
the order of the list as a kind of basic load-balancing
measure.</p>

<p style="margin-left:11%;"><b>&minus;&minus;proto
p</b></p>

<p style="margin-left:22%;">Use protocol <b>p</b> for
communicating with remote host. <b>p</b> can be <b>udp,
tcp-client,</b> or <b>tcp-server.</b></p>

<p style="margin-left:22%; margin-top: 1em">The default
protocol is <b>udp</b> when <b>&minus;&minus;proto</b> is
not specified.</p>

<p style="margin-left:22%; margin-top: 1em">For UDP
operation, <b>&minus;&minus;proto udp</b> should be
specified on both peers.</p>

<p style="margin-left:22%; margin-top: 1em">For TCP
operation, one peer must use <b>&minus;&minus;proto
tcp&minus;server</b> and the other must use
<b>&minus;&minus;proto tcp&minus;client.</b> A peer started
with <b>tcp-server</b> will wait indefinitely for an
incoming connection. A peer started with
<b>tcp&minus;client</b> will attempt to connect, and if that
fails, will sleep for 5 seconds (adjustable via the
<b>&minus;&minus;connect&minus;retry</b> option) and try
again infinite or up to N retries (adjustable via the
<b>&minus;&minus;connect&minus;retry&minus;max</b> option).
Both TCP client and server will simulate a SIGUSR1 restart
signal if either side resets the connection.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN is
designed to operate optimally over UDP, but TCP capability
is provided for situations where UDP cannot be used. In
comparison with UDP, TCP will usually be somewhat less
efficient and less robust when used over unreliable or
congested networks.</p>

<p style="margin-left:22%; margin-top: 1em">This article
outlines some of problems with tunneling IP over TCP:</p>


<p style="margin-left:22%; margin-top: 1em"><i>http://sites.inka.de/sites/bigred/devel/tcp-tcp.html</i></p>

<p style="margin-left:22%; margin-top: 1em">There are
certain cases, however, where using TCP may be advantageous
from a security and robustness perspective, such as
tunneling non-IP or application-level UDP protocols, or
tunneling protocols which don&rsquo;t possess a built-in
reliability layer.</p>


<p style="margin-left:11%;"><b>&minus;&minus;connect&minus;retry
n</b></p>

<p style="margin-left:22%;">For <b>&minus;&minus;proto
tcp&minus;client,</b> take <b>n</b> as the number of seconds
to wait between connection retries (default=5).</p>


<p style="margin-left:11%;"><b>&minus;&minus;connect&minus;timeout
n</b></p>

<p style="margin-left:22%;">For <b>&minus;&minus;proto
tcp&minus;client,</b> set connection timeout to <b>n</b>
seconds (default=10).</p>


<p style="margin-left:11%;"><b>&minus;&minus;connect&minus;retry&minus;max
n</b></p>

<p style="margin-left:22%;">For <b>&minus;&minus;proto
tcp&minus;client,</b> take <b>n</b> as the number of retries
of connection attempt (default=infinite).</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;proxy&minus;settings</b></p>

<p style="margin-left:22%;">Show sensed HTTP or SOCKS proxy
settings. Currently, only Windows clients support this
option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;http&minus;proxy
server port
[authfile|&rsquo;auto&rsquo;|&rsquo;auto&minus;nct&rsquo;]
[auth-method]</b></p>

<p style="margin-left:22%;">Connect to remote host through
an HTTP proxy at address <b>server</b> and port <b>port.</b>
If HTTP Proxy-Authenticate is required, <b>authfile</b> is a
file containing a username and password on 2 lines, or
&quot;stdin&quot; to prompt from console.</p>


<p style="margin-left:22%; margin-top: 1em"><b>auth-method</b>
should be one of &quot;none&quot;, &quot;basic&quot;, or
&quot;ntlm&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">HTTP Digest
authentication is supported as well, but only via the
<b>auto</b> or <b>auto&minus;nct</b> flags (below).</p>

<p style="margin-left:22%; margin-top: 1em">The <b>auto</b>
flag causes OpenVPN to automatically determine the
<b>auth-method</b> and query stdin or the management
interface for username/password credentials, if required.
This flag exists on OpenVPN 2.1 or higher.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>auto&minus;nct</b> flag (no clear-text auth) instructs
OpenVPN to automatically determine the authentication
method, but to reject weak authentication protocols such as
HTTP Basic Authentication.</p>


<p style="margin-left:11%;"><b>&minus;&minus;http&minus;proxy&minus;retry</b></p>

<p style="margin-left:22%;">Retry indefinitely on HTTP
proxy errors. If an HTTP proxy error occurs, simulate a
SIGUSR1 reset.</p>


<p style="margin-left:11%;"><b>&minus;&minus;http&minus;proxy&minus;timeout
n</b></p>

<p style="margin-left:22%;">Set proxy timeout to <b>n</b>
seconds, default=5.</p>


<p style="margin-left:11%;"><b>&minus;&minus;http&minus;proxy&minus;option
type [parm]</b></p>

<p style="margin-left:22%;">Set extended HTTP proxy
options. Repeat to set multiple options.</p>

<p style="margin-left:22%; margin-top: 1em"><b>VERSION
version --</b> Set HTTP version number to <b>version</b>
(default=1.0).</p>

<p style="margin-left:22%; margin-top: 1em"><b>AGENT
user-agent --</b> Set HTTP &quot;User-Agent&quot; string to
<b>user-agent.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;socks&minus;proxy
server [port] [authfile]</b></p>

<p style="margin-left:22%;">Connect to remote host through
a Socks5 proxy at address <b>server</b> and port <b>port</b>
(default=1080). <b>authfile</b> (optional) is a file
containing a username and password on 2 lines, or
&quot;stdin&quot; to prompt from console.</p>


<p style="margin-left:11%;"><b>&minus;&minus;socks&minus;proxy&minus;retry</b></p>

<p style="margin-left:22%;">Retry indefinitely on Socks
proxy errors. If a Socks proxy error occurs, simulate a
SIGUSR1 reset.</p>


<p style="margin-left:11%;"><b>&minus;&minus;resolv&minus;retry
n</b></p>

<p style="margin-left:22%;">If hostname resolve fails for
<b>&minus;&minus;remote,</b> retry resolve for <b>n</b>
seconds before failing.</p>

<p style="margin-left:22%; margin-top: 1em">Set <b>n</b> to
&quot;infinite&quot; to retry indefinitely.</p>

<p style="margin-left:22%; margin-top: 1em">By default,
<b>&minus;&minus;resolv-retry infinite</b> is enabled. You
can disable by setting n=0.</p>

<p style="margin-left:11%;"><b>&minus;&minus;float</b></p>

<p style="margin-left:22%;">Allow remote peer to change its
IP address and/or port number, such as due to DHCP (this is
the default if <b>&minus;&minus;remote</b> is not used).
<b>&minus;&minus;float</b> when specified with
<b>&minus;&minus;remote</b> allows an OpenVPN session to
initially connect to a peer at a known address, however if
packets arrive from a new address and pass all
authentication tests, the new address will take control of
the session. This is useful when you are connecting to a
peer which holds a dynamic address such as a dial-in user or
DHCP client.</p>

<p style="margin-left:22%; margin-top: 1em">Essentially,
<b>&minus;&minus;float</b> tells OpenVPN to accept
authenticated packets from any address, not only the address
which was specified in the <b>&minus;&minus;remote</b>
option.</p>

<p style="margin-left:11%;"><b>&minus;&minus;ipchange
cmd</b></p>

<p style="margin-left:22%;">Run command <b>cmd</b> when our
remote ip-address is initially authenticated or changes.</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">When <b>cmd</b>
is executed two arguments are appended after any arguments
specified in <b>cmd</b> , as follows:</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd
ip_address port_number</b></p>

<p style="margin-left:22%; margin-top: 1em">Don&rsquo;t use
<b>&minus;&minus;ipchange</b> in <b>&minus;&minus;mode
server</b> mode. Use a
<b>&minus;&minus;client&minus;connect</b> script
instead.</p>

<p style="margin-left:22%; margin-top: 1em">See the
&quot;Environmental Variables&quot; section below for
additional parameters passed as environmental variables.</p>

<p style="margin-left:22%; margin-top: 1em">If you are
running in a dynamic IP address environment where the IP
addresses of either peer could change without notice, you
can use this script, for example, to edit the
<i>/etc/hosts</i> file with the current address of the peer.
The script will be run every time the remote peer changes
its IP address.</p>

<p style="margin-left:22%; margin-top: 1em">Similarly if
<i>our</i> IP address changes due to DHCP, we should
configure our IP address change script (see man page for
<b>dhcpcd</b>(8) ) to deliver a <b>SIGHUP</b> or
<b>SIGUSR1</b> signal to OpenVPN. OpenVPN will then
reestablish a connection with its most recently
authenticated peer on its new IP address.</p>

<p style="margin-left:11%;"><b>&minus;&minus;port
port</b></p>

<p style="margin-left:22%;">TCP/UDP port number or port
name for both local and remote (sets both
<b>&minus;&minus;lport</b> and <b>&minus;&minus;rport</b>
options to given port). The current default of 1194
represents the official IANA port number assignment for
OpenVPN and has been used since version 2.0-beta17. Previous
versions used port 5000 as the default.</p>

<p style="margin-left:11%;"><b>&minus;&minus;lport
port</b></p>

<p style="margin-left:22%;">Set local TCP/UDP port number
or name. Cannot be used together with
<b>&minus;&minus;nobind</b> option.</p>

<p style="margin-left:11%;"><b>&minus;&minus;rport
port</b></p>

<p style="margin-left:22%;">Set TCP/UDP port number or name
used by the <b>&minus;&minus;remote</b> option. The port can
also be set directly using the <b>&minus;&minus;remote</b>
option.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;bind</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Bind to local address and port. This is the default
unless any of <b>&minus;&minus;proto tcp&minus;client</b> ,
<b>&minus;&minus;http&minus;proxy</b> or
<b>&minus;&minus;socks&minus;proxy</b> are used.</p></td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;nobind</b></p>

<p style="margin-left:22%;">Do not bind to local address
and port. The IP stack will allocate a dynamic port for
returning packets. Since the value of the dynamic port could
not be known in advance by a peer, this option is only
suitable for peers which will be initiating connections by
using the <b>&minus;&minus;remote</b> option.</p>

<p style="margin-left:11%;"><b>&minus;&minus;dev tunX |
tapX | null</b></p>

<p style="margin-left:22%;">TUN/TAP virtual network device
( <b>X</b> can be omitted for a dynamic device.)</p>

<p style="margin-left:22%; margin-top: 1em">See examples
section below for an example on setting up a TUN device.</p>

<p style="margin-left:22%; margin-top: 1em">You must use
either tun devices on both ends of the connection or tap
devices on both ends. You cannot mix them, as they represent
different underlying network layers.</p>

<p style="margin-left:22%; margin-top: 1em"><b>tun</b>
devices encapsulate IPv4 or IPv6 (OSI Layer 3) while
<b>tap</b> devices encapsulate Ethernet 802.3 (OSI Layer
2).</p>


<p style="margin-left:11%;"><b>&minus;&minus;dev&minus;type
device-type</b></p>

<p style="margin-left:22%;">Which device type are we using?
<b>device-type</b> should be <b>tun</b> (OSI Layer 3) or
<b>tap</b> (OSI Layer 2). Use this option only if the
TUN/TAP device used with <b>&minus;&minus;dev</b> does not
begin with <b>tun</b> or <b>tap.</b></p>

<p style="margin-left:11%;"><b>&minus;&minus;topology
mode</b></p>

<p style="margin-left:22%;">Configure virtual addressing
topology when running in <b>&minus;&minus;dev tun</b> mode.
This directive has no meaning in <b>&minus;&minus;dev
tap</b> mode, which always uses a <b>subnet</b>
topology.</p>

<p style="margin-left:22%; margin-top: 1em">If you set this
directive on the server, the <b>&minus;&minus;server</b> and
<b>&minus;&minus;server&minus;bridge</b> directives will
automatically push your chosen topology setting to clients
as well. This directive can also be manually pushed to
clients. Like the <b>&minus;&minus;dev</b> directive, this
directive must always be compatible between client and
server.</p>

<p style="margin-left:22%; margin-top: 1em"><b>mode</b> can
be one of:</p>

<p style="margin-left:22%; margin-top: 1em"><b>net30 --</b>
Use a point-to-point topology, by allocating one /30 subnet
per client. This is designed to allow point-to-point
semantics when some or all of the connecting clients might
be Windows systems. This is the default on OpenVPN 2.0.</p>

<p style="margin-left:22%; margin-top: 1em"><b>p2p --</b>
Use a point-to-point topology where the remote endpoint of
the client&rsquo;s tun interface always points to the local
endpoint of the server&rsquo;s tun interface. This mode
allocates a single IP address per connecting client. Only
use when none of the connecting clients are Windows systems.
This mode is functionally equivalent to the
<b>&minus;&minus;ifconfig&minus;pool&minus;linear</b>
directive which is available in OpenVPN 2.0 and is now
deprecated.</p>

<p style="margin-left:22%; margin-top: 1em"><b>subnet
--</b> Use a subnet rather than a point-to-point topology by
configuring the tun interface with a local IP address and
subnet mask, similar to the topology used in
<b>&minus;&minus;dev tap</b> and ethernet bridging mode.
This mode allocates a single IP address per connecting
client and works on Windows as well. Only available when
server and clients are OpenVPN 2.1 or higher, or OpenVPN
2.0.x which has been manually patched with the
<b>&minus;&minus;topology</b> directive code. When used on
Windows, requires version 8.2 or higher of the TAP-Win32
driver. When used on *nix, requires that the tun driver
supports an <b>ifconfig</b>(8) command which sets a subnet
instead of a remote endpoint IP address.</p>

<p style="margin-left:22%; margin-top: 1em">This option
exists in OpenVPN 2.1 or higher.</p>

<p style="margin-left:22%; margin-top: 1em">Note: Using
<b>&minus;&minus;topology subnet</b> changes the
interpretation of the arguments of
<b>&minus;&minus;ifconfig</b> to mean &quot;address
netmask&quot;, no longer &quot;local remote&quot;.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tun&minus;ipv6</b></p>

<p style="margin-left:22%;">Build a tun link capable of
forwarding IPv6 traffic. Should be used in conjunction with
<b>&minus;&minus;dev tun</b> or <b>&minus;&minus;dev
tunX.</b> A warning will be displayed if no specific IPv6
TUN support for your OS has been compiled into OpenVPN.</p>

<p style="margin-left:22%; margin-top: 1em">See below for
further IPv6-related configuration options.</p>


<p style="margin-left:11%;"><b>&minus;&minus;dev&minus;node
node</b></p>

<p style="margin-left:22%;">Explicitly set the device node
rather than using /dev/net/tun, /dev/tun, /dev/tap, etc. If
OpenVPN cannot figure out whether <b>node</b> is a TUN or
TAP device based on the name, you should also specify
<b>&minus;&minus;dev&minus;type tun</b> or
<b>&minus;&minus;dev&minus;type tap.</b></p>

<p style="margin-left:22%; margin-top: 1em">Under Mac OS X
this option can be used to specify the default tun
implementation. Using <b>&minus;&minus;dev&minus;node
utun</b> forces usage of the native Darwin tun kernel
support. Use <b>&minus;&minus;dev&minus;node utunN</b> to
select a specific utun instance. To force using the tun.kext
(/dev/tunX) use <b>&minus;&minus;dev&minus;node tun</b>.
When not specifying a <b>&minus;&minus;dev&minus;node</b>
option openvpn will first try to open utun, and fall back to
tun.kext.</p>

<p style="margin-left:22%; margin-top: 1em">On Windows
systems, select the TAP-Win32 adapter which is named
<b>node</b> in the Network Connections Control Panel or the
raw GUID of the adapter enclosed by braces. The
<b>&minus;&minus;show&minus;adapters</b> option under
Windows can also be used to enumerate all available
TAP-Win32 adapters and will show both the network
connections control panel name and the GUID for each
TAP-Win32 adapter.</p>

<p style="margin-left:11%;"><b>&minus;&minus;lladdr
address</b></p>

<p style="margin-left:22%;">Specify the link layer address,
more commonly known as the MAC address. Only applied to TAP
devices.</p>

<p style="margin-left:11%;"><b>&minus;&minus;iproute
cmd</b></p>

<p style="margin-left:22%;">Set alternate command to
execute instead of default iproute2 command. May be used in
order to execute OpenVPN in unprivileged environment.</p>

<p style="margin-left:11%;"><b>&minus;&minus;ifconfig l
rn</b></p>

<p style="margin-left:22%;">Set TUN/TAP adapter parameters.
<b>l</b> is the IP address of the local VPN endpoint. For
TUN devices in point-to-point mode, <b>rn</b> is the IP
address of the remote VPN endpoint. For TAP devices, or TUN
devices used with <b>&minus;&minus;topology subnet, rn</b>
is the subnet mask of the virtual network segment which is
being created or connected to.</p>

<p style="margin-left:22%; margin-top: 1em">For TUN
devices, which facilitate virtual point-to-point IP
connections (when used in <b>&minus;&minus;topology
net30</b> or <b>p2p</b> mode), the proper usage of
<b>&minus;&minus;ifconfig</b> is to use two private IP
addresses which are not a member of any existing subnet
which is in use. The IP addresses may be consecutive and
should have their order reversed on the remote peer. After
the VPN is established, by pinging <b>rn,</b> you will be
pinging across the VPN.</p>

<p style="margin-left:22%; margin-top: 1em">For TAP
devices, which provide the ability to create virtual
ethernet segments, or TUN devices in
<b>&minus;&minus;topology subnet</b> mode (which create
virtual &quot;multipoint networks&quot;),
<b>&minus;&minus;ifconfig</b> is used to set an IP address
and subnet mask just as a physical ethernet adapter would be
similarly configured. If you are attempting to connect to a
remote ethernet bridge, the IP address and subnet should be
set to values which would be valid on the the bridged
ethernet segment (note also that DHCP can be used for the
same purpose).</p>

<p style="margin-left:22%; margin-top: 1em">This option,
while primarily a proxy for the <b>ifconfig</b>(8) command,
is designed to simplify TUN/TAP tunnel configuration by
providing a standard interface to the different ifconfig
implementations on different platforms.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;ifconfig</b>
parameters which are IP addresses can also be specified as a
DNS or /etc/hosts file resolvable name.</p>

<p style="margin-left:22%; margin-top: 1em">For TAP
devices, <b>&minus;&minus;ifconfig</b> should not be used if
the TAP interface will be getting an IP address lease from a
DHCP server.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;noexec</b></p>

<p style="margin-left:22%;">Don&rsquo;t actually execute
ifconfig/netsh commands, instead pass
<b>&minus;&minus;ifconfig</b> parameters to scripts using
environmental variables.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;nowarn</b></p>

<p style="margin-left:22%;">Don&rsquo;t output an options
consistency check warning if the
<b>&minus;&minus;ifconfig</b> option on this side of the
connection doesn&rsquo;t match the remote side. This is
useful when you want to retain the overall benefits of the
options consistency check (also see
<b>&minus;&minus;disable&minus;occ</b> option) while only
disabling the ifconfig component of the check.</p>

<p style="margin-left:22%; margin-top: 1em">For example, if
you have a configuration where the local host uses
<b>&minus;&minus;ifconfig</b> but the remote host does not,
use <b>&minus;&minus;ifconfig&minus;nowarn</b> on the local
host.</p>

<p style="margin-left:22%; margin-top: 1em">This option
will also silence warnings about potential address conflicts
which occasionally annoy more experienced users by
triggering &quot;false positive&quot; warnings.</p>

<p style="margin-left:11%;"><b>&minus;&minus;route
network/IP [netmask] [gateway] [metric]</b></p>

<p style="margin-left:22%;">Add route to routing table
after connection is established. Multiple routes can be
specified. Routes will be automatically torn down in reverse
order prior to TUN/TAP device close.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
intended as a convenience proxy for the <b>route</b>(8)
shell command, while at the same time providing portable
semantics across OpenVPN&rsquo;s platform space.</p>

<p style="margin-left:22%; margin-top: 1em"><b>netmask</b>
default -- 255.255.255.255</p>

<p style="margin-left:22%; margin-top: 1em"><b>gateway</b>
default -- taken from
<b>&minus;&minus;route&minus;gateway</b> or the second
parameter to <b>&minus;&minus;ifconfig</b> when
<b>&minus;&minus;dev tun</b> is specified.</p>

<p style="margin-left:22%; margin-top: 1em"><b>metric</b>
default &minus;&minus; taken from
<b>&minus;&minus;route&minus;metric</b> otherwise 0.</p>

<p style="margin-left:22%; margin-top: 1em">The default can
be specified by leaving an option blank or setting it to
&quot;default&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>network</b> and <b>gateway</b> parameters can also be
specified as a DNS or /etc/hosts file resolvable name, or as
one of three special keywords:</p>


<p style="margin-left:22%; margin-top: 1em"><b>vpn_gateway</b>
-- The remote VPN endpoint address (derived either from
<b>&minus;&minus;route&minus;gateway</b> or the second
parameter to <b>&minus;&minus;ifconfig</b> when
<b>&minus;&minus;dev tun</b> is specified).</p>


<p style="margin-left:22%; margin-top: 1em"><b>net_gateway</b>
-- The pre-existing IP default gateway, read from the
routing table (not supported on all OSes).</p>


<p style="margin-left:22%; margin-top: 1em"><b>remote_host</b>
-- The <b>&minus;&minus;remote</b> address if OpenVPN is
being run in client mode, and is undefined in server
mode.</p>


<p style="margin-left:11%;"><b>&minus;&minus;max&minus;routes
n</b></p>

<p style="margin-left:22%;">Allow a maximum number of n
<b>&minus;&minus;route</b> options to be specified, either
in the local configuration file, or pulled from an OpenVPN
server. By default, n=100.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;gateway
gw|&rsquo;dhcp&rsquo;</b></p>

<p style="margin-left:22%;">Specify a default gateway
<b>gw</b> for use with <b>&minus;&minus;route.</b></p>

<p style="margin-left:22%; margin-top: 1em">If <b>dhcp</b>
is specified as the parameter, the gateway address will be
extracted from a DHCP negotiation with the OpenVPN
server-side LAN.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;metric
m</b></p>

<p style="margin-left:22%;">Specify a default metric
<b>m</b> for use with <b>&minus;&minus;route.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;delay
[n] [w]</b></p>

<p style="margin-left:22%;">Delay <b>n</b> seconds
(default=0) after connection establishment, before adding
routes. If <b>n</b> is 0, routes will be added immediately
upon connection establishment. If
<b>&minus;&minus;route&minus;delay</b> is omitted, routes
will be added immediately after TUN/TAP device open and
<b>&minus;&minus;up</b> script execution, before any
<b>&minus;&minus;user</b> or <b>&minus;&minus;group</b>
privilege downgrade (or <b>&minus;&minus;chroot</b>
execution.)</p>

<p style="margin-left:22%; margin-top: 1em">This option is
designed to be useful in scenarios where DHCP is used to set
tap adapter addresses. The delay will give the DHCP
handshake time to complete before routes are added.</p>

<p style="margin-left:22%; margin-top: 1em">On Windows,
<b>&minus;&minus;route&minus;delay</b> tries to be more
intelligent by waiting <b>w</b> seconds (w=30 by default)
for the TAP-Win32 adapter to come up before adding
routes.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;up
cmd</b></p>

<p style="margin-left:22%;">Run command <b>cmd</b> after
routes are added, subject to
<b>&minus;&minus;route&minus;delay.</b></p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">See the
&quot;Environmental Variables&quot; section below for
additional parameters passed as environmental variables.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;pre&minus;down
cmd</b></p>

<p style="margin-left:22%;">Run command <b>cmd</b> before
routes are removed upon disconnection.</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">See the
&quot;Environmental Variables&quot; section below for
additional parameters passed as environmental variables.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;noexec</b></p>

<p style="margin-left:22%;">Don&rsquo;t add or remove
routes automatically. Instead pass routes to
<b>&minus;&minus;route&minus;up</b> script using
environmental variables.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;nopull</b></p>

<p style="margin-left:22%;">When used with
<b>&minus;&minus;client</b> or <b>&minus;&minus;pull,</b>
accept options pushed by server EXCEPT for routes and dhcp
options like DNS servers.</p>

<p style="margin-left:22%; margin-top: 1em">When used on
the client, this option effectively bars the server from
adding routes to the client&rsquo;s routing table, however
note that this option still allows the server to set the
TCP/IP properties of the client&rsquo;s TUN/TAP
interface.</p>


<p style="margin-left:11%;"><b>&minus;&minus;allow&minus;pull&minus;fqdn</b></p>

<p style="margin-left:22%;">Allow client to pull DNS names
from server (rather than being limited to IP address) for
<b>&minus;&minus;ifconfig, &minus;&minus;route,</b> and
<b>&minus;&minus;route&minus;gateway.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;nat
snat|dnat network netmask alias</b></p>

<p style="margin-left:22%;">This pushable client option
sets up a stateless one-to-one NAT rule on packet addresses
(not ports), and is useful in cases where routes or ifconfig
settings pushed to the client would create an IP numbering
conflict.</p>


<p style="margin-left:22%; margin-top: 1em"><b>network/netmask</b>
(for example 192.168.0.0/255.255.0.0) defines the local view
of a resource from the client perspective, while
<b>alias/netmask</b> (for example 10.64.0.0/255.255.0.0)
defines the remote view from the server perspective.</p>

<p style="margin-left:22%; margin-top: 1em">Use <b>snat</b>
(source NAT) for resources owned by the client and
<b>dnat</b> (destination NAT) for remote resources.</p>

<p style="margin-left:22%; margin-top: 1em">Set
<b>&minus;&minus;verb 6</b> for debugging info showing the
transformation of src/dest addresses in packets.</p>


<p style="margin-left:11%;"><b>&minus;&minus;redirect&minus;gateway
flags...</b></p>

<p style="margin-left:22%;">Automatically execute routing
commands to cause all outgoing IP traffic to be redirected
over the VPN. This is a client-side option.</p>

<p style="margin-left:22%; margin-top: 1em">This option
performs three steps:</p>

<p style="margin-left:22%; margin-top: 1em"><b>(1)</b>
Create a static route for the <b>&minus;&minus;remote</b>
address which forwards to the pre-existing default gateway.
This is done so that <b>(3)</b> will not create a routing
loop.</p>

<p style="margin-left:22%; margin-top: 1em"><b>(2)</b>
Delete the default gateway route.</p>

<p style="margin-left:22%; margin-top: 1em"><b>(3)</b> Set
the new default gateway to be the VPN endpoint address
(derived either from
<b>&minus;&minus;route&minus;gateway</b> or the second
parameter to <b>&minus;&minus;ifconfig</b> when
<b>&minus;&minus;dev tun</b> is specified).</p>

<p style="margin-left:22%; margin-top: 1em">When the tunnel
is torn down, all of the above steps are reversed so that
the original default route is restored.</p>

<p style="margin-left:22%; margin-top: 1em">Option
flags:</p>

<p style="margin-left:22%; margin-top: 1em"><b>local --</b>
Add the <b>local</b> flag if both OpenVPN servers are
directly connected via a common subnet, such as with
wireless. The <b>local</b> flag will cause step <b>1</b>
above to be omitted.</p>

<p style="margin-left:22%; margin-top: 1em"><b>autolocal
--</b> Try to automatically determine whether to enable
<b>local</b> flag above.</p>

<p style="margin-left:22%; margin-top: 1em"><b>def1 --</b>
Use this flag to override the default gateway by using
0.0.0.0/1 and 128.0.0.0/1 rather than 0.0.0.0/0. This has
the benefit of overriding but not wiping out the original
default gateway.</p>

<p style="margin-left:22%; margin-top: 1em"><b>bypass-dhcp
--</b> Add a direct route to the DHCP server (if it is
non-local) which bypasses the tunnel (Available on Windows
clients, may not be available on non-Windows clients).</p>

<p style="margin-left:22%; margin-top: 1em"><b>bypass-dns
--</b> Add a direct route to the DNS server(s) (if they are
non-local) which bypasses the tunnel (Available on Windows
clients, may not be available on non-Windows clients).</p>

<p style="margin-left:22%; margin-top: 1em"><b>block-local
--</b> Block access to local LAN when the tunnel is active,
except for the LAN gateway itself. This is accomplished by
routing the local LAN (except for the LAN gateway address)
into the tunnel.</p>


<p style="margin-left:11%;"><b>&minus;&minus;link&minus;mtu
n</b></p>

<p style="margin-left:22%;">Sets an upper bound on the size
of UDP packets which are sent between OpenVPN peers.
It&rsquo;s best not to set this parameter unless you know
what you&rsquo;re doing.</p>


<p style="margin-left:11%;"><b>&minus;&minus;redirect&minus;private
[flags]</b></p>

<p style="margin-left:22%;">Like
&minus;&minus;redirect&minus;gateway, but omit actually
changing the default gateway. Useful when pushing private
subnets.</p>

<p style="margin-left:11%;"><b>&minus;&minus;tun&minus;mtu
n</b></p>

<p style="margin-left:22%;">Take the TUN device MTU to be
<b>n</b> and derive the link MTU from it (default=1500). In
most cases, you will probably want to leave this parameter
set to its default value.</p>

<p style="margin-left:22%; margin-top: 1em">The MTU
(Maximum Transmission Units) is the maximum datagram size in
bytes that can be sent unfragmented over a particular
network path. OpenVPN requires that packets on the control
or data channels be sent unfragmented.</p>

<p style="margin-left:22%; margin-top: 1em">MTU problems
often manifest themselves as connections which hang during
periods of active usage.</p>

<p style="margin-left:22%; margin-top: 1em">It&rsquo;s best
to use the <b>&minus;&minus;fragment</b> and/or
<b>&minus;&minus;mssfix</b> options to deal with MTU sizing
issues.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tun&minus;mtu&minus;extra
n</b></p>

<p style="margin-left:22%;">Assume that the TUN/TAP device
might return as many as <b>n</b> bytes more than the
<b>&minus;&minus;tun&minus;mtu</b> size on read. This
parameter defaults to 0, which is sufficient for most TUN
devices. TAP devices may introduce additional overhead in
excess of the MTU size, and a setting of 32 is the default
when TAP devices are used. This parameter only controls
internal OpenVPN buffer sizing, so there is no transmission
overhead associated with using a larger value.</p>


<p style="margin-left:11%;"><b>&minus;&minus;mtu&minus;disc
type</b></p>

<p style="margin-left:22%;">Should we do Path MTU discovery
on TCP/UDP channel? Only supported on OSes such as Linux
that supports the necessary system call to set.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&rsquo;no&rsquo;</b>
-- Never send DF (Don&rsquo;t Fragment) frames <b><br>
&rsquo;maybe&rsquo;</b> -- Use per-route hints <b><br>
&rsquo;yes&rsquo;</b> -- Always DF (Don&rsquo;t
Fragment)</p>


<p style="margin-left:11%;"><b>&minus;&minus;mtu&minus;test</b></p>

<p style="margin-left:22%;">To empirically measure MTU on
connection startup, add the
<b>&minus;&minus;mtu&minus;test</b> option to your
configuration. OpenVPN will send ping packets of various
sizes to the remote peer and measure the largest packets
which were successfully received. The
<b>&minus;&minus;mtu&minus;test</b> process normally takes
about 3 minutes to complete.</p>

<p style="margin-left:11%;"><b>&minus;&minus;fragment
max</b></p>

<p style="margin-left:22%;">Enable internal datagram
fragmentation so that no UDP datagrams are sent which are
larger than <b>max</b> bytes.</p>

<p style="margin-left:22%; margin-top: 1em">The <b>max</b>
parameter is interpreted in the same way as the
<b>&minus;&minus;link&minus;mtu</b> parameter, i.e. the UDP
packet size after encapsulation overhead has been added in,
but not including the UDP header itself.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>&minus;&minus;fragment</b> option only makes sense when
you are using the UDP protocol ( <b>&minus;&minus;proto
udp</b> ).</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;fragment</b>
adds 4 bytes of overhead per datagram.</p>

<p style="margin-left:22%; margin-top: 1em">See the
<b>&minus;&minus;mssfix</b> option below for an important
related option to <b>&minus;&minus;fragment.</b></p>

<p style="margin-left:22%; margin-top: 1em">It should also
be noted that this option is not meant to replace UDP
fragmentation at the IP stack level. It is only meant as a
last resort when path MTU discovery is broken. Using this
option is less efficient than fixing path MTU discovery for
your IP link and using native IP fragmentation instead.</p>

<p style="margin-left:22%; margin-top: 1em">Having said
that, there are circumstances where using OpenVPN&rsquo;s
internal fragmentation capability may be your only option,
such as tunneling a UDP multicast stream which requires
fragmentation.</p>

<p style="margin-left:11%;"><b>&minus;&minus;mssfix
max</b></p>

<p style="margin-left:22%;">Announce to TCP sessions
running over the tunnel that they should limit their send
packet sizes such that after OpenVPN has encapsulated them,
the resulting UDP packet size that OpenVPN sends to its peer
will not exceed <b>max</b> bytes. The default value is
<b>1450.</b></p>

<p style="margin-left:22%; margin-top: 1em">The <b>max</b>
parameter is interpreted in the same way as the
<b>&minus;&minus;link&minus;mtu</b> parameter, i.e. the UDP
packet size after encapsulation overhead has been added in,
but not including the UDP header itself.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>&minus;&minus;mssfix</b> option only makes sense when you
are using the UDP protocol for OpenVPN peer-to-peer
communication, i.e. <b>&minus;&minus;proto udp.</b></p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;mssfix</b>
and <b>&minus;&minus;fragment</b> can be ideally used
together, where <b>&minus;&minus;mssfix</b> will try to keep
TCP from needing packet fragmentation in the first place,
and if big packets come through anyhow (from protocols other
than TCP), <b>&minus;&minus;fragment</b> will internally
fragment them.</p>

<p style="margin-left:22%; margin-top: 1em">Both
<b>&minus;&minus;fragment</b> and
<b>&minus;&minus;mssfix</b> are designed to work around
cases where Path MTU discovery is broken on the network path
between OpenVPN peers.</p>

<p style="margin-left:22%; margin-top: 1em">The usual
symptom of such a breakdown is an OpenVPN connection which
successfully starts, but then stalls during active
usage.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>&minus;&minus;fragment</b> and
<b>&minus;&minus;mssfix</b> are used together,
<b>&minus;&minus;mssfix</b> will take its default <b>max</b>
parameter from the <b>&minus;&minus;fragment max</b>
option.</p>

<p style="margin-left:22%; margin-top: 1em">Therefore, one
could lower the maximum UDP packet size to 1300 (a good
first try for solving MTU-related connection problems) with
the following options:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;tun&minus;mtu
1500 &minus;&minus;fragment 1300
&minus;&minus;mssfix</b></p>

<p style="margin-left:11%;"><b>&minus;&minus;sndbuf
size</b></p>

<p style="margin-left:22%;">Set the TCP/UDP socket send
buffer size. Currently defaults to 65536 bytes.</p>

<p style="margin-left:11%;"><b>&minus;&minus;rcvbuf
size</b></p>

<p style="margin-left:22%;">Set the TCP/UDP socket receive
buffer size. Currently defaults to 65536 bytes.</p>

<p style="margin-left:11%;"><b>&minus;&minus;mark
value</b></p>

<p style="margin-left:22%;">Mark encrypted packets being
sent with value. The mark value can be matched in policy
routing and packetfilter rules. This option is only
supported in Linux and does nothing on other operating
systems.</p>


<p style="margin-left:11%;"><b>&minus;&minus;socket&minus;flags
flags...</b></p>

<p style="margin-left:22%;">Apply the given flags to the
OpenVPN transport socket. Currently, only <b>TCP_NODELAY</b>
is supported.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>TCP_NODELAY</b> socket flag is useful in TCP mode, and
causes the kernel to send tunnel packets immediately over
the TCP connection without trying to group several smaller
packets into a larger packet. This can result in a
considerably improvement in latency.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
pushable from server to client, and should be used on both
client and server for maximum effect.</p>

<p style="margin-left:11%;"><b>&minus;&minus;txqueuelen
n</b></p>

<p style="margin-left:22%;">(Linux only) Set the TX queue
length on the TUN/TAP interface. Currently defaults to
100.</p>

<p style="margin-left:11%;"><b>&minus;&minus;shaper
n</b></p>

<p style="margin-left:22%;">Limit bandwidth of outgoing
tunnel data to <b>n</b> bytes per second on the TCP/UDP
port. Note that this will only work if mode is set to p2p.
If you want to limit the bandwidth in both directions, use
this option on both peers.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN uses
the following algorithm to implement traffic shaping: Given
a shaper rate of <i>n</i> bytes per second, after a datagram
write of <i>b</i> bytes is queued on the TCP/UDP port, wait
a minimum of <i>(b / n)</i> seconds before queuing the next
write.</p>

<p style="margin-left:22%; margin-top: 1em">It should be
noted that OpenVPN supports multiple tunnels between the
same two peers, allowing you to construct full-speed and
reduced bandwidth tunnels at the same time, routing
low-priority data such as off-site backups over the reduced
bandwidth tunnel, and other data over the full-speed
tunnel.</p>

<p style="margin-left:22%; margin-top: 1em">Also note that
for low bandwidth tunnels (under 1000 bytes per second), you
should probably use lower MTU values as well (see above),
otherwise the packet latency will grow so large as to
trigger timeouts in the TLS layer and TCP connections
running over the tunnel.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN allows
<b>n</b> to be between 100 bytes/sec and 100 Mbytes/sec.</p>

<p style="margin-left:11%;"><b>&minus;&minus;inactive n
[bytes]</b></p>

<p style="margin-left:22%;">Causes OpenVPN to exit after
<b>n</b> seconds of inactivity on the TUN/TAP device. The
time length of inactivity is measured since the last
incoming or outgoing tunnel packet. The default value is 0
seconds, which disables this feature.</p>

<p style="margin-left:22%; margin-top: 1em">If the optional
<b>bytes</b> parameter is included, exit if less than
<b>bytes</b> of combined in/out traffic are produced on the
tun/tap device in <b>n</b> seconds.</p>

<p style="margin-left:22%; margin-top: 1em">In any case,
OpenVPN&rsquo;s internal ping packets (which are just
keepalives) and TLS control packets are not considered
&quot;activity&quot;, nor are they counted as traffic, as
they are used internally by OpenVPN and are not an
indication of actual user activity.</p>

<p style="margin-left:11%;"><b>&minus;&minus;ping n</b></p>

<p style="margin-left:22%;">Ping remote over the TCP/UDP
control channel if no packets have been sent for at least
<b>n</b> seconds (specify <b>&minus;&minus;ping</b> on both
peers to cause ping packets to be sent in both directions
since OpenVPN ping packets are not echoed like IP ping
packets). When used in one of OpenVPN&rsquo;s secure modes
(where <b>&minus;&minus;secret,
&minus;&minus;tls&minus;server,</b> or
<b>&minus;&minus;tls&minus;client</b> is specified), the
ping packet will be cryptographically secure.</p>

<p style="margin-left:22%; margin-top: 1em">This option has
two intended uses:</p>

<p style="margin-left:22%; margin-top: 1em">(1)
Compatibility with stateful firewalls. The periodic ping
will ensure that a stateful firewall rule which allows
OpenVPN UDP packets to pass will not time out.</p>

<p style="margin-left:22%; margin-top: 1em">(2) To provide
a basis for the remote to test the existence of its peer
using the <b>&minus;&minus;ping&minus;exit</b> option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ping&minus;exit
n</b></p>

<p style="margin-left:22%;">Causes OpenVPN to exit after
<b>n</b> seconds pass without reception of a ping or other
packet from remote. This option can be combined with
<b>&minus;&minus;inactive, &minus;&minus;ping,</b> and
<b>&minus;&minus;ping&minus;exit</b> to create a two-tiered
inactivity disconnect.</p>

<p style="margin-left:22%; margin-top: 1em">For
example,</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
[options...] &minus;&minus;inactive 3600 &minus;&minus;ping
10 &minus;&minus;ping&minus;exit 60</b></p>

<p style="margin-left:22%; margin-top: 1em">when used on
both peers will cause OpenVPN to exit within 60 seconds if
its peer disconnects, but will exit after one hour if no
actual tunnel data is exchanged.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ping&minus;restart
n</b></p>

<p style="margin-left:22%;">Similar to
<b>&minus;&minus;ping&minus;exit,</b> but trigger a
<b>SIGUSR1</b> restart after <b>n</b> seconds pass without
reception of a ping or other packet from remote.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
useful in cases where the remote peer has a dynamic IP
address and a low-TTL DNS name is used to track the IP
address using a service such as <i>http://dyndns.org/</i> +
a dynamic DNS client such as <b>ddclient.</b></p>

<p style="margin-left:22%; margin-top: 1em">If the peer
cannot be reached, a restart will be triggered, causing the
hostname used with <b>&minus;&minus;remote</b> to be
re-resolved (if <b>&minus;&minus;resolv&minus;retry</b> is
also specified).</p>

<p style="margin-left:22%; margin-top: 1em">In server mode,
<b>&minus;&minus;ping&minus;restart,
&minus;&minus;inactive,</b> or any other type of internally
generated signal will always be applied to individual client
instance objects, never to whole server itself. Note also in
server mode that any internally generated signal which would
normally cause a restart, will cause the deletion of the
client instance object instead.</p>

<p style="margin-left:22%; margin-top: 1em">In client mode,
the <b>&minus;&minus;ping&minus;restart</b> parameter is set
to 120 seconds by default. This default will hold until the
client pulls a replacement value from the server, based on
the <b>&minus;&minus;keepalive</b> setting in the server
configuration. To disable the 120 second default, set
<b>&minus;&minus;ping&minus;restart 0</b> on the client.</p>

<p style="margin-left:22%; margin-top: 1em">See the signals
section below for more information on <b>SIGUSR1.</b></p>

<p style="margin-left:22%; margin-top: 1em">Note that the
behavior of <b>SIGUSR1</b> can be modified by the
<b>&minus;&minus;persist&minus;tun,
&minus;&minus;persist&minus;key,
&minus;&minus;persist&minus;local&minus;ip,</b> and
<b>&minus;&minus;persist&minus;remote&minus;ip</b>
options.</p>

<p style="margin-left:22%; margin-top: 1em">Also note that
<b>&minus;&minus;ping&minus;exit</b> and
<b>&minus;&minus;ping&minus;restart</b> are mutually
exclusive and cannot be used together.</p>

<p style="margin-left:11%;"><b>&minus;&minus;keepalive n
m</b></p>

<p style="margin-left:22%;">A helper directive designed to
simplify the expression of <b>&minus;&minus;ping</b> and
<b>&minus;&minus;ping&minus;restart</b> in server mode
configurations.</p>

<p style="margin-left:22%; margin-top: 1em">The server
timeout is set twice the value of the second argument. This
ensures that a timeout is detected on client side before the
server side drops the connection.</p>

<p style="margin-left:22%; margin-top: 1em">For example,
<b>&minus;&minus;keepalive 10 60</b> expands as follows:</p>

<p style="margin-left:28%; margin-top: 1em"><b>if mode
server: <br>
ping 10 <br>
ping-restart 120 <br>
push &quot;ping 10&quot; <br>
push &quot;ping-restart 60&quot; <br>
else <br>
ping 10 <br>
ping-restart 60</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;ping&minus;timer&minus;rem</b></p>

<p style="margin-left:22%;">Run the
<b>&minus;&minus;ping&minus;exit</b> /
<b>&minus;&minus;ping&minus;restart</b> timer only if we
have a remote address. Use this option if you are starting
the daemon in listen mode (i.e. without an explicit
<b>&minus;&minus;remote</b> peer), and you don&rsquo;t want
to start clocking timeouts until a remote peer connects.</p>


<p style="margin-left:11%;"><b>&minus;&minus;persist&minus;tun</b></p>

<p style="margin-left:22%;">Don&rsquo;t close and reopen
TUN/TAP device or run up/down scripts across <b>SIGUSR1</b>
or <b>&minus;&minus;ping&minus;restart</b> restarts.</p>

<p style="margin-left:22%; margin-top: 1em"><b>SIGUSR1</b>
is a restart signal similar to <b>SIGHUP,</b> but which
offers finer-grained control over reset options.</p>


<p style="margin-left:11%;"><b>&minus;&minus;persist&minus;key</b></p>

<p style="margin-left:22%;">Don&rsquo;t re-read key files
across <b>SIGUSR1</b> or
<b>&minus;&minus;ping&minus;restart.</b></p>

<p style="margin-left:22%; margin-top: 1em">This option can
be combined with <b>&minus;&minus;user nobody</b> to allow
restarts triggered by the <b>SIGUSR1</b> signal. Normally if
you drop root privileges in OpenVPN, the daemon cannot be
restarted since it will now be unable to re-read protected
key files.</p>

<p style="margin-left:22%; margin-top: 1em">This option
solves the problem by persisting keys across <b>SIGUSR1</b>
resets, so they don&rsquo;t need to be re-read.</p>


<p style="margin-left:11%;"><b>&minus;&minus;persist&minus;local&minus;ip</b></p>

<p style="margin-left:22%;">Preserve initially resolved
local IP address and port number across <b>SIGUSR1</b> or
<b>&minus;&minus;ping&minus;restart</b> restarts.</p>


<p style="margin-left:11%;"><b>&minus;&minus;persist&minus;remote&minus;ip</b></p>

<p style="margin-left:22%;">Preserve most recently
authenticated remote IP address and port number across
<b>SIGUSR1</b> or <b>&minus;&minus;ping&minus;restart</b>
restarts.</p>

<p style="margin-left:11%;"><b>&minus;&minus;mlock</b></p>

<p style="margin-left:22%;">Disable paging by calling the
POSIX mlockall function. Requires that OpenVPN be initially
run as root (though OpenVPN can subsequently downgrade its
UID using the <b>&minus;&minus;user</b> option).</p>

<p style="margin-left:22%; margin-top: 1em">Using this
option ensures that key material and tunnel data are never
written to disk due to virtual memory paging operations
which occur under most modern operating systems. It ensures
that even if an attacker was able to crack the box running
OpenVPN, he would not be able to scan the system swap file
to recover previously used ephemeral keys, which are used
for a period of time governed by the
<b>&minus;&minus;reneg</b> options (see below), then are
discarded.</p>

<p style="margin-left:22%; margin-top: 1em">The downside of
using <b>&minus;&minus;mlock</b> is that it will reduce the
amount of physical memory available to other
applications.</p>

<p style="margin-left:11%;"><b>&minus;&minus;up cmd</b></p>

<p style="margin-left:22%;">Run command <b>cmd</b> after
successful TUN/TAP device open (pre
<b>&minus;&minus;user</b> UID change).</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">The up command
is useful for specifying route commands which route IP
traffic destined for private subnets which exist at the
other end of the VPN connection into the tunnel.</p>

<p style="margin-left:22%; margin-top: 1em">For
<b>&minus;&minus;dev tun</b> execute as:</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd tun_dev
tun_mtu link_mtu ifconfig_local_ip ifconfig_remote_ip [ init
| restart ]</b></p>

<p style="margin-left:22%; margin-top: 1em">For
<b>&minus;&minus;dev tap</b> execute as:</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd tap_dev
tap_mtu link_mtu ifconfig_local_ip ifconfig_netmask [ init |
restart ]</b></p>

<p style="margin-left:22%; margin-top: 1em">See the
&quot;Environmental Variables&quot; section below for
additional parameters passed as environmental variables.</p>

<p style="margin-left:22%; margin-top: 1em">Note that if
<b>cmd</b> includes arguments, all OpenVPN-generated
arguments will be appended to them to build an argument list
with which the executable will be called.</p>

<p style="margin-left:22%; margin-top: 1em">Typically,
<b>cmd</b> will run a script to add routes to the
tunnel.</p>

<p style="margin-left:22%; margin-top: 1em">Normally the up
script is called after the TUN/TAP device is opened. In this
context, the last command line parameter passed to the
script will be <i>init.</i> If the
<b>&minus;&minus;up&minus;restart</b> option is also used,
the up script will be called for restarts as well. A restart
is considered to be a partial reinitialization of OpenVPN
where the TUN/TAP instance is preserved (the
<b>&minus;&minus;persist&minus;tun</b> option will enable
such preservation). A restart can be generated by a SIGUSR1
signal, a <b>&minus;&minus;ping&minus;restart</b> timeout,
or a connection reset when the TCP protocol is enabled with
the <b>&minus;&minus;proto</b> option. If a restart occurs,
and <b>&minus;&minus;up&minus;restart</b> has been
specified, the up script will be called with <i>restart</i>
as the last parameter.</p>

<p style="margin-left:22%; margin-top: 1em">NOTE: on
restart, OpenVPN will not pass the full set of environment
variables to the script. Namely, everything related to
routing and gateways will not be passed, as nothing needs to
be done anyway - all the routing setup is already in place.
Additionally, the up&minus;restart script will run with the
downgraded UID/GID settings (if configured).</p>

<p style="margin-left:22%; margin-top: 1em">The following
standalone example shows how the <b>&minus;&minus;up</b>
script can be called in both an initialization and restart
context. (NOTE: for security reasons, don&rsquo;t run the
following example unless UDP port 9999 is blocked by your
firewall. Also, the example will run indefinitely, so you
should abort with control-c).</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;dev tun &minus;&minus;port 9999
&minus;&minus;verb 4 &minus;&minus;ping&minus;restart 10
&minus;&minus;up &rsquo;echo up&rsquo; &minus;&minus;down
&rsquo;echo down&rsquo; &minus;&minus;persist&minus;tun
&minus;&minus;up&minus;restart</b></p>

<p style="margin-left:22%; margin-top: 1em">Note that
OpenVPN also provides the <b>&minus;&minus;ifconfig</b>
option to automatically ifconfig the TUN device, eliminating
the need to define an <b>&minus;&minus;up</b> script, unless
you also want to configure routes in the
<b>&minus;&minus;up</b> script.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>&minus;&minus;ifconfig</b> is also specified, OpenVPN
will pass the ifconfig local and remote endpoints on the
command line to the <b>&minus;&minus;up</b> script so that
they can be used to configure routes such as:</p>

<p style="margin-left:22%; margin-top: 1em"><b>route add
&minus;net 10.0.0.0 netmask 255.255.255.0 gw $5</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;up&minus;delay</b></p>

<p style="margin-left:22%;">Delay TUN/TAP open and possible
<b>&minus;&minus;up</b> script execution until after TCP/UDP
connection establishment with peer.</p>

<p style="margin-left:22%; margin-top: 1em">In
<b>&minus;&minus;proto udp</b> mode, this option normally
requires the use of <b>&minus;&minus;ping</b> to allow
connection initiation to be sensed in the absence of tunnel
data, since UDP is a &quot;connectionless&quot;
protocol.</p>

<p style="margin-left:22%; margin-top: 1em">On Windows,
this option will delay the TAP-Win32 media state
transitioning to &quot;connected&quot; until connection
establishment, i.e. the receipt of the first authenticated
packet from the peer.</p>

<p style="margin-left:11%;"><b>&minus;&minus;down
cmd</b></p>

<p style="margin-left:22%;">Run command <b>cmd</b> after
TUN/TAP device close (post <b>&minus;&minus;user</b> UID
change and/or <b>&minus;&minus;chroot</b> ). <b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">Called with the
same parameters and environmental variables as the
<b>&minus;&minus;up</b> option above.</p>

<p style="margin-left:22%; margin-top: 1em">Note that if
you reduce privileges by using <b>&minus;&minus;user</b>
and/or <b>&minus;&minus;group,</b> your
<b>&minus;&minus;down</b> script will also run at reduced
privilege.</p>


<p style="margin-left:11%;"><b>&minus;&minus;down&minus;pre</b></p>

<p style="margin-left:22%;">Call <b>&minus;&minus;down</b>
cmd/script before, rather than after, TUN/TAP close.</p>


<p style="margin-left:11%;"><b>&minus;&minus;up&minus;restart</b></p>

<p style="margin-left:22%;">Enable the
<b>&minus;&minus;up</b> and <b>&minus;&minus;down</b>
scripts to be called for restarts as well as initial program
start. This option is described more fully above in the
<b>&minus;&minus;up</b> option documentation.</p>

<p style="margin-left:11%;"><b>&minus;&minus;setenv name
value</b></p>

<p style="margin-left:22%;">Set a custom environmental
variable <b>name=value</b> to pass to script.</p>

<p style="margin-left:11%;"><b>&minus;&minus;setenv
FORWARD_COMPATIBLE 1</b></p>

<p style="margin-left:22%;">Relax config file syntax
checking so that unknown directives will trigger a warning
but not a fatal error, on the assumption that a given
unknown directive might be valid in future OpenVPN
versions.</p>

<p style="margin-left:22%; margin-top: 1em">This option
should be used with caution, as there are good security
reasons for having OpenVPN fail if it detects problems in a
config file. Having said that, there are valid reasons for
wanting new software features to gracefully degrade when
encountered by older software versions.</p>

<p style="margin-left:22%; margin-top: 1em">It is also
possible to tag a single directive so as not to trigger a
fatal error if the directive isn&rsquo;t recognized. To do
this, prepend the following before the directive: <b>setenv
opt</b></p>

<p style="margin-left:22%; margin-top: 1em">Versions prior
to OpenVPN 2.3.3 will always ignore options set with the
<b>setenv opt</b> directive.</p>

<p style="margin-left:22%; margin-top: 1em">See also
<b>&minus;&minus;ignore&minus;unknown&minus;option</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;setenv&minus;safe
name value</b></p>

<p style="margin-left:22%;">Set a custom environmental
variable <b>OPENVPN_name=value</b> to pass to script.</p>

<p style="margin-left:22%; margin-top: 1em">This directive
is designed to be pushed by the server to clients, and the
prepending of &quot;OPENVPN_&quot; to the environmental
variable is a safety precaution to prevent a LD_PRELOAD
style attack from a malicious or compromised server.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ignore&minus;unknown&minus;option
opt1 opt2 opt3 ... optN</b></p>

<p style="margin-left:22%;">When one of options <b>opt1 ...
optN</b> is encountered in the configuration file the
configuration file parsing does not fail if this OpenVPN
version does not support the option. Multiple
<b>&minus;&minus;ignore&minus;unknown&minus;option</b>
options can be given to support a larger number of options
to ignore.</p>

<p style="margin-left:22%; margin-top: 1em">This option
should be used with caution, as there are good security
reasons for having OpenVPN fail if it detects problems in a
config file. Having said that, there are valid reasons for
wanting new software features to gracefully degrade when
encountered by older software versions.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;ignore&minus;unknown&minus;option</b>
is available since OpenVPN 2.3.3.</p>


<p style="margin-left:11%;"><b>&minus;&minus;script&minus;security
level</b></p>

<p style="margin-left:22%;">This directive offers
policy-level control over OpenVPN&rsquo;s usage of external
programs and scripts. Lower <b>level</b> values are more
restrictive, higher values are more permissive. Settings for
<b>level:</b></p>

<p style="margin-left:22%; margin-top: 1em"><b>0 --</b>
Strictly no calling of external programs. <b><br>
1 --</b> (Default) Only call built-in executables such as
ifconfig, ip, route, or netsh. <b><br>
2 --</b> Allow calling of built-in executables and
user-defined scripts. <b><br>
3 --</b> Allow passwords to be passed to scripts via
environmental variables (potentially unsafe).</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN
releases before v2.3 also supported a <b>method</b> flag
which indicated how OpenVPN should call external commands
and scripts. This could be either <b>execve</b> or
<b>system.</b> As of OpenVPN v2.3, this flag is no longer
accepted. In most *nix environments the execve() approach
has been used without any issues.</p>

<p style="margin-left:22%; margin-top: 1em">Some directives
such as &minus;&minus;up allow options to be passed to the
external script. In these cases make sure the script name
does not contain any spaces or the configuration parser will
choke because it can&rsquo;t determine where the script name
ends and script options start.</p>

<p style="margin-left:22%; margin-top: 1em">To run scripts
in Windows in earlier OpenVPN versions you needed to either
add a full path to the script interpreter which can parse
the script or use the <b>system</b> flag to run these
scripts. As of OpenVPN v2.3 it is now a strict requirement
to have full path to the script interpreter when running
non-executables files. This is not needed for executable
files, such as .exe, .com, .bat or .cmd files. For example,
if you have a Visual Basic script, you must use this syntax
now:</p>


<p style="margin-left:28%; margin-top: 1em"><b>&minus;&minus;up
&rsquo;C:\\Windows\\System32\\wscript.exe C:\\Program\
Files\\OpenVPN\\config\\my-up-script.vbs&rsquo;</b></p>

<p style="margin-left:22%; margin-top: 1em">Please note the
single quote marks and the escaping of the backslashes (\)
and the space character.</p>

<p style="margin-left:22%; margin-top: 1em">The reason the
support for the <b>system</b> flag was removed is due to the
security implications with shell expansions when executing
scripts via the system() call.</p>


<p style="margin-left:11%;"><b>&minus;&minus;disable&minus;occ</b></p>

<p style="margin-left:22%;">Don&rsquo;t output a warning
message if option inconsistencies are detected between
peers. An example of an option inconsistency would be where
one peer uses <b>&minus;&minus;dev tun</b> while the other
peer uses <b>&minus;&minus;dev tap.</b></p>

<p style="margin-left:22%; margin-top: 1em">Use of this
option is discouraged, but is provided as a temporary fix in
situations where a recent version of OpenVPN must connect to
an old version.</p>

<p style="margin-left:11%;"><b>&minus;&minus;user
user</b></p>

<p style="margin-left:22%;">Change the user ID of the
OpenVPN process to <b>user</b> after initialization,
dropping privileges in the process. This option is useful to
protect the system in the event that some hostile party was
able to gain control of an OpenVPN session. Though
OpenVPN&rsquo;s security features make this unlikely, it is
provided as a second line of defense.</p>

<p style="margin-left:22%; margin-top: 1em">By setting
<b>user</b> to <i>nobody</i> or somebody similarly
unprivileged, the hostile party would be limited in what
damage they could cause. Of course once you take away
privileges, you cannot return them to an OpenVPN session.
This means, for example, that if you want to reset an
OpenVPN daemon with a <b>SIGUSR1</b> signal (for example in
response to a DHCP reset), you should make use of one or
more of the <b>&minus;&minus;persist</b> options to ensure
that OpenVPN doesn&rsquo;t need to execute any privileged
operations in order to restart (such as re-reading key files
or running <b>ifconfig</b> on the TUN device).</p>

<p style="margin-left:11%;"><b>&minus;&minus;group
group</b></p>

<p style="margin-left:22%;">Similar to the
<b>&minus;&minus;user</b> option, this option changes the
group ID of the OpenVPN process to <b>group</b> after
initialization.</p>

<p style="margin-left:11%;"><b>&minus;&minus;cd dir</b></p>

<p style="margin-left:22%;">Change directory to <b>dir</b>
prior to reading any files such as configuration files, key
files, scripts, etc. <b>dir</b> should be an absolute path,
with a leading &quot;/&quot;, and without any references to
the current directory such as &quot;.&quot; or
&quot;..&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
useful when you are running OpenVPN in
<b>&minus;&minus;daemon</b> mode, and you want to
consolidate all of your OpenVPN control files in one
location.</p>

<p style="margin-left:11%;"><b>&minus;&minus;chroot
dir</b></p>

<p style="margin-left:22%;">Chroot to <b>dir</b> after
initialization. <b>&minus;&minus;chroot</b> essentially
redefines <b>dir</b> as being the top level directory tree
(/). OpenVPN will therefore be unable to access any files
outside this tree. This can be desirable from a security
standpoint.</p>

<p style="margin-left:22%; margin-top: 1em">Since the
chroot operation is delayed until after initialization, most
OpenVPN options that reference files will operate in a
pre-chroot context.</p>

<p style="margin-left:22%; margin-top: 1em">In many cases,
the <b>dir</b> parameter can point to an empty directory,
however complications can result when scripts or restarts
are executed after the chroot operation.</p>

<p style="margin-left:22%; margin-top: 1em">Note: if
OpenVPN is built using the PolarSSL SSL library,
<b>&minus;&minus;chroot</b> will only work if a /dev/urandom
device node is available inside the chroot directory
<b>dir.</b> This is due to the way PolarSSL works (it wants
to open /dev/urandom every time randomness is needed, not
just once at startup) and nothing OpenVPN can influence.</p>

<p style="margin-left:11%;"><b>&minus;&minus;setcon
context</b></p>

<p style="margin-left:22%;">Apply SELinux <b>context</b>
after initialization. This essentially provides the ability
to restrict OpenVPN&rsquo;s rights to only network I/O
operations, thanks to SELinux. This goes further than
<b>&minus;&minus;user</b> and <b>&minus;&minus;chroot</b> in
that those two, while being great security features,
unfortunately do not protect against privilege escalation by
exploitation of a vulnerable system call. You can of course
combine all three, but please note that since setcon
requires access to /proc you will have to provide it inside
the chroot directory (e.g. with mount
&minus;&minus;bind).</p>

<p style="margin-left:22%; margin-top: 1em">Since the
setcon operation is delayed until after initialization,
OpenVPN can be restricted to just network-related system
calls, whereas by applying the context before startup (such
as the OpenVPN one provided in the SELinux Reference
Policies) you will have to allow many things required only
during initialization.</p>

<p style="margin-left:22%; margin-top: 1em">Like with
chroot, complications can result when scripts or restarts
are executed after the setcon operation, which is why you
should really consider using the
<b>&minus;&minus;persist&minus;key</b> and
<b>&minus;&minus;persist&minus;tun</b> options.</p>

<p style="margin-left:11%;"><b>&minus;&minus;daemon
[progname]</b></p>

<p style="margin-left:22%;">Become a daemon after all
initialization functions are completed. This option will
cause all message and error output to be sent to the syslog
file (such as /var/log/messages), except for the output of
scripts and ifconfig commands, which will go to /dev/null
unless otherwise redirected. The syslog redirection occurs
immediately at the point that <b>&minus;&minus;daemon</b> is
parsed on the command line even though the daemonization
point occurs later. If one of the <b>&minus;&minus;log</b>
options is present, it will supercede syslog
redirection.</p>

<p style="margin-left:22%; margin-top: 1em">The optional
<b>progname</b> parameter will cause OpenVPN to report its
program name to the system logger as <b>progname.</b> This
can be useful in linking OpenVPN messages in the syslog file
with specific tunnels. When unspecified, <b>progname</b>
defaults to &quot;openvpn&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">When OpenVPN is
run with the <b>&minus;&minus;daemon</b> option, it will try
to delay daemonization until the majority of initialization
functions which are capable of generating fatal errors are
complete. This means that initialization scripts can test
the return status of the openvpn command for a fairly
reliable indication of whether the command has correctly
initialized and entered the packet forwarding event
loop.</p>

<p style="margin-left:22%; margin-top: 1em">In OpenVPN, the
vast majority of errors which occur after initialization are
non-fatal.</p>

<p style="margin-left:22%; margin-top: 1em">Note: as soon
as OpenVPN has daemonized, it can not ask for usernames,
passwords, or key pass phrases anymore. This has certain
consequences, namely that using a password-protected private
key will fail unless the <b>&minus;&minus;askpass</b> option
is used to tell OpenVPN to ask for the pass phrase (this
requirement is new in 2.3.7, and is a consequence of calling
daemon() before initializing the crypto layer).</p>

<p style="margin-left:22%; margin-top: 1em">Further, using
<b>&minus;&minus;daemon</b> together with
<b>&minus;&minus;auth-user-pass</b> (entered on console) and
<b>&minus;&minus;auth-nocache</b> will fail as soon as key
renegotiation (and reauthentication) occurs.</p>

<p style="margin-left:11%;"><b>&minus;&minus;syslog
[progname]</b></p>

<p style="margin-left:22%;">Direct log output to system
logger, but do not become a daemon. See
<b>&minus;&minus;daemon</b> directive above for description
of <b>progname</b> parameter.</p>


<p style="margin-left:11%;"><b>&minus;&minus;errors&minus;to&minus;stderr</b></p>

<p style="margin-left:22%;">Output errors to stderr instead
of stdout unless log output is redirected by one of the
<b>&minus;&minus;log</b> options.</p>


<p style="margin-left:11%;"><b>&minus;&minus;passtos</b></p>

<p style="margin-left:22%;">Set the TOS field of the tunnel
packet to what the payload&rsquo;s TOS is.</p>

<p style="margin-left:11%;"><b>&minus;&minus;inetd
[wait|nowait] [progname]</b></p>

<p style="margin-left:22%;">Use this option when OpenVPN is
being run from the inetd or <b>xinetd(8)</b> server.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>wait/nowait</b> option must match what is specified in
the inetd/xinetd config file. The <b>nowait</b> mode can
only be used with <b>&minus;&minus;proto
tcp&minus;server.</b> The default is <b>wait.</b> The
<b>nowait</b> mode can be used to instantiate the OpenVPN
daemon as a classic TCP server, where client connection
requests are serviced on a single port number. For
additional information on this kind of configuration, see
the OpenVPN FAQ:
<i>http://openvpn.net/faq.html#oneport</i></p>

<p style="margin-left:22%; margin-top: 1em">This option
precludes the use of <b>&minus;&minus;daemon,
&minus;&minus;local,</b> or <b>&minus;&minus;remote.</b>
Note that this option causes message and error output to be
handled in the same way as the <b>&minus;&minus;daemon</b>
option. The optional <b>progname</b> parameter is also
handled exactly as in <b>&minus;&minus;daemon.</b></p>

<p style="margin-left:22%; margin-top: 1em">Also note that
in <b>wait</b> mode, each OpenVPN tunnel requires a separate
TCP/UDP port and a separate inetd or xinetd entry. See the
OpenVPN 1.x HOWTO for an example on using OpenVPN with
xinetd: <i>http://openvpn.net/1xhowto.html</i></p>

<p style="margin-left:11%;"><b>&minus;&minus;log
file</b></p>

<p style="margin-left:22%;">Output logging messages to
<b>file,</b> including output to stdout/stderr which is
generated by called scripts. If <b>file</b> already exists
it will be truncated. This option takes effect immediately
when it is parsed in the command line and will supercede
syslog output if <b>&minus;&minus;daemon</b> or
<b>&minus;&minus;inetd</b> is also specified. This option is
persistent over the entire course of an OpenVPN
instantiation and will not be reset by SIGHUP, SIGUSR1, or
<b>&minus;&minus;ping&minus;restart.</b></p>

<p style="margin-left:22%; margin-top: 1em">Note that on
Windows, when OpenVPN is started as a service, logging
occurs by default without the need to specify this
option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;log&minus;append
file</b></p>

<p style="margin-left:22%;">Append logging messages to
<b>file.</b> If <b>file</b> does not exist, it will be
created. This option behaves exactly like
<b>&minus;&minus;log</b> except that it appends to rather
than truncating the log file.</p>


<p style="margin-left:11%;"><b>&minus;&minus;suppress&minus;timestamps</b></p>

<p style="margin-left:22%;">Avoid writing timestamps to log
messages, even when they otherwise would be prepended. In
particular, this applies to log messages sent to stdout.</p>

<p style="margin-left:11%;"><b>&minus;&minus;writepid
file</b></p>

<p style="margin-left:22%;">Write OpenVPN&rsquo;s main
process ID to <b>file.</b></p>

<p style="margin-left:11%;"><b>&minus;&minus;nice n</b></p>

<p style="margin-left:22%;">Change process priority after
initialization ( <b>n</b> greater than 0 is lower priority,
<b>n</b> less than zero is higher priority).</p>


<p style="margin-left:11%;"><b>&minus;&minus;fast&minus;io</b></p>

<p style="margin-left:22%;">(Experimental) Optimize
TUN/TAP/UDP I/O writes by avoiding a call to
poll/epoll/select prior to the write operation. The purpose
of such a call would normally be to block until the device
or socket is ready to accept the write. Such blocking is
unnecessary on some platforms which don&rsquo;t support
write blocking on UDP sockets or TUN/TAP devices. In such
cases, one can optimize the event loop by avoiding the
poll/epoll/select call, improving CPU efficiency by 5% to
10%.</p>

<p style="margin-left:22%; margin-top: 1em">This option can
only be used on non-Windows systems, when
<b>&minus;&minus;proto udp</b> is specified, and when
<b>&minus;&minus;shaper</b> is NOT specified.</p>


<p style="margin-left:11%;"><b>&minus;&minus;multihome</b></p>

<p style="margin-left:22%;">Configure a multi-homed UDP
server. This option needs to be used when a server has more
than one IP address (e.g. multiple interfaces, or secondary
IP addresses), and is not using <b>&minus;&minus;local</b>
to force binding to one specific address only. This option
will add some extra lookups to the packet path to ensure
that the UDP reply packets are always sent from the address
that the client is talking to. This is not supported on all
platforms, and it adds more processing, so it&rsquo;s not
enabled by default.</p>

<p style="margin-left:22%; margin-top: 1em">Note: this
option is only relevant for UDP servers.</p>

<p style="margin-left:22%; margin-top: 1em">Note 2: if you
do an IPv6+IPv4 dual-stack bind on a Linux machine with
multiple IPv4 address, connections to IPv4 addresses will
not work right on kernels before 3.15, due to missing kernel
support for the IPv4-mapped case (some distributions have
ported this to earlier kernel versions, though).</p>

<p style="margin-left:11%;"><b>&minus;&minus;echo
[parms...]</b></p>

<p style="margin-left:22%;">Echo <b>parms</b> to log
output.</p>

<p style="margin-left:22%; margin-top: 1em">Designed to be
used to send messages to a controlling application which is
receiving the OpenVPN log output.</p>


<p style="margin-left:11%;"><b>&minus;&minus;remap&minus;usr1
signal</b></p>

<p style="margin-left:22%;">Control whether internally or
externally generated SIGUSR1 signals are remapped to SIGHUP
(restart without persisting state) or SIGTERM (exit).</p>

<p style="margin-left:22%; margin-top: 1em"><b>signal</b>
can be set to &quot;SIGHUP&quot; or &quot;SIGTERM&quot;. By
default, no remapping occurs.</p>

<p style="margin-left:11%;"><b>&minus;&minus;verb n</b></p>

<p style="margin-left:22%;">Set output verbosity to
<b>n</b> (default=1). Each level shows all info from the
previous levels. Level 3 is recommended if you want a good
summary of what&rsquo;s happening without being swamped by
output.</p>

<p style="margin-left:22%; margin-top: 1em"><b>0 --</b> No
output except fatal errors. <b><br>
1 to 4 --</b> Normal usage range. <b><br>
5 --</b> Output <b>R</b> and <b>W</b> characters to the
console for each packet read and write, uppercase is used
for TCP/UDP packets and lowercase is used for TUN/TAP
packets. <b><br>
6 to 11 --</b> Debug info range (see errlevel.h for
additional information on debug levels).</p>

<p style="margin-left:11%;"><b>&minus;&minus;status file
[n]</b></p>

<p style="margin-left:22%;">Write operational status to
<b>file</b> every <b>n</b> seconds.</p>

<p style="margin-left:22%; margin-top: 1em">Status can also
be written to the syslog by sending a <b>SIGUSR2</b>
signal.</p>


<p style="margin-left:11%;"><b>&minus;&minus;status&minus;version
[n]</b></p>

<p style="margin-left:22%;">Choose the status file format
version number. Currently <b>n</b> can be 1, 2, or 3 and
defaults to 1.</p>

<p style="margin-left:11%;"><b>&minus;&minus;mute n</b></p>

<p style="margin-left:22%;">Log at most <b>n</b>
consecutive messages in the same category. This is useful to
limit repetitive logging of similar message types.</p>


<p style="margin-left:11%;"><b>&minus;&minus;comp&minus;lzo
[mode]</b></p>

<p style="margin-left:22%;">Use fast LZO compression -- may
add up to 1 byte per packet for incompressible data.
<b>mode</b> may be &quot;yes&quot;, &quot;no&quot;, or
&quot;adaptive&quot; (default).</p>

<p style="margin-left:22%; margin-top: 1em">In a server
mode setup, it is possible to selectively turn compression
on or off for individual clients.</p>

<p style="margin-left:22%; margin-top: 1em">First, make
sure the client-side config file enables selective
compression by having at least one
<b>&minus;&minus;comp&minus;lzo</b> directive, such as
<b>&minus;&minus;comp&minus;lzo no.</b> This will turn off
compression by default, but allow a future directive push
from the server to dynamically change the on/off/adaptive
setting.</p>

<p style="margin-left:22%; margin-top: 1em">Next in a
<b>&minus;&minus;client&minus;config&minus;dir</b> file,
specify the compression setting for the client, for
example:</p>

<p style="margin-left:28%; margin-top: 1em"><b>comp-lzo yes
<br>
push &quot;comp&minus;lzo yes&quot;</b></p>

<p style="margin-left:22%; margin-top: 1em">The first line
sets the <b>comp-lzo</b> setting for the server side of the
link, the second sets the client side.</p>


<p style="margin-left:11%;"><b>&minus;&minus;comp&minus;noadapt</b></p>

<p style="margin-left:22%;">When used in conjunction with
<b>&minus;&minus;comp&minus;lzo,</b> this option will
disable OpenVPN&rsquo;s adaptive compression algorithm.
Normally, adaptive compression is enabled with
<b>&minus;&minus;comp&minus;lzo.</b></p>

<p style="margin-left:22%; margin-top: 1em">Adaptive
compression tries to optimize the case where you have
compression enabled, but you are sending predominantly
incompressible (or pre-compressed) packets over the tunnel,
such as an FTP or rsync transfer of a large, compressed
file. With adaptive compression, OpenVPN will periodically
sample the compression process to measure its efficiency. If
the data being sent over the tunnel is already compressed,
the compression efficiency will be very low, triggering
openvpn to disable compression for a period of time until
the next re-sample test.</p>

<p style="margin-left:11%;"><b>&minus;&minus;management IP
port [pw-file]</b></p>

<p style="margin-left:22%;">Enable a TCP server on
<b>IP:port</b> to handle daemon management functions.
<b>pw-file,</b> if specified, is a password file (password
on first line) or &quot;stdin&quot; to prompt from standard
input. The password provided will set the password which TCP
clients will need to provide in order to access management
functions.</p>

<p style="margin-left:22%; margin-top: 1em">The management
interface can also listen on a unix domain socket, for those
platforms that support it. To use a unix domain socket,
specify the unix socket pathname in place of <b>IP</b> and
set <b>port</b> to &rsquo;unix&rsquo;. While the default
behavior is to create a unix domain socket that may be
connected to by any process, the
<b>&minus;&minus;management&minus;client&minus;user</b> and
<b>&minus;&minus;management&minus;client&minus;group</b>
directives can be used to restrict access.</p>

<p style="margin-left:22%; margin-top: 1em">The management
interface provides a special mode where the TCP management
link can operate over the tunnel itself. To enable this
mode, set <b>IP</b> = &quot;tunnel&quot;. Tunnel mode will
cause the management interface to listen for a TCP
connection on the local VPN address of the TUN/TAP
interface.</p>

<p style="margin-left:22%; margin-top: 1em">While the
management port is designed for programmatic control of
OpenVPN by other applications, it is possible to telnet to
the port, using a telnet client in &quot;raw&quot; mode.
Once connected, type &quot;help&quot; for a list of
commands.</p>

<p style="margin-left:22%; margin-top: 1em">For detailed
documentation on the management interface, see the
management-notes.txt file in the <b>management</b> folder of
the OpenVPN source distribution.</p>

<p style="margin-left:22%; margin-top: 1em">It is strongly
recommended that <b>IP</b> be set to 127.0.0.1 (localhost)
to restrict accessibility of the management server to local
clients.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;client</b></p>

<p style="margin-left:22%;">Management interface will
connect as a TCP/unix domain client to <b>IP:port</b>
specified by <b>&minus;&minus;management</b> rather than
listen as a TCP server or on a unix domain socket.</p>

<p style="margin-left:22%; margin-top: 1em">If the client
connection fails to connect or is disconnected, a SIGTERM
signal will be generated causing OpenVPN to quit.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;query&minus;passwords</b></p>

<p style="margin-left:22%;">Query management channel for
private key password and
<b>&minus;&minus;auth&minus;user&minus;pass</b>
username/password. Only query the management channel for
inputs which ordinarily would have been queried from the
console.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;query&minus;proxy</b></p>

<p style="margin-left:22%;">Query management channel for
proxy server information for a specific
<b>&minus;&minus;remote</b> (client-only).</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;query&minus;remote</b></p>

<p style="margin-left:22%;">Allow management interface to
override <b>&minus;&minus;remote</b> directives
(client-only).
<b>&minus;&minus;management&minus;external&minus;key</b>
Allows usage for external private key file instead of
<b>&minus;&minus;key</b> option (client-only).</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;forget&minus;disconnect</b></p>

<p style="margin-left:22%;">Make OpenVPN forget passwords
when management session disconnects.</p>

<p style="margin-left:22%; margin-top: 1em">This directive
does not affect the <b>&minus;&minus;http&minus;proxy</b>
username/password. It is always cached.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;hold</b></p>

<p style="margin-left:22%;">Start OpenVPN in a hibernating
state, until a client of the management interface explicitly
starts it with the <b>hold release</b> command.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;signal</b></p>

<p style="margin-left:22%;">Send SIGUSR1 signal to OpenVPN
if management session disconnects. This is useful when you
wish to disconnect an OpenVPN session on user logoff. For
&minus;&minus;management&minus;client this option is not
needed since a disconnect will always generate a
SIGTERM.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;log&minus;cache
n</b></p>

<p style="margin-left:22%;">Cache the most recent <b>n</b>
lines of log file history for usage by the management
channel.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;up&minus;down</b></p>

<p style="margin-left:22%;">Report tunnel up/down events to
management interface.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;client&minus;auth</b></p>

<p style="margin-left:22%;">Gives management interface
client the responsibility to authenticate clients after
their client certificate has been verified. See
management-notes.txt in OpenVPN distribution for detailed
notes.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;client&minus;pf</b></p>

<p style="margin-left:22%;">Management interface clients
must specify a packet filter file for each connecting
client. See management-notes.txt in OpenVPN distribution for
detailed notes.</p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;client&minus;user
u</b></p>

<p style="margin-left:22%;">When the management interface
is listening on a unix domain socket, only allow connections
from user <b>u.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;management&minus;client&minus;group
g</b></p>

<p style="margin-left:22%;">When the management interface
is listening on a unix domain socket, only allow connections
from group <b>g.</b></p>

<p style="margin-left:11%;"><b>&minus;&minus;plugin
module-pathname [init-string]</b></p>

<p style="margin-left:22%;">Load plug-in module from the
file <b>module-pathname,</b> passing <b>init-string</b> as
an argument to the module initialization function. Multiple
plugin modules may be loaded into one OpenVPN process.</p>

<p style="margin-left:22%; margin-top: 1em">For more
information and examples on how to build OpenVPN plug-in
modules, see the README file in the <b>plugin</b> folder of
the OpenVPN source distribution.</p>

<p style="margin-left:22%; margin-top: 1em">If you are
using an RPM install of OpenVPN, see
/usr/lib64/openvpn/plugin. The documentation is in
<b>doc</b> and the actual plugin modules are in
<b>lib.</b></p>

<p style="margin-left:22%; margin-top: 1em">Multiple plugin
modules can be cascaded, and modules can be used in tandem
with scripts. The modules will be called by OpenVPN in the
order that they are declared in the config file. If both a
plugin and script are configured for the same callback, the
script will be called last. If the return code of the
module/script controls an authentication function (such as
tls-verify, auth-user-pass-verify, or client-connect), then
every module and script must return success (0) in order for
the connection to be authenticated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Server
Mode</b> <br>
Starting with OpenVPN 2.0, a multi-client TCP/UDP server
mode is supported, and can be enabled with the
<b>&minus;&minus;mode server</b> option. In server mode,
OpenVPN will listen on a single port for incoming client
connections. All client connections will be routed through a
single tun or tap interface. This mode is designed for
scalability and should be able to support hundreds or even
thousands of clients on sufficiently fast hardware. SSL/TLS
authentication must be used in this mode. <b><br>
&minus;&minus;server network netmask
[&rsquo;nopool&rsquo;]</b></p>

<p style="margin-left:22%;">A helper directive designed to
simplify the configuration of OpenVPN&rsquo;s server mode.
This directive will set up an OpenVPN server which will
allocate addresses to clients out of the given
network/netmask. The server itself will take the
&quot;.1&quot; address of the given network for use as the
server-side endpoint of the local TUN/TAP interface.</p>

<p style="margin-left:22%; margin-top: 1em">For example,
<b>&minus;&minus;server 10.8.0.0 255.255.255.0</b> expands
as follows:</p>

<p style="margin-left:28%; margin-top: 1em"><b>mode server
<br>
tls-server <br>
push &quot;topology [topology]&quot;</b></p>

<p style="margin-left:28%; margin-top: 1em"><b>if dev tun
AND (topology == net30 OR topology == p2p): <br>
ifconfig 10.8.0.1 10.8.0.2 <br>
if !nopool: <br>
ifconfig-pool 10.8.0.4 10.8.0.251 <br>
route 10.8.0.0 255.255.255.0 <br>
if client-to-client: <br>
push &quot;route 10.8.0.0 255.255.255.0&quot; <br>
else if topology == net30: <br>
push &quot;route 10.8.0.1&quot;</b></p>

<p style="margin-left:28%; margin-top: 1em"><b>if dev tap
OR (dev tun AND topology == subnet): <br>
ifconfig 10.8.0.1 255.255.255.0 <br>
if !nopool: <br>
ifconfig-pool 10.8.0.2 10.8.0.254 255.255.255.0 <br>
push &quot;route-gateway 10.8.0.1&quot; <br>
if route-gateway unset: <br>
route-gateway 10.8.0.2</b></p>

<p style="margin-left:22%; margin-top: 1em">Don&rsquo;t use
<b>&minus;&minus;server</b> if you are ethernet bridging.
Use <b>&minus;&minus;server&minus;bridge</b> instead.</p>


<p style="margin-left:11%;"><b>&minus;&minus;server&minus;bridge
gateway netmask pool-start-IP pool-end-IP <br>
&minus;&minus;server&minus;bridge
[&rsquo;nogw&rsquo;]</b></p>

<p style="margin-left:22%; margin-top: 1em">A helper
directive similar to <b>&minus;&minus;server</b> which is
designed to simplify the configuration of OpenVPN&rsquo;s
server mode in ethernet bridging configurations.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>&minus;&minus;server&minus;bridge</b> is used without any
parameters, it will enable a DHCP-proxy mode, where
connecting OpenVPN clients will receive an IP address for
their TAP adapter from the DHCP server running on the
OpenVPN server-side LAN. Note that only clients that support
the binding of a DHCP client with the TAP adapter (such as
Windows) can support this mode. The optional <b>nogw</b>
flag (advanced) indicates that gateway information should
not be pushed to the client.</p>

<p style="margin-left:22%; margin-top: 1em">To configure
ethernet bridging, you must first use your OS&rsquo;s
bridging capability to bridge the TAP interface with the
ethernet NIC interface. For example, on Linux this is done
with the <b>brctl</b> tool, and with Windows XP it is done
in the Network Connections Panel by selecting the ethernet
and TAP adapters and right-clicking on &quot;Bridge
Connections&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">Next you you
must manually set the IP/netmask on the bridge interface.
The <b>gateway</b> and <b>netmask</b> parameters to
<b>&minus;&minus;server&minus;bridge</b> can be set to
either the IP/netmask of the bridge interface, or the
IP/netmask of the default gateway/router on the bridged
subnet.</p>

<p style="margin-left:22%; margin-top: 1em">Finally, set
aside a IP range in the bridged subnet, denoted by
<b>pool-start-IP</b> and <b>pool-end-IP,</b> for OpenVPN to
allocate to connecting clients.</p>

<p style="margin-left:22%; margin-top: 1em">For example,
<b>server-bridge 10.8.0.4 255.255.255.0 10.8.0.128
10.8.0.254</b> expands as follows:</p>

<p style="margin-left:28%; margin-top: 1em"><b>mode server
<br>
tls-server</b></p>


<p style="margin-left:28%; margin-top: 1em"><b>ifconfig-pool
10.8.0.128 10.8.0.254 255.255.255.0 <br>
push &quot;route-gateway 10.8.0.4&quot;</b></p>

<p style="margin-left:22%; margin-top: 1em">In another
example, <b>&minus;&minus;server&minus;bridge</b> (without
parameters) expands as follows:</p>

<p style="margin-left:28%; margin-top: 1em"><b>mode server
<br>
tls-server</b></p>

<p style="margin-left:28%; margin-top: 1em"><b>push
&quot;route-gateway dhcp&quot;</b></p>

<p style="margin-left:22%; margin-top: 1em">Or
<b>&minus;&minus;server&minus;bridge nogw</b> expands as
follows:</p>

<p style="margin-left:28%; margin-top: 1em"><b>mode server
<br>
tls-server</b></p>

<p style="margin-left:11%;"><b>&minus;&minus;push
option</b></p>

<p style="margin-left:22%;">Push a config file option back
to the client for remote execution. Note that <b>option</b>
must be enclosed in double quotes (&quot;&quot;). The client
must specify <b>&minus;&minus;pull</b> in its config file.
The set of options which can be pushed is limited by both
feasibility and security. Some options such as those which
would execute scripts are banned, since they would
effectively allow a compromised server to execute arbitrary
code on the client. Other options such as TLS or MTU
parameters cannot be pushed because the client needs to know
them before the connection to the server can be
initiated.</p>

<p style="margin-left:22%; margin-top: 1em">This is a
partial list of options which can currently be pushed:
<b>&minus;&minus;route, &minus;&minus;route&minus;gateway,
&minus;&minus;route&minus;delay,
&minus;&minus;redirect&minus;gateway,
&minus;&minus;ip&minus;win32,
&minus;&minus;dhcp&minus;option, &minus;&minus;inactive,
&minus;&minus;ping, &minus;&minus;ping&minus;exit,
&minus;&minus;ping&minus;restart, &minus;&minus;setenv,
&minus;&minus;persist&minus;key,
&minus;&minus;persist&minus;tun, &minus;&minus;echo,
&minus;&minus;comp&minus;lzo,
&minus;&minus;socket&minus;flags, &minus;&minus;sndbuf,
&minus;&minus;rcvbuf</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;push&minus;reset</b></p>

<p style="margin-left:22%;">Don&rsquo;t inherit the global
push list for a specific client instance. Specify this
option in a client-specific context such as with a
<b>&minus;&minus;client&minus;config&minus;dir</b>
configuration file. This option will ignore
<b>&minus;&minus;push</b> options at the global config file
level.</p>


<p style="margin-left:11%;"><b>&minus;&minus;push&minus;peer&minus;info</b></p>

<p style="margin-left:22%;">Push additional information
about the client to server. The additional information
consists of the following data:</p>


<p style="margin-left:22%; margin-top: 1em">IV_VER=&lt;version&gt;
-- the client OpenVPN version</p>


<p style="margin-left:22%; margin-top: 1em">IV_PLAT=[linux|solaris|openbsd|mac|netbsd|freebsd|win]
-- the client OS platform</p>


<p style="margin-left:22%; margin-top: 1em">IV_HWADDR=&lt;mac
address&gt; -- the MAC address of clients default
gateway</p>

<p style="margin-left:22%; margin-top: 1em">IV_LZO_STUB=1
-- if client was built with LZO stub capability</p>


<p style="margin-left:22%; margin-top: 1em">UV_&lt;name&gt;=&lt;value&gt;
-- client environment variables whose names start with
&quot;UV_&quot;</p>


<p style="margin-left:11%;"><b>&minus;&minus;disable</b></p>

<p style="margin-left:22%;">Disable a particular client
(based on the common name) from connecting. Don&rsquo;t use
this option to disable a client due to key or password
compromise. Use a CRL (certificate revocation list) instead
(see the <b>&minus;&minus;crl&minus;verify</b> option).</p>

<p style="margin-left:22%; margin-top: 1em">This option
must be associated with a specific client instance, which
means that it must be specified either in a client instance
config file using
<b>&minus;&minus;client&minus;config&minus;dir</b> or
dynamically generated using a
<b>&minus;&minus;client&minus;connect</b> script.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;pool
start-IP end-IP [netmask]</b></p>

<p style="margin-left:22%;">Set aside a pool of subnets to
be dynamically allocated to connecting clients, similar to a
DHCP server. For tun-style tunnels, each client will be
given a /30 subnet (for interoperability with Windows
clients). For tap-style tunnels, individual addresses will
be allocated, and the optional <b>netmask</b> parameter will
also be pushed to clients.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;pool&minus;persist
file [seconds]</b></p>

<p style="margin-left:22%;">Persist/unpersist ifconfig-pool
data to <b>file,</b> at <b>seconds</b> intervals
(default=600), as well as on program startup and
shutdown.</p>

<p style="margin-left:22%; margin-top: 1em">The goal of
this option is to provide a long-term association between
clients (denoted by their common name) and the virtual IP
address assigned to them from the ifconfig-pool. Maintaining
a long-term association is good for clients because it
allows them to effectively use the
<b>&minus;&minus;persist&minus;tun</b> option.</p>

<p style="margin-left:22%; margin-top: 1em"><b>file</b> is
a comma-delimited ASCII file, formatted as
&lt;Common-Name&gt;,&lt;IP-address&gt;.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>seconds</b> = 0, <b>file</b> will be treated as
read-only. This is useful if you would like to treat
<b>file</b> as a configuration file.</p>

<p style="margin-left:22%; margin-top: 1em">Note that the
entries in this file are treated by OpenVPN as suggestions
only, based on past associations between a common name and
IP address. They do not guarantee that the given common name
will always receive the given IP address. If you want
guaranteed assignment, use
<b>&minus;&minus;ifconfig&minus;push</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;pool&minus;linear</b></p>

<p style="margin-left:22%;">Modifies the
<b>&minus;&minus;ifconfig&minus;pool</b> directive to
allocate individual TUN interface addresses for clients
rather than /30 subnets. NOTE: This option is incompatible
with Windows clients.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
deprecated, and should be replaced with
<b>&minus;&minus;topology p2p</b> which is functionally
equivalent.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;push
local remote-netmask [alias]</b></p>

<p style="margin-left:22%;">Push virtual IP endpoints for
client tunnel, overriding the
&minus;&minus;ifconfig&minus;pool dynamic allocation.</p>

<p style="margin-left:22%; margin-top: 1em">The parameters
<b>local</b> and <b>remote-netmask</b> are set according to
the <b>&minus;&minus;ifconfig</b> directive which you want
to execute on the client machine to configure the remote end
of the tunnel. Note that the parameters <b>local</b> and
<b>remote&minus;netmask</b> are from the perspective of the
client, not the server. They may be DNS names rather than IP
addresses, in which case they will be resolved on the server
at the time of client connection.</p>

<p style="margin-left:22%; margin-top: 1em">The optional
<b>alias</b> parameter may be used in cases where NAT causes
the client view of its local endpoint to differ from the
server view. In this case <b>local/remote-netmask</b> will
refer to the server view while <b>alias/remote-netmask</b>
will refer to the client view.</p>

<p style="margin-left:22%; margin-top: 1em">This option
must be associated with a specific client instance, which
means that it must be specified either in a client instance
config file using
<b>&minus;&minus;client&minus;config&minus;dir</b> or
dynamically generated using a
<b>&minus;&minus;client&minus;connect</b> script.</p>

<p style="margin-left:22%; margin-top: 1em">Remember also
to include a <b>&minus;&minus;route</b> directive in the
main OpenVPN config file which encloses <b>local,</b> so
that the kernel will know to route it to the server&rsquo;s
TUN/TAP interface.</p>


<p style="margin-left:22%; margin-top: 1em">OpenVPN&rsquo;s
internal client IP address selection algorithm works as
follows:</p>

<p style="margin-left:22%; margin-top: 1em"><b>1</b> -- Use
<b>&minus;&minus;client&minus;connect script</b> generated
file for static IP (first choice). <b><br>
2</b> -- Use
<b>&minus;&minus;client&minus;config&minus;dir</b> file for
static IP (next choice). <b><br>
3</b> -- Use <b>&minus;&minus;ifconfig&minus;pool</b>
allocation for dynamic IP (last choice).</p>

<p style="margin-left:11%;"><b>&minus;&minus;iroute network
[netmask]</b></p>

<p style="margin-left:22%;">Generate an internal route to a
specific client. The <b>netmask</b> parameter, if omitted,
defaults to 255.255.255.255.</p>

<p style="margin-left:22%; margin-top: 1em">This directive
can be used to route a fixed subnet from the server to a
particular client, regardless of where the client is
connecting from. Remember that you must also add the route
to the system routing table as well (such as by using the
<b>&minus;&minus;route</b> directive). The reason why two
routes are needed is that the <b>&minus;&minus;route</b>
directive routes the packet from the kernel to OpenVPN. Once
in OpenVPN, the <b>&minus;&minus;iroute</b> directive routes
to the specific client.</p>

<p style="margin-left:22%; margin-top: 1em">This option
must be specified either in a client instance config file
using <b>&minus;&minus;client&minus;config&minus;dir</b> or
dynamically generated using a
<b>&minus;&minus;client&minus;connect</b> script.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>&minus;&minus;iroute</b> directive also has an important
interaction with <b>&minus;&minus;push</b> &quot;route
...&quot;. <b>&minus;&minus;iroute</b> essentially defines a
subnet which is owned by a particular client (we will call
this client A). If you would like other clients to be able
to reach A&rsquo;s subnet, you can use
<b>&minus;&minus;push</b> &quot;route ...&quot; together
with <b>&minus;&minus;client&minus;to&minus;client</b> to
effect this. In order for all clients to see A&rsquo;s
subnet, OpenVPN must push this route to all clients EXCEPT
for A, since the subnet is already owned by A. OpenVPN
accomplishes this by not not pushing a route to a client if
it matches one of the client&rsquo;s iroutes.</p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;to&minus;client</b></p>

<p style="margin-left:22%;">Because the OpenVPN server mode
handles multiple clients through a single tun or tap
interface, it is effectively a router. The
<b>&minus;&minus;client&minus;to&minus;client</b> flag tells
OpenVPN to internally route client-to-client traffic rather
than pushing all client-originating traffic to the TUN/TAP
interface.</p>

<p style="margin-left:22%; margin-top: 1em">When this
option is used, each client will &quot;see&quot; the other
clients which are currently connected. Otherwise, each
client will only see the server. Don&rsquo;t use this option
if you want to firewall tunnel traffic using custom,
per-client rules.</p>


<p style="margin-left:11%;"><b>&minus;&minus;duplicate&minus;cn</b></p>

<p style="margin-left:22%;">Allow multiple clients with the
same common name to concurrently connect. In the absence of
this option, OpenVPN will disconnect a client instance upon
connection of a new client having the same common name.</p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;connect
cmd</b></p>

<p style="margin-left:22%;">Run <b>command cmd</b> on
client connection.</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">The command is
passed the common name and IP address of the
just-authenticated client as environmental variables (see
environmental variable section below). The command is also
passed the pathname of a freshly created temporary file as
the last argument (after any arguments specified in
<b>cmd</b> ), to be used by the command to pass dynamically
generated config file directives back to OpenVPN.</p>

<p style="margin-left:22%; margin-top: 1em">If the script
wants to generate a dynamic config file to be applied on the
server when the client connects, it should write it to the
file named by the last argument.</p>

<p style="margin-left:22%; margin-top: 1em">See the
<b>&minus;&minus;client&minus;config&minus;dir</b> option
below for options which can be legally used in a dynamically
generated config file.</p>

<p style="margin-left:22%; margin-top: 1em">Note that the
return value of <b>script</b> is significant. If
<b>script</b> returns a non-zero error status, it will cause
the client to be disconnected.</p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;disconnect
cmd</b></p>

<p style="margin-left:22%;">Like
<b>&minus;&minus;client&minus;connect</b> but called on
client instance shutdown. Will not be called unless the
<b>&minus;&minus;client&minus;connect</b> script and plugins
(if defined) were previously called on this instance with
successful (0) status returns.</p>

<p style="margin-left:22%; margin-top: 1em">The exception
to this rule is if the
<b>&minus;&minus;client&minus;disconnect</b> command or
plugins are cascaded, and at least one client-connect
function succeeded, then ALL of the client-disconnect
functions for scripts and plugins will be called on client
instance object deletion, even in cases where some of the
related client-connect functions returned an error
status.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>&minus;&minus;client&minus;disconnect</b> command is
passed the same pathname as the corresponding
<b>&minus;&minus;client&minus;connect</b> command as its
last argument. (after any arguments specified in <b>cmd</b>
).</p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;config&minus;dir
dir</b></p>

<p style="margin-left:22%;">Specify a directory <b>dir</b>
for custom client config files. After a connecting client
has been authenticated, OpenVPN will look in this directory
for a file having the same name as the client&rsquo;s X509
common name. If a matching file exists, it will be opened
and parsed for client-specific configuration options. If no
matching file is found, OpenVPN will instead try to open and
parse a default file called &quot;DEFAULT&quot;, which may
be provided but is not required. Note that the configuration
files must be readable by the OpenVPN process after it has
dropped it&rsquo;s root privileges.</p>

<p style="margin-left:22%; margin-top: 1em">This file can
specify a fixed IP address for a given client using
<b>&minus;&minus;ifconfig&minus;push,</b> as well as fixed
subnets owned by the client using
<b>&minus;&minus;iroute.</b></p>

<p style="margin-left:22%; margin-top: 1em">One of the
useful properties of this option is that it allows client
configuration files to be conveniently created, edited, or
removed while the server is live, without needing to restart
the server.</p>

<p style="margin-left:22%; margin-top: 1em">The following
options are legal in a client-specific context:
<b>&minus;&minus;push, &minus;&minus;push&minus;reset,
&minus;&minus;iroute, &minus;&minus;ifconfig&minus;push,</b>
and <b>&minus;&minus;config.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;ccd&minus;exclusive</b></p>

<p style="margin-left:22%;">Require, as a condition of
authentication, that a connecting client has a
<b>&minus;&minus;client&minus;config&minus;dir</b> file.</p>

<p style="margin-left:11%;"><b>&minus;&minus;tmp&minus;dir
dir</b></p>

<p style="margin-left:22%;">Specify a directory <b>dir</b>
for temporary files. This directory will be used by openvpn
processes and script to communicate temporary data with
openvpn main process. Note that the directory must be
writable by the OpenVPN process after it has dropped
it&rsquo;s root privileges.</p>

<p style="margin-left:22%; margin-top: 1em">This directory
will be used by in the following cases:</p>

<p style="margin-left:22%; margin-top: 1em">*
<b>&minus;&minus;client&minus;connect</b> scripts to
dynamically generate client-specific configuration
files.</p>

<p style="margin-left:22%; margin-top: 1em">*
<b>OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY</b> plugin hook to
return success/failure via auth_control_file when using
deferred auth method</p>

<p style="margin-left:22%; margin-top: 1em">*
<b>OPENVPN_PLUGIN_ENABLE_PF</b> plugin hook to pass
filtering rules via pf_file</p>


<p style="margin-left:11%;"><b>&minus;&minus;hash&minus;size
r v</b></p>

<p style="margin-left:22%;">Set the size of the real
address hash table to <b>r</b> and the virtual address table
to <b>v.</b> By default, both tables are sized at 256
buckets.</p>


<p style="margin-left:11%;"><b>&minus;&minus;bcast&minus;buffers
n</b></p>

<p style="margin-left:22%;">Allocate <b>n</b> buffers for
broadcast datagrams (default=256).</p>


<p style="margin-left:11%;"><b>&minus;&minus;tcp&minus;queue&minus;limit
n</b></p>

<p style="margin-left:22%;">Maximum number of output
packets queued before TCP (default=64).</p>

<p style="margin-left:22%; margin-top: 1em">When OpenVPN is
tunneling data from a TUN/TAP device to a remote client over
a TCP connection, it is possible that the TUN/TAP device
might produce data at a faster rate than the TCP connection
can support. When the number of output packets queued before
sending to the TCP socket reaches this limit for a given
client connection, OpenVPN will start to drop outgoing
packets directed at this client.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tcp&minus;nodelay</b></p>

<p style="margin-left:22%;">This macro sets the TCP_NODELAY
socket flag on the server as well as pushes it to connecting
clients. The TCP_NODELAY flag disables the Nagle algorithm
on TCP sockets causing packets to be transmitted immediately
with low latency, rather than waiting a short period of time
in order to aggregate several packets into a larger
containing packet. In VPN applications over TCP, TCP_NODELAY
is generally a good latency optimization.</p>

<p style="margin-left:22%; margin-top: 1em">The macro
expands as follows:</p>

<p style="margin-left:28%; margin-top: 1em"><b>if mode
server: <br>
socket-flags TCP_NODELAY <br>
push &quot;socket-flags TCP_NODELAY&quot;</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;max&minus;clients
n</b></p>

<p style="margin-left:22%;">Limit server to a maximum of
<b>n</b> concurrent clients.</p>


<p style="margin-left:11%;"><b>&minus;&minus;max&minus;routes&minus;per&minus;client
n</b></p>

<p style="margin-left:22%;">Allow a maximum of <b>n</b>
internal routes per client (default=256). This is designed
to help contain DoS attacks where an authenticated client
floods the server with packets appearing to come from many
unique MAC addresses, forcing the server to deplete virtual
memory as its internal routing table expands. This directive
can be used in a
<b>&minus;&minus;client&minus;config&minus;dir</b> file or
auto-generated by a
<b>&minus;&minus;client&minus;connect</b> script to override
the global value for a particular client.</p>

<p style="margin-left:22%; margin-top: 1em">Note that this
directive affects OpenVPN&rsquo;s internal routing table,
not the kernel routing table.</p>


<p style="margin-left:11%;"><b>&minus;&minus;stale&minus;routes&minus;check
n [t]</b></p>

<p style="margin-left:22%;">Remove routes haven&rsquo;t had
activity for <b>n</b> seconds (i.e. the ageing time).</p>

<p style="margin-left:22%; margin-top: 1em">This check is
ran every <b>t</b> seconds (i.e. check interval).</p>

<p style="margin-left:22%; margin-top: 1em">If <b>t</b> is
not present it defaults to <b>n</b></p>

<p style="margin-left:22%; margin-top: 1em">This option
helps to keep the dynamic routing table small. See also
<b>&minus;&minus;max&minus;routes&minus;per&minus;client</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;connect&minus;freq
n sec</b></p>

<p style="margin-left:22%;">Allow a maximum of <b>n</b> new
connections per <b>sec</b> seconds from clients. This is
designed to contain DoS attacks which flood the server with
connection requests using certificates which will ultimately
fail to authenticate.</p>

<p style="margin-left:22%; margin-top: 1em">This is an
imperfect solution however, because in a real DoS scenario,
legitimate connections might also be refused.</p>

<p style="margin-left:22%; margin-top: 1em">For the best
protection against DoS attacks in server mode, use
<b>&minus;&minus;proto udp</b> and
<b>&minus;&minus;tls&minus;auth.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;learn&minus;address
cmd</b></p>

<p style="margin-left:22%;">Run command <b>cmd</b> to
validate client virtual addresses or routes.</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">Three arguments
will be appended to any arguments in <b>cmd</b> as
follows:</p>

<p style="margin-left:22%; margin-top: 1em"><b>[1]
operation --</b> &quot;add&quot;, &quot;update&quot;, or
&quot;delete&quot; based on whether or not the address is
being added to, modified, or deleted from OpenVPN&rsquo;s
internal routing table. <b><br>
[2] address --</b> The address being learned or unlearned.
This can be an IPv4 address such as
&quot;198.162.10.14&quot;, an IPv4 subnet such as
&quot;198.162.10.0/24&quot;, or an ethernet MAC address
(when <b>&minus;&minus;dev tap</b> is being used) such as
&quot;00:FF:01:02:03:04&quot;. <b><br>
[3] common name --</b> The common name on the certificate
associated with the client linked to this address. Only
present for &quot;add&quot; or &quot;update&quot;
operations, not &quot;delete&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">On
&quot;add&quot; or &quot;update&quot; methods, if the script
returns a failure code (non-zero), OpenVPN will reject the
address and will not modify its internal routing table.</p>

<p style="margin-left:22%; margin-top: 1em">Normally, the
<b>cmd</b> script will use the information provided above to
set appropriate firewall entries on the VPN TUN/TAP
interface. Since OpenVPN provides the association between
virtual IP or MAC address and the client&rsquo;s
authenticated common name, it allows a user-defined script
to configure firewall access policies with regard to the
client&rsquo;s high-level common name, rather than the low
level client virtual addresses.</p>


<p style="margin-left:11%;"><b>&minus;&minus;auth&minus;user&minus;pass&minus;verify
cmd method</b></p>

<p style="margin-left:22%;">Require the client to provide a
username/password (possibly in addition to a client
certificate) for authentication.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN will
run <b>command cmd</b> to validate the username/password
provided by the client.</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>method</b> is set to &quot;via-env&quot;, OpenVPN will
call <b>script</b> with the environmental variables
<b>username</b> and <b>password</b> set to the
username/password strings provided by the client. Be aware
that this method is insecure on some platforms which make
the environment of a process publicly visible to other
unprivileged processes.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>method</b> is set to &quot;via-file&quot;, OpenVPN will
write the username and password to the first two lines of a
temporary file. The filename will be passed as an argument
to <b>script,</b> and the file will be automatically deleted
by OpenVPN after the script returns. The location of the
temporary file is controlled by the
<b>&minus;&minus;tmp&minus;dir</b> option, and will default
to the current directory if unspecified. For security,
consider setting <b>&minus;&minus;tmp&minus;dir</b> to a
volatile storage medium such as <b>/dev/shm</b> (if
available) to prevent the username/password file from
touching the hard drive.</p>

<p style="margin-left:22%; margin-top: 1em">The script
should examine the username and password, returning a
success exit code (0) if the client&rsquo;s authentication
request is to be accepted, or a failure code (1) to reject
the client.</p>

<p style="margin-left:22%; margin-top: 1em">This directive
is designed to enable a plugin-style interface for extending
OpenVPN&rsquo;s authentication capabilities.</p>

<p style="margin-left:22%; margin-top: 1em">To protect
against a client passing a maliciously formed username or
password string, the username string must consist only of
these characters: alphanumeric, underbar (&rsquo;_&rsquo;),
dash (&rsquo;-&rsquo;), dot (&rsquo;.&rsquo;), or at
(&rsquo;@&rsquo;). The password string can consist of any
printable characters except for CR or LF. Any illegal
characters in either the username or password string will be
converted to underbar (&rsquo;_&rsquo;).</p>

<p style="margin-left:22%; margin-top: 1em">Care must be
taken by any user-defined scripts to avoid creating a
security vulnerability in the way that these strings are
handled. Never use these strings in such a way that they
might be escaped or evaluated by a shell interpreter.</p>

<p style="margin-left:22%; margin-top: 1em">For a sample
script that performs PAM authentication, see
<b>sample-scripts/auth-pam.pl</b> in the OpenVPN source
distribution.</p>


<p style="margin-left:11%;"><b>&minus;&minus;opt&minus;verify</b></p>

<p style="margin-left:22%;">Clients that connect with
options that are incompatible with those of the server will
be disconnected.</p>

<p style="margin-left:22%; margin-top: 1em">Options that
will be compared for compatibility include dev-type,
link-mtu, tun-mtu, proto, tun-ipv6, ifconfig, comp-lzo,
fragment, keydir, cipher, auth, keysize, secret, no-replay,
no-iv, tls-auth, key-method, tls-server, and tls-client.</p>

<p style="margin-left:22%; margin-top: 1em">This option
requires that <b>&minus;&minus;disable&minus;occ</b> NOT be
used.</p>


<p style="margin-left:11%;"><b>&minus;&minus;auth&minus;user&minus;pass&minus;optional</b></p>

<p style="margin-left:22%;">Allow connections by clients
that do not specify a username/password. Normally, when
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
or <b>&minus;&minus;management&minus;client&minus;auth</b>
is specified (or an authentication plugin module), the
OpenVPN server daemon will require connecting clients to
specify a username and password. This option makes the
submission of a username/password by clients optional,
passing the responsibility to the user-defined
authentication module/script to accept or deny the client
based on other factors (such as the setting of X509
certificate fields). When this option is used, and a
connecting client does not submit a username/password, the
user-defined authentication module/script will see the
username and password as being set to empty strings
(&quot;&quot;). The authentication module/script MUST have
logic to detect this condition and respond accordingly.</p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;cert&minus;not&minus;required</b></p>

<p style="margin-left:22%;">Don&rsquo;t require client
certificate, client will authenticate using
username/password only. Be aware that using this directive
is less secure than requiring certificates from all
clients.</p>

<p style="margin-left:22%; margin-top: 1em">If you use this
directive, the entire responsibility of authentication will
rest on your
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
script, so keep in mind that bugs in your script could
potentially compromise the security of your VPN.</p>

<p style="margin-left:22%; margin-top: 1em">If you
don&rsquo;t use this directive, but you also specify an
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
script, then OpenVPN will perform double authentication. The
client certificate verification AND the
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
script will need to succeed in order for a client to be
authenticated and accepted onto the VPN.</p>


<p style="margin-left:11%;"><b>&minus;&minus;username&minus;as&minus;common&minus;name</b></p>

<p style="margin-left:22%;">For
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
authentication, use the authenticated username as the common
name, rather than the common name from the client cert.</p>


<p style="margin-left:11%;"><b>&minus;&minus;compat&minus;names
[no&minus;remapping] (DEPRECATED)</b></p>

<p style="margin-left:22%;">Until OpenVPN v2.3 the format
of the X.509 Subject fields was formatted like this:</p>


<p style="margin-left:22%; margin-top: 1em"><b>/C=US/L=Somewhere/CN=John
Doe/emailAddress=john@example.com</b></p>

<p style="margin-left:22%; margin-top: 1em">In addition the
old behaviour was to remap any character other than
alphanumeric, underscore (&rsquo;_&rsquo;), dash
(&rsquo;-&rsquo;), dot (&rsquo;.&rsquo;), and slash
(&rsquo;/&rsquo;) to underscore (&rsquo;_&rsquo;). The X.509
Subject string as returned by the <b>tls_id</b>
environmental variable, could additionally contain colon
(&rsquo;:&rsquo;) or equal (&rsquo;=&rsquo;).</p>

<p style="margin-left:22%; margin-top: 1em">When using the
<b>&minus;&minus;compat&minus;names</b> option, this old
formatting and remapping will be re-enabled again. This is
purely implemented for compatibility reasons when using
older plug-ins or scripts which does not handle the new
formatting or UTF-8 characters.</p>

<p style="margin-left:22%; margin-top: 1em">In OpenVPN v2.3
the formatting of these fields changed into a more
standardised format. It now looks like:</p>

<p style="margin-left:22%; margin-top: 1em"><b>C=US,
L=Somewhere, CN=John Doe,
emailAddress=john@example.com</b></p>

<p style="margin-left:22%; margin-top: 1em">The new default
format in OpenVPN v2.3 also does not do the character
remapping which happened earlier. This new format enables
proper support for UTF&minus;8 characters in the usernames,
X.509 Subject fields and Common Name variables and it
complies to the RFC 2253, UTF&minus;8 String Representation
of Distinguished Names.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>no&minus;remapping</b> mode flag can be used with the
<b>&minus;&minus;compat&minus;names</b> option to be
compatible with the now deprecated
&minus;&minus;no&minus;name&minus;remapping option. It is
only available at the server. When this mode flag is used,
the Common Name, Subject, and username strings are allowed
to include any printable character including space, but
excluding control characters such as tab, newline, and
carriage-return. no-remapping is only available on the
server side.</p>

<p style="margin-left:22%; margin-top: 1em"><b>Please
note:</b> This option is immediately deprecated. It is only
implemented to make the transition to the new formatting
less intrusive. It will be removed either in OpenVPN v2.4 or
v2.5. So please make sure you use the
<b>&minus;&minus;verify&minus;x509&minus;name</b> option
instead of <b>&minus;&minus;tls&minus;remote</b> as soon as
possible and update your scripts where necessary.</p>


<p style="margin-left:11%;"><b>&minus;&minus;no&minus;name&minus;remapping
(DEPRECATED)</b></p>

<p style="margin-left:22%;">The
<b>&minus;&minus;no&minus;name&minus;remapping</b> option is
an alias for
<b>&minus;&minus;compat&minus;names&nbsp;no&minus;remapping.</b>
It ensures compatibility with server configurations using
the <b>&minus;&minus;no&minus;name&minus;remapping</b>
option.</p>

<p style="margin-left:22%; margin-top: 1em"><b>Please
note:</b> This option is now deprecated. It will be removed
either in OpenVPN v2.4 or v2.5. So please make sure you
support the new X.509 name formatting described with the
<b>&minus;&minus;compat&minus;names</b> option as soon as
possible.</p>


<p style="margin-left:11%;"><b>&minus;&minus;port&minus;share
host port [dir]</b></p>

<p style="margin-left:22%;">When run in TCP server mode,
share the OpenVPN port with another application, such as an
HTTPS server. If OpenVPN senses a connection to its port
which is using a non-OpenVPN protocol, it will proxy the
connection to the server at <b>host:port.</b> Currently only
designed to work with HTTP/HTTPS, though it would be
theoretically possible to extend to other protocols such as
ssh.</p>

<p style="margin-left:22%; margin-top: 1em"><b>dir</b>
specifies an optional directory where a temporary file with
name N containing content C will be dynamically generated
for each proxy connection, where N is the source IP:port of
the client connection and C is the source IP:port of the
connection to the proxy receiver. This directory can be used
as a dictionary by the proxy receiver to determine the
origin of the connection. Each generated file will be
automatically deleted when the proxied connection is torn
down.</p>

<p style="margin-left:22%; margin-top: 1em">Not implemented
on Windows.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Client
Mode</b> <br>
Use client mode when connecting to an OpenVPN server which
has <b>&minus;&minus;server,
&minus;&minus;server&minus;bridge,</b> or
<b>&minus;&minus;mode server</b> in it&rsquo;s
configuration. <b><br>
&minus;&minus;client</b></p>

<p style="margin-left:22%;">A helper directive designed to
simplify the configuration of OpenVPN&rsquo;s client mode.
This directive is equivalent to:</p>

<p style="margin-left:28%; margin-top: 1em"><b>pull <br>
tls-client</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;pull</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>This option must be used on a client which is connecting
to a multi-client server. It indicates to OpenVPN that it
should accept options pushed by the server, provided they
are part of the legal set of pushable options (note that the
<b>&minus;&minus;pull</b> option is implied by
<b>&minus;&minus;client</b> ).</p></td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">In particular,
<b>&minus;&minus;pull</b> allows the server to push routes
to the client, so you should not use
<b>&minus;&minus;pull</b> or <b>&minus;&minus;client</b> in
situations where you don&rsquo;t trust the server to have
control over the client&rsquo;s routing table.</p>


<p style="margin-left:11%;"><b>&minus;&minus;auth&minus;user&minus;pass
[up]</b></p>

<p style="margin-left:22%;">Authenticate with server using
username/password. <b>up</b> is a file containing
username/password on 2 lines (Note: OpenVPN will only read
passwords from a file if it has been built with the
&minus;&minus;enable&minus;password&minus;save configure
option, or on Windows by defining ENABLE_PASSWORD_SAVE in
win/settings.in).</p>

<p style="margin-left:22%; margin-top: 1em">If <b>up</b> is
omitted, username/password will be prompted from the
console.</p>

<p style="margin-left:22%; margin-top: 1em">The server
configuration must specify an
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
script to verify the username/password provided by the
client.</p>


<p style="margin-left:11%;"><b>&minus;&minus;auth&minus;retry
type</b></p>

<p style="margin-left:22%;">Controls how OpenVPN responds
to username/password verification errors such as the
client-side response to an AUTH_FAILED message from the
server or verification failure of the private key
password.</p>

<p style="margin-left:22%; margin-top: 1em">Normally used
to prevent auth errors from being fatal on the client side,
and to permit username/password requeries in case of
error.</p>

<p style="margin-left:22%; margin-top: 1em">An AUTH_FAILED
message is generated by the server if the client fails
<b>&minus;&minus;auth&minus;user&minus;pass</b>
authentication, or if the server-side
<b>&minus;&minus;client&minus;connect</b> script returns an
error status when the client tries to connect.</p>

<p style="margin-left:22%; margin-top: 1em"><b>type</b> can
be one of:</p>

<p style="margin-left:22%; margin-top: 1em"><b>none --</b>
Client will exit with a fatal error (this is the default).
<b><br>
nointeract --</b> Client will retry the connection without
requerying for an
<b>&minus;&minus;auth&minus;user&minus;pass</b>
username/password. Use this option for unattended clients.
<b><br>
interact --</b> Client will requery for an
<b>&minus;&minus;auth&minus;user&minus;pass</b>
username/password and/or private key password before
attempting a reconnection.</p>

<p style="margin-left:22%; margin-top: 1em">Note that while
this option cannot be pushed, it can be controlled from the
management interface.</p>


<p style="margin-left:11%;"><b>&minus;&minus;static&minus;challenge
t e</b></p>

<p style="margin-left:22%;">Enable static
challenge/response protocol using challenge text <b>t,</b>
with echo flag given by <b>e</b> (0|1).</p>

<p style="margin-left:22%; margin-top: 1em">The echo flag
indicates whether or not the user&rsquo;s response to the
challenge should be echoed.</p>

<p style="margin-left:22%; margin-top: 1em">See
management&minus;notes.txt in the OpenVPN distribution for a
description of the OpenVPN challenge/response protocol.</p>


<p style="margin-left:11%;"><b>&minus;&minus;server&minus;poll&minus;timeout
n</b></p>

<p style="margin-left:22%;">when polling possible remote
servers to connect to in a round-robin fashion, spend no
more than <b>n</b> seconds waiting for a response before
trying the next server. As this only makes sense in
client-to-server setups, it cannot be used in point-to-point
setups using <b>&minus;&minus;secret</b> symmetrical key
mode.</p>


<p style="margin-left:11%;"><b>&minus;&minus;explicit&minus;exit&minus;notify
[n]</b></p>

<p style="margin-left:22%;">In UDP client mode or
point-to-point mode, send server/peer an exit notification
if tunnel is restarted or OpenVPN process is exited. In
client mode, on exit/restart, this option will tell the
server to immediately close its client instance object
rather than waiting for a timeout. The <b>n</b> parameter
(default=1) controls the maximum number of attempts that the
client will try to resend the exit notification message.
OpenVPN will not send any exit notifications unless this
option is enabled.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Data Channel
Encryption Options:</b> <br>
These options are meaningful for both Static &amp;
TLS-negotiated key modes (must be compatible between peers).
<b><br>
&minus;&minus;secret file [direction]</b></p>

<p style="margin-left:22%;">Enable Static Key encryption
mode (non-TLS). Use pre-shared secret <b>file</b> which was
generated with <b>&minus;&minus;genkey.</b></p>

<p style="margin-left:22%; margin-top: 1em">The optional
<b>direction</b> parameter enables the use of 4 distinct
keys (HMAC-send, cipher-encrypt, HMAC-receive,
cipher-decrypt), so that each data flow direction has a
different set of HMAC and cipher keys. This has a number of
desirable security properties including eliminating certain
kinds of DoS and message replay attacks.</p>

<p style="margin-left:22%; margin-top: 1em">When the
<b>direction</b> parameter is omitted, 2 keys are used
bidirectionally, one for HMAC and the other for
encryption/decryption.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>direction</b> parameter should always be complementary on
either side of the connection, i.e. one side should use
&quot;0&quot; and the other should use &quot;1&quot;, or
both sides should omit it altogether.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>direction</b> parameter requires that <b>file</b>
contains a 2048 bit key. While pre-1.5 versions of OpenVPN
generate 1024 bit key files, any version of OpenVPN which
supports the <b>direction</b> parameter, will also support
2048 bit key file generation using the
<b>&minus;&minus;genkey</b> option.</p>

<p style="margin-left:22%; margin-top: 1em">Static key
encryption mode has certain advantages, the primary being
ease of configuration.</p>

<p style="margin-left:22%; margin-top: 1em">There are no
certificates or certificate authorities or complicated
negotiation handshakes and protocols. The only requirement
is that you have a pre-existing secure channel with your
peer (such as <b>ssh</b> ) to initially copy the key. This
requirement, along with the fact that your key never changes
unless you manually generate a new one, makes it somewhat
less secure than TLS mode (see below). If an attacker
manages to steal your key, everything that was ever
encrypted with it is compromised. Contrast that to the
perfect forward secrecy features of TLS mode (using Diffie
Hellman key exchange), where even if an attacker was able to
steal your private key, he would gain no information to help
him decrypt past sessions.</p>

<p style="margin-left:22%; margin-top: 1em">Another
advantageous aspect of Static Key encryption mode is that it
is a handshake-free protocol without any distinguishing
signature or feature (such as a header or protocol handshake
sequence) that would mark the ciphertext packets as being
generated by OpenVPN. Anyone eavesdropping on the wire would
see nothing but random-looking data.</p>


<p style="margin-left:11%;"><b>&minus;&minus;key&minus;direction</b></p>

<p style="margin-left:22%;">Alternative way of specifying
the optional direction parameter for the
<b>&minus;&minus;tls&minus;auth</b> and
<b>&minus;&minus;secret</b> options. Useful when using
inline files (See section on inline files).</p>

<p style="margin-left:11%;"><b>&minus;&minus;auth
alg</b></p>

<p style="margin-left:22%;">Authenticate packets with HMAC
using message digest algorithm <b>alg.</b> (The default is
<b>SHA1</b> ). HMAC is a commonly used message
authentication algorithm (MAC) that uses a data string, a
secure hash algorithm, and a key, to produce a digital
signature.</p>


<p style="margin-left:22%; margin-top: 1em">OpenVPN&rsquo;s
usage of HMAC is to first encrypt a packet, then HMAC the
resulting ciphertext.</p>

<p style="margin-left:22%; margin-top: 1em">In static-key
encryption mode, the HMAC key is included in the key file
generated by <b>&minus;&minus;genkey.</b> In TLS mode, the
HMAC key is dynamically generated and shared between peers
via the TLS control channel. If OpenVPN receives a packet
with a bad HMAC it will drop the packet. HMAC usually adds
16 or 20 bytes per packet. Set <b>alg=none</b> to disable
authentication.</p>

<p style="margin-left:22%; margin-top: 1em">For more
information on HMAC see
<i>http://www.cs.ucsd.edu/users/mihir/papers/hmac.html</i></p>

<p style="margin-left:11%;"><b>&minus;&minus;cipher
alg</b></p>

<p style="margin-left:22%;">Encrypt data channel packets
with cipher algorithm <b>alg.</b> The default is
<b>BF-CBC,</b> an abbreviation for Blowfish in Cipher Block
Chaining mode. Blowfish has the advantages of being fast,
very secure, and allowing key sizes of up to 448 bits.
Blowfish is designed to be used in situations where keys are
changed infrequently.</p>

<p style="margin-left:22%; margin-top: 1em">For more
information on blowfish, see
<i>http://www.counterpane.com/blowfish.html</i></p>

<p style="margin-left:22%; margin-top: 1em">To see other
ciphers that are available with OpenVPN, use the
<b>&minus;&minus;show&minus;ciphers</b> option.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN
supports the CBC, CFB, and OFB cipher modes, however CBC is
recommended and CFB and OFB should be considered advanced
modes.</p>

<p style="margin-left:22%; margin-top: 1em">Set
<b>alg=none</b> to disable encryption.</p>

<p style="margin-left:11%;"><b>&minus;&minus;keysize
n</b></p>

<p style="margin-left:22%;">Size of cipher key in bits
(optional). If unspecified, defaults to cipher-specific
default. The <b>&minus;&minus;show&minus;ciphers</b> option
(see below) shows all available OpenSSL ciphers, their
default key sizes, and whether the key size can be changed.
Use care in changing a cipher&rsquo;s default key size. Many
ciphers have not been extensively cryptanalyzed with
non-standard key lengths, and a larger key may offer no real
guarantee of greater security, or may even reduce
security.</p>

<p style="margin-left:11%;"><b>&minus;&minus;prng alg
[nsl]</b></p>

<p style="margin-left:22%;">(Advanced) For PRNG
(Pseudo-random number generator), use digest algorithm
<b>alg</b> (default=sha1), and set <b>nsl</b> (default=16)
to the size in bytes of the nonce secret length (between 16
and 64).</p>

<p style="margin-left:22%; margin-top: 1em">Set
<b>alg=none</b> to disable the PRNG and use the OpenSSL
RAND_bytes function instead for all of OpenVPN&rsquo;s
pseudo-random number needs.</p>

<p style="margin-left:11%;"><b>&minus;&minus;engine
[engine-name]</b></p>

<p style="margin-left:22%;">Enable OpenSSL hardware-based
crypto engine functionality.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>engine-name</b> is specified, use a specific crypto
engine. Use the <b>&minus;&minus;show&minus;engines</b>
standalone option to list the crypto engines which are
supported by OpenSSL.</p>


<p style="margin-left:11%;"><b>&minus;&minus;no&minus;replay</b></p>

<p style="margin-left:22%;">(Advanced) Disable
OpenVPN&rsquo;s protection against replay attacks.
Don&rsquo;t use this option unless you are prepared to make
a tradeoff of greater efficiency in exchange for less
security.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN
provides datagram replay protection by default.</p>

<p style="margin-left:22%; margin-top: 1em">Replay
protection is accomplished by tagging each outgoing datagram
with an identifier that is guaranteed to be unique for the
key being used. The peer that receives the datagram will
check for the uniqueness of the identifier. If the
identifier was already received in a previous datagram,
OpenVPN will drop the packet. Replay protection is important
to defeat attacks such as a SYN flood attack, where the
attacker listens in the wire, intercepts a TCP SYN packet
(identifying it by the context in which it occurs in
relation to other packets), then floods the receiving peer
with copies of this packet.</p>


<p style="margin-left:22%; margin-top: 1em">OpenVPN&rsquo;s
replay protection is implemented in slightly different ways,
depending on the key management mode you have selected.</p>

<p style="margin-left:22%; margin-top: 1em">In Static Key
mode or when using an CFB or OFB mode cipher, OpenVPN uses a
64 bit unique identifier that combines a time stamp with an
incrementing sequence number.</p>

<p style="margin-left:22%; margin-top: 1em">When using TLS
mode for key exchange and a CBC cipher mode, OpenVPN uses
only a 32 bit sequence number without a time stamp, since
OpenVPN can guarantee the uniqueness of this value for each
key. As in IPSec, if the sequence number is close to
wrapping back to zero, OpenVPN will trigger a new key
exchange.</p>

<p style="margin-left:22%; margin-top: 1em">To check for
replays, OpenVPN uses the <i>sliding window</i> algorithm
used by IPSec.</p>


<p style="margin-left:11%;"><b>&minus;&minus;replay&minus;window
n [t]</b></p>

<p style="margin-left:22%;">Use a replay protection
sliding-window of size <b>n</b> and a time window of
<b>t</b> seconds.</p>

<p style="margin-left:22%; margin-top: 1em">By default
<b>n</b> is 64 (the IPSec default) and <b>t</b> is 15
seconds.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
only relevant in UDP mode, i.e. when either
<b>&minus;&minus;proto udp</b> is specifed, or no
<b>&minus;&minus;proto</b> option is specified.</p>

<p style="margin-left:22%; margin-top: 1em">When OpenVPN
tunnels IP packets over UDP, there is the possibility that
packets might be dropped or delivered out of order. Because
OpenVPN, like IPSec, is emulating the physical network
layer, it will accept an out-of-order packet sequence, and
will deliver such packets in the same order they were
received to the TCP/IP protocol stack, provided they satisfy
several constraints.</p>

<p style="margin-left:22%; margin-top: 1em"><b>(a)</b> The
packet cannot be a replay (unless
<b>&minus;&minus;no&minus;replay</b> is specified, which
disables replay protection altogether).</p>

<p style="margin-left:22%; margin-top: 1em"><b>(b)</b> If a
packet arrives out of order, it will only be accepted if the
difference between its sequence number and the highest
sequence number received so far is less than <b>n.</b></p>

<p style="margin-left:22%; margin-top: 1em"><b>(c)</b> If a
packet arrives out of order, it will only be accepted if it
arrives no later than <b>t</b> seconds after any packet
containing a higher sequence number.</p>

<p style="margin-left:22%; margin-top: 1em">If you are
using a network link with a large pipeline (meaning that the
product of bandwidth and latency is high), you may want to
use a larger value for <b>n.</b> Satellite links in
particular often require this.</p>

<p style="margin-left:22%; margin-top: 1em">If you run
OpenVPN at <b>&minus;&minus;verb 4,</b> you will see the
message &quot;Replay-window backtrack occurred [x]&quot;
every time the maximum sequence number backtrack seen thus
far increases. This can be used to calibrate <b>n.</b></p>

<p style="margin-left:22%; margin-top: 1em">There is some
controversy on the appropriate method of handling packet
reordering at the security layer.</p>

<p style="margin-left:22%; margin-top: 1em">Namely, to what
extent should the security layer protect the encapsulated
protocol from attacks which masquerade as the kinds of
normal packet loss and reordering that occur over IP
networks?</p>

<p style="margin-left:22%; margin-top: 1em">The IPSec and
OpenVPN approach is to allow packet reordering within a
certain fixed sequence number window.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN adds to
the IPSec model by limiting the window size in time as well
as sequence space.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN also
adds TCP transport as an option (not offered by IPSec) in
which case OpenVPN can adopt a very strict attitude towards
message deletion and reordering: Don&rsquo;t allow it. Since
TCP guarantees reliability, any packet loss or reordering
event can be assumed to be an attack.</p>

<p style="margin-left:22%; margin-top: 1em">In this sense,
it could be argued that TCP tunnel transport is preferred
when tunneling non-IP or UDP application protocols which
might be vulnerable to a message deletion or reordering
attack which falls within the normal operational parameters
of IP networks.</p>

<p style="margin-left:22%; margin-top: 1em">So I would make
the statement that one should never tunnel a non-IP protocol
or UDP application protocol over UDP, if the protocol might
be vulnerable to a message deletion or reordering attack
that falls within the normal operating parameters of what is
to be expected from the physical IP layer. The problem is
easily fixed by simply using TCP as the VPN transport
layer.</p>


<p style="margin-left:11%;"><b>&minus;&minus;mute&minus;replay&minus;warnings</b></p>

<p style="margin-left:22%;">Silence the output of replay
warnings, which are a common false alarm on WiFi networks.
This option preserves the security of the replay protection
code without the verbosity associated with warnings about
duplicate packets.</p>


<p style="margin-left:11%;"><b>&minus;&minus;replay&minus;persist
file</b></p>

<p style="margin-left:22%;">Persist replay-protection state
across sessions using <b>file</b> to save and reload the
state.</p>

<p style="margin-left:22%; margin-top: 1em">This option
will strengthen protection against replay attacks,
especially when you are using OpenVPN in a dynamic context
(such as with <b>&minus;&minus;inetd)</b> when OpenVPN
sessions are frequently started and stopped.</p>

<p style="margin-left:22%; margin-top: 1em">This option
will keep a disk copy of the current replay protection state
(i.e. the most recent packet timestamp and sequence number
received from the remote peer), so that if an OpenVPN
session is stopped and restarted, it will reject any replays
of packets which were already received by the prior
session.</p>

<p style="margin-left:22%; margin-top: 1em">This option
only makes sense when replay protection is enabled (the
default) and you are using either
<b>&minus;&minus;secret</b> (shared-secret key mode) or TLS
mode with <b>&minus;&minus;tls&minus;auth.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;no&minus;iv</b></p>

<p style="margin-left:22%;">(Advanced) Disable
OpenVPN&rsquo;s use of IV (cipher initialization vector).
Don&rsquo;t use this option unless you are prepared to make
a tradeoff of greater efficiency in exchange for less
security.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN uses an
IV by default, and requires it for CFB and OFB cipher modes
(which are totally insecure without it). Using an IV is
important for security when multiple messages are being
encrypted/decrypted with the same key.</p>

<p style="margin-left:22%; margin-top: 1em">IV is
implemented differently depending on the cipher mode
used.</p>

<p style="margin-left:22%; margin-top: 1em">In CBC mode,
OpenVPN uses a pseudo-random IV for each packet.</p>

<p style="margin-left:22%; margin-top: 1em">In CFB/OFB
mode, OpenVPN uses a unique sequence number and time stamp
as the IV. In fact, in CFB/OFB mode, OpenVPN uses a datagram
space-saving optimization that uses the unique identifier
for datagram replay protection as the IV.</p>


<p style="margin-left:11%;"><b>&minus;&minus;use&minus;prediction&minus;resistance</b></p>

<p style="margin-left:22%;">Enable prediction resistance on
PolarSSL&rsquo;s RNG.</p>

<p style="margin-left:22%; margin-top: 1em">Enabling
prediction resistance causes the RNG to reseed in each call
for random. Reseeding this often can quickly deplete the
kernel entropy pool.</p>

<p style="margin-left:22%; margin-top: 1em">If you need
this option, please consider running a daemon that adds
entropy to the kernel pool.</p>

<p style="margin-left:22%; margin-top: 1em">Note that this
option only works with PolarSSL versions greater than
1.1.</p>


<p style="margin-left:11%;"><b>&minus;&minus;test&minus;crypto</b></p>

<p style="margin-left:22%;">Do a self-test of
OpenVPN&rsquo;s crypto options by encrypting and decrypting
test packets using the data channel encryption options
specified above. This option does not require a peer to
function, and therefore can be specified without
<b>&minus;&minus;dev</b> or <b>&minus;&minus;remote.</b></p>

<p style="margin-left:22%; margin-top: 1em">The typical
usage of <b>&minus;&minus;test&minus;crypto</b> would be
something like this:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;test&minus;crypto &minus;&minus;secret
key</b></p>

<p style="margin-left:22%; margin-top: 1em">or</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;test&minus;crypto &minus;&minus;secret key
&minus;&minus;verb 9</b></p>

<p style="margin-left:22%; margin-top: 1em">This option is
very useful to test OpenVPN after it has been ported to a
new platform, or to isolate problems in the compiler,
OpenSSL crypto library, or OpenVPN&rsquo;s crypto code.
Since it is a self-test mode, problems with encryption and
authentication can be debugged independently of network and
tunnel issues.</p>

<p style="margin-left:11%; margin-top: 1em"><b>TLS Mode
Options:</b> <br>
TLS mode is the most powerful crypto mode of OpenVPN in both
security and flexibility. TLS mode works by establishing
control and data channels which are multiplexed over a
single TCP/UDP port. OpenVPN initiates a TLS session over
the control channel and uses it to exchange cipher and HMAC
keys to protect the data channel. TLS mode uses a robust
reliability layer over the UDP connection for all control
channel communication, while the data channel, over which
encrypted tunnel data passes, is forwarded without any
mediation. The result is the best of both worlds: a fast
data channel that forwards over UDP with only the overhead
of encrypt, decrypt, and HMAC functions, and a control
channel that provides all of the security features of TLS,
including certificate-based authentication and Diffie
Hellman forward secrecy.</p>

<p style="margin-left:11%; margin-top: 1em">To use TLS
mode, each peer that runs OpenVPN should have its own local
certificate/key pair ( <b>&minus;&minus;cert</b> and
<b>&minus;&minus;key</b> ), signed by the root certificate
which is specified in <b>&minus;&minus;ca.</b></p>

<p style="margin-left:11%; margin-top: 1em">When two
OpenVPN peers connect, each presents its local certificate
to the other. Each peer will then check that its partner
peer presented a certificate which was signed by the master
root certificate as specified in
<b>&minus;&minus;ca.</b></p>

<p style="margin-left:11%; margin-top: 1em">If that check
on both peers succeeds, then the TLS negotiation will
succeed, both OpenVPN peers will exchange temporary session
keys, and the tunnel will begin passing data.</p>

<p style="margin-left:11%; margin-top: 1em">The OpenVPN
distribution contains a set of scripts for managing RSA
certificates &amp; keys, located in the <i>easy-rsa</i>
subdirectory.</p>

<p style="margin-left:11%; margin-top: 1em">The easy-rsa
package is also rendered in web form here:
<i>http://openvpn.net/easyrsa.html</i> <b><br>
&minus;&minus;tls&minus;server</b></p>

<p style="margin-left:22%;">Enable TLS and assume server
role during TLS handshake. Note that OpenVPN is designed as
a peer-to-peer application. The designation of client or
server is only for the purpose of negotiating the TLS
control channel.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;client</b></p>

<p style="margin-left:22%;">Enable TLS and assume client
role during TLS handshake.</p>

<p style="margin-left:11%;"><b>&minus;&minus;ca
file</b></p>

<p style="margin-left:22%;">Certificate authority (CA) file
in .pem format, also referred to as the <i>root</i>
certificate. This file can have multiple certificates in
.pem format, concatenated together. You can construct your
own certificate authority certificate and private key by
using a command such as:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openssl req
&minus;nodes &minus;new &minus;x509 &minus;keyout ca.key
&minus;out ca.crt</b></p>

<p style="margin-left:22%; margin-top: 1em">Then edit your
openssl.cnf file and edit the <b>certificate</b> variable to
point to your new root certificate <b>ca.crt.</b></p>

<p style="margin-left:22%; margin-top: 1em">For testing
purposes only, the OpenVPN distribution includes a sample CA
certificate (ca.crt). Of course you should never use the
test certificates and test keys distributed with OpenVPN in
a production environment, since by virtue of the fact that
they are distributed with OpenVPN, they are totally
insecure.</p>

<p style="margin-left:11%;"><b>&minus;&minus;capath
dir</b></p>

<p style="margin-left:22%;">Directory containing trusted
certificates (CAs and CRLs). Available with OpenSSL version
&gt;= 0.9.7 dev. Not available with PolarSSL.</p>

<p style="margin-left:22%; margin-top: 1em">When using the
<b>&minus;&minus;capath</b> option, you are required to
supply valid CRLs for the CAs too. CAs in the capath
directory are expected to be named &lt;hash&gt;.&lt;n&gt;.
CRLs are expected to be named &lt;hash&gt;.r&lt;n&gt;. See
the <b>-CApath</b> option of <b>openssl verify</b> , and the
<b>-hash</b> option of <b>openssl x509</b> and <b>openssl
crl</b> for more information.</p>

<p style="margin-left:11%;"><b>&minus;&minus;dh
file</b></p>

<p style="margin-left:22%;">File containing Diffie Hellman
parameters in .pem format (required for
<b>&minus;&minus;tls&minus;server</b> only). Use</p>

<p style="margin-left:22%; margin-top: 1em"><b>openssl
dhparam &minus;out dh1024.pem 1024</b></p>

<p style="margin-left:22%; margin-top: 1em">to generate
your own, or use the existing dh1024.pem file included with
the OpenVPN distribution. Diffie Hellman parameters may be
considered public.</p>

<p style="margin-left:11%;"><b>&minus;&minus;cert
file</b></p>

<p style="margin-left:22%;">Local peer&rsquo;s signed
certificate in .pem format -- must be signed by a
certificate authority whose certificate is in
<b>&minus;&minus;ca file.</b> Each peer in an OpenVPN link
running in TLS mode should have its own certificate and
private key file. In addition, each certificate should have
been signed by the key of a certificate authority whose
public key resides in the <b>&minus;&minus;ca</b>
certificate authority file. You can easily make your own
certificate authority (see above) or pay money to use a
commercial service such as thawte.com (in which case you
will be helping to finance the world&rsquo;s second space
tourist :). To generate a certificate, you can use a command
such as:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openssl req
&minus;nodes &minus;new &minus;keyout mycert.key &minus;out
mycert.csr</b></p>

<p style="margin-left:22%; margin-top: 1em">If your
certificate authority private key lives on another machine,
copy the certificate signing request (mycert.csr) to this
other machine (this can be done over an insecure channel
such as email). Now sign the certificate with a command such
as:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openssl ca
&minus;out mycert.crt &minus;in mycert.csr</b></p>

<p style="margin-left:22%; margin-top: 1em">Now copy the
certificate (mycert.crt) back to the peer which initially
generated the .csr file (this can be over a public medium).
Note that the <b>openssl ca</b> command reads the location
of the certificate authority key from its configuration file
such as <b>/usr/share/ssl/openssl.cnf</b> -- note also that
for certificate authority functions, you must set up the
files <b>index.txt</b> (may be empty) and <b>serial</b>
(initialize to <b>01</b> ).</p>


<p style="margin-left:11%;"><b>&minus;&minus;extra&minus;certs
file</b></p>

<p style="margin-left:22%;">Specify a <b>file</b>
containing one or more PEM certs (concatenated together)
that complete the local certificate chain.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
useful for &quot;split&quot; CAs, where the CA for server
certs is different than the CA for client certs. Putting
certs in this file allows them to be used to complete the
local certificate chain without trusting them to verify the
peer-submitted certificate, as would be the case if the
certs were placed in the <b>ca</b> file.</p>

<p style="margin-left:11%;"><b>&minus;&minus;key
file</b></p>

<p style="margin-left:22%;">Local peer&rsquo;s private key
in .pem format. Use the private key which was generated when
you built your peer&rsquo;s certificate (see
<b>&minus;&minus;cert file</b> above).</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;version&minus;min
version [&rsquo;or&minus;highest&rsquo;]</b></p>

<p style="margin-left:22%;">Enable TLS version negotiation,
and set the minimum TLS version we will accept from the peer
(default is &quot;1.0&quot;). Examples for version include
&quot;1.0&quot;, &quot;1.1&quot;, or &quot;1.2&quot;. If
&rsquo;or-highest&rsquo; is specified and version is not
recognized, we will only accept the highest TLS version
supported by the local SSL implementation.</p>

<p style="margin-left:22%; margin-top: 1em">Also see
<b>&minus;&minus;tls&minus;version&minus;max</b> below, for
information on compatibility.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;version&minus;max
version</b></p>

<p style="margin-left:22%;">Set the maximum TLS version we
will use (default is the highest version supported).
Examples for version include &quot;1.0&quot;,
&quot;1.1&quot;, or &quot;1.2&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">If and only if
this is set to 1.0, and OpenSSL is used (not PolarSSL), then
OpenVPN will set up OpenSSL to use a fixed TLSv1 handshake.
All other configurations will autonegotiate in the given
limits, and the choice of handshake versions is left to the
SSL implementation.</p>

<p style="margin-left:11%;"><b>&minus;&minus;pkcs12
file</b></p>

<p style="margin-left:22%;">Specify a PKCS #12 file
containing local private key, local certificate, and root CA
certificate. This option can be used instead of
<b>&minus;&minus;ca, &minus;&minus;cert,</b> and
<b>&minus;&minus;key.</b> Not available with PolarSSL.</p>


<p style="margin-left:11%;"><b>&minus;&minus;verify&minus;hash
hash</b></p>

<p style="margin-left:22%;">Specify SHA1 fingerprint for
level-1 cert. The level-1 cert is the CA (or intermediate
cert) that signs the leaf certificate, and is one removed
from the leaf certificate in the direction of the root. When
accepting a connection from a peer, the level-1 cert
fingerprint must match <b>hash</b> or certificate
verification will fail. Hash is specified as XX:XX:... For
example:
AD:B0:95:D8:09:C8:36:45:12:A9:89:C8:90:09:CB:13:72:A6:AD:16</p>


<p style="margin-left:11%;"><b>&minus;&minus;pkcs11&minus;cert&minus;private
[0|1]...</b></p>

<p style="margin-left:22%;">Set if access to certificate
object should be performed after login. Every provider has
its own setting.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pkcs11&minus;id
name</b></p>

<p style="margin-left:22%;">Specify the serialized
certificate id to be used. The id can be gotten by the
standalone <b>&minus;&minus;show&minus;pkcs11&minus;ids</b>
option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pkcs11&minus;id&minus;management</b></p>

<p style="margin-left:22%;">Acquire PKCS#11 id from
management interface. In this case a NEED-STR
&rsquo;pkcs11-id-request&rsquo; real-time message will be
triggered, application may use pkcs11-id-count command to
retrieve available number of certificates, and pkcs11-id-get
command to retrieve certificate id and certificate body.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pkcs11&minus;pin&minus;cache
seconds</b></p>

<p style="margin-left:22%;">Specify how many seconds the
PIN can be cached, the default is until the token is
removed.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pkcs11&minus;protected&minus;authentication
[0|1]...</b></p>

<p style="margin-left:22%;">Use PKCS#11 protected
authentication path, useful for biometric and external
keypad devices. Every provider has its own setting.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pkcs11&minus;providers
provider...</b></p>

<p style="margin-left:22%;">Specify a RSA Security Inc.
PKCS #11 Cryptographic Token Interface (Cryptoki) providers
to load. This option can be used instead of
<b>&minus;&minus;cert, &minus;&minus;key,</b> and
<b>&minus;&minus;pkcs12.</b></p>

<p style="margin-left:22%; margin-top: 1em">If p11-kit is
present on the system, its <b>p11-kit-proxy.so</b> module
will be loaded by default if either the
<b>&minus;&minus;pkcs11&minus;id</b> or
<b>&minus;&minus;pkcs11&minus;id&minus;management</b>
options are specified without
<b>&minus;&minus;pkcs11&minus;provider</b> being given.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pkcs11&minus;private&minus;mode
mode...</b></p>

<p style="margin-left:22%;">Specify which method to use in
order to perform private key operations. A different mode
can be specified for each provider. Mode is encoded as hex
number, and can be a mask one of the following:</p>

<p style="margin-left:22%; margin-top: 1em"><b>0</b>
(default) -- Try to determine automatically. <b><br>
1</b> -- Use sign. <b><br>
2</b> -- Use sign recover. <b><br>
4</b> -- Use decrypt. <b><br>
8</b> -- Use unwrap.</p>

<p style="margin-left:11%;"><b>&minus;&minus;cryptoapicert
select-string</b></p>

<p style="margin-left:22%;">Load the certificate and
private key from the Windows Certificate System Store
(Windows/OpenSSL Only).</p>

<p style="margin-left:22%; margin-top: 1em">Use this option
instead of <b>&minus;&minus;cert</b> and
<b>&minus;&minus;key.</b></p>

<p style="margin-left:22%; margin-top: 1em">This makes it
possible to use any smart card, supported by Windows, but
also any kind of certificate, residing in the Cert Store,
where you have access to the private key. This option has
been tested with a couple of different smart cards (GemSAFE,
Cryptoflex, and Swedish Post Office eID) on the client side,
and also an imported PKCS12 software certificate on the
server side.</p>

<p style="margin-left:22%; margin-top: 1em">To select a
certificate, based on a substring search in the
certificate&rsquo;s subject:</p>


<p style="margin-left:22%; margin-top: 1em"><b>cryptoapicert</b>
&quot;SUBJ:Peter Runestig&quot;</p>

<p style="margin-left:22%; margin-top: 1em">To select a
certificate, based on certificate&rsquo;s thumbprint:</p>


<p style="margin-left:22%; margin-top: 1em"><b>cryptoapicert</b>
&quot;THUMB:f6 49 24 41 01 b4 ...&quot;</p>

<p style="margin-left:22%; margin-top: 1em">The thumbprint
hex string can easily be copy-and-pasted from the Windows
Certificate Store GUI.</p>


<p style="margin-left:11%;"><b>&minus;&minus;key&minus;method
m</b></p>

<p style="margin-left:22%;">Use data channel key
negotiation method <b>m.</b> The key method must match on
both sides of the connection.</p>

<p style="margin-left:22%; margin-top: 1em">After OpenVPN
negotiates a TLS session, a new set of keys for protecting
the tunnel data channel is generated and exchanged over the
TLS session.</p>

<p style="margin-left:22%; margin-top: 1em">In method 1
(the default for OpenVPN 1.x), both sides generate random
encrypt and HMAC-send keys which are forwarded to the other
host over the TLS channel.</p>

<p style="margin-left:22%; margin-top: 1em">In method 2,
(the default for OpenVPN 2.0) the client generates a random
key. Both client and server also generate some random seed
material. All key source material is exchanged over the TLS
channel. The actual keys are generated using the TLS PRF
function, taking source entropy from both client and server.
Method 2 is designed to closely parallel the key generation
process used by TLS 1.0.</p>

<p style="margin-left:22%; margin-top: 1em">Note that in
TLS mode, two separate levels of keying occur:</p>

<p style="margin-left:22%; margin-top: 1em">(1) The TLS
connection is initially negotiated, with both sides of the
connection producing certificates and verifying the
certificate (or other authentication info provided) of the
other side. The <b>&minus;&minus;key&minus;method</b>
parameter has no effect on this process.</p>

<p style="margin-left:22%; margin-top: 1em">(2) After the
TLS connection is established, the tunnel session keys are
separately negotiated over the existing secure TLS channel.
Here, <b>&minus;&minus;key&minus;method</b> determines the
derivation of the tunnel session keys.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;cipher
l</b></p>

<p style="margin-left:22%;">A list <b>l</b> of allowable
TLS ciphers delimited by a colon (&quot;:&quot;).</p>

<p style="margin-left:22%; margin-top: 1em">This setting
can be used to ensure that certain cipher suites are used
(or not used) for the TLS connection. OpenVPN uses TLS to
secure the control channel, over which the keys that are
used to protect the actual VPN traffic are exchanged.</p>

<p style="margin-left:22%; margin-top: 1em">The supplied
list of ciphers is (after potential OpenSSL/IANA name
translation) simply supplied to the crypto library. Please
see the OpenSSL and/or PolarSSL documentation for details on
the cipher list interpretation.</p>

<p style="margin-left:22%; margin-top: 1em">Use
<b>&minus;&minus;show&minus;tls</b> to see a list of TLS
ciphers supported by your crypto library.</p>

<p style="margin-left:22%; margin-top: 1em">Warning!
<b>&minus;&minus;tls&minus;cipher</b> is an expert feature,
which - if used correcly - can improve the security of your
VPN connection. But it is also easy to unwittingly use it to
carefully align a gun with your foot, or just break your
connection. Use with care!</p>

<p style="margin-left:22%; margin-top: 1em">The default for
--tls-cipher is to use PolarSSL&rsquo;s default cipher list
when using PolarSSL or
&quot;DEFAULT:!EXP:!PSK:!SRP:!kRSA&quot; when using
OpenSSL.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;timeout
n</b></p>

<p style="margin-left:22%;">Packet retransmit timeout on
TLS control channel if no acknowledgment from remote within
<b>n</b> seconds (default=2). When OpenVPN sends a control
packet to its peer, it will expect to receive an
acknowledgement within <b>n</b> seconds or it will
retransmit the packet, subject to a TCP-like exponential
backoff algorithm. This parameter only applies to control
channel packets. Data channel packets (which carry encrypted
tunnel data) are never acknowledged, sequenced, or
retransmitted by OpenVPN because the higher level network
protocols running on top of the tunnel such as TCP expect
this role to be left to them.</p>


<p style="margin-left:11%;"><b>&minus;&minus;reneg&minus;bytes
n</b></p>

<p style="margin-left:22%;">Renegotiate data channel key
after <b>n</b> bytes sent or received (disabled by default).
OpenVPN allows the lifetime of a key to be expressed as a
number of bytes encrypted/decrypted, a number of packets, or
a number of seconds. A key renegotiation will be forced if
any of these three criteria are met by either peer.</p>


<p style="margin-left:11%;"><b>&minus;&minus;reneg&minus;pkts
n</b></p>

<p style="margin-left:22%;">Renegotiate data channel key
after <b>n</b> packets sent and received (disabled by
default).</p>


<p style="margin-left:11%;"><b>&minus;&minus;reneg&minus;sec
n</b></p>

<p style="margin-left:22%;">Renegotiate data channel key
after <b>n</b> seconds (default=3600).</p>

<p style="margin-left:22%; margin-top: 1em">When using
dual-factor authentication, note that this default value may
cause the end user to be challenged to reauthorize once per
hour.</p>

<p style="margin-left:22%; margin-top: 1em">Also, keep in
mind that this option can be used on both the client and
server, and whichever uses the lower value will be the one
to trigger the renegotiation. A common mistake is to set
<b>&minus;&minus;reneg&minus;sec</b> to a higher value on
either the client or server, while the other side of the
connection is still using the default value of 3600 seconds,
meaning that the renegotiation will still occur once per
3600 seconds. The solution is to increase
&minus;&minus;reneg&minus;sec on both the client and server,
or set it to 0 on one side of the connection (to disable),
and to your chosen value on the other side.</p>


<p style="margin-left:11%;"><b>&minus;&minus;hand&minus;window
n</b></p>

<p style="margin-left:22%;">Handshake Window -- the
TLS-based key exchange must finalize within <b>n</b> seconds
of handshake initiation by any peer (default = 60 seconds).
If the handshake fails we will attempt to reset our
connection with our peer and try again. Even in the event of
handshake failure we will still use our expiring key for up
to <b>&minus;&minus;tran&minus;window</b> seconds to
maintain continuity of transmission of tunnel data.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tran&minus;window
n</b></p>

<p style="margin-left:22%;">Transition window -- our old
key can live this many seconds after a new a key
renegotiation begins (default = 3600 seconds). This feature
allows for a graceful transition from old to new key, and
removes the key renegotiation sequence from the critical
path of tunnel data forwarding.</p>


<p style="margin-left:11%;"><b>&minus;&minus;single&minus;session</b></p>

<p style="margin-left:22%;">After initially connecting to a
remote peer, disallow any new connections. Using this option
means that a remote peer cannot connect, disconnect, and
then reconnect.</p>

<p style="margin-left:22%; margin-top: 1em">If the daemon
is reset by a signal or
<b>&minus;&minus;ping&minus;restart,</b> it will allow one
new connection.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;single&minus;session</b>
can be used with <b>&minus;&minus;ping&minus;exit</b> or
<b>&minus;&minus;inactive</b> to create a single dynamic
session that will exit when finished.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;exit</b></p>

<p style="margin-left:22%;">Exit on TLS negotiation
failure.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;auth
file [direction]</b></p>

<p style="margin-left:22%;">Add an additional layer of HMAC
authentication on top of the TLS control channel to protect
against DoS attacks.</p>

<p style="margin-left:22%; margin-top: 1em">In a nutshell,
<b>&minus;&minus;tls&minus;auth</b> enables a kind of
&quot;HMAC firewall&quot; on OpenVPN&rsquo;s TCP/UDP port,
where TLS control channel packets bearing an incorrect HMAC
signature can be dropped immediately without response.</p>

<p style="margin-left:22%; margin-top: 1em"><b>file</b>
(required) is a key file which can be in one of two
formats:</p>

<p style="margin-left:22%; margin-top: 1em"><b>(1)</b> An
OpenVPN static key file generated by
<b>&minus;&minus;genkey</b> (required if <b>direction</b>
parameter is used).</p>

<p style="margin-left:22%; margin-top: 1em"><b>(2)
DEPRECATED</b> A freeform passphrase file. In this case the
HMAC key will be derived by taking a secure hash of this
file, similar to the <b>md5sum</b>(1) or <b>sha1sum</b>(1)
commands. This option is deprecated and will stop working in
OpenVPN 2.4 and newer releases.</p>

<p style="margin-left:22%; margin-top: 1em">OpenVPN will
first try format (1), and if the file fails to parse as a
static key file, format (2) will be used.</p>

<p style="margin-left:22%; margin-top: 1em">See the
<b>&minus;&minus;secret</b> option for more information on
the optional <b>direction</b> parameter.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;tls&minus;auth</b>
is recommended when you are running OpenVPN in a mode where
it is listening for packets from any IP address, such as
when <b>&minus;&minus;remote</b> is not specified, or
<b>&minus;&minus;remote</b> is specified with
<b>&minus;&minus;float.</b></p>

<p style="margin-left:22%; margin-top: 1em">The rationale
for this feature is as follows. TLS requires a multi-packet
exchange before it is able to authenticate a peer. During
this time before authentication, OpenVPN is allocating
resources (memory and CPU) to this potential peer. The
potential peer is also exposing many parts of OpenVPN and
the OpenSSL library to the packets it is sending. Most
successful network attacks today seek to either exploit bugs
in programs (such as buffer overflow attacks) or force a
program to consume so many resources that it becomes
unusable. Of course the first line of defense is always to
produce clean, well-audited code. OpenVPN has been written
with buffer overflow attack prevention as a top priority.
But as history has shown, many of the most widely used
network applications have, from time to time, fallen to
buffer overflow attacks.</p>

<p style="margin-left:22%; margin-top: 1em">So as a second
line of defense, OpenVPN offers this special layer of
authentication on top of the TLS control channel so that
every packet on the control channel is authenticated by an
HMAC signature and a unique ID for replay protection. This
signature will also help protect against DoS (Denial of
Service) attacks. An important rule of thumb in reducing
vulnerability to DoS attacks is to minimize the amount of
resources a potential, but as yet unauthenticated, client is
able to consume.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;tls&minus;auth</b>
does this by signing every TLS control channel packet with
an HMAC signature, including packets which are sent before
the TLS level has had a chance to authenticate the peer. The
result is that packets without the correct signature can be
dropped immediately upon reception, before they have a
chance to consume additional system resources such as by
initiating a TLS handshake.
<b>&minus;&minus;tls&minus;auth</b> can be strengthened by
adding the <b>&minus;&minus;replay&minus;persist</b> option
which will keep OpenVPN&rsquo;s replay protection state in a
file so that it is not lost across restarts.</p>

<p style="margin-left:22%; margin-top: 1em">It should be
emphasized that this feature is optional and that the
passphrase/key file used with
<b>&minus;&minus;tls&minus;auth</b> gives a peer nothing
more than the power to initiate a TLS handshake. It is not
used to encrypt or authenticate any tunnel data.</p>

<p style="margin-left:11%;"><b>&minus;&minus;askpass
[file]</b></p>

<p style="margin-left:22%;">Get certificate password from
console or <b>file</b> before we daemonize.</p>

<p style="margin-left:22%; margin-top: 1em">For the
extremely security conscious, it is possible to protect your
private key with a password. Of course this means that every
time the OpenVPN daemon is started you must be there to type
the password. The <b>&minus;&minus;askpass</b> option allows
you to start OpenVPN from the command line. It will query
you for a password before it daemonizes. To protect a
private key with a password you should omit the
<b>&minus;nodes</b> option when you use the <b>openssl</b>
command line tool to manage certificates and private
keys.</p>

<p style="margin-left:22%; margin-top: 1em">If <b>file</b>
is specified, read the password from the first line of
<b>file.</b> Keep in mind that storing your password in a
file to a certain extent invalidates the extra security
provided by using an encrypted key (Note: OpenVPN will only
read passwords from a file if it has been built with the
&minus;&minus;enable&minus;password&minus;save configure
option, or on Windows by defining ENABLE_PASSWORD_SAVE in
win/settings.in).</p>


<p style="margin-left:11%;"><b>&minus;&minus;auth&minus;nocache</b></p>

<p style="margin-left:22%;">Don&rsquo;t cache
<b>&minus;&minus;askpass</b> or
<b>&minus;&minus;auth&minus;user&minus;pass</b>
username/passwords in virtual memory.</p>

<p style="margin-left:22%; margin-top: 1em">If specified,
this directive will cause OpenVPN to immediately forget
username/password inputs after they are used. As a result,
when OpenVPN needs a username/password, it will prompt for
input from stdin, which may be multiple times during the
duration of an OpenVPN session.</p>

<p style="margin-left:22%; margin-top: 1em">When using
&minus;&minus;auth&minus;nocache in combination with a
user/password file and &minus;&minus;chroot or
&minus;&minus;daemon, make sure to use an absolute path.</p>

<p style="margin-left:22%; margin-top: 1em">This directive
does not affect the <b>&minus;&minus;http&minus;proxy</b>
username/password. It is always cached.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;verify
cmd</b></p>

<p style="margin-left:22%;">Run command <b>cmd</b> to
verify the X509 name of a pending TLS connection that has
otherwise passed all other tests of certification (except
for revocation via <b>&minus;&minus;crl&minus;verify</b>
directive; the revocation test occurs after the
<b>&minus;&minus;tls&minus;verify</b> test).</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
should return 0 to allow the TLS handshake to proceed, or 1
to fail.</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd</b>
consists of a path to script (or executable program),
optionally followed by arguments. The path and arguments may
be single- or double-quoted and/or escaped using a
backslash, and should be separated by one or more
spaces.</p>

<p style="margin-left:22%; margin-top: 1em">When <b>cmd</b>
is executed two arguments are appended after any arguments
specified in <b>cmd</b> , as follows:</p>

<p style="margin-left:22%; margin-top: 1em"><b>cmd
certificate_depth subject</b></p>

<p style="margin-left:22%; margin-top: 1em">These arguments
are, respectively, the current certificate depth and the
X509 common name (cn) of the peer.</p>

<p style="margin-left:22%; margin-top: 1em">This feature is
useful if the peer you want to trust has a certificate which
was signed by a certificate authority who also signed many
other certificates, where you don&rsquo;t necessarily want
to trust all of them, but rather be selective about which
peer certificate you will accept. This feature allows you to
write a script which will test the X509 name on a
certificate and decide whether or not it should be accepted.
For a simple perl script which will test the common name
field on the certificate, see the file <b>verify-cn</b> in
the OpenVPN distribution.</p>

<p style="margin-left:22%; margin-top: 1em">See the
&quot;Environmental Variables&quot; section below for
additional parameters passed as environmental variables.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;export&minus;cert
directory</b></p>

<p style="margin-left:22%;">Store the certificates the
clients uses upon connection to this directory. This will be
done before &minus;&minus;tls&minus;verify is called. The
certificates will use a temporary name and will be deleted
when the tls-verify script returns. The file name used for
the certificate is available via the peer_cert environment
variable.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509&minus;username&minus;field
[ext:]fieldname</b></p>

<p style="margin-left:22%;">Field in the X.509 certificate
subject to be used as the username (default=CN). Typically,
this option is specified with <b>fieldname</b> as either of
the following:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;x509&minus;username&minus;field</b>
emailAddress <b><br>
&minus;&minus;x509&minus;username&minus;field
ext:</b>subjectAltName</p>

<p style="margin-left:22%; margin-top: 1em">The first
example uses the value of the &quot;emailAddress&quot;
attribute in the certificate&rsquo;s Subject field as the
username. The second example uses the <b>ext:</b> prefix to
signify that the X.509 extension <b>fieldname</b>
&quot;subjectAltName&quot; be searched for an rfc822Name
(email) field to be used as the username. In cases where
there are multiple email addresses in <b>ext:fieldname</b>,
the last occurrence is chosen.</p>

<p style="margin-left:22%; margin-top: 1em">When this
option is used, the
<b>&minus;&minus;verify&minus;x509&minus;name</b> option
will match against the chosen <b>fieldname</b> instead of
the Common Name.</p>

<p style="margin-left:22%; margin-top: 1em"><b>Please
note:</b> This option has a feature which will convert an
all-lowercase <b>fieldname</b> to uppercase characters,
e.g., ou -&gt; OU. A mixed-case <b>fieldname</b> or one
having the <b>ext:</b> prefix will be left as-is. This
automatic upcasing feature is deprecated and will be removed
in a future release.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;remote
name (DEPRECATED)</b></p>

<p style="margin-left:22%;">Accept connections only from a
host with X509 name or common name equal to <b>name.</b> The
remote host must also pass all other tests of
verification.</p>

<p style="margin-left:22%; margin-top: 1em"><b>NOTE:</b>
Because tls-remote may test against a common name prefix,
only use this option when you are using OpenVPN with a
custom CA certificate that is under your control. Never use
this option when your client certificates are signed by a
third party, such as a commercial web CA.</p>

<p style="margin-left:22%; margin-top: 1em">Name can also
be a common name prefix, for example if you want a client to
only accept connections to &quot;Server-1&quot;,
&quot;Server-2&quot;, etc., you can simply use
<b>&minus;&minus;tls&minus;remote Server</b></p>

<p style="margin-left:22%; margin-top: 1em">Using a common
name prefix is a useful alternative to managing a CRL
(Certificate Revocation List) on the client, since it allows
the client to refuse all certificates except for those
associated with designated servers.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;tls&minus;remote</b>
is a useful replacement for the
<b>&minus;&minus;tls&minus;verify</b> option to verify the
remote host, because <b>&minus;&minus;tls&minus;remote</b>
works in a <b>&minus;&minus;chroot</b> environment too.</p>

<p style="margin-left:22%; margin-top: 1em"><b>Please also
note:</b> This option is now deprecated. It will be removed
either in OpenVPN v2.4 or v2.5. So please make sure you
support the new X.509 name formatting described with the
<b>&minus;&minus;compat&minus;names</b> option as soon as
possible by updating your configurations to use
<b>&minus;&minus;verify&minus;x509&minus;name</b>
instead.</p>


<p style="margin-left:11%;"><b>&minus;&minus;verify&minus;x509&minus;name
name type</b></p>

<p style="margin-left:22%;">Accept connections only if a
host&rsquo;s X.509 name is equal to <b>name.</b> The remote
host must also pass all other tests of verification.</p>

<p style="margin-left:22%; margin-top: 1em">Which X.509
name is compared to <b>name</b> depends on the setting of
type. <b>type</b> can be &quot;subject&quot; to match the
complete subject DN (default), &quot;name&quot; to match a
subject RDN or &quot;name-prefix&quot; to match a subject
RDN prefix. Which RDN is verified as name depends on the
<b>&minus;&minus;x509&minus;username&minus;field</b> option.
But it defaults to the common name (CN), e.g. a certificate
with a subject DN &quot;C=KG, ST=NA, L=Bishkek,
CN=Server-1&quot; would be matched by:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;verify&minus;x509&minus;name
&rsquo;C=KG, ST=NA, L=Bishkek, CN=Server-1&rsquo;</b> and
<b>&minus;&minus;verify&minus;x509&minus;name Server-1
name</b> or you could use
<b>&minus;&minus;verify&minus;x509&minus;name Server-
name-prefix</b> if you want a client to only accept
connections to &quot;Server-1&quot;, &quot;Server-2&quot;,
etc.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;verify&minus;x509&minus;name</b>
is a useful replacement for the
<b>&minus;&minus;tls&minus;verify</b> option to verify the
remote host, because
<b>&minus;&minus;verify&minus;x509&minus;name</b> works in a
<b>&minus;&minus;chroot</b> environment without any
dependencies.</p>

<p style="margin-left:22%; margin-top: 1em">Using a name
prefix is a useful alternative to managing a CRL
(Certificate Revocation List) on the client, since it allows
the client to refuse all certificates except for those
associated with designated servers.</p>

<p style="margin-left:22%; margin-top: 1em"><b>NOTE:</b>
Test against a name prefix only when you are using OpenVPN
with a custom CA certificate that is under your control.
Never use this option with type &quot;name-prefix&quot; when
your client certificates are signed by a third party, such
as a commercial web CA.</p>


<p style="margin-left:11%;"><b>&minus;&minus;x509&minus;track
attribute</b></p>

<p style="margin-left:22%;">Save peer X509 <b>attribute</b>
value in environment for use by plugins and management
interface. Prepend a &rsquo;+&rsquo; to <b>attribute</b> to
save values from full cert chain. Values will be encoded as
X509_&lt;depth&gt;_&lt;attribute&gt;=&lt;value&gt;. Multiple
<b>&minus;&minus;x509&minus;track</b> options can be defined
to track multiple attributes. Not available with
PolarSSL.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ns&minus;cert&minus;type
client|server</b></p>

<p style="margin-left:22%;">Require that peer certificate
was signed with an explicit <b>nsCertType</b> designation of
&quot;client&quot; or &quot;server&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">This is a
useful security option for clients, to ensure that the host
they connect with is a designated server.</p>

<p style="margin-left:22%; margin-top: 1em">See the
easy-rsa/build-key-server script for an example of how to
generate a certificate with the <b>nsCertType</b> field set
to &quot;server&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">If the server
certificate&rsquo;s nsCertType field is set to
&quot;server&quot;, then the clients can verify this with
<b>&minus;&minus;ns&minus;cert&minus;type server.</b></p>

<p style="margin-left:22%; margin-top: 1em">This is an
important security precaution to protect against a
man-in-the-middle attack where an authorized client attempts
to connect to another client by impersonating the server.
The attack is easily prevented by having clients verify the
server certificate using any one of
<b>&minus;&minus;ns&minus;cert&minus;type,
&minus;&minus;verify&minus;x509&minus;name,</b> or
<b>&minus;&minus;tls&minus;verify.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;remote&minus;cert&minus;ku
v...</b></p>

<p style="margin-left:22%;">Require that peer certificate
was signed with an explicit <b>key usage.</b></p>

<p style="margin-left:22%; margin-top: 1em">This is a
useful security option for clients, to ensure that the host
they connect to is a designated server.</p>

<p style="margin-left:22%; margin-top: 1em">The key usage
should be encoded in hex, more than one key usage can be
specified.</p>


<p style="margin-left:11%;"><b>&minus;&minus;remote&minus;cert&minus;eku
oid</b></p>

<p style="margin-left:22%;">Require that peer certificate
was signed with an explicit <b>extended key usage.</b></p>

<p style="margin-left:22%; margin-top: 1em">This is a
useful security option for clients, to ensure that the host
they connect to is a designated server.</p>

<p style="margin-left:22%; margin-top: 1em">The extended
key usage should be encoded in oid notation, or OpenSSL
symbolic representation.</p>


<p style="margin-left:11%;"><b>&minus;&minus;remote&minus;cert&minus;tls
client|server</b></p>

<p style="margin-left:22%;">Require that peer certificate
was signed with an explicit <b>key usage</b> and <b>extended
key usage</b> based on RFC3280 TLS rules.</p>

<p style="margin-left:22%; margin-top: 1em">This is a
useful security option for clients, to ensure that the host
they connect to is a designated server.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>&minus;&minus;remote&minus;cert&minus;tls client</b>
option is equivalent to
<b>&minus;&minus;remote&minus;cert&minus;ku 80 08 88
&minus;&minus;remote&minus;cert&minus;eku &quot;TLS Web
Client Authentication&quot;</b></p>

<p style="margin-left:22%; margin-top: 1em">The key usage
is digitalSignature and/or keyAgreement.</p>

<p style="margin-left:22%; margin-top: 1em">The
<b>&minus;&minus;remote&minus;cert&minus;tls server</b>
option is equivalent to
<b>&minus;&minus;remote&minus;cert&minus;ku a0 88
&minus;&minus;remote&minus;cert&minus;eku &quot;TLS Web
Server Authentication&quot;</b></p>

<p style="margin-left:22%; margin-top: 1em">The key usage
is digitalSignature and ( keyEncipherment or keyAgreement
).</p>

<p style="margin-left:22%; margin-top: 1em">This is an
important security precaution to protect against a
man-in-the-middle attack where an authorized client attempts
to connect to another client by impersonating the server.
The attack is easily prevented by having clients verify the
server certificate using any one of
<b>&minus;&minus;remote&minus;cert&minus;tls,
&minus;&minus;verify&minus;x509&minus;name,</b> or
<b>&minus;&minus;tls&minus;verify.</b></p>


<p style="margin-left:11%;"><b>&minus;&minus;crl&minus;verify
crl [&rsquo;dir&rsquo;]</b></p>

<p style="margin-left:22%;">Check peer certificate against
the file <b>crl</b> in PEM format.</p>

<p style="margin-left:22%; margin-top: 1em">A CRL
(certificate revocation list) is used when a particular key
is compromised but when the overall PKI is still intact.</p>

<p style="margin-left:22%; margin-top: 1em">Suppose you had
a PKI consisting of a CA, root certificate, and a number of
client certificates. Suppose a laptop computer containing a
client key and certificate was stolen. By adding the stolen
certificate to the CRL file, you could reject any connection
which attempts to use it, while preserving the overall
integrity of the PKI.</p>

<p style="margin-left:22%; margin-top: 1em">The only time
when it would be necessary to rebuild the entire PKI from
scratch would be if the root certificate key itself was
compromised.</p>

<p style="margin-left:22%; margin-top: 1em">If the optional
<b>dir</b> flag is specified, enable a different mode where
<b>crl</b> is a directory containing files named as revoked
serial numbers (the files may be empty, the contents are
never read). If a client requests a connection, where the
client certificate serial number (decimal string) is the
name of a file present in the directory, it will be
rejected.</p>

<p style="margin-left:22%; margin-top: 1em">Note: As the
crl file (or directory) is read every time a peer connects,
if you are dropping root privileges with
<b>&minus;&minus;user,</b> make sure that this user has
sufficient privileges to read the file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>SSL Library
information: <br>
&minus;&minus;show&minus;ciphers</b></p>

<p style="margin-left:22%;">(Standalone) Show all cipher
algorithms to use with the <b>&minus;&minus;cipher</b>
option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;digests</b></p>

<p style="margin-left:22%;">(Standalone) Show all message
digest algorithms to use with the <b>&minus;&minus;auth</b>
option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;tls</b></p>

<p style="margin-left:22%;">(Standalone) Show all TLS
ciphers supported by the crypto library. OpenVPN uses TLS to
secure the control channel, over which the keys that are
used to protect the actual VPN traffic are exchanged. The
TLS ciphers will be sorted from highest preference (most
secure) to lowest.</p>

<p style="margin-left:22%; margin-top: 1em">Be aware that
whether a cipher suite in this list can actually work
depends on the specific setup of both peers (e.g. both peers
must support the cipher, and an ECDSA cipher suite will not
work if you are using an RSA certificate, etc.).</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;engines</b></p>

<p style="margin-left:22%;">(Standalone) Show currently
available hardware-based crypto acceleration engines
supported by the OpenSSL library.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Generate a
random key:</b> <br>
Used only for non-TLS static key encryption mode. <b><br>
&minus;&minus;genkey</b></p>

<p style="margin-left:22%;">(Standalone) Generate a random
key to be used as a shared secret, for use with the
<b>&minus;&minus;secret</b> option. This file must be shared
with the peer over a pre-existing secure channel such as
<b>scp</b>(1)</p>

<p style="margin-left:11%;"><b>&minus;&minus;secret
file</b></p>

<p style="margin-left:22%;">Write key to <b>file.</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>TUN/TAP
persistent tunnel config mode:</b> <br>
Available with linux 2.4.7+. These options comprise a
standalone mode of OpenVPN which can be used to create and
delete persistent tunnels. <b><br>
&minus;&minus;mktun</b></p>

<p style="margin-left:22%;">(Standalone) Create a
persistent tunnel on platforms which support them such as
Linux. Normally TUN/TAP tunnels exist only for the period of
time that an application has them open. This option takes
advantage of the TUN/TAP driver&rsquo;s ability to build
persistent tunnels that live through multiple instantiations
of OpenVPN and die only when they are deleted or the machine
is rebooted.</p>

<p style="margin-left:22%; margin-top: 1em">One of the
advantages of persistent tunnels is that they eliminate the
need for separate <b>&minus;&minus;up</b> and
<b>&minus;&minus;down</b> scripts to run the appropriate
<b>ifconfig</b>(8) and <b>route</b>(8) commands. These
commands can be placed in the the same shell script which
starts or terminates an OpenVPN session.</p>

<p style="margin-left:22%; margin-top: 1em">Another
advantage is that open connections through the TUN/TAP-based
tunnel will not be reset if the OpenVPN peer restarts. This
can be useful to provide uninterrupted connectivity through
the tunnel in the event of a DHCP reset of the peer&rsquo;s
public IP address (see the <b>&minus;&minus;ipchange</b>
option above).</p>

<p style="margin-left:22%; margin-top: 1em">One
disadvantage of persistent tunnels is that it is harder to
automatically configure their MTU value (see
<b>&minus;&minus;link&minus;mtu</b> and
<b>&minus;&minus;tun&minus;mtu</b> above).</p>

<p style="margin-left:22%; margin-top: 1em">On some
platforms such as Windows, TAP-Win32 tunnels are persistent
by default.</p>

<p style="margin-left:11%;"><b>&minus;&minus;rmtun</b></p>

<p style="margin-left:22%;">(Standalone) Remove a
persistent tunnel.</p>

<p style="margin-left:11%;"><b>&minus;&minus;dev tunX |
tapX</b></p>

<p style="margin-left:22%;">TUN/TAP device</p>

<p style="margin-left:11%;"><b>&minus;&minus;user
user</b></p>

<p style="margin-left:22%;">Optional user to be owner of
this tunnel.</p>

<p style="margin-left:11%;"><b>&minus;&minus;group
group</b></p>

<p style="margin-left:22%;">Optional group to be owner of
this tunnel.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Windows-Specific
Options: <br>
&minus;&minus;win&minus;sys path</b></p>

<p style="margin-left:22%;">Set the Windows system
directory pathname to use when looking for system
executables such as <b>route.exe</b> and <b>netsh.exe.</b>
By default, if this directive is not specified, OpenVPN will
use the SystemRoot environment variable.</p>

<p style="margin-left:22%; margin-top: 1em">This option
have changed behaviour in OpenVPN 2.3. Earlier you had to
define <b>&minus;&minus;win&minus;sys env</b> to use the
SystemRoot environment variable, otherwise it defaulted to
C:\WINDOWS. It is not needed to use the <b>env</b> keyword
any more, and it will just be ignored. A warning is logged
when this is found in the configuration file.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ip&minus;win32
method</b></p>

<p style="margin-left:22%;">When using
<b>&minus;&minus;ifconfig</b> on Windows, set the TAP-Win32
adapter IP address and netmask using <b>method.</b>
Don&rsquo;t use this option unless you are also using
<b>&minus;&minus;ifconfig.</b></p>

<p style="margin-left:22%; margin-top: 1em"><b>manual
--</b> Don&rsquo;t set the IP address or netmask
automatically. Instead output a message to the console
telling the user to configure the adapter manually and
indicating the IP/netmask which OpenVPN expects the adapter
to be set to.</p>

<p style="margin-left:22%; margin-top: 1em"><b>dynamic
[offset] [lease-time] --</b> Automatically set the IP
address and netmask by replying to DHCP query messages
generated by the kernel. This mode is probably the
&quot;cleanest&quot; solution for setting the TCP/IP
properties since it uses the well-known DHCP protocol. There
are, however, two prerequisites for using this mode: (1) The
TCP/IP properties for the TAP-Win32 adapter must be set to
&quot;Obtain an IP address automatically,&quot; and (2)
OpenVPN needs to claim an IP address in the subnet for use
as the virtual DHCP server address. By default in
<b>&minus;&minus;dev tap</b> mode, OpenVPN will take the
normally unused first address in the subnet. For example, if
your subnet is 192.168.4.0 netmask 255.255.255.0, then
OpenVPN will take the IP address 192.168.4.0 to use as the
virtual DHCP server address. In <b>&minus;&minus;dev tun</b>
mode, OpenVPN will cause the DHCP server to masquerade as if
it were coming from the remote endpoint. The optional offset
parameter is an integer which is &gt; -256 and &lt; 256 and
which defaults to 0. If offset is positive, the DHCP server
will masquerade as the IP address at network address +
offset. If offset is negative, the DHCP server will
masquerade as the IP address at broadcast address + offset.
The Windows <b>ipconfig /all</b> command can be used to show
what Windows thinks the DHCP server address is. OpenVPN will
&quot;claim&quot; this address, so make sure to use a free
address. Having said that, different OpenVPN instantiations,
including different ends of the same connection, can share
the same virtual DHCP server address. The <b>lease-time</b>
parameter controls the lease time of the DHCP assignment
given to the TAP-Win32 adapter, and is denoted in seconds.
Normally a very long lease time is preferred because it
prevents routes involving the TAP-Win32 adapter from being
lost when the system goes to sleep. The default lease time
is one year.</p>

<p style="margin-left:22%; margin-top: 1em"><b>netsh --</b>
Automatically set the IP address and netmask using the
Windows command-line &quot;netsh&quot; command. This method
appears to work correctly on Windows XP but not Windows
2000.</p>

<p style="margin-left:22%; margin-top: 1em"><b>ipapi --</b>
Automatically set the IP address and netmask using the
Windows IP Helper API. This approach does not have ideal
semantics, though testing has indicated that it works okay
in practice. If you use this option, it is best to leave the
TCP/IP properties for the TAP-Win32 adapter in their default
state, i.e. &quot;Obtain an IP address
automatically.&quot;</p>

<p style="margin-left:22%; margin-top: 1em"><b>adaptive
--</b> (Default) Try <b>dynamic</b> method initially and
fail over to <b>netsh</b> if the DHCP negotiation with the
TAP-Win32 adapter does not succeed in 20 seconds. Such
failures have been known to occur when certain third-party
firewall packages installed on the client machine block the
DHCP negotiation used by the TAP-Win32 adapter. Note that if
the <b>netsh</b> failover occurs, the TAP-Win32 adapter
TCP/IP properties will be reset from DHCP to static, and
this will cause future OpenVPN startups using the
<b>adaptive</b> mode to use <b>netsh</b> immediately, rather
than trying <b>dynamic</b> first. To &quot;unstick&quot; the
<b>adaptive</b> mode from using <b>netsh,</b> run OpenVPN at
least once using the <b>dynamic</b> mode to restore the
TAP-Win32 adapter TCP/IP properties to a DHCP
configuration.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;method
m</b></p>

<p style="margin-left:22%;">Which method <b>m</b> to use
for adding routes on Windows?</p>


<p style="margin-left:22%; margin-top: 1em"><b>adaptive</b>
(default) -- Try IP helper API first. If that fails, fall
back to the route.exe shell command. <b><br>
ipapi</b> -- Use IP helper API. <b><br>
exe</b> -- Call the route.exe shell command.</p>


<p style="margin-left:11%;"><b>&minus;&minus;dhcp&minus;option
type [parm]</b></p>

<p style="margin-left:22%;">Set extended TAP-Win32 TCP/IP
properties, must be used with
<b>&minus;&minus;ip&minus;win32 dynamic</b> or
<b>&minus;&minus;ip&minus;win32 adaptive.</b> This option
can be used to set additional TCP/IP properties on the
TAP-Win32 adapter, and is particularly useful for
configuring an OpenVPN client to access a Samba server
across the VPN.</p>

<p style="margin-left:22%; margin-top: 1em"><b>DOMAIN name
--</b> Set Connection-specific DNS Suffix.</p>

<p style="margin-left:22%; margin-top: 1em"><b>DNS addr
--</b> Set primary domain name server address. Repeat this
option to set secondary DNS server addresses.</p>

<p style="margin-left:22%; margin-top: 1em"><b>WINS addr
--</b> Set primary WINS server address (NetBIOS over TCP/IP
Name Server). Repeat this option to set secondary WINS
server addresses.</p>

<p style="margin-left:22%; margin-top: 1em"><b>NBDD addr
--</b> Set primary NBDD server address (NetBIOS over TCP/IP
Datagram Distribution Server) Repeat this option to set
secondary NBDD server addresses.</p>

<p style="margin-left:22%; margin-top: 1em"><b>NTP addr
--</b> Set primary NTP server address (Network Time
Protocol). Repeat this option to set secondary NTP server
addresses.</p>

<p style="margin-left:22%; margin-top: 1em"><b>NBT type
--</b> Set NetBIOS over TCP/IP Node type. Possible options:
<b>1</b> = b-node (broadcasts), <b>2</b> = p-node
(point-to-point name queries to a WINS server), <b>4</b> =
m-node (broadcast then query name server), and <b>8</b> =
h-node (query name server, then broadcast).</p>

<p style="margin-left:22%; margin-top: 1em"><b>NBS scope-id
--</b> Set NetBIOS over TCP/IP Scope. A NetBIOS Scope ID
provides an extended naming service for the NetBIOS over
TCP/IP (Known as NBT) module. The primary purpose of a
NetBIOS scope ID is to isolate NetBIOS traffic on a single
network to only those nodes with the same NetBIOS scope ID.
The NetBIOS scope ID is a character string that is appended
to the NetBIOS name. The NetBIOS scope ID on two hosts must
match, or the two hosts will not be able to communicate. The
NetBIOS Scope ID also allows computers to use the same
computer name, as they have different scope IDs. The Scope
ID becomes a part of the NetBIOS name, making the name
unique. (This description of NetBIOS scopes courtesy of
NeonSurge@abyss.com)</p>

<p style="margin-left:22%; margin-top: 1em"><b>DISABLE-NBT
--</b> Disable Netbios-over-TCP/IP.</p>

<p style="margin-left:22%; margin-top: 1em">Note that if
<b>&minus;&minus;dhcp&minus;option</b> is pushed via
<b>&minus;&minus;push</b> to a non-windows client, the
option will be saved in the client&rsquo;s environment
before the up script is called, under the name
&quot;foreign_option_{n}&quot;.</p>


<p style="margin-left:11%;"><b>&minus;&minus;tap&minus;sleep
n</b></p>

<p style="margin-left:22%;">Cause OpenVPN to sleep for
<b>n</b> seconds immediately after the TAP-Win32 adapter
state is set to &quot;connected&quot;.</p>

<p style="margin-left:22%; margin-top: 1em">This option is
intended to be used to troubleshoot problems with the
<b>&minus;&minus;ifconfig</b> and
<b>&minus;&minus;ip&minus;win32</b> options, and is used to
give the TAP-Win32 adapter time to come up before Windows IP
Helper API operations are applied to it.</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;net&minus;up</b></p>

<p style="margin-left:22%;">Output OpenVPN&rsquo;s view of
the system routing table and network adapter list to the
syslog or log file after the TUN/TAP adapter has been
brought up and any routes have been added.</p>


<p style="margin-left:11%;"><b>&minus;&minus;dhcp&minus;renew</b></p>

<p style="margin-left:22%;">Ask Windows to renew the TAP
adapter lease on startup. This option is normally
unnecessary, as Windows automatically triggers a DHCP
renegotiation on the TAP adapter when it comes up, however
if you set the TAP-Win32 adapter Media Status property to
&quot;Always Connected&quot;, you may need this flag.</p>


<p style="margin-left:11%;"><b>&minus;&minus;dhcp&minus;release</b></p>

<p style="margin-left:22%;">Ask Windows to release the TAP
adapter lease on shutdown. This option has the same caveats
as <b>&minus;&minus;dhcp&minus;renew</b> above.</p>


<p style="margin-left:11%;"><b>&minus;&minus;register&minus;dns</b></p>

<p style="margin-left:22%;">Run net stop dnscache, net
start dnscache, ipconfig /flushdns and ipconfig /registerdns
on connection initiation. This is known to kick Windows into
recognizing pushed DNS servers.</p>


<p style="margin-left:11%;"><b>&minus;&minus;pause&minus;exit</b></p>

<p style="margin-left:22%;">Put up a &quot;press any key to
continue&quot; message on the console prior to OpenVPN
program exit. This option is automatically used by the
Windows explorer when OpenVPN is run on a configuration file
using the right-click explorer menu.</p>

<p style="margin-left:11%;"><b>&minus;&minus;service
exit&minus;event [0|1]</b></p>

<p style="margin-left:22%;">Should be used when OpenVPN is
being automatically executed by another program in such a
context that no interaction with the user via display or
keyboard is possible. In general, end-users should never
need to explicitly use this option, as it is automatically
added by the OpenVPN service wrapper when a given OpenVPN
configuration is being run as a service.</p>


<p style="margin-left:22%; margin-top: 1em"><b>exit-event</b>
is the name of a Windows global event object, and OpenVPN
will continuously monitor the state of this event object and
exit when it becomes signaled.</p>

<p style="margin-left:22%; margin-top: 1em">The second
parameter indicates the initial state of <b>exit-event</b>
and normally defaults to 0.</p>

<p style="margin-left:22%; margin-top: 1em">Multiple
OpenVPN processes can be simultaneously executed with the
same <b>exit-event</b> parameter. In any case, the
controlling process can signal <b>exit-event,</b> causing
all such OpenVPN processes to exit.</p>

<p style="margin-left:22%; margin-top: 1em">When executing
an OpenVPN process using the <b>&minus;&minus;service</b>
directive, OpenVPN will probably not have a console window
to output status/error messages, therefore it is useful to
use <b>&minus;&minus;log</b> or
<b>&minus;&minus;log&minus;append</b> to write these
messages to a file.</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;adapters</b></p>

<p style="margin-left:22%;">(Standalone) Show available
TAP-Win32 adapters which can be selected using the
<b>&minus;&minus;dev&minus;node</b> option. On non-Windows
systems, the <b>ifconfig</b>(8) command provides similar
functionality.</p>


<p style="margin-left:11%;"><b>&minus;&minus;allow&minus;nonadmin
[TAP-adapter]</b></p>

<p style="margin-left:22%;">(Standalone) Set
<b>TAP-adapter</b> to allow access from non-administrative
accounts. If <b>TAP-adapter</b> is omitted, all TAP adapters
on the system will be configured to allow non-admin access.
The non-admin access setting will only persist for the
length of time that the TAP-Win32 device object and driver
remain loaded, and will need to be re-enabled after a
reboot, or if the driver is unloaded and reloaded. This
directive can only be used by an administrator.</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;valid&minus;subnets</b></p>

<p style="margin-left:22%;">(Standalone) Show valid subnets
for <b>&minus;&minus;dev tun</b> emulation. Since the
TAP-Win32 driver exports an ethernet interface to Windows,
and since TUN devices are point-to-point in nature, it is
necessary for the TAP-Win32 driver to impose certain
constraints on TUN endpoint address selection.</p>

<p style="margin-left:22%; margin-top: 1em">Namely, the
point-to-point endpoints used in TUN device emulation must
be the middle two addresses of a /30 subnet (netmask
255.255.255.252).</p>


<p style="margin-left:11%;"><b>&minus;&minus;show&minus;net</b></p>

<p style="margin-left:22%;">(Standalone) Show
OpenVPN&rsquo;s view of the system routing table and network
adapter list.</p>

<p style="margin-left:11%; margin-top: 1em"><b>PKCS#11
Standalone Options: <br>
&minus;&minus;show&minus;pkcs11&minus;ids [provider]
[cert_private]</b></p>

<p style="margin-left:22%;">(Standalone) Show PKCS#11 token
object list. Specify cert_private as 1 if certificates are
stored as private objects.</p>

<p style="margin-left:22%; margin-top: 1em">If p11-kit is
present on the system, the <b>provider</b> argument is
optional; if omitted the default <b>p11-kit-proxy.so</b>
module will be queried.</p>


<p style="margin-left:22%; margin-top: 1em"><b>&minus;&minus;verb</b>
option can be used BEFORE this option to produce debugging
information.</p>

<p style="margin-left:11%; margin-top: 1em"><b>IPv6 Related
Options</b> <br>
The following options exist to support IPv6 tunneling in
peer-to-peer and client-server mode. All options are modeled
after their IPv4 counterparts, so more detailed explanations
given there apply here as well (except for
<b>&minus;&minus;topology</b> , which has no effect on
IPv6). <b><br>
&minus;&minus;ifconfig&minus;ipv6 ipv6addr/bits
ipv6remote</b></p>

<p style="margin-left:22%;">configure IPv6 address
<b>ipv6addr/bits</b> on the &lsquo;&lsquo;tun&rsquo;&rsquo;
device. The second parameter is used as route target for
<b>&minus;&minus;route&minus;ipv6</b> if no gateway is
specified.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;ipv6
ipv6addr/bits [gateway] [metric]</b></p>

<p style="margin-left:22%;">setup IPv6 routing in the
system to send the specified IPv6 network into
OpenVPN&rsquo;s &lsquo;&lsquo;tun&rsquo;&rsquo; device</p>


<p style="margin-left:11%;"><b>&minus;&minus;server&minus;ipv6
ipv6addr/bits</b></p>

<p style="margin-left:22%;">convenience-function to enable
a number of IPv6 related options at once, namely
<b>&minus;&minus;ifconfig&minus;ipv6,
&minus;&minus;ifconfig&minus;ipv6&minus;pool,
&minus;&minus;tun&minus;ipv6</b> and <b>&minus;&minus;push
tun&minus;ipv6</b> Is only accepted if
&lsquo;&lsquo;&minus;&minus;mode server&rsquo;&rsquo; or
&lsquo;&lsquo;&minus;&minus;server&rsquo;&rsquo; is set.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;ipv6&minus;pool
ipv6addr/bits</b></p>

<p style="margin-left:22%;">Specify an IPv6 address pool
for dynamic assignment to clients. The pool starts at
<b>ipv6addr</b> and increments by +1 for every new client
(linear mode). The <b>/bits</b> setting controls the size of
the pool. Due to implementation details, the pool size must
be between /64 and /112.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ifconfig&minus;ipv6&minus;push
ipv6addr/bits ipv6remote</b></p>

<p style="margin-left:22%;">for ccd/ per-client static IPv6
interface configuration, see
<b>&minus;&minus;client&minus;config&minus;dir</b> and
<b>&minus;&minus;ifconfig&minus;push</b> for more
details.</p>


<p style="margin-left:11%;"><b>&minus;&minus;iroute&minus;ipv6
ipv6addr/bits</b></p>

<p style="margin-left:22%;">for ccd/ per-client static IPv6
route configuration, see <b>&minus;&minus;iroute</b> for
more details how to setup and use this, and how
<b>&minus;&minus;iroute</b> and <b>&minus;&minus;route</b>
interact.</p>

<h2>SCRIPTING AND ENVIRONMENTAL VARIABLES
<a name="SCRIPTING AND ENVIRONMENTAL VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">OpenVPN exports
a series of environmental variables for use by user-defined
scripts.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Script Order
of Execution</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><b>&minus;&minus;up</b></p></td>
<td width="5%"></td>
<td width="78%">


<p>Executed after TCP/UDP socket bind and TUN/TAP open.</p></td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;tls&minus;verify</b></p>

<p style="margin-left:22%;">Executed when we have a still
untrusted remote peer.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ipchange</b></p>

<p style="margin-left:22%;">Executed after connection
authentication, or remote IP address change.</p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;connect</b></p>

<p style="margin-left:22%;">Executed in
<b>&minus;&minus;mode server</b> mode immediately after
client authentication.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;up</b></p>

<p style="margin-left:22%;">Executed after connection
authentication, either immediately after, or some number of
seconds after as defined by the
<b>&minus;&minus;route&minus;delay</b> option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;route&minus;pre&minus;down</b></p>

<p style="margin-left:22%;">Executed right before the
routes are removed.</p>


<p style="margin-left:11%;"><b>&minus;&minus;client&minus;disconnect</b></p>

<p style="margin-left:22%;">Executed in
<b>&minus;&minus;mode server</b> mode on client instance
shutdown.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>&minus;&minus;down</b></p></td>
<td width="2%"></td>
<td width="63%">


<p>Executed after TCP/UDP and TUN/TAP close.</p></td>
<td width="15%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>&minus;&minus;learn&minus;address</b></p>

<p style="margin-left:22%;">Executed in
<b>&minus;&minus;mode server</b> mode whenever an IPv4
address/route or MAC address is added to OpenVPN&rsquo;s
internal routing table.</p>


<p style="margin-left:11%;"><b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b></p>

<p style="margin-left:22%;">Executed in
<b>&minus;&minus;mode server</b> mode on new client
connections, when the client is still untrusted.</p>

<p style="margin-left:11%; margin-top: 1em"><b>String Types
and Remapping</b> <br>
In certain cases, OpenVPN will perform remapping of
characters in strings. Essentially, any characters outside
the set of permitted characters for each string type will be
converted to underbar (&rsquo;_&rsquo;).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> Why
is string remapping necessary?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b>
It&rsquo;s an important security feature to prevent the
malicious coding of strings from untrusted sources to be
passed as parameters to scripts, saved in the environment,
used as a common name, translated to a filename, etc.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Q:</b> Can
string remapping be disabled?</p>

<p style="margin-left:11%; margin-top: 1em"><b>A:</b> Yes,
by using the
<b>&minus;&minus;no&minus;name&minus;remapping</b> option,
however this should be considered an advanced option.</p>

<p style="margin-left:11%; margin-top: 1em">Here is a brief
rundown of OpenVPN&rsquo;s current string types and the
permitted character class for each string:</p>

<p style="margin-left:11%; margin-top: 1em"><b>X509
Names:</b> Alphanumeric, underbar (&rsquo;_&rsquo;), dash
(&rsquo;-&rsquo;), dot (&rsquo;.&rsquo;), at
(&rsquo;@&rsquo;), colon (&rsquo;:&rsquo;), slash
(&rsquo;/&rsquo;), and equal (&rsquo;=&rsquo;). Alphanumeric
is defined as a character which will cause the C library
isalnum() function to return true.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Common
Names:</b> Alphanumeric, underbar (&rsquo;_&rsquo;), dash
(&rsquo;-&rsquo;), dot (&rsquo;.&rsquo;), and at
(&rsquo;@&rsquo;).</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;auth&minus;user&minus;pass
username:</b> Same as Common Name, with one exception:
starting with OpenVPN 2.0.1, the username is passed to the
OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY plugin in its raw form,
without string remapping.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;auth&minus;user&minus;pass
password:</b> Any &quot;printable&quot; character except CR
or LF. Printable is defined to be a character which will
cause the C library isprint() function to return true.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;&minus;client&minus;config&minus;dir
filename as derived from common name or username:</b>
Alphanumeric, underbar (&rsquo;_&rsquo;), dash
(&rsquo;-&rsquo;), and dot (&rsquo;.&rsquo;) except for
&quot;.&quot; or &quot;..&quot; as standalone strings. As of
2.0.1-rc6, the at (&rsquo;@&rsquo;) character has been added
as well for compatibility with the common name character
class.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Environmental
variable names:</b> Alphanumeric or underbar
(&rsquo;_&rsquo;).</p>


<p style="margin-left:11%; margin-top: 1em"><b>Environmental
variable values:</b> Any printable character.</p>

<p style="margin-left:11%; margin-top: 1em">For all cases,
characters in a string which are not members of the legal
character class for that string type will be remapped to
underbar (&rsquo;_&rsquo;).</p>


<p style="margin-left:11%; margin-top: 1em"><b>Environmental
Variables</b> <br>
Once set, a variable is persisted indefinitely until it is
reset by a new value or a restart,</p>

<p style="margin-left:11%; margin-top: 1em">As of OpenVPN
2.0-beta12, in server mode, environmental variables set by
OpenVPN are scoped according to the client objects they are
associated with, so there should not be any issues with
scripts having access to stale, previously set variables
which refer to different client instances. <b><br>
bytes_received</b></p>

<p style="margin-left:22%;">Total number of bytes received
from client during VPN session. Set prior to execution of
the <b>&minus;&minus;client&minus;disconnect</b> script.</p>

<p style="margin-left:11%;"><b>bytes_sent</b></p>

<p style="margin-left:22%;">Total number of bytes sent to
client during VPN session. Set prior to execution of the
<b>&minus;&minus;client&minus;disconnect</b> script.</p>

<p style="margin-left:11%;"><b>common_name</b></p>

<p style="margin-left:22%;">The X509 common name of an
authenticated client. Set prior to execution of
<b>&minus;&minus;client&minus;connect,
&minus;&minus;client&minus;disconnect,</b> and
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
scripts.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>config</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Name of first <b>&minus;&minus;config</b> file. Set on
program initiation and reset on SIGHUP.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>daemon</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Set to &quot;1&quot; if the <b>&minus;&minus;daemon</b>
directive is specified, or &quot;0&quot; otherwise. Set on
program initiation and reset on SIGHUP.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>daemon_log_redirect</b></p>

<p style="margin-left:22%;">Set to &quot;1&quot; if the
<b>&minus;&minus;log</b> or
<b>&minus;&minus;log&minus;append</b> directives are
specified, or &quot;0&quot; otherwise. Set on program
initiation and reset on SIGHUP.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>dev</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>The actual name of the TUN/TAP device, including a unit
number if it exists. Set prior to <b>&minus;&minus;up</b> or
<b>&minus;&minus;down</b> script execution.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>foreign_option_{n}</b></p>

<p style="margin-left:22%;">An option pushed via
<b>&minus;&minus;push</b> to a client which does not
natively support it, such as
<b>&minus;&minus;dhcp&minus;option</b> on a non-Windows
system, will be recorded to this environmental variable
sequence prior to <b>&minus;&minus;up</b> script
execution.</p>

<p style="margin-left:11%;"><b>ifconfig_broadcast</b></p>

<p style="margin-left:22%;">The broadcast address for the
virtual ethernet segment which is derived from the
<b>&minus;&minus;ifconfig</b> option when
<b>&minus;&minus;dev tap</b> is used. Set prior to OpenVPN
calling the <i>ifconfig</i> or <i>netsh</i> (windows version
of ifconfig) commands which normally occurs prior to
<b>&minus;&minus;up</b> script execution.</p>

<p style="margin-left:11%;"><b>ifconfig_ipv6_local</b></p>

<p style="margin-left:22%;">The local VPN endpoint IPv6
address specified in the
<b>&minus;&minus;ifconfig&minus;ipv6</b> option (first
parameter). Set prior to OpenVPN calling the <i>ifconfig</i>
or <i>netsh</i> (windows version of ifconfig) commands which
normally occurs prior to <b>&minus;&minus;up</b> script
execution.</p>


<p style="margin-left:11%;"><b>ifconfig_ipv6_netbits</b></p>

<p style="margin-left:22%;">The prefix length of the IPv6
network on the VPN interface. Derived from the /nnn
parameter of the IPv6 address in the
<b>&minus;&minus;ifconfig&minus;ipv6</b> option (first
parameter). Set prior to OpenVPN calling the <i>ifconfig</i>
or <i>netsh</i> (windows version of ifconfig) commands which
normally occurs prior to <b>&minus;&minus;up</b> script
execution.</p>


<p style="margin-left:11%;"><b>ifconfig_ipv6_remote</b></p>

<p style="margin-left:22%;">The remote VPN endpoint IPv6
address specified in the
<b>&minus;&minus;ifconfig&minus;ipv6</b> option (second
parameter). Set prior to OpenVPN calling the <i>ifconfig</i>
or <i>netsh</i> (windows version of ifconfig) commands which
normally occurs prior to <b>&minus;&minus;up</b> script
execution.</p>

<p style="margin-left:11%;"><b>ifconfig_local</b></p>

<p style="margin-left:22%;">The local VPN endpoint IP
address specified in the <b>&minus;&minus;ifconfig</b>
option (first parameter). Set prior to OpenVPN calling the
<i>ifconfig</i> or <i>netsh</i> (windows version of
ifconfig) commands which normally occurs prior to
<b>&minus;&minus;up</b> script execution.</p>

<p style="margin-left:11%;"><b>ifconfig_remote</b></p>

<p style="margin-left:22%;">The remote VPN endpoint IP
address specified in the <b>&minus;&minus;ifconfig</b>
option (second parameter) when <b>&minus;&minus;dev tun</b>
is used. Set prior to OpenVPN calling the <i>ifconfig</i> or
<i>netsh</i> (windows version of ifconfig) commands which
normally occurs prior to <b>&minus;&minus;up</b> script
execution.</p>

<p style="margin-left:11%;"><b>ifconfig_netmask</b></p>

<p style="margin-left:22%;">The subnet mask of the virtual
ethernet segment that is specified as the second parameter
to <b>&minus;&minus;ifconfig</b> when <b>&minus;&minus;dev
tap</b> is being used. Set prior to OpenVPN calling the
<i>ifconfig</i> or <i>netsh</i> (windows version of
ifconfig) commands which normally occurs prior to
<b>&minus;&minus;up</b> script execution.</p>


<p style="margin-left:11%;"><b>ifconfig_pool_local_ip</b></p>

<p style="margin-left:22%;">The local virtual IP address
for the TUN/TAP tunnel taken from an
<b>&minus;&minus;ifconfig&minus;push</b> directive if
specified, or otherwise from the ifconfig pool (controlled
by the <b>&minus;&minus;ifconfig&minus;pool</b> config file
directive). Only set for <b>&minus;&minus;dev tun</b>
tunnels. This option is set on the server prior to execution
of the <b>&minus;&minus;client&minus;connect</b> and
<b>&minus;&minus;client&minus;disconnect</b> scripts.</p>


<p style="margin-left:11%;"><b>ifconfig_pool_netmask</b></p>

<p style="margin-left:22%;">The virtual IP netmask for the
TUN/TAP tunnel taken from an
<b>&minus;&minus;ifconfig&minus;push</b> directive if
specified, or otherwise from the ifconfig pool (controlled
by the <b>&minus;&minus;ifconfig&minus;pool</b> config file
directive). Only set for <b>&minus;&minus;dev tap</b>
tunnels. This option is set on the server prior to execution
of the <b>&minus;&minus;client&minus;connect</b> and
<b>&minus;&minus;client&minus;disconnect</b> scripts.</p>


<p style="margin-left:11%;"><b>ifconfig_pool_remote_ip</b></p>

<p style="margin-left:22%;">The remote virtual IP address
for the TUN/TAP tunnel taken from an
<b>&minus;&minus;ifconfig&minus;push</b> directive if
specified, or otherwise from the ifconfig pool (controlled
by the <b>&minus;&minus;ifconfig&minus;pool</b> config file
directive). This option is set on the server prior to
execution of the <b>&minus;&minus;client&minus;connect</b>
and <b>&minus;&minus;client&minus;disconnect</b>
scripts.</p>

<p style="margin-left:11%;"><b>link_mtu</b></p>

<p style="margin-left:22%;">The maximum packet size (not
including the IP header) of tunnel data in UDP tunnel
transport mode. Set prior to <b>&minus;&minus;up</b> or
<b>&minus;&minus;down</b> script execution.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>local</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>The <b>&minus;&minus;local</b> parameter. Set on program
initiation and reset on SIGHUP.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>local_port</b></p>

<p style="margin-left:22%;">The local port number,
specified by <b>&minus;&minus;port</b> or
<b>&minus;&minus;lport.</b> Set on program initiation and
reset on SIGHUP.</p>

<p style="margin-left:11%;"><b>password</b></p>

<p style="margin-left:22%;">The password provided by a
connecting client. Set prior to
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
script execution only when the <b>via-env</b> modifier is
specified, and deleted from the environment after the script
returns.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>proto</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>The <b>&minus;&minus;proto</b> parameter. Set on program
initiation and reset on SIGHUP.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>remote_{n}</b></p>

<p style="margin-left:22%;">The <b>&minus;&minus;remote</b>
parameter. Set on program initiation and reset on
SIGHUP.</p>

<p style="margin-left:11%;"><b>remote_port_{n}</b></p>

<p style="margin-left:22%;">The remote port number,
specified by <b>&minus;&minus;port</b> or
<b>&minus;&minus;rport.</b> Set on program initiation and
reset on SIGHUP.</p>

<p style="margin-left:11%;"><b>route_net_gateway</b></p>

<p style="margin-left:22%;">The pre-existing default IP
gateway in the system routing table. Set prior to
<b>&minus;&minus;up</b> script execution.</p>

<p style="margin-left:11%;"><b>route_vpn_gateway</b></p>

<p style="margin-left:22%;">The default gateway used by
<b>&minus;&minus;route</b> options, as specified in either
the <b>&minus;&minus;route&minus;gateway</b> option or the
second parameter to <b>&minus;&minus;ifconfig</b> when
<b>&minus;&minus;dev tun</b> is specified. Set prior to
<b>&minus;&minus;up</b> script execution.</p>

<p style="margin-left:11%;"><b>route_{parm}_{n}</b></p>

<p style="margin-left:22%;">A set of variables which define
each route to be added, and are set prior to
<b>&minus;&minus;up</b> script execution.</p>

<p style="margin-left:22%; margin-top: 1em"><b>parm</b>
will be one of &quot;network&quot;, &quot;netmask&quot;,
&quot;gateway&quot;, or &quot;metric&quot;.</p>

<p style="margin-left:22%; margin-top: 1em"><b>n</b> is the
OpenVPN route number, starting from 1.</p>

<p style="margin-left:22%; margin-top: 1em">If the network
or gateway are resolvable DNS names, their IP address
translations will be recorded rather than their names as
denoted on the command line or configuration file.</p>


<p style="margin-left:11%;"><b>route_ipv6_{parm}_{n}</b></p>

<p style="margin-left:22%;">A set of variables which define
each IPv6 route to be added, and are set prior to
<b>&minus;&minus;up</b> script execution.</p>

<p style="margin-left:22%; margin-top: 1em"><b>parm</b>
will be one of &quot;network&quot; or &quot;gateway&quot;
(&quot;netmask&quot; is contained as &quot;/nnn&quot; in the
route_ipv6_network_{n}, unlike IPv4 where it is passed in a
separate environment variable).</p>

<p style="margin-left:22%; margin-top: 1em"><b>n</b> is the
OpenVPN route number, starting from 1.</p>

<p style="margin-left:22%; margin-top: 1em">If the network
or gateway are resolvable DNS names, their IP address
translations will be recorded rather than their names as
denoted on the command line or configuration file.</p>

<p style="margin-left:11%;"><b>peer_cert</b></p>

<p style="margin-left:22%;">Temporary file name containing
the client certificate upon connection. Useful in
conjunction with &minus;&minus;tls&minus;verify</p>

<p style="margin-left:11%;"><b>script_context</b></p>

<p style="margin-left:22%;">Set to &quot;init&quot; or
&quot;restart&quot; prior to up/down script execution. For
more information, see documentation for
<b>&minus;&minus;up.</b></p>

<p style="margin-left:11%;"><b>script_type</b></p>

<p style="margin-left:22%;">Prior to execution of any
script, this variable is set to the type of script being
run. It can be one of the following: <b>up, down, ipchange,
route-up, tls-verify, auth-user-pass-verify, client-connect,
client-disconnect,</b> or <b>learn-address.</b> Set prior to
execution of any script.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>signal</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The reason for exit or restart. Can be one of
<b>sigusr1, sighup, sigterm, sigint, inactive</b>
(controlled by <b>&minus;&minus;inactive</b> option),
<b>ping-exit</b> (controlled by
<b>&minus;&minus;ping&minus;exit</b> option),
<b>ping-restart</b> (controlled by
<b>&minus;&minus;ping&minus;restart</b> option),
<b>connection-reset</b> (triggered on TCP connection reset),
<b>error,</b> or <b>unknown</b> (unknown signal). This
variable is set just prior to down script execution.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>time_ascii</b></p>

<p style="margin-left:22%;">Client connection timestamp,
formatted as a human-readable time string. Set prior to
execution of the <b>&minus;&minus;client&minus;connect</b>
script.</p>

<p style="margin-left:11%;"><b>time_duration</b></p>

<p style="margin-left:22%;">The duration (in seconds) of
the client session which is now disconnecting. Set prior to
execution of the
<b>&minus;&minus;client&minus;disconnect</b> script.</p>

<p style="margin-left:11%;"><b>time_unix</b></p>

<p style="margin-left:22%;">Client connection timestamp,
formatted as a unix integer date/time value. Set prior to
execution of the <b>&minus;&minus;client&minus;connect</b>
script.</p>

<p style="margin-left:11%;"><b>tls_digest_{n}</b></p>

<p style="margin-left:22%;">Contains the certificate SHA1
fingerprint/digest hash value, where <b>n</b> is the
verification level. Only set for TLS connections. Set prior
to execution of <b>&minus;&minus;tls&minus;verify</b>
script.</p>

<p style="margin-left:11%;"><b>tls_id_{n}</b></p>

<p style="margin-left:22%;">A series of certificate fields
from the remote peer, where <b>n</b> is the verification
level. Only set for TLS connections. Set prior to execution
of <b>&minus;&minus;tls&minus;verify</b> script.</p>

<p style="margin-left:11%;"><b>tls_serial_{n}</b></p>

<p style="margin-left:22%;">The serial number of the
certificate from the remote peer, where <b>n</b> is the
verification level. Only set for TLS connections. Set prior
to execution of <b>&minus;&minus;tls&minus;verify</b>
script. This is in the form of a decimal string like
&quot;933971680&quot;, which is suitable for doing
serial-based OCSP queries (with OpenSSL, do not prepend
&quot;0x&quot; to the string) If something goes wrong while
reading the value from the certificate it will be an empty
string, so your code should check that. See the
contrib/OCSP_check/OCSP_check.sh script for an example.</p>

<p style="margin-left:11%;"><b>tls_serial_hex_{n}</b></p>

<p style="margin-left:22%;">Like <b>tls_serial_{n}</b>, but
in hex form (e.g. &quot;12:34:56:78:9A&quot;).</p>

<p style="margin-left:11%;"><b>tun_mtu</b></p>

<p style="margin-left:22%;">The MTU of the TUN/TAP device.
Set prior to <b>&minus;&minus;up</b> or
<b>&minus;&minus;down</b> script execution.</p>

<p style="margin-left:11%;"><b>trusted_ip (or
trusted_ip6)</b></p>

<p style="margin-left:22%;">Actual IP address of connecting
client or peer which has been authenticated. Set prior to
execution of <b>&minus;&minus;ipchange,
&minus;&minus;client&minus;connect,</b> and
<b>&minus;&minus;client&minus;disconnect</b> scripts. If
using ipv6 endpoints (udp6, tcp6), <b>trusted_ip6</b> will
be set instead.</p>

<p style="margin-left:11%;"><b>trusted_port</b></p>

<p style="margin-left:22%;">Actual port number of
connecting client or peer which has been authenticated. Set
prior to execution of <b>&minus;&minus;ipchange,
&minus;&minus;client&minus;connect,</b> and
<b>&minus;&minus;client&minus;disconnect</b> scripts.</p>

<p style="margin-left:11%;"><b>untrusted_ip (or
untrusted_ip6)</b></p>

<p style="margin-left:22%;">Actual IP address of connecting
client or peer which has not been authenticated yet.
Sometimes used to <b>nmap</b> the connecting host in a
<b>&minus;&minus;tls&minus;verify</b> script to ensure it is
firewalled properly. Set prior to execution of
<b>&minus;&minus;tls&minus;verify</b> and
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
scripts. If using ipv6 endpoints (udp6, tcp6),
<b>untrusted_ip6</b> will be set instead.</p>

<p style="margin-left:11%;"><b>untrusted_port</b></p>

<p style="margin-left:22%;">Actual port number of
connecting client or peer which has not been authenticated
yet. Set prior to execution of
<b>&minus;&minus;tls&minus;verify</b> and
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
scripts.</p>

<p style="margin-left:11%;"><b>username</b></p>

<p style="margin-left:22%;">The username provided by a
connecting client. Set prior to
<b>&minus;&minus;auth&minus;user&minus;pass&minus;verify</b>
script execution only when the <b>via-env</b> modifier is
specified.</p>


<p style="margin-left:11%;"><b>X509_{n}_{subject_field}</b></p>

<p style="margin-left:22%;">An X509 subject field from the
remote peer certificate, where <b>n</b> is the verification
level. Only set for TLS connections. Set prior to execution
of <b>&minus;&minus;tls&minus;verify</b> script. This
variable is similar to <b>tls_id_{n}</b> except the
component X509 subject fields are broken out, and no string
remapping occurs on these field values (except for remapping
of control characters to &quot;_&quot;). For example, the
following variables would be set on the OpenVPN server using
the sample client certificate in sample-keys (client.crt).
Note that the verification level is 0 for the client
certificate and 1 for the CA certificate.</p>


<p style="margin-left:28%; margin-top: 1em"><b>X509_0_emailAddress=me@myhost.mydomain
<br>
X509_0_CN=Test-Client <br>
X509_0_O=OpenVPN-TEST <br>
X509_0_ST=NA <br>
X509_0_C=KG <br>
X509_1_emailAddress=me@myhost.mydomain <br>
X509_1_O=OpenVPN-TEST <br>
X509_1_L=BISHKEK <br>
X509_1_ST=NA <br>
X509_1_C=KG</b></p>

<h2>INLINE FILE SUPPORT
<a name="INLINE FILE SUPPORT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">OpenVPN allows
including files in the main configuration for the
<b>&minus;&minus;ca, &minus;&minus;cert, &minus;&minus;dh,
&minus;&minus;extra&minus;certs, &minus;&minus;key,
&minus;&minus;pkcs12, &minus;&minus;secret</b> and
<b>&minus;&minus;tls&minus;auth</b> options.</p>

<p style="margin-left:11%; margin-top: 1em">Each inline
file started by the line <b>&lt;option&gt;</b> and ended by
the line <b>&lt;/option&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">Here is an
example of an inline file usage</p>


<p style="margin-left:17%; margin-top: 1em"><b>&lt;cert&gt;
<br>
-----BEGIN CERTIFICATE----- <br>
[...] <br>
-----END CERTIFICATE----- <br>
&lt;/cert&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">When using the
inline file feature with <b>&minus;&minus;pkcs12</b> the
inline file has to be base64 encoded. Encoding of a .p12
file into base64 can be done for example with OpenSSL by
running <b>openssl base64 &minus;in input.p12</b></p>

<h2>SIGNALS
<a name="SIGNALS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>SIGHUP</b></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">Cause OpenVPN to close all
TUN/TAP and network connections, restart, re-read the
configuration file (if any), and reopen TUN/TAP and network
connections.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>SIGUSR1</b></p>

<p style="margin-left:22%;">Like <b>SIGHUP,</b> except
don&rsquo;t re-read configuration file, and possibly
don&rsquo;t close and reopen TUN/TAP device, re-read key
files, preserve local IP address/port, or preserve most
recently authenticated remote IP address/port based on
<b>&minus;&minus;persist&minus;tun,
&minus;&minus;persist&minus;key,
&minus;&minus;persist&minus;local&minus;ip,</b> and
<b>&minus;&minus;persist&minus;remote&minus;ip</b> options
respectively (see above).</p>

<p style="margin-left:22%; margin-top: 1em">This signal may
also be internally generated by a timeout condition,
governed by the <b>&minus;&minus;ping&minus;restart</b>
option.</p>

<p style="margin-left:22%; margin-top: 1em">This signal,
when combined with
<b>&minus;&minus;persist&minus;remote&minus;ip,</b> may be
sent when the underlying parameters of the host&rsquo;s
network interface change such as when the host is a DHCP
client and is assigned a new IP address. See
<b>&minus;&minus;ipchange</b> above for more
information.</p>

<p style="margin-left:11%;"><b>SIGUSR2</b></p>

<p style="margin-left:22%;">Causes OpenVPN to display its
current statistics (to the syslog file if
<b>&minus;&minus;daemon</b> is used, or stdout
otherwise).</p>

<p style="margin-left:11%;"><b>SIGINT, SIGTERM</b></p>

<p style="margin-left:22%;">Causes OpenVPN to exit
gracefully.</p>

<h2>TUN/TAP DRIVER SETUP
<a name="TUN/TAP DRIVER SETUP"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">If you are
running Linux 2.4.7 or higher, you probably have the TUN/TAP
driver already installed. If so, there are still a few
things you need to do:</p>

<p style="margin-left:11%; margin-top: 1em">Make device:
<b>mknod /dev/net/tun c 10 200</b></p>

<p style="margin-left:11%; margin-top: 1em">Load driver:
<b>modprobe tun</b></p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Prior to
running these examples, you should have OpenVPN installed on
two machines with network connectivity between them. If you
have not yet installed OpenVPN, consult the INSTALL file
included in the OpenVPN distribution.</p>

<p style="margin-left:11%; margin-top: 1em"><b>TUN/TAP
Setup:</b> <br>
If you are using Linux 2.4 or higher, make the tun device
node and load the tun module:</p>

<p style="margin-left:22%; margin-top: 1em"><b>mknod
/dev/net/tun c 10 200</b></p>

<p style="margin-left:22%; margin-top: 1em"><b>modprobe
tun</b></p>

<p style="margin-left:11%; margin-top: 1em">If you
installed from RPM, the <b>mknod</b> step may be omitted,
because the RPM install does that for you.</p>

<p style="margin-left:11%; margin-top: 1em">Only Linux 2.4
and newer are supported.</p>

<p style="margin-left:11%; margin-top: 1em">For other
platforms, consult the INSTALL file at
<i>http://openvpn.net/install.html</i> for more
information.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Firewall
Setup:</b> <br>
If firewalls exist between the two machines, they should be
set to forward UDP port 1194 in both directions. If you do
not have control over the firewalls between the two
machines, you may still be able to use OpenVPN by adding
<b>&minus;&minus;ping 15</b> to each of the <b>openvpn</b>
commands used below in the examples (this will cause each
peer to send out a UDP ping to its remote peer once every 15
seconds which will cause many stateful firewalls to forward
packets in both directions without an explicit firewall
rule).</p>

<p style="margin-left:11%; margin-top: 1em">If you are
using a Linux iptables-based firewall, you may need to enter
the following command to allow incoming packets on the TUN
device:</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A INPUT &minus;i tun+ &minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">See the
firewalls section below for more information on configuring
firewalls for use with OpenVPN.</p>

<p style="margin-left:11%; margin-top: 1em"><b>VPN Address
Setup:</b> <br>
For purposes of our example, our two machines will be called
<b>may.kg</b> and <b>june.kg.</b> If you are constructing a
VPN over the internet, then replace <b>may.kg</b> and
<b>june.kg</b> with the internet hostname or IP address that
each machine will use to contact the other over the
internet.</p>

<p style="margin-left:11%; margin-top: 1em">Now we will
choose the tunnel endpoints. Tunnel endpoints are private IP
addresses that only have meaning in the context of the VPN.
Each machine will use the tunnel endpoint of the other
machine to access it over the VPN. In our example, the
tunnel endpoint for may.kg will be 10.4.0.1 and for june.kg,
10.4.0.2.</p>

<p style="margin-left:11%; margin-top: 1em">Once the VPN is
established, you have essentially created a secure alternate
path between the two hosts which is addressed by using the
tunnel endpoints. You can control which network traffic
passes between the hosts (a) over the VPN or (b)
independently of the VPN, by choosing whether to use (a) the
VPN endpoint address or (b) the public internet address, to
access the remote host. For example if you are on may.kg and
you wish to connect to june.kg via <b>ssh</b> without using
the VPN (since <b>ssh</b> has its own built-in security) you
would use the command <b>ssh june.kg.</b> However in the
same scenario, you could also use the command <b>telnet
10.4.0.2</b> to create a telnet session with june.kg over
the VPN, that would use the VPN to secure the session rather
than <b>ssh.</b></p>

<p style="margin-left:11%; margin-top: 1em">You can use any
address you wish for the tunnel endpoints but make sure that
they are private addresses (such as those that begin with 10
or 192.168) and that they are not part of any existing
subnet on the networks of either peer, unless you are
bridging. If you use an address that is part of your local
subnet for either of the tunnel endpoints, you will get a
weird feedback loop.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example 1: A
simple tunnel without security</b> <br>
On may:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;remote june.kg &minus;&minus;dev tun1
&minus;&minus;ifconfig 10.4.0.1 10.4.0.2 &minus;&minus;verb
9</b></p>

<p style="margin-left:11%; margin-top: 1em">On june:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;remote may.kg &minus;&minus;dev tun1
&minus;&minus;ifconfig 10.4.0.2 10.4.0.1 &minus;&minus;verb
9</b></p>

<p style="margin-left:11%; margin-top: 1em">Now verify the
tunnel is working by pinging across the tunnel.</p>

<p style="margin-left:11%; margin-top: 1em">On may:</p>

<p style="margin-left:22%; margin-top: 1em"><b>ping
10.4.0.2</b></p>

<p style="margin-left:11%; margin-top: 1em">On june:</p>

<p style="margin-left:22%; margin-top: 1em"><b>ping
10.4.0.1</b></p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;verb 9</b> option will produce verbose
output, similar to the <b>tcpdump</b>(8) program. Omit the
<b>&minus;&minus;verb 9</b> option to have OpenVPN run
quietly.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example 2: A
tunnel with static-key security (i.e. using a pre-shared
secret)</b> <br>
First build a static key on may.</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;genkey &minus;&minus;secret key</b></p>

<p style="margin-left:11%; margin-top: 1em">This command
will build a random key file called <b>key</b> (in ascii
format). Now copy <b>key</b> to june over a secure medium
such as by using the <b>scp</b>(1) program.</p>

<p style="margin-left:11%; margin-top: 1em">On may:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;remote june.kg &minus;&minus;dev tun1
&minus;&minus;ifconfig 10.4.0.1 10.4.0.2 &minus;&minus;verb
5 &minus;&minus;secret key</b></p>

<p style="margin-left:11%; margin-top: 1em">On june:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;remote may.kg &minus;&minus;dev tun1
&minus;&minus;ifconfig 10.4.0.2 10.4.0.1 &minus;&minus;verb
5 &minus;&minus;secret key</b></p>

<p style="margin-left:11%; margin-top: 1em">Now verify the
tunnel is working by pinging across the tunnel.</p>

<p style="margin-left:11%; margin-top: 1em">On may:</p>

<p style="margin-left:22%; margin-top: 1em"><b>ping
10.4.0.2</b></p>

<p style="margin-left:11%; margin-top: 1em">On june:</p>

<p style="margin-left:22%; margin-top: 1em"><b>ping
10.4.0.1</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>Example 3: A
tunnel with full TLS-based security</b> <br>
For this test, we will designate <b>may</b> as the TLS
client and <b>june</b> as the TLS server. <i>Note that
client or server designation only has meaning for the TLS
subsystem. It has no bearing on OpenVPN&rsquo;s
peer-to-peer, UDP-based communication model.</i></p>

<p style="margin-left:11%; margin-top: 1em">First, build a
separate certificate/key pair for both may and june (see
above where <b>&minus;&minus;cert</b> is discussed for more
info). Then construct Diffie Hellman parameters (see above
where <b>&minus;&minus;dh</b> is discussed for more info).
You can also use the included test files client.crt,
client.key, server.crt, server.key and ca.crt. The .crt
files are certificates/public-keys, the .key files are
private keys, and ca.crt is a certification authority who
has signed both client.crt and server.crt. For Diffie
Hellman parameters you can use the included file dh1024.pem.
<i>Note that all client, server, and certificate authority
certificates and keys included in the OpenVPN distribution
are totally insecure and should be used for testing
only.</i></p>

<p style="margin-left:11%; margin-top: 1em">On may:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;remote june.kg &minus;&minus;dev tun1
&minus;&minus;ifconfig 10.4.0.1 10.4.0.2
&minus;&minus;tls&minus;client &minus;&minus;ca ca.crt
&minus;&minus;cert client.crt &minus;&minus;key client.key
&minus;&minus;reneg&minus;sec 60 &minus;&minus;verb
5</b></p>

<p style="margin-left:11%; margin-top: 1em">On june:</p>

<p style="margin-left:22%; margin-top: 1em"><b>openvpn
&minus;&minus;remote may.kg &minus;&minus;dev tun1
&minus;&minus;ifconfig 10.4.0.2 10.4.0.1
&minus;&minus;tls&minus;server &minus;&minus;dh dh1024.pem
&minus;&minus;ca ca.crt &minus;&minus;cert server.crt
&minus;&minus;key server.key &minus;&minus;reneg&minus;sec
60 &minus;&minus;verb 5</b></p>

<p style="margin-left:11%; margin-top: 1em">Now verify the
tunnel is working by pinging across the tunnel.</p>

<p style="margin-left:11%; margin-top: 1em">On may:</p>

<p style="margin-left:22%; margin-top: 1em"><b>ping
10.4.0.2</b></p>

<p style="margin-left:11%; margin-top: 1em">On june:</p>

<p style="margin-left:22%; margin-top: 1em"><b>ping
10.4.0.1</b></p>

<p style="margin-left:11%; margin-top: 1em">Notice the
<b>&minus;&minus;reneg&minus;sec 60</b> option we used
above. That tells OpenVPN to renegotiate the data channel
keys every minute. Since we used <b>&minus;&minus;verb 5</b>
above, you will see status information on each new key
negotiation.</p>

<p style="margin-left:11%; margin-top: 1em">For production
operations, a key renegotiation interval of 60 seconds is
probably too frequent. Omit the
<b>&minus;&minus;reneg&minus;sec 60</b> option to use
OpenVPN&rsquo;s default key renegotiation interval of one
hour.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Routing:</b>
<br>
Assuming you can ping across the tunnel, the next step is to
route a real subnet over the secure tunnel. Suppose that may
and june have two network interfaces each, one connected to
the internet, and the other to a private network. Our goal
is to securely connect both private networks. We will assume
that may&rsquo;s private subnet is 10.0.0.0/24 and
june&rsquo;s is 10.0.1.0/24.</p>

<p style="margin-left:11%; margin-top: 1em">First, ensure
that IP forwarding is enabled on both peers. On Linux,
enable routing:</p>

<p style="margin-left:22%; margin-top: 1em"><b>echo 1 &gt;
/proc/sys/net/ipv4/ip_forward</b></p>

<p style="margin-left:11%; margin-top: 1em">and enable TUN
packet forwarding through the firewall:</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A FORWARD &minus;i tun+ &minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">On may:</p>

<p style="margin-left:22%; margin-top: 1em"><b>route add
&minus;net 10.0.1.0 netmask 255.255.255.0 gw
10.4.0.2</b></p>

<p style="margin-left:11%; margin-top: 1em">On june:</p>

<p style="margin-left:22%; margin-top: 1em"><b>route add
&minus;net 10.0.0.0 netmask 255.255.255.0 gw
10.4.0.1</b></p>

<p style="margin-left:11%; margin-top: 1em">Now any machine
on the 10.0.0.0/24 subnet can access any machine on the
10.0.1.0/24 subnet over the secure tunnel (or vice
versa).</p>

<p style="margin-left:11%; margin-top: 1em">In a production
environment, you could put the route command(s) in a script
and execute with the <b>&minus;&minus;up</b> option.</p>

<h2>FIREWALLS
<a name="FIREWALLS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">OpenVPN&rsquo;s
usage of a single UDP port makes it fairly
firewall-friendly. You should add an entry to your firewall
rules to allow incoming OpenVPN packets. On Linux 2.4+:</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A INPUT &minus;p udp &minus;s 1.2.3.4
&minus;&minus;dport 1194 &minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">This will allow
incoming packets on UDP port 1194 (OpenVPN&rsquo;s default
UDP port) from an OpenVPN peer at 1.2.3.4.</p>

<p style="margin-left:11%; margin-top: 1em">If you are
using HMAC-based packet authentication (the default in any
of OpenVPN&rsquo;s secure modes), having the firewall filter
on source address can be considered optional, since HMAC
packet authentication is a much more secure method of
verifying the authenticity of a packet source. In that
case:</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A INPUT &minus;p udp &minus;&minus;dport 1194
&minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">would be
adequate and would not render the host inflexible with
respect to its peer having a dynamic IP address.</p>

<p style="margin-left:11%; margin-top: 1em">OpenVPN also
works well on stateful firewalls. In some cases, you may not
need to add any static rules to the firewall list if you are
using a stateful firewall that knows how to track UDP
connections. If you specify <b>&minus;&minus;ping n,</b>
OpenVPN will be guaranteed to send a packet to its peer at
least once every <b>n</b> seconds. If <b>n</b> is less than
the stateful firewall connection timeout, you can maintain
an OpenVPN connection indefinitely without explicit firewall
rules.</p>

<p style="margin-left:11%; margin-top: 1em">You should also
add firewall rules to allow incoming IP traffic on TUN or
TAP devices such as:</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A INPUT &minus;i tun+ &minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">to allow input
packets from tun devices,</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A FORWARD &minus;i tun+ &minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">to allow input
packets from tun devices to be forwarded to other hosts on
the local network,</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A INPUT &minus;i tap+ &minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">to allow input
packets from tap devices, and</p>

<p style="margin-left:22%; margin-top: 1em"><b>iptables
&minus;A FORWARD &minus;i tap+ &minus;j ACCEPT</b></p>

<p style="margin-left:11%; margin-top: 1em">to allow input
packets from tap devices to be forwarded to other hosts on
the local network.</p>

<p style="margin-left:11%; margin-top: 1em">These rules are
secure if you use packet authentication, since no incoming
packets will arrive on a TUN or TAP virtual device unless
they first pass an HMAC authentication test.</p>

<h2>FAQ
<a name="FAQ"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>http://openvpn.net/faq.html</i></p>

<h2>HOWTO
<a name="HOWTO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For a more
comprehensive guide to setting up OpenVPN in a production
setting, see the OpenVPN HOWTO at
<i>http://openvpn.net/howto.html</i></p>

<h2>PROTOCOL
<a name="PROTOCOL"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For a
description of OpenVPN&rsquo;s underlying protocol, see
<i>http://openvpn.net/security.html</i></p>

<h2>WEB
<a name="WEB"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">OpenVPN&rsquo;s
web site is at <i>http://openvpn.net/</i></p>

<p style="margin-left:11%; margin-top: 1em">Go here to
download the latest version of OpenVPN, subscribe to the
mailing lists, read the mailing list archives, or browse the
SVN repository.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Report all bugs
to the OpenVPN team &lt;info@openvpn.net&gt;.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>dhcpcd</b>(8),
<b>ifconfig</b>(8), <b>openssl</b>(1), <b>route</b>(8),
<b>scp</b>(1) <b>ssh</b>(1)</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This product
includes software developed by the OpenSSL Project (
<i>http://www.openssl.org/</i> )</p>

<p style="margin-left:11%; margin-top: 1em">For more
information on the TLS protocol, see
<i>http://www.ietf.org/rfc/rfc2246.txt</i></p>

<p style="margin-left:11%; margin-top: 1em">For more
information on the LZO real-time compression library see
<i>http://www.oberhumer.com/opensource/lzo/</i></p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2002-2010 OpenVPN Technologies, Inc. This program is free
software; you can redistribute it and/or modify it under the
terms of the GNU General Public License version 2 as
published by the Free Software Foundation.</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">James Yonan
&lt;jim@yonan.net&gt;</p>
<hr>
</body>
</html>
