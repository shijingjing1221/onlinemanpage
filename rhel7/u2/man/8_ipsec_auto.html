<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 01:50:30 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IPSEC_AUTO</title>

</head>
<body>

<h1 align="center">IPSEC_AUTO</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ipsec_auto
&minus; control automatically&minus;keyed IPsec
connections</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="61%">


<p style="margin-top: 1em"><b>ipsec</b> <i>auto</i>
[&minus;&minus;showonly] [&minus;&minus;asynchronous]</p></td>
<td width="28%">
</td></tr>
</table>


<p style="margin-left:20%;">[&minus;&minus;config&nbsp;<i>configfile</i>]
[&minus;&minus;verbose] <i>operation&nbsp;connection</i></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="61%">


<p style="margin-top: 1em"><b>ipsec</b> <i>auto</i>
[&minus;&minus;showonly] [&minus;&minus;asynchronous]</p></td>
<td width="28%">
</td></tr>
</table>


<p style="margin-left:20%;">[&minus;&minus;config&nbsp;<i>configfile</i>]
[&minus;&minus;verbose] <i>operation&nbsp;connection</i></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>
<td width="11%"></td>
<td width="89%">


<p><i><b>ipsec</b> auto</i>
{&nbsp;&minus;&minus;add&nbsp;|&nbsp;&minus;&minus;delete&nbsp;|&nbsp;&minus;&minus;replace&nbsp;|&nbsp;&minus;&minus;up&nbsp;|&nbsp;&minus;&minus;down&nbsp;}
<i>connection</i></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p><b>ipsec</b> <i>auto</i>
{&nbsp;&minus;&minus;status&nbsp;|&nbsp;&minus;&minus;ready&nbsp;}</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p><b>ipsec</b> <i>auto</i>
{&nbsp;&minus;&minus;route&nbsp;|&nbsp;&minus;&minus;unroute&nbsp;}
<i>connection</i></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p><b>ipsec</b> <i>auto</i> [&minus;&minus;utc]
[&minus;&minus;listall&nbsp;|&nbsp;&minus;&minus;rereadall]
[&minus;&minus;rereadsecrets] [&minus;&minus;listcerts]
[&minus;&minus;listpubkeys] [&minus;&minus;checkpubkeys]
[&minus;&minus;listcacerts&nbsp;|&nbsp;&minus;&minus;rereadcacerts]
[&minus;&minus;listcrls&nbsp;|&nbsp;&minus;&minus;rereadcrls]
[&minus;&minus;listacerts&nbsp;|&nbsp;&minus;&minus;rereadacerts]
[&minus;&minus;listaacerts&nbsp;|&nbsp;&minus;&minus;rereadaacerts]
[&minus;&minus;listgroups&nbsp;|&nbsp;&minus;&minus;rereadgroups]</p> </td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>Auto</i>
manipulates automatically&minus;keyed Libreswan IPsec
connections, setting them up and shutting them down based on
the information in the IPsec configuration file. In the
normal usage, <i>connection</i> is the name of a connection
specification in the configuration file; <i>operation</i> is
<b>&minus;&minus;add</b>, <b>&minus;&minus;delete</b>,
<b>&minus;&minus;replace</b>, <b>&minus;&minus;up</b>,
<b>&minus;&minus;down</b>, <b>&minus;&minus;route</b>, or
<b>&minus;&minus;unroute</b>. The
<b>&minus;&minus;ready</b>,
<b>&minus;&minus;rereadsecrets</b>,
<b>&minus;&minus;rereadgroups</b>, and
<b>&minus;&minus;status</b><i>operations</i> do not take a
connection name. <i>Auto</i> generates suitable commands and
feeds them to a shell for execution.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;add</b> operation adds a connection
specification to the internal database within <i>pluto</i>;
it will fail if <i>pluto</i> already has a specification by
that name. The <b>&minus;&minus;delete</b> operation deletes
a connection specification from <i>pluto</i>'s internal
database (also tearing down any connections based on it);
The <b>&minus;&minus;replace</b> operation is equivalent to
<b>&minus;&minus;delete</b> (if there is already a loaded
connection by the given name) followed by
<b>&minus;&minus;add</b>, and is a convenience for updating
<i>pluto</i>'s internal specification to match an external
one. (Note that a <b>&minus;&minus;rereadsecrets</b> may
also be needed.) The <b>&minus;&minus;rereadgroups</b>
operation causes any changes to the policy group files to
take effect (this is currently a synonym for
<b>&minus;&minus;ready</b>, but that may change). None of
the other operations alters the internal database.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;up</b> operation asks <i>pluto</i> to
establish a connection based on an entry in its internal
database. The <b>&minus;&minus;down</b> operation tells
<i>pluto</i> to tear down such a connection.</p>

<p style="margin-left:11%; margin-top: 1em">Normally,
<i>pluto</i> establishes a route to the destination
specified for a connection as part of the
<b>&minus;&minus;up</b> operation. However, the route (for
KLIPS) and packet capture (KLIPS and NETKEY) can be
established with the <b>&minus;&minus;route</b> operation.
Until and unless an actual connection is established, this
discards any packets sent there, which may be preferable to
having them sent elsewhere based on a more general route
(e.g., a default route).</p>

<p style="margin-left:11%; margin-top: 1em">Normally,
<i>pluto</i>'s route (KLIPS) or packet capture (NETKEY) to a
destination remains in place when a
<b>&minus;&minus;down</b> operation is used to take the
connection down (or if connection setup, or later automatic
rekeying, fails). This permits establishing a new connection
(perhaps using a different specification; the route is
altered as necessary) without having a &ldquo;window&rdquo;
in which packets might go elsewhere based on a more general
route. Such a route can be removed using the
<b>&minus;&minus;unroute</b> operation (and is implicitly
removed by <b>&minus;&minus;delete</b>).</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;ready</b> operation tells <i>pluto</i> to
listen for connection&minus;setup requests from other hosts.
Doing an <b>&minus;&minus;up</b> operation before doing
<b>&minus;&minus;ready</b> on both ends is futile and will
not work, although this is now automated as part of IPsec
startup and should not normally be an issue.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;status</b> operation asks <i>pluto</i> for
current connection status. The output format is ad&minus;hoc
and likely to change.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;rereadsecrets</b> operation tells
<i>pluto</i> to re&minus;read the /etc/ipsec.secrets
secret&minus;keys file, which it normally reads only at
startup time. (This is currently a synonym for
<b>&minus;&minus;ready</b>, but that may change.)</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;rereadsecrets</b> operation tells pluto to
re&minus;read the /etc/ipsec.secrets secret&minus;keys file,
which it normally reads only at startup time. (This is
currently a synonym for <b>&minus;&minus;ready,</b> but that
may change.)</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;rereadcacerts</b> operation reads all
certificate files contained in the /etc/ipsec.d/cacerts
directory and adds them to pluto's list of Certification
Authority (CA) certificates. Note CA certificates can and
should be stored inside NSS instead of in the
/etc/ipsec.d/cacerts directory which will result in
automatic updates. This option will be obsoleted in the near
future.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;rereadcrls</b> operation reads all
certificate revocation list (CRL) files contained in the
/etc/ipsec.d/crls directory and adds them to pluto's list of
CRLs. Note CRLs can and should be stored inside NSS instead
of in the /etc/ipsec.d/crls directory which will result in
automatic updates. This option will be obsoleted in the near
future.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;rereadall</b> operation is equivalent to
the execution of &minus;&minus;rereadsecrets,
&minus;&minus;rereadcacerts and
&minus;&minus;rereadcrls.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;listpubkeys</b> operation lists all RSA
public keys either received from peers via the IKE protocol
embedded in authenticated certificate payloads or loaded
locally using the rightcert / leftcert or rightr&minus;
sasigkey / leftrsasigkey parameters in ipsec.conf(5).</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;listcerts</b> operation lists all X.509
certificates loaded locally using the rightcert and leftcert
parameters in ipsec.conf(5). To see all certificates in the
NSS database, use <b>certutil &minus;d /etc/ipsec.d
&minus;L</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;checkpubkeys</b> operation lists all loaded
X.509 certificates which are about to expire or have been
expired.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;listcacerts</b> operation lists all X.509
CA certificates either loaded locally from the
/etc/ipsec.d/cacerts directory or received in
PKCS#7&minus;wrapped certificate payloads via the IKE
protocol.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;listgroups</b> operation lists all groups
that are either used in connection definitions in
ipsec.conf(5) or are embedded in loaded X.509 attributes
certificates.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;listcrls</b> operation lists all
Certificate Revocation Lists (CRLs) either loaded locally
from the /etc/ipsec.d/crls directory or fetched dynamically
from an HTTP or LDAP server.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;listall</b> operation is equivalent to the
execution of &minus;&minus;listpubkeys,
&minus;&minus;listcerts, &minus;&minus;listcacerts,
&minus;&minus;listgroups, &minus;&minus;listcrls.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;showonly</b> option causes <i>auto</i> to
show the commands it would run, on standard output, and not
run them.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;asynchronous</b> option, applicable only to
the <b>up</b> operation, tells <i>pluto</i> to attempt to
establish the connection, but does not delay to report
results. This is especially useful to start multiple
connections in parallel when network links are slow.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;verbose</b> option instructs <i>auto</i> to
pass through all output from <b>ipsec_whack</b>(8),
including log output that is normally filtered out as
uninteresting.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;&minus;config</b> option specifies a
non&minus;standard location for the IPsec configuration file
(default /etc/ipsec.conf).</p>

<p style="margin-left:11%; margin-top: 1em">See
<b>ipsec.conf</b>(5) for details of the configuration
file.</p>

<h2>FILES
<a name="FILES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="-9%">


<p>/etc/ipsec.conf</p></td>
<td width="15%"></td>
<td width="8%"></td>
<td width="7%"></td>
<td width="8%"></td>
<td width="8%">
</td>
<td width="46%">
</td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="-9%"></td>
<td width="15%"></td>
<td width="8%"></td>
<td width="7%"></td>
<td width="8%"></td>
<td width="8%"></td>
<td width="46%">


<p>default IPSEC configuration file</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="-9%">


<p>/etc/ipsec.d/</p></td>
<td width="15%"></td>
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="46%">


<p>X.509 and Opportunistic Encryption files</p></td></tr>
<tr valign="top" align="left">
<td width="17%"></td>
<td width="-9%">


<p>/var/run/pluto/pluto.ctl</p></td>
<td width="15%"></td>
<td width="8%"></td>
<td width="7%"></td>
<td width="8%"></td>
<td width="8%"></td>
<td width="46%">


<p>Pluto command socket</p></td></tr>
</table>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>ipsec.conf</b>(5),
<b>ipsec</b>(8), <b>ipsec_pluto</b>(8),
<b>ipsec_whack</b>(8)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Originally
written for the FreeS/WAN project
&lt;<b><font color="#0000FF">http://www.freeswan.org</font></b><font color="#000000">&gt;
by Henry Spencer.</font></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Although
an <b>&minus;&minus;up</b> operation does connection setup
on both ends, <b>&minus;&minus;down</b> tears only one end
of the connection down (although the orphaned end will
eventually time out).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">There
is no support for <b>passthrough</b> connections.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">A
connection description which uses <b>%defaultroute</b> for
one of its <b>nexthop</b> parameters but not the other may
be falsely rejected as erroneous in some
circumstances.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
exit status of <b>&minus;&minus;showonly</b> does not always
reflect errors discovered during processing of the request.
(This is fine for human inspection, but not so good for use
in scripts.)</font></p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Paul
Wouters</b></font></p>


<p style="margin-left:17%;"><font color="#000000">placeholder
to suppress warning</font></p>
<hr>
</body>
</html>
