<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Sat Nov  5 22:14:54 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IPSEC.CONF</title>

</head>
<body>

<h1 align="center">IPSEC.CONF</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONN SECTIONS">CONN SECTIONS</a><br>
<a href="#CA SECTIONS">CA SECTIONS</a><br>
<a href="#CONFIG SECTIONS">CONFIG SECTIONS</a><br>
<a href="#SA EXPIRY/REKEY">SA EXPIRY/REKEY</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ipsec.conf
&minus; IPsec configuration and connections</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The optional
<i>ipsec.conf</i> file specifies most configuration and
control information for the strongSwan IPsec subsystem. The
major exception is secrets for authentication; see
<i>ipsec.secrets</i>(5). Its contents are not
security-sensitive.</p>

<p style="margin-left:11%; margin-top: 1em">The file is a
text file, consisting of one or more <i>sections</i>. White
space followed by <b>#</b> followed by anything to the end
of the line is a comment and is ignored, as are empty lines
which are not within a section.</p>

<p style="margin-left:11%; margin-top: 1em">A line which
contains <b>include</b> and a file name, separated by white
space, is replaced by the contents of that file. If the file
name is not a full pathname, it is considered to be relative
to the directory containing the including file. Such
inclusions can be nested. Only a single filename may be
supplied, and it may not contain white space, but it may
include shell wildcards (see <i>sh</i>(1)); for example:</p>

<p style="margin-left:11%; margin-top: 1em"><b>include
ipsec.*.conf</b></p>

<p style="margin-left:11%; margin-top: 1em">The intention
of the include facility is mostly to permit keeping
information on connections, or sets of connections, separate
from the main configuration file. This permits such
connection descriptions to be changed, copied to the other
security gateways involved, etc., without having to
constantly extract them from the configuration file and then
insert them back into it. Note also the <b>also</b>
parameter (described below) which permits splitting a single
logical section (e.g. a connection description) into several
actual sections.</p>

<p style="margin-left:11%; margin-top: 1em">A section
begins with a line of the form:</p>

<p style="margin-left:11%; margin-top: 1em"><i>type
name</i></p>

<p style="margin-left:11%; margin-top: 1em">where
<i>type</i> indicates what type of section follows, and
<i>name</i> is an arbitrary name which distinguishes the
section from others of the same type. All subsequent
non-empty lines which begin with white space are part of the
section. Sections of the same type that share the same name
are merged.</p>

<p style="margin-left:11%; margin-top: 1em">Lines within
the section are generally of the form
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


<p style="margin-left:11%; margin-top: 1em"><i>parameter</i><b>=</b><i>value</i></p>

<p style="margin-left:11%; margin-top: 1em">(note the
mandatory preceding white space). There can be white space
on either side of the <b>=</b>. Parameter names are specific
to a section type.</p>

<p style="margin-left:11%; margin-top: 1em">An empty
<i>value</i> stands for the system default value (if any) of
the parameter, i.e. it is roughly equivalent to omitting the
parameter line entirely. This may be useful to clear a
setting inherited from a <b>%default</b> section or via
<b>also</b> parameter (see below). A <i>value</i> may
contain single spaces (additional white space is reduced to
one space). To preserve white space as written enclose the
entire <i>value</i> in double quotes (<b>&quot;</b>); in
such values double quotes themselves may be escaped by
prefixing them with <b>\</b> characters. A double-quoted
string may span multiple lines by ending them with <b>\</b>
characters (following lines don&rsquo;t have to begin with
white space, as that will be preserved). Additionally, the
following control characters may be encoded in double-quoted
strings: \n, \r, \t, \b, \f.</p>

<p style="margin-left:11%; margin-top: 1em">Numeric values
are specified to be either an
&lsquo;&lsquo;integer&rsquo;&rsquo; (a sequence of digits)
or a &lsquo;&lsquo;decimal number&rsquo;&rsquo; (sequence of
digits optionally followed by &lsquo;.&rsquo; and another
sequence of digits).</p>

<p style="margin-left:11%; margin-top: 1em">There is
currently one parameter which is available in any type of
section:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><b>also</b></p></td>
<td width="5%"></td>
<td width="78%">


<p>the value is a section name; the parameters of that
section are inherited by the current section. Parameters in
the current section always override inherited parameters,
even if an <b>also</b> follows after them. The specified
section must exist and must have the same section type; it
doesn&rsquo;t if it is defined before or after the current
section. Nesting is permitted, and there may be more than
one <b>also</b> in a single section (parameters from
referenced sections are inherited and overridden in the
order of these <b>also</b> parameters).</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">A section with
name <b>%default</b> specifies defaults for sections of the
same type. All parameters in it, are inherited by all other
sections of that type.</p>

<p style="margin-left:11%; margin-top: 1em">Currently there
are three types of sections: a <b>config</b> section
specifies general configuration information for IPsec, a
<b>conn</b> section specifies an IPsec connection, while a
<b>ca</b> section specifies special properties of a
certification authority.</p>

<h2>CONN SECTIONS
<a name="CONN SECTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A <b>conn</b>
section contains a <i>connection specification</i>, defining
a network connection to be made using IPsec. The name given
is arbitrary, and is used to identify the connection.
Here&rsquo;s a simple example:</p>

<p style="margin-left:11%; margin-top: 1em"><b>conn
snt</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p><b>left=192.168.0.1</b></p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p><b>leftsubnet=10.1.0.0/16</b></p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p><b>right=192.168.0.2</b></p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p><b>rightsubnet=10.1.0.0/16</b></p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p><b>keyingtries=%forever</b></p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="94%">


<p><b>auto=add</b></p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">A note on
terminology: There are two kinds of communications going on:
transmission of user IP packets, and gateway-to-gateway
negotiations for keying, rekeying, and general control. The
path to control the connection is called &rsquo;ISAKMP
SA&rsquo; in IKEv1 and &rsquo;IKE SA&rsquo; in the IKEv2
protocol. That what is being negotiated, the kernel level
data path, is called &rsquo;IPsec SA&rsquo; or &rsquo;Child
SA&rsquo;. strongSwan previously used two separate keying
daemons, <i>pluto</i> and <i>charon</i>. This manual does
not discuss <i>pluto</i> options anymore, but only
<i>charon</i> that since strongSwan 5.0 supports both IKEv1
and IKEv2.</p>

<p style="margin-left:11%; margin-top: 1em">To avoid
trivial editing of the configuration file to suit it to each
system involved in a connection, connection specifications
are written in terms of <i>left</i> and <i>right</i>
participants, rather than in terms of local and remote.
Which participant is considered <i>left</i> or <i>right</i>
is arbitrary; for every connection description an attempt is
made to figure out whether the local endpoint should act as
the <i>left</i> or <i>right</i> endpoint. This is done by
matching the IP addresses defined for both endpoints with
the IP addresses assigned to local network interfaces. If a
match is found then the role (left or right) that matches is
going to be considered local. If no match is found during
startup, <i>left</i> is considered local. This permits using
identical connection specifications on both ends. There are
cases where there is no symmetry; a good convention is to
use <i>left</i> for the local side and <i>right</i> for the
remote side (the first letters are a good mnemonic).</p>

<p style="margin-left:11%; margin-top: 1em">Many of the
parameters relate to one participant or the other; only the
ones for <i>left</i> are listed here, but every parameter
whose name begins with <b>left</b> has a <b>right</b>
counterpart, whose description is the same but with
<b>left</b> and <b>right</b> reversed.</p>

<p style="margin-left:11%; margin-top: 1em">Parameters are
optional unless marked &rsquo;(required)&rsquo;.</p>

<p style="margin-left:11%; margin-top: 1em"><b>CONN
PARAMETERS</b> <br>
Unless otherwise noted, for a connection to work, in general
it is necessary for the two ends to agree exactly on the
values of these parameters. <b><br>
aaa_identity</b> = &lt;id&gt;</p>

<p style="margin-left:22%;">defines the identity of the AAA
backend used during IKEv2 EAP authentication. This is
required if the EAP client uses a method that verifies the
server identity (such as EAP-TLS), but it does not match the
IKEv2 gateway identity.</p>

<p style="margin-left:11%;"><b>aggressive</b> = yes |
<b>no</b></p>

<p style="margin-left:22%;">whether to use IKEv1 Aggressive
or Main Mode (the default).</p>

<p style="margin-left:11%;"><b>ah</b> = &lt;cipher
suites&gt;</p>

<p style="margin-left:22%;">comma-separated list of AH
algorithms to be used for the connection, e.g.
<b>sha1-sha256-modp1024</b>. The notation is
<b>integrity[-dhgroup]</b>. For IKEv2, multiple algorithms
(separated by -) of the same type can be included in a
single proposal. IKEv1 only includes the first algorithm in
a proposal. Only either the <b>ah</b> or <b>esp</b> keyword
may be used, AH+ESP bundles are not supported.</p>

<p style="margin-left:22%; margin-top: 1em">There is no
default AH cipher suite since by default ESP is used. The
daemon adds its extensive default proposal to the configured
value. To restrict it to the configured proposal an
exclamation mark (<b>!</b>) can be added at the end.</p>

<p style="margin-left:22%; margin-top: 1em">If
<b>dh-group</b> is specified, CHILD_SA/Quick Mode setup and
rekeying include a separate Diffie-Hellman exchange.</p>

<p style="margin-left:11%;"><b>also</b> = &lt;name&gt;</p>

<p style="margin-left:22%;">includes conn section
<b>&lt;name&gt;</b>.</p>

<p style="margin-left:11%;"><b>auth</b> = &lt;value&gt;</p>

<p style="margin-left:22%;">was used by the <b>pluto</b>
IKEv1 daemon to use AH integrity protection for ESP
encrypted packets, but is not supported in charon. The
<b>ah</b> keyword specifies algorithms to use for integrity
protection with AH, but without encryption. AH+ESP bundles
are not supported.</p>

<p style="margin-left:11%;"><b>authby</b> = <b>pubkey</b> |
rsasig | ecdsasig | psk | secret | never | xauthpsk | <br>
xauthrsasig</p>

<p style="margin-left:22%;">how the two security gateways
should authenticate each other; acceptable values are
<b>psk</b> or <b>secret</b> for pre-shared secrets,
<b>pubkey</b> (the default) for public key signatures as
well as the synonyms <b>rsasig</b> for RSA digital
signatures and <b>ecdsasig</b> for Elliptic Curve DSA
signatures. <b>never</b> can be used if negotiation is never
to be attempted or accepted (useful for shunt-only conns).
Digital signatures are superior in every way to shared
secrets. IKEv1 additionally supports the values
<b>xauthpsk</b> and <b>xauthrsasig</b> that will enable
eXtended AUTHentication (XAUTH) in addition to IKEv1 main
mode based on shared secrets or digital RSA signatures,
respectively. This parameter is deprecated, as two peers do
not need to agree on an authentication method in IKEv2. Use
the <b>leftauth</b> parameter instead to define
authentication methods.</p>

<p style="margin-left:11%;"><b>auto</b> = <b>ignore</b> |
add | route | start</p>

<p style="margin-left:22%;">what operation, if any, should
be done automatically at IPsec startup; currently-accepted
values are <b>add</b>, <b>route</b>, <b>start</b> and
<b>ignore</b> (the default). <b>add</b> loads a connection
without starting it. <b>route</b> loads a connection and
installs kernel traps. If traffic is detected between
<b>leftsubnet</b> and <b>rightsubnet</b>, a connection is
established. <b>start</b> loads a connection and brings it
up immediately. <b>ignore</b> ignores the connection. This
is equal to deleting a connection from the config file.
Relevant only locally, other end need not agree on it.</p>

<p style="margin-left:11%;"><b>closeaction</b> =
<b>none</b> | clear | hold | restart</p>

<p style="margin-left:22%;">defines the action to take if
the remote peer unexpectedly closes a CHILD_SA (see
<b>dpdaction</b> for meaning of values). A <b>closeaction
should not be</b> used if the peer uses reauthentication or
uniquids checking, as these events might trigger the defined
action when not desired.</p>

<p style="margin-left:11%;"><b>compress</b> = yes |
<b>no</b></p>

<p style="margin-left:22%;">whether IPComp compression of
content is proposed on the connection (link-level
compression does not work on encrypted data, so to be
effective, compression must be done <i>before</i>
encryption); acceptable values are <b>yes</b> and <b>no</b>
(the default). A value of <b>yes</b> causes the daemon to
propose both compressed and uncompressed, and prefer
compressed. A value of <b>no</b> prevents the daemon from
proposing or accepting compression.</p>

<p style="margin-left:11%;"><b>dpdaction</b> = <b>none</b>
| clear | hold | restart</p>

<p style="margin-left:22%;">controls the use of the Dead
Peer Detection protocol (DPD, RFC 3706) where R_U_THERE
notification messages (IKEv1) or empty INFORMATIONAL
messages (IKEv2) are periodically sent in order to check the
liveliness of the IPsec peer. The values <b>clear</b>,
<b>hold</b>, and <b>restart</b> all activate DPD. If no
activity is detected, all connections with a dead peer are
stopped and unrouted (<b>clear</b>), put in the hold state
(<b>hold</b>) or restarted (<b>restart</b>). The default is
<b>none</b> which disables the active sending of DPD
messages.</p>

<p style="margin-left:11%;"><b>dpddelay</b> = <b>30s</b> |
&lt;time&gt;</p>

<p style="margin-left:22%;">defines the period time
interval with which R_U_THERE messages/INFORMATIONAL
exchanges are sent to the peer. These are only sent if no
other traffic is received. In IKEv2, a value of 0 sends no
additional INFORMATIONAL messages and uses only standard
messages (such as those to rekey) to detect dead peers.</p>

<p style="margin-left:11%;"><b>dpdtimeout</b> = <b>150s</b>
| &lt;time&gt;</p>

<p style="margin-left:22%;">defines the timeout interval,
after which all connections to a peer are deleted in case of
inactivity. This only applies to IKEv1, in IKEv2 the default
retransmission timeout applies, as every exchange is used to
detect dead peers.</p>

<p style="margin-left:11%;"><b>inactivity</b> =
&lt;time&gt;</p>

<p style="margin-left:22%;">defines the timeout interval,
after which a CHILD_SA is closed if it did not send or
receive any traffic. The inactivity counter is reset during
CHILD_SA rekeying. This means that the inactivity timeout
must be smaller than the rekeying interval to have any
effect.</p>

<p style="margin-left:11%;"><b>eap_identity</b> =
&lt;id&gt;</p>

<p style="margin-left:22%;">defines the identity the client
uses to reply to an EAP Identity request. If defined on the
EAP server, the defined identity will be used as peer
identity during EAP authentication. The special value
<b>%identity</b> uses the EAP Identity method to ask the
client for an EAP identity. If not defined, the IKEv2
identity will be used as EAP identity.</p>

<p style="margin-left:11%;"><b>esp</b> = &lt;cipher
suites&gt;</p>

<p style="margin-left:22%;">comma-separated list of ESP
encryption/authentication algorithms to be used for the
connection, e.g. <b>aes128-sha256</b>. The notation is
<b>encryption-integrity[-dhgroup][-esnmode]</b>. For IKEv2,
multiple algorithms (separated by -) of the same type can be
included in a single proposal. IKEv1 only includes the first
algorithm in a proposal. Only either the <b>ah</b> or
<b>esp</b> keyword may be used, AH+ESP bundles are not
supported.</p>

<p style="margin-left:22%; margin-top: 1em">Defaults to
<b>aes128-sha1,3des-sha1</b>. The daemon adds its extensive
default proposal to this default or the configured value. To
restrict it to the configured proposal an exclamation mark
(<b>!</b>) can be added at the end.</p>

<p style="margin-left:22%; margin-top: 1em"><b>Note</b>: As
a responder the daemon accepts the first supported proposal
received from the peer. In order to restrict a responder to
only accept specific cipher suites, the strict flag
(<b>!</b>, exclamation mark) can be used, e.g:
aes256-sha512-modp4096! <br>
If <b>dh-group</b> is specified, CHILD_SA/Quick Mode setup
and rekeying include a separate Diffie-Hellman exchange.
Valid values for <b>esnmode</b> (IKEv2 only) are <b>esn</b>
and <b>noesn</b>. Specifying both negotiates Extended
Sequence Number support with the peer, the default is
<b>noesn.</b></p>

<p style="margin-left:11%;"><b>forceencaps</b> = yes |
<b>no</b></p>

<p style="margin-left:22%;">force UDP encapsulation for ESP
packets even if no NAT situation is detected. This may help
to surmount restrictive firewalls. In order to force the
peer to encapsulate packets, NAT detection payloads are
faked.</p>

<p style="margin-left:11%;"><b>fragmentation</b> = yes |
force | <b>no</b></p>

<p style="margin-left:22%;">whether to use IKE
fragmentation (proprietary IKEv1 extension or IKEv2
fragmentation as per RFC 7383). Acceptable values are
<b>yes</b>, <b>force</b> and <b>no</b> (the default).
Fragmented IKE messages sent by a peer are always accepted
irrespective of the value of this option. If set to
<b>yes</b>, and the peer supports it, larger IKE messages
will be sent in fragments. If set to <b>force</b> (only
supported for IKEv1) the initial IKE message will already be
fragmented if required.</p>

<p style="margin-left:11%;"><b>ike</b> = &lt;cipher
suites&gt;</p>

<p style="margin-left:22%;">comma-separated list of
IKE/ISAKMP SA encryption/authentication algorithms to be
used, e.g. <b>aes128-sha1-modp2048</b>. The notation is
<b>encryption-integrity[-prf]-dhgroup</b>. If no PRF is
given, the algorithms defined for integrity are used for the
PRF. The prf keywords are the same as the integrity
algorithms, but have a <b>prf</b> prefix (such as
<b>prfsha1</b>, <b>prfsha256</b> or <b>prfaesxcbc</b>). <br>
In IKEv2, multiple algorithms and proposals may be included,
such as
<b>aes128-aes256-sha1-modp1536-modp2048,3des-sha1-md5-modp1024</b>.</p>

<p style="margin-left:22%; margin-top: 1em">Defaults to
<b>aes128-sha1-modp2048,3des-sha1-modp1536</b>. The daemon
adds its extensive default proposal to this default or the
configured value. To restrict it to the configured proposal
an exclamation mark (<b>!</b>) can be added at the end.</p>

<p style="margin-left:22%; margin-top: 1em"><b>Note</b>: As
a responder the daemon accepts the first supported proposal
received from the peer. In order to restrict a responder to
only accept specific cipher suites, the strict flag
(<b>!</b>, exclamation mark) can be used, e.g:
<b>aes256-sha512-modp4096!</b></p>

<p style="margin-left:11%;"><b>ikedscp</b> = <b>000000</b>
| &lt;DSCP field&gt;</p>

<p style="margin-left:22%;">Differentiated Services Field
Codepoint to set on outgoing IKE packets sent from this
connection. The value is a six digit binary encoded string
defining the Codepoint to set, as defined in RFC 2474.</p>

<p style="margin-left:11%;"><b>ikelifetime</b> = <b>3h</b>
| &lt;time&gt;</p>

<p style="margin-left:22%;">how long the keying channel of
a connection (ISAKMP or IKE SA) should last before being
renegotiated. Also see EXPIRY/REKEY below.</p>

<p style="margin-left:11%;"><b>installpolicy</b> =
<b>yes</b> | no</p>

<p style="margin-left:22%;">decides whether IPsec policies
are installed in the kernel by the charon daemon for a given
connection. Allows peaceful cooperation e.g. with the Mobile
IPv6 daemon mip6d who wants to control the kernel policies.
Acceptable values are <b>yes</b> (the default) and
<b>no</b>.</p>

<p style="margin-left:11%;"><b>keyexchange</b> = <b>ike</b>
| ikev1 | ikev2</p>

<p style="margin-left:22%;">which key exchange protocol
should be used to initiate the connection. Connections
marked with <b>ike</b> use IKEv2 when initiating, but accept
any protocol version when responding.</p>

<p style="margin-left:11%;"><b>keyingtries</b> = <b>3</b> |
&lt;number&gt; | %forever</p>

<p style="margin-left:22%;">how many attempts (a whole
number or <b>%forever</b>) should be made to negotiate a
connection, or a replacement for one, before giving up
(default <b>3</b>). The value <b>%forever</b> means
&rsquo;never give up&rsquo;. Relevant only locally, other
end need not agree on it.</p>

<p style="margin-left:11%;"><b>keylife</b></p>

<p style="margin-left:22%;">synonym for
<b>lifetime</b>.</p>

<p style="margin-left:11%;"><b>left</b> = &lt;ip
address&gt; | &lt;fqdn&gt; | <b>%any</b> | &lt;range&gt; |
&lt;subnet&gt;</p>

<p style="margin-left:22%;">The IP address of the left
participant&rsquo;s public-network interface or one of
several magic values. The value <b>%any</b> (the default)
for the local endpoint signifies an address to be filled in
(by automatic keying) during negotiation. If the local peer
initiates the connection setup the routing table will be
queried to determine the correct local IP address. In case
the local peer is responding to a connection setup then any
IP address that is assigned to a local interface will be
accepted.</p>

<p style="margin-left:22%; margin-top: 1em">The prefix
<b>%</b> in front of a fully-qualified domain name or an IP
address will implicitly set <b>leftallowany</b>=yes.</p>

<p style="margin-left:22%; margin-top: 1em">If <b>%any</b>
is used for the remote endpoint it literally means any IP
address.</p>

<p style="margin-left:22%; margin-top: 1em">To limit the
connection to a specific range of hosts, a range (
<b>10.1.0.0-10.2.255.255</b> ) or a subnet (
<b>10.1.0.0/16</b> ) can be specified, and multiple
addresses, ranges and subnets can be separated by commas.
While one can freely combine these items, to initiate the
connection at least one non-range/subnet is required.</p>

<p style="margin-left:22%; margin-top: 1em">Please note
that with the usage of wildcards multiple connection
descriptions might match a given incoming connection
attempt. The most specific description is used in that
case.</p>

<p style="margin-left:11%;"><b>leftallowany</b> = yes |
<b>no</b></p>

<p style="margin-left:22%;">a modifier for <b>left</b>,
making it behave as <b>%any</b> although a concrete IP
address or domain name has been assigned.</p>

<p style="margin-left:11%;"><b>leftauth</b> = &lt;auth
method&gt;</p>

<p style="margin-left:22%;">Authentication method to use
locally (left) or require from the remote (right) side.
Acceptable values are <b>pubkey</b> for public key
authentication (RSA/ECDSA), <b>psk</b> for pre-shared key
authentication, <b>eap</b> to (require the) use of the
Extensible Authentication Protocol in IKEv2, and
<b>xauth</b> for IKEv1 eXtended Authentication.</p>

<p style="margin-left:22%; margin-top: 1em">To require a
trustchain public key strength for the remote side, specify
the key type followed by the minimum strength in bits (for
example <b>ecdsa-384</b> or <b>rsa-2048-ecdsa-256</b>). To
limit the acceptable set of hashing algorithms for
trustchain validation, append hash algorithms to
<b>pubkey</b> or a key strength definition (for example
<b>pubkey-sha1-sha256</b> or
<b>rsa-2048-ecdsa-256-sha256-sha384-sha512</b>). Unless
disabled in <b>strongswan.conf</b>(5) such key types and
hash algorithms are also applied as constraints against
IKEv2 signature authentication schemes used by the remote
side.</p>

<p style="margin-left:22%; margin-top: 1em">If both peers
support RFC 7427 (&quot;Signature Authentication in
IKEv2&quot;) specific hash algorithms to be used during
IKEv2 authentication may be configured. The syntax is the
same as above. For example, with <b>pubkey-sha384-sha256</b>
a public key signature scheme with either SHA-384 or SHA-256
would get used for authentication, in that order and
depending on the hash algorithms supported by the peer. If
no specific hash algorithms are configured, the default is
to prefer an algorithm that matches or exceeds the strength
of the signature key.</p>

<p style="margin-left:22%; margin-top: 1em">For <b>eap</b>,
an optional EAP method can be appended. Currently defined
methods are <b>eap-aka</b>, <b>eap-gtc</b>, <b>eap-md5</b>,
<b>eap-mschapv2</b>, <b>eap-peap</b>, <b>eap-sim</b>,
<b>eap-tls</b>, <b>eap-ttls</b>, <b>eap-dynamic</b>, and
<b>eap-radius</b>. Alternatively, IANA assigned EAP method
numbers are accepted. Vendor specific EAP methods are
defined in the form <b>eap-type-vendor</b> (e.g.
<b>eap-7-12345</b>). To specify signature and trust chain
constraints for EAP-(T)TLS, append a colon to the EAP
method, followed by the key type/size and hash algorithm as
discussed above. For <b>xauth,</b> an XAuth authentication
backend can be specified, such as <b>xauth-generic</b> or
<b>xauth-eap</b>. If XAuth is used in <b>leftauth</b>,
Hybrid authentication is used. For traditional XAuth
authentication, define XAuth in <b>lefauth2</b>.</p>

<p style="margin-left:11%;"><b>leftauth2</b> = &lt;auth
method&gt;</p>

<p style="margin-left:22%;">Same as <b>leftauth</b>, but
defines an additional authentication exchange. In IKEv1,
only XAuth can be used in the second authentication round.
IKEv2 supports multiple complete authentication rounds using
&quot;Multiple Authentication Exchanges&quot; defined in RFC
4739. This allows, for example, separated authentication of
host and user.</p>

<p style="margin-left:11%;"><b>leftca</b> = &lt;issuer
dn&gt; | %same</p>

<p style="margin-left:22%;">the distinguished name of a
certificate authority which is required to lie in the trust
path going from the left participant&rsquo;s certificate up
to the root certification authority. <b>%same</b> means that
the value configured for the right participant should be
reused.</p>

<p style="margin-left:11%;"><b>leftca2</b> = &lt;issuer
dn&gt; | %same</p>

<p style="margin-left:22%;">Same as <b>leftca</b>, but for
the second authentication round (IKEv2 only).</p>

<p style="margin-left:11%;"><b>leftcert</b> =
&lt;path&gt;</p>

<p style="margin-left:22%;">the path to the left
participant&rsquo;s X.509 certificate. The file can be
encoded either in PEM or DER format. OpenPGP certificates
are supported as well. Both absolute paths or paths relative
to <i>/etc/ipsec.d/certs</i> are accepted. By default
<b>leftcert</b> sets <b>leftid</b> to the distinguished name
of the certificate&rsquo;s subject. The left
participant&rsquo;s ID can be overridden by specifying a
<b>leftid</b> value which must be certified by the
certificate, though. <br>
A value in the form <b>%smartcard[&lt;slot
nr&gt;[@&lt;module&gt;]]:&lt;keyid&gt;</b> defines a
specific certificate to load from a PKCS#11 backend for this
connection. See ipsec.secrets(5) for details about smartcard
definitions. <b>leftcert</b> is required only if selecting
the certificate with <b>leftid</b> is not sufficient, for
example if multiple certificates use the same subject. <br>
Multiple certificate paths or PKCS#11 backends can be
specified in a comma separated list. The daemon chooses the
certificate based on the received certificate requests if
possible before enforcing the first.</p>

<p style="margin-left:11%;"><b>leftcert2</b> =
&lt;path&gt;</p>

<p style="margin-left:22%;">Same as <b>leftcert,</b> but
for the second authentication round (IKEv2 only).</p>

<p style="margin-left:11%;"><b>leftcertpolicy</b> =
&lt;OIDs&gt;</p>

<p style="margin-left:22%;">Comma separated list of
certificate policy OIDs the peer&rsquo;s certificate must
have. OIDs are specified using the numerical dotted
representation.</p>

<p style="margin-left:11%;"><b>leftdns</b> =
&lt;servers&gt;</p>

<p style="margin-left:22%;">Comma separated list of DNS
server addresses to exchange as configuration attributes. On
the initiator, a server is a fixed IPv4/IPv6 address, or
<b>%config4</b>/<b>%config6</b> to request attributes
without an address. On the responder, only fixed IPv4/IPv6
addresses are allowed and define DNS servers assigned to the
client.</p>

<p style="margin-left:11%;"><b>leftfirewall</b> = yes |
<b>no</b></p>

<p style="margin-left:22%;">whether the left participant is
doing forwarding-firewalling (including masquerading) using
iptables for traffic from <i>leftsubnet</i>, which should be
turned off (for traffic to the other subnet) once the
connection is established; acceptable values are <b>yes</b>
and <b>no</b> (the default). May not be used in the same
connection description with <b>leftupdown</b>. Implemented
as a parameter to the default <b>ipsec _updown</b> script.
See notes below. Relevant only locally, other end need not
agree on it.</p>

<p style="margin-left:22%; margin-top: 1em">If one or both
security gateways are doing forwarding firewalling (possibly
including masquerading), and this is specified using the
firewall parameters, tunnels established with IPsec are
exempted from it so that packets can flow unchanged through
the tunnels. (This means that all subnets connected in this
manner must have distinct, non-overlapping subnet address
blocks.) This is done by the default <b>ipsec _updown</b>
script.</p>

<p style="margin-left:22%; margin-top: 1em">In situations
calling for more control, it may be preferable for the user
to supply his own <i>updown</i> script, which makes the
appropriate adjustments for his system.</p>

<p style="margin-left:11%;"><b>leftgroups</b> = &lt;group
list&gt;</p>

<p style="margin-left:22%;">a comma separated list of group
names. If the <b>leftgroups</b> parameter is present then
the peer must be a member of at least one of the groups
defined by the parameter.</p>

<p style="margin-left:11%;"><b>leftgroups2</b> = &lt;group
list&gt;</p>

<p style="margin-left:22%;">Same as <b>leftgroups,</b> but
for the second authentication round defined with
<b>leftauth2.</b></p>

<p style="margin-left:11%;"><b>lefthostaccess</b> = yes |
<b>no</b></p>

<p style="margin-left:22%;">inserts a pair of INPUT and
OUTPUT iptables rules using the default <b>ipsec _updown</b>
script, thus allowing access to the host itself in the case
where the host&rsquo;s internal interface is part of the
negotiated client subnet. Acceptable values are <b>yes</b>
and <b>no</b> (the default).</p>

<p style="margin-left:11%;"><b>leftid</b> = &lt;id&gt;</p>

<p style="margin-left:22%;">how the left participant should
be identified for authentication; defaults to <b>left</b> or
the subject of the certificate configured with
<b>leftcert</b>. If <b>leftcert</b> is configured the
identity has to be confirmed by the certificate.</p>

<p style="margin-left:22%; margin-top: 1em">Can be an IP
address, a fully-qualified domain name, an email address or
a Distinguished Name for which the ID type is determined
automatically and the string is converted to the appropriate
encoding. To enforce a specific identity type, a prefix may
be used, followed by a colon (:). If the number sign (#)
follows the colon, the remaining data is interpreted as hex
encoding, otherwise the string is used as-is as the
identification data. Note that this implies that no
conversion is performed for non-string identities. For
example, <i>ipv4:10.0.0.1</i> does not create a valid
ID_IPV4_ADDR IKE identity, as it does not get converted to
binary 0x0a000001. Instead, one could use
<i>ipv4:#0a000001</i> to get a valid identity, but just
using the implicit type with automatic conversion is usually
simpler. The same applies to the ASN1 encoded types. The
following prefixes are known: <b>ipv4</b>, <b>ipv6</b>,
<b>rfc822</b>, <b>email</b>, <b>userfqdn</b>, <b>fqdn</b>,
<b>dns</b>, <b>asn1dn</b>, <b>asn1gn</b> and <b>keyid</b>.
Custom type prefixes may be specified by surrounding the
numerical type value by curly brackets.</p>

<p style="margin-left:22%; margin-top: 1em">For IKEv2 and
<b>rightid</b> the prefix <b>%</b> in front of the identity
prevents the daemon from sending IDr in its IKE_AUTH request
and will allow it to verify the configured identity against
the subject and subjectAltNames contained in the
responder&rsquo;s certificate (otherwise it is only compared
with the IDr returned by the responder). The IDr sent by the
initiator might otherwise prevent the responder from finding
a config if it has configured a different value for
<b>leftid</b>.</p>

<p style="margin-left:11%;"><b>leftid2</b> = &lt;id&gt;</p>

<p style="margin-left:22%;">identity to use for a second
authentication for the left participant (IKEv2 only);
defaults to <b>leftid</b>.</p>

<p style="margin-left:11%;"><b>leftikeport</b> =
&lt;port&gt;</p>

<p style="margin-left:22%;">UDP port the left participant
uses for IKE communication. If unspecified, port 500 is used
with the port floating to 4500 if a NAT is detected or
MOBIKE is enabled. Specifying a local IKE port different
from the default additionally requires a socket
implementation that listens on this port.</p>

<p style="margin-left:11%;"><b>leftprotoport</b> =
&lt;protocol&gt;/&lt;port&gt;</p>

<p style="margin-left:22%;">restrict the traffic selector
to a single protocol and/or port. This option is now
deprecated, protocol/port information can be defined for
each subnet directly in <b>leftsubnet</b>.</p>

<p style="margin-left:11%;"><b>leftsigkey</b> = &lt;raw
public key&gt; | &lt;path to public key&gt;</p>

<p style="margin-left:22%;">the left participant&rsquo;s
public key for public key signature authentication, in
PKCS#1 format using hex (0x prefix) or base64 (0s prefix)
encoding. With the optional <b>dns:</b> or <b>ssh:</b>
prefix in front of 0x or 0s, the public key is expected to
be in either the RFC 3110 (not the full RR, only RSA key
part) or RFC 4253 public key format, respectively. Also
accepted is the path to a file containing the public key in
PEM, DER or SSH encoding. Both absolute paths or paths
relative to <i>/etc/ipsec.d/certs</i> are accepted.</p>

<p style="margin-left:11%;"><b>leftsendcert</b> = never |
no | <b>ifasked</b> | always | yes</p>

<p style="margin-left:22%;">Accepted values are
<b>never</b> or <b>no</b>, <b>always</b> or <b>yes</b>, and
<b>ifasked</b> (the default), the latter meaning that the
peer must send a certificate request payload in order to get
a certificate in return.</p>

<p style="margin-left:11%;"><b>leftsourceip</b> = %config4
| %config6 | &lt;ip address&gt;</p>

<p style="margin-left:22%;">Comma separated list of
internal source IPs to use in a tunnel, also known as
virtual IP. If the value is one of the synonyms
<b>%config</b>, <b>%cfg</b>, <b>%modeconfig</b>, or
<b>%modecfg</b>, an address (from the tunnel address family)
is requested from the peer. With <b>%config4</b> and
<b>%config6</b> an address of the given address family will
be requested explicitly. If an IP address is configured, it
will be requested from the responder, which is free to
respond with a different address.</p>

<p style="margin-left:11%;"><b>rightsourceip</b> = %config
| &lt;network&gt;/&lt;netmask&gt; | &lt;from&gt;-&lt;to&gt;
| %poolname</p>

<p style="margin-left:22%;">Comma separated list of
internal source IPs to use in a tunnel for the remote peer.
If the value is <b>%config</b> on the responder side, the
initiator must propose an address which is then echoed back.
Also supported are address pools expressed as
<i>network</i><b>/</b><i>netmask</i> and
<i>from</i><b>-</b><i>to</i> or the use of an external IP
address pool using %<i>poolname</i>, where <i>poolname</i>
is the name of the IP address pool used for the lookup.</p>

<p style="margin-left:11%;"><b>leftsubnet</b> = &lt;ip
subnet&gt;[[&lt;proto/port&gt;]][,...]</p>

<p style="margin-left:22%;">private subnet behind the left
participant, expressed as
<i>network</i><b>/</b><i>netmask</i>; if omitted,
essentially assumed to be <i>left</i><b>/32</b>, signifying
that the left end of the connection goes to the left
participant only. Configured subnets of the peers may
differ, the protocol narrows it to the greatest common
subnet. In IKEv1, this may lead to problems with other
implementations, make sure to configure identical subnets in
such configurations. IKEv2 supports multiple subnets
separated by commas. IKEv1 only interprets the first subnet
of such a definition, unless the Cisco Unity extension
plugin is enabled.</p>

<p style="margin-left:22%; margin-top: 1em">The optional
part after each subnet enclosed in square brackets specifies
a protocol/port to restrict the selector for that
subnet.</p>

<p style="margin-left:22%; margin-top: 1em">Examples:
<b>leftsubnet=10.0.0.1[tcp/http],10.0.0.2[6/80]</b> or
<b>leftsubnet=fec1::1[udp],10.0.0.0/16[/53]</b>. Instead of
omitting either value <b>%any</b> can be used to the same
effect, e.g.
<b>leftsubnet=fec1::1[udp/%any],10.0.0.0/16[%any/53]</b>.</p>

<p style="margin-left:22%; margin-top: 1em">If the protocol
is <b>icmp</b> or <b>ipv6-icmp</b> the port is interpreted
as ICMP message type if it is less than 256 or as type and
code if it is greater or equal to 256, with the type in the
most significant 8 bits and the code in the least
significant 8 bits.</p>

<p style="margin-left:22%; margin-top: 1em">The port value
can alternatively take the value <b>%opaque</b> for RFC 4301
OPAQUE selectors, or a numerical range in the form
<b>1024-65535</b>. None of the kernel backends currently
supports opaque or port ranges and uses <b>%any</b> for
policy installation instead.</p>

<p style="margin-left:22%; margin-top: 1em">Instead of
specifying a subnet, <b>%dynamic</b> can be used to replace
it with the IKE address, having the same effect as omitting
<b>leftsubnet</b> completely. Using <b>%dynamic</b> can be
used to define multiple dynamic selectors, each having a
potentially different protocol/port definition.</p>

<p style="margin-left:11%;"><b>leftupdown</b> =
&lt;path&gt;</p>

<p style="margin-left:22%;">what
&lsquo;&lsquo;updown&rsquo;&rsquo; script to run to adjust
routing and/or firewalling when the status of the connection
changes (default <b>ipsec _updown</b>). May include
positional parameters separated by white space (although
this requires enclosing the whole string in quotes);
including shell metacharacters is unwise. Relevant only
locally, other end need not agree on it. Charon uses the
updown script to insert firewall rules only, since routing
has been implemented directly into the daemon.</p>

<p style="margin-left:11%;"><b>lifebytes</b> =
&lt;number&gt;</p>

<p style="margin-left:22%;">the number of bytes transmitted
over an IPsec SA before it expires.</p>

<p style="margin-left:11%;"><b>lifepackets</b> =
&lt;number&gt;</p>

<p style="margin-left:22%;">the number of packets
transmitted over an IPsec SA before it expires.</p>

<p style="margin-left:11%;"><b>lifetime</b> = <b>1h</b> |
&lt;time&gt;</p>

<p style="margin-left:22%;">how long a particular instance
of a connection (a set of encryption/authentication keys for
user packets) should last, from successful negotiation to
expiry; acceptable values are an integer optionally followed
by <b>s</b> (a time in seconds) or a decimal number followed
by <b>m</b>, <b>h</b>, or <b>d</b> (a time in minutes,
hours, or days respectively) (default <b>1h</b>, maximum
<b>24h</b>). Normally, the connection is renegotiated (via
the keying channel) before it expires (see
<b>margintime</b>). The two ends need not exactly agree on
<b>lifetime</b>, although if they do not, there will be some
clutter of superseded connections on the end which thinks
the lifetime is longer. Also see EXPIRY/REKEY below.</p>

<p style="margin-left:11%;"><b>marginbytes</b> =
&lt;number&gt;</p>

<p style="margin-left:22%;">how many bytes before IPsec SA
expiry (see <b>lifebytes</b>) should attempts to negotiate a
replacement begin.</p>

<p style="margin-left:11%;"><b>marginpackets</b> =
&lt;number&gt;</p>

<p style="margin-left:22%;">how many packets before IPsec
SA expiry (see <b>lifepackets</b>) should attempts to
negotiate a replacement begin.</p>

<p style="margin-left:11%;"><b>margintime</b> = <b>9m</b> |
&lt;time&gt;</p>

<p style="margin-left:22%;">how long before connection
expiry or keying-channel expiry should attempts to negotiate
a replacement begin; acceptable values as for
<b>lifetime</b> (default <b>9m</b>). Relevant only locally,
other end need not agree on it. Also see EXPIRY/REKEY
below.</p>

<p style="margin-left:11%;"><b>mark</b> =
&lt;value&gt;[/&lt;mask&gt;]</p>

<p style="margin-left:22%;">sets an XFRM mark in the
inbound and outbound IPsec SAs and policies. If the mask is
missing then a default mask of <b>0xffffffff</b> is assumed.
The special value <b>%unique</b> assigns a unique value to
each newly created IPsec SA.</p>

<p style="margin-left:11%;"><b>mark_in</b> =
&lt;value&gt;[/&lt;mask&gt;]</p>

<p style="margin-left:22%;">sets an XFRM mark in the
inbound IPsec SA and policy. If the mask is missing then a
default mask of <b>0xffffffff</b> is assumed.</p>

<p style="margin-left:11%;"><b>mark_out</b> =
&lt;value&gt;[/&lt;mask&gt;]</p>

<p style="margin-left:22%;">sets an XFRM mark in the
outbound IPsec SA and policy. If the mask is missing then a
default mask of <b>0xffffffff</b> is assumed.</p>

<p style="margin-left:11%;"><b>mobike</b> = <b>yes</b> |
no</p>

<p style="margin-left:22%;">enables the IKEv2 MOBIKE
protocol defined by RFC 4555. Accepted values are <b>yes</b>
(the default) and <b>no</b>. If set to <b>no</b>, the charon
daemon will not actively propose MOBIKE as initiator and
ignore the MOBIKE_SUPPORTED notify as responder.</p>

<p style="margin-left:11%;"><b>modeconfig</b> = push |
<b>pull</b></p>

<p style="margin-left:22%;">defines which mode is used to
assign a virtual IP. Accepted values are <b>push</b> and
<b>pull</b> (the default). Push mode is currently not
supported with IKEv2.</p>

<p style="margin-left:11%;"><b>reauth</b> = <b>yes</b> |
no</p>

<p style="margin-left:22%;">whether rekeying of an IKE_SA
should also reauthenticate the peer. In IKEv1,
reauthentication is always done. In IKEv2, a value of
<b>no</b> rekeys without uninstalling the IPsec SAs, a value
of <b>yes</b> (the default) creates a new IKE_SA from
scratch and tries to recreate all IPsec SAs.</p>

<p style="margin-left:11%;"><b>rekey</b> = <b>yes</b> |
no</p>

<p style="margin-left:22%;">whether a connection should be
renegotiated when it is about to expire; acceptable values
are <b>yes</b> (the default) and <b>no</b>. The two ends
need not agree, but while a value of <b>no</b> prevents
charon from requesting renegotiation, it does not prevent
responding to renegotiation requested from the other end, so
<b>no</b> will be largely ineffective unless both ends agree
on it. Also see <b>reauth</b>.</p>

<p style="margin-left:11%;"><b>rekeyfuzz</b> = <b>100%</b>
| &lt;percentage&gt;</p>

<p style="margin-left:22%;">maximum percentage by which
<b>marginbytes</b>, <b>marginpackets</b> and
<b>margintime</b> should be randomly increased to randomize
rekeying intervals (important for hosts with many
connections); acceptable values are an integer, which may
exceed 100, followed by a &lsquo;%&rsquo; (defaults to
<b>100%</b>). The value of <b>marginTYPE</b>, after this
random increase, must not exceed <b>lifeTYPE</b> (where TYPE
is one of <i>bytes</i>, <i>packets</i> or <i>time</i>). The
value <b>0%</b> will suppress randomization. Relevant only
locally, other end need not agree on it. Also see
EXPIRY/REKEY below.</p>

<p style="margin-left:11%;"><b>rekeymargin</b></p>

<p style="margin-left:22%;">synonym for
<b>margintime</b>.</p>

<p style="margin-left:11%;"><b>replay_window</b> =
<b>&minus;1</b> | &lt;number&gt;</p>

<p style="margin-left:22%;">The IPsec replay window size
for this connection. With the default of &minus;1 the value
configured with <i>charon.replay_window</i> in
<b>strongswan.conf</b>(5) is used. Larger values than 32 are
supported using the Netlink backend only, a value of 0
disables IPsec replay protection.</p>

<p style="margin-left:11%;"><b>reqid</b> =
&lt;number&gt;</p>

<p style="margin-left:22%;">sets the reqid for a given
connection to a pre-configured fixed value.</p>

<p style="margin-left:11%;"><b>tfc</b> = &lt;value&gt;</p>

<p style="margin-left:22%;">number of bytes to pad ESP
payload data to. Traffic Flow Confidentiality is currently
supported in IKEv2 and applies to outgoing packets only. The
special value <b>%mtu</b> fills up ESP packets with padding
to have the size of the MTU.</p>

<p style="margin-left:11%;"><b>type</b> = <b>tunnel</b> |
transport | transport_proxy | passthrough | drop</p>

<p style="margin-left:22%;">the type of the connection;
currently the accepted values are <b>tunnel</b> (the
default) signifying a host-to-host, host-to-subnet, or
subnet-to-subnet tunnel; <b>transport</b>, signifying
host-to-host transport mode; <b>transport_proxy</b>,
signifying the special Mobile IPv6 transport proxy mode;
<b>passthrough</b>, signifying that no IPsec processing
should be done at all; <b>drop</b>, signifying that packets
should be discarded.</p>

<p style="margin-left:11%;"><b>xauth</b> = <b>client</b> |
server</p>

<p style="margin-left:22%;">specifies the role in the XAuth
protocol if activated by <b>authby=xauthpsk</b> or
<b>authby=xauthrsasig.</b> Accepted values are <b>server</b>
and <b>client</b> (the default).</p>

<p style="margin-left:11%;"><b>xauth_identity</b> =
&lt;id&gt;</p>

<p style="margin-left:22%;">defines the identity/username
the client uses to reply to an XAuth request. If not
defined, the IKEv1 identity will be used as XAuth
identity.</p>

<p style="margin-left:11%; margin-top: 1em"><b>CONN
PARAMETERS: IKEv2 MEDIATION EXTENSION</b> <br>
The following parameters are relevant to IKEv2 Mediation
Extension operation only. <b><br>
mediation</b> = yes | <b>no</b></p>

<p style="margin-left:22%;">whether this connection is a
mediation connection, ie. whether this connection is used to
mediate other connections. Mediation connections create no
child SA. Acceptable values are <b>no</b> (the default) and
<b>yes</b>.</p>

<p style="margin-left:11%;"><b>mediated_by</b> =
&lt;name&gt;</p>

<p style="margin-left:22%;">the name of the connection to
mediate this connection through. If given, the connection
will be mediated through the named mediation connection. The
mediation connection must set <b>mediation=yes</b>.</p>

<p style="margin-left:11%;"><b>me_peerid</b> =
&lt;id&gt;</p>

<p style="margin-left:22%;">ID as which the peer is known
to the mediation server, ie. which the other end of this
connection uses as its <b>leftid</b> on its connection to
the mediation server. This is the ID we request the
mediation server to mediate us with. If <b>me_peerid</b> is
not given, the <b>rightid</b> of this connection will be
used as peer ID.</p>

<h2>CA SECTIONS
<a name="CA SECTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">These are
optional sections that can be used to assign special
parameters to a Certification Authority (CA). Because the
daemons automatically import CA certificates from
<i>/etc/ipsec.d/cacerts</i>, there is no need to explicitly
add them with a CA section, unless you want to assign
special parameters (like a CRL) to a CA. <b><br>
also</b> = &lt;name&gt;</p>

<p style="margin-left:22%;">includes ca section
<b>&lt;name&gt;</b>.</p>

<p style="margin-left:11%;"><b>auto</b> = <b>ignore</b> |
add</p>

<p style="margin-left:22%;">currently can have either the
value <b>ignore</b> (the default) or <b>add</b>.</p>

<p style="margin-left:11%;"><b>cacert</b> =
&lt;path&gt;</p>

<p style="margin-left:22%;">defines a path to the CA
certificate either relative to <i>/etc/ipsec.d/cacerts</i>
or as an absolute path. <br>
A value in the form <b>%smartcard[&lt;slot
nr&gt;[@&lt;module&gt;]]:&lt;keyid&gt;</b> defines a
specific CA certificate to load from a PKCS#11 backend for
this CA. See ipsec.secrets(5) for details about smartcard
definitions.</p>

<p style="margin-left:11%;"><b>crluri</b> = &lt;uri&gt;</p>

<p style="margin-left:22%;">defines a CRL distribution
point (ldap, http, or file URI)</p>

<p style="margin-left:11%;"><b>crluri1</b></p>

<p style="margin-left:22%;">synonym for <b>crluri.</b></p>

<p style="margin-left:11%;"><b>crluri2</b> =
&lt;uri&gt;</p>

<p style="margin-left:22%;">defines an alternative CRL
distribution point (ldap, http, or file URI)</p>

<p style="margin-left:11%; margin-top: 1em"><b>ocspuri</b>
= &lt;uri&gt;</p>

<p style="margin-left:22%;">defines an OCSP URI.</p>

<p style="margin-left:11%;"><b>ocspuri1</b></p>

<p style="margin-left:22%;">synonym for <b>ocspuri.</b></p>

<p style="margin-left:11%;"><b>ocspuri2</b> =
&lt;uri&gt;</p>

<p style="margin-left:22%;">defines an alternative OCSP
URI.</p>

<p style="margin-left:11%;"><b>certuribase</b> =
&lt;uri&gt;</p>

<p style="margin-left:22%;">defines the base URI for the
Hash and URL feature supported by IKEv2. Instead of
exchanging complete certificates, IKEv2 allows one to send
an URI that resolves to the DER encoded certificate. The
certificate URIs are built by appending the SHA1 hash of the
DER encoded certificates to this base URI.</p>

<h2>CONFIG SECTIONS
<a name="CONFIG SECTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">At present, the
only <b>config</b> section known to the IPsec software is
the one named <b>setup</b>, which contains information used
when the software is being started. The currently-accepted
<i>parameter</i> names in a <b>config setup</b> section are:
<b><br>
cachecrls</b> = yes | <b>no</b></p>

<p style="margin-left:22%;">if enabled, certificate
revocation lists (CRLs) fetched via HTTP or LDAP will be
cached in <i>/etc/ipsec.d/crls/</i> under a unique file name
derived from the certification authority&rsquo;s public
key.</p>

<p style="margin-left:11%;"><b>charondebug</b> = &lt;debug
list&gt;</p>

<p style="margin-left:22%;">how much charon debugging
output should be logged. A comma separated list containing
type/level-pairs may be specified, e.g: <b>dmn 3, ike 1, net
-1.</b> Acceptable values for types are <b>dmn, mgr, ike,
chd, job, cfg, knl, net, asn, enc, lib, esp, tls, tnc, imc,
imv, pts</b> and the level is one of <b>-1, 0, 1, 2, 3,
4</b> (for silent, audit, control, controlmore, raw,
private). By default, the level is set to <b>1</b> for all
types. For more flexibility see LOGGER CONFIGURATION in
<i>strongswan.conf</i>(5).</p>

<p style="margin-left:11%;"><b>strictcrlpolicy</b> = yes |
ifuri | <b>no</b></p>

<p style="margin-left:22%;">defines if a fresh CRL must be
available in order for the peer authentication based on RSA
signatures to succeed. IKEv2 additionally recognizes
<b>ifuri</b> which reverts to <b>yes</b> if at least one CRL
URI is defined and to <b>no</b> if no URI is known.</p>

<p style="margin-left:11%;"><b>uniqueids</b> = <b>yes</b> |
no | never | replace | keep</p>

<p style="margin-left:22%;">whether a particular
participant ID should be kept unique, with any new IKE_SA
using an ID deemed to replace all old ones using that ID;
acceptable values are <b>yes</b> (the default), <b>no</b>
and <b>never</b>. Participant IDs normally <i>are</i>
unique, so a new IKE_SA using the same ID is almost
invariably intended to replace an old one. The difference
between <b>no</b> and <b>never</b> is that the daemon will
replace old IKE_SAs when receiving an INITIAL_CONTACT notify
if the option is <b>no</b> but will ignore these notifies if
<b>never</b> is configured. The daemon also accepts the
value <b>replace</b> which is identical to <b>yes</b> and
the value <b>keep</b> to reject new IKE_SA setups and keep
the duplicate established earlier.</p>

<h2>SA EXPIRY/REKEY
<a name="SA EXPIRY/REKEY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The IKE SAs and
IPsec SAs negotiated by the daemon can be configured to
expire after a specific amount of time. For IPsec SAs this
can also happen after a specified number of transmitted
packets or transmitted bytes. The following settings can be
used to configure this:</p>


<p style="margin-left:11%; margin-top: 1em"><b>Rekeying</b>
<br>
IKE SAs as well as IPsec SAs can be rekeyed before they
expire. This can be configured using the following
settings:</p>


<p style="margin-left:11%; margin-top: 1em"><b>Randomization</b>
<br>
To avoid collisions the specified margins are increased
randomly before subtracting them from the expiration limits
(see formula below). This is controlled by the
<b>rekeyfuzz</b> setting:</p>

<p style="margin-left:11%; margin-top: 1em">Randomization
can be disabled by setting <b>rekeyfuzz</b> to
<b>0%</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Formula</b>
<br>
The following formula is used to calculate the rekey time of
IPsec SAs:</p>

<pre style="margin-left:11%; margin-top: 1em"> rekeytime = lifetime - (margintime + random(0, margintime * rekeyfuzz))</pre>


<p style="margin-left:11%; margin-top: 1em">It applies
equally to IKE SAs and byte and packet limits for IPsec
SAs.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example</b>
<br>
Let&rsquo;s consider the default configuration:</p>

<pre style="margin-left:11%; margin-top: 1em">           lifetime = 1h
           margintime = 9m
           rekeyfuzz = 100%</pre>


<p style="margin-left:11%; margin-top: 1em">From the
formula above follows that the rekey time lies between:</p>

<pre style="margin-left:11%; margin-top: 1em">           rekeytime_min = 1h - (9m + 9m) = 42m
           rekeytime_max = 1h - (9m + 0m) = 51m</pre>


<p style="margin-left:11%; margin-top: 1em">Thus, the
daemon will attempt to rekey the IPsec SA at a random time
between 42 and 51 minutes after establishing the SA. Or, in
other words, between 9 and 18 minutes before the SA
expires.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Notes</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="10%"></td>
<td width="78%">


<p>Since the rekeying of an SA needs some time, the margin
values must not be too low.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="10%"></td>
<td width="78%">


<p>The value <b>margin... + margin... * rekeyfuzz</b> must
not exceed the original limit. For example, specifying
<b>margintime = 30m</b> in the default configuration is a
bad idea as there is a chance that the rekey time equals
zero and, thus, rekeying gets disabled.</p></td></tr>
</table>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">/etc/ipsec.conf
<br>
/etc/ipsec.d/aacerts <br>
/etc/ipsec.d/acerts <br>
/etc/ipsec.d/cacerts <br>
/etc/ipsec.d/certs <br>
/etc/ipsec.d/crls</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">strongswan.conf(5),
ipsec.secrets(5), ipsec(8)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Originally
written for the FreeS/WAN project by Henry Spencer. Updated
and extended for the strongSwan project
&lt;http://www.strongswan.org&gt; by Tobias Brunner, Andreas
Steffen and Martin Willi.</p>
<hr>
</body>
</html>
