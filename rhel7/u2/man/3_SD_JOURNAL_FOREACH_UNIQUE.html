<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:17:14 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SD_JOURNAL_QUERY_UNIQUE</title>

</head>
<body>

<h1 align="center">SD_JOURNAL_QUERY_UNIQUE</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">sd_journal_query_unique,
sd_journal_enumerate_unique, sd_journal_restart_unique,
SD_JOURNAL_FOREACH_UNIQUE &minus; Read unique data fields
from the journal</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;systemd/sd&minus;journal.h&gt;</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>int
sd_journal_query_unique(sd_journal&nbsp;*</b><i>j</i><b>,
const&nbsp;char&nbsp;*</b><i>field</i><b>);</b></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>int
sd_journal_enumerate_unique(sd_journal&nbsp;*</b><i>j</i><b>,
const&nbsp;void&nbsp;**</b><i>data</i><b>,
size_t&nbsp;*</b><i>length</i><b>);</b></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>void
sd_journal_restart_unique(sd_journal&nbsp;*</b><i>j</i><b>);</b></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">



<p style="margin-top: 1em"><b>SD_JOURNAL_FOREACH_UNIQUE(sd_journal&nbsp;*</b><i>j</i><b>,
const&nbsp;void&nbsp;*</b><i>data</i><b>,
size_t&nbsp;</b><i>length</i><b>);</b></p> </td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>sd_journal_query_unique()</b>
queries the journal for all unique values the specified
field can take. It takes two arguments: the journal to query
and the field name to look for. Well&minus;known field names
are listed on <b>systemd.journal-fields</b>(7). Field names
must be specified without a trailing '='. After this
function has been executed successfully the field values may
be queried using <b>sd_journal_enumerate_unique()</b>.
Invoking this call a second time will change the field name
being queried and reset the enumeration index to the first
field value that matches.</p>


<p style="margin-left:11%; margin-top: 1em"><b>sd_journal_enumerate_unique()</b>
may be used to iterate through all data fields which match
the previously selected field name as set with
<b>sd_journal_query_unique()</b>. On each invocation the
next field data matching the field name is returned. The
order of the returned data fields is not defined. It takes
three arguments: the journal context object, plus a pair of
pointers to pointer/size variables where the data object and
its size shall be stored in. The returned data is in a
read&minus;only memory map and is only valid until the next
invocation of <b>sd_journal_enumerate_unique()</b>. Note
that the data returned will be prefixed with the field name
and '='. Note that this call is subject to the data field
size threshold as controlled by
<b>sd_journal_set_data_threshold()</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>sd_journal_restart_unique()</b>
resets the data enumeration index to the beginning of the
list. The next invocation of
<b>sd_journal_enumerate_unique()</b> will return the first
field data matching the field name again.</p>

<p style="margin-left:11%; margin-top: 1em">Note that the
<b>SD_JOURNAL_FOREACH_UNIQUE()</b> macro may be used as a
handy wrapper around <b>sd_journal_restart_unique()</b> and
<b>sd_journal_enumerate_unique()</b>.</p>

<p style="margin-left:11%; margin-top: 1em">Note that these
functions currently are not influenced by matches set with
<b>sd_journal_add_match()</b> but this might change in a
later version of this software.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>sd_journal_query_unique()</b>
returns 0 on success or a negative errno&minus;style error
code. <b>sd_journal_enumerate_unique()</b> returns a
positive integer if the next field data has been read, 0
when no more fields are known, or a negative
errno&minus;style error code.
<b>sd_journal_restart_unique()</b> returns nothing.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>sd_journal_query_unique()</b>,
<b>sd_journal_enumerate_unique()</b> and
<b>sd_journal_restart_unique()</b> interfaces are available
as a shared library, which can be compiled and linked to
with the <b>libsystemd&nbsp;pkg-config</b>(1) file.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Use the
<b>SD_JOURNAL_FOREACH_UNIQUE</b> macro to iterate through
all values a field of the journal can take. The following
example lists all unit names referenced in the journal:</p>

<p style="margin-left:17%; margin-top: 1em">#include
&lt;stdio.h&gt; <br>
#include &lt;string.h&gt; <br>
#include &lt;systemd/sd&minus;journal.h&gt;</p>

<p style="margin-left:17%; margin-top: 1em">int main(int
argc, char *argv[]) { <br>
sd_journal *j; <br>
const void *d; <br>
size_t l; <br>
int r;</p>

<p style="margin-left:17%; margin-top: 1em">r =
sd_journal_open(&amp;j, SD_JOURNAL_LOCAL_ONLY); <br>
if (r &lt; 0) { <br>
fprintf(stderr, &quot;Failed to open journal: %s\n&quot;,
strerror(&minus;r)); <br>
return 1; <br>
} <br>
r = sd_journal_query_unique(j, &quot;_SYSTEMD_UNIT&quot;);
<br>
if (r &lt; 0) { <br>
fprintf(stderr, &quot;Failed to query journal: %s\n&quot;,
strerror(&minus;r)); <br>
return 1; <br>
} <br>
SD_JOURNAL_FOREACH_UNIQUE(j, d, l) <br>
printf(&quot;%.*s\n&quot;, (int) l, (const char*) d); <br>
sd_journal_close(j); <br>
return 0; <br>
}</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>systemd</b>(1),
<b>systemd.journal-fields</b>(7), <b>sd-journal</b>(3),
<b>sd_journal_open</b>(3), <b>sd_journal_get_data</b>(3),
<b>sd_journal_add_match</b>(3)</p>
<hr>
</body>
</html>
