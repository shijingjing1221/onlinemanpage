<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:03:08 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>ocsptool</title>

</head>
<body>

<h1 align="center">ocsptool</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ocsptool
&minus; GnuTLS OCSP tool</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>ocsptool</b>
[<b>&minus;</b><i>flag</i> [<i>value</i>]]...
[<b>&minus;&minus;</b><i>opt&minus;name</i>[[=|
]<i>value</i>]]...</p>

<p style="margin-left:11%; margin-top: 1em">All arguments
must be options.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Ocsptool is a
program that can parse and print information about OCSP
requests/responses, generate requests and verify
responses.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;d</b>
<i>number</i>, <b>&minus;&minus;debug</b>=<i>number</i></p>

<p style="margin-left:22%;">Enable debugging. This option
takes an integer number as its argument. The value of
<i>number</i> is constrained to being:</p>

<p style="margin-left:28%;">in the range 0 through 9999</p>

<p style="margin-left:22%; margin-top: 1em">Specifies the
debug level.</p>

<p style="margin-left:11%;"><b>&minus;V</b>,
<b>-&minus;verbose</b></p>

<p style="margin-left:22%;">More verbose output. This
option may appear an unlimited number of times.</p>


<p style="margin-left:11%;"><b>&minus;&minus;infile</b>=<i>file</i></p>

<p style="margin-left:22%;">Input file.</p>


<p style="margin-left:11%;"><b>&minus;&minus;outfile</b>=<i>string</i></p>

<p style="margin-left:22%;">Output file.</p>


<p style="margin-left:11%;"><b>&minus;&minus;ask</b>[=<i>server
name|url</i>]</p>

<p style="margin-left:22%;">Ask an OCSP/HTTP server on a
certificate validity. This option must appear in combination
with the following options: load-cert, load-issuer.</p>

<p style="margin-left:22%; margin-top: 1em">Connects to the
specified HTTP OCSP server and queries on the validity of
the loaded certificate.</p>

<p style="margin-left:11%;"><b>&minus;e</b>,
<b>-&minus;verify&minus;response</b></p>

<p style="margin-left:22%;">Verify response.</p>

<p style="margin-left:11%;"><b>&minus;i</b>,
<b>-&minus;request&minus;info</b></p>

<p style="margin-left:22%;">Print information on a OCSP
request.</p>

<p style="margin-left:11%;"><b>&minus;j</b>,
<b>-&minus;response&minus;info</b></p>

<p style="margin-left:22%;">Print information on a OCSP
response.</p>

<p style="margin-left:11%;"><b>&minus;q</b>,
<b>-&minus;generate&minus;request</b></p>

<p style="margin-left:22%;">Generate an OCSP request.</p>

<p style="margin-left:11%;"><b>&minus;&minus;nonce,
&minus;&minus;no&minus;nonce</b></p>

<p style="margin-left:22%;">Use (or not) a nonce to OCSP
request. The <i>no&minus;nonce</i> form will disable the
option.</p>


<p style="margin-left:11%;"><b>&minus;&minus;load&minus;issuer</b>=<i>file</i></p>

<p style="margin-left:22%;">Read issuer certificate from
file.</p>


<p style="margin-left:11%;"><b>&minus;&minus;load&minus;cert</b>=<i>file</i></p>

<p style="margin-left:22%;">Read certificate to check from
file.</p>


<p style="margin-left:11%;"><b>&minus;&minus;load&minus;trust</b>=<i>file</i></p>

<p style="margin-left:22%;">Read OCSP trust anchors from
file. This option must not appear in combination with any of
the following options: load-signer.</p>


<p style="margin-left:11%;"><b>&minus;&minus;load&minus;signer</b>=<i>file</i></p>

<p style="margin-left:22%;">Read OCSP response signer from
file. This option must not appear in combination with any of
the following options: load-trust.</p>

<p style="margin-left:11%;"><b>&minus;&minus;inder,
&minus;&minus;no&minus;inder</b></p>

<p style="margin-left:22%;">Use DER format for input
certificates and private keys. The <i>no&minus;inder</i>
form will disable the option.</p>

<p style="margin-left:11%;"><b>&minus;Q</b> <i>file</i>,
<b>&minus;&minus;load&minus;request</b>=<i>file</i></p>

<p style="margin-left:22%;">Read DER encoded OCSP request
from file.</p>

<p style="margin-left:11%;"><b>&minus;S</b> <i>file</i>,
<b>&minus;&minus;load&minus;response</b>=<i>file</i></p>

<p style="margin-left:22%;">Read DER encoded OCSP response
from file.</p>

<p style="margin-left:11%;"><b>&minus;h</b>,
<b>&minus;&minus;help</b></p>

<p style="margin-left:22%;">Display usage information and
exit.</p>

<p style="margin-left:11%;"><b>&minus;!</b>,
<b>&minus;&minus;more-help</b></p>

<p style="margin-left:22%;">Pass the extended usage
information through a pager.</p>

<p style="margin-left:11%;"><b>&minus;v</b>
[{<i>v|c|n</i>}],
<b>&minus;&minus;version</b>[={<i>v|c|n</i>}]</p>

<p style="margin-left:22%;">Output version of program and
exit. The default mode is &lsquo;v&rsquo;, a simple version.
The &lsquo;c&rsquo; mode will print copyright information
and &lsquo;n&rsquo; will print the full copyright
notice.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Print
information about an OCSP request</b></p>

<p style="margin-left:11%; margin-top: 1em">To parse an
OCSP request and print information about the content, the
<b>&minus;i</b> or <b>&minus;&minus;request&minus;info</b>
parameter may be used as follows. The <b>&minus;Q</b>
parameter specify the name of the file containing the OCSP
request, and it should contain the OCSP request in binary
DER format.</p>

<p style="margin-left:17%; margin-top: 1em">$ ocsptool
&minus;i &minus;Q ocsp&minus;request.der</p>

<p style="margin-left:11%; margin-top: 1em">The input file
may also be sent to standard input like this:</p>

<p style="margin-left:17%; margin-top: 1em">$ cat
ocsp&minus;request.der | ocsptool
&minus;&minus;request&minus;info</p>

<p style="margin-left:11%; margin-top: 1em"><b>Print
information about an OCSP response</b></p>

<p style="margin-left:11%; margin-top: 1em">Similar to
parsing OCSP requests, OCSP responses can be parsed using
the <b>&minus;j</b> or
<b>&minus;&minus;response&minus;info</b> as follows.</p>

<p style="margin-left:17%; margin-top: 1em">$ ocsptool
&minus;j &minus;Q ocsp&minus;response.der <br>
$ cat ocsp&minus;response.der | ocsptool
&minus;&minus;response&minus;info</p>

<p style="margin-left:11%; margin-top: 1em"><b>Generate an
OCSP request</b></p>

<p style="margin-left:11%; margin-top: 1em">The
<b>&minus;q</b> or
<b>&minus;&minus;generate&minus;request</b> parameters are
used to generate an OCSP request. By default the OCSP
request is written to standard output in binary DER format,
but can be stored in a file using
<b>&minus;&minus;outfile</b>. To generate an OCSP request
the issuer of the certificate to check needs to be specified
with <b>&minus;&minus;load&minus;issuer</b> and the
certificate to check with
<b>&minus;&minus;load&minus;cert</b>. By default PEM format
is used for these files, although <b>&minus;&minus;inder</b>
can be used to specify that the input files are in DER
format.</p>

<p style="margin-left:17%; margin-top: 1em">$ ocsptool
&minus;q &minus;&minus;load&minus;issuer issuer.pem
&minus;&minus;load&minus;cert client.pem
&minus;&minus;outfile ocsp&minus;request.der</p>

<p style="margin-left:11%; margin-top: 1em">When generating
OCSP requests, the tool will add an OCSP extension
containing a nonce. This behaviour can be disabled by
specifying <b>&minus;&minus;no&minus;nonce</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Verify
signature in OCSP response</b></p>

<p style="margin-left:11%; margin-top: 1em">To verify the
signature in an OCSP response the <b>&minus;e</b> or
<b>&minus;&minus;verify&minus;response</b> parameter is
used. The tool will read an OCSP response in DER format from
standard input, or from the file specified by
<b>&minus;&minus;load&minus;response</b>. The OCSP response
is verified against a set of trust anchors, which are
specified using <b>&minus;&minus;load&minus;trust</b>. The
trust anchors are concatenated certificates in PEM format.
The certificate that signed the OCSP response needs to be in
the set of trust anchors, or the issuer of the signer
certificate needs to be in the set of trust anchors and the
OCSP Extended Key Usage bit has to be asserted in the signer
certificate.</p>

<p style="margin-left:17%; margin-top: 1em">$ ocsptool
&minus;e &minus;&minus;load&minus;trust issuer.pem
&minus;&minus;load&minus;response
ocsp&minus;response.der</p>

<p style="margin-left:11%; margin-top: 1em">The tool will
print status of verification.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Verify
signature in OCSP response against given certificate</b></p>

<p style="margin-left:11%; margin-top: 1em">It is possible
to override the normal trust logic if you know that a
certain certificate is supposed to have signed the OCSP
response, and you want to use it to check the signature.
This is achieved using
<b>&minus;&minus;load&minus;signer</b> instead of
<b>&minus;&minus;load&minus;trust</b>. This will load one
certificate and it will be used to verify the signature in
the OCSP response. It will not check the Extended Key Usage
bit.</p>

<p style="margin-left:17%; margin-top: 1em">$ ocsptool
&minus;e &minus;&minus;load&minus;signer
ocsp&minus;signer.pem &minus;&minus;load&minus;response
ocsp&minus;response.der</p>

<p style="margin-left:11%; margin-top: 1em">This approach
is normally only relevant in two situations. The first is
when the OCSP response does not contain a copy of the signer
certificate, so the <b>&minus;&minus;load&minus;trust</b>
code would fail. The second is if you want to avoid the
indirect mode where the OCSP response signer certificate is
signed by a trust anchor.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Real&minus;world
example</b></p>

<p style="margin-left:11%; margin-top: 1em">Here is an
example of how to generate an OCSP request for a certificate
and to verify the response. For illustration we&rsquo;ll use
the <b>blog.josefsson.org</b> host, which (as of writing)
uses a certificate from CACert. First we&rsquo;ll use
<b>gnutls&minus;cli</b> to get a copy of the server
certificate chain. The server is not required to send this
information, but this particular one is configured to do
so.</p>

<p style="margin-left:17%; margin-top: 1em">$ echo |
gnutls&minus;cli &minus;p 443 blog.josefsson.org
&minus;&minus;print&minus;cert &gt; chain.pem</p>

<p style="margin-left:11%; margin-top: 1em">Use a text
editor on <b>chain.pem</b> to create three files for each
separate certificates, called <b>cert.pem</b> for the first
certificate for the domain itself, secondly
<b>issuer.pem</b> for the intermediate certificate and
<b>root.pem</b> for the final root certificate.</p>

<p style="margin-left:11%; margin-top: 1em">The domain
certificate normally contains a pointer to where the OCSP
responder is located, in the Authority Information Access
Information extension. For example, from <b>certtool
&minus;i &lt; cert.pem</b> there is this information:</p>

<p style="margin-left:17%; margin-top: 1em">Authority
Information Access Information (not critical): <br>
Access Method: 1.3.6.1.5.5.7.48.1 (id&minus;ad&minus;ocsp)
<br>
Access Location URI: http://ocsp.CAcert.org/</p>

<p style="margin-left:11%; margin-top: 1em">This means the
CA support OCSP queries over HTTP. We are now ready to
create a OCSP request for the certificate.</p>

<p style="margin-left:17%; margin-top: 1em">$ ocsptool
&minus;&minus;ask ocsp.CAcert.org
&minus;&minus;load&minus;issuer issuer.pem
&minus;&minus;load&minus;cert cert.pem &minus;&minus;outfile
ocsp&minus;response.der</p>

<p style="margin-left:11%; margin-top: 1em">The request is
sent via HTTP to the OCSP server address specified. If the
address is ommited ocsptool will use the address stored in
the certificate.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">One of the
following exit values will be returned: <b><br>
0</b> (EXIT_SUCCESS)</p>

<p style="margin-left:22%;">Successful program
execution.</p>

<p style="margin-left:11%;"><b>1</b> (EXIT_FAILURE)</p>

<p style="margin-left:22%;">The operation failed or the
command syntax was not valid.</p>

<p style="margin-left:11%;"><b>70</b> (EX_SOFTWARE)</p>

<p style="margin-left:22%;">libopts had an internal
operational error. Please report it to
autogen-users@lists.sourceforge.net. Thank you.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">certtool
(1)</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Nikos
Mavrogiannopoulos, Simon Josefsson and others; see
/usr/share/doc/gnutls/AUTHORS for a complete list.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright (C)
2000-2014 Free Software Foundation, and others all rights
reserved. This program is released under the terms of the
GNU General Public License, version 3 or later.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please send bug
reports to: bugs@gnutls.org</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This manual
page was <i>AutoGen</i>-erated from the <b>ocsptool</b>
option definitions.</p>
<hr>
</body>
</html>
