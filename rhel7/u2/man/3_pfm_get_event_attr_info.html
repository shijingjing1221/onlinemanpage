<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:07:28 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>LIBPFM</title>

</head>
<body>

<h1 align="center">LIBPFM</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN">RETURN</a><br>
<a href="#ERRORS">ERRORS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">pfm_get_event_attr_info
&minus; get event attribute information</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;perfmon/pfmlib.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
pfm_get_event_attr_info(int</b> <i>idx</i><b>, int</b>
<i>attr</i><b>, pfm_os_t</b> <i>os</i><b>,
pfm_event_attr_info_t *</b><i>info</i><b>);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This function
returns in <b>info</b> information about the attribute
designated by <b>attr</b> for the event specified in
<b>idx</b> and the os layer in <b>os</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>pfm_os_t</b> enumeration provides the following choices:
<b><br>
PFM_OS_NONE</b></p>

<p style="margin-left:22%;">The returned information
pertains only to what the PMU hardware exports. No operating
system attributes is taken into account.</p>

<p style="margin-left:11%;"><b>PFM_OS_PERF_EVENT</b></p>

<p style="margin-left:22%;">The returned information
includes the actual PMU hardware and the additional
attributes exported by the perf_events kernel interface. The
perf_event attributes pertain only the PMU hardware. In case
perf_events is not detected, an error is returned.</p>


<p style="margin-left:11%;"><b>PFM_OS_PERF_EVENT_EXT</b></p>

<p style="margin-left:22%;">The returned information
includes all of what is already provided by
<b>PFM_OS_PERF_EVENT</b> plus all the software attributes
controlled by perf_events, such as sampling period, precise
sampling.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>pfm_event_attr_info_t</b> structure is defined as
follows: <br>
typedef struct { <br>
const char *name; <br>
const char *desc; <br>
const char *equiv;</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>size_t</p><td width="23%"></td>
<td width="-15%"></td>
<td width="15%"></td>
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="54%">


<p>size;</p></td></tr>
</table>

<p style="margin-left:11%;">uint64_t code; <br>
pfm_attr_t type; <br>
int idx; <br>
pfm_attr_ctrl_t ctrl; <br>
int reserved1; <br>
struct { <br>
int is_dfl:1; <br>
int is_precise:1; <br>
int reserved:30; <br>
}; <br>
union { <br>
uint64_t dfl_val64; <br>
const char *dfl_str; <br>
int dfl_bool; <br>
int dfl_int; <br>
}; <br>
} pfm_event_attr_info_t;</p>

<p style="margin-left:11%; margin-top: 1em">The fields of
this structure are defined as follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>name</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>This is the name of the attribute. This is a read-only
string.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>desc</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>This is the description of the attribute. This is a
read-only string. It may contain multiple sentences.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>equiv</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>Certain attributes may be just variations of other
attributes for the same event. They may be provided as handy
shortcuts to avoid supplying a long list of attributes. For
those attributes, this field is not NULL and contains the
complete equivalent attribute string. This string, once
appended to the event name, may be used library calls
requiring an event string.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>code</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>This is the raw attribute code. For PFM_ATTR_UMASK, this
is the unit mask code. For all other attributes, this is an
opaque index.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>type</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>This is the type of the attribute. Attributes represent
either sub-events or extra filters that can be applied to
the event. Filters (also called modifiers) may be tied to
the event or the PMU register the event is programmed into.
The type of an attribute determines how it must be
specified. The following types are defined:</p></td></tr>
</table>

<p style="margin-left:22%;"><b>PFM_ATTR_UMASK</b></p>

<p style="margin-left:32%;">This is a unit mask, i.e., a
sub-event. It is specified using its name. Depending on the
event, it may be possible to specify multiple unit
masks.</p>

<p style="margin-left:22%;"><b>PFM_ATTR_MOD_BOOL</b></p>

<p style="margin-left:32%;">This is a boolean attribute. It
has a value of 0, 1, y or n. The value is specified after
the equal sign, e.g., foo=1. As a convenience, the equal
sign and value may be omitted, in which case this is
equivalent to =1.</p>


<p style="margin-left:22%;"><b>PFM_ATTR_MOD_INTEGER</b></p>

<p style="margin-left:32%;">This is an integer attribute.
It has a value which must be passed after the equal sign.
The range of valid values depends on the attribute and is
usually specified in its description.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>idx</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>This is the attribute index. It is identical to the
value of <b>attr</b> passed to the call and is provided for
completeness.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>size</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>This field contains the size of the struct passed. This
field is used to provide for extensibility of the struct
without compromising backward compatibility. The value
should be set to <b>sizeof(pfm_event_attr_info_t)</b>. If
instead, a value of <b>0</b> is specified, the library
assumes the struct passed is identical to the first ABI
version which size is <b>PFM_ATTR_INFO_ABI0</b>. Thus, if
fields were added after the first ABI, they will not be set
by the library. The library does check that bytes beyond
what is implemented are zeroes.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>is_dfl</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>This field indicates whether or not this attribute is
set by default. This applies mostly for PFM_ATTR_UMASK. If a
unit mask is marked as default, and no unit mask is
specified in the event string, then the library uses it by
default. Note that there may be multiple defaults per event
depending on how unit masks are grouped.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>is_precise</b></p>

<p style="margin-left:22%;">This field indicates whether or
not this umask supports precise sampling. Precise sampling
is a hardware mechanism that avoids instruction address skid
when using interrupt-based sampling. On Intel X86
processors, this field indicates that the umask supports
Precise Event-Based Sampling (PEBS).</p>

<p style="margin-left:11%;"><b>dfl_val64, dfl_str,
dfl_bool, dfl_int</b></p>

<p style="margin-left:22%;">This union contains the value
of an attribute. For PFM_ATTR_UMASK, the is the unit mask
code, for all other types this is the actual value of the
attribute.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><b>ctrl</b></p></td>
<td width="5%"></td>
<td width="78%">


<p>This field indicates which layer or source controls the
attribute. The following sources are defined:</p></td></tr>
</table>


<p style="margin-left:22%;"><b>PFM_ATTR_CTRL_UNKNOWN</b></p>

<p style="margin-left:32%;">The source controlling the
attribute is not known.</p>

<p style="margin-left:22%;"><b>PFM_ATTR_CTRL_PMU</b></p>

<p style="margin-left:32%;">The attribute is controlled by
the PMU hardware.</p>


<p style="margin-left:22%;"><b>PFM_ATTR_CTRL_PERF_EVENT</b></p>

<p style="margin-left:32%;">The attribute is controlled by
the perf_events kernel interface.</p>

<p style="margin-left:11%;"><b>reserved</b></p>

<p style="margin-left:22%;">These fields must be set to
zero.</p>

<h2>RETURN
<a name="RETURN"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">If successful,
the function returns <b>PFM_SUCCESS</b> and attribute
information in <b>info</b>, otherwise it returns an error
code.</p>

<h2>ERRORS
<a name="ERRORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>PFMLIB_ERR_NOINIT</b></p>

<p style="margin-left:22%;">Library has not been
initialized properly.</p>

<p style="margin-left:11%;"><b>PFMLIB_ERR_INVAL</b></p>

<p style="margin-left:22%;">The <b>idx</b> or <b>attr</b>
arguments are invalid or <b>info</b> is <b>NULL</b> or
<b>size</b> is not zero.</p>

<p style="margin-left:11%;"><b>PFM_ERR_NOTSUPP</b></p>

<p style="margin-left:22%;">The requested os layer has not
been detected on the host system.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Stephane
Eranian &lt;eranian@gmail.com&gt;</p>
<hr>
</body>
</html>
