<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 01:50:39 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IPSEC_SPI</title>

</head>
<body>

<h1 align="center">IPSEC_SPI</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#OBSOLETE">OBSOLETE</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>
<a href="#BUGS">BUGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ipsec_spi
&minus; list IPSEC Security Associations</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p style="margin-top: 1em"><b>ipsec</b> <i>spi</i></p></td>
<td width="75%">
</td></tr>
</table>


<p style="margin-left:20%;"><i>cat/proc/net/ipsec_spi</i></p>

<h2>OBSOLETE
<a name="OBSOLETE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Note that
eroute is only supported on the classic KLIPS stack. It is
not supported on any other stack and will be completely
removed in future versions. A replacement command still
needs to be designed</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">/proc/net/ipsec_spi
is a read&minus;only file that lists the current IPSEC
Security Associations. A Security Association (SA) is a
transform through which packet contents are to be processed
before being forwarded. A transform can be an
IPv4&minus;in&minus;IPv4 or IPv6&minus;in&minus;IPv6
encapsulation, an IPSEC Authentication Header
(authentication with no encryption), or an IPSEC
Encapsulation Security Payload (encryption, possibly
including authentication).</p>

<p style="margin-left:11%; margin-top: 1em">When a packet
is passed from a higher networking layer through an IPSEC
virtual interface, a search in the extended routing table
(see <b>ipsec_eroute</b>(5)) yields a IP protocol number , a
Security Parameters Index (SPI) and an effective destination
address When an IPSEC packet arrives from the network, its
ostensible destination, an SPI and an IP protocol specified
by its outermost IPSEC header are used. The
destination/SPI/protocol combination is used to select a
relevant SA. (See <b>ipsec_spigrp</b>(5) for discussion of
how multiple transforms are combined.)</p>

<p style="margin-left:11%; margin-top: 1em">An <i>spi ,
proto, daddr</i> and <i>address_family</i> arguments specify
an SAID. <i>Proto</i> is an ASCII string, &quot;ah&quot;,
&quot;esp&quot;, &quot;comp&quot; or &quot;tun&quot;,
specifying the IP protocol. <i>Spi</i> is a number, preceded
by &acute;.&acute; indicating hexadecimal and IPv4 or by
&acute;:&acute; indicating hexadecimal and IPv6, where each
hexadecimal digit represents 4 bits, between <b>0x100</b>
and <b>0xffffffff</b>; values from <b>0x0</b> to <b>0xff</b>
are reserved. <i>Daddr</i> is a dotted&minus;decimal IPv4
destination address or a coloned hex IPv6 destination
address.</p>

<p style="margin-left:11%; margin-top: 1em">An <i>SAID</i>
combines the three parameters above, such as:
&quot;tun.101@1.2.3.4&quot; for IPv4 or
&quot;tun:101@3049:1::1&quot; for IPv6</p>

<p style="margin-left:11%; margin-top: 1em">A table entry
consists of:</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;"><b>SAID</b></p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">&lt;transform name
(proto,encalg,authalg)&gt;:</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">direction (dir=)</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">source address (src=)</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">source and destination
addresses and masks for inner header policy check addresses
(policy=), as dotted&minus;quads or coloned hex, separated
by &acute;&minus;&gt;&acute;, for IPv4&minus;in&minus;IPv4
or IPv6&minus;in&minus;IPv6 SAs only</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">initialisation vector length
and value (iv_bits=, iv=) if non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">out&minus;of&minus;order window
size, number of out&minus;of&minus;order errors, sequence
number, recently received packet bitmask, maximum difference
between sequence numbers (ooowin=, ooo_errs=, seq=, bit=,
max_seq_diff=) if SA is AH or ESP and if individual items
are non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">extra flags (flags=) if any are
set</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">authenticator length in bits
(alen=) if non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">authentication key length in
bits (aklen=) if non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">authentication errors
(auth_errs=) if non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">encryption key length in bits
(eklen=) if non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">encryption size errors
(encr_size_errs=) if non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">encryption padding error
warnings (encr_pad_errs=) if non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">lifetimes legend, c=Current
status, s=Soft limit when exceeded will initiate rekeying,
h=Hard limit will cause termination of SA (life(c,s,h)=)</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">number of connections to which
the SA is allocated (c), that will cause a rekey (s), that
will cause an expiry (h) (alloc=), if any value is
non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">number of bytes processesd by
this SA (c), that will cause a rekey (s), that will cause an
expiry (h) (bytes=), if any value is non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">time since the SA was added
(c), until rekey (s), until expiry (h), in seconds
(add=)</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">time since the SA was first
used (c), until rekey (s), until expiry (h), in seconds
(used=), if any value is non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">number of packets processesd by
this SA (c), that will cause a rekey (s), that will cause an
expiry (h) (packets=), if any value is non&minus;zero</p>

<p style="margin-left:11%; margin-top: 1em">+</p>

<p style="margin-left:17%;">time since the last packet was
processed, in seconds (idle=), if SA has been used</p>

<p style="margin-left:17%; margin-top: 1em">average
compression ratio (ratio=)</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>tun.12a@192.168.43.1
IPIP: dir=out src=192.168.43.2</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>life(c,s,h)=bytes(14073,0,0)add(269,0,0)</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>use(149,0,0)packets(14,0,0)</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>idle=23</b></p>

<p style="margin-left:11%; margin-top: 1em">is an outbound
IPv4&minus;in&minus;IPv4 (protocol 4) tunnel&minus;mode SA
set up between machines 192.168.43.2 and 192.168.43.1 with
an SPI of 12a in hexadecimal that has passed about 14
kilobytes of traffic in 14 packets since it was created, 269
seconds ago, first used 149 seconds ago and has been idle
for 23 seconds.</p>


<p style="margin-left:11%; margin-top: 1em"><b>esp:9a35fc02@3049:1::1
ESP_3DES_HMAC_MD5:</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>dir=in
src=9a35fc02@3049:1::2</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>ooowin=32
seq=7149 bit=0xffffffff</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>alen=128
aklen=128 eklen=192</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>life(c,s,h)=bytes(1222304,0,0)add(4593,0,0)</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>use(3858,0,0)packets(7149,0,0)</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>idle=23</b></p>

<p style="margin-left:11%; margin-top: 1em">is an inbound
Encapsulating Security Payload (protocol 50) SA on machine
3049:1::1 with an SPI of 9a35fc02 that uses 3DES as the
encryption cipher, HMAC MD5 as the authentication algorithm,
an out&minus;of&minus;order window of 32 packets, a present
sequence number of 7149, every one of the last 32 sequence
numbers was received, the authenticator length and keys is
128 bits, the encryption key is 192 bits (actually 168 for
3DES since 1 of 8 bits is a parity bit), has passed 1.2
Mbytes of data in 7149 packets, was added 4593 seconds ago,
first used 3858 seconds ago and has been idle for 23
seconds.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">/proc/net/ipsec_spi,
/usr/local/bin/ipsec</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ipsec(8),
ipsec_manual(8), ipsec_tncfg(5), ipsec_eroute(5),
ipsec_spigrp(5), ipsec_klipsdebug(5), ipsec_spi(8),
ipsec_version(5), ipsec_pf_key(5)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Written for the
Linux FreeS/WAN project
&lt;<b><font color="#0000FF">http://www.freeswan.org/</font></b><font color="#000000">&gt;
by Richard Guy Briggs.</font></p>

<h2>BUGS
<a name="BUGS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
add and use times are awkward, displayed in seconds since
machine start. It would be better to display them in seconds
before now for human readability.</font></p>
<hr>
</body>
</html>
