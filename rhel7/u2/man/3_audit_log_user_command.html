<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 01:15:23 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>AUDIT_LOG_USER_COMMAND</title>

</head>
<body>

<h1 align="center">AUDIT_LOG_USER_COMMAND</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#ERRORS">ERRORS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">audit_log_user_command
&minus; log a user command</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;libaudit.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
audit_log_user_command(int audit_fd, int type, const char
*command, const char *tty, int result);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This function
will log a command to the audit system using a predefined
message format. It encodes the command as the audit system
expects for untrusted strings. This function should be used
by all apps need to record commands. The function parameters
are as follows:</p>

<p style="margin-left:11%; margin-top: 1em">audit_fd - The
fd returned by audit_open <br>
type - type of message, ex: AUDIT_USYS_CONFIG,
AUDIT_USER_LOGIN <br>
command - the command being logged <br>
tty - The tty of the user, if NULL will attempt to figure
out <br>
result - 1 is &quot;success&quot; and 0 is
&quot;failed&quot;</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">It returns the
sequence number which is &gt; 0 on success or &lt;= 0 on
error.</p>

<h2>ERRORS
<a name="ERRORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This function
returns &minus;1 on failure. Examine errno for more
info.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>audit_log_user_message</b>(3),
<b>audit_log_user_comm_message</b>(3),
<b>audit_log_acct_message</b>(3),
<b>audit_log_user_avc_message</b>(3),
<b>audit_log_semanage_message</b>(3).</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Steve Grubb</p>
<hr>
</body>
</html>
