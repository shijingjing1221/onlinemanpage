<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:08:55 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PMLOGREDUCE</title>

</head>
<body>

<h1 align="center">PMLOGREDUCE</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#COMMAND LINE OPTIONS">COMMAND LINE OPTIONS</a><br>
<a href="#DATA REDUCTION">DATA REDUCTION</a><br>
<a href="#FILES">FILES</a><br>
<a href="#PCP ENVIRONMENT">PCP ENVIRONMENT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>
<a href="#CAVEATS">CAVEATS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pmlogreduce</b>
&minus; temporal reduction of Performance Co-Pilot
archives</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>$PCP_BINADM_DIR/pmlogreduce</b>
[<b>&minus;z</b>] [<b>&minus;A</b> <i>align</i>]
[<b>&minus;S</b> <i>starttime</i>] [<b>&minus;s</b>
<i>samples</i>] [<b>&minus;T</b> <i>endtime</i>]
[<b>&minus;t</b> <i>interval</i>] [<b>&minus;v</b>
<i>volsamples</i>] [<b>&minus;Z</b> <i>timezone</i>]
<i>input output</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>pmlogreduce</b></i>
reads one Performance Co-Pilot (PCP) archive identified by
<i>input</i> (this must be a PCP archive created by
<b>pmlogger</b>(1), <b>pmlogextract</b>(1) or
<b>pmlogreduce</b>(1)), and creates a temporally reduced PCP
archive in <i>output</i>. The data reduction involves
statistical and temporal reduction of samples with an output
sampling interval defined by the <b>&minus;t</b> option in
the <i>output</i> archive (independent of the sampling
intervals in the <i>input</i> archive), and is further
controlled by other command line arguments.</p>

<p style="margin-left:11%; margin-top: 1em">For some
metrics, temporal data reduction is not going to be helpful,
so for metrics with types <b>PM_TYPE_AGGREGATE</b> or
<b>PM_TYPE_EVENT</b>, a warning is issued if these metrics
are found in <i>input</i> and they will be skipped and not
appear in the <i>output</i> archive.</p>

<h2>COMMAND LINE OPTIONS
<a name="COMMAND LINE OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The command
line options for <b>pmlogreduce</b> are as follows: <b><br>
&minus;A</b> <i>align</i></p>

<p style="margin-left:22%;">Specify a
&lsquo;&lsquo;natural&rsquo;&rsquo; alignment of the output
sample times; refer to <b>PCPIntro</b>(1).</p>

<p style="margin-left:11%;"><b>&minus;S</b>
<i>starttime</i></p>

<p style="margin-left:22%;">Define the start of a time
window to restrict the samples retrieved from the
<i>input</i> archive; refer to <b>PCPIntro</b>(1).</p>

<p style="margin-left:11%;"><b>&minus;s</b>
<i>samples</i></p>

<p style="margin-left:22%;">The argument <i>samples</i>
defines the number of samples to be written to
<i>output</i>. If <i>samples</i> is 0 or <b>-s</b> is not
specified, <b>pmlogreduce</b> will sample until the end of
the PCP archive, or the end of the time window as specified
by <b>-T</b>, whichever comes first. The <b>-s</b> option
will override the <b>-T</b> option if it occurs sooner.</p>

<p style="margin-left:11%;"><b>&minus;T</b>
<i>endtime</i></p>

<p style="margin-left:22%;">Define the termination of a
time window to restrict the samples retrieved from the
<i>input</i> archive; refer to <b>PCPIntro</b>(1).</p>

<p style="margin-left:11%;"><b>&minus;v</b>
<i>volsamples</i></p>

<p style="margin-left:22%;">The <i>output</i> archive is
potentially a multi-volume data set, and the <b>&minus;v</b>
option causes <b>pmlogreduce</b> to start a new volume after
<i>volsamples</i> log records have been written to the
<i>output</i> archive.</p>

<p style="margin-left:22%; margin-top: 1em">Independent of
any <b>&minus;v</b> option, each volume of an archive is
limited to no more than 2^31 bytes, so <i>pmlogreduce</i>
will automatically create a new volume for the archive
before this limit is reached.</p>

<p style="margin-left:11%;"><b>&minus;t</b>
<i>interval</i></p>

<p style="margin-left:22%;">Consecutive samples in the
<i>output</i> archive will appear with a time delta defined
by <i>interval</i>; refer to <b>PCPIntro</b>(1). Note the
default value is 600 (seconds, i.e. 10 minutes).</p>

<p style="margin-left:11%;"><b>&minus;Z</b>
<i>timezone</i></p>

<p style="margin-left:22%;">Use <i>timezone</i> when
displaying the date and time, or interpreting the
<b>&minus;S</b> and <b>&minus;T</b> options. <i>Timezone</i>
is in the format of the environment variable <b>TZ</b> as
described in <b>environ</b>(5).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;z</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Use the local timezone of the host from the <i>input</i>
archive when displaying the date and time, or interpreting
the <b>&minus;S</b> and <b>&minus;T</b> options. The default
is to initially use the timezone of the local host.</p></td></tr>
</table>

<h2>DATA REDUCTION
<a name="DATA REDUCTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The statistical
and temporal reduction follows the following rules:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em">1.</p></td>
<td width="3%"></td>
<td width="83%">


<p style="margin-top: 1em">Consecutive records from
<i>input</i> are read without interpolation, and at most one
output record is written for each <i>interval</i>,
summarizing the performance data over that period.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2.</p></td>
<td width="3%"></td>
<td width="83%">


<p>If the semantics of a metric indicates it is
<b>instantaneous</b> or <b>discrete</b> then <i>output</i>
value is computed as the arithmetic mean of the observations
(if any) over each <i>interval</i>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>3.</p></td>
<td width="3%"></td>
<td width="83%">


<p>If the semantics of a metric indicates it is a
<b>counter</b> then the following transformations are
applied:</p> </td></tr>
</table>

<p style="margin-left:17%;">a)</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%"></td>
<td width="3%"></td>
<td width="77%">


<p style="margin-top: 1em">Metrics with 32-bit precision
are promoted to 64-bit precision.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>b)</p></td>
<td width="3%"></td>
<td width="77%">


<p>Any counter wrap (overflow) is noted, and appropriate
adjustment made in the value of the metric over each
<i>interval</i>. This will be correct in the case of a
single counter wrap, but will silently <b>underestimate</b>
in the case where more than one counter wrap occurs between
consecutive observations in the <i>input</i> archive, and
silently <b>overestimate</b> in the case where a counter is
reset occurs between consecutive observations in the
<i>input</i> archive; unfortunately these situations cannot
be detected, but are believed to be rare events for the sort
of production monitoring environments where
<b>pmlogreduce</b> is most likely to be deployed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>4.</p></td>
<td width="3%"></td>
<td width="77%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">Any changes in
instance domains, and indeed all metadata, is preserved.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em">5.</p></td>
<td width="3%"></td>
<td width="83%">


<p style="margin-top: 1em">Any
&lsquo;&lsquo;mark&rsquo;&rsquo; records in the <i>input</i>
archive (as created by <b>pmlogextract</b>(1)) will be
preserved in the <i>output</i> archive, so periods where no
data is available are maintained, and data interpolation
will <b>not</b> occur across these periods when the
<i>output</i> archive is subsequently processed with PCP
applications.</p> </td></tr>
</table>

<h2>FILES
<a name="FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For each of the
<i>input</i> and <i>output</i> archives, several physical
files are used. <i><br>
archive</i><b>.meta</b></p>

<p style="margin-left:26%;">metadata (metric descriptions,
instance domains, etc.) for the archive log</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="14%">


<p><i>archive</i><b>.0</b></p></td>
<td width="1%"></td>
<td width="74%">


<p>initial volume of metrics values (subsequent volumes
have suffixes <b>1</b>, <b>2</b>, ...) &minus; for
<i>input</i> these files may have been previously compressed
with <b>bzip2</b>(1) or <b>gzip</b>(1) and thus may have an
additional <b>.bz2</b> or <b>.gz</b> suffix.</p></td></tr>
</table>


<p style="margin-left:11%;"><i>archive</i><b>.index</b></p>

<p style="margin-left:26%;">temporal index to support rapid
random access to the other files in the archive log.</p>

<h2>PCP ENVIRONMENT
<a name="PCP ENVIRONMENT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Environment
variables with the prefix <b>PCP_</b> are used to
parameterize the file and directory names used by PCP. On
each installation, the file <i>/etc/pcp.conf</i> contains
the local values for these variables. The <b>$PCP_CONF</b>
variable may be used to specify an alternative configuration
file, as described in <b>pcp.conf</b>(5).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>PCPIntro</b>(1),
<b>pmdumplog</b>(1), <b>pmlc</b>(1), <b>pmlogextract</b>(1),
<b>pmlogger</b>(1), <b>pcp.conf</b>(5) and
<b>pcp.env</b>(5).</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">All error
conditions detected by <b>pmlogreduce</b> are reported on
<i>stderr</i> with textual (if sometimes terse)
explanation.</p>

<p style="margin-left:11%; margin-top: 1em">Should the
<i>input</i> archive be corrupted (this can happen if the
<b>pmlogger</b> instance writing the archive suddenly dies),
then <b>pmlogreduce</b> will detect and report the position
of the corruption in the file, and any subsequent
information from the <i>input</i> archive will not be
processed.</p>

<p style="margin-left:11%; margin-top: 1em">If any error is
detected, <b>pmlogreduce</b> will exit with a non-zero
status.</p>

<h2>CAVEATS
<a name="CAVEATS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The preamble
metrics (pmcd.pmlogger.archive, pmcd.pmlogger.host, and
pmcd.pmlogger.port), which are automatically recorded by
<b>pmlogger</b> at the start of the archive, may not be
present in the archive output by <b>pmlogreduce</b>. These
metrics are only relevant while the archive is being
created, and have no significance once recording has
finished.</p>
<hr>
</body>
</html>
