<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Nov 11 02:02:26 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>NFSTEST_POSIX</title>

</head>
<body>

<h1 align="center">NFSTEST_POSIX</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#TESTS">TESTS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfstest_posix -
POSIX file system level access tests</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nfstest_posix
--server &lt;server&gt; [options]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Verify POSIX
file system level access over the specified path using
positive and negative testing.</p>

<p style="margin-left:11%; margin-top: 1em">Valid for any
version of NFS.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>--version</b></p>

<p style="margin-left:22%;">show program&rsquo;s version
number and exit</p>

<p style="margin-left:11%;"><b>-h, --help</b></p>

<p style="margin-left:22%;">show this help message and
exit</p>

<p style="margin-left:11%;"><b>-f FILE, --file=FILE</b></p>

<p style="margin-left:22%;">Options file</p>

<p style="margin-left:11%;"><b>-s SERVER,
--server=SERVER</b></p>

<p style="margin-left:22%;">Server name or IP address</p>

<p style="margin-left:11%;"><b>-p PORT, --port=PORT</b></p>

<p style="margin-left:22%;">NFS server port [default:
2049]</p>


<p style="margin-left:11%;"><b>--nfsversion=NFSVERSION</b></p>

<p style="margin-left:22%;">NFS version [default: 4]</p>


<p style="margin-left:11%;"><b>--minorversion=MINORVERSION</b></p>

<p style="margin-left:22%;">Minor version [default: 1]</p>

<p style="margin-left:11%;"><b>-e EXPORT,
--export=EXPORT</b></p>

<p style="margin-left:22%;">Exported file system to mount
[default: &rsquo;/&rsquo;]</p>

<p style="margin-left:11%;"><b>-m MTPOINT,
--mtpoint=MTPOINT</b></p>

<p style="margin-left:22%;">Mount point [default:
&rsquo;/mnt/t&rsquo;]</p>

<p style="margin-left:11%;"><b>--datadir=DATADIR</b></p>

<p style="margin-left:22%;">Data directory where files are
created [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%;"><b>-o MTOPTS,
--mtopts=MTOPTS</b></p>

<p style="margin-left:22%;">Mount options [default:
&rsquo;hard,rsize=4096,wsize=4096&rsquo;]</p>

<p style="margin-left:11%;"><b>-i INTERFACE,
--interface=INTERFACE</b></p>

<p style="margin-left:22%;">Device interface [default:
&rsquo;eth0&rsquo;]</p>

<p style="margin-left:11%;"><b>-v VERBOSE,
--verbose=VERBOSE</b></p>

<p style="margin-left:22%;">Verbose level [default:
&rsquo;none&rsquo;]</p>

<p style="margin-left:11%;"><b>--nocleanup</b></p>

<p style="margin-left:22%;">Do not cleanup</p>

<p style="margin-left:11%;"><b>--rmtraces</b></p>

<p style="margin-left:22%;">Remove trace files [default:
remove trace files if no errors]</p>

<p style="margin-left:11%;"><b>--keeptraces</b></p>

<p style="margin-left:22%;">Do not remove any trace files
[default: remove trace files if no errors]</p>

<p style="margin-left:11%;"><b>--createlog</b></p>

<p style="margin-left:22%;">Create log file</p>

<p style="margin-left:11%;"><b>--bugmsgs=BUGMSGS</b></p>

<p style="margin-left:22%;">File containing test messages
to mark as bugs if they failed</p>

<p style="margin-left:11%;"><b>--ignore</b></p>

<p style="margin-left:22%;">Ignore all bugs given by
bugmsgs</p>

<p style="margin-left:11%;"><b>--nomount</b></p>

<p style="margin-left:22%;">Do not mount server</p>

<p style="margin-left:11%;"><b>--basename=BASENAME</b></p>

<p style="margin-left:22%;">Base name for all files and
logs [default: automatically generated]</p>

<p style="margin-left:11%;"><b>--tverbose=TVERBOSE</b></p>

<p style="margin-left:22%;">Verbose level for test messages
[default: &rsquo;1&rsquo;]</p>

<p style="margin-left:11%;"><b>--filesize=FILESIZE</b></p>

<p style="margin-left:22%;">File size to use for test files
[default: 65536]</p>

<p style="margin-left:11%;"><b>--nfiles=NFILES</b></p>

<p style="margin-left:22%;">Number of files to create
[default: 2]</p>

<p style="margin-left:11%;"><b>--rsize=RSIZE</b></p>

<p style="margin-left:22%;">Read size to use when reading
files [default: 4096]</p>

<p style="margin-left:11%;"><b>--wsize=WSIZE</b></p>

<p style="margin-left:22%;">Write size to use when writing
files [default: 4096]</p>

<p style="margin-left:11%;"><b>--iodelay=IODELAY</b></p>

<p style="margin-left:22%;">Seconds to delay I/O operations
[default: 0.1]</p>


<p style="margin-left:11%;"><b>--offset-delta=OFFSET_DELTA</b></p>

<p style="margin-left:22%;">Read/Write offset delta
[default: 4096]</p>

<p style="margin-left:11%;"><b>--warnings</b></p>

<p style="margin-left:22%;">Display warnings</p>

<p style="margin-left:11%;"><b>--nfsdebug=NFSDEBUG</b></p>

<p style="margin-left:22%;">Set NFS kernel debug flags and
save log messages [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%;"><b>--rpcdebug=RPCDEBUG</b></p>

<p style="margin-left:22%;">Set RPC kernel debug flags and
save log messages [default: &rsquo;&rsquo;]</p>

<p style="margin-left:11%;"><b>--sudo=SUDO</b></p>

<p style="margin-left:22%;">Full path of binary for sudo
[default: &rsquo;/usr/bin/sudo&rsquo;]</p>

<p style="margin-left:11%;"><b>--tcpdump=TCPDUMP</b></p>

<p style="margin-left:22%;">Full path of binary for tcpdump
[default: &rsquo;/usr/sbin/tcpdump&rsquo;]</p>

<p style="margin-left:11%;"><b>--iptables=IPTABLES</b></p>

<p style="margin-left:22%;">Full path of binary for
iptables [default: &rsquo;/sbin/iptables&rsquo;]</p>

<p style="margin-left:11%;"><b>--messages=MESSAGES</b></p>

<p style="margin-left:22%;">Full path of log messages file
[default: &rsquo;/var/log/messages&rsquo;]</p>

<p style="margin-left:11%;"><b>--tmpdir=TMPDIR</b></p>

<p style="margin-left:22%;">Temporary directory [default:
&rsquo;/tmp&rsquo;]</p>

<p style="margin-left:11%;"><b>--runtest=RUNTEST</b></p>

<p style="margin-left:22%;">Comma separated list of tests
to run [default: &rsquo;all&rsquo;]</p>

<p style="margin-left:11%;"><b>--createtrace</b></p>

<p style="margin-left:22%;">Start a packet trace [default:
no packet trace is created]</p>

<h2>TESTS
<a name="TESTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>access</b>
<br>
Verify POSIX API access() on files with different modes.</p>

<p style="margin-left:11%; margin-top: 1em"><b>chdir</b>
<br>
Verify POSIX API chdir() by changing to a newly created
directory and then by changing back to the original
directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>creat</b>
<br>
Verify POSIX API creat(path, mode) is equivalent to
open(path, O_WRONLY|O_CREAT|O_TRUNC, mode). First test with
a path that does not exist to verify the file was created
and then test with a path that does exist to verify that the
file is truncated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>fcntl</b>
<br>
Verify the POSIX API fcntl() commands F_DUPFD, F_GETFD,
F_SETFD, F_GETFL, F_SETFL, and FD_CLOEXEC. The F_DUPFD
command is tested by performing operations on the original
and dupped file descriptor to ensure they behave correctly.
The F_GETFD and F_SETFD commands are tested by setting the
FD_CLOEXEC flag and making sure it gets set. The F_GETFL and
F_SETFL commands are tested by setting the O_APPEND flag and
making sure it gets set. Run the test for both
&rsquo;read&rsquo; and &rsquo;write&rsquo;.</p>


<p style="margin-left:11%; margin-top: 1em"><b>fdatasync</b>
<br>
Verify POSIX API fdatasync().</p>

<p style="margin-left:11%; margin-top: 1em"><b>fstat</b>
<br>
Verify POSIX API fstat() by checking the mode on a file and
that it returns the expected structure members. Create a
symlink and verify that fstat returns information about the
link.</p>


<p style="margin-left:11%; margin-top: 1em"><b>fstatvfs</b>
<br>
Verify POSIX API fstatvfs() by making sure all the members
of the structure are returned.</p>

<p style="margin-left:11%; margin-top: 1em"><b>fsync</b>
<br>
Verify POSIX API fsync().</p>

<p style="margin-left:11%; margin-top: 1em"><b>link</b>
<br>
Verify POSIX API link(src, dst) creates a link and updates
st_ctime field for the file. Verify that link updates the
st_ctime and st_mtime for the directory. Verify st_link
count incremented by 1 for the file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>lseek</b>
<br>
Verify POSIX API lseek() with different offsets and whence
values including seeking past the end of the file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>lstat</b>
<br>
Verify POSIX API lstat() by checking the mode on a file and
that it returns the expected structure members. Create a
symlink and verify that lstat returns information about the
link.</p>

<p style="margin-left:11%; margin-top: 1em"><b>mkdir</b>
<br>
Verify POSIX API mkdir(). Verify that mkdir with a path of a
symbolic link fails. Verify that the st_ctime and st_mtime
fields of the parent directory are updated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>opendir</b>
<br>
Verify POSIX API opendir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>read</b>
<br>
Verify POSIX API read() by reading data from a file. Verify
that the st_atime of the file is updated after the read.
Verify a read of 0 bytes returns 0.</p>

<p style="margin-left:11%; margin-top: 1em"><b>readdir</b>
<br>
Verify POSIX API readdir() on a directory.</p>


<p style="margin-left:11%; margin-top: 1em"><b>readlink</b>
<br>
Verify Test POSIX API readlink() by reading a symbolic
link.</p>

<p style="margin-left:11%; margin-top: 1em"><b>rename</b>
<br>
Verify POSIX API rename() by renaming a file, directory, and
a symbolic link. Verify that a rename from a file to a
symbolic link will cause the symbolic link to be
removed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>rewinddir</b>
<br>
Verify POSIX API rewinddir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>rmdir</b>
<br>
Verify POSIX API rmdir() by removing a directory. Verify
that the parent&rsquo;s st_ctime and st_mtime are
updated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>seekdir</b>
<br>
Verify POSIX API seekdir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>stat</b>
<br>
Verify POSIX API stat() by checking the mode on a file and
that it returns the expected structure members. Create a
symlink and verify that stat returns information about the
file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>statvfs</b>
<br>
Verify POSIX API statvfs() by making sure all the members of
the structure are returned.</p>

<p style="margin-left:11%; margin-top: 1em"><b>symlink</b>
<br>
Verify POSIX API symlink() by creating a symbolic link and
verify that the file type is slnk.</p>

<p style="margin-left:11%; margin-top: 1em"><b>sync</b>
<br>
Verify POSIX API sync().</p>

<p style="margin-left:11%; margin-top: 1em"><b>telldir</b>
<br>
Verify POSIX API telldir() on a directory.</p>

<p style="margin-left:11%; margin-top: 1em"><b>unlink</b>
<br>
Verify POSIX API unlink() by unlinking a file and verify
that it was removed. Verify that the st_ctime and st_mtime
fields of the parent directory were updated. Then unlink a
symbolic link and verify that the symbolic link was removed
but not the referenced file. Then remove an open file and
verify that I/O still occurs to the file after the unlink
and that the file gets removed when the file is closed.
Create a file and then hard link to it so the link count is
greater than 1. Unlink the hard file and verify that
st_ctime field is updated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>write</b>
<br>
Verify POSIX API write() by writing 0 bytes and verifying 0
is returned. Write a pattern the file, seek +N, write
another pattern, and close the file. Open the file and read
in both written patterns and verify that it is the correct
pattern. Read in the data from the hole in the file and
verify that it is 0.</p>

<p style="margin-left:11%; margin-top: 1em"><b>open</b>
<br>
Verify POSIX API open() on a file. Verify file creation
using the O_CREAT flag and verifying the file mode is set to
the specified value. Verify the st_ctime and st_mtime are
updated on the parent directory after the file was created.
Verify open on existing file fails with the O_EXCL flag set.
Verify write succeeds and read fails if file was open with
O_WRONLY. Verify read succeeds and write fails if file was
open with O_RDONLY. Verify that all writes with O_APPEND set
are to the end of the file. Use O_DSYNC, O_RSYNC, and O_SYNC
flags in open calls. Verify file open with O_CREAT and
O_TRUNC set will truncate an existing file. Verify that it
updates the file st_ctime and st_mtime.</p>

<p style="margin-left:11%; margin-top: 1em"><b>chmod</b>
<br>
Verify POSIX API chmod() on a file and directory by trying
all valid combinations of modes. Verify that the st_ctime
files is updated for both the file and directory.</p>


<p style="margin-left:11%; margin-top: 1em"><b>closedir</b>
<br>
Verify POSIX API closedir() works and that reading to a
closed file descriptor returns an error.</p>

<p style="margin-left:11%; margin-top: 1em"><b>close</b>
<br>
Verify POSIX API close() works and that writing to a closed
file descriptor returns an error.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The only
required option is --server <br>
$ nfstest_posix --server 192.168.0.11</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The user id in
the local host must have access to run commands as root
using the &rsquo;sudo&rsquo; command without the need for a
password.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>nfstest.test_util</b>(1),
<b>nfstest_cache</b>(1), <b>nfstest_delegation</b>(1),
<b>nfstest_dio</b>(1), <b>nfstest_pnfs</b>(1)</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">No known
bugs.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Jorge Mora
(mora@netapp.com)</p>
<hr>
</body>
</html>
