<!-- Creator     : groff version 1.18.1.1 -->
<!-- CreationDate: Sat Nov 12 05:26:48 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>VFS_FULL_AUDIT(8) System Administration tools
VFS_FULL_AUDIT(8)</p>

<p>NAME vfs_full_audit - record Samba VFS operations in the
system log</p>

<p>SYNOPSIS vfs objects = full_audit</p>

<p>DESCRIPTION This VFS module is part of the samba(7)
suite.</p>

<p>The vfs_full_audit VFS module records selected client
operations to the system log using syslog(3).</p>

<p>vfs_full_audit is able to record the complete set of
Samba VFS operations:</p>

<p>aio_cancel</p>

<p>aio_error</p>

<p>aio_fsync</p>

<p>aio_read</p>

<p>aio_return</p>

<p>aio_suspend</p>

<p>aio_write</p>

<p>chdir</p>

<p>chflags</p>

<p>chmod</p>

<p>chmod_acl</p>

<p>chown</p>

<p>close</p>

<p>closedir</p>

<p>connect</p>

<p>disconnect</p>

<p>disk_free</p>

<p>fchmod</p>

<p>fchmod_acl</p>

<p>fchown</p>

<p>fget_nt_acl</p>

<p>fgetxattr</p>

<p>flistxattr</p>

<p>fremovexattr</p>

<p>fset_nt_acl</p>

<p>fsetxattr</p>

<p>fstat</p>

<p>fsync</p>

<p>ftruncate</p>

<p>get_nt_acl</p>

<p>get_quota</p>

<p>get_shadow_copy_data</p>

<p>getlock</p>

<p>getwd</p>

<p>getxattr</p>

<p>kernel_flock</p>

<p>lgetxattr</p>

<p>link</p>

<p>linux_setlease</p>

<p>listxattr</p>

<p>llistxattr</p>

<p>lock</p>

<p>lremovexattr</p>

<p>lseek</p>

<p>lsetxattr</p>

<p>lstat</p>

<p>mkdir</p>

<p>mknod</p>

<p>open</p>

<p>opendir</p>

<p>pread</p>

<p>pwrite</p>

<p>read</p>

<p>readdir</p>

<p>readlink</p>

<p>realpath</p>

<p>removexattr</p>

<p>rename</p>

<p>rewinddir</p>

<p>rmdir</p>

<p>seekdir</p>

<p>sendfile</p>

<p>set_nt_acl</p>

<p>set_quota</p>

<p>setxattr</p>

<p>stat</p>

<p>statvfs</p>

<p>symlink</p>

<p>sys_acl_add_perm</p>

<p>sys_acl_clear_perms</p>

<p>sys_acl_create_entry</p>

<p>sys_acl_delete_def_file</p>

<p>sys_acl_free_acl</p>

<p>sys_acl_free_qualifier</p>

<p>sys_acl_free_text</p>

<p>sys_acl_get_entry</p>

<p>sys_acl_get_fd</p>

<p>sys_acl_get_file</p>

<p>sys_acl_get_perm</p>

<p>sys_acl_get_permset</p>

<p>sys_acl_get_qualifier</p>

<p>sys_acl_get_tag_type</p>

<p>sys_acl_init</p>

<p>sys_acl_set_fd</p>

<p>sys_acl_set_file</p>

<p>sys_acl_set_permset</p>

<p>sys_acl_set_qualifier</p>

<p>sys_acl_set_tag_type</p>

<p>sys_acl_to_text</p>

<p>sys_acl_valid</p>

<p>telldir</p>

<p>unlink</p>

<p>utime</p>

<p>write</p>

<p>In addition to these operations, vfs_full_audit
recognizes the special operation names &quot;all&quot; and
&quot;none &quot;, which refer to all the VFS operations and
none of the VFS operations respectively.</p>

<p>vfs_full_audit records operations in fixed format
consisting of fields separated by &acute;|&acute;
characters. The format is:</p>

<p>smbd_audit: PREFIX|OPERATION|RESULT|FILE</p>

<p>The record fields are:</p>

<p>&middot; PREFIX - the result of the full_audit:prefix
string after variable substitutions</p>

<p>&middot; OPERATION - the name of the VFS operation</p>

<p>&middot; RESULT - whether the operation succeeded or
failed</p>

<p>&middot; FILE - the name of the file or directory the
operation was performed on</p>

<p>This module is stackable.</p>

<p>OPTIONS vfs_full_audit:prefix = STRING Prepend audit
messages with STRING. STRING is processed for standard
substitution variables listed in smb.conf(5). The default
prefix is &quot;%u|%I&quot;.</p>

<p>vfs_full_audit:success = LIST LIST is a list of VFS
operations that should be recorded if they succeed.
Operations are specified using the names listed above.</p>

<p>vfs_full_audit:failure = LIST LIST is a list of VFS
operations that should be recorded if they failed.
Operations are specified using the names listed above.</p>

<p>full_audit:facility = FACILITY Log messages to the named
syslog(3) facility.</p>

<p>full_audit:priority = PRIORITY Log messages with the
named syslog(3) priority.</p>

<p>EXAMPLES Log file and directory open operations on the
[records] share using the LOCAL7 facility and ALERT
priority, including the username and IP address:</p>

<p>[records] path = /data/records vfs objects = full_audit
full_audit:prefix = %u|%I full_audit:success = open opendir
full_audit:failure = all full_audit:facility = LOCAL7
full_audit:priority = ALERT</p>

<p>VERSION This man page is correct for version 3.0.25 of
the Samba suite.</p>

<p>AUTHOR The original Samba software and related utilities
were created by Andrew Tridgell. Samba is now developed by
the Samba Team as an Open Source project similar to the way
the Linux kernel is developed.</p>

<p>Samba 3.0 11/20/2008 VFS_FULL_AUDIT(8)</p>
<hr>
</body>
</html>
