<!-- Creator     : groff version 1.18.1.1 -->
<!-- CreationDate: Sat Nov 12 05:17:55 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PAM_TALLY(8) Linux-PAM Manual PAM_TALLY(8)</p>

<p>NAME pam_tally - The login counter (tallying) module</p>

<p>SYNOPSIS pam_tally.so [file=/path/to/counter]
[onerr=[fail|succeed]] [magic_root] [even_deny_root_account]
[deny=n] [lock_time=n] [unlock_time=n] [per_user]
[no_lock_time] [no_reset] [audit]</p>

<p>pam_tally [--file /path/to/counter] [--user username]
[--reset[=n]] [--quiet]</p>

<p>DESCRIPTION This module maintains a count of attempted
accesses, can reset count on success, can deny access if too
many attempts fail.</p>

<p>pam_tally comes in two parts: pam_tally.so and
pam_tally. The former is the PAM module and the latter, a
stand-alone program. pam_tally is an (optional) application
which can be used to interrogate and manipulate the counter
file. It can display users counts, set individual counts, or
clear all counts. Setting artificially high counts may be
useful for blocking users without changing their passwords.
For example, one might find it useful to clear all counts
every midnight from a cron job. The faillog(8) command can
be used instead of pam_tally to to maintain the counter
file.</p>

<p>Normally, failed attempts to access root will not cause
the root account to become blocked, to prevent
denial-of-service: if your users aren t given shell accounts
and root may only login via su or at the machine console
(not telnet/rsh, etc), this is safe.</p>

<p>OPTIONS GLOBAL OPTIONS This can be used for auth and
account services.</p>

<p>onerr=[fail|succeed] If something weird happens (like
unable to open the file), return with PAM_SUCESS if
onerr=succeed is given, else with the corresponding PAM
error code.</p>

<p>file=/path/to/counter File where to keep counts. Default
is /var/log/faillog.</p>

<p>audit Will display the username typed if the user is not
found.</p>

<p>AUTH OPTIONS Authentication phase first checks if user
should be denied access and if not it increments attempted
login counter. Then on call to pam_setcred(3) it resets the
attempts counter.</p>

<p>deny=n Deny access if tally for this user exceeds n.</p>

<p>lock_time=n Always deny for n seconds after failed
attempt.</p>

<p>unlock_time=n Allow access after n seconds after failed
attempt. If this option is used the user will be locked out
for the specified amount of time after he exceeded his
maximum allowed attempts. Otherwise the account is locked
until the lock is removed by a manual intervention of the
system administrator.</p>

<p>magic_root If the module is invoked by a user with uid=0
the counter is not incremented. The sys-admin should use
this for user launched services, like su, otherwise this
argument should be omitted.</p>

<p>no_lock_time Do not use the .fail_locktime field in
/var/log/faillog for this user.</p>

<p>no_reset Don t reset count on successful entry, only
decrement.</p>

<p>even_deny_root_account Root account can become
unavailable.</p>

<p>even_deny_root_account Root account can become
unavailable.</p>

<p>per_user If /var/log/faillog contains a non-zero
.fail_max/.fail_locktime field for this user then use it
instead of deny=n/ lock_time=n parameter.</p>

<p>no_lock_time Don t use .fail_locktime filed in
/var/log/faillog for this user.</p>

<p>ACCOUNT OPTIONS Account phase resets attempts counter if
the user is not magic root. This phase can be used optionaly
for services which don t call pam_setcred(3) correctly or if
the reset should be done regardless of the failure of the
account phase of other modules.</p>

<p>magic_root If the module is invoked by a user with uid=0
the counter is not incremented. The sys-admin should use
this for user launched services, like su, otherwise this
argument should be omitted.</p>

<p>no_reset Don t reset count on successful entry, only
decrement.</p>

<p>MODULE SERVICES PROVIDED The auth and account services
are supported.</p>

<p>RETURN VALUES PAM_AUTH_ERR A invalid option was given,
the module was not able to retrive the user name, no valid
counter file was found, or too many failed logins.</p>

<p>PAM_SUCCESS Everything was successfull.</p>

<p>PAM_USER_UNKNOWN User not known.</p>

<p>EXAMPLES Add the following line to /etc/pam.d/login to
lock the account after too many failed logins. The number of
allowed fails is specified by /var/log/faillog and needs to
be set with pam_tally or faillog(8) before.</p>

<p>auth required pam_securetty.so auth required
pam_tally.so per_user auth required pam_env.so auth required
pam_unix.so auth required pam_nologin.so account required
pam_unix.so password required pam_unix.so session required
pam_limits.so session required pam_unix.so session required
pam_lastlog.so nowtmp session optional pam_mail.so
standard</p>

<p>FILES /var/log/faillog failure logging file</p>

<p>SEE ALSO faillog(8), pam.conf(5), pam.d(8), pam(8)</p>

<p>AUTHOR pam_tally was written by Tim Baverstock and Tomas
Mraz.</p>

<p>Linux-PAM Manual 06/18/2006 PAM_TALLY(8)</p>
<hr>
</body>
</html>
