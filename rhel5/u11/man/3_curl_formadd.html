<!-- Creator     : groff version 1.18.1.1 -->
<!-- CreationDate: Sat Nov 12 05:08:16 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>curl_formadd(3) libcurl Manual curl_formadd(3)</p>

<p>NAME curl_formadd - add a section to a
multipart/formdata HTTP POST</p>

<p>SYNOPSIS #include &lt;curl/curl.h&gt;</p>

<p>CURLFORMcode curl_formadd(struct curl_httppost **
firstitem, struct curl_httppost ** lastitem, ...);</p>

<p>DESCRIPTION curl_formadd() is used to append sections
when building a multi- part/formdata HTTP POST (sometimes
referred to as rfc1867-style posts). Append one section at a
time until youve added all the sections you want included
and then you pass the firstitem pointer as parameter to
CURLOPT_HTTPPOST. lastitem is set after each call and on
repeated invokes it should be left as set to allow repeated
invokes to find the end of the list faster.</p>

<p>After the lastitem pointer follow the real
arguments.</p>

<p>The pointers *firstitem and *lastitem should both be
pointing to NULL in the first call to this function. All
list-data will be allocated by the function itself. You must
call curl_formfree after the form post has been done to free
the resources again.</p>

<p>Using POST with HTTP 1.1 implies the use of a
&quot;Expect: 100-continue&quot; header. You can disable
this header with CURLOPT_HTTPHEADER as usual.</p>

<p>First, there are some basics you need to understand
about multi- part/formdata posts. Each part consists of at
least a NAME and a CON- TENTS part. If the part is made for
file upload, there are also a stored CONTENT-TYPE and a
FILENAME. Below here, we ll discuss on what options you use
to set these properties in the parts you want to add to your
post.</p>

<p>OPTIONS CURLFORM_COPYNAME followed by string is used to
set the name of this part. libcurl copies the given data, so
your application doesnt need to keep it around after this
function call. If the name isn t zero ter- minated properly,
or if youd like it to contain zero bytes, you need to set
the length of the name with CURLFORM_NAMELENGTH.</p>

<p>CURLFORM_PTRNAME followed by a string is used for the
name of this part. libcurl will use the pointer and refer to
the data in your application, you must make sure it remains
until curl no longer needs it. If the name isnt zero
terminated properly, or if youd like it to contain zero
bytes, you need to set the length of the name with
CURLFORM_NAMELENGTH.</p>

<p>CURLFORM_COPYCONTENTS followed by a string is used for
the contents of this part, the actual data to send away.
libcurl copies the given data, so your application doesnt
need to keep it around after this function call. If the data
isnt zero terminated properly, or if youd like it to contain
zero bytes, you need to set the length of the name with
CURLFORM_CONTENTSLENGTH.</p>

<p>CURLFORM_PTRCONTENTS followed by a string is used for
the contents of this part, the actual data to send away.
libcurl will use the pointer and refer to the data in your
application, you must make sure it remains until curl no
longer needs it. If the data isn t zero terminated properly,
or if youd like it to contain zero bytes, you need to set
the length of the name with CURLFORM_CONTENTSLENGTH.</p>

<p>CURLFORM_CONTENTSLENGTH followed by a long setting the
length of the contents.</p>

<p>CURLFORM_FILECONTENT followed by a file name, makes that
file read and the contents will be used in as data in this
part.</p>

<p>CURLFORM_FILE followed by a file name, makes this part a
file upload part. It sets the file name field to the actual
file name used here, it gets the contents of the file and
passes as data and sets the content-type if the given file
match one of the new internally known file extension. For
CURLFORM_FILE the user may send one or more files in one
part by providing multiple CURLFORM_FILE arguments each
followed by the filename (and each CURLFORM_FILE is allowed
to have a CURLFORM_CONTENTTYPE).</p>

<p>CURLFORM_CONTENTTYPE followed by a pointer to a string
with a content-type will make curl use this given
content-type for this file upload part, pos- sibly instead
of an internally chosen one.</p>

<p>CURLFORM_FILENAME followed by a pointer to a string to a
name, will make libcurl use the given name in the file
upload part, instead of the actual file name given to
CURLFORM_FILE.</p>

<p>CURLFORM_BUFFER followed by a string, tells libcurl that
a buffer is to be used to upload data instead of using a
file. The given string is used as the value of the file name
field in the content header.</p>

<p>CURLFORM_BUFFERPTR followed by a pointer to a data area,
tells libcurl the address of the buffer containing data to
upload (as indicated with CURL- FORM_BUFFER). The buffer
containing this data must not be freed until after
curl_easy_cleanup(3) is called. You must also use
CURLFORM_BUFFERLENGTH to set the length of the given buffer
area.</p>

<p>CURLFORM_BUFFERLENGTH followed by a long with the size
of the CURLFORM_BUFFERPTR data area, tells libcurl the
length of the buffer to upload.</p>

<p>CURLFORM_ARRAY Another possibility to send options to
curl_formadd() is the CURLFORM_ARRAY option, that passes a
struct curl_forms array pointer as its value. Each
curl_forms structure element has a CURLformoption and a char
pointer. The final element in the array must be a
CURLFORM_END. All available options can be used in an array,
except the CURLFORM_ARRAY option itself! The last argument
in such an array must always be CURLFORM_END.</p>

<p>CURLFORM_CONTENTHEADER specifies extra headers for the
form POST section. This takes a curl_slist prepared in the
usual way using curl_slist_append and appends the list of
headers to those libcurl automatically gen- erates. The list
must exist while the POST occurs, if you free it before the
post completes you may experience problems.</p>

<p>When you ve passed the HttpPost pointer to
curl_easy_setopt(3) (using the CURLOPT_HTTPPOST option), you
must not free the list until after youve called
curl_easy_cleanup(3) for the curl han- dle.</p>

<p>See example below.</p>

<p>RETURN VALUE 0 means everything was ok, non-zero means
an error occurred as &lt;curl/curl.h&gt; defines.</p>

<p>EXAMPLE struct curl_httppost* post = NULL; struct
curl_httppost* last = NULL; char namebuffer[] = &quot;name
buffer&quot;; long namelength = strlen(namebuffer); char
buffer[] = &quot;test buffer&quot;; char htmlbuffer[] =
&quot;&lt;HTML&gt;test buffer&lt;/HTML&gt;&quot;; long
htmlbufferlength = strlen(htmlbuffer); struct curl_forms
forms[3]; char file1[] = &quot;my-face.jpg&quot;; char
file2[] = &quot;your-face.jpg&quot;; /* add null character
into htmlbuffer, to demonstrate that transfers of buffers
containing null characters actually work */ htmlbuffer[8] =
;</p>

<p>/* Add simple name/content section */
curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME,
&quot;name&quot;, CURLFORM_COPYCONTENTS,
&quot;content&quot;, CURLFORM_END);</p>

<p>/* Add simple name/content/contenttype section */
curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME,
&quot;htmlcode&quot;, CURLFORM_COPYCONTENTS,
&quot;&lt;HTML&gt;&lt;/HTML&gt;&quot;, CURLFORM_CONTENTTYPE,
&quot;text/html&quot;, CURLFORM_END);</p>

<p>/* Add name/ptrcontent section */
curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME,
&quot;name_for_ptrcontent&quot;, CURLFORM_PTRCONTENTS,
buffer, CURLFORM_END);</p>

<p>/* Add ptrname/ptrcontent section */
curl_formadd(&amp;post, &amp;last, CURLFORM_PTRNAME,
namebuffer, CURLFORM_PTRCONTENTS, buffer,
CURLFORM_NAMELENGTH, namelength, CURLFORM_END);</p>

<p>/* Add name/ptrcontent/contenttype section */
curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME,
&quot;html_code_with_hole&quot;, CURLFORM_PTRCONTENTS,
htmlbuffer, CURLFORM_CONTENTSLENGTH, htmlbufferlength,
CURLFORM_CONTENTTYPE, &quot;text/html&quot;,
CURLFORM_END);</p>

<p>/* Add simple file section */ curl_formadd(&amp;post,
&amp;last, CURLFORM_COPYNAME, &quot;picture&quot;,
CURLFORM_FILE, &quot;my-face.jpg&quot;, CURLFORM_END);</p>

<p>/* Add file/contenttype section */
curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME,
&quot;picture&quot;, CURLFORM_FILE, &quot;my-face.jpg&quot;,
CURLFORM_CONTENTTYPE, &quot;image/jpeg&quot;,
CURLFORM_END);</p>

<p>/* Add two file section */ curl_formadd(&amp;post,
&amp;last, CURLFORM_COPYNAME, &quot;pictures&quot;,
CURLFORM_FILE, &quot;my-face.jpg&quot;, CURLFORM_FILE,
&quot;your-face.jpg&quot;, CURLFORM_END);</p>

<p>/* Add two file section using CURLFORM_ARRAY */
forms[0].option = CURLFORM_FILE; forms[0].value = file1;
forms[1].option = CURLFORM_FILE; forms[1].value = file2;
forms[2].option = CURLFORM_END;</p>

<p>/* Add a buffer to upload */ curl_formadd(&amp;post,
&amp;last, CURLFORM_COPYNAME, &quot;name&quot;,
CURLFORM_BUFFER, &quot;data&quot;, CURLFORM_BUFFERPTR,
record, CURLFORM_BUFFERLENGTH, record_length,
CURLFORM_END);</p>

<p>/* no option needed for the end marker */
curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME,
&quot;pictures&quot;, CURLFORM_ARRAY, forms, CURLFORM_END);
/* Add the content of a file as a normal post text value */
curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME,
&quot;filecontent&quot;, CURLFORM_FILECONTENT,
&quot;.bashrc&quot;, CURLFORM_END); /* Set the form info */
curl_easy_setopt(curl, CURLOPT_HTTPPOST, post);</p>

<p>SEE ALSO curl_easy_setopt(3), curl_formfree(3)</p>

<p>libcurl 7.9.8 24 June 2002 curl_formadd(3)</p>
<hr>
</body>
</html>
