<!-- Creator     : groff version 1.18.1.1 -->
<!-- CreationDate: Sat Nov 12 05:23:35 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>SOCKATMARK(3) Linux Programmer s Manual
SOCKATMARK(3)</p>

<p>NAME sockatmark - determine whether socket is at
out-of-band mark</p>

<p>SYNOPSIS #include &lt;sys/socket.h&gt;</p>

<p>int sockatmark(int fd);</p>

<p>DESCRIPTION sockatmark() returns a value indicating
whether or not the socket referred to by the file descriptor
fd is at the out-of-band mark. If the socket is at the mark,
then 1 is returned; if the socket is not at the mark, 0 is
returned. This function does not remove the out-of-band
mark.</p>

<p>RETURN VALUE A successful call to sockatmark() returns 1
if the socket is at the out-of-band mark, or 0 if it is not.
On error, -1 is returned and errno is set to indicate the
error.</p>

<p>ERRORS EBADF fd is not a valid file descriptor.</p>

<p>EINVAL fd is not a file descriptor to which sockatmark()
can be applied.</p>

<p>NOTES If sockatmark() returns 1, then the out-of-band
data can be read using the MSG_OOB flag of recv(2).</p>

<p>Out-of-band data is only supported on some stream socket
protocols.</p>

<p>sockatmark() can safely be called from a handler for the
SIGURG signal.</p>

<p>sockatmark() is implemented using the SIOCATMARK ioctl()
operation.</p>

<p>CONFORMING TO POSIX.1-2001</p>

<p>VERSIONS sockatmark() was added to glibc in version
2.2.4.</p>

<p>BUGS Prior to glibc 2.4, sockatmark() did not work.</p>

<p>EXAMPLE The following code can be used after receipt of
a SIGURG signal to read (and discard) all data up to the
mark, and then read the byte of data at the mark:</p>

<p>char buf[BUF_LEN]; char oobdata; int atmark, s;</p>

<p>for (;;) { atmark = sockatmark(fd); if (atmark == -1) {
perror(&quot;sockatmark&quot;); break; }</p>

<p>if (atmark) break;</p>

<p>s = read(fd, buf, BUF_LEN) &lt;= 0); if (s == -1)
perror(&quot;read&quot;); if (s &lt;= 0) break; }</p>

<p>if (atmark == 1) { if (recv(fd, &amp;oobdata, 1,
MSG_OOB) == -1) { perror(&quot;recv&quot;); ... } }</p>

<p>SEE ALSO fcntl(2), recv(2), send(2), tcp(7)</p>

<p>Linux 2006-04-24 SOCKATMARK(3)</p>
<hr>
</body>
</html>
