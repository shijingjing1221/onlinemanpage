<!-- Creator     : groff version 1.18.1.1 -->
<!-- CreationDate: Sat Nov 12 05:18:50 2016 -->
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta name="Content-Style" content="text/css">
<title></title>
</head>
<body>

<hr>

<p>PERLVMS(1) Perl Programmers Reference Guide
PERLVMS(1)</p>

<p>NAME perlvms - VMS-specific documentation for Perl</p>

<p>DESCRIPTION Gathered below are notes describing details
of Perl 5 s behavior on VMS. They are a supplement to the
regular Perl 5 documentation, so we have focussed on the
ways in which Perl 5 functions differently under VMS than it
does under Unix, and on the interactions between Perl and
the rest of the operating system. We haven t tried to
duplicate com- plete descriptions of Perl features from the
main Perl documentation, which can be found in the [.pod]
subdirectory of the Perl distribution.</p>

<p>We hope these notes will save you from confusion and
lost sleep when writing Perl scripts on VMS. If you find we
ve missed something you think should appear here, please
dont hesitate to drop a line to vmsperl@perl.org.</p>

<p>Installation Directions for building and installing Perl
5 can be found in the file README.vms in the main source
directory of the Perl distribution..</p>

<p>Organization of Perl Images Core Images</p>

<p>During the installation process, three Perl images are
produced. Miniperl.Exe is an executable image which contains
all of the basic functionality of Perl, but cannot take
advantage of Perl extensions. It is used to generate several
files needed to build the complete Perl and various
extensions. Once you ve finished installing Perl, you can
delete this image.</p>

<p>Most of the complete Perl resides in the shareable image
PerlShr.Exe, which provides a core to which the Perl
executable image and all Perl extensions are linked. You
should place this image in Sys$Share, or define the logical
name PerlShr to translate to the full file specifi- cation
of this image. It should be world readable. (Remember that
if a user has execute only access to PerlShr, VMS will treat
it as if it were a privileged shareable image, and will
therefore require all down- stream shareable images to be
INSTALLed, etc.)</p>

<p>Finally, Perl.Exe is an executable image containing the
main entry point for Perl, as well as some initialization
code. It should be placed in a public directory, and made
world executable. In order to run Perl with command line
arguments, you should define a foreign com- mand to invoke
this image.</p>

<p>Perl Extensions</p>

<p>Perl extensions are packages which provide both XS and
Perl code to add new functionality to perl. (XS is a
meta-language which simplifies writing C code which
interacts with Perl, see perlxs for more details.) The Perl
code for an extension is treated like any other library
module - it s made available in your script through the
appropriate &quot;use&quot; or &quot;require&quot;
statement, and usually defines a Perl package containing the
extension.</p>

<p>The portion of the extension provided by the XS code may
be connected to the rest of Perl in either of two ways. In
the static configura- tion, the object code for the
extension is linked directly into Perl- Shr.Exe, and is
initialized whenever Perl is invoked. In the dynamic
configuration, the extensions machine code is placed into a
separate shareable image, which is mapped by Perls
DynaLoader when the extension is &quot;use&quot;d or
&quot;require&quot;d in your script. This allows you to
maintain the extension as a separate entity, at the cost of
keeping track of the additional shareable image. Most
extensions can be set up as either static or dynamic.</p>

<p>The source code for an extension usually resides in its
own directory. At least three files are generally provided:
Extshortname.xs (where Extshortname is the portion of the
extension s name following the last &quot;::&quot;),
containing the XS code, Extshortname.pm, the Perl library
module for the extension, and Makefile.PL, a Perl script
which uses the &quot;Make- Maker&quot; library modules
supplied with Perl to generate a Descrip.MMS file for the
extension.</p>

<p>Installing static extensions</p>

<p>Since static extensions are incorporated directly into
PerlShr.Exe, youll have to rebuild Perl to incorporate a new
extension. You should edit the main Descrip.MMS or Makefile
you use to build Perl, adding the extensions name to the
&quot;ext&quot; macro, and the extension s object file to
the &quot;extobj&quot; macro. You ll also need to build the
extensions object file, either by adding dependencies to the
main Descrip.MMS, or using a separate Descrip.MMS for the
extension. Then, rebuild PerlShr.Exe to incorporate the new
code.</p>

<p>Finally, youll need to copy the extension s Perl library
module to the [.Extname] subdirectory under one of the
directories in @INC, where Extname is the name of the
extension, with all &quot;::&quot; replaced by &quot;.&quot;
(e.g. the library module for extension Foo::Bar would be
copied to a [.Foo.Bar] subdirectory).</p>

<p>Installing dynamic extensions</p>

<p>In general, the distributed kit for a Perl extension
includes a file named Makefile.PL, which is a Perl program
which is used to create a Descrip.MMS file which can be used
to build and install the files required by the extension.
The kit should be unpacked into a directory tree not under
the main Perl source directory, and the procedure for
building the extension is simply</p>

<p>$ perl Makefile.PL ! Create Descrip.MMS $ mmk ! Build
necessary files $ mmk test ! Run test code, if supplied $
mmk install ! Install into public Perl tree</p>

<p>N.B. The procedure by which extensions are built and
tested creates several levels (at least 4) under the
directory in which the exten- sion s source files live. For
this reason if you are running a version of VMS prior to
V7.1 you shouldn t nest the source directory too deeply in
your directory structure lest you exceed RMS maximum of 8
levels of subdirectory in a filespec. (You can use rooted
logical names to get another 8 levels of nesting, if you
cant place the files near the top of the physical directory
structure.)</p>

<p>VMS support for this process in the current release of
Perl is suffi- cient to handle most extensions. However, it
does not yet recognize extra libraries required to build
shareable images which are part of an extension, so these
must be added to the linker options file for the extension
by hand. For instance, if the PGPLOT extension to Perl
requires the PGPLOTSHR.EXE shareable image in order to
properly link the Perl extension, then the line
&quot;PGPLOTSHR/Share&quot; must be added to the linker
options file PGPLOT.Opt produced during the build process
for the Perl extension.</p>

<p>By default, the shareable image for an extension is
placed in the [.lib.site_perl.autoArch.Extname] directory of
the installed Perl directory tree (where Arch is VMS_VAX or
VMS_AXP, and Extname is the name of the extension, with each
&quot;::&quot; translated to &quot;.&quot;). (See the
MakeMaker documentation for more details on installation
options for extensions.) However, it can be manually placed
in any of several locations:</p>

<p>&middot; the [.Lib.Auto.Arch$PVersExtname] subdirectory
of one of the direc- tories in @INC (where PVers is the
version of Perl you re using, as supplied in $], with .
converted to _), or</p>

<p>&middot; one of the directories in @INC, or</p>

<p>&middot; a directory which the extensions Perl library
module passes to the DynaLoader when asking it to map the
shareable image, or</p>

<p>&middot; Sys$Share or Sys$Library.</p>

<p>If the shareable image isnt in any of these places, you
ll need to define a logical name Extshortname, where
Extshortname is the portion of the extension s name after
the last &quot;::&quot;, which translates to the full file
specification of the shareable image.</p>

<p>File specifications Syntax</p>

<p>We have tried to make Perl aware of both VMS-style and
Unix- style file specifications wherever possible. You may
use either style, or both, on the command line and in
scripts, but you may not combine the two styles within a
single file specification. VMS Perl interprets Unix
pathnames in much the same way as the CRTL (e.g. the first
component of an absolute path is read as the device name for
the VMS file specifica- tion). There are a set of functions
provided in the &quot;VMS::Filespec&quot; package for
explicit interconversion between VMS and Unix syntax; its
documentation provides more details.</p>

<p>Filenames are, of course, still case-insensitive. For
consistency, most Perl routines return filespecs using lower
case letters only, regardless of the case used in the
arguments passed to them. (This is true only when running
under VMS; Perl respects the case-sensitivity of OSs like
Unix.)</p>

<p>We ve tried to minimize the dependence of Perl library
modules on Unix syntax, but you may find that some of these,
as well as some scripts written for Unix systems, will
require that you use Unix syntax, since they will assume
that / is the directory separator, etc. If you find
instances of this in the Perl distribution itself, please
let us know, so we can try to work around them.</p>

<p>Wildcard expansion</p>

<p>File specifications containing wildcards are allowed
both on the com- mand line and within Perl globs (e.g.
&quot;&lt;*.c&gt;&quot;). If the wildcard file- spec uses
VMS syntax, the resultant filespecs will follow VMS syntax;
if a Unix-style filespec is passed in, Unix-style filespecs
will be returned. Similar to the behavior of wildcard
globbing for a Unix shell, one can escape command line
wildcards with double quotation marks &quot;&quot;&quot;
around a perl program command line argument. However, owing
to the stripping of &quot;&quot;&quot; characters carried
out by the C handling of argv you will need to escape a
construct such as this one (in a direc- tory containing the
files PERL.C, PERL.EXE, PERL.H, and PERL.OBJ):</p>

<p>$ perl -e &quot;print join( ,@ARGV)&quot; perl.* perl.c
perl.exe perl.h perl.obj</p>

<p>in the following triple quoted manner:</p>

<p>$ perl -e &quot;print join( ,@ARGV)&quot;
&quot;&quot;&quot;perl.*&quot;&quot;&quot; perl.*</p>

<p>In both the case of unquoted command line arguments or
in calls to &quot;glob()&quot; VMS wildcard expansion is
performed. (csh-style wildcard expansion is available if you
use &quot;File::Glob::glob&quot;.) If the wildcard filespec
contains a device or directory specification, then the
resul- tant filespecs will also contain a device and
directory; otherwise, device and directory information are
removed. VMS-style resultant filespecs will contain a full
device and directory, while Unix-style resultant filespecs
will contain only as much of a directory path as was present
in the input filespec. For example, if your default direc-
tory is Perl_Root:[000000], the expansion of
&quot;[.t]*.*&quot; will yield file- specs like
&quot;perl_root:[t]base.dir&quot;, while the expansion of
&quot;t/*/*&quot; will yield filespecs like
&quot;t/base.dir&quot;. (This is done to match the behavior
of glob expansion performed by Unix shells.)</p>

<p>Similarly, the resultant filespec will contain the file
version only if one was present in the input filespec.</p>

<p>Pipes</p>

<p>Input and output pipes to Perl filehandles are
supported; the &quot;file name&quot; is passed to
lib$spawn() for asynchronous execution. You should be
careful to close any pipes you have opened in a Perl script,
lest you leave any &quot;orphaned&quot; subprocesses around
when Perl exits.</p>

<p>You may also use backticks to invoke a DCL subprocess,
whose output is used as the return value of the expression.
The string between the backticks is handled as if it were
the argument to the &quot;system&quot; opera- tor (see
below). In this case, Perl will wait for the subprocess to
complete before continuing.</p>

<p>The mailbox (MBX) that perl can create to communicate
with a pipe defaults to a buffer size of 512. The default
buffer size is adjustable via the logical name PERL_MBX_SIZE
provided that the value falls between 128 and the SYSGEN
parameter MAXBUF inclusive. For exam- ple, to double the MBX
size from the default within a Perl program, use
&quot;$ENV{&rsquo;PERL_MBX_SIZE&rsquo;} = 1024;&quot; and
then open and use pipe constructs. An alternative would be
to issue the command:</p>

<p>$ Define PERL_MBX_SIZE 1024</p>

<p>before running your wide record pipe program. A larger
value may improve performance at the expense of the BYTLM
UAF quota.</p>

<p>PERL5LIB and PERLLIB The PERL5LIB and PERLLIB logical
names work as documented in perl, except that the element
separator is instead of : . The directory specifications may
use either VMS or Unix syntax.</p>

<p>Command line I/O redirection and backgrounding</p>

<p>Perl for VMS supports redirection of input and output on
the command line, using a subset of Bourne shell syntax:</p>

<p>&middot; &quot;&lt;file&quot; reads stdin from
&quot;file&quot;,</p>

<p>&middot; &quot;&gt;file&quot; writes stdout to
&quot;file&quot;,</p>

<p>&middot; &quot;&gt;&gt;file&quot; appends stdout to
&quot;file&quot;,</p>

<p>&middot; &quot;2&gt;file&quot; writes stderr to
&quot;file&quot;,</p>

<p>&middot; &quot;2&gt;&gt;file&quot; appends stderr to
&quot;file&quot;, and</p>

<p>&middot; &quot;2&gt;&amp;1&quot; redirects stderr to
stdout.</p>

<p>In addition, output may be piped to a subprocess, using
the character . Anything after this character on the command
line is passed to a subprocess for execution; the subprocess
takes the output of Perl as its input.</p>

<p>Finally, if the command line ends with &amp;, the entire
command is run in the background as an asynchronous
subprocess.</p>

<p>Command line switches</p>

<p>The following command line switches behave differently
under VMS than described in perlrun. Note also that in order
to pass uppercase switches to Perl, you need to enclose them
in double-quotes on the com- mand line, since the CRTL
downcases all unquoted strings.</p>

<p>-i If the &quot;-i&quot; switch is present but no
extension for a backup copy is given, then inplace editing
creates a new version of a file; the existing copy is not
deleted. (Note that if an extension is given, an existing
file is renamed to the backup file, as is the case under
other operating systems, so it does not remain as a previous
version under the original filename.)</p>

<p>-S If the &quot;-S&quot; or &quot;-&quot;S&quot;&quot;
switch is present and the script name does not contain a
directory, then Perl translates the logical name DCL$PATH as
a searchlist, using each translation as a directory in which
to look for the script. In addition, if no file type is
specified, Perl looks in each directory for a file matching
the name specified, with a blank type, a type of .pl, and a
type of .com, in that order.</p>

<p>-u The &quot;-u&quot; switch causes the VMS debugger to
be invoked after the Perl program is compiled, but before it
has run. It does not cre- ate a core dump file.</p>

<p>Perl functions As of the time this document was last
revised, the following Perl func- tions were implemented in
the VMS port of Perl (functions marked with * are discussed
in more detail below):</p>

<p>file tests*, abs, alarm, atan, backticks*, binmode*,
bless, caller, chdir, chmod, chown, chomp, chop, chr, close,
closedir, cos, crypt*, defined, delete, die, do, dump*,
each, endpwent, eof, eval, exec*, exists, exit, exp, fileno,
getc, getlogin, getppid, getpwent*, getpwnam*, getpwuid*,
glob, gmtime*, goto, grep, hex, import, index, int, join,
keys, kill*, last, lc, lcfirst, length, local, localtime,
log, m//, map, mkdir, my, next, no, oct, open, opendir, ord,
pack, pipe, pop, pos, print, printf, push, q//, qq//, qw//,
qx//*, quotemeta, rand, read, readdir, redo, ref, rename,
require, reset, return, reverse, rewinddir, rindex, rmdir,
s///, scalar, seek, seekdir, select(internal), select
(system call)*, setpwent, shift, sin, sleep, sort, splice,
split, sprintf, sqrt, srand, stat, study, substr, sysread,
system*, syswrite, tell, telldir, tie, time, times*, tr///,
uc, ucfirst, umask, undef, unlink*, unpack, untie, unshift,
use, utime*, values, vec, wait, waitpid*, wantarray, warn,
write, y///</p>

<p>The following functions were not implemented in the VMS
port, and call- ing them produces a fatal error (usually) or
undefined behavior (rarely, we hope):</p>

<p>chroot, dbmclose, dbmopen, flock, fork*, getpgrp,
getpriority, getgrent, getgrgid, getgrnam, setgrent,
endgrent, ioctl, link, lstat, msgctl, msgget, msgsend,
msgrcv, readlink, semctl, semget, semop, setpgrp,
setpriority, shmctl, shmget, shmread, shmwrite, socketpair,
symlink, syscall</p>

<p>The following functions are available on Perls compiled
with Dec C 5.2 or greater and running VMS 7.0 or
greater:</p>

<p>truncate</p>

<p>The following functions are available on Perls built on
VMS 7.2 or greater:</p>

<p>fcntl (without locking)</p>

<p>The following functions may or may not be implemented,
depending on what type of socket support youve built into
your copy of Perl:</p>

<p>accept, bind, connect, getpeername, gethostbyname,
getnetbyname, getprotobyname, getservbyname, gethostbyaddr,
getnetbyaddr, getprotobynumber, getservbyport, gethostent,
getnetent, getprotoent, getservent, sethostent, setnetent,
setprotoent, setservent, endhostent, endnetent, endprotoent,
endservent, getsockname, getsockopt, listen, recv,
select(system call)*, send, setsockopt, shutdown, socket</p>

<p>File tests The tests &quot;-b&quot;, &quot;-B&quot;,
&quot;-c&quot;, &quot;-C&quot;, &quot;-d&quot;,
&quot;-e&quot;, &quot;-f&quot;, &quot;-o&quot;,
&quot;-M&quot;, &quot;-s&quot;, &quot;-S&quot;,
&quot;-t&quot;, &quot;-T&quot;, and &quot;-z&quot; work as
advertised. The return values for &quot;-r&quot;,
&quot;-w&quot;, and &quot;-x&quot; tell you whether you can
actually access the file; this may not reflect the UIC-based
file protec- tions. Since real and effective UIC dont differ
under VMS, &quot;-O&quot;, &quot;-R&quot;, &quot;-W&quot;,
and &quot;-X&quot; are equivalent to &quot;-o&quot;,
&quot;-r&quot;, &quot;-w&quot;, and &quot;-x&quot;.
Similarly, several other tests, including &quot;-A&quot;,
&quot;-g&quot;, &quot;-k&quot;, &quot;-l&quot;,
&quot;-p&quot;, and &quot;-u&quot;, arent particularly
meaningful under VMS, and the values returned by these tests
reflect whatever your CRTL &quot;stat()&quot; routine does
to the equivalent bits in the st_mode field. Finally,
&quot;-d&quot; returns true if passed a device specification
without an explicit directory (e.g. &quot;DUA1:&quot;), as
well as if passed a direc- tory.</p>

<p>Note: Some sites have reported problems when using the
file-access tests (&quot;-r&quot;, &quot;-w&quot;, and
&quot;-x&quot;) on files accessed via DEC s DFS.
Specifically, since DFS does not currently provide access to
the extended file header of files on remote volumes,
attempts to exam- ine the ACL fail, and the file tests will
return false, with $! indicating that the file does not
exist. You can use &quot;stat&quot; on these files, since
that checks UIC-based protection only, and then manually
check the appropriate bits, as defined by your C com- piler
s stat.h, in the mode value it returns, if you need an
approximation of the files protections.</p>

<p>backticks Backticks create a subprocess, and pass the
enclosed string to it for execution as a DCL command. Since
the subprocess is created directly via
&quot;lib$spawn()&quot;, any valid DCL command string may be
specified.</p>

<p>binmode FILEHANDLE The &quot;binmode&quot; operator will
attempt to insure that no translation of carriage control
occurs on input from or output to this filehan- dle. Since
this involves reopening the file and then restoring its file
position indicator, if this function returns FALSE, the
underlying filehandle may no longer point to an open file,
or may point to a different position in the file than before
&quot;binmode&quot; was called.</p>

<p>Note that &quot;binmode&quot; is generally not necessary
when using normal filehandles; it is provided so that you
can control I/O to existing record-structured files when
necessary. You can also use the &quot;vms- fopen&quot;
function in the VMS::Stdio extension to gain finer control
of I/O to files and devices with different record
structures.</p>

<p>crypt PLAINTEXT, USER The &quot;crypt&quot; operator
uses the &quot;sys$hash_password&quot; system service to
generate the hashed representation of PLAINTEXT. If USER is
a valid username, the algorithm and salt values are taken
from that user s UAF record. If it is not, then the
preferred algorithm and a salt of 0 are used. The quadword
encrypted value is returned as an 8-character string.</p>

<p>The value returned by &quot;crypt&quot; may be compared
against the encrypted password from the UAF returned by the
&quot;getpw*&quot; functions, in order to authenticate
users. If youre going to do this, remember that the
encrypted password in the UAF was generated using uppercase
username and password strings; youll have to upcase the
arguments to &quot;crypt&quot; to insure that youll get the
proper value:</p>

<p>sub validate_passwd { my($user,$passwd) = @_;
my($pwdhash); if ( !($pwdhash = (getpwnam($user))[1])
$pwdhash ne crypt(&quot;U$passwd&quot;,&quot;U$name&quot;) )
{ intruder_alert($name); } return 1; }</p>

<p>dump Rather than causing Perl to abort and dump core,
the &quot;dump&quot; opera- tor invokes the VMS debugger. If
you continue to execute the Perl program under the debugger,
control will be transferred to the label specified as the
argument to &quot;dump&quot;, or, if no label was specified,
back to the beginning of the program. All other state of the
program (e.g. values of variables, open file handles) are
not affected by calling &quot;dump&quot;.</p>

<p>exec LIST A call to &quot;exec&quot; will cause Perl to
exit, and to invoke the command given as an argument to
&quot;exec&quot; via &quot;lib$do_command&quot;. If the
argu- ment begins with @ or $ (other than as part of a
filespec), then it is executed as a DCL command. Otherwise,
the first token on the command line is treated as the
filespec of an image to run, and an attempt is made to
invoke it (using .Exe and the process defaults to expand the
filespec) and pass the rest of &quot;exec&quot;s argument to
it as parameters. If the token has no file type, and matches
a file with null type, then an attempt is made to determine
whether the file is an executable image which should be
invoked using &quot;MCR&quot; or a text file which should be
passed to DCL as a com- mand procedure.</p>

<p>fork While in principle the &quot;fork&quot; operator
could be implemented via (and with the same rather severe
limitations as) the CRTL &quot;vfork()&quot; routine, and
while some internal support to do just that is in place, the
implementation has never been completed, making
&quot;fork&quot; currently unavailable. A true kernel
&quot;fork()&quot; is expected in a future version of VMS,
and the pseudo-fork based on interpreter threads may be
available in a future version of Perl on VMS (see perlfork).
In the meantime, use &quot;system&quot;, backticks, or piped
filehandles to create subprocesses.</p>

<p>getpwent getpwnam getpwuid These operators obtain the
information described in perlfunc, if you have the
privileges necessary to retrieve the named users UAF
information via &quot;sys$getuai&quot;. If not, then only
the $name, $uid, and $gid items are returned. The $dir item
contains the login directory in VMS syntax, while the
$comment item contains the login directory in Unix syntax.
The $gcos item contains the owner field from the UAF record.
The $quota item is not used.</p>

<p>gmtime The &quot;gmtime&quot; operator will function
properly if you have a working CRTL &quot;gmtime()&quot;
routine, or if the logical name SYS$TIMEZONE_DIF- FERENTIAL
is defined as the number of seconds which must be added to
UTC to yield local time. (This logical name is defined
automat- ically if you are running a version of VMS with
built-in UTC sup- port.) If neither of these cases is true,
a warning message is printed, and &quot;undef&quot; is
returned.</p>

<p>kill In most cases, &quot;kill&quot; is implemented via
the CRTL s &quot;kill()&quot; func- tion, so it will behave
according to that functions documentation. If you send a
SIGKILL, however, the $DELPRC system service is called
directly. This insures that the target process is actually
deleted, if at all possible. (The CRTL s &quot;kill()&quot;
function is presently implemented via $FORCEX, which is
ignored by supervisor- mode images like DCL.)</p>

<p>Also, negative signal values dont do anything special
under VMS; they re just converted to the corresponding
positive value.</p>

<p>qx// See the entry on &quot;backticks&quot; above.</p>

<p>select (system call) If Perl was not built with socket
support, the system call version of &quot;select&quot; is
not available at all. If socket support is present, then the
system call version of &quot;select&quot; functions only for
file descriptors attached to sockets. It will not provide
information about regular files or pipes, since the CRTL
&quot;select()&quot; routine does not provide this
functionality.</p>

<p>stat EXPR Since VMS keeps track of files according to a
different scheme than Unix, its not really possible to
represent the file s ID in the &quot;st_dev&quot; and
&quot;st_ino&quot; fields of a &quot;struct stat&quot;. Perl
tries its best, though, and the values it uses are pretty
unlikely to be the same for two different files. We cant
guarantee this, though, so caveat scriptor.</p>

<p>system LIST The &quot;system&quot; operator creates a
subprocess, and passes its argu- ments to the subprocess for
execution as a DCL command. Since the subprocess is created
directly via &quot;lib$spawn()&quot;, any valid DCL command
string may be specified. If the string begins with @, it is
treated as a DCL command unconditionally. Otherwise, if the
first token contains a character used as a delimiter in file
speci- fication (e.g. &quot;:&quot; or &quot;]&quot;), an
attempt is made to expand it using a default type of .Exe
and the process defaults, and if successful, the resulting
file is invoked via &quot;MCR&quot;. This allows you to
invoke an image directly simply by passing the file
specification to &quot;sys- tem&quot;, a common Unixish
idiom. If the token has no file type, and matches a file
with null type, then an attempt is made to determine whether
the file is an executable image which should be invoked
using &quot;MCR&quot; or a text file which should be passed
to DCL as a com- mand procedure.</p>

<p>If LIST consists of the empty string, &quot;system&quot;
spawns an interac- tive DCL subprocess, in the same fashion
as typing SPAWN at the DCL prompt.</p>

<p>Perl waits for the subprocess to complete before
continuing execu- tion in the current process. As described
in perlfunc, the return value of &quot;system&quot; is a
fake &quot;status&quot; which follows POSIX semantics unless
the pragma &quot;use vmsish &rsquo;status&rsquo;&quot; is in
effect; see the description of $? in this document for more
detail.</p>

<p>time The value returned by &quot;time&quot; is the
offset in seconds from 01-JAN-1970 00:00:00 (just like the
CRTLs times() routine), in order to make life easier for
code coming in from the POSIX/Unix world.</p>

<p>times The array returned by the &quot;times&quot;
operator is divided up according to the same rules the CRTL
&quot;times()&quot; routine. Therefore, the &quot;sys- tem
time&quot; elements will always be 0, since there is no
difference between &quot;user time&quot; and
&quot;system&quot; time under VMS, and the time accu-
mulated by a subprocess may or may not appear separately in
the &quot;child time&quot; field, depending on whether times
keeps track of sub- processes separately. Note especially
that the VAXCRTL (at least) keeps track only of subprocesses
spawned using fork and exec; it will not accumulate the
times of subprocesses spawned via pipes, system, or
backticks.</p>

<p>unlink LIST &quot;unlink&quot; will delete the highest
version of a file only; in order to delete all versions, you
need to say</p>

<p>1 while unlink LIST;</p>

<p>You may need to make this change to scripts written for
a Unix sys- tem which expect that after a call to
&quot;unlink&quot;, no files with the names passed to
&quot;unlink&quot; will exist. (Note: This can be changed at
compile time; if you &quot;use Config&quot; and
$Config{&rsquo;d_unlink_all_ver- sions&rsquo;} is
&quot;define&quot;, then &quot;unlink&quot; will delete all
versions of a file on the first call.)</p>

<p>&quot;unlink&quot; will delete a file if at all
possible, even if it requires changing file protection
(though it wont try to change the protec- tion of the parent
directory). You can tell whether youve got explicit delete
access to a file by using the &quot;VMS::Filespec::can-
delete&quot; operator. For instance, in order to delete only
files to which you have delete access, you could say
something like</p>

<p>sub safe_unlink { my($file,$num); foreach $file (@_) {
next unless VMS::Filespec::candelete($file); $num += unlink
$file; } $num; }</p>

<p>(or you could just use &quot;VMS::Stdio::remove&quot;,
if youve installed the VMS::Stdio extension distributed with
Perl). If &quot;unlink&quot; has to change the file
protection to delete the file, and you interrupt it in
midstream, the file may be left intact, but with a changed
ACL allowing you delete access.</p>

<p>utime LIST Since ODS-2, the VMS file structure for disk
files, does not keep track of access times, this operator
changes only the modification time of the file (VMS revision
date).</p>

<p>waitpid PID,FLAGS If PID is a subprocess started by a
piped &quot;open()&quot; (see open), &quot;waitpid&quot;
will wait for that subprocess, and return its final sta- tus
value in $?. If PID is a subprocess created in some other
way (e.g. SPAWNed before Perl was invoked),
&quot;waitpid&quot; will simply check once per second
whether the process has completed, and return when it has.
(If PID specifies a process that isnt a subprocess of the
current process, and you invoked Perl with the
&quot;-w&quot; switch, a warning will be issued.)</p>

<p>Returns PID on success, -1 on error. The FLAGS argument
is ignored in all cases.</p>

<p>Perl variables The following VMS-specific information
applies to the indicated &quot;spe- cial&quot; Perl
variables, in addition to the general information in perl-
var. Where there is a conflict, this information takes
precedence.</p>

<p>%ENV The operation of the %ENV array depends on the
translation of the logical name PERL_ENV_TABLES. If defined,
it should be a search list, each element of which specifies
a location for %ENV elements. If you tell Perl to read or
set the element &quot;$ENV{&quot;name&quot;}&quot;, then
Perl uses the translations of PERL_ENV_TABLES as
follows:</p>

<p>CRTL_ENV This string tells Perl to consult the CRTLs
internal &quot;environ&quot; array of key-value pairs, using
name as the key. In most cases, this contains only a few
keys, but if Perl was invoked via the C
&quot;exec[lv]e()&quot; function, as is the case for CGI
pro- cessing by some HTTP servers, then the
&quot;environ&quot; array may have been populated by the
calling program.</p>

<p>CLISYM_[LOCAL] A string beginning with
&quot;CLISYM_&quot;tells Perl to consult the CLI s symbol
tables, using name as the name of the symbol. When reading
an element of %ENV, the local symbol table is scanned first,
followed by the global symbol table.. The char- acters
following &quot;CLISYM_&quot; are significant when an
element of %ENV is set or deleted: if the complete string is
&quot;CLISYM_LOCAL&quot;, the change is made in the local
symbol table; otherwise the global symbol table is
changed.</p>

<p>Any other string If an element of PERL_ENV_TABLES
translates to any other string, that string is used as the
name of a logical name ta- ble, which is consulted using
name as the logical name. The normal search order of access
modes is used.</p>

<p>PERL_ENV_TABLES is translated once when Perl starts up;
any changes you make while Perl is running do not affect the
behavior of %ENV. If PERL_ENV_TABLES is not defined, then
Perl defaults to consulting first the logical name tables
specified by LNM$FILE_DEV, and then the CRTL
&quot;environ&quot; array.</p>

<p>In all operations on %ENV, the key string is treated as
if it were entirely uppercase, regardless of the case
actually specified in the Perl expression.</p>

<p>When an element of %ENV is read, the locations to which
PERL_ENV_TABLES points are checked in order, and the value
obtained from the first successful lookup is returned. If
the name of the %ENV element contains a semi-colon, it and
any characters after it are removed. These are ignored when
the CRTL &quot;environ&quot; array or a CLI symbol table is
consulted. However, the name is looked up in a logical name
table, the suffix after the semi-colon is treated as the
translation index to be used for the lookup. This lets you
look up successive values for search list logical names. For
instance, if you say</p>

<p>$ Define STORY once,upon,a,time,there,was $ perl -e
&quot;for ($i = 0; $i &lt;= 6; $i++) &quot; - _$ -e &quot;{
print $ENV{story;.$i}, }&quot;</p>

<p>Perl will print &quot;ONCE UPON A TIME THERE WAS&quot;,
assuming, of course, that PERL_ENV_TABLES is set up so that
the logical name &quot;story&quot; is found, rather than a
CLI symbol or CRTL &quot;environ&quot; element with the same
name.</p>

<p>When an element of %ENV is set to a defined string, the
correspond- ing definition is made in the location to which
the first transla- tion of PERL_ENV_TABLES points. If this
causes a logical name to be created, it is defined in
supervisor mode. (The same is done if an existing logical
name was defined in executive or kernel mode; an existing
user or supervisor mode logical name is reset to the new
value.) If the value is an empty string, the logical names
translation is defined as a single NUL (ASCII 00) character,
since a logical name cannot translate to a zero-length
string. (This restriction does not apply to CLI symbols or
CRTL &quot;environ&quot; values; they are set to the empty
string.) An element of the CRTL &quot;envi- ron&quot; array
can be set only if your copy of Perl knows about the CRTL s
&quot;setenv()&quot; function. (This is present only in some
versions of the DECCRTL; check $Config{d_setenv} to see
whether your copy of Perl was built with a CRTL that has
this function.)</p>

<p>When an element of %ENV is set to &quot;undef&quot;, the
element is looked up as if it were being read, and if it is
found, it is deleted. (An item &quot;deleted&quot; from the
CRTL &quot;environ&quot; array is set to the empty string;
this can only be done if your copy of Perl knows about the
CRTL &quot;setenv()&quot; function.) Using
&quot;delete&quot; to remove an element from %ENV has a
similar effect, but after the element is deleted, another
attempt is made to look up the element, so an inner-mode
logical name or a name in another location will replace the
logical name just deleted. In either case, only the first
value found searching PERL_ENV_TABLES is altered. It is not
possible at present to define a search list logical name via
%ENV.</p>

<p>The element $ENV{DEFAULT} is special: when read, it
returns Perls current default device and directory, and when
set, it resets them, regardless of the definition of
PERL_ENV_TABLES. It cannot be cleared or deleted; attempts
to do so are silently ignored.</p>

<p>Note that if you want to pass on any elements of the
C-local envi- ron array to a subprocess which isn t started
by fork/exec, or isnt running a C program, you can
&quot;promote&quot; them to logical names in the current
process, which will then be inherited by all subpro- cesses,
by saying</p>

<p>foreach my $key (qw[C-local keys you want promoted]) {
my $temp = $ENV{$key}; # read from C-local array $ENV{$key}
= $temp; # and define as logical name }</p>

<p>(You cant just say $ENV{$key} = $ENV{$key}, since the
Perl opti- mizer is smart enough to elide the
expression.)</p>

<p>Dont try to clear %ENV by saying &quot;%ENV = ();&quot;,
it will throw a fatal error. This is equivalent to doing the
following from DCL:</p>

<p>DELETE/LOGICAL *</p>

<p>You can imagine how bad things would be if, for example,
the SYS$MANAGER or SYS$SYSTEM logicals were deleted.</p>

<p>At present, the first time you iterate over %ENV using
&quot;keys&quot;, or &quot;values&quot;, you will incur a
time penalty as all logical names are read, in order to
fully populate %ENV. Subsequent iterations will not reread
logical names, so they wont be as slow, but they also wont
reflect any changes to logical name tables caused by other
programs.</p>

<p>You do need to be careful with the logicals representing
process- permanent files, such as &quot;SYS$INPUT&quot; and
&quot;SYS$OUTPUT&quot;. The trans- lations for these
logicals are prepended with a two-byte binary value (0x1B
0x00) that needs to be stripped off if you want to use it.
(In previous versions of Perl it wasnt possible to get the
values of these logicals, as the null byte acted as an
end-of- string marker)</p>

<p>$! The string value of $! is that returned by the CRTL s
strerror() function, so it will include the VMS message for
VMS-specific errors. The numeric value of $! is the value of
&quot;errno&quot;, except if errno is EVMSERR, in which case
$! contains the value of vaxc$errno. Setting $! always sets
errno to the value specified. If this value is EVMSERR, it
also sets vaxc$errno to 4 (NON- AME-F-NOMSG), so that the
string value of $! won t reflect the VMS error message from
before $! was set.</p>

<p>$^E This variable provides direct access to VMS status
values in vaxc$errno, which are often more specific than the
generic Unix- style error messages in $!. Its numeric value
is the value of vaxc$errno, and its string value is the
corresponding VMS message string, as retrieved by
sys$getmsg(). Setting $^E sets vaxc$errno to the value
specified.</p>

<p>$? The &quot;status value&quot; returned in $? is
synthesized from the actual exit status of the subprocess in
a way that approximates POSIX wait(5) semantics, in order to
allow Perl programs to portably test for successful
completion of subprocesses. The low order 8 bits of $? are
always 0 under VMS, since the termination status of a pro-
cess may or may not have been generated by an exception. The
next 8 bits are derived from the severity portion of the
subprocess exit status: if the severity was success or
informational, these bits are all 0; if the severity was
warning, they contain a value of 1; if the severity was
error or fatal error, they contain the actual severity bits,
which turns out to be a value of 2 for error and 4 for fatal
error.</p>

<p>As a result, $? will always be zero if the subprocess
exit status indicated successful completion, and non-zero if
a warning or error occurred. Conversely, when setting $? in
an END block, an attempt is made to convert the POSIX value
into a native status intelligi- ble to the operating system
upon exiting Perl. What this boils down to is that setting
$? to zero results in the generic success value SS$_NORMAL,
and setting $? to a non-zero value results in the generic
failure status SS$_ABORT. See also &quot;exit&quot; in
perlport.</p>

<p>The pragma &quot;use vmsish &rsquo;status&rsquo;&quot;
makes $? reflect the actual VMS exit status instead of the
default emulation of POSIX status described above. This
pragma also disables the conversion of non- zero values to
SS$_ABORT when setting $? in an END block (but zero will
still be converted to SS$_NORMAL).</p>

<p>$ Setting $ for an I/O stream causes data to be flushed
all the way to disk on each write (i.e. not just to the
underlying RMS buffers for a file). In other words, it s
equivalent to calling fflush() and fsync() from C.</p>

<p>Standard modules with VMS-specific differences
SDBM_File</p>

<p>SDBM_File works properly on VMS. It has, however, one
minor difference. The database directory file created has a
.sdbm_dir extension rather than a .dir extension. .dir files
are VMS filesystem directory files, and using them for other
purposes could cause unacceptable problems.</p>

<p>Revision date This document was last updated on
01-May-2002, for Perl 5, patchlevel 8.</p>

<p>AUTHOR Charles Bailey bailey@cor.newman.upenn.edu Craig
Berry craig- berry@mac.com Dan Sugalski dan@sidhe.org</p>

<p>perl v5.8.8 2014-02-11 PERLVMS(1)</p>
<hr>
</body>
</html>
